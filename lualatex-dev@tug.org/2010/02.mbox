From wspr81 at gmail.com  Mon Feb 15 06:44:40 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 15 Feb 2010 16:14:40 +1030
Subject: [lltx] fontspec CTAN release
In-Reply-To: <20100215050418.GA2356@khaled-laptop>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com> <20100213114623.GA2225@khaled-laptop> <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com> <20100214071713.GA2366@khaled-laptop> <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com> <20100214151907.GA2596@khaled-laptop> <0916FAE3-5660-44DC-8D47-2A7D6F9EB6E1@gmail.com> <20100215050418.GA2356@khaled-laptop>
Message-ID: <F7E91C27-74B3-41B1-BE87-65893A6082A1@gmail.com>

On 15/02/2010, at 3:34 PM, Khaled Hosny wrote:

> On Mon, Feb 15, 2010 at 10:20:04AM +1030, Will Robertson wrote:
>> On 15/02/2010, at 1:49 AM, Khaled Hosny wrote:
>> 
>>> `luatex --luaonly luaotfload-fonts.lua` or `texlua luaotfload-fonts.lua`
>> 
>> Seems like I'll have to do some debugging for Mac OS X
[...]

> Could you try my last commits (though I doubt there will be any
> difference).

Different output on the terminal but I'm afraid I still can't load system fonts afterwards:

$ texlua luaotfload-fonts.lua
luaotfload | Generating font names database.
luaotfload | Scanning TEXMF fonts:
[========>                                                                    ]luaotfload-fonts.lua:114: table index is nil


I don't have a whole lot of time during the week at the moment so it might take me a few days to come back to this problem.


>> I think the current problem you're having is that fontspec is assuming
>> for now that all fonts under LuaTeX will be external (at that stage I
>> didn't think system fonts were feasible for us yet). Will investigate.
> 
> AFAIK, it doesn't. The following works for me just fine:
[...]

Purely a coincidence, I think! :)

-- Will



From khaledhosny at eglug.org  Wed Feb  3 22:57:46 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 3 Feb 2010 23:57:46 +0200
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <20100130133134.GA6540@khaled-laptop>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>
 <20100130053701.GA2773@khaled-laptop>
 <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>
 <20100130133134.GA6540@khaled-laptop>
Message-ID: <20100203215746.GA22926@khaled-laptop>

On Sat, Jan 30, 2010 at 03:31:34PM +0200, Khaled Hosny wrote:
> On Sat, Jan 30, 2010 at 04:09:42PM +1030, Will Robertson wrote:
> > On 30/01/2010, at 4:07 PM, Khaled Hosny wrote:
> > 
> > > This might need a deeper luaotfload changes, which will be a significant
> > > deviate from ConTeXt codebase, which I'm reluctant to do, not before it
> > > is considered stable at least.
> > 
> > No worries.
> > This is definitely a good reason to want to use fontspec, instead, then!
> 
> It turned out to be fairly easy to implement it in ad hock way without
> messing with OpenType layout code internals, pushed to githup, please
> test.

Elie: I branched the repository from the latest CTAN release, and
backported this fix and few others (mainly the xtx file), I think it
should be safe to upload it to CTAN, can you verify this?

If every thing is OK, we can then change EU2 files to use the shorter
syntax.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Tue Feb 23 12:00:22 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 23 Feb 2010 13:00:22 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <eba574421002230207jb5d62e4s9a4a4b0fc1836f34@mail.gmail.com>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
 <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
 <4B83B028.1050000@gmx.de>
 <eba574421002230207jb5d62e4s9a4a4b0fc1836f34@mail.gmail.com>
Message-ID: <20100223110022.GD4097@khaled-laptop>

On Tue, Feb 23, 2010 at 12:07:54PM +0200, ?lie Roux wrote:
> 2010/2/23 Arno Trautmann <Arno.Trautmann at gmx.de>:
> >
> > I?d really love \fontspec[microtype]{my font}. Would that be possible to
> > implement? ?
> 
> Basically everything is possible... what about something like
>  - microtype=all or true or false or a scheme,
>  - protrusion = true or false or compat (\pdfprotrusion 1) or a scheme
>  - expansion = true or false or a scheme

I was thinking in something like this, too.

> as options for fontspec? Then users would have to build their scheme
> in lua instead of passing very long TeX options (calling a function
> like fontspec.microtype.create_protrusion_scheme)... for me that would
> be OK...

And the scheme is?


> But then what about enabling microtype=all by default in fontspec?

I'd say lets have the basic work done and tested, then if it proved to
be good enough may be we can turn it on by default (I myself in favour
of having it on by default).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From wspr81 at gmail.com  Sun Feb 14 09:11:42 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sun, 14 Feb 2010 18:41:42 +1030
Subject: [lltx] fontspec CTAN release
In-Reply-To: <20100214071713.GA2366@khaled-laptop>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com> <20100213114623.GA2225@khaled-laptop> <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com> <20100214071713.GA2366@khaled-laptop>
Message-ID: <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com>

On 14/02/2010, at 5:47 PM, Khaled Hosny wrote:

> Yes, but we don't use that any more (it will not even work), instead one
> can use the luaotfload-fonts.lua script from git, it'll generate and
> install a font database with all the needed info (names, styles and
> optical sizes).

Like this?  `luatex --lua luaotfload-fonts.lua`
I get an error:

luaotfload-fonts.lua:127: attempt to index a nil value

Sorry if I'm being dense right now...


>> But until then something like this will still fail:
>> 
>>    \font\1="TeX Gyre Termes" at 10pt\1
> 
> And even \font\1="TeX Gyre Termes/B/S=10" (you can use any arbitrary
> style name too, "DeJaVu Sans/ExtraLight").
> 
> This is already working, but not throughly tested (I did my best, but
> with font names you can expect all weired things).

I didn't know you'd got so far with this already, well done.
If this is actually working reasonably well, perhaps we can get it into fontspec straight away -- it will make documentation easier if both XeTeX and LuaTeX can access system fonts.


>> I think the roadmap right now should be
>> 
>> 1. Release fontspec with LuaTeX support & only "external" fonts
>> 2. Improve the tools in LuaLaTeX to access system fonts
>> 3. Add system font support to fontspec

I've just pushed a few commits in fixing up stupid bugs of mine.
I wish right now I had a test suite to check what's working and so on.

If this version actually works in terms of loading features and scripts and languages, besides the list on the Issues page are there any other bugs or missing features you're aware of at the moment?

-- Will



From elie.roux at telecom-bretagne.eu  Tue Feb 23 11:25:40 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Tue, 23 Feb 2010 12:25:40 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <20100223101820.GB3206@khaled-laptop>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
	 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
	 <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
	 <20100223101820.GB3206@khaled-laptop>
Message-ID: <eba574421002230225w1a8575c4r3e8d46494313d00d@mail.gmail.com>

2010/2/23 Khaled Hosny <khaledhosny at eglug.org>:
>
> I still find the extra package unnecessary, what is the function of
> luamicrotype packages besides switching microtypography on?

Containing fine tuned settings for some fonts.

> it can be
> done some thing like:
>
> \usepackage [Microtypography]{fontspec} % switch on microtypography

Good idea!

> \setmainfont[
> ? ? ? ? ? ? Protrusion=Quality, ? ? ? ?% user explicitly selects a preset
> ? ? ? ? ? ? Expansion =Quality,
> ? ? ? ? ? ?] {TeX Gyre Termes}
> \setsansfont ?{TeX Gyre Heros} ? ? ? ? ?% otherwise 'default' preset is implied
>
> I'm not sure what the callbacks you are suggesting are for.

The callbacks are to have an "auto" option (that would be default if
fontspec is loaded with microtypographic option) that would look into
a database of fine tuned settings and chose one for the font, instead
of having to select something like \setmainfont[Protrusion=TeX Gyre
Termes, Expansion =TeX Gyre Termes] {TeX Gyre Termes}, it would select
the settings automatically... Wdyt?

Thank you,
-- 
Elie


From elie.roux at telecom-bretagne.eu  Thu Feb  4 10:15:43 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Thu, 4 Feb 2010 11:15:43 +0200
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <20100203215746.GA22926@khaled-laptop>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>
	 <20100130053701.GA2773@khaled-laptop>
	 <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>
	 <20100130133134.GA6540@khaled-laptop>
	 <20100203215746.GA22926@khaled-laptop>
Message-ID: <eba574421002040115x161a0133s4099fa862d2ee98f@mail.gmail.com>

2010/2/3 Khaled Hosny <khaledhosny at eglug.org>:
>
> Elie: I branched the repository from the latest CTAN release, and
> backported this fix and few others (mainly the xtx file), I think it
> should be safe to upload it to CTAN, can you verify this?
>
> If every thing is OK, we can then change EU2 files to use the shorter
> syntax.

That's OK for me, it works fine under LuaTeX 0.40.6 and LuaTeX 0.50
for the tests I've made...

Thank you!
-- 
Elie


From elie.roux at telecom-bretagne.eu  Tue Feb 23 20:36:09 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Tue, 23 Feb 2010 21:36:09 +0200
Subject: [lltx] Re: luamicrotype?
In-Reply-To: <4B842431.6010307@gmx.net>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com> <4B842431.6010307@gmx.net>
Message-ID: <4B842E29.8030608@telecom-bretagne.eu>

Hello Robert,

thank you for your answer!

> You seem to be steering towards reinventing the wheel here (and the 
> axis, too).

Strange news but good news!

> Just recently I have been working on microtype in a luatex context, 
> and fortunately, it isn't all that difficult. The pdftex primitives 
> pertinent for protrusion and expansion still exist in luatex and will 
> -- in sha' Taco -- exist in the future, too. They also work with otf 
> fonts, so the main problem to solve here was how to convert the 
> characters in the configuration (where the user may specify them 
> straight-forwardly as 'A', '\textendash' or '?' etc.) into slot 
> numbers in the font. This has been puzzled out, so microtype now also 
> works with opentype fonts, as long as you stick to the NFSS, eg.:

Great! I don't have time to see how this works tonight, but I'll try to 
take a look tomorrow. Does it work with the latest CTAN version?

> It does not yet work with fontspec of course, however, only because 
> the latter deviates from the NFSS. I do not see the principal 
> difficulties you seem to make out. It should not be too hard to teach 
> microtype about fontspec, so that it is able do its task of activating 
> microtypography both systematically (if the font is included in the 
> set of fonts that should be activated) as well as in an ad-hoc manner 
> (eg., \fontspec[protrusion]{font}). Probably all that's required on 
> fontspec's part is a hook to call microtype once the font is loaded.

This looks simple... I guess the main thing will be for microtype to 
convert the fontspec naming (which is multiple as a font can be called 
in may ways) into some kind of nfss naming (which is ways simpler) to 
know which settings to use?

> I agree with Will that eventually, microtype and fontspec belong 
> together, but then the same holds true for microtype and the NFSS. 
> However, since for historical reasons, microtype is not part of the 
> latter, I do not see why it should become part of the former, 
> especially if this leads to different interfaces for the user.

Or more simple according to the new situation... should fontspec 
automatically load microtype when loaded with LuaTeX?

> Yes, and simple, too:
>   \DeclareOption{microtypography}{\RequirePackage{microtype}} % in 
> fontspec
> once microtype has been adapted to fontspec.

This would be a simple solution too...

> So, I would suggest to keep things as they are, be a bit patient with 
> me, and maybe in March, microtype will also work with fontspec...

Great news! We'll try to provide the needed hook in fontspec soon.

Thank you!
-- 
Elie


From elie.roux at telecom-bretagne.eu  Fri Feb 12 22:38:50 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Fri, 12 Feb 2010 23:38:50 +0200
Subject: [lltx] Re: microtypography
In-Reply-To: <F07CE8C5-7F8F-4340-B3B7-C511FECB8C2E@gmail.com>
References: <4B75810C.8010600@telecom-bretagne.eu> <4B7586E0.10701@telecom-bretagne.eu> <4B758B83.2060507@elzevir.fr> <20100212173756.GA31553@khaled-laptop> <F07CE8C5-7F8F-4340-B3B7-C511FECB8C2E@gmail.com>
Message-ID: <4B75CA6A.3020907@telecom-bretagne.eu>

Will Robertson a ?crit :
> AFAIK the current version of microtype already supports microtype?
> Or is it only for non-OpenType fonts?
>   

It is... and only for a set of them.

> If microtype is already working for LuaTeX I'd prefer to keep separate 
> packages, but if it makes things convenient then provide an interface 
> to microtype through fontspec itself.

Microtype is working for LuaTeX the same way it does with pdfTeX (a bit 
worse actually...), so all that happens in luaotfload is totally new and 
never worked before in microtype. As it's quite independant, I thought 
it would be good to separate it a bit from microtype...

But anyway, one of the goals of microtype is to store values of 
protrusion and expansion for different fonts, meaning that they are 
really fine tuned for these fonts, and I'm not sure this kind of things 
would belong to luaotfload or fontspec... I think luaotfload should 
provide an interface to pass these values to the algorithm, and that 
another package should provide them; but it could provide default values 
that could be activated automatically. Wdyt?

Thank you,
-- 
Elie


From wspr81 at gmail.com  Sat Feb 13 08:24:09 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 13 Feb 2010 17:54:09 +1030
Subject: [lltx] fontspec CTAN release
Message-ID: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>

Hi all,

So obviously things have come up and I've dropped the ball a fair bit on (a) writing the documentation for fontspec and (b) fixing all its bugs.

So these can happen sooner rather than later, I'd like to establish a baseline feature set to work towards over the next little while. First of all, I guess: do you think we should aim to have cached fonts (i.e., system fonts) available in LuaTeX? Or is that too variable at the moment depending on the setup of each user?

-- Will



From elie.roux at telecom-bretagne.eu  Fri Feb 12 17:50:40 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Fri, 12 Feb 2010 18:50:40 +0200
Subject: [lltx] Re: microtypography
In-Reply-To: <4B75810C.8010600@telecom-bretagne.eu>
References: <4B75810C.8010600@telecom-bretagne.eu>
Message-ID: <4B7586E0.10701@telecom-bretagne.eu>

Elie Roux a ?crit :
> The question I wanted to ask is whether we should enable it by default 
> in luaotfload or not... Not so many people know what protrusion means, 
> but if they knew I'm sure 99% of them would want it, so it seems 
> logical for me to enable this kind of features by default, with of 
> course options to unactivate it. I don't really see any disadvantage, 
> except a different rendering between XeTeX and LuaTeX, which is not 
> really a disadvantage for me... What do you think?

Sorry to answer my mail, I just got an idea: if we don't enable 
microtypography by default, I think the best way to deal with it would 
be through a microtype-luatex package, that would be loaded by microtype 
and that would contain code to activate the features as well as the good 
data for some OTF fonts. If you agree can ask Robert Schlicht what he 
thinks about this solution... The reason I prefer a microtype-luatex 
than an integration into microtype is because I don't think Robert wants 
to deal with all the updates it will imply, and because I find the idea 
of having a package for unicode that doesn't have a big machinery for 
all 8-bit fonts attractive... Maybe we should find a better name... What 
do you think?

Thank you,
-- 
Elie


From wspr81 at gmail.com  Tue Feb 23 06:00:32 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Tue, 23 Feb 2010 15:30:32 +1030
Subject: [lltx] luamicrotype?
In-Reply-To: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
Message-ID: <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>

On 22/02/2010, at 10:33 PM, ?lie Roux wrote:

> The main question is to know the user interface for microtypography:
> users are obviously used to microtype doing everything on its own, and
> I think such a thing is overall a good idea; but I'm not sure we
> should keep microtype for OTF fonts as it will need a lot of changes
> to interact with fontspec, and the checks to know if we are in an
> "old" configuration (with 8-bit fonts) or in a modern configuration
> (with Unicode fonts) will be a mess...


My current feelings (which may change; this is just random collections of thoughts at this stage):

1. font expansion and/or protrusion should be globally switchable, which lends itself more to a package like microtype than for specific font loading in fontspec

2. if people go to the effort of creating and distributing protrusion settings for different fonts, then they should be loaded by default -- although whether protrusion should be active or not should be entirely up to the user

3. these two points above lead me to think that specific expansion/protrusion settings should be somewhat "invisible" to most fontspec users; is this similar to what happens in ConTeXt?

4. however, if the relevant parts of microtype and fontspec are amenable to being merged together, I'm certainly not opposed to a hybrid package; the less packages to be loaded the better, IMO. But I don't want to step on microtype's toes if separating the packages is better for maintenance and development.

Need to get back to work; Robert, would you like to join this mailing list to continue the discussion?

-- Will



From wspr81 at gmail.com  Wed Feb 24 00:06:55 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Wed, 24 Feb 2010 09:36:55 +1030
Subject: [lltx] Re: luamicrotype?
In-Reply-To: <4B842E29.8030608@telecom-bretagne.eu>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com> <4B842431.6010307@gmx.net> <4B842E29.8030608@telecom-bretagne.eu>
Message-ID: <7E376BD9-4FD7-4CCF-8872-95FB375BC078@gmail.com>

On 24/02/2010, at 6:06 AM, Elie Roux wrote:

>> Just recently I have been working on microtype in a luatex context, and fortunately, it isn't all that difficult. The pdftex primitives pertinent for protrusion and expansion still exist in luatex and will -- in sha' Taco -- exist in the future, too. They also work with otf fonts, so the main problem to solve here was how to convert the characters in the configuration (where the user may specify them straight-forwardly as 'A', '\textendash' or '?' etc.) into slot numbers in the font. This has been puzzled out, so microtype now also works with opentype fonts, as long as you stick to the NFSS, eg.:
> 
> Great! I don't have time to see how this works tonight, but I'll try to take a look tomorrow. Does it work with the latest CTAN version?

Didn't I mention that the latest version of microtype supported LuaTeX? :)
To be honest though I've been too busy to look at what it was doing.

>> It does not yet work with fontspec of course, however, only because the latter deviates from the NFSS. I do not see the principal difficulties you seem to make out. It should not be too hard to teach microtype about fontspec, so that it is able do its task of activating microtypography both systematically (if the font is included in the set of fonts that should be activated) as well as in an ad-hoc manner (eg., \fontspec[protrusion]{font}). Probably all that's required on fontspec's part is a hook to call microtype once the font is loaded.


Since fontspec "layers" on top of the NFSS, it should be easy enough to either add support for microtype in fontspec or add support for fontspec in microtype. The rule, at present, for constructing a new NFSS family is to take the base font name (say "TeX Gyre Termes"), strip out any spaces, then append a counter to it depending how many times its been loaded with different font features. E.g., "TeXGyreTerms(3)".

If you would like a more robust string to parse/normalise than "(x)", this is easy to arrange.

-- Will



From khaledhosny at eglug.org  Mon Feb 15 07:08:47 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 15 Feb 2010 08:08:47 +0200
Subject: [lltx] fontspec CTAN release
In-Reply-To: <F7E91C27-74B3-41B1-BE87-65893A6082A1@gmail.com>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>
 <20100213114623.GA2225@khaled-laptop>
 <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com>
 <20100214071713.GA2366@khaled-laptop>
 <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com>
 <20100214151907.GA2596@khaled-laptop>
 <0916FAE3-5660-44DC-8D47-2A7D6F9EB6E1@gmail.com>
 <20100215050418.GA2356@khaled-laptop>
 <F7E91C27-74B3-41B1-BE87-65893A6082A1@gmail.com>
Message-ID: <20100215060847.GA5292@khaled-laptop>

On Mon, Feb 15, 2010 at 04:14:40PM +1030, Will Robertson wrote:
> On 15/02/2010, at 3:34 PM, Khaled Hosny wrote:
> 
> > On Mon, Feb 15, 2010 at 10:20:04AM +1030, Will Robertson wrote:
> >> On 15/02/2010, at 1:49 AM, Khaled Hosny wrote:
> >> 
> >>> `luatex --luaonly luaotfload-fonts.lua` or `texlua luaotfload-fonts.lua`
> >> 
> >> Seems like I'll have to do some debugging for Mac OS X
> [...]
> 
> > Could you try my last commits (though I doubt there will be any
> > difference).
> 
> Different output on the terminal but I'm afraid I still can't load
> system fonts afterwards:
> 
> $ texlua luaotfload-fonts.lua
> luaotfload | Generating font names database.
> luaotfload | Scanning TEXMF fonts:
> [========>                                                                    ]luaotfload-fonts.lua:114: table index is nil

Expected, I just wanted to get the new line number :) Anyway, you seem
to have some font that we can't index, Can you change the log level to 3
(line 23) so that we can know the broken font, and my be sending me a
copy to check myself.

> >> I think the current problem you're having is that fontspec is assuming
> >> for now that all fonts under LuaTeX will be external (at that stage I
> >> didn't think system fonts were feasible for us yet). Will investigate.
> > 
> > AFAIK, it doesn't. The following works for me just fine:
> [...]
> 
> Purely a coincidence, I think! :)

Well, I can't see where this assumption has been made in the code (I'm
not claiming any understanding of the code though).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From Arno.Trautmann at gmx.de  Tue Feb 23 11:38:32 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Tue, 23 Feb 2010 11:38:32 +0100
Subject: [lltx] luamicrotype?
In-Reply-To: <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>	 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com> <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
Message-ID: <4B83B028.1050000@gmx.de>

?lie Roux wrote:
> 2010/2/23 Will Robertson <wspr81 at gmail.com>:
>>
>> 1. font expansion and/or protrusion should be globally switchable, which lends itself more to a package like microtype than for specific font loading in fontspec
> 
> Agreed, but as fonts will be loaded with fontspec, luamicrotype (or
> whatever) will have to interact with it and fontspec will have to
> provide a way to load a font with microtypographic options...

I?d really love \fontspec[microtype]{my font}. Would that be possible to
implement? ?

>> 2. if people go to the effort of creating and distributing protrusion settings for different fonts, then they should be loaded by default -- although whether protrusion should be active or not should be entirely up to the user
> 
> Agreed! What I imagined more precisely is this:
>  - the user loads luamicrotype

This might not be a good idea. As Will statet, less packages are better.
So if the user had to load something for microtype, it should be
microtype (which then could check for the engine and load luamicrotype).

>  - luamicrotype sets \pdfprotrudechars2 \pdfadjustspacing2 and tells
> fontspec to have the default option Protrusion = Auto
>  - fontspec loads all new fonts with luaotfload with the option +protrusion=auto
>  - luaotfload, when it sees the 'auto' options calls a function (we
> can imagine something like callback.create) to retrieve the protrusion
> settings for the font, and luamicrotype provides it through this
> callback
> 
> What do you think about this?

Sounds good for the interna. But not really good for a user that should
not load more than needed. If anything regarding fonts could be done via
fontspec it would be great for the user. Maybe a swith \setmicrotype
similar to \setmainfont could be possible?

>> 3. these two points above lead me to think that specific expansion/protrusion settings should be somewhat "invisible" to most fontspec users; is this similar to what happens in ConTeXt?
>>
>> 4. however, if the relevant parts of microtype and fontspec are amenable to being merged together, I'm certainly not opposed to a hybrid package; the less packages to be loaded the better, IMO. But I don't want to step on microtype's toes if separating the packages is better for maintenance and development.
> 
> I guess so... though It's starting to smell like LaTeX 2.5 (the idea
> of which I totally agree with) ;-)

I?m looking forward for this version! :)

cheers
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100223/5aef13a2/attachment.bin>

From khaledhosny at eglug.org  Fri Feb 12 19:15:55 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 12 Feb 2010 20:15:55 +0200
Subject: [lltx] Re: microtypography
In-Reply-To: <F07CE8C5-7F8F-4340-B3B7-C511FECB8C2E@gmail.com>
References: <4B75810C.8010600@telecom-bretagne.eu>
 <4B7586E0.10701@telecom-bretagne.eu>
 <4B758B83.2060507@elzevir.fr>
 <20100212173756.GA31553@khaled-laptop>
 <F07CE8C5-7F8F-4340-B3B7-C511FECB8C2E@gmail.com>
Message-ID: <20100212181555.GA31861@khaled-laptop>

On Sat, Feb 13, 2010 at 04:18:47AM +1030, Will Robertson wrote:
> On 13/02/2010, at 4:07 AM, Khaled Hosny wrote:
> 
> > Expansion and protrusion, as currently implemented in luaotfload, are
> > font features and thus need to be enabled at font definition time and
> > thus naturally fall in fontspec area, doing it separately in any other
> > package will just make things unnecessary complex (if possible at all)
> > for no real gain. And there is OpenType "Opyical Bounds" feature
> > ('opbd') which is used to set protrusion values which need to be
> > supported by luaotfload/fontspec anyway.
> 
> 
> If microtype is already working for LuaTeX I'd prefer to keep separate
> packages, but if it makes things convenient then provide an interface to
> microtype through fontspec itself.

I didn't check how microtype implement it, but in luaotfload it is a
font feature, i.e. \font\test=file:lmroman10-regular:protrusion=default
so should be implemented in fontspec as any other font feature
("default" is a table predefined protrusion values and we should define
more.)

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From elie.roux at telecom-bretagne.eu  Wed Feb 24 08:14:01 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Wed, 24 Feb 2010 09:14:01 +0200
Subject: [lltx] Re: luamicrotype?
In-Reply-To: <4B849DD8.8030800@gmx.net>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
	 <4B842431.6010307@gmx.net> <4B842E29.8030608@telecom-bretagne.eu>
	 <4B849DD8.8030800@gmx.net>
Message-ID: <eba574421002232314y125b1897x9d8833096089fba4@mail.gmail.com>

2010/2/24 Robert <w.m.l at gmx.net>:
>
> No, only with my private version. I'll make it available soon.

Ok, great! We're all developing packages under github
(https://github.com/), it's a very nice collaborative development site
based on git; if you're interested in developing microtype there, I
think a lot of people would be curious and would maybe collaborate...
wdyt?

> I don't think so. Protrusion and expansion are nice, but not everybody wants
> them, and some people even hate them. So I don't think microtype should be
> imposed on the user.

Ok, I guess the package option is nice then.

> PS. I would really like to subscribe to lualatex-dev, but it seems I won't
> be getting very far without a google account. Whom would I have to contact
> to be added to the list?

I sent you an invitation, I hope it will work...

Thank you!
-- 
Elie


From elie.roux at telecom-bretagne.eu  Mon Feb 22 13:03:01 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Mon, 22 Feb 2010 14:03:01 +0200
Subject: [lltx] luamicrotype?
Message-ID: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>

Hello Robert and all,

Recently we've got microtypography (protrusion and expansion) working
under LuaTeX with OTF fonts, in the development version of luaotfload
(http://github.com/mpg/luaotfload/). It works this way:

 - we have some settings in two tables, like :
fonts.expansions.setups['default'] = {
    stretch = 2, shrink = 2, step = .5, factor = 1,
    [byte('A')] = 0.5, [byte('B')] = 0.7, [byte('C')] = 0.7,
[byte('D')] = 0.5, [byte('E')] = 0.7,
    [byte('F')] = 0.7, [byte('G')] = 0.5, [byte('H')] = 0.7,
[byte('K')] = 0.7, [byte('M')] = 0.7,
}
fonts.protrusions.setups['default'] = {
    factor = 1, left = 1, right = 1,
    [0x002C] = { 0, 1}, -- comma
    [0x002E] = { 0, 1}, -- period
    [0x003A] = { 0, 1}, -- colon
    [0x003B] = { 0, 1}, -- semicolon
    [0x002D] = { 0, 1}, -- hyphen
}

 - we load fonts and select the settings they will be applied, for example:
  \font\testb=file:texgyretermes-regular:script=latn;protrusion=default

 - later on we will have (I think?) a fontspec option to enable
certain settings into a font.

The main question is to know the user interface for microtypography:
users are obviously used to microtype doing everything on its own, and
I think such a thing is overall a good idea; but I'm not sure we
should keep microtype for OTF fonts as it will need a lot of changes
to interact with fontspec, and the checks to know if we are in an
"old" configuration (with 8-bit fonts) or in a modern configuration
(with Unicode fonts) will be a mess...

Here is how I see things: a new package (luamicrotype? umicrotype?)
should be created that would only interact with fontspec and provide a
user interface ? la microtype, as well as finely tuned data for OT
fonts. On the fontspec side, we should allow such a thing to happen by
providing a "callback" so that when a font is asked it's loaded with
the good microtypographic options.

What do you all think about that?

Thank you,
-- 
Elie


From arthur.reutenauer at normalesup.org  Wed Feb  3 20:53:22 2010
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Wed, 3 Feb 2010 20:53:22 +0100
Subject: [lltx] euenc: sed -E
In-Reply-To: <20100130054507.GB2773@khaled-laptop>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com> <20100130054507.GB2773@khaled-laptop>
Message-ID: <20100203195322.GQ22595@phare.normalesup.org>

>                                           If it were me, I'd just
> standarise on GNU sed;

  As one who had the most stupid problems with BSD sed at work recently, and
finally settled to install GNU sed because it was too much pain figthing with
both variants over a tiny detail, I'd advocate that, too.  (Actually I even had
it twice, once in December and once just this afternoon, when I had to install
GNU sed on my boss' machine -- again :-)

	Arthur


From elie.roux at telecom-bretagne.eu  Sun Feb  7 14:54:35 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Sun, 07 Feb 2010 15:54:35 +0200
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <eba574421002040115x161a0133s4099fa862d2ee98f@mail.gmail.com>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>	 <20100130053701.GA2773@khaled-laptop>	 <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>	 <20100130133134.GA6540@khaled-laptop>	 <20100203215746.GA22926@khaled-laptop> <eba574421002040115x161a0133s4099fa862d2ee98f@mail.gmail.com>
Message-ID: <4B6EC61B.7030609@telecom-bretagne.eu>

?lie Roux a ?crit :
> That's OK for me, it works fine under LuaTeX 0.40.6 and LuaTeX 0.50
> for the tests I've made...
>   

Hello,

I uploaded the TeXLive2009 branch of the github repository after some 
updates, and I also prepared luainputenc for upload (the package 
contained eu2lmr.fd and eu2end.def so it need to be uploaded at the same 
time as euenc). Will, tell me when you're ready to upload euenc, I'll 
upload luainputenc too. Also, you can put my mail address in the README 
file, no problem.

Thank you!
-- 
Elie


From wspr81 at gmail.com  Sun Feb 14 07:37:59 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sun, 14 Feb 2010 17:07:59 +1030
Subject: [lltx] fontspec CTAN release
In-Reply-To: <20100213114623.GA2225@khaled-laptop>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com> <20100213114623.GA2225@khaled-laptop>
Message-ID: <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com>

On 13/02/2010, at 10:16 PM, Khaled Hosny wrote:

> AFAIC, luaotfload can now load system fonts (which is different from
> cached fonts that is yet to be implemented), currently the font
> database generating script is too memory consuming (on my system with
> ~3000 fonts installed, it eats no less than 1GB of memory), luatex is
> leaking memory here and this need to be fixed. What is missing is the
> ability to launch the script from fontspec if no font database is
> available or if the asked font is missing from the database, this
> shouldn't be hard to implement, but I guess we can release fontspec 2.0
> without it.


Sorry for my terminology confusion.

Let me just clarify... in LuaTeX one can access system fonts if you have ConTeXt installed and run

    mtxrun --script font --reload

right?
But until then something like this will still fail:

    \font\1="TeX Gyre Termes" at 10pt\1

I think the roadmap right now should be

1. Release fontspec with LuaTeX support & only "external" fonts
2. Improve the tools in LuaLaTeX to access system fonts
3. Add system font support to fontspec

W



From khaledhosny at eglug.org  Sun Feb 14 08:17:13 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 14 Feb 2010 09:17:13 +0200
Subject: [lltx] fontspec CTAN release
In-Reply-To: <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>
 <20100213114623.GA2225@khaled-laptop>
 <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com>
Message-ID: <20100214071713.GA2366@khaled-laptop>

On Sun, Feb 14, 2010 at 05:07:59PM +1030, Will Robertson wrote:
> On 13/02/2010, at 10:16 PM, Khaled Hosny wrote:
> 
> > AFAIC, luaotfload can now load system fonts (which is different from
> > cached fonts that is yet to be implemented), currently the font
> > database generating script is too memory consuming (on my system with
> > ~3000 fonts installed, it eats no less than 1GB of memory), luatex is
> > leaking memory here and this need to be fixed. What is missing is the
> > ability to launch the script from fontspec if no font database is
> > available or if the asked font is missing from the database, this
> > shouldn't be hard to implement, but I guess we can release fontspec 2.0
> > without it.
> 
> 
> Sorry for my terminology confusion.
> 
> Let me just clarify... in LuaTeX one can access system fonts if you have ConTeXt installed and run
> 
>     mtxrun --script font --reload
> 
> right?
Yes, but we don't use that any more (it will not even work), instead one
can use the luaotfload-fonts.lua script from git, it'll generate and
install a font database with all the needed info (names, styles and
optical sizes).

> But until then something like this will still fail:
> 
>     \font\1="TeX Gyre Termes" at 10pt\1

And even \font\1="TeX Gyre Termes/B/S=10" (you can use any arbitrary
style name too, "DeJaVu Sans/ExtraLight").

This is already working, but not throughly tested (I did my best, but
with font names you can expect all weired things).

> I think the roadmap right now should be
> 
> 1. Release fontspec with LuaTeX support & only "external" fonts
> 2. Improve the tools in LuaLaTeX to access system fonts
> 3. Add system font support to fontspec
> 
> W

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Mon Feb 15 15:21:25 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 15 Feb 2010 16:21:25 +0200
Subject: [lltx] Microtypography... now the user asks questions.
In-Reply-To: <d8610afd-e6fd-4c29-95b2-eecb996d4892@l19g2000yqb.googlegroups.com>
References: <d8610afd-e6fd-4c29-95b2-eecb996d4892@l19g2000yqb.googlegroups.com>
Message-ID: <20100215141952.GB2126@khaled-laptop>

I think you are best reading H?n Th? Th?nh's thesis[1] on pdfTeX's
microtypography which LuaTeX inherited.

And you need not to change the default setup, you can make your own:

\directlua{
  fonts.expansions.setups['myexpansion'] = {
  ...
  }
}
\font\test\lmroman10-regular:expansion=myexpansion at 10 pt

[1] http://www.pragma-ade.com/download-6.htm

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From mpg at elzevir.fr  Sat Feb 13 10:44:03 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sat, 13 Feb 2010 10:44:03 +0100
Subject: [lltx] euenc upload and my broken luatex
In-Reply-To: <F9F9A6D7-BC1B-4CB5-A004-B551F0B20AA6@gmail.com>
References: <F9F9A6D7-BC1B-4CB5-A004-B551F0B20AA6@gmail.com>
Message-ID: <4B767463.6060709@elzevir.fr>

Will Robertson a ?crit :
>> This is LuaTeX, Version beta-0.40.6-2009100310 (TeX Live 2009)
>>  \write18 enabled.
>> (Fatal format file error; I'm stymied)
> 
Did your try 'fmtutil-sys -byengine luatex' (with sufficient privileges)? It
should solve the problem.

M.


From elie.roux at telecom-bretagne.eu  Tue Feb 23 11:07:54 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Tue, 23 Feb 2010 12:07:54 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <4B83B028.1050000@gmx.de>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
	 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
	 <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
	 <4B83B028.1050000@gmx.de>
Message-ID: <eba574421002230207jb5d62e4s9a4a4b0fc1836f34@mail.gmail.com>

2010/2/23 Arno Trautmann <Arno.Trautmann at gmx.de>:
>
> I?d really love \fontspec[microtype]{my font}. Would that be possible to
> implement? ?

Basically everything is possible... what about something like
 - microtype=all or true or false or a scheme,
 - protrusion = true or false or compat (\pdfprotrusion 1) or a scheme
 - expansion = true or false or a scheme
as options for fontspec? Then users would have to build their scheme
in lua instead of passing very long TeX options (calling a function
like fontspec.microtype.create_protrusion_scheme)... for me that would
be OK... But then what about enabling microtype=all by default in
fontspec?

> This might not be a good idea. As Will statet, less packages are better.
> So if the user had to load something for microtype, it should be
> microtype (which then could check for the engine and load luamicrotype).

Ok.

Thank you!
-- 
Elie


From elie.roux at telecom-bretagne.eu  Tue Feb 23 08:35:46 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Tue, 23 Feb 2010 09:35:46 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
	 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
Message-ID: <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>

2010/2/23 Will Robertson <wspr81 at gmail.com>:
>
> 1. font expansion and/or protrusion should be globally switchable, which lends itself more to a package like microtype than for specific font loading in fontspec

Agreed, but as fonts will be loaded with fontspec, luamicrotype (or
whatever) will have to interact with it and fontspec will have to
provide a way to load a font with microtypographic options...

> 2. if people go to the effort of creating and distributing protrusion settings for different fonts, then they should be loaded by default -- although whether protrusion should be active or not should be entirely up to the user

Agreed! What I imagined more precisely is this:
 - the user loads luamicrotype
 - luamicrotype sets \pdfprotrudechars2 \pdfadjustspacing2 and tells
fontspec to have the default option Protrusion = Auto
 - fontspec loads all new fonts with luaotfload with the option +protrusion=auto
 - luaotfload, when it sees the 'auto' options calls a function (we
can imagine something like callback.create) to retrieve the protrusion
settings for the font, and luamicrotype provides it through this
callback

What do you think about this?

> 3. these two points above lead me to think that specific expansion/protrusion settings should be somewhat "invisible" to most fontspec users; is this similar to what happens in ConTeXt?
>
> 4. however, if the relevant parts of microtype and fontspec are amenable to being merged together, I'm certainly not opposed to a hybrid package; the less packages to be loaded the better, IMO. But I don't want to step on microtype's toes if separating the packages is better for maintenance and development.

I guess so... though It's starting to smell like LaTeX 2.5 (the idea
of which I totally agree with) ;-)

Thank you,
-- 
Elie


From wspr81 at gmail.com  Fri Feb 12 18:48:47 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 13 Feb 2010 04:18:47 +1030
Subject: [lltx] Re: microtypography
In-Reply-To: <20100212173756.GA31553@khaled-laptop>
References: <4B75810C.8010600@telecom-bretagne.eu> <4B7586E0.10701@telecom-bretagne.eu> <4B758B83.2060507@elzevir.fr> <20100212173756.GA31553@khaled-laptop>
Message-ID: <F07CE8C5-7F8F-4340-B3B7-C511FECB8C2E@gmail.com>


On Fri, Feb 12, 2010 at 06:10:27PM +0100, Manuel P?gouri?-Gonnard wrote:

> I was precisely about to suggest that these features would be more naturally
> integrated in microtype than in fontspec. Concerning the implementation details
> (microtype-luatex vs direct integration in microtype), I have no opinion, but if
> would be great to preserve the same user interface whenever it makes sense.



AFAIK the current version of microtype already supports microtype?
Or is it only for non-OpenType fonts?



On 13/02/2010, at 4:07 AM, Khaled Hosny wrote:

> Expansion and protrusion, as currently implemented in luaotfload, are
> font features and thus need to be enabled at font definition time and
> thus naturally fall in fontspec area, doing it separately in any other
> package will just make things unnecessary complex (if possible at all)
> for no real gain. And there is OpenType "Opyical Bounds" feature
> ('opbd') which is used to set protrusion values which need to be
> supported by luaotfload/fontspec anyway.


If microtype is already working for LuaTeX I'd prefer to keep separate packages, but if it makes things convenient then provide an interface to microtype through fontspec itself.

But I agree eventually microtype and fontspec belong together.

-- Will



From khaledhosny at eglug.org  Sun Feb  7 20:02:36 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 7 Feb 2010 21:02:36 +0200
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <4B6EC61B.7030609@telecom-bretagne.eu>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>
 <20100130053701.GA2773@khaled-laptop>
 <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>
 <20100130133134.GA6540@khaled-laptop>
 <20100203215746.GA22926@khaled-laptop>
 <eba574421002040115x161a0133s4099fa862d2ee98f@mail.gmail.com>
 <4B6EC61B.7030609@telecom-bretagne.eu>
Message-ID: <20100207190236.GA9185@khaled-laptop>

On Sun, Feb 07, 2010 at 03:54:35PM +0200, Elie Roux wrote:
> ?lie Roux a ?crit :
> >That's OK for me, it works fine under LuaTeX 0.40.6 and LuaTeX 0.50
> >for the tests I've made...
> 
> Hello,
> 
> I uploaded the TeXLive2009 branch of the github repository after
> some updates, and I also prepared luainputenc for upload (the
> package contained eu2lmr.fd and eu2end.def so it need to be uploaded
> at the same time as euenc). Will, tell me when you're ready to
> upload euenc, I'll upload luainputenc too. Also, you can put my mail
> address in the README file, no problem.

I fixed a typo in the date (it was 2009 not 2010 allover the place), so
may be another upload is needed.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From elie.roux at telecom-bretagne.eu  Tue Feb 23 12:44:49 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Tue, 23 Feb 2010 13:44:49 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <20100223105545.GC4097@khaled-laptop>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
	 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
	 <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
	 <20100223101820.GB3206@khaled-laptop>
	 <eba574421002230225w1a8575c4r3e8d46494313d00d@mail.gmail.com>
	 <20100223105545.GC4097@khaled-laptop>
Message-ID: <eba574421002230344w7b73acb7na8667441227c7d07@mail.gmail.com>

2010/2/23 Khaled Hosny <khaledhosny at eglug.org>:
>
> Hmm, we can just have single lua module with tables for each font, but
> the question is: would such module be of interest to other packages
> hence qualifying for its own package, or we should just ship it with
> fontspec?

I guess it could be shipped with fontspec.

> And the scheme is?

The protrusions and expansion tables.

> Ah, then in the said module we can index fonts with their font names,
> then fontspec can select presets based on that or just load a generic
> default if non is present.

That's what I was thinking about.

Let's wait for Robert's answer and start to code.

Thank you,
-- 
Elie


From khaledhosny at eglug.org  Mon Feb 15 06:04:18 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 15 Feb 2010 07:04:18 +0200
Subject: [lltx] fontspec CTAN release
In-Reply-To: <0916FAE3-5660-44DC-8D47-2A7D6F9EB6E1@gmail.com>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>
 <20100213114623.GA2225@khaled-laptop>
 <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com>
 <20100214071713.GA2366@khaled-laptop>
 <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com>
 <20100214151907.GA2596@khaled-laptop>
 <0916FAE3-5660-44DC-8D47-2A7D6F9EB6E1@gmail.com>
Message-ID: <20100215050418.GA2356@khaled-laptop>

On Mon, Feb 15, 2010 at 10:20:04AM +1030, Will Robertson wrote:
> On 15/02/2010, at 1:49 AM, Khaled Hosny wrote:
> 
> > `luatex --luaonly luaotfload-fonts.lua` or `texlua luaotfload-fonts.lua`
> 
> Seems like I'll have to do some debugging for Mac OS X:
> 
> $ texlua luaotfload-fonts.lua
> 
> luaotfload | detecting system: unix
> luaotfload | executing `fc-cat -v'
> /usr/share/fonts: No such file or directory
> /Library/Fonts: No such file or directory
> /Network/Library/Fonts: No such file or directory
> /System/Library/Fonts: No such file or directory
> /opt/local/share/fonts: No such file or directory
> /Users/will/.fonts: No such file or directory
> /usr/X11R6/lib/X11/fonts/encodings: No such file or directory
> 
> luaotfload | Scanning directory /usr/local/texlive/2009/texmf-dist/fonts/opentype/public/inconsolataluaotfload-fonts.lua:98: table index is nil
Could you try my last commits (though I doubt there will be any
difference).
> 
> 
> 
> > AFAIK, no, but I didn't test your latest commits.
> 
> I think the current problem you're having is that fontspec is assuming
> for now that all fonts under LuaTeX will be external (at that stage I
> didn't think system fonts were feasible for us yet). Will investigate.

AFAIK, it doesn't. The following works for me just fine:

\documentclass{article}
\usepackage{fontspec}

\setmainfont{TeX Gyre Termes}

\begin{document}
Normal, \textbf{Bold}, \textit{Italic}, \textsc{Small Caps},
\textbf{\textit{Bold Italic}}, \textbf{\textsc{Bold Small Caps}}.
\end{document}

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.pdf
Type: application/pdf
Size: 10736 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100215/41fac6ee/attachment.pdf>

From wspr81 at gmail.com  Sat Feb 13 04:54:33 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 13 Feb 2010 14:24:33 +1030
Subject: [lltx] euenc upload and my broken luatex
Message-ID: <F9F9A6D7-BC1B-4CB5-A004-B551F0B20AA6@gmail.com>

Hi,

Just uploading the latest version of euenc now. 
Unfortunately I can't test LuaLaTeX functionality right now because I have suddenly started receiving fatal errors:

> This is LuaTeX, Version beta-0.40.6-2009100310 (TeX Live 2009)
>  \write18 enabled.
> (Fatal format file error; I'm stymied)


Hopefully things will sort themselves out :)

-- Will



From khaledhosny at eglug.org  Fri Feb 12 23:07:24 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 13 Feb 2010 00:07:24 +0200
Subject: [lltx] Re: microtypography
In-Reply-To: <4B75CA6A.3020907@telecom-bretagne.eu>
References: <4B75810C.8010600@telecom-bretagne.eu>
 <4B7586E0.10701@telecom-bretagne.eu>
 <4B758B83.2060507@elzevir.fr>
 <20100212173756.GA31553@khaled-laptop>
 <F07CE8C5-7F8F-4340-B3B7-C511FECB8C2E@gmail.com>
 <4B75CA6A.3020907@telecom-bretagne.eu>
Message-ID: <20100212220724.GA15637@khaled-laptop>

On Fri, Feb 12, 2010 at 11:38:50PM +0200, Elie Roux wrote:
> Will Robertson a ?crit :
> >AFAIK the current version of microtype already supports microtype?
> >Or is it only for non-OpenType fonts?
> 
> It is... and only for a set of them.
> 
> >If microtype is already working for LuaTeX I'd prefer to keep
> >separate packages, but if it makes things convenient then provide
> >an interface to microtype through fontspec itself.
> 
> Microtype is working for LuaTeX the same way it does with pdfTeX (a
> bit worse actually...), so all that happens in luaotfload is totally
> new and never worked before in microtype. As it's quite independant,
> I thought it would be good to separate it a bit from microtype...
> 
> But anyway, one of the goals of microtype is to store values of
> protrusion and expansion for different fonts, meaning that they are
> really fine tuned for these fonts, and I'm not sure this kind of
> things would belong to luaotfload or fontspec... I think luaotfload
> should provide an interface to pass these values to the algorithm,
> and that another package should provide them; but it could provide
> default values that could be activated automatically. Wdyt?

I myself would like to enable it by default, especially as I mainly set
Arabic text which doesn't have, yet, a powerful justification algorithm
in LuaTeX and benefits greatly from optical justification and expansion.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Tue Feb 23 11:55:45 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 23 Feb 2010 12:55:45 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <eba574421002230225w1a8575c4r3e8d46494313d00d@mail.gmail.com>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
 <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
 <20100223101820.GB3206@khaled-laptop>
 <eba574421002230225w1a8575c4r3e8d46494313d00d@mail.gmail.com>
Message-ID: <20100223105545.GC4097@khaled-laptop>

On Tue, Feb 23, 2010 at 12:25:40PM +0200, ?lie Roux wrote:
> 2010/2/23 Khaled Hosny <khaledhosny at eglug.org>:
> >
> > I still find the extra package unnecessary, what is the function of
> > luamicrotype packages besides switching microtypography on?
> 
> Containing fine tuned settings for some fonts.

Hmm, we can just have single lua module with tables for each font, but
the question is: would such module be of interest to other packages
hence qualifying for its own package, or we should just ship it with
fontspec?

> > I'm not sure what the callbacks you are suggesting are for.
> 
> The callbacks are to have an "auto" option (that would be default if
> fontspec is loaded with microtypographic option) that would look into
> a database of fine tuned settings and chose one for the font, instead
> of having to select something like \setmainfont[Protrusion=TeX Gyre
> Termes, Expansion =TeX Gyre Termes] {TeX Gyre Termes}, it would select
> the settings automatically... Wdyt?

Ah, then in the said module we can index fonts with their font names,
then fontspec can select presets based on that or just load a generic
default if non is present.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Fri Feb 26 09:31:53 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 26 Feb 2010 10:31:53 +0200
Subject: [lltx] Re: luamicrotype?
In-Reply-To: <4B842E29.8030608@telecom-bretagne.eu>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
 <4B842431.6010307@gmx.net>
 <4B842E29.8030608@telecom-bretagne.eu>
Message-ID: <20100226083153.GB6311@khaled-laptop>

On Tue, Feb 23, 2010 at 09:36:09PM +0200, Elie Roux wrote:
> Hello Robert,
> 
> thank you for your answer!
> 
> >You seem to be steering towards reinventing the wheel here (and
> >the axis, too).

Well, I confess, I've an ulterior motive; I want to get ride of as
legacy TeX macro code as possible, and to me microtype is nothing but a
pile of code written in a weired macro language that I'll never be able
to comprehend. So why tie ourselves with legacies, where all what we
need, to get microtype support in fontspec, is few tens of lines written
in an elegant, easy to understand programming language? (most of the
needed work is already done in luaotfload).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From wspr81 at gmail.com  Mon Feb 15 00:50:04 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 15 Feb 2010 10:20:04 +1030
Subject: [lltx] fontspec CTAN release
In-Reply-To: <20100214151907.GA2596@khaled-laptop>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com> <20100213114623.GA2225@khaled-laptop> <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com> <20100214071713.GA2366@khaled-laptop> <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com> <20100214151907.GA2596@khaled-laptop>
Message-ID: <0916FAE3-5660-44DC-8D47-2A7D6F9EB6E1@gmail.com>

On 15/02/2010, at 1:49 AM, Khaled Hosny wrote:

> `luatex --luaonly luaotfload-fonts.lua` or `texlua luaotfload-fonts.lua`

Seems like I'll have to do some debugging for Mac OS X:

$ texlua luaotfload-fonts.lua

luaotfload | detecting system: unix
luaotfload | executing `fc-cat -v'
/usr/share/fonts: No such file or directory
/Library/Fonts: No such file or directory
/Network/Library/Fonts: No such file or directory
/System/Library/Fonts: No such file or directory
/opt/local/share/fonts: No such file or directory
/Users/will/.fonts: No such file or directory
/usr/X11R6/lib/X11/fonts/encodings: No such file or directory

luaotfload | Scanning directory /usr/local/texlive/2009/texmf-dist/fonts/opentype/public/inconsolataluaotfload-fonts.lua:98: table index is nil



> AFAIK, no, but I didn't test your latest commits.

I think the current problem you're having is that fontspec is assuming for now that all fonts under LuaTeX will be external (at that stage I didn't think system fonts were feasible for us yet). Will investigate.

-- Will



From khaledhosny at eglug.org  Sat Feb 13 12:46:23 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 13 Feb 2010 13:46:23 +0200
Subject: [lltx] fontspec CTAN release
In-Reply-To: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>
Message-ID: <20100213114623.GA2225@khaled-laptop>

On Sat, Feb 13, 2010 at 05:54:09PM +1030, Will Robertson wrote:
> Hi all,
> 
> So obviously things have come up and I've dropped the ball a fair bit on
> (a) writing the documentation for fontspec and (b) fixing all its bugs.
> 
> So these can happen sooner rather than later, I'd like to establish a
> baseline feature set to work towards over the next little while. First
> of all, I guess: do you think we should aim to have cached fonts (i.e.,
> system fonts) available in LuaTeX? Or is that too variable at the moment
> depending on the setup of each user?

AFAIC, luaotfload can now load system fonts (which is different from
cached fonts that is yet to be implemented), currently the font
database generating script is too memory consuming (on my system with
~3000 fonts installed, it eats no less than 1GB of memory), luatex is
leaking memory here and this need to be fixed. What is missing is the
ability to launch the script from fontspec if no font database is
available or if the asked font is missing from the database, this
shouldn't be hard to implement, but I guess we can release fontspec 2.0
without it.

Cached fonts, on the other hand, are dumps of luatex's fontloader
returned font table so that it can be used by luaotfload without
reloading the font in later runs (faster font loading), the code already
support this but Hans disabled it in the released code (as it depends on
other parts of ConTeXt), I'm planning to check what is missing and
reactivate it if possible.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From mpg at elzevir.fr  Fri Feb 12 18:10:27 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Fri, 12 Feb 2010 18:10:27 +0100
Subject: [lltx] Re: microtypography
In-Reply-To: <4B7586E0.10701@telecom-bretagne.eu>
References: <4B75810C.8010600@telecom-bretagne.eu> <4B7586E0.10701@telecom-bretagne.eu>
Message-ID: <4B758B83.2060507@elzevir.fr>

Elie Roux a ?crit :
> Elie Roux a ?crit :
>> The question I wanted to ask is whether we should enable it by default
>> in luaotfload or not... Not so many people know what protrusion means,
>> but if they knew I'm sure 99% of them would want it, so it seems
>> logical for me to enable this kind of features by default, with of
>> course options to unactivate it. I don't really see any disadvantage,
>> except a different rendering between XeTeX and LuaTeX, which is not
>> really a disadvantage for me... What do you think?
> 
> Sorry to answer my mail, I just got an idea: if we don't enable
> microtypography by default, I think the best way to deal with it would
> be through a microtype-luatex package, that would be loaded by microtype
> and that would contain code to activate the features as well as the good
> data for some OTF fonts. If you agree can ask Robert Schlicht what he
> thinks about this solution... The reason I prefer a microtype-luatex
> than an integration into microtype is because I don't think Robert wants
> to deal with all the updates it will imply, and because I find the idea
> of having a package for unicode that doesn't have a big machinery for
> all 8-bit fonts attractive... Maybe we should find a better name... What
> do you think?
> 
I was precisely about to suggest that these features would be more naturally
integrated in microtype than in fontspec. Concerning the implementation details
(microtype-luatex vs direct integration in microtype), I have no opinion, but if
would be great to preserve the same user interface whenever it makes sense.

Manuel.


From elie.roux at telecom-bretagne.eu  Wed Feb 24 09:09:38 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Wed, 24 Feb 2010 10:09:38 +0200
Subject: [lltx] LuaTeX logo in metalogo
Message-ID: <eba574421002240009q30078501he70676bebba4b331@mail.gmail.com>

Hello,

currently the \LuaTeX  and \LuaLaTeX logo definition are in the
luatextra package, but metalogo looks like a much better place to make
it live. The definitions are actually extremely simple: \LuaTeX is
Lua\TeX and \LuaLaTeX is Lua\LaTeX. We took the convention of the
LuaTeX user manual
(http://www.luatex.org/svn/trunk/manual/luatexref-t.pdf) to write it.
Is it possible to add these logos in metalogo? Maybe an option to tune
the space between the a and the T of LuaTeX would be nice too, though
the aT option in metalogo is already used by LaTeX... so you see a
simple solution?

Please let me know when you'll upload a new version on CTAN so that I
upload a new version of luatextra the same day.

Thank you,
-- 
Elie


From khaledhosny at eglug.org  Tue Feb 23 11:18:20 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 23 Feb 2010 12:18:20 +0200
Subject: [lltx] luamicrotype?
In-Reply-To: <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
References: <eba574421002220403v85ec38fhd7b09c432ec6b92f@mail.gmail.com>
 <FFBB79D5-87A8-4AEC-A3A6-CA152EA3061B@gmail.com>
 <eba574421002222335l3cf6c4b4yed8735a3adb12e01@mail.gmail.com>
Message-ID: <20100223101820.GB3206@khaled-laptop>

On Tue, Feb 23, 2010 at 09:35:46AM +0200, ?lie Roux wrote:
> 2010/2/23 Will Robertson <wspr81 at gmail.com>:
> >
> > 1. font expansion and/or protrusion should be globally switchable, which
> > lends itself more to a package like microtype than for specific font
> > loading in fontspec
> 
> Agreed, but as fonts will be loaded with fontspec, luamicrotype (or
> whatever) will have to interact with it and fontspec will have to
> provide a way to load a font with microtypographic options...
> 
> > 2. if people go to the effort of creating and distributing protrusion
> > settings for different fonts, then they should be loaded by default --
> > although whether protrusion should be active or not should be entirely up
> > to the user
> 
> Agreed! What I imagined more precisely is this:
>  - the user loads luamicrotype
>  - luamicrotype sets \pdfprotrudechars2 \pdfadjustspacing2 and tells
> fontspec to have the default option Protrusion = Auto
>  - fontspec loads all new fonts with luaotfload with the option +protrusion=auto
>  - luaotfload, when it sees the 'auto' options calls a function (we
> can imagine something like callback.create) to retrieve the protrusion
> settings for the font, and luamicrotype provides it through this
> callback
> 
> What do you think about this?

I still find the extra package unnecessary, what is the function of
luamicrotype packages besides switching microtypography on? it can be
done some thing like:

\usepackage [Microtypography]{fontspec} % switch on microtypography
\setmainfont[
             Protrusion=Quality,        % user explicitly selects a preset
             Expansion =Quality,
	    ] {TeX Gyre Termes}
\setsansfont  {TeX Gyre Heros}          % otherwise 'default' preset is implied

I'm not sure what the callbacks you are suggesting are for.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Fri Feb 12 18:37:56 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 12 Feb 2010 19:37:56 +0200
Subject: [lltx] Re: microtypography
In-Reply-To: <4B758B83.2060507@elzevir.fr>
References: <4B75810C.8010600@telecom-bretagne.eu>
 <4B7586E0.10701@telecom-bretagne.eu>
 <4B758B83.2060507@elzevir.fr>
Message-ID: <20100212173756.GA31553@khaled-laptop>

On Fri, Feb 12, 2010 at 06:10:27PM +0100, Manuel P?gouri?-Gonnard wrote:
> Elie Roux a ?crit :
> > Elie Roux a ?crit :
> >> The question I wanted to ask is whether we should enable it by default
> >> in luaotfload or not... Not so many people know what protrusion means,
> >> but if they knew I'm sure 99% of them would want it, so it seems
> >> logical for me to enable this kind of features by default, with of
> >> course options to unactivate it. I don't really see any disadvantage,
> >> except a different rendering between XeTeX and LuaTeX, which is not
> >> really a disadvantage for me... What do you think?
> > 
> > Sorry to answer my mail, I just got an idea: if we don't enable
> > microtypography by default, I think the best way to deal with it would
> > be through a microtype-luatex package, that would be loaded by microtype
> > and that would contain code to activate the features as well as the good
> > data for some OTF fonts. If you agree can ask Robert Schlicht what he
> > thinks about this solution... The reason I prefer a microtype-luatex
> > than an integration into microtype is because I don't think Robert wants
> > to deal with all the updates it will imply, and because I find the idea
> > of having a package for unicode that doesn't have a big machinery for
> > all 8-bit fonts attractive... Maybe we should find a better name... What
> > do you think?
> > 
> I was precisely about to suggest that these features would be more naturally
> integrated in microtype than in fontspec. Concerning the implementation details
> (microtype-luatex vs direct integration in microtype), I have no opinion, but if
> would be great to preserve the same user interface whenever it makes sense.

I tend to disagree here, I find microtypography (at least protrusion)
very font specific and should be integrated with the font handling
package (fontspec here), I don't see the point of having a separate
package for just this font feature, except may be for compatibility with
pdflatex, but then the current microtype package does this already.

Expansion and protrusion, as currently implemented in luaotfload, are
font features and thus need to be enabled at font definition time and
thus naturally fall in fontspec area, doing it separately in any other
package will just make things unnecessary complex (if possible at all)
for no real gain. And there is OpenType "Opyical Bounds" feature
('opbd') which is used to set protrusion values which need to be
supported by luaotfload/fontspec anyway.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From wspr81 at gmail.com  Sat Feb  6 06:39:17 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 6 Feb 2010 16:09:17 +1030
Subject: [lltx] euenc: sed -E
In-Reply-To: <20100203195322.GQ22595@phare.normalesup.org>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com> <20100130054507.GB2773@khaled-laptop> <20100203195322.GQ22595@phare.normalesup.org>
Message-ID: <EA7E32D1-1BE4-4FF8-866A-BB3DACA5EF7B@gmail.com>

On 04/02/2010, at 6:23 AM, Arthur Reutenauer wrote:

>  As one who had the most stupid problems with BSD sed at work recently, and
> finally settled to install GNU sed because it was too much pain figthing with
> both variants over a tiny detail, I'd advocate that, too.

Bleah.
I never knew sed was so annoying.
Much better off switching to Lua in the future!

-- Will



From zappathustra at free.Fr  Mon Feb 15 13:39:08 2010
From: zappathustra at free.Fr (zappathustra)
Date: Mon, 15 Feb 2010 04:39:08 -0800 (PST)
Subject: [lltx] Microtypography... now the user asks questions.
Message-ID: <d8610afd-e6fd-4c29-95b2-eecb996d4892@l19g2000yqb.googlegroups.com>

Dear all,

Thank your very much for all your work here (with special thanks to
Elie who answered all my mails and set everything in motion, even
though he was asking something from me in the first place...).

I've tested font expansion with otf fonts, and I'm very happy that it
works. Now, I have some questions...

- First, how does font expansion enter TeX's paragraph building
algorithm? Does it play a role in badness calculation or does it come
for free? (\tracingparagraphs doesn't give any information). I.e., is
there a trade-off between space manipulation and character
manipulation? And are there restrictions on adjacent lines, e.g. a
fully stretched line can't be next to a fully shrunken one (talking
about glyph expansion, of course)?
- Second, what about letterspacing (once again for better
implementation)? I know the microtypography package is supposed to do
that, but I've not had the courage to look at the code yet, and I'm
not using LaTeX anyway...
- Third, I understand that the expansion factor is given by the
following table, which I manipulate with a little bit of \directlua:

fonts.expansions.setups['default'] = {

    stretch = 2, shrink = 2, step = .5, factor = 1,

    [byte('A')] = 0.5, [byte('B')] = 0.7, [byte('C')] = 0.7,
[byte('D')] = 0.5, [byte('E')] = 0.7,
    [byte('F')] = 0.7, [byte('G')] = 0.5, [byte('H')] = 0.7,
[byte('K')] = 0.7, [byte('M')] = 0.7,
    [byte('N')] = 0.7, [byte('O')] = 0.5, [byte('P')] = 0.7,
[byte('Q')] = 0.5, [byte('R')] = 0.7,
    [byte('S')] = 0.7, [byte('U')] = 0.7, [byte('W')] = 0.7,
[byte('Z')] = 0.7,
    [byte('a')] = 0.7, [byte('b')] = 0.7, [byte('c')] = 0.7,
[byte('d')] = 0.7, [byte('e')] = 0.7,
    [byte('g')] = 0.7, [byte('h')] = 0.7, [byte('k')] = 0.7,
[byte('m')] = 0.7, [byte('n')] = 0.7,
    [byte('o')] = 0.7, [byte('p')] = 0.7, [byte('q')] = 0.7,
[byte('s')] = 0.7, [byte('u')] = 0.7,
    [byte('w')] = 0.7, [byte('z')] = 0.7,
    [byte('2')] = 0.7, [byte('3')] = 0.7, [byte('6')] = 0.7,
[byte('8')] = 0.7, [byte('9')] = 0.7,
}

and I'd like to understand it. I suppose stretch and shrink are
percentages, and step is the increment. But what about factor?
Setting, say, factor=10, is a shorthand for stretch and shrink set to
20 and step to 5, or is there something else? Finally, what do the
values apparently associated with characters represent? I've set

[byte('a')] = 5

(a probably stupid value) and it produced overfull boxes absent
otherwise.

Once again, infinite thanks... We now have the best justifcation
engine, and that's cool!

Errrr, as an aside, I've already told this to Elie, but apparently
something went wrong. I use the latest version of LuaTeX (for
Windows), i.e. v.0.5, and setting \hsize still modify the page width
(if \pagewidth isn't specified).

Paul Isambert


From elie.roux at telecom-bretagne.eu  Fri Feb 12 17:25:48 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Fri, 12 Feb 2010 18:25:48 +0200
Subject: [lltx] microtypography
Message-ID: <4B75810C.8010600@telecom-bretagne.eu>

Hello,

Following a discussion with Paul Isambert, I asked Hans today about 
microtypography, and he released a new ConTeXt beta containing the 
necessary code for slanting, extending (we already had these), expansion 
and protrusion; and Khaled merged it in the git repository (see 
http://github.com/mpg/luaotfload/commit/fc4ceb016698207125b66ab35af1e306b117993c). 
This is a great milestone and I'm sure it will make more users use 
luaotfload, as XeTeX does not support microtypography.

Next job is to integrate it into fontspec, with a warning when activated 
under XeTeX?

The question I wanted to ask is whether we should enable it by default 
in luaotfload or not... Not so many people know what protrusion means, 
but if they knew I'm sure 99% of them would want it, so it seems logical 
for me to enable this kind of features by default, with of course 
options to unactivate it. I don't really see any disadvantage, except a 
different rendering between XeTeX and LuaTeX, which is not really a 
disadvantage for me... What do you think?

Thank you,
-- 
Elie


From elie.roux at telecom-bretagne.eu  Mon Feb 15 13:52:14 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Mon, 15 Feb 2010 14:52:14 +0200
Subject: [lltx] Microtypography... now the user asks questions.
In-Reply-To: <d8610afd-e6fd-4c29-95b2-eecb996d4892@l19g2000yqb.googlegroups.com>
References: <d8610afd-e6fd-4c29-95b2-eecb996d4892@l19g2000yqb.googlegroups.com>
Message-ID: <eba574421002150452n32321d69vf58e788997697a70@mail.gmail.com>

2010/2/15 zappathustra <zappathustra at free.fr>:
>
> Thank your very much for all your work here (with special thanks to
> Elie who answered all my mails and set everything in motion, even
> though he was asking something from me in the first place...).

I actually wrote absolutely no line of code for this, so you should
thank Hans (who is in copy) and Khaled for that!

> I've tested font expansion with otf fonts, and I'm very happy that it
> works. Now, I have some questions...
>
> - First, how does font expansion enter TeX's paragraph building
> algorithm? Does it play a role in badness calculation or does it come
> for free? (\tracingparagraphs doesn't give any information). I.e., is
> there a trade-off between space manipulation and character
> manipulation? And are there restrictions on adjacent lines, e.g. a
> fully stretched line can't be next to a fully shrunken one (talking
> about glyph expansion, of course)?

I think Hans is by far the best person to ask!

> - Second, what about letterspacing (once again for better
> implementation)? I know the microtypography package is supposed to do
> that, but I've not had the courage to look at the code yet, and I'm
> not using LaTeX anyway...
> - Third, I understand that the expansion factor is given by the
> following table, which I manipulate with a little bit of \directlua:
>
> fonts.expansions.setups['default'] = {
>
> ? ?stretch = 2, shrink = 2, step = .5, factor = 1,
>
> ? ?[byte('A')] = 0.5, [byte('B')] = 0.7, [byte('C')] = 0.7,
> [byte('D')] = 0.5, [byte('E')] = 0.7,
> ? ?[byte('F')] = 0.7, [byte('G')] = 0.5, [byte('H')] = 0.7,
> [byte('K')] = 0.7, [byte('M')] = 0.7,
> ? ?[byte('N')] = 0.7, [byte('O')] = 0.5, [byte('P')] = 0.7,
> [byte('Q')] = 0.5, [byte('R')] = 0.7,
> ? ?[byte('S')] = 0.7, [byte('U')] = 0.7, [byte('W')] = 0.7,
> [byte('Z')] = 0.7,
> ? ?[byte('a')] = 0.7, [byte('b')] = 0.7, [byte('c')] = 0.7,
> [byte('d')] = 0.7, [byte('e')] = 0.7,
> ? ?[byte('g')] = 0.7, [byte('h')] = 0.7, [byte('k')] = 0.7,
> [byte('m')] = 0.7, [byte('n')] = 0.7,
> ? ?[byte('o')] = 0.7, [byte('p')] = 0.7, [byte('q')] = 0.7,
> [byte('s')] = 0.7, [byte('u')] = 0.7,
> ? ?[byte('w')] = 0.7, [byte('z')] = 0.7,
> ? ?[byte('2')] = 0.7, [byte('3')] = 0.7, [byte('6')] = 0.7,
> [byte('8')] = 0.7, [byte('9')] = 0.7,
> }
>
> and I'd like to understand it. I suppose stretch and shrink are
> percentages, and step is the increment. But what about factor?
> Setting, say, factor=10, is a shorthand for stretch and shrink set to
> 20 and step to 5, or is there something else? Finally, what do the
> values apparently associated with characters represent? I've set
>
> [byte('a')] = 5
>
> (a probably stupid value) and it produced overfull boxes absent
> otherwise.

Once again, I think Hans will be the best person to answer you questions...

> Errrr, as an aside, I've already told this to Elie, but apparently
> something went wrong. I use the latest version of LuaTeX (for
> Windows), i.e. v.0.5, and setting \hsize still modify the page width
> (if \pagewidth isn't specified).

Can you provide a minimal plainTeX example that gives different
results under pdfTeX and LuaTeX?

Thank you,
-- 
Elie


From arthur.reutenauer at normalesup.org  Sat Feb  6 11:18:23 2010
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Sat, 6 Feb 2010 11:18:23 +0100
Subject: [lltx] euenc: sed -E
In-Reply-To: <EA7E32D1-1BE4-4FF8-866A-BB3DACA5EF7B@gmail.com>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com> <20100130054507.GB2773@khaled-laptop> <20100203195322.GQ22595@phare.normalesup.org> <EA7E32D1-1BE4-4FF8-866A-BB3DACA5EF7B@gmail.com>
Message-ID: <20100206101823.GC16147@phare.normalesup.org>

> I never knew sed was so annoying.

  Neither did I :-(

> Much better off switching to Lua in the future!

  Indeed :-)  Using gsub, etc.  Or even LPeg!

  In case you're interested, Will, since you're also on the Mac, the problem
was that I couldn't get Mac OS' sed (a BSD sed) to interpret the espace
sequence "\n" as a newline character...

	Arthur


From wspr81 at gmail.com  Sat Feb 13 11:58:03 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 13 Feb 2010 21:28:03 +1030
Subject: [lltx] euenc upload and my broken luatex
In-Reply-To: <4B767463.6060709@elzevir.fr>
References: <F9F9A6D7-BC1B-4CB5-A004-B551F0B20AA6@gmail.com> <4B767463.6060709@elzevir.fr>
Message-ID: <9DD456E7-4841-4D62-9ED1-D3C069A4CC1A@gmail.com>

On 13/02/2010, at 8:14 PM, Manuel P?gouri?-Gonnard wrote:

> fmtutil-sys --byengine luatex

Hey, whaddya know? :)
Thanks Manu, I obviously haven't been paying as much attention as I should have been.

-- Will



From khaledhosny at eglug.org  Sun Feb 14 16:19:07 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 14 Feb 2010 17:19:07 +0200
Subject: [lltx] fontspec CTAN release
In-Reply-To: <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com>
References: <A14161BE-F492-4FFF-96B9-66675B30C857@gmail.com>
 <20100213114623.GA2225@khaled-laptop>
 <C09C64D6-BFF7-4120-93E5-0CDE283A8B39@gmail.com>
 <20100214071713.GA2366@khaled-laptop>
 <EDAECE4D-D77E-4A47-A1E8-25E6209A8BF1@gmail.com>
Message-ID: <20100214151907.GA2596@khaled-laptop>

On Sun, Feb 14, 2010 at 06:41:42PM +1030, Will Robertson wrote:
> On 14/02/2010, at 5:47 PM, Khaled Hosny wrote:
> 
> > Yes, but we don't use that any more (it will not even work), instead one
> > can use the luaotfload-fonts.lua script from git, it'll generate and
> > install a font database with all the needed info (names, styles and
> > optical sizes).
> 
> Like this?  `luatex --lua luaotfload-fonts.lua`
> I get an error:
> 
> luaotfload-fonts.lua:127: attempt to index a nil value
> 
> Sorry if I'm being dense right now...

`luatex --luaonly luaotfload-fonts.lua` or `texlua luaotfload-fonts.lua`

 
> >> But until then something like this will still fail:
> >> 
> >>    \font\1="TeX Gyre Termes" at 10pt\1
> > 
> > And even \font\1="TeX Gyre Termes/B/S=10" (you can use any arbitrary
> > style name too, "DeJaVu Sans/ExtraLight").
> > 
> > This is already working, but not throughly tested (I did my best, but
> > with font names you can expect all weired things).
> 
> I didn't know you'd got so far with this already, well done.
> If this is actually working reasonably well, perhaps we can get it into
> fontspec straight away -- it will make documentation easier if both
> XeTeX and LuaTeX can access system fonts.

The current fontspec does work (assuming you've the font database).

> 
> >> I think the roadmap right now should be
> >> 
> >> 1. Release fontspec with LuaTeX support & only "external" fonts
> >> 2. Improve the tools in LuaLaTeX to access system fonts
> >> 3. Add system font support to fontspec
> 
> I've just pushed a few commits in fixing up stupid bugs of mine.
> I wish right now I had a test suite to check what's working and so on.
> 
> If this version actually works in terms of loading features and scripts
> and languages, besides the list on the Issues page are there any other
> bugs or missing features you're aware of at the moment?

AFAIK, no, but I didn't test your latest commits.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


