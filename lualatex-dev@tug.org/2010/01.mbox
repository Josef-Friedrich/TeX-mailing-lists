From mpg at elzevir.fr  Tue Jan 12 19:19:38 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Tue, 12 Jan 2010 19:19:38 +0100
Subject: [lltx] Font names database
In-Reply-To: <20100112180942.GA18074@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop>
Message-ID: <4B4CBD3A.5010407@elzevir.fr>

Khaled Hosny a ?crit :
> I'm working on a font names database generation script, it is capable of
> producing output similar to ConTeXt's 'simple' font names.
> 
Great.

> Now I'm wondering where, in TEXMF tree, should I store the database
> file? I thought $TEXMFVAR is a logical choice, but kpse seems not to be
> able to find files there, any idea?
> 
Files should be found here. How do you try? Does it work in another tree?

> [font names]
> Now which one should I pick? Any idea how Fontconfig and similar tools
> handle this? (since what they return is likely to be expected by users)
> 
I'm afraid I have no idea here.

Manuel.


From khaledhosny at eglug.org  Tue Jan 12 08:54:49 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 12 Jan 2010 09:54:49 +0200
Subject: [lltx] \luanewcommand?
In-Reply-To: <4B4BB005.1080502@elzevir.fr>
References: <20100111174435.GA11416@khaled-laptop>
 <4B4BB005.1080502@elzevir.fr>
Message-ID: <20100112075448.GA2167@khaled-laptop>

On Tue, Jan 12, 2010 at 12:11:01AM +0100, Manuel P?gouri?-Gonnard wrote:
> On 11/01/2010 18:44, Khaled Hosny wrote:
> > This would make lua feel more integrated (and it may take care of spaces
> > and catcodes etc. so we can use lua comment char '--' etc.)
> > 
> > What do you think?
> > 
> I like the idea, but i may need a bit more reflexion. I added it to my todolist
> for later. Obviously it would be a LaTeX-specific thing?

Yup, as long as \newcommand is a LaTeX-specific.


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100112/4a40a3b0/attachment.bin>

From khaledhosny at eglug.org  Mon Jan 11 13:41:03 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 11 Jan 2010 14:41:03 +0200
Subject: [lltx] luaextra
In-Reply-To: <eba574421001110434m7bdffde2v30eb10ac66ebbad@mail.gmail.com>
References: <20100110175957.GA11766@khaled-laptop>
 <4B4A3F73.6060804@telecom-bretagne.eu>
 <20100111112752.GA2828@khaled-laptop>
 <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>
 <20100111122621.GA3465@khaled-laptop>
 <eba574421001110434m7bdffde2v30eb10ac66ebbad@mail.gmail.com>
Message-ID: <20100111124103.GA3884@khaled-laptop>

On Mon, Jan 11, 2010 at 02:34:49PM +0200, ?lie Roux wrote:
> In fact luaextra is quite short compared to the l-*.lua files of
> ConTeXt, it contains only a minimal subset, so I think it can be
> loaded all at once, which is not really the case of the l-* files...
> What I was thinking was to ship the l-* files and to keep the minimal
> luaextra functions, but this will introduce code duplication... so
> maybe just shipping the l-* files and make luaextra load some of them
> with some modifications (I renamed a thing or two, it's written in the
> doc) would be OK... Wdyt?

Since ConTeXt's lua modules are quite generic, I'd rather try to keep
our copy 100% compatible for easy syncing etc. may be one day LuaTeX (or
some other macro package independent package) will ship them, but we can
add some aliases in luaextra for backward compatibility.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100111/f5c83155/attachment.bin>

From khaledhosny at eglug.org  Mon Jan 11 12:27:53 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 11 Jan 2010 13:27:53 +0200
Subject: [lltx] luaextra
In-Reply-To: <4B4A3F73.6060804@telecom-bretagne.eu>
References: <20100110175957.GA11766@khaled-laptop>
 <4B4A3F73.6060804@telecom-bretagne.eu>
Message-ID: <20100111112752.GA2828@khaled-laptop>

On Sun, Jan 10, 2010 at 10:58:27PM +0200, Elie Roux wrote:
> Khaled Hosny a ?crit :
> >I'm trying to use some luatextra functions in a lua script, but it fails
> >because it needs luatextra, but I'd like to have as less dependencies
> >(and loaded files) as possible.
> 
> Hello,
> 
> I must say I don't understand the part "I'm trying to use some
> luatextra functions, [...] but it fails because it needs luatextra",
> can you be more explicit ? Do you mean that luatextra.lua needs
> luatextra.sty? Or are you talking about luamcallbacks and luaextra?

My bad, that should have been "trying to use some luaextra" not
"luatextra".

> >So I was thinking it'd be better to have the lua libraries
> >separately (the original ConTeXt l-*.lua files, may be renamed to
> >luatextra-*.lua)
> >since each is essentially self contained, and make luatextra.lua just
> >load them for people who don't want to bother loading each separately.
> >
> >This might make the libraries more appealing for standalone lua
> >scripts.
> >
> >What do you think?
> 
> It sounds like a good idea! Although I think it would be necessary
> to write a small script to load ConTeXt modules (to load them only
> once, to write the name to the log file, etc.)...

I don't get this, sorry.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100111/61b2c981/attachment.bin>

From elie.roux at telecom-bretagne.eu  Fri Jan  8 10:27:53 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Fri, 8 Jan 2010 11:27:53 +0200
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <20100108092417.GA19534@khaled-laptop>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
	 <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
	 <eba574421001072301y51c27e35v90347c9a94cfe175@mail.gmail.com>
	 <20100108070452.GA16882@khaled-laptop>
	 <20100108085310.GB30199@phare.normalesup.org>
	 <20100108092417.GA19534@khaled-laptop>
Message-ID: <eba574421001080127x7b54b534x79ec30b613899c9b@mail.gmail.com>

2010/1/8 Khaled Hosny <khaledhosny at eglug.org>:
>
> I usually try to be more specific before reporting bugs, or even try to
> fix it myself (I learn good stuff this way ;), but I give up, debugging
> tex macros just blows my head.

Good to know I'm not the only one ;-)

> Reported as http://tracker.luatex.org/view.php?id=315 with a smaller
> test file (still docstrip though).

I think it's a problem with the arguments of the \openout primitive,
but it's pretty hard to isolate it from the code...

Thank you!
-- 
Elie


From elie.roux at telecom-bretagne.eu  Fri Jan  8 08:01:20 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Fri, 8 Jan 2010 09:01:20 +0200
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
	 <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
Message-ID: <eba574421001072301y51c27e35v90347c9a94cfe175@mail.gmail.com>

2010/1/8 Will Robertson <wspr81 at gmail.com>:
>
> It works for me with MacTeX 2009... are you using a different LuaTeX than me?:
>
>> This is LuaTeX, Version beta-0.40.6-2009111822 (TeX Live 2009)

I have the 0.50 version, and I think some changes in the file name
handling made it in the 0.45...

Thank you!
-- 
Elie


From firmicus at gmx.net  Thu Jan 14 18:06:58 2010
From: firmicus at gmx.net (=?ISO-8859-1?Q?Fran=E7ois_Charette?=)
Date: Thu, 14 Jan 2010 09:06:58 -0800 (PST)
Subject: [lltx] Re: A new Babel?
In-Reply-To: <eba574421001140137i78ae8f32s8f7c2052e85caec1@mail.gmail.com>
References: <eba574421001140137i78ae8f32s8f7c2052e85caec1@mail.gmail.com>
Message-ID: <edafd55a-6757-4542-97eb-32cdab1c9fd2@j5g2000yqm.googlegroups.com>

Thanks Elie for this post. As the author of polyglossia I will add a
few notices below from my perspective, and will leave the lualatex
aspects of the discussions to others.

On Jan 14, 10:37?am, ?lie Roux <elie.r... at telecom-bretagne.eu> wrote:
> Hello,
>
> recently I got interested in polyglossia and had interesting
> discussions with Fran?ois Charette. The reasons I got interested in
> polyglossia were:
> ?- having (the very romanian) ? instead of (the very turkish) ? in
> romanian titles, which is not possible in standard 8-bit TeX (and I
> don't really like tricky TeX patches)
> ?- having a modern Unicode+OTF solution without all the 8-bit+T1 heavy machinery
>
> The discussions I had with Fran?ois were on these topics:
> ?- is it possible to adapt polyglossia to LuaTeX? currently it uses
> things like \XeTeXintercharclass that are not accessible in LuaTeX.
> This means we have two choices: (a) adapt \XeTeXintercharclass and
> stuff to LuaTeX, which would be quite funny, (b) copy-paste bunches of
> code from Babel with active characters.
> ?- why isn't it possible in polyglossia to have some features from
> babel (especially in french) like modification of the shape of the
> lists, of the indentation, etc. that are really mandatory for me
> (english typography is so awful when you're used to french one). The
> answer is: "it's on the TODO list"

Just a side-note: when I initiated polyglossia, I had expected that
the "xelatex community" would actually develop and improve the various
language modules.. I have received a number of corrections for various
languages over the year, but funnily, none at all for French and very
few for German, two languages with a large user base. If someone had
nagged me to improve the french module, I would certainly have devoted
more time to it :) Overall the contribution from the community has
been rather limited (with the exception of some important bugfixes and
stylistic improvements sent by Enrico Gregorio, the author of the
Italian module for Babel). One way to improve this situation, perhaps,
would be to create a more abstract user-interface for setting up the
most common bells and whistles that are found in most gloss-*.ldf
files (i.e. hyphenation pattern + hyphenmins, name of language, script
and direction, captions and date, settings for frenchindent and
frenchspacing, etc. Hypotherical example:

\PolyglossiaSetup{<lang>}{%
   Script=Latin, %default=Latin
   Direction=LTR, %default=LTR
%   LanguageString=<lang>, %default=<lang>
%   Aliases={Foo,Bar},
   hyphenmins={x,y} %default={2,2} ?  {2,3} in babel...
   frenchspacing=true, %default=false
   frenchindent=true %default=false
   }

That would make it much easier for average users to customize
polyglossia...

> I'd like to know what you think about a new babel. First you can read
> the discussions on the XeTeX list that lead to the birth of
> polyglossia:http://www.tug.org/pipermail/xetex/2007-April/thread.html
> in the thread "[XeTeX] "new-babel", was: Ancient Greek hyphenation".
> The README is also useful to see the functionalities:http://mirror.unl.edu/ctan/macros/xetex/latex/polyglossia/README.
> These readings are really interesting and hard to sum up, but the main
> open points are:
>
> ?(1) should it set a font for each language or just set the language
> option in the current font:
> ? ? - for french and german, the same font can obviously be used
> ? ? - for arabic and japanese obviously not, so for close languages it
> shoudn't be changed, when it should be for far languages... but what
> is the limit... should we make groups of languages?
> ? ? - for german and polish the ligatures are not the same even though
> the languages are close, do all the fonts change the ligatures
> according to the language option?
> ? ? - I must say I have no preference for this... except that we
> should allow the user to do whatever he want by providing the good
> macros.

FWIW, my approach has been to assume that, when switching to a new
language, the same font is kept, unless \<lang>font or \<script>font
has been explicitly defined.

>
> (2) should it include typographic rules or should they be in another
> package? in a different file? For me it should as an option, activated
> by default.
>
> (3) Is all the babel machinery included in Unicode+OTF? Do we still
> need active characters and things like that? I think we still need
> some active characters for some languages, or to implement the \XeTeX
> machinery... but I think the babel active characters have been more
> tested and work in more cases.

Yes, active characters are needed in German, Dutch and some other
languages to fine-tune various aspects of hyphenation, etc. See page 8
of the documentation (latest version of polyglossia.pdf).

I have recently imported the relevant code for active characters from
babel into polyglossia:
http://github.com/fc7/polyglossia/blob/master/tex/babelsh.def
It is currently only used for German, but they should also become
available for Dutch (hopefully in the next version I shall upload to
CTAN).

> (4 - not discussed on the XeTeX list) how far should it be from babel?
> I was thinking about loading the babel files and then overriding the
> translated strings to Unicode, so that we have the same result as
> babel... This is a point that would need further inquiries for me. But
> we shouldn't forget that some language files change very often
> (frenchb for example, which often breaks backward compatibility), and
> maybe we should be aligned with babel to confuse less users...

Following the brain-storming we had on the xetex list in 2007, I
decided against this and chose to use antomega as a starting point for
polyglossia, and later added a bunch of additional modules based on
the ones from Babel. The problem, obviously, is that those have been
updated since then, and it's hard to keep in sync. One solution would
be to have common files for use by babel, polyglossia (and potentially
other packages), in which things such as caption strings are set. And
these should of course include both the Babel representation and the
UTF-8 strings side-by-side. I am not sure the Babel people would
welcome this idea with joy, but it is certainly worth a try :)

> Even though Will has already participated in the XeTeX discussions,
> I'd like to have your opinions on these topics. The main reason is
> that Fran?ois gives up polyglossia and proposed me to take the
> leadership on the package, allowing me to change a lot of things... If
> we manage to agree on something I'll move the discussion to a wider
> range, including the babel team, and the luatex and xetex
> mailing-lists.

As I wrote to Elie, I am no longer able to properly maintain
polyglossia, and I am very happy he has accepted to take it over!

Best regards to all,
FC


From elie.roux at telecom-bretagne.eu  Sat Jan 30 07:53:36 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Sat, 30 Jan 2010 08:53:36 +0200
Subject: [lltx] euenc: sed -E
In-Reply-To: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com>
Message-ID: <4B63D770.7080907@telecom-bretagne.eu>

Will Robertson a ?crit :
> Hi Khaled and Elie,
>
> The scripts are broken on my machine because anything with [...]+ has been turned into [...]\+, which doesn't seem to work in my version of sed (Mac OS X 10.6). I've changed it into [...]\{1,\} which is ugly but at least works.
>
> I can't remember if I used + instead of * because of a reason in particular or just because I thought it was a safer choice at the time.
>   

Hi,

all these tools are freaking crappy sometimes... they are really 
non-standards and differents on all platforms...  I tested under GNU and 
cygwin (the versions are different, and it certainly is different under 
BSD too) and it worked (which was not the case with the -E option which 
was not recognized). Maybe it would be best to change '\+' to '*' which 
seems more widespread? The result will be the same, I don't think the 
t1lm*.fd files will change a lot...

Thank you,
-- 
Elie


From khaledhosny at eglug.org  Sat Jan 30 14:31:34 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 30 Jan 2010 15:31:34 +0200
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>
 <20100130053701.GA2773@khaled-laptop>
 <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>
Message-ID: <20100130133134.GA6540@khaled-laptop>

On Sat, Jan 30, 2010 at 04:09:42PM +1030, Will Robertson wrote:
> On 30/01/2010, at 4:07 PM, Khaled Hosny wrote:
> 
> > This might need a deeper luaotfload changes, which will be a significant
> > deviate from ConTeXt codebase, which I'm reluctant to do, not before it
> > is considered stable at least.
> 
> No worries.
> This is definitely a good reason to want to use fontspec, instead, then!

It turned out to be fairly easy to implement it in ad hock way without
messing with OpenType layout code internals, pushed to githup, please
test.

Regards,
 Khaled 

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Wed Jan 13 18:27:58 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 13 Jan 2010 19:27:58 +0200
Subject: [lltx] Font names database
In-Reply-To: <5765725A-7FB5-4F28-9918-F5A55DEADD50@gmail.com>
References: <20100112180942.GA18074@khaled-laptop>
 <5765725A-7FB5-4F28-9918-F5A55DEADD50@gmail.com>
Message-ID: <20100113172758.GC3609@khaled-laptop>

On Wed, Jan 13, 2010 at 03:41:29PM +1030, Will Robertson wrote:
> On 13/01/2010, at 4:39 AM, Khaled Hosny wrote:
> All I know is that XeTeX is fairly forgiving about which fontname is
> used. Looks to me as if fullname, fontname, and names.compatfull would
> be the important (i.e., unique) ones.

Right, I found that it accepts both fullname and names.preffamilyname
(with /B etc.)

> By the way, I've been meaning to ask: does ConTeXt (or, now, your
> script) make it possible to auto-detect italic and bold shapes?

Last time I checked ConTeXt didn't, but I see now it has code to detect
font weight and style, but no idea how it is used. It is on my todo list
however (this one of the reasons I'm working on that names database.)

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From wspr81 at gmail.com  Wed Jan 13 06:11:29 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Wed, 13 Jan 2010 15:41:29 +1030
Subject: [lltx] Font names database
In-Reply-To: <20100112180942.GA18074@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop>
Message-ID: <5765725A-7FB5-4F28-9918-F5A55DEADD50@gmail.com>

On 13/01/2010, at 4:39 AM, Khaled Hosny wrote:

> I'm working on a font names database generation script, it is capable of
> producing output similar to ConTeXt's 'simple' font names.


Thanks, this is probably a good idea. I installed the ConTeXt minimals to get this working but that screwed up a couple of things such as texdoc and kpsewhich.


> The main problem now is which font names should we index, currently we
> simply take the 'fullname' as returned by fontloader, but things is isn't
> that simple! There is a hell of different font names stored in the font;
> fontname, fullname, familyname, and identical enteries in TTF names
> table, which in turn have different copies for mac and windows! And
> kindly enough, font designers have taken the liberty to have different
> names in each set. Take LM roman regular as an example:
> 
> fullname: LMRoman10-Regular
> fontname: LMRoman10-Regular
> familyname: LMRoman10
> names.compatfull: LM Roman 10 Regular
> names.family: LM Roman 10
> names.preffamilyname: Latin Modern Roman
> names.prefmodifiers: 10 Regular
> fontstyle_name: Regular


All I know is that XeTeX is fairly forgiving about which fontname is used. Looks to me as if fullname, fontname, and names.compatfull would be the important (i.e., unique) ones.

By the way, I've been meaning to ask: does ConTeXt (or, now, your script) make it possible to auto-detect italic and bold shapes?

-- Will



From mpg at elzevir.fr  Wed Jan 20 19:22:31 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Wed, 20 Jan 2010 19:22:31 +0100
Subject: [lltx] luatexbase
In-Reply-To: <20100120175448.GA5811@khaled-laptop>
References: <4B4DAE0A.6060001@elzevir.fr> <20100120175448.GA5811@khaled-laptop>
Message-ID: <4B5749E7.9050802@elzevir.fr>

Hi,

Khaled Hosny a ?crit :
> I think the splitting is a good idea,

I'm glad you approve. Btw, I've had very few time to work on it recently, but I
plan to be quite active on it in the weeks coming.

> I'd like to move luaextra to
> luatexbase too (unless stability is a concern, then it should live in
> its own package),

I was thinking about it too, and I would prefer a separate package, so that in
the long run luatexbase can become very stable.

> and kill luatextra completely and move document
> specific parts to xltxtra. I think unifying XeTeX and LuaTeX specific
> packages would allow smoother user experience, and better
> maintainability.

In the long run, it's probably a good idea, but I'm afraid it's a bit too early
to do this. For example, the version of fontspec supporting LuaTeX is not
release to CTAN, hence widely tested, yet, unless I'm mistaken.

I think (quite strongly) that we should avoid anticipating to much, so that we
(and users) can build confidence in the lualatex packages. and more generally
LaTeX on LuaTeX. IMO, XeLaTeX is quite more mature right now.

> The name might be subobtimal, may be we can rename
> xltxtra to ultxtra (u for Unicode), or even get a better name (I always
> mistype xltxtra!) and make xltxtra.sty a small wrapper for backward
> compatibility. Will, what do you think?
> 
While talking names, I'm always troubled that luaextra and luatextra have so
similar names (only one letter difference, and similar pronouncation). I was
thinking about renaming luaTextra to lltxtra, since it's a xltxtra but for
luatex. Arguably, it's also only one letter different from an existing package,
but since you can't pronouce either name, the letter is more prominent (and this
similarity makes a lot of sense since the packages may be merged later).

Manuel.



From wspr81 at gmail.com  Fri Jan 22 07:20:51 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 22 Jan 2010 16:50:51 +1030
Subject: [lltx] Re: xltxtra+luatex
In-Reply-To: <20100120222357.GA10005@khaled-laptop>
References: <20100120222357.GA10005@khaled-laptop>
Message-ID: <06BA4FA7-8E6E-444D-A925-8A0EE2A0EEB0@gmail.com>

Replying from an offlist message from Khaled:

On 21/01/2010, at 8:53 AM, Khaled Hosny wrote:

> I did some work tonight adding luatex support to xltxtra, and it seems
> to be functioning. If it is OK with you, please add me to the repo so I
> can push it (patches attached for review).

In light of the recent discussions here I think for now it's best if we create a new package based on xltxtra (but maybe skipping a couple of its more useless features) that supports both XeTeX and LuaTeX. Then deprecate xltxtra as the "XeTeX-only" original. 

What do you all think?

To be honest, I'm not even sure if we need xltxtra (or analogous) any more. I suggest we enumerate its features and then decide which of them are really necessary -- it may end up that stuff like OpenType superiors for \textsuperscript/\textsubscript deserve their own mini-packages and the rest can be ignored. The more I think about this idea the more I like it -- there have been more issues raised than solved, I think, by lumping in various LaTeX changes into a single package when conflicts have occurred.

Oh, and we should also get a version of the LuaTeX logo incorporated into metalogo. I'll message Andrew Moschou about it.

-- Will



From wspr81 at gmail.com  Fri Jan 22 07:25:31 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 22 Jan 2010 16:55:31 +1030
Subject: [lltx] luatexbase
In-Reply-To: <4B576D67.8080508@elzevir.fr>
References: <4B4DAE0A.6060001@elzevir.fr> <20100120175448.GA5811@khaled-laptop> <4B5749E7.9050802@elzevir.fr> <20100120202138.GA7969@khaled-laptop> <4B576D67.8080508@elzevir.fr>
Message-ID: <C6AF5F00-831F-46E3-8498-89762BBD7364@gmail.com>

On 21/01/2010, at 7:23 AM, Manuel P?gouri?-Gonnard wrote:

>> Right, mostly because luaotfload isn't done enough yet. Once we manage
>> to properly implement a font names database, LuaTeX part of Fontspec 2.0
>> should be almost done, bugs aside, but then I doubt we will be able to
>> upload to CTAN since it is unlikely to work with LuaTeX in TeXlive.
>> 
> Well, sorry for being the "pessimistic" guy again, but "bugs aside" can be quite
> a big restriction, and I'm afraid we can expect surpises when people start
> trying it on various systems with various fonts, doing various weird things :-)

Especially when the one supposed to be fixing the bugs goes mysteriously missing inside his own head for days/weeks on end!

Seriously, I hope this weekend will bring some attention of mine back to fontspec...

-- Will



From wspr81 at gmail.com  Sat Jan 30 06:39:42 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 30 Jan 2010 16:09:42 +1030
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <20100130053701.GA2773@khaled-laptop>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com> <20100130053701.GA2773@khaled-laptop>
Message-ID: <39377CC2-0B9A-41DE-9C22-D702E12762D1@gmail.com>

On 30/01/2010, at 4:07 PM, Khaled Hosny wrote:

> This might need a deeper luaotfload changes, which will be a significant
> deviate from ConTeXt codebase, which I'm reluctant to do, not before it
> is considered stable at least.

No worries.
This is definitely a good reason to want to use fontspec, instead, then!

-- Will



From khaledhosny at eglug.org  Fri Jan 22 12:18:17 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 22 Jan 2010 13:18:17 +0200
Subject: [lltx] luatexbase
In-Reply-To: <4B597E36.8080201@elzevir.fr>
References: <4B4DAE0A.6060001@elzevir.fr>
 <20100120175448.GA5811@khaled-laptop>
 <4B5749E7.9050802@elzevir.fr>
 <20100120202138.GA7969@khaled-laptop>
 <4B576D67.8080508@elzevir.fr>
 <20100122064130.GA3700@khaled-laptop>
 <4B597E36.8080201@elzevir.fr>
Message-ID: <20100122111817.GA16583@khaled-laptop>

On Fri, Jan 22, 2010 at 11:30:14AM +0100, Manuel P?gouri?-Gonnard wrote:
> Khaled Hosny a ?crit :
> > That was actually the point, it should load the relevant packages
> > according to the engine used, though I'm still not sure if it is a good
> > idea; we don't want to get limited by XeTeX (being the least common
> > denominator here, flexibility wise). I think Fran?ois's modern-latex is
> > much better, if we decided to go one common package for different
> > engines route.
> > 
> I tend to like modern-latex indeed. The only drawback with this kind of name is,
> in 15 years, when LuaTeX has been the standard for years and some other
> bleeding-edge engine is under heavy development, "modern" will sound weird :-)
> But I don't think we need to worry a lot about this, since latex3 will be
> finished in the meanwhile and offer built-in support for modern engines, right ? ;-)

And STIX fonts will be released :P

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Tue Jan 12 19:28:17 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 12 Jan 2010 20:28:17 +0200
Subject: [lltx] Font names database
In-Reply-To: <4B4CBD3A.5010407@elzevir.fr>
References: <20100112180942.GA18074@khaled-laptop>
 <4B4CBD3A.5010407@elzevir.fr>
Message-ID: <20100112182817.GA18243@khaled-laptop>

On Tue, Jan 12, 2010 at 07:19:38PM +0100, Manuel P?gouri?-Gonnard wrote:
> Khaled Hosny a ?crit :
> > I'm working on a font names database generation script, it is capable of
> > producing output similar to ConTeXt's 'simple' font names.
> > 
> Great.
> 
> > Now I'm wondering where, in TEXMF tree, should I store the database
> > file? I thought $TEXMFVAR is a logical choice, but kpse seems not to be
> > able to find files there, any idea?
> > 
> Files should be found here. How do you try? Does it work in another tree?

Ah, I see now, I should but it under $TEXMFVAR/tex not $TEXMFVAR
directly, solved now.

> 
> > [font names]
> > Now which one should I pick? Any idea how Fontconfig and similar tools
> > handle this? (since what they return is likely to be expected by users)
> > 
> I'm afraid I have no idea here.

I think I've to reverse engineer fontconfig here, since it hardly has any
useful documentation.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100112/b587b913/attachment.bin>

From khaledhosny at eglug.org  Tue Jan 12 08:54:49 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 12 Jan 2010 09:54:49 +0200
Subject: [lltx] \luanewcommand?
In-Reply-To: <4B4BB005.1080502@elzevir.fr>
References: <20100111174435.GA11416@khaled-laptop>
 <4B4BB005.1080502@elzevir.fr>
Message-ID: <20100112075448.GA2167@khaled-laptop>

On Tue, Jan 12, 2010 at 12:11:01AM +0100, Manuel P?gouri?-Gonnard wrote:
> On 11/01/2010 18:44, Khaled Hosny wrote:
> > This would make lua feel more integrated (and it may take care of spaces
> > and catcodes etc. so we can use lua comment char '--' etc.)
> > 
> > What do you think?
> > 
> I like the idea, but i may need a bit more reflexion. I added it to my todolist
> for later. Obviously it would be a LaTeX-specific thing?

Yup, as long as \newcommand is a LaTeX-specific.


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100112/4a40a3b0/attachment-0001.bin>

From wspr81 at gmail.com  Mon Jan 18 00:43:03 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 18 Jan 2010 10:13:03 +1030
Subject: [lltx] Makefiles
In-Reply-To: <20100117093439.GA9514@khaled-laptop>
References: <20100117093439.GA9514@khaled-laptop>
Message-ID: <AFDC5715-F3BA-42B0-9BAE-CCF9DD09BEAA@gmail.com>

On 17/01/2010, at 8:04 PM, Khaled Hosny wrote:

> I'd appreciate if someone can help writing makefiles for euenc and
> fontspec, trying to understand makefiles and docstrip at once is mind
> blowing :)

Sure, I can probably copy over what I'm using for unicode-math.
What exactly do you want them to do?

-- Will



From elie.roux at telecom-bretagne.eu  Mon Jan 11 13:47:30 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Mon, 11 Jan 2010 14:47:30 +0200
Subject: [lltx] luaextra
In-Reply-To: <20100111124103.GA3884@khaled-laptop>
References: <20100110175957.GA11766@khaled-laptop>
	 <4B4A3F73.6060804@telecom-bretagne.eu>
	 <20100111112752.GA2828@khaled-laptop>
	 <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>
	 <20100111122621.GA3465@khaled-laptop>
	 <eba574421001110434m7bdffde2v30eb10ac66ebbad@mail.gmail.com>
	 <20100111124103.GA3884@khaled-laptop>
Message-ID: <eba574421001110447q7f3e8513je635fb47f47d1d13@mail.gmail.com>

2010/1/11 Khaled Hosny <khaledhosny at eglug.org>:
>
> Since ConTeXt's lua modules are quite generic, I'd rather try to keep
> our copy 100% compatible for easy syncing etc. may be one day LuaTeX (or
> some other macro package independent package) will ship them, but we can
> add some aliases in luaextra for backward compatibility.

Sure, I just aliased file to fpath (because all the file. functions
are actually working on path...), and renamed file.is_readable in
lfs.is_readable which seem more accurate... but it's no important
changes...

So do you think luaextra should load like l-table, l-string, l-file
and l-math, and that we also ship the other files, for people who want
to use them? This would be OK for me... Manuel, can you give the
rights on the git rep to Khaled?

Thank you,
-- 
Elie


From elie.roux at telecom-bretagne.eu  Mon Jan 11 12:51:39 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Mon, 11 Jan 2010 13:51:39 +0200
Subject: [lltx] luaextra
In-Reply-To: <20100111112752.GA2828@khaled-laptop>
References: <20100110175957.GA11766@khaled-laptop>
	 <4B4A3F73.6060804@telecom-bretagne.eu>
	 <20100111112752.GA2828@khaled-laptop>
Message-ID: <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>

2010/1/11 Khaled Hosny <khaledhosny at eglug.org>:
> On Sun, Jan 10, 2010 at 10:58:27PM +0200, Elie Roux wrote:
>> Khaled Hosny a ?crit :
>> >I'm trying to use some luatextra functions in a lua script, but it fails
>> >because it needs luatextra, but I'd like to have as less dependencies
>> >(and loaded files) as possible.
>>
>> Hello,
>>
>> I must say I don't understand the part "I'm trying to use some
>> luatextra functions, [...] but it fails because it needs luatextra",
>> can you be more explicit ? Do you mean that luatextra.lua needs
>> luatextra.sty? Or are you talking about luamcallbacks and luaextra?
>
> My bad, that should have been "trying to use some luaextra" not
> "luatextra".

Oh ok, I see much better now... I think we should replace

    luatextra.provides_module(luatextra_module)

by

    if luatextra then
        luatextra.provides_module(luatextra_module)
    end

I'm going to push this now...

BTW, is the table printing function working ok for you? I always have
some strange newlines where there shouldn't be...

But anyway, I think having the ConTeXt libraries easily loadable
without ConTeXt by duplicating them would be a good idea...

Thank you!
-- 
Elie


From khaledhosny at eglug.org  Fri Jan  8 08:04:52 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 8 Jan 2010 09:04:52 +0200
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <eba574421001072301y51c27e35v90347c9a94cfe175@mail.gmail.com>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
 <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
 <eba574421001072301y51c27e35v90347c9a94cfe175@mail.gmail.com>
Message-ID: <20100108070452.GA16882@khaled-laptop>

On Fri, Jan 08, 2010 at 09:01:20AM +0200, ?lie Roux wrote:
> 2010/1/8 Will Robertson <wspr81 at gmail.com>:
> >
> > It works for me with MacTeX 2009... are you using a different LuaTeX than me?:
> >
> >> This is LuaTeX, Version beta-0.40.6-2009111822 (TeX Live 2009)
> 
> I have the 0.50 version, and I think some changes in the file name
> handling made it in the 0.45...

Actually, it have been broken with svn revision 3217; the first broken
release is 0.47.0

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100108/098b9b9d/attachment.bin>

From elie.roux at telecom-bretagne.eu  Thu Jan  7 21:09:53 2010
From: elie.roux at telecom-bretagne.eu (Elie)
Date: Thu, 7 Jan 2010 12:09:53 -0800 (PST)
Subject: [lltx] bug in docstrip with lualatex
Message-ID: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>

Hello,

Let's inaugurate this group, thank you Will for opening it!

I hope I'm not too off-topic here, but it's just that I didn't know
where to ask... I just tried to compile euenc.dtx (from
http://github.com/khaledhosny/euenc) with lualatex and it failed. I
think the error comes from the file name handling in LuaTeX which is
quite different from the one of pdfTeX. I managed to create a minimal
example: http://norgz.guiling.fr/ecm.dtx ; you can compile with
pdflatex without any problem, but the compilation with lualatex fails,
saying there is an error on the file name.

I'd like to create a real minimal example in Plain to report it on the
LuaTeX mailing-list, but docstrip is really tricky... so if one of you
know docstrip or know who to ask such a thing (the maintainers seem to
be the LaTeX3 project members who certainly have other fishes to
fry...), it would be welcome!

Thank you!
--
Elie


From wspr81 at gmail.com  Sat Jan 30 05:55:27 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 30 Jan 2010 15:25:27 +1030
Subject: [lltx] euenc: sed -E
Message-ID: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com>

Hi Khaled and Elie,

The scripts are broken on my machine because anything with [...]+ has been turned into [...]\+, which doesn't seem to work in my version of sed (Mac OS X 10.6). I've changed it into [...]\{1,\} which is ugly but at least works.

I can't remember if I used + instead of * because of a reason in particular or just because I thought it was a safer choice at the time.

Damned regexp.

-- Will



From mpg at elzevir.fr  Wed Jan 13 12:27:06 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Wed, 13 Jan 2010 12:27:06 +0100
Subject: [lltx] luatexbase
Message-ID: <4B4DAE0A.6060001@elzevir.fr>

FYI,

As mentioned in a previous message, I am splitting luatextra in two parts:

- luatexbase for basic resource handling (registers, catcodetables, attributes,
lua modules, callbacks) and maybe later I'll add compatibility stuff (such as
names of primitives)

- luatextra, with luaextra, the logos, goodies for LaTeX (currently the luacode
environment, later \newluacommand as suggested by Khaled, etc.)

There is a new repo for luatexbase, and the splitting out is happening in the
base-out branch of luatextra. Until I announce otherwise, you should assume
luatebase/master and luatextra/base-out are broken :-) I made them public just
so that everybody can see what's happening, they are currently not for use.

My mid-term goal is that luatexbase becomes the standard package that every
lua(la)tex programmer can load without thinking. It means it should become quite
stable soon. Before this happens, I'd like to make a few changes to some parts.
(I'll warn if I want to make incompatible changes during this period.)

More importantly, at some point I want to discuss with Heiko about his
luatex.sty package, which is mostly redundant with luatexbase. It is obviously
highly undesirable to have two concurrent packages for resource allocation. I'll
try study carefully the differences between those two packages (and probably
clean up the code of luatexbase on my way) before I start this discussion.

Manuel.


From khaledhosny at eglug.org  Sat Jan 30 08:23:48 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 30 Jan 2010 09:23:48 +0200
Subject: [lltx] euenc: sed -E
In-Reply-To: <4B63DA17.3070102@telecom-bretagne.eu>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com>
 <4B63D770.7080907@telecom-bretagne.eu>
 <4B63DA17.3070102@telecom-bretagne.eu>
Message-ID: <20100130072348.GA3332@khaled-laptop>

On Sat, Jan 30, 2010 at 09:04:55AM +0200, Elie Roux wrote:
> Elie Roux a ?crit :
> >Hi,
> >
> >all these tools are freaking crappy sometimes... they are really
> >non-standards and differents on all platforms...  I tested under
> >GNU and cygwin (the versions are different, and it certainly is
> >different under BSD too) and it worked (which was not the case
> >with the -E option which was not recognized). Maybe it would be
> >best to change '\+' to '*' which seems more widespread? The result
> >will be the same, I don't think the t1lm*.fd files will change a
> >lot...
> 
> Oops, Ididn't see you already changed it in the repository... it's
> OK for me as it is now.

It is OK here too.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From mpg at elzevir.fr  Fri Jan 22 11:30:14 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Fri, 22 Jan 2010 11:30:14 +0100
Subject: [lltx] luatexbase
In-Reply-To: <20100122064130.GA3700@khaled-laptop>
References: <4B4DAE0A.6060001@elzevir.fr> <20100120175448.GA5811@khaled-laptop> <4B5749E7.9050802@elzevir.fr> <20100120202138.GA7969@khaled-laptop> <4B576D67.8080508@elzevir.fr> <20100122064130.GA3700@khaled-laptop>
Message-ID: <4B597E36.8080201@elzevir.fr>

Khaled Hosny a ?crit :
> True, that is another reason we should concentrate on getting things
> done first, then worry about version compatibility later. It doesn't
> make any sense to talk about backward incompatibility with half
> working/half broken, feature incomplete packages.
> 
Sure.

>> Concerning TL, I'll discuss with Karl if we can just blacklist lualatex stuff
>> from our update detection script, so that we can update to CTAN: it would make
>> things easier to test for more users, and I think we'll need testing.
> 
> Good idea.
> 
Ok, I'll keep you posted. Technically, it's not hard at all.

> Lets hope we'll get things done by time, my todo list is starting to
> collapse, hopefully we wll have time to stabilize things and do more
> testing.
> 
I hope so! OTOH, TL'10 is not yet in finalisation phase.

> That was actually the point, it should load the relevant packages
> according to the engine used, though I'm still not sure if it is a good
> idea; we don't want to get limited by XeTeX (being the least common
> denominator here, flexibility wise). I think Fran?ois's modern-latex is
> much better, if we decided to go one common package for different
> engines route.
> 
I tend to like modern-latex indeed. The only drawback with this kind of name is,
in 15 years, when LuaTeX has been the standard for years and some other
bleeding-edge engine is under heavy development, "modern" will sound weird :-)
But I don't think we need to worry a lot about this, since latex3 will be
finished in the meanwhile and offer built-in support for modern engines, right ? ;-)

Manuel.


From khaledhosny at eglug.org  Mon Jan 18 06:00:52 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 18 Jan 2010 07:00:52 +0200
Subject: [lltx] Makefiles
In-Reply-To: <AFDC5715-F3BA-42B0-9BAE-CCF9DD09BEAA@gmail.com>
References: <20100117093439.GA9514@khaled-laptop>
 <AFDC5715-F3BA-42B0-9BAE-CCF9DD09BEAA@gmail.com>
Message-ID: <20100118050052.GA2207@khaled-laptop>

On Mon, Jan 18, 2010 at 10:13:03AM +1030, Will Robertson wrote:
> On 17/01/2010, at 8:04 PM, Khaled Hosny wrote:
> 
> > I'd appreciate if someone can help writing makefiles for euenc and
> > fontspec, trying to understand makefiles and docstrip at once is mind
> > blowing :)
> 
> Sure, I can probably copy over what I'm using for unicode-math.
> What exactly do you want them to do?

Something in the lines of luaotfload, luainputenc, etc. makefiles; be
able to do 'make install', 'make ctan' etc.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Fri Jan 15 13:58:19 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 15 Jan 2010 14:58:19 +0200
Subject: [lltx] Font names database
In-Reply-To: <20100113174244.GD3609@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop>
 <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com>
 <20100113174244.GD3609@khaled-laptop>
Message-ID: <20100115125819.GC7716@khaled-laptop>

On Wed, Jan 13, 2010 at 07:42:44PM +0200, Khaled Hosny wrote:
> On Wed, Jan 13, 2010 at 02:11:27PM +0200, ?lie Roux wrote:
> > I think we should make a first pass generating a table like
> > 
> > fonts.list = {
> >   {
> >     fullname = "LMRoman10-Regular",
> >     variant = "regular" -- we should normalize the value here
> >     size = 10             -- here too
> >     familyname = "Latin Modern Roman" -- the thing that will be
> > searched first, for compatibility with fc and thus XeTeX
> >     family = "LM Roman 10"
> >     path = "/path/to/the/file"
> > }
> > 
> > and then making a second pass that generates the table that will be
> > written in the file:
> > 
> > fonts = {
> >   familyname = "Latin Modern Roman",
> >   alias = "LM Roman 10"
> >     {
> >       size = 10,  -- can be 0 for any
> >         {
> >           variant = "regular",
> >           fullname = "LMRoman10-Regular"
> >           path = "/path/to/the/file"
> >         }
> >         {
> >           variant = "slanted",
> >           fullname = "LMRoman10-Slanted"
> >           path = "/path/to/the/file"
> >         }
> >      }
> >      {
> >        size = 12,
> >        {
> >           ...
> >        }
> >      ....
> > }
> > 
> > With this, a single font would fit in a family with this font only,
> > and we can do a very quick search on a requested name (only on the
> > fields familyname and alias, and then go in the subtree to be more
> > precise, etc.). Wdyt?
> 
> That is an interesting idea, I have a more or less similar idea, but I
> need to think more about it though.

I've no a more or less working implementation (it is a bit messy
though).

Now the database looks like:
{
  mappings = {
    families = {
      ["familyname"] = {
        ["regular]   = filename-regular.ttf
        ["bold"]     = filename-bold.ttf
        ...
      }
      ...
    }
    psnames = {
    ["psnameregular"] = filename-regular.ttf
    ["psnamebold"]    = filename-bold.ttf
    ...
    }
  }
}

The psnames table is used as fall-back if font is not found by family
name, and style auto-detection works using XeTeX-like syntax; font/B,
font/I etc. Family names, psnames and the style all case insensitive
(spaces, hyphens etc. are ignored too).

The font information are retrieved through a full fontloader.open()
call, and it is very memory consuming, this definitely needs to be
improved. The font style extraction code is a bit messy, because of a
FontForge "feature" that ignores font subfamily for certain font names
(it is a feature for a font editor as it forces some consistency, but
IMO a bug for a font loader), I'll try to see what can be done to improve
this.

Optical sizes not supported yet.

Check git logs for more details.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Fri Jan 22 08:58:44 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 22 Jan 2010 09:58:44 +0200
Subject: [lltx] Re: xltxtra+luatex
In-Reply-To: <06BA4FA7-8E6E-444D-A925-8A0EE2A0EEB0@gmail.com>
References: <20100120222357.GA10005@khaled-laptop>
 <06BA4FA7-8E6E-444D-A925-8A0EE2A0EEB0@gmail.com>
Message-ID: <20100122075844.GA3748@khaled-laptop>

On Fri, Jan 22, 2010 at 04:50:51PM +1030, Will Robertson wrote:
> Replying from an offlist message from Khaled:
> 
> On 21/01/2010, at 8:53 AM, Khaled Hosny wrote:
> 
> > I did some work tonight adding luatex support to xltxtra, and it seems
> > to be functioning. If it is OK with you, please add me to the repo so I
> > can push it (patches attached for review).
> 
> In light of the recent discussions here I think for now it's best if we
> create a new package based on xltxtra (but maybe skipping a couple of
> its more useless features) that supports both XeTeX and LuaTeX. Then
> deprecate xltxtra as the "XeTeX-only" original. 
> 
> What do you all think?
> 
> To be honest, I'm not even sure if we need xltxtra (or analogous) any
> more. I suggest we enumerate its features and then decide which of them
> are really necessary -- it may end up that stuff like OpenType superiors
> for \textsuperscript/\textsubscript deserve their own mini-packages and
> the rest can be ignored. The more I think about this idea the more I
> like it -- there have been more issues raised than solved, I think, by
> lumping in various LaTeX changes into a single package when conflicts
> have occurred.

You no better than do I, I never used xelatex seriously to know about
the issues raised by xltxtra (and I hate the name, so I'll be more than
happy to let it die).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Sat Jan 30 06:37:01 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 30 Jan 2010 07:37:01 +0200
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
In-Reply-To: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>
References: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>
Message-ID: <20100130053701.GA2773@khaled-laptop>

On Sat, Jan 30, 2010 at 03:26:59PM +1030, Will Robertson wrote:
> Hi guys,
> 
> Just wondering if it would make sense if things like
> 
>     script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
> 
> were handled by luaotfload automatically (like XeTeX does it) to be turned off manually if necessary?

This might need a deeper luaotfload changes, which will be a significant
deviate from ConTeXt codebase, which I'm reluctant to do, not before it
is considered stable at least.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Wed Jan 20 18:54:48 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 20 Jan 2010 19:54:48 +0200
Subject: [lltx] luatexbase
In-Reply-To: <4B4DAE0A.6060001@elzevir.fr>
References: <4B4DAE0A.6060001@elzevir.fr>
Message-ID: <20100120175448.GA5811@khaled-laptop>

Hi Manuel,

On Wed, Jan 13, 2010 at 12:27:06PM +0100, Manuel P?gouri?-Gonnard wrote:
> FYI,
> 
> As mentioned in a previous message, I am splitting luatextra in two parts:
> 
> - luatexbase for basic resource handling (registers, catcodetables, attributes,
> lua modules, callbacks) and maybe later I'll add compatibility stuff (such as
> names of primitives)
> 
> - luatextra, with luaextra, the logos, goodies for LaTeX (currently the luacode
> environment, later \newluacommand as suggested by Khaled, etc.)
> 
> There is a new repo for luatexbase, and the splitting out is happening in the
> base-out branch of luatextra. Until I announce otherwise, you should assume
> luatebase/master and luatextra/base-out are broken :-) I made them public just
> so that everybody can see what's happening, they are currently not for use.
> 
> My mid-term goal is that luatexbase becomes the standard package that every
> lua(la)tex programmer can load without thinking. It means it should become quite
> stable soon. Before this happens, I'd like to make a few changes to some parts.
> (I'll warn if I want to make incompatible changes during this period.)

I think the splitting is a good idea, I'd like to move luaextra to
luatexbase too (unless stability is a concern, then it should live in
its own package), and kill luatextra completely and move document
specific parts to xltxtra. I think unifying XeTeX and LuaTeX specific
packages would allow smoother user experience, and better
maintainability. The name might be subobtimal, may be we can rename
xltxtra to ultxtra (u for Unicode), or even get a better name (I always
mistype xltxtra!) and make xltxtra.sty a small wrapper for backward
compatibility. Will, what do you think?

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From wspr81 at gmail.com  Thu Jan  7 08:05:00 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Thu, 7 Jan 2010 17:35:00 +1030
Subject: [lltx] fontspec development
Message-ID: <539FF915-88F2-4FED-BC0E-79F1B2CE5EAB@gmail.com>

Hi all,

I'm assuming that this setup thing has gone well and everyone's sort of seeing what I'm writing here. Once we've started a bit of a discussion I'll put a notice on c.t.t. (etc.) that this group exists.

So I'm in the middle of fixing up some of fontspec's more egregious bugs while grafting in support that Elie and Khaled have been adding for OpenType fonts in LuaTeX (based on ConTeXt and extended for our needs).

Anyway, the current fontspec code is here:
  <http://github.com/wspr/fontspec>

You'll also want to grab recent version of luaotfload and luatextra:
  <http://github.com/mpg/luaotfload>
  <http://github.com/mpg/luatextra>

Guess I should put that in a readme. Damn.

The biggest job for me, now, is to finish off a re-organisation of the documentation. As I go through things I'm trying to tidy up the code, as well, but that's a bit of a mess -- fontspec was my first major piece of development work, and I've learnt a lot since then!

In regards to the philosophy of Lua vs TeX programming, for those who are interested in actually working with the package, I don't care too much but my personal preference is to stick with TeX (or rather expl3) code as much as possible to keep things sort-of in sync between the XeTeX and LuaTeX sections of the code. But if you're happier writing Lua code: go for it.

-- Will



From mpg at elzevir.fr  Thu Jan 14 14:04:51 2010
From: mpg at elzevir.fr (Manuel Pegourie-Gonnard)
Date: Thu, 14 Jan 2010 14:04:51 +0100
Subject: [lltx] Font names database
In-Reply-To: <20100114040652.GB2200@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop> <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com> <20100113174244.GD3609@khaled-laptop> <4B4E09DA.3060003@elzevir.fr> <20100114040652.GB2200@khaled-laptop>
Message-ID: <4B4F1673.6080108@elzevir.fr>

Khaled Hosny a ?crit :
> Do TeXlive (or other TeX distributions) ship fontconfig's command line
> tools?

On windows, yes. On Unices, no. (I don't know about MacTeX but according to 
Will's answer, no.) But, on Unix (except OS X) the command-line utilities 
ought to be present, at least fc-cache.

> I think they are only shipping the library and we can't use the
> library directly, unless someone writes luafontconfig binding and make
> it work with LuaTeX. So we can only expect fontconfig on modern
> GNU/Linux systems, not even sure about *BSD.
> 
If you think we can achieve a reliable result without fontconfig and without 
explosion of the size of the code, then it would probably be more portable 
indeed.

Manuel.


From mpg at elzevir.fr  Fri Jan 22 11:35:23 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Fri, 22 Jan 2010 11:35:23 +0100
Subject: [lltx] Re: xltxtra+luatex
In-Reply-To: <06BA4FA7-8E6E-444D-A925-8A0EE2A0EEB0@gmail.com>
References: <20100120222357.GA10005@khaled-laptop> <06BA4FA7-8E6E-444D-A925-8A0EE2A0EEB0@gmail.com>
Message-ID: <4B597F6B.1060708@elzevir.fr>

Will Robertson a ?crit :
> To be honest, I'm not even sure if we need xltxtra (or analogous) any more. I
> suggest we enumerate its features and then decide which of them are really
> necessary -- it may end up that stuff like OpenType superiors for
> \textsuperscript/\textsubscript deserve their own mini-packages and the rest
> can be ignored. The more I think about this idea the more I like it -- there
> have been more issues raised than solved, I think, by lumping in various
> LaTeX changes into a single package when conflicts have occurred.
> 
Well, I'm in my splitting phase with luatexbase etc, so I tend to agree to
splitting. However, I'd like to advocate for a single (or at least very few)
end-user packages, so the user don't have to say

\usepackage{fontspec}
\usepackage{opentypesuperscripts}
\usepackage{whatever}
\ETC.

in each and every document.

> Oh, and we should also get a version of the LuaTeX logo incorporated into
> metalogo. I'll message Andrew Moschou about it.
> 
Btw, I tend to like Lua\kern-0.8333em\TeX but apparently the LuaTeX manual uses
just Lua\TeX. I guess they know better than us...

m


From wspr81 at gmail.com  Sat Jan 30 05:56:59 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 30 Jan 2010 15:26:59 +1030
Subject: [lltx] script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;
Message-ID: <F6D7DBDF-611F-40A7-A52D-471C0E0D906D@gmail.com>

Hi guys,

Just wondering if it would make sense if things like

    script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;

were handled by luaotfload automatically (like XeTeX does it) to be turned off manually if necessary?

-- Will



From wspr81 at gmail.com  Thu Jan 14 00:46:55 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Thu, 14 Jan 2010 10:16:55 +1030
Subject: [lltx] Font names database
In-Reply-To: <39774836-EB06-4465-8158-E8DD827C4628@gmail.com>
References: <20100112180942.GA18074@khaled-laptop> <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com> <20100113174244.GD3609@khaled-laptop> <4B4E09DA.3060003@elzevir.fr> <39774836-EB06-4465-8158-E8DD827C4628@gmail.com>
Message-ID: <5330E305-FA1D-42DE-8BDB-8A2F7207CA91@gmail.com>

On 14/01/2010, at 8:22 AM, Will Robertson wrote:

> I'll have to check if it's installed by texlive2009, but Fontconfig has never been used on mac os x for font loading.

I do have `fc-cache` installed on my Mac, but not through TeX Live. So I wouldn't count on it being available...

-- Will



From mpg at elzevir.fr  Mon Jan 11 13:48:51 2010
From: mpg at elzevir.fr (Manuel Pegourie-Gonnard)
Date: Mon, 11 Jan 2010 13:48:51 +0100
Subject: [lltx] luaextra
In-Reply-To: <20100111122621.GA3465@khaled-laptop>
References: <20100110175957.GA11766@khaled-laptop> <4B4A3F73.6060804@telecom-bretagne.eu> <20100111112752.GA2828@khaled-laptop> <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com> <20100111122621.GA3465@khaled-laptop>
Message-ID: <4B4B1E33.2070301@elzevir.fr>

Khaled Hosny a ?crit :
>> But anyway, I think having the ConTeXt libraries easily loadable
>> without ConTeXt by duplicating them would be a good idea...
> 
> So, what I suggest is to strip the modules out of luaextra.lua and
> replace it with a bunch of require("luaextra-*.lua") calls, and have the
> modules separately. If this OK, I can work on it (once having write
> access to the git repository).
> 
Seems like a good idea to me. I added you to luatextra, so you can easily push.

FYI, I was planning to split luatextra in two parts:
1. luatexbase, comprising extended registers, attribute and catcodetable 
allocation, as well as lua module loading, and luamcallback. There would be 
a luatexbase package loading all of them, but it would be possible to load 
each part independently, for programmers wanting to minimze dependencies
2. all the rest (luaextra, and the remaining bits bits in luatextra).

So, once this splitting will be done, you can load just luatexbase-mods (lua 
module loading part) then require"luaxtra-foobar" for some value of foobar, 
with no additional code being loaded.

The idea is to make luatexbase as small and clean as possible so that 
programmers can load it in all documents without worrying. OTOH, luatextra 
would what users load if they want all benefits of lualatex without worrying 
(just as we currently load xltxtra under xelatex).

Manuel.

PS: I'll push tonight the beginning of my work on this splitting. I'll post 
back here when I think the result is ready.


From khaledhosny at eglug.org  Sun Jan 10 18:59:57 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 10 Jan 2010 19:59:57 +0200
Subject: [lltx] luaextra
Message-ID: <20100110175957.GA11766@khaled-laptop>

I'm trying to use some luatextra functions in a lua script, but it fails
because it needs luatextra, but I'd like to have as less dependencies
(and loaded files) as possible.

So I was thinking it'd be better to have the lua libraries separately 
(the original ConTeXt l-*.lua files, may be renamed to luatextra-*.lua)
since each is essentially self contained, and make luatextra.lua just
load them for people who don't want to bother loading each separately.

This might make the libraries more appealing for standalone lua
scripts.

What do you think?

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100110/a35cef94/attachment.bin>

From arthur.reutenauer at normalesup.org  Fri Jan  8 09:53:10 2010
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Fri, 8 Jan 2010 09:53:10 +0100
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <20100108070452.GA16882@khaled-laptop>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com> <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com> <eba574421001072301y51c27e35v90347c9a94cfe175@mail.gmail.com> <20100108070452.GA16882@khaled-laptop>
Message-ID: <20100108085310.GB30199@phare.normalesup.org>

	Hello all,

> Actually, it have been broken with svn revision 3217; the first broken
> release is 0.47.0

  Maybe at that point it's worth a bug report on the dev-luatex list?  ;-)

	Arthur


From wspr81 at gmail.com  Fri Jan  8 00:55:55 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 8 Jan 2010 10:25:55 +1030
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
Message-ID: <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>

On 08/01/2010, at 6:39 AM, Elie wrote:

> I managed to create a minimal
> example: http://norgz.guiling.fr/ecm.dtx ; you can compile with
> pdflatex without any problem, but the compilation with lualatex fails,
> saying there is an error on the file name.

It works for me with MacTeX 2009... are you using a different LuaTeX than me?:

> This is LuaTeX, Version beta-0.40.6-2009111822 (TeX Live 2009)

-- Will



From elie.roux at telecom-bretagne.eu  Thu Jan 14 10:37:35 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Thu, 14 Jan 2010 11:37:35 +0200
Subject: [lltx] A new Babel?
Message-ID: <eba574421001140137i78ae8f32s8f7c2052e85caec1@mail.gmail.com>

Hello,

recently I got interested in polyglossia and had interesting
discussions with Fran?ois Charette. The reasons I got interested in
polyglossia were:
 - having (the very romanian) ? instead of (the very turkish) ? in
romanian titles, which is not possible in standard 8-bit TeX (and I
don't really like tricky TeX patches)
 - having a modern Unicode+OTF solution without all the 8-bit+T1 heavy machinery

The discussions I had with Fran?ois were on these topics:
 - is it possible to adapt polyglossia to LuaTeX? currently it uses
things like \XeTeXintercharclass that are not accessible in LuaTeX.
This means we have two choices: (a) adapt \XeTeXintercharclass and
stuff to LuaTeX, which would be quite funny, (b) copy-paste bunches of
code from Babel with active characters.
 - why isn't it possible in polyglossia to have some features from
babel (especially in french) like modification of the shape of the
lists, of the indentation, etc. that are really mandatory for me
(english typography is so awful when you're used to french one). The
answer is: "it's on the TODO list"

I'd like to know what you think about a new babel. First you can read
the discussions on the XeTeX list that lead to the birth of
polyglossia: http://www.tug.org/pipermail/xetex/2007-April/thread.html
in the thread "[XeTeX] "new-babel", was: Ancient Greek hyphenation".
The README is also useful to see the functionalities:
http://mirror.unl.edu/ctan/macros/xetex/latex/polyglossia/README .
These readings are really interesting and hard to sum up, but the main
open points are:

 (1) should it set a font for each language or just set the language
option in the current font:
    - for french and german, the same font can obviously be used
    - for arabic and japanese obviously not, so for close languages it
shoudn't be changed, when it should be for far languages... but what
is the limit... should we make groups of languages?
    - for german and polish the ligatures are not the same even though
the languages are close, do all the fonts change the ligatures
according to the language option?
    - I must say I have no preference for this... except that we
should allow the user to do whatever he want by providing the good
macros.

(2) should it include typographic rules or should they be in another
package? in a different file? For me it should as an option, activated
by default.

(3) Is all the babel machinery included in Unicode+OTF? Do we still
need active characters and things like that? I think we still need
some active characters for some languages, or to implement the \XeTeX
machinery... but I think the babel active characters have been more
tested and work in more cases.

(4 - not discussed on the XeTeX list) how far should it be from babel?
I was thinking about loading the babel files and then overriding the
translated strings to Unicode, so that we have the same result as
babel... This is a point that would need further inquiries for me. But
we shouldn't forget that some language files change very often
(frenchb for example, which often breaks backward compatibility), and
maybe we should be aligned with babel to confuse less users...

Even though Will has already participated in the XeTeX discussions,
I'd like to have your opinions on these topics. The main reason is
that Fran?ois gives up polyglossia and proposed me to take the
leadership on the package, allowing me to change a lot of things... If
we manage to agree on something I'll move the discussion to a wider
range, including the babel team, and the luatex and xetex
mailing-lists.

Thank you,
-- 
Elie


From khaledhosny at eglug.org  Sun Jan 17 10:34:39 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 17 Jan 2010 11:34:39 +0200
Subject: [lltx] Makefiles
Message-ID: <20100117093439.GA9514@khaled-laptop>

Hi all,

I'd appreciate if someone can help writing makefiles for euenc and
fontspec, trying to understand makefiles and docstrip at once is mind
blowing :)

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Thu Jan 14 05:29:01 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 14 Jan 2010 06:29:01 +0200
Subject: [lltx] Font names database
In-Reply-To: <4B4E0AA0.9030501@telecom-bretagne.eu>
References: <20100112180942.GA18074@khaled-laptop>
 <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com>
 <20100113174244.GD3609@khaled-laptop>
 <4B4E0AA0.9030501@telecom-bretagne.eu>
Message-ID: <20100114042901.GC2200@khaled-laptop>

On Wed, Jan 13, 2010 at 08:02:08PM +0200, Elie Roux wrote:
> Khaled Hosny a ?crit :
> >That is an interesting idea, I have a more or less similar idea, but I
> >need to think more about it though.
> 
> Ok, do not hesitate to share very technical ideas and to describe
> your technical solution, I'm interested in contributing.

Sure.

> >I've considered using fontconfig (actually my first version were using
> >fc-list to list all system font files), but I disregarded it later as we
> >can't guarantee fontconfig (or fontconfig tools) are present on all
> >systems,
> 
> That's for sure, but on the systems where it is, it implies that
> ""all"" the fonts are listed by it, except eventually the ones in
> the TEXMF tree that are not always added to the fc database, that's
> why I liked the idea... Also I think the script would take less
> loading time right? A fontforge call for each font seems like a bit
> overkill to me if there is already a database available... Of course
> we would still have to do it manually on poor OSs...

We have to do TEXMF fonts on our own anyway (unless there is away to add
it to fc cache without fiddling with user's configuration files). A full
fontforge call it too much indeed, but LuaTeX has a fontforge.info which
is much faster (processing more than 2000 files toke less than 2 seconds
on my machine), but it doesn't currently provide all the information we
need (names table for example), but we may try to extend it, I'm sure
Taco will accept some patch.
> Furthermore it would be more compliant with XeTeX.

Not sure about this, looking at XeTeX sources I see 
// for sfnt containers, we'll read the name table ourselves, not rely on Fontconfig

(sfnt containers are almost all XeTeX supported fonts except tfm and
type1 fonts)

> > also fontconfig tries to do smart things that wouldn't fit our
> >needs and we better off parsing font files ourselves.
> 
> I don't understand this... fc-cat (or fc-list -v) displays too much
> information, but we can still parse it, all the work is almost
> done... what doesn't fit it the informations given by fc?

For example, what if the font have not subfamily, what fc will return
(type1 fonts for example)? What if the font is available in several
formats (TTF, OTF, etc. as many fonts in TeXlive do), what are the
meaning of some values; for lmb10.pfb for example I get "weight: 180,
width: 100" (I expect Bold and Regular respectively), what are the
meaning of those values? And the fact that we will be loading the fonts
with fontforge not fontconfig (TTC subfont indices for example, do fc
support dfont fonts?)

Lots of question and very little documentation.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From Firmicus at gmx.net  Thu Jan 21 16:45:53 2010
From: Firmicus at gmx.net (Firmicus)
Date: Thu, 21 Jan 2010 16:45:53 +0100
Subject: [lltx] luatexbase
In-Reply-To: <4B576D67.8080508@elzevir.fr>
References: <4B4DAE0A.6060001@elzevir.fr> <20100120175448.GA5811@khaled-laptop> <4B5749E7.9050802@elzevir.fr> <20100120202138.GA7969@khaled-laptop> <4B576D67.8080508@elzevir.fr>
Message-ID: <4B5876B1.1000604@gmx.net>

On 20/01/2010 21:53, Manuel P?gouri?-Gonnard wrote:
> Khaled Hosny a ?crit :
>    
>
>> May I suggest "unicode-latex" as a meta package that would take car of loading
>> various XeTeX or LuaTeX packages for the user? (it should essentially be
>> xltxra with LuaTeX support for the time being).
>>      
> I don't like "unicode-latex" so much, since I'm not sure it is clear that
> "unicode" means XeTeX or LuaLaTeX.
>
>    

May I suggest "modern-latex" ? This would more nicely emphasize what it 
is, namely an enhancement for  latex on modern engines. BTW the name is 
inspired by the Modern::Perl module on CPAN: 
http://search.cpan.org/dist/Modern-Perl/ which is very similar in spirit 
to what *ltxtra does.

F



From khaledhosny at eglug.org  Tue Jan 12 19:09:42 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 12 Jan 2010 20:09:42 +0200
Subject: [lltx] Font names database
Message-ID: <20100112180942.GA18074@khaled-laptop>


Hi all,

I'm working on a font names database generation script, it is capable of
producing output similar to ConTeXt's 'simple' font names.

Now I'm wondering where, in TEXMF tree, should I store the database
file? I thought $TEXMFVAR is a logical choice, but kpse seems not to be
able to find files there, any idea?

The main problem now is which font names should we index, currently we
simply take the 'fullname' as returned by fontloader, but things is isn't
that simple! There is a hell of different font names stored in the font;
fontname, fullname, familyname, and identical enteries in TTF names
table, which in turn have different copies for mac and windows! And
kindly enough, font designers have taken the liberty to have different
names in each set. Take LM roman regular as an example:

fullname: LMRoman10-Regular
fontname: LMRoman10-Regular
familyname: LMRoman10
names.compatfull: LM Roman 10 Regular
names.family: LM Roman 10
names.preffamilyname: Latin Modern Roman
names.prefmodifiers: 10 Regular
fontstyle_name: Regular

(not to mention that mac entries in names table are different, but FF
ignores it)
And this is only a single font!

Now which one should I pick? Any idea how Fontconfig and similar tools
handle this? (since what they return is likely to be expected by users)

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100112/8b638bd5/attachment.bin>

From elie.roux at telecom-bretagne.eu  Wed Jan 13 13:11:27 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Wed, 13 Jan 2010 14:11:27 +0200
Subject: [lltx] Font names database
In-Reply-To: <20100112180942.GA18074@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop>
Message-ID: <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com>

2010/1/12 Khaled Hosny <khaledhosny at eglug.org>:
>
> I'm working on a font names database generation script, it is capable of
> producing output similar to ConTeXt's 'simple' font names.

Hello,

I'm glad you're taking care of it, it will be a huge improvement in
LuaTeX's fontspec!

> The main problem now is which font names should we index, currently we
> simply take the 'fullname' as returned by fontloader, but things is isn't
> that simple! There is a hell of different font names stored in the font;
> fontname, fullname, familyname, and identical enteries in TTF names
> table, which in turn have different copies for mac and windows! And
> kindly enough, font designers have taken the liberty to have different
> names in each set. Take LM roman regular as an example:
>
> fullname: LMRoman10-Regular
> fontname: LMRoman10-Regular
> familyname: LMRoman10
> names.compatfull: LM Roman 10 Regular
> names.family: LM Roman 10
> names.preffamilyname: Latin Modern Roman
> names.prefmodifiers: 10 Regular
> fontstyle_name: Regular

I think we should make a first pass generating a table like

fonts.list = {
  {
    fullname = "LMRoman10-Regular",
    variant = "regular" -- we should normalize the value here
    size = 10             -- here too
    familyname = "Latin Modern Roman" -- the thing that will be
searched first, for compatibility with fc and thus XeTeX
    family = "LM Roman 10"
    path = "/path/to/the/file"
}

and then making a second pass that generates the table that will be
written in the file:

fonts = {
  familyname = "Latin Modern Roman",
  alias = "LM Roman 10"
    {
      size = 10,  -- can be 0 for any
        {
          variant = "regular",
          fullname = "LMRoman10-Regular"
          path = "/path/to/the/file"
        }
        {
          variant = "slanted",
          fullname = "LMRoman10-Slanted"
          path = "/path/to/the/file"
        }
     }
     {
       size = 12,
       {
          ...
       }
     ....
}

With this, a single font would fit in a family with this font only,
and we can do a very quick search on a requested name (only on the
fields familyname and alias, and then go in the subtree to be more
precise, etc.). Wdyt?

> Now which one should I pick? Any idea how Fontconfig and similar tools
> handle this? (since what they return is likely to be expected by users)

I tried fc-match when I planned to make a luafontspec, and frankly,
there must be something I didn't understand because it has always
seemed something at best strange, at worst totally crappy... for
example:

fc-match Latin
--> DejaVuSans.ttf

fc-match Latin\ Modern
--> DejaVuSans.ttf

fc-match Latin\ Modern\ Roman
--> lmroman17-regular.otf

But anyway, fontconfig could be used in the script, with fc-cat: it
outputs a set of entries like

"VenturisSansADFNo2Cd-Bold.otf" 0 "VenturisSans ADF No2
Cd:familylang=en:style=Bold:stylelang=en:fullname=VenturisSansADFNo2Cd-Bold,VenturisSans
ADF No2 Cd Bold:fullnamelang=en,en:slant=0:weight=200:width=75:foundry=unknown:index=0:outline=True:scalable=True:charset=
 |>^1!|>^1!P0oWQ |>]!]|>^1!|>^1!!!!%# !!71$!#>r7F3y?4!!K?&   !!!)$
 9;*f! !!#0GM>RAd#y#fx!!!!5  !!!W5  !!#3H !!!!&      !!#6I!!K?&
!!+u{!!!!F
:lang=aa|ast|ay|bi|br|ch|co|da|de|en|es|et|eu|fi|fj|fo|fr|fur|fy|gd|gl|gv|ho|ia|id|ie|io|is|it|lb|mg|nb|nds|nl|nn|no|nr|nso|oc|om|pt|rm|sma|smj|so|sq|ss|st|sv|sw|tl|tn|ts|uz|vo|vot|wa|xh|yap|zu|an|fil|ht|jv|kj|kwm|li|ms|ng|pap-an|pap-aw|rn|rw|sc|sg|sn|su|za:fo

As you can see it doesn't give the full file name with the directory
path, but with the option -v it gives it each time it changes
directory. I think this is clearly the best way to get all the system
fonts listed. Also you could easily detect if the fonts in TEXMF have
already been listed or not, and list them after accordingly. Wdyt?

If you can't use fontconfig on your system I can do this part.
fontconfig exists under cygwin if it helps, though it would need a
change from cygwin paths to Windows paths. (cygwin is always a mess
for programmers...)

Thank you,
-- 
Elie


From wspr81 at gmail.com  Wed Jan 13 22:52:40 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Thu, 14 Jan 2010 08:22:40 +1030
Subject: [lltx] Font names database
In-Reply-To: <4B4E09DA.3060003@elzevir.fr>
References: <20100112180942.GA18074@khaled-laptop> <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com> <20100113174244.GD3609@khaled-laptop> <4B4E09DA.3060003@elzevir.fr>
Message-ID: <39774836-EB06-4465-8158-E8DD827C4628@gmail.com>



(Sent from my phone.)

On 14/01/2010, at 4:28, Manuel P?gouri?-Gonnard <mpg at elzevir.fr>  
wrote:

> Khaled Hosny a ?crit :
>> I've considered using fontconfig (actually my first version were  
>> using
>> fc-list to list all system font files), but I disregarded it later  
>> as we
>> can't guarantee fontconfig (or fontconfig tools) are present on all
>> systems, also fontconfig tries to do smart things that wouldn't fit  
>> our
>> needs and we better off parsing font files ourselves.
>
> Can't we assume fontconfig to be present wherever XeTeX is? But we  
> may want to
> be more portable that XeTeX indeed.

I'll have to check if it's installed by texlive2009, but Fontconfig  
has never been used on mac os x for font loading.

Which might well rule out using it at all, not sure.
>

W

From mpg at elzevir.fr  Tue Jan 12 00:11:01 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Tue, 12 Jan 2010 00:11:01 +0100
Subject: [lltx] \luanewcommand?
In-Reply-To: <20100111174435.GA11416@khaled-laptop>
References: <20100111174435.GA11416@khaled-laptop>
Message-ID: <4B4BB005.1080502@elzevir.fr>

On 11/01/2010 18:44, Khaled Hosny wrote:
> 
> I think it'd be handy to have a \luanewcommand that is similar to
> \newcommand but takes luacode instead of TeX macros, so one can do
> something like:
> 
> \luanewcommand{\hello}[1]{tex.sprint("Hello #1")}
> 
> Instead of:
> \newcommand{\hello}[1]{\directlua{tex.sprint("Hello #1")}}
> 
Well, in the general case one should write

\directlua{tex.sprint("Hello \luatexescapestring{#1}")}

> This would make lua feel more integrated (and it may take care of spaces
> and catcodes etc. so we can use lua comment char '--' etc.)
> 
> What do you think?
> 
I like the idea, but i may need a bit more reflexion. I added it to my todolist
for later. Obviously it would be a LaTeX-specific thing?

Manuel.



From khaledhosny at eglug.org  Mon Jan 11 17:13:47 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 11 Jan 2010 18:13:47 +0200
Subject: [lltx] luaextra
In-Reply-To: <eba574421001110447q7f3e8513je635fb47f47d1d13@mail.gmail.com>
References: <20100110175957.GA11766@khaled-laptop>
 <4B4A3F73.6060804@telecom-bretagne.eu>
 <20100111112752.GA2828@khaled-laptop>
 <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>
 <20100111122621.GA3465@khaled-laptop>
 <eba574421001110434m7bdffde2v30eb10ac66ebbad@mail.gmail.com>
 <20100111124103.GA3884@khaled-laptop>
 <eba574421001110447q7f3e8513je635fb47f47d1d13@mail.gmail.com>
Message-ID: <20100111161346.GA10631@khaled-laptop>

On Mon, Jan 11, 2010 at 02:47:30PM +0200, ?lie Roux wrote:
> 2010/1/11 Khaled Hosny <khaledhosny at eglug.org>:
> >
> > Since ConTeXt's lua modules are quite generic, I'd rather try to keep
> > our copy 100% compatible for easy syncing etc. may be one day LuaTeX (or
> > some other macro package independent package) will ship them, but we can
> > add some aliases in luaextra for backward compatibility.
> 
> Sure, I just aliased file to fpath (because all the file. functions
> are actually working on path...), and renamed file.is_readable in
> lfs.is_readable which seem more accurate... but it's no important
> changes...
> 
> So do you think luaextra should load like l-table, l-string, l-file
> and l-math, and that we also ship the other files, for people who want
> to use them? This would be OK for me... Manuel, can you give the
> rights on the git rep to Khaled?

I pushed my changes to the repository, please check that I didn't break
anything. Also the documentation needs to be updated a bit.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100111/516b911b/attachment.bin>

From elie.roux at telecom-bretagne.eu  Mon Jan 11 13:34:49 2010
From: elie.roux at telecom-bretagne.eu (=?UTF-8?Q?=C3=89lie_Roux?=)
Date: Mon, 11 Jan 2010 14:34:49 +0200
Subject: [lltx] luaextra
In-Reply-To: <20100111122621.GA3465@khaled-laptop>
References: <20100110175957.GA11766@khaled-laptop>
	 <4B4A3F73.6060804@telecom-bretagne.eu>
	 <20100111112752.GA2828@khaled-laptop>
	 <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>
	 <20100111122621.GA3465@khaled-laptop>
Message-ID: <eba574421001110434m7bdffde2v30eb10ac66ebbad@mail.gmail.com>

2010/1/11 Khaled Hosny <khaledhosny at eglug.org>:
>
>> BTW, is the table printing function working ok for you? I always have
>> some strange newlines where there shouldn't be...
>
> It seems to work OK here, I think the newlines are TeX cutting the lines
> after certain length, try print() instead of texio.write() and compare.

Thank you for the tip!

> So, what I suggest is to strip the modules out of luaextra.lua and
> replace it with a bunch of require("luaextra-*.lua") calls, and have the
> modules separately. If this OK, I can work on it (once having write
> access to the git repository).

In fact luaextra is quite short compared to the l-*.lua files of
ConTeXt, it contains only a minimal subset, so I think it can be
loaded all at once, which is not really the case of the l-* files...
What I was thinking was to ship the l-* files and to keep the minimal
luaextra functions, but this will introduce code duplication... so
maybe just shipping the l-* files and make luaextra load some of them
with some modifications (I renamed a thing or two, it's written in the
doc) would be OK... Wdyt?

Thank you,
-- 
Elie


From elie.roux at telecom-bretagne.eu  Sun Jan 10 21:58:27 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Sun, 10 Jan 2010 22:58:27 +0200
Subject: [lltx] luaextra
In-Reply-To: <20100110175957.GA11766@khaled-laptop>
References: <20100110175957.GA11766@khaled-laptop>
Message-ID: <4B4A3F73.6060804@telecom-bretagne.eu>

Khaled Hosny a ?crit :
> I'm trying to use some luatextra functions in a lua script, but it fails
> because it needs luatextra, but I'd like to have as less dependencies
> (and loaded files) as possible.
>   

Hello,

I must say I don't understand the part "I'm trying to use some luatextra 
functions, [...] but it fails because it needs luatextra", can you be 
more explicit ? Do you mean that luatextra.lua needs luatextra.sty? Or 
are you talking about luamcallbacks and luaextra?

> So I was thinking it'd be better to have the lua libraries separately 
> (the original ConTeXt l-*.lua files, may be renamed to luatextra-*.lua)
> since each is essentially self contained, and make luatextra.lua just
> load them for people who don't want to bother loading each separately.
>
> This might make the libraries more appealing for standalone lua
> scripts.
>
> What do you think?
>   

It sounds like a good idea! Although I think it would be necessary to 
write a small script to load ConTeXt modules (to load them only once, to 
write the name to the log file, etc.)...

Thank you!
-- 
Elie


From khaledhosny at eglug.org  Fri Jan  8 10:24:18 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 8 Jan 2010 11:24:18 +0200
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <20100108085310.GB30199@phare.normalesup.org>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
 <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
 <eba574421001072301y51c27e35v90347c9a94cfe175@mail.gmail.com>
 <20100108070452.GA16882@khaled-laptop>
 <20100108085310.GB30199@phare.normalesup.org>
Message-ID: <20100108092417.GA19534@khaled-laptop>

On Fri, Jan 08, 2010 at 09:53:10AM +0100, Arthur Reutenauer wrote:
> 	Hello all,
> 
> > Actually, it have been broken with svn revision 3217; the first broken
> > release is 0.47.0
> 
>   Maybe at that point it's worth a bug report on the dev-luatex list?  ;-)

I usually try to be more specific before reporting bugs, or even try to
fix it myself (I learn good stuff this way ;), but I give up, debugging
tex macros just blows my head.

Reported as http://tracker.luatex.org/view.php?id=315 with a smaller
test file (still docstrip though).

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100108/776ebeb1/attachment.bin>

From khaledhosny at eglug.org  Fri Jan  8 06:16:10 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 8 Jan 2010 07:16:10 +0200
Subject: [lltx] bug in docstrip with lualatex
In-Reply-To: <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
References: <d6abba2f-4555-4805-bfbd-f15768d08de8@22g2000yqr.googlegroups.com>
 <657AD191-A2E2-4DBA-A171-9EDE1FFFE87B@gmail.com>
Message-ID: <20100108051609.GA2279@khaled-laptop>

On Fri, Jan 08, 2010 at 10:25:55AM +1030, Will Robertson wrote:
> On 08/01/2010, at 6:39 AM, Elie wrote:
> 
> > I managed to create a minimal
> > example: http://norgz.guiling.fr/ecm.dtx ; you can compile with
> > pdflatex without any problem, but the compilation with lualatex fails,
> > saying there is an error on the file name.
> 
> It works for me with MacTeX 2009... are you using a different LuaTeX than me?:
> 
> > This is LuaTeX, Version beta-0.40.6-2009111822 (TeX Live 2009)

With beta-0.40.6 it is OK here too, but not with beta-0.50.0.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100108/9f1216c4/attachment.bin>

From elie.roux at telecom-bretagne.eu  Wed Jan 13 19:02:08 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Wed, 13 Jan 2010 20:02:08 +0200
Subject: [lltx] Font names database
In-Reply-To: <20100113174244.GD3609@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop> <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com> <20100113174244.GD3609@khaled-laptop>
Message-ID: <4B4E0AA0.9030501@telecom-bretagne.eu>

Khaled Hosny a ?crit :
> That is an interesting idea, I have a more or less similar idea, but I
> need to think more about it though.
>   

Ok, do not hesitate to share very technical ideas and to describe your 
technical solution, I'm interested in contributing.

> I've considered using fontconfig (actually my first version were using
> fc-list to list all system font files), but I disregarded it later as we
> can't guarantee fontconfig (or fontconfig tools) are present on all
> systems,

That's for sure, but on the systems where it is, it implies that ""all"" 
the fonts are listed by it, except eventually the ones in the TEXMF tree 
that are not always added to the fc database, that's why I liked the 
idea... Also I think the script would take less loading time right? A 
fontforge call for each font seems like a bit overkill to me if there is 
already a database available... Of course we would still have to do it 
manually on poor OSs... Furthermore it would be more compliant with XeTeX.

>  also fontconfig tries to do smart things that wouldn't fit our
> needs and we better off parsing font files ourselves.
>   

I don't understand this... fc-cat (or fc-list -v) displays too much 
information, but we can still parse it, all the work is almost done... 
what doesn't fit it the informations given by fc?

> (BTW, I usually use a recent GNU/Linux distro and never use Windows as a
> production system, so I might actually need Windows help more than any
> thing else.)
>   

Ok, do not hesitate to ask, I have a windows machine available (and a 
virtual one too).

Thank you!
-- 
Elie


From khaledhosny at eglug.org  Mon Jan 11 13:26:21 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 11 Jan 2010 14:26:21 +0200
Subject: [lltx] luaextra
In-Reply-To: <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>
References: <20100110175957.GA11766@khaled-laptop>
 <4B4A3F73.6060804@telecom-bretagne.eu>
 <20100111112752.GA2828@khaled-laptop>
 <eba574421001110351x6707cfcficf9286e18c0ccfab@mail.gmail.com>
Message-ID: <20100111122621.GA3465@khaled-laptop>

On Mon, Jan 11, 2010 at 01:51:39PM +0200, ?lie Roux wrote:
> 2010/1/11 Khaled Hosny <khaledhosny at eglug.org>:
> Oh ok, I see much better now... I think we should replace
> 
>     luatextra.provides_module(luatextra_module)
> 
> by
> 
>     if luatextra then
>         luatextra.provides_module(luatextra_module)
>     end
> 
> I'm going to push this now...

Thanks.

> BTW, is the table printing function working ok for you? I always have
> some strange newlines where there shouldn't be...

It seems to work OK here, I think the newlines are TeX cutting the lines
after certain length, try print() instead of texio.write() and compare.

> But anyway, I think having the ConTeXt libraries easily loadable
> without ConTeXt by duplicating them would be a good idea...

So, what I suggest is to strip the modules out of luaextra.lua and
replace it with a bunch of require("luaextra-*.lua") calls, and have the
modules separately. If this OK, I can work on it (once having write
access to the git repository).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100111/2e12227f/attachment.bin>

From mpg at elzevir.fr  Wed Jan 13 18:58:50 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Wed, 13 Jan 2010 18:58:50 +0100
Subject: [lltx] Font names database
In-Reply-To: <20100113174244.GD3609@khaled-laptop>
References: <20100112180942.GA18074@khaled-laptop> <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com> <20100113174244.GD3609@khaled-laptop>
Message-ID: <4B4E09DA.3060003@elzevir.fr>

Khaled Hosny a ?crit :
> I've considered using fontconfig (actually my first version were using
> fc-list to list all system font files), but I disregarded it later as we
> can't guarantee fontconfig (or fontconfig tools) are present on all
> systems, also fontconfig tries to do smart things that wouldn't fit our
> needs and we better off parsing font files ourselves.

Can't we assume fontconfig to be present wherever XeTeX is? But we may want to
be more portable that XeTeX indeed.

Just out of curiosity, which kind of "smart" things is fc trying to do?

> (BTW, I usually use a recent GNU/Linux distro and never use Windows as a
> production system, so I might actually need Windows help more than any
> thing else.)
> 
I can do some testing on windows since I have a few virtual machines running XP
for testing purpose. But don't expect any smart idea form me concerning windows,
I know almost nothing about this system.

Manuel,
who just discovered another windows-specific bug in texdoc :-)


From elie.roux at telecom-bretagne.eu  Sat Jan 30 08:04:55 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Sat, 30 Jan 2010 09:04:55 +0200
Subject: [lltx] euenc: sed -E
In-Reply-To: <4B63D770.7080907@telecom-bretagne.eu>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com> <4B63D770.7080907@telecom-bretagne.eu>
Message-ID: <4B63DA17.3070102@telecom-bretagne.eu>

Elie Roux a ?crit :
> Hi,
>
> all these tools are freaking crappy sometimes... they are really 
> non-standards and differents on all platforms...  I tested under GNU 
> and cygwin (the versions are different, and it certainly is different 
> under BSD too) and it worked (which was not the case with the -E 
> option which was not recognized). Maybe it would be best to change 
> '\+' to '*' which seems more widespread? The result will be the same, 
> I don't think the t1lm*.fd files will change a lot...

Oops, Ididn't see you already changed it in the repository... it's OK 
for me as it is now.

Thank you,
-- 
Elie


From khaledhosny at eglug.org  Fri Jan 22 07:41:30 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 22 Jan 2010 08:41:30 +0200
Subject: [lltx] luatexbase
In-Reply-To: <4B576D67.8080508@elzevir.fr>
References: <4B4DAE0A.6060001@elzevir.fr>
 <20100120175448.GA5811@khaled-laptop>
 <4B5749E7.9050802@elzevir.fr>
 <20100120202138.GA7969@khaled-laptop>
 <4B576D67.8080508@elzevir.fr>
Message-ID: <20100122064130.GA3700@khaled-laptop>

On Wed, Jan 20, 2010 at 09:53:59PM +0100, Manuel P?gouri?-Gonnard wrote:
> Khaled Hosny a ?crit :
> > Right, mostly because luaotfload isn't done enough yet. Once we manage
> > to properly implement a font names database, LuaTeX part of Fontspec 2.0
> > should be almost done, bugs aside, but then I doubt we will be able to
> > upload to CTAN since it is unlikely to work with LuaTeX in TeXlive.
> > 
> Well, sorry for being the "pessimistic" guy again, but "bugs aside" can be quite
> a big restriction, and I'm afraid we can expect surpises when people start
> trying it on various systems with various fonts, doing various weird things :-)

True, that is another reason we should concentrate on getting things
done first, then worry about version compatibility later. It doesn't
make any sense to talk about backward incompatibility with half
working/half broken, feature incomplete packages.

> Concerning TL, I'll discuss with Karl if we can just blacklist lualatex stuff
> from our update detection script, so that we can update to CTAN: it would make
> things easier to test for more users, and I think we'll need testing.

Good idea.

> > Later on, once a certain level of functionality is reached, we can setup
> > our texlive repository, lualatex-dev or whatever, and ask interested
> > users to test it, later (my goal is TeXlive 2010) we can declare it
> > stable enough and advertise it to regular users.
> > 
> FYI, plans are to release TL10 earlier than previous years.

Lets hope we'll get things done by time, my todo list is starting to
collapse, hopefully we wll have time to stabilize things and do more
testing.

> > May I
> > suggest "unicode-latex" as a meta package that would take car of loading
> > various XeTeX or LuaTeX packages for the user? (it should essentially be
> > xltxra with LuaTeX support for the time being).
> > 
> I don't like "unicode-latex" so much, since I'm not sure it is clear that
> "unicode" means XeTeX or LuaLaTeX.

That was actually the point, it should load the relevant packages
according to the engine used, though I'm still not sure if it is a good
idea; we don't want to get limited by XeTeX (being the least common
denominator here, flexibility wise). I think Fran?ois's modern-latex is
much better, if we decided to go one common package for different
engines route.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From mpg at elzevir.fr  Wed Jan 20 21:53:59 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Wed, 20 Jan 2010 21:53:59 +0100
Subject: [lltx] luatexbase
In-Reply-To: <20100120202138.GA7969@khaled-laptop>
References: <4B4DAE0A.6060001@elzevir.fr> <20100120175448.GA5811@khaled-laptop> <4B5749E7.9050802@elzevir.fr> <20100120202138.GA7969@khaled-laptop>
Message-ID: <4B576D67.8080508@elzevir.fr>

Khaled Hosny a ?crit :
> OK, I can understand that :) ConTeXt-derived code is API unstable and I
> think Hans has to plans to stabilize it prior LuaTeX 1.0 (and I can
> understand this too :)
> 
Right, and that's another reason for having our own copy of that code, so we can
handle the API changes.

>> For example, the version of fontspec supporting LuaTeX is not
>> release to CTAN, hence widely tested, yet, unless I'm mistaken.
> 
> Right, mostly because luaotfload isn't done enough yet. Once we manage
> to properly implement a font names database, LuaTeX part of Fontspec 2.0
> should be almost done, bugs aside, but then I doubt we will be able to
> upload to CTAN since it is unlikely to work with LuaTeX in TeXlive.
> 
Well, sorry for being the "pessimistic" guy again, but "bugs aside" can be quite
a big restriction, and I'm afraid we can expect surpises when people start
trying it on various systems with various fonts, doing various weird things :-)

Concerning TL, I'll discuss with Karl if we can just blacklist lualatex stuff
from our update detection script, so that we can update to CTAN: it would make
things easier to test for more users, and I think we'll need testing.

> My approach is that to expect the user to be using the latest
> (development) versions of, what I consider, LuaLaTeX bundle, which
> includes right now: luatextra, luaotfload, euenc, fontspec and
> luainputenc, together with latest luatex binary. Any other combination
> is untested and hence unsupported. This way, IMO, we save ourselves lots
> of multiple versions and compatibility headache
> 
Agreed.

> Later on, once a certain level of functionality is reached, we can setup
> our texlive repository, lualatex-dev or whatever, and ask interested
> users to test it, later (my goal is TeXlive 2010) we can declare it
> stable enough and advertise it to regular users.
> 
FYI, plans are to release TL10 earlier than previous years.

> I strongly believe that tight cooperation between the related packages
> will save us LaTeX package incompatibility hell, like the way latex3
> packages are developed for example.
> 
200% agreed.

> I'd rather try to expose the user to as less packages as possible, like
> the way xltxtra abstract the user from several packages,

Sure, it's also the way I see things: many packages for the developpers who want
to minimise dependencies etc, but only one package for the user. That's exactly
what I was suggesting with lltxtra.

> and I'd also
> try to use less confusing names (I like unicode-math for example).

I agree.

> May I
> suggest "unicode-latex" as a meta package that would take car of loading
> various XeTeX or LuaTeX packages for the user? (it should essentially be
> xltxra with LuaTeX support for the time being).
> 
I don't like "unicode-latex" so much, since I'm not sure it is clear that
"unicode" means XeTeX or LuaLaTeX.

Manuel.


From khaledhosny at eglug.org  Wed Jan 13 18:42:44 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 13 Jan 2010 19:42:44 +0200
Subject: [lltx] Font names database
In-Reply-To: <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com>
References: <20100112180942.GA18074@khaled-laptop>
 <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com>
Message-ID: <20100113174244.GD3609@khaled-laptop>

On Wed, Jan 13, 2010 at 02:11:27PM +0200, ?lie Roux wrote:
> I think we should make a first pass generating a table like
> 
> fonts.list = {
>   {
>     fullname = "LMRoman10-Regular",
>     variant = "regular" -- we should normalize the value here
>     size = 10             -- here too
>     familyname = "Latin Modern Roman" -- the thing that will be
> searched first, for compatibility with fc and thus XeTeX
>     family = "LM Roman 10"
>     path = "/path/to/the/file"
> }
> 
> and then making a second pass that generates the table that will be
> written in the file:
> 
> fonts = {
>   familyname = "Latin Modern Roman",
>   alias = "LM Roman 10"
>     {
>       size = 10,  -- can be 0 for any
>         {
>           variant = "regular",
>           fullname = "LMRoman10-Regular"
>           path = "/path/to/the/file"
>         }
>         {
>           variant = "slanted",
>           fullname = "LMRoman10-Slanted"
>           path = "/path/to/the/file"
>         }
>      }
>      {
>        size = 12,
>        {
>           ...
>        }
>      ....
> }
> 
> With this, a single font would fit in a family with this font only,
> and we can do a very quick search on a requested name (only on the
> fields familyname and alias, and then go in the subtree to be more
> precise, etc.). Wdyt?

That is an interesting idea, I have a more or less similar idea, but I
need to think more about it though.

> If you can't use fontconfig on your system I can do this part.
> fontconfig exists under cygwin if it helps, though it would need a
> change from cygwin paths to Windows paths. (cygwin is always a mess
> for programmers...)

I've considered using fontconfig (actually my first version were using
fc-list to list all system font files), but I disregarded it later as we
can't guarantee fontconfig (or fontconfig tools) are present on all
systems, also fontconfig tries to do smart things that wouldn't fit our
needs and we better off parsing font files ourselves.

(BTW, I usually use a recent GNU/Linux distro and never use Windows as a
production system, so I might actually need Windows help more than any
thing else.)

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Wed Jan 20 21:21:38 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 20 Jan 2010 22:21:38 +0200
Subject: [lltx] luatexbase
In-Reply-To: <4B5749E7.9050802@elzevir.fr>
References: <4B4DAE0A.6060001@elzevir.fr>
 <20100120175448.GA5811@khaled-laptop>
 <4B5749E7.9050802@elzevir.fr>
Message-ID: <20100120202138.GA7969@khaled-laptop>

On Wed, Jan 20, 2010 at 07:22:31PM +0100, Manuel P?gouri?-Gonnard wrote:
> > I'd like to move luaextra to
> > luatexbase too (unless stability is a concern, then it should live in
> > its own package),
> 
> I was thinking about it too, and I would prefer a separate package, so that in
> the long run luatexbase can become very stable.

OK, I can understand that :) ConTeXt-derived code is API unstable and I
think Hans has to plans to stabilize it prior LuaTeX 1.0 (and I can
understand this too :)

> > and kill luatextra completely and move document
> > specific parts to xltxtra. I think unifying XeTeX and LuaTeX specific
> > packages would allow smoother user experience, and better
> > maintainability.
> 
> In the long run, it's probably a good idea, but I'm afraid it's a bit too early
> to do this.

Too late, I'm almost done porting xltxra to LuaTeX, there isn't really
much XeTeX specific code there.

> For example, the version of fontspec supporting LuaTeX is not
> release to CTAN, hence widely tested, yet, unless I'm mistaken.

Right, mostly because luaotfload isn't done enough yet. Once we manage
to properly implement a font names database, LuaTeX part of Fontspec 2.0
should be almost done, bugs aside, but then I doubt we will be able to
upload to CTAN since it is unlikely to work with LuaTeX in TeXlive.

> I think (quite strongly) that we should avoid anticipating to much, so that we
> (and users) can build confidence in the lualatex packages. and more generally
> LaTeX on LuaTeX. IMO, XeLaTeX is quite more mature right now.

My approach is that to expect the user to be using the latest
(development) versions of, what I consider, LuaLaTeX bundle, which
includes right now: luatextra, luaotfload, euenc, fontspec and
luainputenc, together with latest luatex binary. Any other combination
is untested and hence unsupported. This way, IMO, we save ourselves lots
of multiple versions and compatibility headache

Later on, once a certain level of functionality is reached, we can setup
our texlive repository, lualatex-dev or whatever, and ask interested
users to test it, later (my goal is TeXlive 2010) we can declare it
stable enough and advertise it to regular users.

I strongly believe that tight cooperation between the related packages
will save us LaTeX package incompatibility hell, like the way latex3
packages are developed for example.


> > The name might be subobtimal, may be we can rename
> > xltxtra to ultxtra (u for Unicode), or even get a better name (I always
> > mistype xltxtra!) and make xltxtra.sty a small wrapper for backward
> > compatibility. Will, what do you think?
> > 
> While talking names, I'm always troubled that luaextra and luatextra have so
> similar names (only one letter difference, and similar pronouncation). I was
> thinking about renaming luaTextra to lltxtra, since it's a xltxtra but for
> luatex. Arguably, it's also only one letter different from an existing package,
> but since you can't pronouce either name, the letter is more prominent (and this
> similarity makes a lot of sense since the packages may be merged later).

I'd rather try to expose the user to as less packages as possible, like
the way xltxtra abstract the user from several packages, and I'd also
try to use less confusing names (I like unicode-math for example). May I
suggest "unicode-latex" as a meta package that would take car of loading
various XeTeX or LuaTeX packages for the user? (it should essentially be
xltxra with LuaTeX support for the time being).

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Sat Jan 30 06:45:07 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 30 Jan 2010 07:45:07 +0200
Subject: [lltx] euenc: sed -E
In-Reply-To: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com>
References: <0697E2E5-5A96-4A54-BD9D-6161E3A78F0C@gmail.com>
Message-ID: <20100130054507.GB2773@khaled-laptop>

On Sat, Jan 30, 2010 at 03:25:27PM +1030, Will Robertson wrote:
> Hi Khaled and Elie,
> 
> The scripts are broken on my machine because anything with [...]+ has been turned into [...]\+, which doesn't seem to work in my version of sed (Mac OS X 10.6). I've changed it into [...]\{1,\} which is ugly but at least works.
> 
> I can't remember if I used + instead of * because of a reason in particular or just because I thought it was a safer choice at the time.
> 
> Damned regexp.

The old (pre Elie) code were working fine for GNU sed on my system, I
don't know what version of sed Elie have. If it were me, I'd just
standarise on GNU sed; it is can be installed on almost all platforms
and this is a one time script, not something end user is supposed to
run anyway.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From khaledhosny at eglug.org  Mon Jan 11 18:44:35 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 11 Jan 2010 19:44:35 +0200
Subject: [lltx] \luanewcommand?
Message-ID: <20100111174435.GA11416@khaled-laptop>


I think it'd be handy to have a \luanewcommand that is similar to
\newcommand but takes luacode instead of TeX macros, so one can do
something like:

\luanewcommand{\hello}[1]{tex.sprint("Hello #1")}

Instead of:
\newcommand{\hello}[1]{\directlua{tex.sprint("Hello #1")}}

This would make lua feel more integrated (and it may take care of spaces
and catcodes etc. so we can use lua comment char '--' etc.)

What do you think?

Regards,
 Khaled

P.S. I don't know enough TeX or LaTeX to dare doing it myself, I tried
looking at perltex.sty, but after few lines I closed the file and
started composing this message :)


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100111/4790c5f9/attachment.bin>

From khaledhosny at eglug.org  Thu Jan 14 05:06:52 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 14 Jan 2010 06:06:52 +0200
Subject: [lltx] Font names database
In-Reply-To: <4B4E09DA.3060003@elzevir.fr>
References: <20100112180942.GA18074@khaled-laptop>
 <eba574421001130411u1853928fn5039dda6bb0983fb@mail.gmail.com>
 <20100113174244.GD3609@khaled-laptop>
 <4B4E09DA.3060003@elzevir.fr>
Message-ID: <20100114040652.GB2200@khaled-laptop>

On Wed, Jan 13, 2010 at 06:58:50PM +0100, Manuel P?gouri?-Gonnard wrote:
> Khaled Hosny a ?crit :
> > I've considered using fontconfig (actually my first version were using
> > fc-list to list all system font files), but I disregarded it later as we
> > can't guarantee fontconfig (or fontconfig tools) are present on all
> > systems, also fontconfig tries to do smart things that wouldn't fit our
> > needs and we better off parsing font files ourselves.
> 
> Can't we assume fontconfig to be present wherever XeTeX is? But we may want to
> be more portable that XeTeX indeed.

Do TeXlive (or other TeX distributions) ship fontconfig's command line
tools? I think they are only shipping the library and we can't use the
library directly, unless someone writes luafontconfig binding and make
it work with LuaTeX. So we can only expect fontconfig on modern
GNU/Linux systems, not even sure about *BSD.

> Just out of curiosity, which kind of "smart" things is fc trying to do?

I don't know :) If I'd known, I wouldn't started this discussion at all,
even XeTeX does font parsing on its own (for SFNT fonts at least). I
also find the output of fc tools cryptic and inconsistent, but it may be
just me.
 
Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


