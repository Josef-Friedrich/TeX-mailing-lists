From elie.roux at telecom-bretagne.eu  Tue Dec  7 17:31:18 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Tue, 07 Dec 2010 17:31:18 +0100
Subject: [lltx] testing latest otf code
Message-ID: <4CFE6156.2000006@telecom-bretagne.eu>

Hello,

I have a tibetan font which seems to have problems with LuaTeX, but i'm 
not sure as I don't have the latest version of the font loading 
system... I'm on debian and I don't have a texlive 2010 installed. I 
tried to update luaotfload to the latest github code, but it needed a 
more recent luatexbase, which I also updated to the latest github code, 
but now I have an error telling me that log() is nil at line 45 of 
luaotfload.lua... I tried to define a dumb log() version, but now I'm 
not sure if it's really supposed to work fine with my luatexbase, as it 
also kept regenerating my font database and scanning all fonts (not only 
the ones not already seen).

So I tried to get the latest ConTeXt code, namely luatex-fonts.lua, but 
I cannot find it anymore on 
http://source.contextgarden.net/tex/generic/context.

Are these problems normal (in the sense that I should have TeXLive 
2010)? Where can I get the latest luatex-fonts.lua?

Thank you,
-- 
Elie

From khaledhosny at eglug.org  Tue Dec  7 17:47:55 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 7 Dec 2010 18:47:55 +0200
Subject: [lltx] testing latest otf code
In-Reply-To: <4CFE6156.2000006@telecom-bretagne.eu>
References: <4CFE6156.2000006@telecom-bretagne.eu>
Message-ID: <20101207164754.GA14185@khaled-laptop>

On Tue, Dec 07, 2010 at 05:31:18PM +0100, Elie Roux wrote:
> Hello,
> 
> I have a tibetan font which seems to have problems with LuaTeX, but
> i'm not sure as I don't have the latest version of the font loading
> system... I'm on debian and I don't have a texlive 2010 installed. I
> tried to update luaotfload to the latest github code, but it needed
> a more recent luatexbase, which I also updated to the latest github
> code, but now I have an error telling me that log() is nil at line
> 45 of luaotfload.lua... I tried to define a dumb log() version, but
> now I'm not sure if it's really supposed to work fine with my
> luatexbase, as it also kept regenerating my font database and
> scanning all fonts (not only the ones not already seen).

The version uploaded to CTAN should work fine together, I'm not sure
what is the status of the luatexbase on github, but here texlive2010
every thing seems to be fine.

> 
> So I tried to get the latest ConTeXt code, namely luatex-fonts.lua,
> but I cannot find it anymore on
> http://source.contextgarden.net/tex/generic/context.
> 
> Are these problems normal (in the sense that I should have TeXLive
> 2010)? Where can I get the latest luatex-fonts.lua?

No idea, ask Hans.

Anyway, Indic scripts are not supported (unless you are not using any
Indic specific features and doing all the processing yourself using
generic features). Hans can probably support Indic scripts if given a
clear specification and a set of tests (last I heard Indic OT
specification was a mess with MS releasing incompatible specs with every
new Windows release; non of the free OT engines have a reliable Indic
support.)

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From elie.roux at telecom-bretagne.eu  Tue Dec  7 18:02:55 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Tue, 07 Dec 2010 18:02:55 +0100
Subject: [lltx] testing latest otf code
In-Reply-To: <20101207164754.GA14185@khaled-laptop>
References: <4CFE6156.2000006@telecom-bretagne.eu>
 <20101207164754.GA14185@khaled-laptop>
Message-ID: <4CFE68BF.8050003@telecom-bretagne.eu>

Khaled Hosny a ?crit :
> 
> Anyway, Indic scripts are not supported (unless you are not using any
> Indic specific features and doing all the processing yourself using
> generic features). Hans can probably support Indic scripts if given a
> clear specification and a set of tests (last I heard Indic OT
> specification was a mess with MS releasing incompatible specs with every
> new Windows release; non of the free OT engines have a reliable Indic
> support.)

Ok, I didn't know that... In fact TibetanMachineUni.ttf 
(http://norgz.guiling.fr/TibetanMachineUni.ttf) seemed to be working 
just fine with LuaTeX (before I messed up everything), and I have the 
feeling that some other fonts I have but are not working (such as 
http://norgz.guiling.fr/UChen.ttf) are made the same way... You can try 
for instance with a simple stack like ????, the stacking isn't OK...

But anyway the problem I got is lua errors appearing in some otfl-node-* 
files, and I'd like to see if the latest versions are still buggy...

Also, I just updated LuaTeX binary to latest svn version, and now this 
bug appears:

luaotfload | Font names database loaded: 
/home/eroux/.texmf-var/luatex-cache/ge
neric/names/otfl-names.lua
luaotfload | Updating the font names database:
luaotfload | Scanning TEXMF fonts...
! LuaTeX error /home/eroux/texmf/tex/norgzextra/lualibs-dir.lua:37: bad 
argumen
t #1 to '(for generator)' (directory metatable expected, got nil).

Thank you,
-- 
Elie

From mpg at elzevir.fr  Tue Dec  7 18:13:04 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Tue, 07 Dec 2010 18:13:04 +0100
Subject: [lltx] testing latest otf code
In-Reply-To: <20101207164754.GA14185@khaled-laptop>
References: <4CFE6156.2000006@telecom-bretagne.eu>
 <20101207164754.GA14185@khaled-laptop>
Message-ID: <4CFE6B20.9090008@elzevir.fr>

Le 07/12/2010 17:47, Khaled Hosny a ?crit :
> The version uploaded to CTAN should work fine together, I'm not sure
> what is the status of the luatexbase on github, but here texlive2010
> every thing seems to be fine.
> 
I confirm. Currently, luatex on github is the same as on CTAN, ie 0.3.

Also, luaotfload comes with a bunch of test files which compile fine on my
machine. ?lie, I suggest you compile them to make sure there is nothing wrong
with your installation, before trying more "exotic" stuff with Indic scripts.

Manuel.

From khaledhosny at eglug.org  Tue Dec  7 18:29:02 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 7 Dec 2010 19:29:02 +0200
Subject: [lltx] testing latest otf code
In-Reply-To: <4CFE68BF.8050003@telecom-bretagne.eu>
References: <4CFE6156.2000006@telecom-bretagne.eu>
 <20101207164754.GA14185@khaled-laptop>
 <4CFE68BF.8050003@telecom-bretagne.eu>
Message-ID: <20101207172902.GA32259@khaled-laptop>

On Tue, Dec 07, 2010 at 06:02:55PM +0100, Elie Roux wrote:
> Khaled Hosny a ?crit :
> >
> >Anyway, Indic scripts are not supported (unless you are not using any
> >Indic specific features and doing all the processing yourself using
> >generic features). Hans can probably support Indic scripts if given a
> >clear specification and a set of tests (last I heard Indic OT
> >specification was a mess with MS releasing incompatible specs with every
> >new Windows release; non of the free OT engines have a reliable Indic
> >support.)
> 
> Ok, I didn't know that... In fact TibetanMachineUni.ttf
> (http://norgz.guiling.fr/TibetanMachineUni.ttf) seemed to be working
> just fine with LuaTeX (before I messed up everything), and I have
> the feeling that some other fonts I have but are not working (such
> as http://norgz.guiling.fr/UChen.ttf) are made the same way... You
> can try for instance with a simple stack like ????, the stacking isn't
> OK...

I claim no understanding of Indic OT stuff, but AFAIK there are several
reordering and Indic specific positioning features that require engine
level support and can't be handled just like generic features, and that
specific support is what we are lacking.

> But anyway the problem I got is lua errors appearing in some
> otfl-node-* files, and I'd like to see if the latest versions are
> still buggy...
> 
> Also, I just updated LuaTeX binary to latest svn version, and now
> this bug appears:

You shouldn't, luatex trunk contains several incompatible changes that
is to break current code (some in the lfs module, thus the errors you
see). Only versions on CTAN and texlive2010 of anything are tested.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From pragma at wxs.nl  Tue Dec  7 18:36:04 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 07 Dec 2010 18:36:04 +0100
Subject: [lltx] testing latest otf code
In-Reply-To: <4CFE6156.2000006@telecom-bretagne.eu>
References: <4CFE6156.2000006@telecom-bretagne.eu>
Message-ID: <4CFE7084.8090307@wxs.nl>

On 7-12-2010 5:31, Elie Roux wrote:
> Hello,
>
> I have a tibetan font which seems to have problems with LuaTeX, but i'm
> not sure as I don't have the latest version of the font loading
> system... I'm on debian and I don't have a texlive 2010 installed. I
> tried to update luaotfload to the latest github code, but it needed a
> more recent luatexbase, which I also updated to the latest github code,
> but now I have an error telling me that log() is nil at line 45 of
> luaotfload.lua... I tried to define a dumb log() version, but now I'm
> not sure if it's really supposed to work fine with my luatexbase, as it
> also kept regenerating my font database and scanning all fonts (not only
> the ones not already seen).
>
> So I tried to get the latest ConTeXt code, namely luatex-fonts.lua, but
> I cannot find it anymore on
> http://source.contextgarden.net/tex/generic/context.

looks quite old, best take the regular cont-tmf zip, but afaik Khaled 
handles all that for latex

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Dec  7 18:36:57 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 07 Dec 2010 18:36:57 +0100
Subject: [lltx] testing latest otf code
In-Reply-To: <20101207164754.GA14185@khaled-laptop>
References: <4CFE6156.2000006@telecom-bretagne.eu>
 <20101207164754.GA14185@khaled-laptop>
Message-ID: <4CFE70B9.2010109@wxs.nl>

On 7-12-2010 5:47, Khaled Hosny wrote:

> Anyway, Indic scripts are not supported (unless you are not using any
> Indic specific features and doing all the processing yourself using
> generic features). Hans can probably support Indic scripts if given a
> clear specification and a set of tests (last I heard Indic OT

indeed we need specs and proper fonts and good examples

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From elie.roux at telecom-bretagne.eu  Tue Dec  7 18:38:30 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Tue, 07 Dec 2010 18:38:30 +0100
Subject: [lltx] testing latest otf code
In-Reply-To: <20101207172902.GA32259@khaled-laptop>
References: <4CFE6156.2000006@telecom-bretagne.eu>
 <20101207164754.GA14185@khaled-laptop> <4CFE68BF.8050003@telecom-bretagne.eu>
 <20101207172902.GA32259@khaled-laptop>
Message-ID: <4CFE7116.4090706@telecom-bretagne.eu>

Khaled Hosny a ?crit :
> 
> I claim no understanding of Indic OT stuff, but AFAIK there are several
> reordering and Indic specific positioning features that require engine
> level support and can't be handled just like generic features, and that
> specific support is what we are lacking.

I see... though I really don't see any difficulty with tibetan (I don't 
know anything about sanskrit or other indic scripts), the stack system 
is very basic as Unicode has been really well done.

> You shouldn't, luatex trunk contains several incompatible changes that
> is to break current code (some in the lfs module, thus the errors you
> see). Only versions on CTAN and texlive2010 of anything are tested.

I see, I'll keep my previous version. With CTAN versions (sorry, in fact 
I didn't event thought about CTAN to get working versions...), it seems 
to be working fine. There are still very minor problems, but LuaTeX 
seems to handle the fonts fine, I don't where the error came from.

Anyway, the database is still regenerated every time I compile a 
document, I'll try to see where it comes from and report it.

Thank you!
-- 
Elie

From khaledhosny at eglug.org  Tue Dec  7 18:53:36 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 7 Dec 2010 19:53:36 +0200
Subject: [lltx] testing latest otf code
In-Reply-To: <4CFE7116.4090706@telecom-bretagne.eu>
References: <4CFE6156.2000006@telecom-bretagne.eu>
 <20101207164754.GA14185@khaled-laptop>
 <4CFE68BF.8050003@telecom-bretagne.eu>
 <20101207172902.GA32259@khaled-laptop>
 <4CFE7116.4090706@telecom-bretagne.eu>
Message-ID: <20101207175336.GA11568@khaled-laptop>

On Tue, Dec 07, 2010 at 06:38:30PM +0100, Elie Roux wrote:
> Khaled Hosny a ?crit :
> >
> >I claim no understanding of Indic OT stuff, but AFAIK there are several
> >reordering and Indic specific positioning features that require engine
> >level support and can't be handled just like generic features, and that
> >specific support is what we are lacking.
> 
> I see... though I really don't see any difficulty with tibetan (I
> don't know anything about sanskrit or other indic scripts), the
> stack system is very basic as Unicode has been really well done.
> 
> >You shouldn't, luatex trunk contains several incompatible changes that
> >is to break current code (some in the lfs module, thus the errors you
> >see). Only versions on CTAN and texlive2010 of anything are tested.
> 
> I see, I'll keep my previous version. With CTAN versions (sorry, in
> fact I didn't event thought about CTAN to get working versions...),
> it seems to be working fine. There are still very minor problems,
> but LuaTeX seems to handle the fonts fine, I don't where the error
> came from.
> 
> Anyway, the database is still regenerated every time I compile a
> document, I'll try to see where it comes from and report it.

Are you using fontspec? May be you are asking for a font style that does
not exist (e.g. \setmainfont{foo} where foo has no bold or so).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From adityam at umich.edu  Tue Dec  7 19:11:58 2010
From: adityam at umich.edu (Aditya Mahajan)
Date: Tue, 7 Dec 2010 13:11:58 -0500 (EST)
Subject: [lltx] testing latest otf code
In-Reply-To: <4CFE7084.8090307@wxs.nl>
References: <4CFE6156.2000006@telecom-bretagne.eu> <4CFE7084.8090307@wxs.nl>
Message-ID: <alpine.LNX.2.01.1012071310370.28039@ybpnyubfg.ybpnyqbznva>

On Tue, 7 Dec 2010, Hans Hagen wrote:

> On 7-12-2010 5:31, Elie Roux wrote:
>> So I tried to get the latest ConTeXt code, namely luatex-fonts.lua, but
>> I cannot find it anymore on
>> http://source.contextgarden.net/tex/generic/context.
>
> looks quite old,

contextgarden has not been updated in a while and is still using version 
2010.03.30. See http://live.contextgarden.net/

Aditya

From Damien.Robert__sent01 at normalesup.org  Fri Dec 10 22:02:14 2010
From: Damien.Robert__sent01 at normalesup.org (Damien Robert)
Date: Fri, 10 Dec 2010 22:02:14 +0100
Subject: [lltx] luacolor bug
Message-ID: <20101210210214.GA6629@phare.normalesup.org>

Hi everyone.

I hope I am sending this to the right mailing list. I have been playing
with lualatex, and stumbled upon some bugs. These bugs are with the
texlive-2010 packages, upgraded as of today.

1) A bug in latextra:

\documentclass{minimal}
\usepackage{luatextra}
\begin{document}
\setromanfont{Latin Modern Roman} Test
\setmainfont{Latin Modern Roman} Test
\fontspec{Latin Modern Roman} Test
\end{document}

This document prints some \@tempswatrue\@tempswafalse on the document after
each call to fontspec. A workaround is to load fontspec before luatextra.

2) A bug in luacolor:

\documentclass{minimal}
\usepackage{fontspec}
\usepackage{luacolor}
\defaultfontfeatures{Ligatures=TeX}
\setmainfont{Latin Modern Roman} 
\begin{document}
Foo--Bar---Foo
\end{document}

luacolor breaks the Tex Ligatures. I think it also breaks Font expansion
and protusion, but it is easier to see on the ligature. Loading luacolor
before fontspec solves the problem _in this example_, but it is quite
fragile. When I activate Font expansion and protusion and loads some other
packages, the TeX ligatures are still broken even when loading luacolor
before fontspec (I did not quite manage to produce a minimal example for
this case, I can try if you wish to).

3) fontspec loads xunicode which is incompatible with amssymb (if amssymb
   is loaded after fontspec). A quick
   search on google show that people are aware of this bug, but I don't
   know if the last two bugs are new.



From mpg at elzevir.fr  Sat Dec 11 17:42:11 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sat, 11 Dec 2010 17:42:11 +0100
Subject: [lltx] luacolor bug
In-Reply-To: <20101210210214.GA6629@phare.normalesup.org>
References: <20101210210214.GA6629@phare.normalesup.org>
Message-ID: <4D03A9E3.6000603@elzevir.fr>

Hi Damien,

Le 10/12/2010 22:02, Damien Robert a ?crit :
> 1) A bug in latextra:
> 
> \documentclass{minimal}
> \usepackage{luatextra}
> \begin{document}
> \setromanfont{Latin Modern Roman} Test
> \setmainfont{Latin Modern Roman} Test
> \fontspec{Latin Modern Roman} Test
> \end{document}
> 
> This document prints some \@tempswatrue\@tempswafalse on the document after
> each call to fontspec. A workaround is to load fontspec before luatextra.
> 
Funny one indeed. I'll investigate.

> luacolor breaks the Tex Ligatures. [...]

I'm note sure if Heiko reads this list on a regular basis. If he doesn't reply
in a few days, it's probably safer to write him directly.

Thanks for your report,
Manuel.

From heiko.oberdiek at googlemail.com  Sat Dec 11 20:01:48 2010
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Sat, 11 Dec 2010 20:01:48 +0100
Subject: [lltx] luacolor bug
In-Reply-To: <4D03A9E3.6000603@elzevir.fr>
References: <20101210210214.GA6629@phare.normalesup.org>
 <4D03A9E3.6000603@elzevir.fr>
Message-ID: <20101211190147.GA8418@oberdiek.my-fqdn.de>

On Sat, Dec 11, 2010 at 05:42:11PM +0100, Manuel P?gouri?-Gonnard wrote:

> Le 10/12/2010 22:02, Damien Robert a ?crit :
> > 1) A bug in latextra:
> > 
> > \documentclass{minimal}
> > \usepackage{luatextra}
> > \begin{document}
> > \setromanfont{Latin Modern Roman} Test
> > \setmainfont{Latin Modern Roman} Test
> > \fontspec{Latin Modern Roman} Test
> > \end{document}
> > 
> > This document prints some \@tempswatrue\@tempswafalse on the document after
> > each call to fontspec. A workaround is to load fontspec before luatextra.
> > 
> Funny one indeed. I'll investigate.
> 
> > luacolor breaks the Tex Ligatures. [...]
> 
> I'm note sure if Heiko reads this list on a regular basis. If he doesn't reply
> in a few days, it's probably safer to write him directly.

I have already read it and have started experimenting, but no time
to finish. At least it seems to work, if luacolor is loaded
before fontspec.
  The funny things I have seen:
* \pdfliteral direct0 g 0 G
  (missing curly braces around "0 g 0 G" of the \pdfliteral whatsit,
  inserted by luacolor).
* segementation fault in some configuration (hopefully I can repeat
  this scenario, because this is a LuaTeX bug).

Yours sincerely
  Heiko Oberdiek

From heiko.oberdiek at googlemail.com  Sun Dec 12 02:43:29 2010
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Sun, 12 Dec 2010 02:43:29 +0100
Subject: [lltx] luacolor bug
In-Reply-To: <20101210210214.GA6629@phare.normalesup.org>
References: <20101210210214.GA6629@phare.normalesup.org>
Message-ID: <20101212014328.GA13495@oberdiek.my-fqdn.de>

On Fri, Dec 10, 2010 at 10:02:14PM +0100, Damien Robert wrote:

> 2) A bug in luacolor:
> 
> \documentclass{minimal}
> \usepackage{fontspec}
> \usepackage{luacolor}
> \defaultfontfeatures{Ligatures=TeX}
> \setmainfont{Latin Modern Roman} 
> \begin{document}
> Foo--Bar---Foo
> \end{document}
> 
> luacolor breaks the Tex Ligatures.

luacolor.sty loads luatex.sty that is not yet adopted to lualatexbase
(sorry I haven't returned to the luatex stuff yet).
Workaround:

\let\newattribute\newluatexattribute
\usepackage{luacolor}

Yours sincerely
  Heiko Oberdiek

PS:
Probably I will switch to luatexbase-attr.sty for luacolor
that also loads luatexbase-compat.sty. I found two problems
so far:

* [luatexbase-compat.sty]
  Bug: Missing curly braces:
    \luatexbase at directlua{tex.enableprimitives('luatex', '#1')}}
  should be:
    \luatexbase at directlua{tex.enableprimitives('luatex', {'#1'})}}

* [luatexbase-compat.sty]
  If eTeX isn't enabled, then \ifcsname isn't available.
  Perhaps it can be enabled before \begingroup:

\ifnum\luatexversion<37 %
\else
  \begingroup\expandafter\expandafter\expandafter\endgroup
  \expandafter\ifx\csname ifcsname\endcsname\relax
    \directlua{tex.enableprimitives('',{'ifcsname'})}%
  \fi
\fi
\begingroup % original line
...
\def\y#1{}%
\begingroup\expandafter\expandafter\expandafter\endgroup
\expandafter\ifx\csname ifcsname\endcsname\relax
  \x{%
    \begingroup\expandafter\expandafter\expandafter\endgroup
    \expandafter\ifx\csname luatex#1\endcsname\relax
    \else
  }%
  \y\fi
\else
  \x{%
    \ifcsname luatex#1\endcsname
    \else
  }%
  \y\fi
\fi
\ifnum\luatexversion<37\relax % original line

From mpg at elzevir.fr  Sun Dec 12 04:08:42 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sun, 12 Dec 2010 04:08:42 +0100
Subject: [lltx] luacolor bug
In-Reply-To: <20101212014328.GA13495@oberdiek.my-fqdn.de>
References: <20101210210214.GA6629@phare.normalesup.org>
 <20101212014328.GA13495@oberdiek.my-fqdn.de>
Message-ID: <4D043CBA.8060005@elzevir.fr>

Le 12/12/2010 02:43, Heiko Oberdiek a ?crit :
> * [luatexbase-compat.sty]
>   Bug: Missing curly braces:
>     \luatexbase at directlua{tex.enableprimitives('luatex', '#1')}}
>   should be:
>     \luatexbase at directlua{tex.enableprimitives('luatex', {'#1'})}}
> 
Good catch. It seems the path leading to this line of code is never taken in any
the 'luatex' and 'lualatex' formats with TL 2008, 2009, 2010 (and probably
MikTeX 2.9 whose formats should match those of TL 2010).

Anyway, I just fixed it.

> * [luatexbase-compat.sty]
>   If eTeX isn't enabled, then \ifcsname isn't available.

The package already throws an error if LuaTeX isn't used. AFAIK, every
luatex-based format has e-TeX enable. So, relying e-TeX was a deliberate choice.
If you feel this choice is not reasonable, I'm open to discussion.

At least, I should document that, and maybe add a check for e-TeX at the
beginning of the package too.

Manuel.

From mpg at elzevir.fr  Tue Dec 14 05:54:17 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Tue, 14 Dec 2010 05:54:17 +0100
Subject: [lltx] luacolor bug
In-Reply-To: <20101210210214.GA6629@phare.normalesup.org>
References: <20101210210214.GA6629@phare.normalesup.org>
Message-ID: <4D06F879.2000606@elzevir.fr>

Le 10/12/2010 22:02, Damien Robert a ?crit :
> 1) A bug in latextra:
> 
> \documentclass{minimal} \usepackage{luatextra} \begin{document} 
> \setromanfont{Latin Modern Roman} Test \setmainfont{Latin Modern Roman} Test 
> \fontspec{Latin Modern Roman} Test \end{document}
> 
> This document prints some \@tempswatrue\@tempswafalse on the document after 
> each call to fontspec. A workaround is to load fontspec before luatextra.
> 
I implemented this workaround in luatextra for now, by loading fontspec earlier.
Version 1.0.1, with this workaround, is on its way to CTAN.

Without going to full details, the core problem is the following: fontspec loads
expl3, which loads luatex.sty, but also loads luaotfload, which loads
luatexbase. Currently, luatex.sty and luatexbase are incompatible, since they
define/patch mostly the same macros. (Heiko and I plan to fix this some day, in
case it wasn't obvious.)

Manuel.

From patrick at gundla.ch  Wed Dec 15 10:47:38 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 15 Dec 2010 10:47:38 +0100
Subject: [lltx] Use system font Monaco on Mac OS X
Message-ID: <4ECE3725-590B-4157-B8F1-834BE9086EE1@gundla.ch>

Hi,

this is a repost/the same as http://tex.stackexchange.com/questions/7027/lualatex-use-system-font-monaco-on-mac-os-x

The answer I got "copy the font somewhere else" seems to me like a workaround. Wolfgang Schuster told me that with ConTeXt it is possible to use fonts from a system folder.

The post:
-------------------------------------------------------------------------------------------------------------------------

I'd like to use the Mac OS X (.dfont) Monaco with LuaLaTeX. With this input file

\documentclass{article}
\usepackage{fontspec}
\setmonofont{Monaco}
\begin{document}
\begin{verbatim}
    foo
\end{verbatim}
\end{document}

I get the following error message:

luaotfload | Font names database not found, generating new one.
             This can take several minutes; please be patient.
luaotfload | Updating the font names database:
luaotfload | Scanning TEXMF fonts...
luaotfload | Scanning OS fonts...
! LuaTeX error ...0/texmf-dist/tex/luatex/luaotfload/otfl-luat-dum.lua:67: bad 
argument #2 to 'find_file' (invalid option 'truetype dictionary').
<to be read again> 
                   \scan_stop: 
l.3 \setmonofont{Monaco}

This is the file list:


*File List*
 article.cls    2007/10/19 v1.4h Standard LaTeX document class
  size10.clo    2007/10/19 v1.4h Standard LaTeX file (size option)
fontspec.sty    2010/09/29 v2.1b Advanced font selection for XeLaTeX/LuaLaTeX
   expl3.sty    2010/09/16 v2022 L3 Experimental code bundle wrapper
 l3names.sty    2010/09/26 v2048 L3 Experimental Naming Scheme for TeX Primitives
  luatex.sty    2010/03/09 v0.4 LuaTeX basic definition package (HO)
infwarerr.sty    2010/04/08 v1.3 Providing info/warning/message (HO)
ifluatex.sty    2010/03/01 v1.3 Provides the ifluatex switch (HO)
    etex.sty    1998/03/26 v2.0 eTeX basic definition package (PEB)
luatex-loader.sty    2010/03/09 v0.4 Lua module loader (HO)
pdftexcmds.sty    2010/04/01 v0.9 Utility functions of pdfTeX for LuaTeX (HO)
 ltxcmds.sty    2010/04/26 v1.7 LaTeX kernel commands for general use (HO)
l3basics.sty    2010/09/20 v2037 L3 Experimental basic definitions
 l3expan.sty    2010/09/20 v2037 L3 Experimental Argument Expansion module
    l3tl.sty    2010/09/21 v2040 L3 Experimental Token Lists
l3intexpr.sty    2010/09/22 v2045 L3 Integer Expressions
 l3quark.sty    2010/09/20 v2036 L3 Experimental Quark Commands
   l3seq.sty    2010/03/29 v1879 L3 Experimental sequences and stacks
  l3toks.sty    2010/09/20 v2037 L3 Experimental Token Registers
   l3int.sty    2010/09/19 v2029 L3 Experimental Integer module
   l3prg.sty    2010/09/22 v2043 L3 Experimental control structures
 l3clist.sty    2010/09/20 v2037 L3 Experimental comma separated lists
 l3token.sty    2010/09/19 v2029 L3 Experimental token investigation and manipulation
  l3prop.sty    2010/03/21 v1857 L3 Experimental Property Lists
   l3msg.sty    2010/03/23 v1866 L3 Experimental LaTeX Messages module
    l3io.sty    2010/05/22 v1923 L3 Experimental i/o module
  l3skip.sty    2010/09/23 v2047 L3 Experimental skip registers
   l3box.sty    2010/09/26 v2048 L3 Experimental Box module
l3keyval.sty    2010/04/11 v1890 L3 Experimental keyval processing
  l3keys.sty    2010/05/24 v1931 L3 Experimental key-value support
l3precom.sty    2010/02/09 v1793 L3 Experimental precompilation module
  l3xref.sty    2010/02/09 v1786 L3 Experimental cross referencing
  l3file.sty    2010/03/21 v1853 L3 Experimental file loading
    l3fp.sty    2010/09/19 v2029 L3 Experimental floating-point operations
l3luatex.sty    2010/07/18 v1985 L3 Experimental LuaTeX functions
    calc.sty    2007/08/22 v4.3 Infix arithmetic (KKT,FJ)
  xparse.sty    2010/09/20 v2037 Generic document command parser
luatextra.sty    2010/08/02 v0.971 LuaTeX extra low-level macros
luatexbase-modutils.sty    2010/05/27 v0.2a Module utilities for LuaTeX
luatexbase-loader.sty    2010/05/27 v0.2a Lua module loader for LuaTeX
luatexbase-compat.sty    2010/05/27 v0.2a Compatibility tools for LuaTeX
luatexbase-attr.sty    2010/05/27 v0.2a Attributes allocation for LuaTeX
luatexbase-cctb.sty    2010/05/27 v0.2a Catcodetable allocation for LuaTeX
luatexbase-regs.sty    2010/05/27 v0.2a Registers allocation for LuaTeX
luatexbase-mcb.sty    2010/05/27 v0.2a Callback management for LuaTeX
 environ.sty    2008/06/18 v0.2 A new way to define environments
luaotfload.sty    2010/09/12 v1.19 OpenType layout system
 xkeyval.sty    2008/08/13 v2.6a package option processing (HA)
 xkeyval.tex    2008/08/13 v2.6a key=value parser (HA)
fontspec-patches.sty    2010/09/29 v2.1b Advanced font selection for XeLaTeX/LuaLaTeX
fixltx2e.sty    2006/09/13 v1.1m fixes to LaTeX
 fontenc.sty
  eu2enc.def    2010/05/27 v0.1h Experimental Unicode font encodings
  eu2lmr.fd    2009/10/30 v1.6 Font defs for Latin Modern
xunicode.sty    2010/05/18 v0.95 provides access to latin accents and many other characters in Unicode lower plane
fontspec.cfg

and this is what luatex --version tells me:

This is LuaTeX, Version beta-0.64.0-2010111215

Now the question is: what do I need to do in order to use Monaco with LuaLaTeX?

-------------------------------------------------------------------------------------------------------------------------


Thanks

Patrick




From taco at elvenkind.com  Wed Dec 15 11:18:50 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Dec 2010 11:18:50 +0100
Subject: [lltx] Use system font Monaco on Mac OS X
In-Reply-To: <4ECE3725-590B-4157-B8F1-834BE9086EE1@gundla.ch>
References: <4ECE3725-590B-4157-B8F1-834BE9086EE1@gundla.ch>
Message-ID: <4D08960A.20000@elvenkind.com>



On 12/15/10 10:47, Patrick Gundlach wrote:
> 
> \documentclass{article}
> \usepackage{fontspec}
> \setmonofont{Monaco}
> \begin{document}
> \begin{verbatim}
>     foo
> \end{verbatim}
> \end{document}
> 
> I get the following error message:
> 
> luaotfload | Font names database not found, generating new one.
>              This can take several minutes; please be patient.
> luaotfload | Updating the font names database:
> luaotfload | Scanning TEXMF fonts...
> luaotfload | Scanning OS fonts...
> ! LuaTeX error ...0/texmf-dist/tex/luatex/luaotfload/otfl-luat-dum.lua:67: bad 
> argument #2 to 'find_file' (invalid option 'truetype dictionary').

kpse doesn't know about 'truetype dictionary' as a file type to search
for, it only knows about 'truetype fonts' (which can be ttc files).
Context's file finder (that does not use kpse) does indeed have
'truetype dictionary' as an actual file type, so that is probably
where the find_file() error comes from.

Nevertheless, the font should have been discovered by an earlier
attempt, so that is not the cause of the problem, I think.

Best wishes,
Taco


From oinos at web.de  Tue Dec 21 23:28:19 2010
From: oinos at web.de (=?ISO-8859-1?Q?Pablo_Rodr=EDguez?=)
Date: Tue, 21 Dec 2010 23:28:19 +0100
Subject: [lltx] polytonic Greek hyphenation
Message-ID: <4D112A03.1080301@web.de>

Hi there,

almost three months ago I asked in the tex-hyphen mailing list about the 
possibility of (polytonic) Greek hyphenation and I was told that you 
were working on a fix to that.

My only question is: when do you expect to release the fix?

Thanks for your help,


Pablo
-- 
http://www.ousia.tk

From mpg at elzevir.fr  Wed Dec 22 00:28:03 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Wed, 22 Dec 2010 00:28:03 +0100
Subject: [lltx] polytonic Greek hyphenation
In-Reply-To: <4D112A03.1080301@web.de>
References: <4D112A03.1080301@web.de>
Message-ID: <4D113803.8050804@elzevir.fr>

Le 21/12/2010 23:28, Pablo Rodr?guez a ?crit :
> almost three months ago I asked in the tex-hyphen mailing list about the 
> possibility of (polytonic) Greek hyphenation and I was told that you 
> were working on a fix to that.
> 
> My only question is: when do you expect to release the fix?
> 
I can't remember exactly what the the problem was, but if it was about catcodes,
then the fix is available in TeX Live since October 9.

If it was about something else, a link to the original discussion may be
helpful, unless someone else one the list remembers better than me.

Manuel.

From oinos at web.de  Wed Dec 22 12:49:41 2010
From: oinos at web.de (=?ISO-8859-1?Q?Pablo_Rodr=EDguez?=)
Date: Wed, 22 Dec 2010 12:49:41 +0100
Subject: [lltx] polytonic Greek hyphenation
In-Reply-To: <4D113803.8050804@elzevir.fr>
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
Message-ID: <4D11E5D5.1030100@web.de>

On 12/22/2010 12:28 AM, Manuel P?gouri?-Gonnard wrote:
> Le 21/12/2010 23:28, Pablo Rodr?guez a ?crit :
>> almost three months ago I asked in the tex-hyphen mailing list about the
>> possibility of (polytonic) Greek hyphenation and I was told that you
>> were working on a fix to that.
>>
>> My only question is: when do you expect to release the fix?
>>
> I can't remember exactly what the the problem was, but if it was about catcodes,
> then the fix is available in TeX Live since October 9.

Thanks for your reply, Manuel.

This is all Greek to me. As far as I can remember, catcodes were 
discussed, but with TeXLive 2010 updated yesterday polytonic Greek isn't 
hyphenated at all.

> If it was about something else, a link to the original discussion may be
> helpful, unless someone else one the list remembers better than me.

Sorry, it was my fault.

The thread-starting message is 
http://tug.org/pipermail/tex-hyphen/2010-September/000701.html, but the 
message that contains actual supposed-to-work code is 
http://tug.org/pipermail/tex-hyphen/2010-September/000704.html.

Thanks for your help,


Pablo
-- 
http://www.ousia.tk

From news3 at nililand.de  Wed Dec 22 13:52:47 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Wed, 22 Dec 2010 13:52:47 +0100
Subject: [lltx] polytonic Greek hyphenation
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de>
Message-ID: <p0jx9xut78db$.dlg@nililand.de>

Am Wed, 22 Dec 2010 12:49:41 +0100 schrieb Pablo Rodr?guez:

>>> almost three months ago I asked in the tex-hyphen mailing list about the
>>> possibility of (polytonic) Greek hyphenation and I was told that you
>>> were working on a fix to that.

>> I can't remember exactly what the the problem was, but if it was about catcodes,
>> then the fix is available in TeX Live since October 9.
 
> Thanks for your reply, Manuel.
 
> This is all Greek to me. As far as I can remember, catcodes were 
> discussed, but with TeXLive 2010 updated yesterday polytonic Greek isn't 
> hyphenated at all.

Your example in the old thread (with \usepackage[greek]{babel})
works fine for me (miktex 2.9 + lualatex). I don't read greek but
showhyphens shows   ??-??-?? and I see one hyphenated word in the
text.

To get it working you need 

1. a current lualatex.ini which contains the line
\input luatex-unicode-letters.tex

2. the luatex-unicode-letters.tex

3. A lualatex format which has been generated with the above
lualatex.ini

4. I also needed to activate the greek patterns in miktex settings.

-- 
Ulrike Fischer 


From mpg at elzevir.fr  Wed Dec 22 14:02:44 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Wed, 22 Dec 2010 14:02:44 +0100
Subject: [lltx] polytonic Greek hyphenation
In-Reply-To: <p0jx9xut78db$.dlg@nililand.de>
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de> <p0jx9xut78db$.dlg@nililand.de>
Message-ID: <4D11F6F4.4020806@elzevir.fr>

Le 22/12/2010 13:52, Ulrike Fischer a ?crit :
> Your example in the old thread (with \usepackage[greek]{babel})
> works fine for me (miktex 2.9 + lualatex). I don't read greek but
> showhyphens shows   ??-??-?? and I see one hyphenated word in the
> text.
> 
Thanks for testing, Ulrike.

> To get it working you need 
> 
> 1. a current lualatex.ini which contains the line
> \input luatex-unicode-letters.tex
> 
> 2. the luatex-unicode-letters.tex
> 
> 3. A lualatex format which has been generated with the above
> lualatex.ini
> 
Which makes me think: with TeX Live, the system-wide format should be
regenerated automatically, but you may have a user-specific format, for some reason.

I recommend that you either delete ~/.texlive2010/texmf-var/web2c if it exists,
or rerun fmtutil --byengine luatex. (Unless you know why you need to have a
user-specific format, the first option is the way to go.)

> 4. I also needed to activate the greek patterns in miktex settings.
> 
For texlive, check that hyphen-greek is installed.

Manuel.

From news3 at nililand.de  Wed Dec 22 14:12:08 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Wed, 22 Dec 2010 14:12:08 +0100
Subject: [lltx] polytonic Greek hyphenation
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de> <p0jx9xut78db$.dlg@nililand.de>
 <4D11F6F4.4020806@elzevir.fr>
Message-ID: <1quxbh7wzduq2.dlg@nililand.de>

Am Wed, 22 Dec 2010 14:02:44 +0100 schrieb Manuel P?gouri?-Gonnard:


>> Your example in the old thread (with \usepackage[greek]{babel})
>> works fine for me (miktex 2.9 + lualatex). I don't read greek but
>> showhyphens shows   ??-??-?? and I see one hyphenated word in the
>> text.
>> 
> Thanks for testing, Ulrike.

Just to clarify: It works because I have a local lualatex.ini (which
I took from texlive). Miktex hasn't it yet "officially".


-- 
Ulrike Fischer 


From mpg at elzevir.fr  Wed Dec 22 17:31:18 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Wed, 22 Dec 2010 17:31:18 +0100
Subject: [lltx] polytonic Greek hyphenation
In-Reply-To: <1quxbh7wzduq2.dlg@nililand.de>
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de> <p0jx9xut78db$.dlg@nililand.de>
 <4D11F6F4.4020806@elzevir.fr> <1quxbh7wzduq2.dlg@nililand.de>
Message-ID: <4D1227D6.4080909@elzevir.fr>

Le 22/12/2010 14:12, Ulrike Fischer a ?crit :
> Am Wed, 22 Dec 2010 14:02:44 +0100 schrieb Manuel P?gouri?-Gonnard:
> 
> 
>>> Your example in the old thread (with \usepackage[greek]{babel})
>>> works fine for me (miktex 2.9 + lualatex). I don't read greek but
>>> showhyphens shows   ??-??-?? and I see one hyphenated word in the
>>> text.
>>>
>> Thanks for testing, Ulrike.
> 
> Just to clarify: It works because I have a local lualatex.ini (which
> I took from texlive). Miktex hasn't it yet "officially".
> 
Oh, good to know. Thanks for the clarification, then :-)

Manuel.

From oinos at web.de  Wed Dec 22 18:24:55 2010
From: oinos at web.de (=?UTF-8?B?UGFibG8gUm9kcsOtZ3Vleg==?=)
Date: Wed, 22 Dec 2010 18:24:55 +0100
Subject: [lltx] polytonic Greek hyphenation
In-Reply-To: <1quxbh7wzduq2.dlg@nililand.de>
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de> <p0jx9xut78db$.dlg@nililand.de>
 <4D11F6F4.4020806@elzevir.fr> <1quxbh7wzduq2.dlg@nililand.de>
Message-ID: <4D123467.3040009@web.de>

On 12/22/2010 02:12 PM, Ulrike Fischer wrote:
> Am Wed, 22 Dec 2010 14:02:44 +0100 schrieb Manuel P?gouri?-Gonnard:
>
>>> Your example in the old thread (with \usepackage[greek]{babel})
>>> works fine for me (miktex 2.9 + lualatex). I don't read greek but
>>> showhyphens shows   ??-??-?? and I see one hyphenated word in the
>>> text.
>>>
>> Thanks for testing, Ulrike.
>
> Just to clarify: It works because I have a local lualatex.ini (which
> I took from texlive). Miktex hasn't it yet "officially".

Thanks for your help, Ulrike.

Ulrike, I wonder whether your method could be reported in the TeXLive 
mailing list as an improvement or a bugfix to be implemented.

Do you think that this would be useful to the general public?

I guess so, because other not only Greek, but Russian and Bulgarian 
(among other ones) will be hyphenated using LuaLaTeX.

But I don't know whether your approach may have collateral damages 
(sorry, I'm simply ignorant).

In case it is be useful, I will report this in the TeXLive mailing list.

Many thanks for your help,


Pablo
-- 
http://www.ousia.tk

From news3 at nililand.de  Wed Dec 22 18:56:46 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Wed, 22 Dec 2010 18:56:46 +0100
Subject: [lltx] polytonic Greek hyphenation
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de> <p0jx9xut78db$.dlg@nililand.de>
 <4D11F6F4.4020806@elzevir.fr> <1quxbh7wzduq2.dlg@nililand.de>
 <4D123467.3040009@web.de>
Message-ID: <1ca5j1gi55gaz$.dlg@nililand.de>

Am Wed, 22 Dec 2010 18:24:55 +0100 schrieb Pablo Rodr?guez:



> Ulrike, I wonder whether your method could be reported in the TeXLive 
> mailing list as an improvement or a bugfix to be implemented.

There is no need! I got the files from TeXLive. It's miktex that's
missing this improvement. 

If it doesn't work for you with a current TeXLive then you problably
have (as Manual suggested) a local format which needs to be
recreated. To quote Manuel:

"I recommend that you either delete ~/.texlive2010/texmf-var/web2c
if it exists, or rerun fmtutil --byengine luatex. (Unless you know
why you need to have a user-specific format, the first option is
the way to go.)" 


-- 
Ulrike Fischer 


From oinos at web.de  Wed Dec 22 19:12:12 2010
From: oinos at web.de (=?ISO-8859-1?Q?Pablo_Rodr=EDguez?=)
Date: Wed, 22 Dec 2010 19:12:12 +0100
Subject: [lltx] polytonic Greek hyphenation
In-Reply-To: <1ca5j1gi55gaz$.dlg@nililand.de>
References: <4D112A03.1080301@web.de> <4D113803.8050804@elzevir.fr>
 <4D11E5D5.1030100@web.de> <p0jx9xut78db$.dlg@nililand.de>
 <4D11F6F4.4020806@elzevir.fr> <1quxbh7wzduq2.dlg@nililand.de>
 <4D123467.3040009@web.de> <1ca5j1gi55gaz$.dlg@nililand.de>
Message-ID: <4D123F7C.8080504@web.de>

On 12/22/2010 06:56 PM, Ulrike Fischer wrote:
> Am Wed, 22 Dec 2010 18:24:55 +0100 schrieb Pablo Rodr?guez:
>
>> Ulrike, I wonder whether your method could be reported in the TeXLive
>> mailing list as an improvement or a bugfix to be implemented.
>
> There is no need! I got the files from TeXLive. It's miktex that's
> missing this improvement.
>
> If it doesn't work for you with a current TeXLive then you problably
> have (as Manual suggested) a local format which needs to be
> recreated. To quote Manuel:
>
> "I recommend that you either delete ~/.texlive2010/texmf-var/web2c
> if it exists, or rerun fmtutil --byengine luatex. (Unless you know
> why you need to have a user-specific format, the first option is
> the way to go.)"

Many thanks for your help, Ulrike.

I misunderstood the comment from Manuel, since I thought it was directed 
to your special settings.

I don't know what happened, but I didn't work yesterday and I don't have 
a user-specific format. Running fmtutil-sys --byengine luatex worked fine.

Thanks again for your help,


Pablo
-- 
http://www.ousia.tk

From oinos at web.de  Thu Dec 23 10:13:51 2010
From: oinos at web.de (=?UTF-8?B?UGFibG8gUm9kcsOtZ3Vleg==?=)
Date: Thu, 23 Dec 2010 10:13:51 +0100
Subject: [lltx] issue with \texorpdfstring{}
Message-ID: <4D1312CF.8090905@web.de>

Hi there,

I have the following document:

\documentclass{article}
\usepackage[spanish]{babel}
\usepackage{hyperref}
\begin{document}
\section{Ley 
(\texorpdfstring{\begin{hyphenrules}{ancientgreek}?????\end{hyphenrules}}{?????})}
\end{document}

which uses \texorpdfstring to enable hyphenation and aviod problems with 
hyperref.

I must be missing something extremely basic, but I don't know why it 
doesn't work (I get an error: "! Argument of \@sect has an extra }.").

What am I doing wrong here?

Thanks for your help,


Pablo
-- 
http://www.ousia.tk

From mpg at elzevir.fr  Thu Dec 23 10:50:29 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Thu, 23 Dec 2010 10:50:29 +0100
Subject: [lltx] issue with \texorpdfstring{}
In-Reply-To: <4D1312CF.8090905@web.de>
References: <4D1312CF.8090905@web.de>
Message-ID: <4D131B65.6010904@elzevir.fr>

Hi,

Le 23/12/2010 10:13, Pablo Rodr?guez a ?crit :
> \documentclass{article}
> \usepackage[spanish]{babel}
> \usepackage{hyperref}
> \begin{document}
> \section{Ley 
> (\texorpdfstring{\begin{hyphenrules}{ancientgreek}?????\end{hyphenrules}}{?????})}
> \end{document}
> 
> which uses \texorpdfstring to enable hyphenation and aviod problems with 
> hyperref.
> 
> I must be missing something extremely basic, but I don't know why it 
> doesn't work (I get an error: "! Argument of \@sect has an extra }.").
> 
> What am I doing wrong here?
> 
On the tex end, I don't know, but you're probably writing to the wrong
mailing-list. I can reproduce that with pdftex, too, so there is nothing
specific to luatex here. I suggest writing to texhax, or the usenet group
comp.text.tex.

Manuel.


PS: I'm not getting any problem with

(\texorpdfstring{\foreignlanguage{ancientgreek}{?????}}{?????})}

I didn't check, but environments are likely not to be robust (ie, not usable in
a moving argument).

From heiko.oberdiek at googlemail.com  Thu Dec 23 11:37:16 2010
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Thu, 23 Dec 2010 11:37:16 +0100
Subject: [lltx] issue with \texorpdfstring{}
In-Reply-To: <4D1312CF.8090905@web.de>
References: <4D1312CF.8090905@web.de>
Message-ID: <20101223103715.GA28645@oberdiek.my-fqdn.de>

On Thu, Dec 23, 2010 at 10:13:51AM +0100, Pablo Rodr?guez wrote:

> \documentclass{article}
> \usepackage[spanish]{babel}
> \usepackage{hyperref}
> \begin{document}
> \section{Ley (\texorpdfstring{\begin{hyphenrules}{ancientgreek}??????????\end{hyphenrules}}{??????????})}
> \end{document}
> 
> which uses \texorpdfstring to enable hyphenation and aviod problems
> with hyperref.
> 
> I must be missing something extremely basic, but I don't know why it
> doesn't work (I get an error: "! Argument of \@sect has an extra
> }.").

\begin and \end are fragile in LaTeX already. Thus you also need
\protect.

You can avoid \texorpdfstring here by using \pdfstringdefDisableCommands:

\pdfstringdefDisableCommands{%
  \def\begin#1{\csname#1\endcsname}%
  \def\end#1{\csname end#1\endcsname}%
  \def\hyphenrules#1{}%
  \def\endhyphenrules{}%
  \def\foreignlanguage#1#2{#2}%
}

In 6.82a hyperref will do this for \begin, \end, and
\foreignlanguage automatically.

Yours sincerely
  Heiko Oberdiek

From heiko.oberdiek at googlemail.com  Thu Dec 23 11:42:06 2010
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Thu, 23 Dec 2010 11:42:06 +0100
Subject: [lltx] issue with \texorpdfstring{}
In-Reply-To: <20101223103715.GA28645@oberdiek.my-fqdn.de>
References: <4D1312CF.8090905@web.de>
 <20101223103715.GA28645@oberdiek.my-fqdn.de>
Message-ID: <20101223104206.GA28971@oberdiek.my-fqdn.de>

On Thu, Dec 23, 2010 at 11:37:15AM +0100, Heiko Oberdiek wrote:

> On Thu, Dec 23, 2010 at 10:13:51AM +0100, Pablo Rodr?guez wrote:
> 
> > \usepackage{hyperref}

> > \section{Ley (\texorpdfstring{\begin{hyphenrules}{ancientgreek}??????????\end{hyphenrules}}{??????????})}

PDFDocEncoding misses most Greek letters. You need Unicode bookmarks:

\usepackage[unicode]{hyperref}

Yours sincerely
  Heiko Oberdiek

From oinos at web.de  Thu Dec 23 13:08:02 2010
From: oinos at web.de (=?ISO-8859-1?Q?Pablo_Rodr=EDguez?=)
Date: Thu, 23 Dec 2010 13:08:02 +0100
Subject: [lltx] issue with \texorpdfstring{}
In-Reply-To: <20101223103715.GA28645@oberdiek.my-fqdn.de>
References: <4D1312CF.8090905@web.de>
 <20101223103715.GA28645@oberdiek.my-fqdn.de>
Message-ID: <4D133BA2.8030401@web.de>

On 12/23/2010 11:37 AM, Heiko Oberdiek wrote:
> On Thu, Dec 23, 2010 at 10:13:51AM +0100, Pablo Rodr?guez wrote:
>
>> \documentclass{article}
>> \usepackage[spanish]{babel}
>> \usepackage{hyperref}
>> \begin{document}
>> \section{Ley (\texorpdfstring{\begin{hyphenrules}{ancientgreek}??????????\end{hyphenrules}}{??????????})}
>> \end{document}
>>
> \begin and \end are fragile in LaTeX already. Thus you also need
> \protect.
>
> You can avoid \texorpdfstring here by using \pdfstringdefDisableCommands:
>
> \pdfstringdefDisableCommands{%
>    \def\begin#1{\csname#1\endcsname}%
>    \def\end#1{\csname end#1\endcsname}%
>    \def\hyphenrules#1{}%
>    \def\endhyphenrules{}%
>    \def\foreignlanguage#1#2{#2}%
> }

Thanks, Heiko, it works like charm.

> In 6.82a hyperref will do this for \begin, \end, and
> \foreignlanguage automatically.

How about adding \selectlanguage to this list?

Thanks again,


Pablo
-- 
http://www.ousia.tk

From heiko.oberdiek at googlemail.com  Thu Dec 23 15:18:56 2010
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Thu, 23 Dec 2010 15:18:56 +0100
Subject: [lltx] issue with \texorpdfstring{}
In-Reply-To: <4D133BA2.8030401@web.de>
References: <4D1312CF.8090905@web.de>
 <20101223103715.GA28645@oberdiek.my-fqdn.de>
 <4D133BA2.8030401@web.de>
Message-ID: <20101223141855.GA29525@oberdiek.my-fqdn.de>

On Thu, Dec 23, 2010 at 01:08:02PM +0100, Pablo Rodr?guez wrote:

> On 12/23/2010 11:37 AM, Heiko Oberdiek wrote:
> >On Thu, Dec 23, 2010 at 10:13:51AM +0100, Pablo Rodr?guez wrote:
> >
> >>\documentclass{article}
> >>\usepackage[spanish]{babel}
> >>\usepackage{hyperref}
> >>\begin{document}
> >>\section{Ley (\texorpdfstring{\begin{hyphenrules}{ancientgreek}??????????\end{hyphenrules}}{??????????})}
> >>\end{document}
> >>
> >\begin and \end are fragile in LaTeX already. Thus you also need
> >\protect.
> >
> >You can avoid \texorpdfstring here by using \pdfstringdefDisableCommands:
> >
> >\pdfstringdefDisableCommands{%
> >   \def\begin#1{\csname#1\endcsname}%
> >   \def\end#1{\csname end#1\endcsname}%
> >   \def\hyphenrules#1{}%
> >   \def\endhyphenrules{}%
> >   \def\foreignlanguage#1#2{#2}%
> >}
> 
> Thanks, Heiko, it works like charm.
> 
> >In 6.82a hyperref will do this for \begin, \end, and
> >\foreignlanguage automatically.
> 
> How about adding \selectlanguage to this list?

The list shouldn't be too long, because it's called
for every bookmark and pdf information string.

Yours sincerely
  Heiko Oberdiek

From Arno.Trautmann at gmx.de  Sat Dec 25 14:38:07 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Sat, 25 Dec 2010 14:38:07 +0100
Subject: [lltx] luamplib (a nil value)
Message-ID: <4D15F3BF.50407@gmx.de>

Hi all,

I just wanted to take my first steps with luamplib using this document:

\documentclass{minimal}
\usepackage{luamplib}
\begin{document}
\begin{mplibcode}

\end{mplibcode}
\end{document}

Having just updated TeXlive and TLcontrib, I get:

(/home/texlive2010/texmf-dist/tex/luatex/luamplib/luamplib.lua))
(./test.aux)
! LuaTeX error
...live2010/texmf-dist/tex/luatex/luamplib/luamplib.lua:78: atte
mpt to call field 'module_term' (a nil value)
stack traceback:
	...live2010/texmf-dist/tex/luatex/luamplib/luamplib.lua:78: in function
'term'

	...live2010/texmf-dist/tex/luatex/luamplib/luamplib.lua:146: in
function 'repo
rt'
	...live2010/texmf-dist/tex/luatex/luamplib/luamplib.lua:173: in
function 'proc
ess'
	...live2010/texmf-dist/tex/luatex/luamplib/luamplib.lua:101: in
function 'proc
esslines'
	<\directlua >:1: in main chunk.
\endmplibcode ...rectlua {luamplib.processlines()}

l.10 \end{mplibcode}

This error raises as soon as I use the mplibcode-environment.
I can only guess that luamplib.lua tries to access
luatexbase.module_term('luamplib', format(...))
in line 77. I guess further this should be defined in luatexbase, but is
not.
Alternatively (more likely), I am doing something wrong ? but what?

I?ll be happy for any comments,

cheers
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101225/1ac68ced/attachment.bin>

From mpg at elzevir.fr  Sat Dec 25 18:07:16 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Sat, 25 Dec 2010 18:07:16 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D15F3BF.50407@gmx.de>
References: <4D15F3BF.50407@gmx.de>
Message-ID: <4D1624C4.6020105@elzevir.fr>

Le 25/12/2010 14:38, Arno Trautmann a ?crit :
> I can only guess that luamplib.lua tries to access
> luatexbase.module_term('luamplib', format(...))
> in line 77. I guess further this should be defined in luatexbase, but is
> not.

You're guessing right. Sorry for missing that. I'll publish an update soon.

As a temporary workaround,

function luatexbase.module_term(_, s)
    texio.write_nl('term', s)
end

should do the trick.

Manuel.

From Arno.Trautmann at gmx.de  Sun Dec 26 10:19:17 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Sun, 26 Dec 2010 10:19:17 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D1624C4.6020105@elzevir.fr>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
Message-ID: <4D170895.2000900@gmx.de>

Sorry, forgot to cc to list:

Manuel P?gouri?-Gonnard wrote:
> Le 25/12/2010 14:38, Arno Trautmann a ?crit :
>> I can only guess that luamplib.lua tries to access
>> luatexbase.module_term('luamplib', format(...))
>> in line 77. I guess further this should be defined in luatexbase, but is
>> not.
> 
> You're guessing right. Sorry for missing that. I'll publish an update soon.
> 
> As a temporary workaround,
> 
> function luatexbase.module_term(_, s)
>     texio.write_nl('term', s)
> end

Thanks, that seems to fix the problem on the TeX-side. But now I get an
error from MetaPost, see below. Am I doing something wrong with this
document?

????

\documentclass{minimal}
\usepackage{luamplib}

\directlua{
function luatexbase.module_term(_, s)
    texio.write_nl('term', s)
end
}

\begin{document}
\begin{mplibcode}
\end{mplibcode}
\end{document}

????

This is MetaPost, Version 1.503
 (plain.mp
>> $Id
! Isolated expression.
<to be read again>
                   :
l.1  $Id:
          plain.mp,v 1.3 2005/04/28 06:45:21 taco Exp $
! Extra tokens will be flushed.
<to be read again>
                   :
l.1  $Id:
          plain.mp,v 1.3 2005/04/28 06:45:21 taco Exp $
>> base_name
>> "plain"
! Equation cannot be performed (numeric=string).
<to be read again>
                   ;
l.8 ...base_name, base_version; base_name="plain";
                                                   base_version="1.004";
>> base_version
>> "1.004"
! Equation cannot be performed (numeric=string).
<to be read again>
                   ;
l.8 ...n; base_name="plain"; base_version="1.004";

>> "Preloading the plain mem file, version "
>> base_version
! Not implemented: (string)&(unknown numeric).
<to be read again>
                   ;
l.10 ...he plain mem file, version "&base_version;

>> base_version
! Not a string.
<to be read again>
                   ;
l.10 ...he plain mem file, version "&base_version;

)
! Attempt to close the bottom level file!.
l.576 defaultpen := savepen;



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101226/4ade468f/attachment.bin>

From Arno.Trautmann at gmx.de  Sun Dec 26 16:50:37 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Sun, 26 Dec 2010 16:50:37 +0100
Subject: [lltx] Type1 fonts
Message-ID: <4D17644D.7000202@gmx.de>

Hi all!

I was wondering if there was a simple interface to use Type1 fonts via
luaLaTeX/fontspec. If so ? how?
If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
(Given that no TeX adaption is present so far.)

cheers
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101226/2786df1a/attachment.bin>

From st_philipp at yahoo.de  Sun Dec 26 17:44:48 2010
From: st_philipp at yahoo.de (Philipp Stephani)
Date: Sun, 26 Dec 2010 17:44:48 +0100
Subject: [lltx] Type1 fonts
In-Reply-To: <4D17644D.7000202@gmx.de>
References: <4D17644D.7000202@gmx.de>
Message-ID: <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>

Am 26.12.2010 um 16:50 schrieb Arno Trautmann:

> If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
> (Given that no TeX adaption is present so far.)

LuaLaTeX is more-or-less backwards compatible with pdfLaTeX, so Type1 fonts work as with pdfLaTeX. That means you have to generate TFM, ENC, MAP, FD files etc., usually with the fontinst script. I don't think that there is a special interface to deal with Type1 fonts in LuaTeX (after all, they're obsolete).

From patrick at gundla.ch  Sun Dec 26 20:41:03 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Sun, 26 Dec 2010 20:41:03 +0100
Subject: [lltx] Type1 fonts
In-Reply-To: <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>
References: <4D17644D.7000202@gmx.de>
 <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>
Message-ID: <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>


Am 26.12.2010 um 17:44 schrieb Philipp Stephani:

> Am 26.12.2010 um 16:50 schrieb Arno Trautmann:
> 
>> If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
>> (Given that no TeX adaption is present so far.)
> 
> LuaLaTeX is more-or-less backwards compatible with pdfLaTeX, so Type1 fonts work as with pdfLaTeX. That means you have to generate TFM, ENC, MAP, FD files etc., usually with the fontinst script. I don't think that there is a special interface to deal with Type1 fonts in LuaTeX (after all, they're obsolete).

LuaTeX can read Type1 fonts with the fontloader mechanism, without going through the legacy pdftex code. But I believe that LuaLaTeX does not support using Type1 fonts with the fontloader library. Perhaps they are obsolete, but still widely used.

Patrick



From patrick at gundla.ch  Sun Dec 26 21:00:04 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Sun, 26 Dec 2010 21:00:04 +0100
Subject: [lltx] Type1 fonts
In-Reply-To: <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
References: <4D17644D.7000202@gmx.de>
 <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>
 <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
Message-ID: <4B61B035-82EC-4457-9A06-1F8AC67DEBDA@gundla.ch>


Am 26.12.2010 um 20:41 schrieb Patrick Gundlach:

> 
> Am 26.12.2010 um 17:44 schrieb Philipp Stephani:
> 
>> Am 26.12.2010 um 16:50 schrieb Arno Trautmann:
>> 
>>> If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
>>> (Given that no TeX adaption is present so far.)
>> 
>> LuaLaTeX is more-or-less backwards compatible with pdfLaTeX, so Type1 fonts work as with pdfLaTeX. That means you have to generate TFM, ENC, MAP, FD files etc., usually with the fontinst script. I don't think that there is a special interface to deal with Type1 fonts in LuaTeX (after all, they're obsolete).
> 
> LuaTeX can read Type1 fonts with the fontloader mechanism, without going through the legacy pdftex code. But I believe that LuaLaTeX does not support using Type1 fonts with the fontloader library. Perhaps they are obsolete, but still widely used.

I should add that this is just meant as "it is possible with LuaTeX but not with LuaLaTeX". So a quite useless comment, unless someone from the LuaLaTeX team proves me wrong (or implements type1 loading).


Patrick



From Arno.Trautmann at gmx.de  Sun Dec 26 21:06:38 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Sun, 26 Dec 2010 21:06:38 +0100
Subject: [lltx] Type1 fonts
In-Reply-To: <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
References: <4D17644D.7000202@gmx.de>
 <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>
 <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
Message-ID: <4D17A04E.6080407@gmx.de>

Sorry, forgot /again/ to cc to list :-/

Patrick Gundlach wrote:
> Am 26.12.2010 um 17:44 schrieb Philipp Stephani:
>> Am 26.12.2010 um 16:50 schrieb Arno Trautmann:

So only germans are interested in this subject? ;)

>>> If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
>>> (Given that no TeX adaption is present so far.)
>>
>> LuaLaTeX is more-or-less backwards compatible with pdfLaTeX, so Type1 fonts work as with pdfLaTeX. That means you have to generate TFM, ENC, MAP, FD files etc., usually with the fontinst script. I don't think that there is a special interface to deal with Type1 fonts in LuaTeX (after all, they're obsolete).
> 
> LuaTeX can read Type1 fonts with the fontloader mechanism, without going through the legacy pdftex code. But I believe that LuaLaTeX does not support using Type1 fonts with the fontloader library. Perhaps they are obsolete, but still widely used.

Am I supposed to fully understand your comment or could you give some
more information? Sounds interesting!

> I should add that this is just meant as "it is possible with LuaTeX
> but not with LuaLaTeX". So a quite useless comment, unless someone
> from the LuaLaTeX team proves me wrong (or implements type1 loading).

What prevents me (or, rather, you) from using it with luaLaTeX?

cheers
Arno



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101226/2a68afd4/attachment.bin>

From khaledhosny at eglug.org  Sun Dec 26 21:07:24 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 26 Dec 2010 22:07:24 +0200
Subject: [lltx] Type1 fonts
In-Reply-To: <4B61B035-82EC-4457-9A06-1F8AC67DEBDA@gundla.ch>
References: <4D17644D.7000202@gmx.de>
 <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>
 <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
 <4B61B035-82EC-4457-9A06-1F8AC67DEBDA@gundla.ch>
Message-ID: <20101226200724.GA26281@khaled-laptop>

On Sun, Dec 26, 2010 at 09:00:04PM +0100, Patrick Gundlach wrote:
> 
> Am 26.12.2010 um 20:41 schrieb Patrick Gundlach:
> 
> > 
> > Am 26.12.2010 um 17:44 schrieb Philipp Stephani:
> > 
> >> Am 26.12.2010 um 16:50 schrieb Arno Trautmann:
> >> 
> >>> If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
> >>> (Given that no TeX adaption is present so far.)
> >> 
> >> LuaLaTeX is more-or-less backwards compatible with pdfLaTeX, so Type1 fonts work as with pdfLaTeX. That means you have to generate TFM, ENC, MAP, FD files etc., usually with the fontinst script. I don't think that there is a special interface to deal with Type1 fonts in LuaTeX (after all, they're obsolete).
> > 
> > LuaTeX can read Type1 fonts with the fontloader mechanism, without going through the legacy pdftex code. But I believe that LuaLaTeX does not support using Type1 fonts with the fontloader library. Perhaps they are obsolete, but still widely used.
> 
> I should add that this is just meant as "it is possible with LuaTeX but not with LuaLaTeX". So a quite useless comment, unless someone from the LuaLaTeX team proves me wrong (or implements type1 loading).

Patches are welcomed.

Sorry, can't resist :p

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Sun Dec 26 21:12:32 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 26 Dec 2010 22:12:32 +0200
Subject: [lltx] Type1 fonts
In-Reply-To: <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
References: <4D17644D.7000202@gmx.de>
 <25E2BB87-8325-4CBF-8778-A02BBAE404CE@yahoo.de>
 <8827872D-A15C-40E1-8E71-BBB9323F27A1@gundla.ch>
Message-ID: <20101226201231.GB26281@khaled-laptop>

On Sun, Dec 26, 2010 at 08:41:03PM +0100, Patrick Gundlach wrote:
> 
> Am 26.12.2010 um 17:44 schrieb Philipp Stephani:
> 
> > Am 26.12.2010 um 16:50 schrieb Arno Trautmann:
> > 
> >> If not ? what would be the simplest way to use a Type1 font in luaLaTeX?
> >> (Given that no TeX adaption is present so far.)
> > 
> > LuaLaTeX is more-or-less backwards compatible with pdfLaTeX, so Type1 fonts work as with pdfLaTeX. That means you have to generate TFM, ENC, MAP, FD files etc., usually with the fontinst script. I don't think that there is a special interface to deal with Type1 fonts in LuaTeX (after all, they're obsolete).
> 
> LuaTeX can read Type1 fonts with the fontloader mechanism, without going through the legacy pdftex code. But I believe that LuaLaTeX does not support using Type1 fonts with the fontloader library. Perhaps they are obsolete, but still widely used.

Type1 fonts have been declared obsolete a decade or so before I touched
a TeX system, I never used them (apart from legacy TeX fonts) myself,
and they are pretty useless for any of my needs. The code we borrowed
from ConTeXt lacked the pfb/afm loading part since Hans too finds them
obsolete, and there is no much incentive for me to work on it.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Tue Dec 28 02:38:50 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Tue, 28 Dec 2010 02:38:50 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D170895.2000900@gmx.de>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de>
Message-ID: <4D193FAA.2020101@elzevir.fr>

Le 26/12/2010 10:19, Arno Trautmann a ?crit :
> This is MetaPost, Version 1.503
>  (plain.mp
>>> $Id
> ! Isolated expression.

I think this must be related to metapost 1.5 which, iirc, doesn't use
precompiled formats any more, but loads macros at runtime. Looks like the change
isn't completely transparent, so that luamplib is not compatible with those
recent versions.

I'll see to fix that, but I can't guarantee any timeline. In the meanwhile; I
encourage you to use older versions of the executables, if you can easily switch
versions.

Manuel.

From Arno.Trautmann at gmx.de  Tue Dec 28 14:04:14 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Tue, 28 Dec 2010 14:04:14 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D19DD2E.9000700@elzevir.fr>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
Message-ID: <4D19E04E.6050409@gmx.de>

Manuel P?gouri?-Gonnard wrote:
> [cc-ing the list again]

sorry, I always forget that these days :-/

> Le 28/12/2010 10:29, Arno Trautmann a ?crit :
>> Downgrading to latest TeXlive2010 works:
>>
>> This is LuaTeX, Version beta-0.60.2-2010071218 (TeX Live 2010) (rev 3736)
>>
> Great.

Thanks to tlcontrib and TeXlive's --reinstall, it's very easy to jump
between new and newest versions :)

>>> I'll see to fix that, but I can't guarantee any timeline. In the meanwhile; I
>>> encourage you to use older versions of the executables, if you can easily switch
>>> versions.
>>
>> Let me know if I can help you (at least some testing), I have a few days
>> left for intense TeXing (and related things) ;)
>>
> I believe the next version fixes the two bugs mentioned in this thread. It is
> temporarily available at <http://tug.org/~mpg/luamplib.tds.zip>. Your testing
> with different versions of LuaTeX would be very much appreciated before I upload
> it to CTAN.

Latest TeXlive and latest tlcontrib versions seem to work, i.e. this:

\documentclass{minimal}
\usepackage{luamplib}
\begin{document}
\begin{mplibcode}
beginfig(1)
endfig
\end{mplibcode}
\end{document}

does not produce an error while the old version still fails (so no
change at another component). I did no further testing as I am just
starting to learn metapost ?
But the bugs seem to be fixed, thank you very much for that rapid work ?
waiting for the CTAN-release :)

cheers
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101228/a5f76f6b/attachment.bin>

From mpg at elzevir.fr  Tue Dec 28 14:16:07 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Tue, 28 Dec 2010 14:16:07 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D19E04E.6050409@gmx.de>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
 <4D19E04E.6050409@gmx.de>
Message-ID: <4D19E317.9070909@elzevir.fr>

Le 28/12/2010 14:04, Arno Trautmann a ?crit :
> Latest TeXlive and latest tlcontrib versions seem to work, i.e. this:
> 
> \documentclass{minimal}
> \usepackage{luamplib}
> \begin{document}
> \begin{mplibcode}
> beginfig(1)
> endfig
> \end{mplibcode}
> \end{document}
> 
> does not produce an error while the old version still fails (so no
> change at another component). I did no further testing as I am just
> starting to learn metapost ?

I use exactly the same test file, with an extra line

   fill fullcircle scaled 20;

and nothing more, because I also don't know much metapost :-)

> But the bugs seem to be fixed, thank you very much for that rapid work ?
> waiting for the CTAN-release :)
> 
Ok, so I just uploaded to CTAN. Should be in TeX Live and at your local mirror
in a few days.

Manuel.

From Arno.Trautmann at gmx.de  Tue Dec 28 14:18:34 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Tue, 28 Dec 2010 14:18:34 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D19E317.9070909@elzevir.fr>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
 <4D19E04E.6050409@gmx.de> <4D19E317.9070909@elzevir.fr>
Message-ID: <4D19E3AA.90904@gmx.de>

Manuel P?gouri?-Gonnard wrote:
> Le 28/12/2010 14:04, Arno Trautmann a ?crit :
>> Latest TeXlive and latest tlcontrib versions seem to work, i.e. this:
>>
>> \documentclass{minimal}
>> \usepackage{luamplib}
>> \begin{document}
>> \begin{mplibcode}
>> beginfig(1)
>> endfig
>> \end{mplibcode}
>> \end{document}
>>
>> does not produce an error while the old version still fails (so no
>> change at another component). I did no further testing as I am just
>> starting to learn metapost ?
> 
> I use exactly the same test file, with an extra line
> 
>    fill fullcircle scaled 20;
> 
> and nothing more, because I also don't know much metapost :-)

Does someone here?
And, does anyone uses metapost at all? I think everyone should have
noticed the buglets if it was used?

>> But the bugs seem to be fixed, thank you very much for that rapid work ?
>> waiting for the CTAN-release :)
>>
> Ok, so I just uploaded to CTAN. Should be in TeX Live and at your local mirror
> in a few days.

Thanks again,
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101228/c0360489/attachment.bin>

From mpg at elzevir.fr  Tue Dec 28 14:22:57 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Tue, 28 Dec 2010 14:22:57 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D19E3AA.90904@gmx.de>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
 <4D19E04E.6050409@gmx.de> <4D19E317.9070909@elzevir.fr>
 <4D19E3AA.90904@gmx.de>
Message-ID: <4D19E4B1.5040909@elzevir.fr>

Le 28/12/2010 14:18, Arno Trautmann a ?crit :
> And, does anyone uses metapost at all? I think everyone should have
> noticed the buglets if it was used?
> 
That's an intersting question too, but let me point out that the two bugs were
triggered only by a recent luatex (even if the first one doesn't seem to be
version specific, the code path that lead to it is not always taken with older
versions of luatex).

Anyway, I'd be happy to hear about other users indeed :-)

Manuel.

From mailing_list at arcor.de  Tue Dec 28 20:29:56 2010
From: mailing_list at arcor.de (Stephan Hennig)
Date: Tue, 28 Dec 2010 20:29:56 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D19E3AA.90904@gmx.de>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
 <4D19E04E.6050409@gmx.de> <4D19E317.9070909@elzevir.fr>
 <4D19E3AA.90904@gmx.de>
Message-ID: <4D1A3AB4.3060200@arcor.de>

schrieb Arno Trautmann:
> Manuel P?gouri?-Gonnard wrote:
>> 
>> because I also don't know much metapost :-)
> 
> Does someone here?

MetaPost has it's own list, which can be joined at
<URL:http://tug.org/mailman/listinfo/metapost>.

> And, does anyone uses metapost at all? I think everyone should have
> noticed the buglets if it was used?

Seems like luamplib isn't that popular.  But that doesn't say much about
MetaPost.

Best regards,
Stephan Hennig

From Arno.Trautmann at gmx.de  Wed Dec 29 15:16:50 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Wed, 29 Dec 2010 15:16:50 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D1A3AB4.3060200@arcor.de>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
 <4D19E04E.6050409@gmx.de> <4D19E317.9070909@elzevir.fr>
 <4D19E3AA.90904@gmx.de> <4D1A3AB4.3060200@arcor.de>
Message-ID: <4D1B42D2.4080108@gmx.de>

Stephan Hennig wrote:
> schrieb Arno Trautmann:
>> Manuel P?gouri?-Gonnard wrote:
>>>
>>> because I also don't know much metapost :-)
>>
>> Does someone here?
> 
> MetaPost has it's own list, which can be joined at
> <URL:http://tug.org/mailman/listinfo/metapost>.

sigh ? that makes like ? 16 of TeX-related mailing list subscriptions ?
Thanks!

>> And, does anyone uses metapost at all? I think everyone should have
>> noticed the buglets if it was used?
> 
> Seems like luamplib isn't that popular.  But that doesn't say much about
> MetaPost.

Time to spread the words ;)
No, seriously, I wonder if Metapost can/will be a reasonable replacement
for tikz/pstricks. But that will take some time, if at all ?

cheers
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101229/07881e94/attachment.bin>

From luigi.scarso at gmail.com  Wed Dec 29 15:24:45 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Wed, 29 Dec 2010 15:24:45 +0100
Subject: [lltx] luamplib (a nil value)
In-Reply-To: <4D1B42D2.4080108@gmx.de>
References: <4D15F3BF.50407@gmx.de> <4D1624C4.6020105@elzevir.fr>
 <4D170895.2000900@gmx.de> <4D193FAA.2020101@elzevir.fr>
 <4D19ADF2.10306@gmx.de> <4D19DD2E.9000700@elzevir.fr>
 <4D19E04E.6050409@gmx.de> <4D19E317.9070909@elzevir.fr>
 <4D19E3AA.90904@gmx.de> <4D1A3AB4.3060200@arcor.de>
 <4D1B42D2.4080108@gmx.de>
Message-ID: <AANLkTinKLxQ0pmxxEPZL-WtoTwRDSHQ3t7LnLS_Dbf7f@mail.gmail.com>

On Wed, Dec 29, 2010 at 3:16 PM, Arno Trautmann <Arno.Trautmann at gmx.de> wrote:
> No, seriously, I wonder if Metapost can/will be a reasonable replacement
> for tikz/pstricks. But that will take some time, if at all ?
It can be, of course:
see
http://www.pragma-ade.com/general/manuals/metafun-s.pdf

-- 
luigi


From Arno.Trautmann at gmx.de  Fri Dec 31 12:05:40 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Fri, 31 Dec 2010 12:05:40 +0100
Subject: [lltx] rand feature in fontspec / microtype
Message-ID: <4D1DB904.7070307@gmx.de>

Hi all,

I just found out about the rand feature (e.g. in the Punk Nova font) and
wondered if there was a fontspec key for it. Would be nice to have
something like \fontspec[Random]{fontname} instead of using
\fontspec{fontnamed:rand}. Is this planned/possible?

Something quite different: What are the reasons that there is no support
f?r microtype in fontspec so far? As far as I can see, microtypographic
features are possible by setting \pdfprotrudechars and \pdfadjustspacing
and loading fonts with :protrusion=default and :expansion=default. But I
guess there must be something more or else it would already be present
in fontspec, wouldn't it? Or is it difficult to use non-default values
and therefore no support?

cheers
Arno

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101231/8256d188/attachment.bin>

From patrick at gundla.ch  Fri Dec 31 12:39:52 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Fri, 31 Dec 2010 12:39:52 +0100
Subject: [lltx] rand feature in fontspec / microtype
In-Reply-To: <4D1DB904.7070307@gmx.de>
References: <4D1DB904.7070307@gmx.de>
Message-ID: <EBC70BB8-44F2-4CAF-B991-B7144B5AC092@gundla.ch>


> 
> Something quite different: What are the reasons that there is no support
> f?r microtype in fontspec so far?

The microtype package (beta version) and fontspec seem to work fine together.

Patrick



From patrick at gundla.ch  Fri Dec 31 13:05:44 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Fri, 31 Dec 2010 13:05:44 +0100
Subject: [lltx] rand feature in fontspec / microtype
In-Reply-To: <4D1DC3BD.7080300@gmx.de>
References: <4D1DB904.7070307@gmx.de>
 <EBC70BB8-44F2-4CAF-B991-B7144B5AC092@gundla.ch> <4D1DC3BD.7080300@gmx.de>
Message-ID: <67BBDE3B-7A74-4A29-8D83-EBFAE315FE96@gundla.ch>


Am 31.12.2010 um 12:51 schrieb Arno Trautmann:

> Patrick Gundlach wrote:
>> 
>>> 
>>> Something quite different: What are the reasons that there is no support
>>> f?r microtype in fontspec so far?
>> 
>> The microtype package (beta version) and fontspec seem to work fine together.
> 
> Which version?

2.5 beta-04

http://xetex.tk/mediawiki/index.php/Microtype_package_(preliminary_version)


\documentclass[10pt]{article}
\usepackage[english]{babel}
\usepackage{fontspec}
\usepackage{microtype}
\usepackage{blindtext}

\begin{document}
\begin{minipage}{3.7cm}
\blindtext
\end{minipage}
\end{document}

Patrick



From Arno.Trautmann at gmx.de  Fri Dec 31 13:34:35 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Fri, 31 Dec 2010 13:34:35 +0100
Subject: [lltx] rand feature in fontspec / microtype
In-Reply-To: <67BBDE3B-7A74-4A29-8D83-EBFAE315FE96@gundla.ch>
References: <4D1DB904.7070307@gmx.de>
 <EBC70BB8-44F2-4CAF-B991-B7144B5AC092@gundla.ch> <4D1DC3BD.7080300@gmx.de>
 <67BBDE3B-7A74-4A29-8D83-EBFAE315FE96@gundla.ch>
Message-ID: <4D1DCDDB.9070701@gmx.de>

Patrick Gundlach wrote:
> 
> Am 31.12.2010 um 12:51 schrieb Arno Trautmann:
> 
>> Patrick Gundlach wrote:
>>>
>>>>
>>>> Something quite different: What are the reasons that there is no support
>>>> f?r microtype in fontspec so far?
>>>
>>> The microtype package (beta version) and fontspec seem to work fine together.
>>
>> Which version?
> 
> 2.5 beta-04
> 
> http://xetex.tk/mediawiki/index.php/Microtype_package_(preliminary_version)

Thank you very much!
Why are such things not on TLcontrib? :(
That would make testing so much easier ?

At least it does seem to do something, protrusion seems to work.
Expansion does not seem to do anything (in my testfile), though, but
that may be due to my bad eyes ?

> \documentclass[10pt]{article}
> \usepackage[english]{babel}
> \usepackage{fontspec}
> \usepackage{microtype}
> \usepackage{blindtext}
> 
> \begin{document}
> \begin{minipage}{3.7cm}
> \blindtext
> \end{minipage}
> \end{document}

Well, here the effect is very clear ?
So remains the question for the rand-feature.

Thanks again,

cheers
Arno



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101231/f7a35728/attachment.bin>

From khaledhosny at eglug.org  Fri Dec 31 13:42:42 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 31 Dec 2010 14:42:42 +0200
Subject: [lltx] rand feature in fontspec / microtype
In-Reply-To: <4D1DB904.7070307@gmx.de>
References: <4D1DB904.7070307@gmx.de>
Message-ID: <20101231124242.GA2387@khaled-laptop>

On Fri, Dec 31, 2010 at 12:05:40PM +0100, Arno Trautmann wrote:
> Hi all,
> 
> I just found out about the rand feature (e.g. in the Punk Nova font) and
> wondered if there was a fontspec key for it. Would be nice to have
> something like \fontspec[Random]{fontname} instead of using
> \fontspec{fontnamed:rand}. Is this planned/possible?

There is no fontspec key for it right now, but should not be hard to
add. In the meantime you should use RawFeatures={+rand}, appending
features to font name is highly discouraged.

> Something quite different: What are the reasons that there is no support
> f?r microtype in fontspec so far? As far as I can see, microtypographic
> features are possible by setting \pdfprotrudechars and \pdfadjustspacing
> and loading fonts with :protrusion=default and :expansion=default. But I
> guess there must be something more or else it would already be present
> in fontspec, wouldn't it? Or is it difficult to use non-default values
> and therefore no support?

Mostly because I couldn't figure out a good user interface for it, I
hear microtype now works with luatex/fontspec, but I did not try it
myself. An undocumented feature of luaotfload is the support for 'obpd'
feature, so if the font have set protrusion values for glyphs it can be
used, I've not seen any fonts using it but I intend to use it for my
Arabic fonts (it is the only way to set protrusion of unencoded glyphs
in a portable way).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer


From Arno.Trautmann at gmx.de  Fri Dec 31 13:50:24 2010
From: Arno.Trautmann at gmx.de (Arno Trautmann)
Date: Fri, 31 Dec 2010 13:50:24 +0100
Subject: [lltx] rand feature in fontspec / microtype
In-Reply-To: <20101231124242.GA2387@khaled-laptop>
References: <4D1DB904.7070307@gmx.de> <20101231124242.GA2387@khaled-laptop>
Message-ID: <4D1DD190.3070307@gmx.de>

Khaled Hosny wrote:
> On Fri, Dec 31, 2010 at 12:05:40PM +0100, Arno Trautmann wrote:
>> Hi all,
>>
>> I just found out about the rand feature (e.g. in the Punk Nova font) and
>> wondered if there was a fontspec key for it. Would be nice to have
>> something like \fontspec[Random]{fontname} instead of using
>> \fontspec{fontnamed:rand}. Is this planned/possible?
> 
> There is no fontspec key for it right now, but should not be hard to
> add. In the meantime you should use RawFeatures={+rand}, appending
> features to font name is highly discouraged.

Ok; why?
The greatest effect of such a key would surely be the documentation of
it. I had to guess it while trying to play around with the Punk Nova.
(That would make a great example in the documentation, too ;) )

>> Something quite different: What are the reasons that there is no support
>> f?r microtype in fontspec so far? As far as I can see, microtypographic
>> features are possible by setting \pdfprotrudechars and \pdfadjustspacing
>> and loading fonts with :protrusion=default and :expansion=default. But I
>> guess there must be something more or else it would already be present
>> in fontspec, wouldn't it? Or is it difficult to use non-default values
>> and therefore no support?
> 
> Mostly because I couldn't figure out a good user interface for it, I
> hear microtype now works with luatex/fontspec, but I did not try it
> myself. An undocumented feature of luaotfload is the support for 'obpd'
> feature, so if the font have set protrusion values for glyphs it can be
> used, I've not seen any fonts using it but I intend to use it for my
> Arabic fonts (it is the only way to set protrusion of unencoded glyphs
> in a portable way).

Ok; would be nice if it could also be documented ;)

cheers
Arno



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20101231/2dd837d6/attachment.bin>

From mpg at elzevir.fr  Fri Dec 31 14:14:12 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Fri, 31 Dec 2010 14:14:12 +0100
Subject: [lltx] rand feature in fontspec / microtype
In-Reply-To: <4D1DCDDB.9070701@gmx.de>
References: <4D1DB904.7070307@gmx.de>
 <EBC70BB8-44F2-4CAF-B991-B7144B5AC092@gundla.ch> <4D1DC3BD.7080300@gmx.de>
 <67BBDE3B-7A74-4A29-8D83-EBFAE315FE96@gundla.ch> <4D1DCDDB.9070701@gmx.de>
Message-ID: <4D1DD724.4020905@elzevir.fr>

Le 31/12/2010 13:34, Arno Trautmann a ?crit :
> Patrick Gundlach wrote:
>>
>> http://xetex.tk/mediawiki/index.php/Microtype_package_(preliminary_version)
> 
> Thank you very much!
> Why are such things not on TLcontrib? :(
> That would make testing so much easier ?
> 
You should probably suggest it to microtype's author, maybe he didn't think
about it, or doesn't have time to get familiar with tlcrontib but would
appreciate someone else doing the job, etc.

Manuel.

