From wspr81 at gmail.com  Wed Jun  2 10:47:52 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Wed, 2 Jun 2010 18:17:52 +0930
Subject: [lltx] Fwd: [MacTeX] New MacTeX pretest
References: <FCDAA1C0-9544-4295-8425-D899DCC60D5C@me.com>
Message-ID: <C3599204-6043-4F5F-86EE-F956CF20BCCD@gmail.com>

Hi,

See below for an odd bug report with luaotfload's automatic font shapes mechanism. I don't have the font so I can't reproduce it.

Cheers,
Will

Begin forwarded message:

> From: Bruno Voisin <bvoisin at me.com>
> Date: 31 May 2010 6:20:13 PM ACST
> To: "MacOS X and TeX." <mactex at tug.org>
> Subject: Re: [MacTeX] New MacTeX pretest
> Reply-To: "MacOS X and TeX." <mactex at tug.org>

[...]

> To test further, I changed the font to Adobe Garamond Pro. Things work as expected in XeLaTeX with
> 
> 	\setmainfont{Adobe Garamond Pro}
> 
> With LuaLaTeX, the above yields italic for roman and roman for bold. You've got to use instead
> 
> 	\setmainfont
> 	  [BoldFont = {Adobe Garamond Pro Bold}]
> 	  {Adobe Garamond Pro Regular}
> 
> The test file I used is appended.
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lualatex-test.tex
Type: application/x-tex
Size: 2159 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100602/cf960f99/attachment.tex>
-------------- next part --------------
> 

-- Will


From khaledhosny at eglug.org  Wed Jun  2 14:06:09 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 2 Jun 2010 15:06:09 +0300
Subject: [lltx] Fwd: [MacTeX] New MacTeX pretest
In-Reply-To: <C3599204-6043-4F5F-86EE-F956CF20BCCD@gmail.com>
References: <FCDAA1C0-9544-4295-8425-D899DCC60D5C@me.com>
	<C3599204-6043-4F5F-86EE-F956CF20BCCD@gmail.com>
Message-ID: <20100602120609.GA3931@khaled-laptop>

Without the fonts, or his names database file, there is nothing I can do
either.

On Wed, Jun 02, 2010 at 06:17:52PM +0930, Will Robertson wrote:
> Hi,
> 
> See below for an odd bug report with luaotfload's automatic font shapes mechanism. I don't have the font so I can't reproduce it.
> 
> Cheers,
> Will
> 
> Begin forwarded message:
> 
> > From: Bruno Voisin <bvoisin at me.com>
> > Date: 31 May 2010 6:20:13 PM ACST
> > To: "MacOS X and TeX." <mactex at tug.org>
> > Subject: Re: [MacTeX] New MacTeX pretest
> > Reply-To: "MacOS X and TeX." <mactex at tug.org>
> 
> [...]
> 
> > To test further, I changed the font to Adobe Garamond Pro. Things work as expected in XeLaTeX with
> > 
> > 	\setmainfont{Adobe Garamond Pro}
> > 
> > With LuaLaTeX, the above yields italic for roman and roman for bold. You've got to use instead
> > 
> > 	\setmainfont
> > 	  [BoldFont = {Adobe Garamond Pro Bold}]
> > 	  {Adobe Garamond Pro Regular}
> > 
> > The test file I used is appended.
> > 


> > 
> 
> -- Will
> 


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From wspr81 at gmail.com  Thu Jun  3 09:16:40 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Thu, 3 Jun 2010 16:46:40 +0930
Subject: [lltx] fontspec tests suite
Message-ID: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>

Hi,

Thinking about putting together a test suite for fontspec. Have any of you actually tried the unicode-math test suite? It works by comparing PNG renders of PDF output by xelatex. The main problem with it is false negatives, which happen periodically, and very long execution times. I've heard netpbm is faster than `convert`, but I couldn't get it set up on my machine last I tried.

I'm wondering if such a suite is useable by more people than just the single person who first created the test file. Or if the general idea is sound but the png files should only be created for each user running the test suite. (I.e., first you initialise the tests, and then make changes the files, and then re-run the tests again. You won't find if your files end up the same as mine, but you will be able to see when your changes affected the tests.)

Any thoughts?

-- Will



From dcnieho at gmail.com  Fri Jun  4 09:02:08 2010
From: dcnieho at gmail.com (Diederick C. Niehorster)
Date: Fri, 4 Jun 2010 15:02:08 +0800
Subject: [lltx] fontspec tests suite
In-Reply-To: <5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>
	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>
	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>
Message-ID: <AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>

(sorry if this a top-post or without original text, not quite sure
what my phone does to it.)

Ah, if pngs are generated like that for both compare and test image is
even better. The way you've set it up now sounds very efficient. If in
the script you can get the output from imagemagick whether images are
the same or not, you could copy all the pairs giving a negative to a
temp directory for verification  of a human. Any simple image viewing
program that allows to navigate to next and previous image with arrow
keys is all you need then. When flipping front and back quickly, any
differences are extremely easily seen when there is not too much
content in the text (i study vision, humans are the best pattern
detectors). If the imagemagick part is complicating everything a lot,
you could even do away with it all together and let the human do it by
flipping front and back quickly (I suppose i could write a quick
OpenGL/GLUT program for showing the pairs fullscreen and flipping
quickly and writing the human response to file, but can't promise any
timeline right now).
I think the resolution of the png you attached is good!

Sounds like very nice setup, better than what I just came up with. If
you could roll this out for fontspec would be very useful to get quick
and detailed feedback about a whole bunch of less and more advanced
features from a lot of users.

Best,
Dee

On 6/4/10, Will Robertson <wspr81 at gmail.com> wrote:
> On 04/06/2010, at 1:07 PM, Diederick C. Niehorster wrote:
>
>> I'd say tests are good! If you want to quickly know if the
>> functionality of your package works correctly accross a range of
>> different systems and (in the case of fontspec importantly) different
>> interpreters. You'd want to provide the pngs so set them side to side
>> (which you seem to be suggesting, not familiar with your unicode test
>> suite) so all testers can quickly see if output is as intented.
>
> That's true.
> And even if the output is (say) one pixel wrong, it's still easy to verify
> that the output is as intended but the test is outputting a false negative.
>
>> And indeed, if you provide the script for creating the pngs, then we
>> can test our stuff easily as well, that'd be nice! Pngs of text should
>> be very small btw, and long processing times is not really an issue
>
> For unicode-math, the PNGs are about 20kB--40kB each, but in hindsight I
> think their dimensions are larger than necessary (they're about 1000x700
> pixels). I've attached a typical test image to the end of this message.
>
>> So, yeah I'm all for it. I could envision a kind of package with a
>> command like \addtest{arbitrary code} which, when processed a file wih
>> those commands would generate the pngs (is this possible
>> automatically) and a document with the test codes and the png output
>> set next to each other, then its easy to maintain and extend.
>
> The process with unicode math isn't quite that automatic, but it's close.
> You write a new file called umtestXXXX.ltx and then write
>
>     make initest
>
> which generates the PNG alongside the test, called umtestXXXX.safe.png.
> Then when you run
>
>     make test
>
> it recompiles the PNG in a build/ directory, called umtestXXXX.test.png, and
> then uses ImageMagick's `compare` tool to check if the two PNGs are the same
> or not.
>
> (The `make test` script also updates another document that contains a
> listing of all the test files with their output, but that's purely for
> documentation purposes.)
>
> -- Will
>
>

From wspr81 at gmail.com  Fri Jun  4 09:37:05 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 4 Jun 2010 17:07:05 +0930
Subject: [lltx] fontspec tests suite
In-Reply-To: <AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>
	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>
	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>
	<AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>
Message-ID: <329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>

On 04/06/2010, at 4:32 PM, Diederick C. Niehorster wrote:

> When flipping front and back quickly, any
> differences are extremely easily seen when there is not too much
> content in the text (i study vision, humans are the best pattern
> detectors).

Sounds interesting!
There was a postdoc advertised in my department recently for doing "visually guide navigation" with a mobile robot; wished I'd worked harder to finish my thesis so I could have applied for it... (but then I'd have less time for LaTeX:)).

> If the imagemagick part is complicating everything a lot,
> you could even do away with it all together and let the human do it by
> flipping front and back quickly

No, the Imagemagick comparison is essential for automating it -- for unicode-math there are over 100 different tests and you certainly don't want to have to flip through them all every time you send out a new release :)

> Sounds like very nice setup, better than what I just came up with. If
> you could roll this out for fontspec would be very useful to get quick
> and detailed feedback about a whole bunch of less and more advanced
> features from a lot of users.

Well, I can't say it's a top priority in terms of being necessary, but it will be needed sooner or later. If we could recruit people to create tests for us, moreso the better. (Creating the tests is easily the most time-consuming part.)

I'll see how easy it is to adapt my unicode-math Makefile for fontspec (should be easy enough) and send out a request for contributions.

-- Will



From wspr81 at gmail.com  Fri Jun  4 15:18:03 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 4 Jun 2010 22:48:03 +0930
Subject: [lltx] fontspec test suite
Message-ID: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>

Dear all,

I've now added a test suite to fontspec. It currently contains no tests :) -- besides some examples. Please try it out! You'll need ImageMagick and an environment that can deal with Makefiles and so on. (I *think* all TeX distributions come with ImageMagick these days, but I might be wrong.)

The only step required, I hope, is to run `make check` after you've grabbed the files from <http://github.com/wspr/fontspec>. Now that I mention it, you might need to manually create a build/ directory.

Three types of tests are supported with the following naming scheme:

  F001a - compiles with both xelatex and lualatex and checks the output of both
  L001a - compiles with lualatex only
  X001a - compiles with xelatex only

It uses a visual diff of the compiled PDFs against a reference PDF in the testsuite/ directory. There's a "fuzz" factor incorporated to hopefully reduce the occurrence of false negatives.

I'm interested to see

(a) if the test suite actually functions (my shell scripting isn't so hot)
(b) if the test suite actually passes (rounding errors might be too large)

If (b) doesn't work, then I'll remove the ".safe.pdf" files from the repository, and the test suite can be used simply as a regression suite for each developer.

Once we know that it works, it'll be time to fill it up with tests. I'm pretty much out of time for fontspec for the foreseeable future. But there's a bug or two that I just discover that need to be fixed, so I guess I'll just have to find the time.

-- Will



From dcnieho at gmail.com  Fri Jun  4 15:41:17 2010
From: dcnieho at gmail.com (Diederick C. Niehorster)
Date: Fri, 4 Jun 2010 21:41:17 +0800
Subject: [lltx] fontspec tests suite
In-Reply-To: <329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>
	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>
	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>
	<AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>
	<329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>
Message-ID: <AANLkTinW2tVLccG_QVEQw7cPv5FHjbvdlEIZPBJtI61m@mail.gmail.com>

> Well, I can't say it's a top priority in terms of being necessary, but it will be needed sooner or later. If we could recruit people to create tests for us, moreso the better. (Creating the tests is easily the most time-consuming part.)
>
> I'll see how easy it is to adapt my unicode-math Makefile for fontspec (should be easy enough) and send out a request for contributions.
>

Contributions in terms of materials should be easy to get by asking on
the XeLateX list, there must be plenty of people having
interesting/complicated fontspec uses that could just be copied to
make a good test-case. For features new to fontspec, we migh have to
rely on you for a bit.

BTW does anybody know what to do on windows with a make-file (never tried...)?

Best,
Dee

From wspr81 at gmail.com  Fri Jun  4 15:44:42 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 4 Jun 2010 23:14:42 +0930
Subject: [lltx] fontspec tests suite
In-Reply-To: <AANLkTinW2tVLccG_QVEQw7cPv5FHjbvdlEIZPBJtI61m@mail.gmail.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>
	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>
	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>
	<AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>
	<329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>
	<AANLkTinW2tVLccG_QVEQw7cPv5FHjbvdlEIZPBJtI61m@mail.gmail.com>
Message-ID: <26F0413F-AD00-4B65-84E2-BFD8BD7AFEB5@gmail.com>

On 04/06/2010, at 11:11 PM, Diederick C. Niehorster wrote:

> BTW does anybody know what to do on windows with a make-file (never tried...)?

Not exactly. I suspect that installing Cygwin is the best way.
It gives you a unix-like command line that behaves just like you were on Linux or Mac OS X :)

-- Will



From taco at elvenkind.com  Fri Jun  4 15:57:25 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 04 Jun 2010 15:57:25 +0200
Subject: [lltx] fontspec tests suite
In-Reply-To: <26F0413F-AD00-4B65-84E2-BFD8BD7AFEB5@gmail.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>	<AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>	<329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>	<AANLkTinW2tVLccG_QVEQw7cPv5FHjbvdlEIZPBJtI61m@mail.gmail.com>
	<26F0413F-AD00-4B65-84E2-BFD8BD7AFEB5@gmail.com>
Message-ID: <4C090645.50902@elvenkind.com>


Hi,

Will Robertson wrote:
> On 04/06/2010, at 11:11 PM, Diederick C. Niehorster wrote:
> 
>> BTW does anybody know what to do on windows with a make-file (never tried...)?
> 
> Not exactly. I suspect that installing Cygwin is the best way.

I advise mingw + msys (+ mingw32-gcc etc, if need a C compiler) as it is
less invasive than a full-blown cygwin installation and the tools
generally cooperate better with a standard windows environment.

The website is http://www.mingw.org

Best wishes,
Taco

From mpg at elzevir.fr  Fri Jun  4 16:04:33 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Fri, 04 Jun 2010 16:04:33 +0200
Subject: [lltx] fontspec test suite
In-Reply-To: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>
References: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>
Message-ID: <4C0907F1.3050708@elzevir.fr>

Le 04/06/2010 15:18, Will Robertson a ?crit :
> I've now added a test suite to fontspec. It currently contains no tests :) --
> besides some examples. Please try it out! You'll need ImageMagick and an
> environment that can deal with Makefiles and so on. (I *think* all TeX
> distributions come with ImageMagick these days, but I might be wrong.)
> 
TL doesn't come with ImageMagick (it is an addition of MacTeX on the Mac), but I
still think this tool is pretty standard. After all, TL doesn't come with GNU
make either :-)

> The only step required, I hope, is to run `make check` after you've grabbed
> the files from <http://github.com/wspr/fontspec>. Now that I mention it, you
> might need to manually create a build/ directory.
> 
Yep, we need to create it. You'll probably add mkdir -p build in a next version.

> (a) if the test suite actually functions (my shell scripting isn't so hot)

Atm, I've got two problems:
- my shell's test command (aka [) doesn't seem to like '=='. Since I don't see
it listed on [1], I assume it's better to use '='. Also, as a general rule, it
is safer to prepend something to the strings being tested, like

test "x$a" = "x$b"

so as to avoid problems with strings starting with special symbols, as well as
empty strings.

[1]: http://www.opengroup.org/onlinepubs/009695399/utilities/test.html

- I'm afraid the second problem is more serious: my compare command doesn't
include the string "dB" in its output:

mpg at roth:~/tex/packages/fontspec% compare -metric ae -fuzz 10% build/F001a-L.pdf
testsuite/F001a.safe.pdf build/F001a.diff.pdf
0
mpg at roth:~/tex/packages/fontspec% compare -metric ae build/F001a-L.pdf
testsuite/F001a.safe.pdf build/F001a.diff.pdf
3

which make your grep fail on the output fail. Probably a version issue?

mpg at roth:~/tex/packages/fontspec% compare --version                      (test)
Version: ImageMagick 6.6.0-4 2010-03-17 Q16 http://www.imagemagick.org
Copyright: Copyright (C) 1999-2010 ImageMagick Studio LLC
Features: OpenMP

> (b) if the test suite actually passes (rounding errors might be too large)
> 
I was too lazy to modify the Makefile to make the suite run, so I don't know if
it passes.

> If (b) doesn't work, then I'll remove the ".safe.pdf" files from the
> repository, and the test suite can be used simply as a regression suite for
> each developer.
> 
Or maybe we can combine both modes: ship the .safe.pdf files (I think they are
valuable) and allow a (local) regression-testing mode. It should be doable by
adjusting the location of the reference files depending on the target.

Manuel.

From mpg at elzevir.fr  Fri Jun  4 16:06:11 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Fri, 04 Jun 2010 16:06:11 +0200
Subject: [lltx] fontspec test suite
In-Reply-To: <4C0907F1.3050708@elzevir.fr>
References: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>
	<4C0907F1.3050708@elzevir.fr>
Message-ID: <4C090853.9080304@elzevir.fr>

Oops, I forgot to say:

Le 04/06/2010 16:04, Manuel P?gouri?-Gonnard a ?crit :
> Le 04/06/2010 15:18, Will Robertson a ?crit :
>> I've now added a test suite to fontspec.

Nice work! Looks impressive.

Manuel.

From dcnieho at gmail.com  Fri Jun  4 16:08:40 2010
From: dcnieho at gmail.com (Diederick C. Niehorster)
Date: Fri, 4 Jun 2010 22:08:40 +0800
Subject: [lltx] fontspec tests suite
In-Reply-To: <4C090645.50902@elvenkind.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>
	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>
	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>
	<AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>
	<329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>
	<AANLkTinW2tVLccG_QVEQw7cPv5FHjbvdlEIZPBJtI61m@mail.gmail.com>
	<26F0413F-AD00-4B65-84E2-BFD8BD7AFEB5@gmail.com>
	<4C090645.50902@elvenkind.com>
Message-ID: <AANLkTinRqoGg5tVhqEG5oSWqnf5lNtOxm_J4aDMS1YI7@mail.gmail.com>

On Fri, Jun 4, 2010 at 9:57 PM, Taco Hoekwater <taco at elvenkind.com> wrote:
>
> Hi,
>
> Will Robertson wrote:
>>
>> On 04/06/2010, at 11:11 PM, Diederick C. Niehorster wrote:
>>
>>> BTW does anybody know what to do on windows with a make-file (never
>>> tried...)?
>>
>> Not exactly. I suspect that installing Cygwin is the best way.
>
> I advise mingw + msys (+ mingw32-gcc etc, if need a C compiler) as it is
> less invasive than a full-blown cygwin installation and the tools
> generally cooperate better with a standard windows environment.
>
> The website is http://www.mingw.org

Thanks Taco and Will,

I've heard of both of those, by the description, I'd prefer Mingw, I'm
familiar with windows only and would like to keep it clean.

So for my previous suggestion, does the ImageMagick compare action
return same of different to the shell? Then we can do a move action
for those pairs that need closer, human, inspection. (though i've
never touched make-file like scripting, I wouldn't mind trying, soon.

And based on your other email announcing the test suite, what is that
fuzz factor exactly? I could imagine big fails that are only a few
pixels.. e.g. -- not being converted to en-dash, or and ft ligatue
failing. Guess (but haven't tried) that output of a given testcase
should be the same given that typesetting should be deterministic,
right? or just moving to a different system would lead to slightly
different output easily (sounds bad intuitively)? Personally, I'd
prefer the human change-detector approach, unless the false negatives
are really common.

Best,
Dee

From wspr81 at gmail.com  Fri Jun  4 16:24:10 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 4 Jun 2010 23:54:10 +0930
Subject: [lltx] fontspec test suite
In-Reply-To: <4C0907F1.3050708@elzevir.fr>
References: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>
	<4C0907F1.3050708@elzevir.fr>
Message-ID: <25956969-12B1-4CD9-B9FB-820BAAFB35DA@gmail.com>

On 04/06/2010, at 11:34 PM, Manuel P?gouri?-Gonnard wrote:

> Yep, we need to create it. You'll probably add mkdir -p build in a next version.

I will, will I? :)


> Atm, I've got two problems:
> - my shell's test command (aka [) doesn't seem to like '=='. Since I don't see
> it listed on [1], I assume it's better to use '='. Also, as a general rule, it
> is safer to prepend something to the strings being tested, like
> 
> test "x$a" = "x$b"
> 
> so as to avoid problems with strings starting with special symbols, as well as
> empty strings.

Ah yes; I've seen that before.


> - I'm afraid the second problem is more serious: my compare command doesn't
> include the string "dB" in its output:
[...]
> 
> which make your grep fail on the output fail. Probably a version issue?
> 
> mpg at roth:~/tex/packages/fontspec% compare --version                      (test)
> Version: ImageMagick 6.6.0-4 2010-03-17 Q16 http://www.imagemagick.org

Unfortunately yes: I've only got 6.2.9 09/24/06. MacTeX must has a particularly old version.


> Or maybe we can combine both modes: ship the .safe.pdf files (I think they are
> valuable) and allow a (local) regression-testing mode. It should be doable by
> adjusting the location of the reference files depending on the target.

That's a good idea.


-- Will



From mpg at elzevir.fr  Fri Jun  4 16:27:47 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Fri, 04 Jun 2010 16:27:47 +0200
Subject: [lltx] fontspec tests suite
In-Reply-To: <AANLkTinRqoGg5tVhqEG5oSWqnf5lNtOxm_J4aDMS1YI7@mail.gmail.com>
References: <D29C790C-4B0E-4B4D-B68E-BC3FA216D147@gmail.com>	<AANLkTil41gMBs8JZABKpa96hkLqkBJ2Xl0vEDeLxWKDK@mail.gmail.com>	<5703FB0C-5A7B-49AD-B3B7-59A4B45CA74F@gmail.com>	<AANLkTimy24PuH2kDFmQr3vYuH-I40u_OMeOudyowNyJs@mail.gmail.com>	<329B2A09-8021-43D8-93C5-B1309EA2BAC3@gmail.com>	<AANLkTinW2tVLccG_QVEQw7cPv5FHjbvdlEIZPBJtI61m@mail.gmail.com>	<26F0413F-AD00-4B65-84E2-BFD8BD7AFEB5@gmail.com>	<4C090645.50902@elvenkind.com>
	<AANLkTinRqoGg5tVhqEG5oSWqnf5lNtOxm_J4aDMS1YI7@mail.gmail.com>
Message-ID: <4C090D63.4020600@elzevir.fr>

Le 04/06/2010 16:08, Diederick C. Niehorster a ?crit :
> And based on your other email announcing the test suite, what is that
> fuzz factor exactly? I could imagine big fails that are only a few
> pixels.. e.g. -- not being converted to en-dash, or and ft ligatue
> failing. Guess (but haven't tried) that output of a given testcase
> should be the same given that typesetting should be deterministic,
> right? or just moving to a different system would lead to slightly
> different output easily (sounds bad intuitively)? Personally, I'd
> prefer the human change-detector approach, unless the false negatives
> are really common.
> 
On one test, run semi-manually, I got "3" (dunno which unit) as the difference
on the "hello world" sample. Will mentioned floating-point and rounding errors.
I'd be curious to know more about when this difference comes from (since I
naively tend to agree with you that the typesetting should be fully
determinisitc), but I'm afraid I don't have the time and necessary background
(event the the time to acquire such a background) to invesitgate.

Manuel.

From mpg at elzevir.fr  Fri Jun  4 16:29:52 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Fri, 04 Jun 2010 16:29:52 +0200
Subject: [lltx] fontspec test suite
In-Reply-To: <25956969-12B1-4CD9-B9FB-820BAAFB35DA@gmail.com>
References: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>	<4C0907F1.3050708@elzevir.fr>
	<25956969-12B1-4CD9-B9FB-820BAAFB35DA@gmail.com>
Message-ID: <4C090DE0.5070201@elzevir.fr>

Le 04/06/2010 16:24, Will Robertson a ?crit :
> On 04/06/2010, at 11:34 PM, Manuel P?gouri?-Gonnard wrote:
> 
>> Yep, we need to create it. You'll probably add mkdir -p build in a next version.
> 
> I will, will I? :)
> 
Will you, Will? (Sorry, was too tempting.)

>> which make your grep fail on the output fail. Probably a version issue?
>>
>> mpg at roth:~/tex/packages/fontspec% compare --version                      (test)
>> Version: ImageMagick 6.6.0-4 2010-03-17 Q16 http://www.imagemagick.org
> 
> Unfortunately yes: I've only got 6.2.9 09/24/06. MacTeX must has a particularly old version.
> 
This explains the difference in the output format. Unfortunately, I'm not sure
how to reliably handle this.

>> Or maybe we can combine both modes: ship the .safe.pdf files (I think they are
>> valuable) and allow a (local) regression-testing mode. It should be doable by
>> adjusting the location of the reference files depending on the target.
> 
> That's a good idea.
> 
But it makes more work for you :-)

Manuel.

From arthur.reutenauer at normalesup.org  Fri Jun  4 16:41:41 2010
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Fri, 4 Jun 2010 16:41:41 +0200
Subject: [lltx] fontspec test suite
In-Reply-To: <4C090DE0.5070201@elzevir.fr>
References: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>
	<4C0907F1.3050708@elzevir.fr>
	<25956969-12B1-4CD9-B9FB-820BAAFB35DA@gmail.com>
	<4C090DE0.5070201@elzevir.fr>
Message-ID: <20100604144141.GF28945@phare.normalesup.org>

>> I will, will I? :)
>> 
> Will you, Will? (Sorry, was too tempting.)

  Not if he has to do it manuelly.

	Arthur

From wspr81 at gmail.com  Fri Jun  4 18:25:32 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 5 Jun 2010 01:55:32 +0930
Subject: [lltx] fontspec test suite
In-Reply-To: <4C090DE0.5070201@elzevir.fr>
References: <DD7DEDDE-985C-4DDA-8514-C7DCF904D2F4@gmail.com>	<4C0907F1.3050708@elzevir.fr>
	<25956969-12B1-4CD9-B9FB-820BAAFB35DA@gmail.com>
	<4C090DE0.5070201@elzevir.fr>
Message-ID: <C10E1509-2472-46F8-867C-F202EF82361E@gmail.com>

On 04/06/2010, at 11:59 PM, Manuel P?gouri?-Gonnard wrote:

> This explains the difference in the output format. Unfortunately, I'm not sure
> how to reliably handle this.

Easy :) Update my version.
Unfortunately MacPorts is a big pain to use and everything must be compiled from scratch.
And ImageMagick uses *a lot* of dependencies.

Hence the delay on this message.

I've now updated the Makefile for the newer version of ImageMagick but the numbers are all a hack.
Maybe now it will work?

BTW, the reason that you get "rounding errors" or whatever I was calling them, is that the PDFs must first be converted to PNG (with a specific resolution) before being compared. Imperceptible changes in glyph placement can affect how the image is discretised, and you can end up with a line of pixels, say, (or sometimes just a single pixel) that have ended up being generated differently.

There might be some antialiasing effects that're compounding the problem but I haven't looked into ImageMagick enough to know if that's the case (and if so, how to turn it off).


>>> Or maybe we can combine both modes: ship the .safe.pdf files (I think they are
>>> valuable) and allow a (local) regression-testing mode. It should be doable by
>>> adjusting the location of the reference files depending on the target.
>> 
>> That's a good idea.
>> 
> But it makes more work for you :-)

Remind me if I forget, but that doesn't seem like toooooo much work.

-- Will



From wspr81 at gmail.com  Sat Jun  5 10:05:04 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 5 Jun 2010 17:35:04 +0930
Subject: [lltx] fontspec v2.0 (no beta)
Message-ID: <8EDFFE12-AEE7-466F-81A1-BF8379721A5E@gmail.com>

Hi,

I'm considering releasing the current version of fontspec as v2 (no beta). Despite the unfinished manual.

Is anyone aware of niggling problems or any issues before I do so?

-- Will



From khaledhosny at eglug.org  Sat Jun  5 17:05:49 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 5 Jun 2010 18:05:49 +0300
Subject: [lltx] fontspec v2.0 (no beta)
In-Reply-To: <8EDFFE12-AEE7-466F-81A1-BF8379721A5E@gmail.com>
References: <8EDFFE12-AEE7-466F-81A1-BF8379721A5E@gmail.com>
Message-ID: <20100605150549.GB2584@khaled-laptop>

On Sat, Jun 05, 2010 at 05:35:04PM +0930, Will Robertson wrote:
> Hi,
> 
> I'm considering releasing the current version of fontspec as v2 (no beta). Despite the unfinished manual.
> 
> Is anyone aware of niggling problems or any issues before I do so?

I'm going to work on \fontdimen8 issue to make it more robust, you can
either wait for new luaotfload release or just assume it is already done
and remove the old hack (if you didn't already)

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From stephenmoye at mac.com  Sat Jun  5 17:58:46 2010
From: stephenmoye at mac.com (Stephen Moye)
Date: Sat, 05 Jun 2010 11:58:46 -0400
Subject: [lltx] LuaLaTeX and FontExplorer Pro
Message-ID: <AE5368DB-C160-4CF0-8A31-06BE8D29CDCC@mac.com>

I am experimenting with MacTeX2010. 

I have run into one problem. I use Linotype FontExplorer Pro (2.5, on Mac OS X 10.6.3) to manage my type library. With this simple document:

%%==8><--%%

% !TEX encoding = UTF-8 Unicode
% !TEX TS-program = LuaLaTeX

\documentclass{article}

\usepackage{fontspec}

\setmainfont{Centaur MT Pro}

\begin{document}

This is easy.

\end{document}

%%==8><--%%

I get the following from the console:

%%==8><--%%

luaotfload | Updating the font names database:
luaotfload | scanning TEXMF fonts...
luaotfload | scanning OS fonts...
./luatest.tex:8: Font \zf at basefont=Centaur MT Pro at 10pt not loadable: metric 
data not found or bad.
<to be read again> 
                  \let 
l.8 \setmainfont{Centaur MT Pro}

? 

%%==8><--%%

Will Robertson explained: "Unfortunately LuaLaTeX doesn't use the actual font system in Mac OS X, it just cheats and looks in known locations like ~/Library/Fonts/ and so on. This is a limitation in LuaLaTeX that can only be fixed by someone who knows what they're doing :)"

Would it be possible for Lua{La)TeX to use fonts activated by font management software? (WR also went on to explain that it is possible to use mkluatexfontdb to widen the Lua search area).


Stephen Moye
sgmoye at me.com




From khaledhosny at eglug.org  Sun Jun  6 00:39:50 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 6 Jun 2010 01:39:50 +0300
Subject: [lltx] TTC fonts on MacOSX
Message-ID: <20100605223950.GA6851@khaled-laptop>

Thinking again about Taco's remark on TTC fonts, I think the problem is
not in TTC fonts generally, but in Apple supplied TTC fonts. So I
suggest, instead of blacklisting all TTC fonts unconditionally, we
should explicitly blacklist the problematic ones (or even all TTC fonts
from Apple).

Also, such fonts should be blacklisted on all OSs; if they crash luatex
on mac, then they will cash it elsewhere as well, the same goes for the
LastResort font (I had it while ago, and it is available for free
download from unicode.org, so it is not a mac-only font).

We need some one with access to MacOSX to confirm this, by testing
Cambria or other TTC fonts from MS etc. and to list all broken ones.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From wspr81 at gmail.com  Sun Jun  6 04:25:43 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sun, 6 Jun 2010 11:55:43 +0930
Subject: [lltx] TTC fonts on MacOSX
In-Reply-To: <20100605223950.GA6851@khaled-laptop>
References: <20100605223950.GA6851@khaled-laptop>
Message-ID: <C3F2E9A2-2EDA-42AF-9826-070687F6F7DA@gmail.com>

On 06/06/2010, at 8:09 AM, Khaled Hosny wrote:

> Thinking again about Taco's remark on TTC fonts, I think the problem is
> not in TTC fonts generally, but in Apple supplied TTC fonts. So I
> suggest, instead of blacklisting all TTC fonts unconditionally, we
> should explicitly blacklist the problematic ones (or even all TTC fonts
> from Apple).

That sounds like a very good idea.
Happy to help with the testing, of course...

-- Will


From m_g_n at gmx.de  Sun Jun  6 17:18:05 2010
From: m_g_n at gmx.de (M. Niedermair)
Date: Sun, 06 Jun 2010 17:18:05 +0200
Subject: [lltx] lualatex and otf feature
Message-ID: <4C0BBC2D.2030603@gmx.de>

Hi,

I define a font with a fd file like this:

\ProvidesFile{eu2fxl.fd}[2010/04/19 v4.6.5b Font defs for Libertine]
\def\eu2fxl at parms{mode=node;script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;+trep;+tlig}
\expandafter\ifx\csname fxl at scale\endcsname\relax
    \let\fxl@@scale\@empty%
\else
    \edef\fxl@@scale{s*[\csname fxl at scale\endcsname]}%
\fi
\DeclareFontFamily{EU2}{fxl}{}
\DeclareFontShape{EU2}{fxl}{m}{n}   {<-> \fxl@@scale 
file:fxlr:\eu2fxl at parms}{}
\DeclareFontShape{EU2}{fxl}{m}{it}  {<-> \fxl@@scale 
file:fxlri:\eu2fxl at parms}{}
...

Is it possible to activate a otf feature like +onum with a macro, such 
as \addfontfeature in xetex?

By
Michael




From m_g_n at gmx.de  Sun Jun  6 17:18:27 2010
From: m_g_n at gmx.de (M. Niedermair)
Date: Sun, 06 Jun 2010 17:18:27 +0200
Subject: [lltx] lualatex and glyph names
Message-ID: <4C0BBC43.3040506@gmx.de>

Hi,

how can I set a glyph with his name.

By
Michael

From wspr81 at gmail.com  Sun Jun  6 17:34:29 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 7 Jun 2010 01:04:29 +0930
Subject: [lltx] lualatex and otf feature
In-Reply-To: <4C0BBC2D.2030603@gmx.de>
References: <4C0BBC2D.2030603@gmx.de>
Message-ID: <1DC6703C-A90E-4AF2-BE5B-D73E19E44B98@gmail.com>

On 07/06/2010, at 12:48 AM, M. Niedermair wrote:

> \ProvidesFile{eu2fxl.fd}[2010/04/19 v4.6.5b Font defs for Libertine]
> \def\eu2fxl at parms{mode=node;script=latn;+ccmp;+locl;+mark;+mkmk;+kern;+liga;+clig;+trep;+tlig}
> \expandafter\ifx\csname fxl at scale\endcsname\relax
>   \let\fxl@@scale\@empty%
> \else
>   \edef\fxl@@scale{s*[\csname fxl at scale\endcsname]}%
> \fi
> \DeclareFontFamily{EU2}{fxl}{}
> \DeclareFontShape{EU2}{fxl}{m}{n}   {<-> \fxl@@scale file:fxlr:\eu2fxl at parms}{}
> \DeclareFontShape{EU2}{fxl}{m}{it}  {<-> \fxl@@scale file:fxlri:\eu2fxl at parms}{}
> ...
> 
> Is it possible to activate a otf feature like +onum with a macro, such as \addfontfeature in xetex?

Only the first time the font is loaded as you're doing with the scale macro. LaTeX doesn't read an .fd file twice, although somewhere once I had code that disabled its check for exactly this sort of situation.

You shouldn't need to apply the default features (+kern, etc.) as you are doing there; luaotfload should be applying them automatically, unless I'm mistaken.

Cheers,
-- Will




From m_g_n at gmx.de  Sun Jun  6 17:49:26 2010
From: m_g_n at gmx.de (M. Niedermair)
Date: Sun, 06 Jun 2010 17:49:26 +0200
Subject: [lltx] lualatex and otf feature
In-Reply-To: <1DC6703C-A90E-4AF2-BE5B-D73E19E44B98@gmail.com>
References: <4C0BBC2D.2030603@gmx.de>
	<1DC6703C-A90E-4AF2-BE5B-D73E19E44B98@gmail.com>
Message-ID: <4C0BC386.1000501@gmx.de>

Hi Will,

> You shouldn't need to apply the default features (+kern, etc.) as you are doing there; luaotfload should be applying them automatically, unless I'm mistaken.

I want to do like this with lualtex and luaotfload:

\usefont{EU2}{fxl}{m}{n}\selecfont
some text with numbers 0123456789
{\addfontfeature{+onum} and old style numbers 01234567890}

By
Michael



From khaledhosny at eglug.org  Sun Jun  6 18:06:02 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 6 Jun 2010 19:06:02 +0300
Subject: [lltx] lualatex and glyph names
In-Reply-To: <4C0BBC43.3040506@gmx.de>
References: <4C0BBC43.3040506@gmx.de>
Message-ID: <20100606160602.GA8172@khaled-laptop>

On Sun, Jun 06, 2010 at 05:18:27PM +0200, M. Niedermair wrote:
> Hi,
> 
> how can I set a glyph with his name.

There is a lua function that takes either glyph name or id:
\directlua{fonts.otf.char("Aacute")}
\directlua{fonts.otf.char(193)}

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From wspr81 at gmail.com  Sun Jun  6 18:38:35 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 7 Jun 2010 02:08:35 +0930
Subject: [lltx] lualatex and otf feature
In-Reply-To: <4C0BC386.1000501@gmx.de>
References: <4C0BBC2D.2030603@gmx.de>
	<1DC6703C-A90E-4AF2-BE5B-D73E19E44B98@gmail.com>
	<4C0BC386.1000501@gmx.de>
Message-ID: <AE3788F2-8A21-4800-81E3-58DCA42E0933@gmail.com>

On 07/06/2010, at 1:19 AM, M. Niedermair wrote:

>> You shouldn't need to apply the default features (+kern, etc.) as you are doing there; luaotfload should be applying them automatically, unless I'm mistaken.
> 
> I want to do like this with lualtex and luaotfload:
> 
> \usefont{EU2}{fxl}{m}{n}\selecfont
> some text with numbers 0123456789
> {\addfontfeature{+onum} and old style numbers 01234567890}


I found the code to reset a LaTeX font definition.
If you put \maybe at onum in your .fd file and load the font like usual, you can then execute this:

   \global\expandafter\let 
      \csname\f at encoding/% 
             \f at family/% 
             \f at series/% 
             \f at shape/% 
             \f at size\endcsname 
       \relax 

to forget about the font, then change \maybe at onum, and reload the font.

But please don't use the same macro names as fontspec, as I'm sure it will only lead to confusion :)

-- Will



From m_g_n at gmx.de  Sun Jun  6 18:41:37 2010
From: m_g_n at gmx.de (M. Niedermair)
Date: Sun, 06 Jun 2010 18:41:37 +0200
Subject: [lltx] lualatex and glyph names
In-Reply-To: <20100606160602.GA8172@khaled-laptop>
References: <4C0BBC43.3040506@gmx.de> <20100606160602.GA8172@khaled-laptop>
Message-ID: <4C0BCFC1.70302@gmx.de>

Hi,

> There is a lua function that takes either glyph name or id:
> \directlua{fonts.otf.char("Aacute")}
> \directlua{fonts.otf.char(193)}

Thanks, it works!

By
Michael

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[ngerman]{article}
\usepackage{babel}
\usepackage{luaotfload}
\usepackage[EU2]{fontenc}

\usepackage{libertine}% 4.6.5b
\renewcommand\ttdefault{lmtt}

\usepackage{xunicode}

\begin{document}

\bigskip
{\Huge\libertineGlyph{Tux}}

\bigskip
{\Huge\fontfamily{fxl}\selectfont\directlua{fonts.otf.char("Tux")}
}

\end{document}



From wspr81 at gmail.com  Sun Jun  6 19:49:25 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 7 Jun 2010 03:19:25 +0930
Subject: [lltx] kerning; am i mad?
Message-ID: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>

Hi,

It's time for me to finish for the night, but I think I'm going crazy.
Just yesterday I generated the following test file for fontspec:

-------------- next part --------------
A non-text attachment was scrubbed...
Name: L003a.safe.pdf
Type: application/pdf
Size: 9907 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100607/838032ce/attachment-0002.pdf>
-------------- next part --------------


But after messing around and probably updating some stuff here and there, I now get:

-------------- next part --------------
A non-text attachment was scrubbed...
Name: L003a.pdf
Type: application/pdf
Size: 8908 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20100607/838032ce/attachment-0003.pdf>
-------------- next part --------------


No more kerning!
Here's a test file to replicate what I'm seeing:

\documentclass{article}
\usepackage{luaotfload}
\begin{document}
\font\1=name:Verdana\1 Test
\end{document}

What do you see?

I can't replicate the old output that has proper kerning, even going back to older versions of luaotfload. I've tried TL2010 and TL2009. Am I mad? Where has my kerning gone?

-- Will


From khaledhosny at eglug.org  Sun Jun  6 19:58:02 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 6 Jun 2010 20:58:02 +0300
Subject: [lltx] kerning; am i mad?
In-Reply-To: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
References: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
Message-ID: <20100606175802.GA9918@khaled-laptop>

On Mon, Jun 07, 2010 at 03:19:25AM +0930, Will Robertson wrote:
> Hi,
> 
> It's time for me to finish for the night, but I think I'm going crazy.
> Just yesterday I generated the following test file for fontspec:
> 


> 
> 
> But after messing around and probably updating some stuff here and there, I now get:
> 


> 
> 
> No more kerning!
> Here's a test file to replicate what I'm seeing:
> 
> \documentclass{article}
> \usepackage{luaotfload}
> \begin{document}
> \font\1=name:Verdana\1 Test
> \end{document}
> 
> What do you see?
> 
> I can't replicate the old output that has proper kerning, even going back to older versions of luaotfload. I've tried TL2010 and TL2009. Am I mad? Where has my kerning gone?

Are you sure you are testing the same Verdana (I think older versions of
verdana might have an old style "kern" table which is unlikely to be
supported).


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Sun Jun  6 20:14:27 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 6 Jun 2010 21:14:27 +0300
Subject: [lltx] kerning; am i mad?
In-Reply-To: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
References: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
Message-ID: <20100606181427.GA10348@khaled-laptop>

On Mon, Jun 07, 2010 at 03:19:25AM +0930, Will Robertson wrote:
> Hi,
> 
> It's time for me to finish for the night, but I think I'm going crazy.
> Just yesterday I generated the following test file for fontspec:
> 


> 
> 
> But after messing around and probably updating some stuff here and there, I now get:
> 


> 
> 
> No more kerning!
> Here's a test file to replicate what I'm seeing:
> 
> \documentclass{article}
> \usepackage{luaotfload}
> \begin{document}
> \font\1=name:Verdana\1 Test
> \end{document}
> 
> What do you see?
> 
> I can't replicate the old output that has proper kerning, even going back to older versions of luaotfload. I've tried TL2010 and TL2009. Am I mad? Where has my kerning gone?

Using "\font\1=name:Verdana:script=latn\1 Test" I get kerning, so for some reason fontspec stopped applying default script.


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From wspr81 at gmail.com  Sun Jun  6 20:14:57 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 7 Jun 2010 03:44:57 +0930
Subject: [lltx] kerning; am i mad?
In-Reply-To: <20100606175802.GA9918@khaled-laptop>
References: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
	<20100606175802.GA9918@khaled-laptop>
Message-ID: <3A731C9B-D043-46D8-BFC5-7873470EF615@gmail.com>

On 07/06/2010, at 3:28 AM, Khaled Hosny wrote:

> Are you sure you are testing the same Verdana (I think older versions of
> verdana might have an old style "kern" table which is unlikely to be
> supported).

I thought this too, but as far as I know I've only got the one version on my machine.
I assume your kerning comes out right?

-- Will



From wspr81 at gmail.com  Sun Jun  6 20:27:18 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 7 Jun 2010 03:57:18 +0930
Subject: [lltx] kerning; am i mad?
In-Reply-To: <20100606181427.GA10348@khaled-laptop>
References: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
	<20100606181427.GA10348@khaled-laptop>
Message-ID: <C9841900-2B25-4EE8-8E5A-A41D4D49E48F@gmail.com>

On 07/06/2010, at 3:44 AM, Khaled Hosny wrote:

> Using "\font\1=name:Verdana:script=latn\1 Test" I get kerning, so for some reason fontspec stopped applying default script.

That part of the code did get changed recently.
I'll take a closer look tomorrow. Good to hear I'm not totally crazy.

But why is 'kern' always be applied? I'm not sure if I see the logic there.

Actually, XeTeX does similar weird stuff here too...

\font\1="Verdana:script=" at 12pt\1 Test  % kerning
\font\1="Verdana:script=latn" at 12pt\1 Test  % no kerning
\font\1="Verdana" at 12pt\1 Test  % no kerning

Too late at night for me to think straight.

-- Will



From wspr81 at gmail.com  Sun Jun  6 21:06:00 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Mon, 7 Jun 2010 04:36:00 +0930
Subject: [lltx] kerning; am i mad?
In-Reply-To: <C9841900-2B25-4EE8-8E5A-A41D4D49E48F@gmail.com>
References: <F60D19F3-98A6-4562-9F98-876E4F738509@gmail.com>
	<20100606181427.GA10348@khaled-laptop>
	<C9841900-2B25-4EE8-8E5A-A41D4D49E48F@gmail.com>
Message-ID: <C5FB9520-BEEB-494A-9DCA-3ABFB246FF4A@gmail.com>

On 07/06/2010, at 3:57 AM, Will Robertson wrote:

>> Using "\font\1=name:Verdana:script=latn\1 Test" I get kerning, so for some reason fontspec stopped applying default script.
> 
> That part of the code did get changed recently.
> I'll take a closer look tomorrow. Good to hear I'm not totally crazy.

I've reduced the problem down to this:

\documentclass{article}
\usepackage{luaotfload}
\begin{document}
\def\check#1{\directlua{
local function check_script(id, script)
   local s = string.lower(script)
   if id and id > 0 then
       local otfdata = fonts.ids[id].shared.otfdata
       if otfdata then
           local features = otfdata.luatex.features
           for i,_ in pairs(features) do
               for j,_ in pairs(features[i]) do
                   if features[i][j][s] then
                       return true
                   end
               end
           end
       end
   end
end
 if check_script(font.id("#1"), "latn") then tex.print("true") else tex.print("false") end
}
}
\font\1={name:Verdana}
\check{1}
{\font\2={name:Verdana}\2}
\check{2}
{\global\font\3={name:Verdana}\3}
\check{3}
\end{document}


I don't know if this is intentional or not (it feels like a slight bug to me), but it's obviously easy to work around.

Thanks for the help :)
-- Will



From mpg at elzevir.fr  Sun Jun  6 22:50:22 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sun, 06 Jun 2010 22:50:22 +0200
Subject: [lltx] mkluatexfontdb version 1.07,
	database version 2.009 crashes
In-Reply-To: <7DC7FB17-8F3F-406E-9C17-29E06776BF1A@gmail.com>
References: <F8A1365D-C90B-4D98-9B59-DE6D32B39AE1@Freenet.DE>
	<7DC7FB17-8F3F-406E-9C17-29E06776BF1A@gmail.com>
Message-ID: <4C0C0A0E.6030408@elzevir.fr>

[moving from the TL list to lltx-dev]

Le 06/06/2010 04:23, Will Robertson a ?crit :
> On 06/06/2010, at 6:31 AM, Peter Dyballa wrote:
> 
>> The script crashes every time I invoke it with. It makes no difference whether I run it privately or as super-user with --sys. The font where it crashes is mostly another one (because I cleverly set env OSFONTDIR=...).
> 
> Can you run the script the -vvv and try and isolate which font causes the crash?
> (It might be the *next* one after the last one displayed on the console.)
> 
By the way, could the script be modified so that it displays the name before
trying to load the font? It would be much more useful.

Manuel.

From khaledhosny at eglug.org  Mon Jun  7 19:46:42 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 7 Jun 2010 20:46:42 +0300
Subject: [lltx] mkluatexfontdb version 1.07,
 database version 2.009 crashes
In-Reply-To: <4C0C0A0E.6030408@elzevir.fr>
References: <F8A1365D-C90B-4D98-9B59-DE6D32B39AE1@Freenet.DE>
	<7DC7FB17-8F3F-406E-9C17-29E06776BF1A@gmail.com>
	<4C0C0A0E.6030408@elzevir.fr>
Message-ID: <20100607174641.GA4386@khaled-laptop>

On Sun, Jun 06, 2010 at 10:50:22PM +0200, Manuel P?gouri?-Gonnard wrote:
> [moving from the TL list to lltx-dev]
> 
> Le 06/06/2010 04:23, Will Robertson a ?crit :
> > On 06/06/2010, at 6:31 AM, Peter Dyballa wrote:
> > 
> >> The script crashes every time I invoke it with. It makes no difference whether I run it privately or as super-user with --sys. The font where it crashes is mostly another one (because I cleverly set env OSFONTDIR=...).
> > 
> > Can you run the script the -vvv and try and isolate which font causes the crash?
> > (It might be the *next* one after the last one displayed on the console.)
> > 
> By the way, could the script be modified so that it displays the name before
> trying to load the font? It would be much more useful.

We were already doing that, but I now moved the logging to before
even calling load_font() (we were logging inside that function).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From zhouyan1014 at gmail.com  Thu Jun 10 11:31:09 2010
From: zhouyan1014 at gmail.com (Yan Zhou)
Date: Thu, 10 Jun 2010 10:31:09 +0100
Subject: [lltx] Fail to compile documents with lualatex
Message-ID: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>

Dear all,

I am trying out TeX Live 2010 pretest. I tried to compile an old document with lualatex. It compiles perfectly with pdflatex, but with lualatex, it fails. Below it the error message.

! LaTeX Error: Missing \begin{document}.

See the LaTeX manual or LaTeX Companion for explanation.
Type  H <return>  for immediate help.
 ...                                              
                                                  
l.429 \begin{document}


It looks rather strange. Luatex stop at the line of  \begin{document} but complain that \begin{document} is missing. Is there any extra setup steps needed for luatex?

From zhouyan1014 at gmail.com  Thu Jun 10 11:40:18 2010
From: zhouyan1014 at gmail.com (Yan Zhou)
Date: Thu, 10 Jun 2010 10:40:18 +0100
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
Message-ID: <69F5C366-6B2B-4712-9A3F-C05575D5E78B@gmail.com>

Rely to my own message. The same error I get from x86_64-linux, Universal-Darwin, x86_64-darwin, all three platforms.
I think I must missed something here. But I cannot find it out.

On Jun 10, 2010, at 10:31 AM, Yan Zhou wrote:

> Dear all,
> 
> I am trying out TeX Live 2010 pretest. I tried to compile an old document with lualatex. It compiles perfectly with pdflatex, but with lualatex, it fails. Below it the error message.
> 
> ! LaTeX Error: Missing \begin{document}.
> 
> See the LaTeX manual or LaTeX Companion for explanation.
> Type  H <return>  for immediate help.
> ...                                              
> 
> l.429 \begin{document}
> 
> 
> It looks rather strange. Luatex stop at the line of  \begin{document} but complain that \begin{document} is missing. Is there any extra setup steps needed for luatex?



From khaledhosny at eglug.org  Thu Jun 10 11:43:31 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 10 Jun 2010 12:43:31 +0300
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
Message-ID: <20100610094331.GA22099@khaled-laptop>

On Thu, Jun 10, 2010 at 10:31:09AM +0100, Yan Zhou wrote:
> Dear all,
> 
> I am trying out TeX Live 2010 pretest. I tried to compile an old document with lualatex. It compiles perfectly with pdflatex, but with lualatex, it fails. Below it the error message.
> 
> ! LaTeX Error: Missing \begin{document}.
> 
> See the LaTeX manual or LaTeX Companion for explanation.
> Type  H <return>  for immediate help.
>  ...                                              
>                                                   
> l.429 \begin{document}
> 
> 
> It looks rather strange. Luatex stop at the line of  \begin{document} but complain that \begin{document} is missing. Is there any extra setup steps needed for luatex?

Without a test file there is hardly anything we can do.

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From zhouyan1014 at gmail.com  Thu Jun 10 12:03:31 2010
From: zhouyan1014 at gmail.com (Yan Zhou)
Date: Thu, 10 Jun 2010 11:03:31 +0100
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <20100610094331.GA22099@khaled-laptop>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
	<20100610094331.GA22099@khaled-laptop>
Message-ID: <12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>

Sorry for forget to attach a test file.
Below is a minimal test file.

\documentclass{book}

\title{foo}
\author{foo}

\begin{document}
\maketitle
\end{document}

Later I found that the problem seems to be related to the file name. While the file name contains space, lualatex fails, otherwise it performs good. eg, with the minimal test file as above, if I name the finale "a b.tex", in terminal, The following is produced

$ cat a\ b.tex 
\documentclass{book}

\title{foo}
\author{foo}

\begin{document}
\maketitle
\end{document}


$ lualatex a\ b.tex 
This is LuaTeX, Version beta-0.60.1-2010052109 (TeX Live 2010/pretest) (rev 3685) 
 restricted \write18 enabled.
("./a b.tex"
LaTeX2e <2009/09/24>
LuaTeX adaptation of babel <v3.8l-luatex-1.4> and hyphenation patterns for engl
ish, dumylang, nohyphenation, loaded.
(/usr/local/texlive/2010/texmf-dist/tex/latex/base/book.cls
Document Class: book 2007/10/19 v1.4h Standard LaTeX document class
(/usr/local/texlive/2010/texmf-dist/tex/latex/base/bk10.clo))

! LaTeX Error: Missing \begin{document}.

See the LaTeX manual or LaTeX Companion for explanation.
Type  H <return>  for immediate help.
 ...                                              
                                                  
l.6 \begin{document}
                    
? 




On Jun 10, 2010, at 10:43 AM, Khaled Hosny wrote:

> On Thu, Jun 10, 2010 at 10:31:09AM +0100, Yan Zhou wrote:
>> Dear all,
>> 
>> I am trying out TeX Live 2010 pretest. I tried to compile an old document with lualatex. It compiles perfectly with pdflatex, but with lualatex, it fails. Below it the error message.
>> 
>> ! LaTeX Error: Missing \begin{document}.
>> 
>> See the LaTeX manual or LaTeX Companion for explanation.
>> Type  H <return>  for immediate help.
>> ...                                              
>> 
>> l.429 \begin{document}
>> 
>> 
>> It looks rather strange. Luatex stop at the line of  \begin{document} but complain that \begin{document} is missing. Is there any extra setup steps needed for luatex?
> 
> Without a test file there is hardly anything we can do.
> 
> -- 
> Khaled Hosny
> Arabic localiser and member of Arabeyes.org team
> Free font developer



From khaledhosny at eglug.org  Thu Jun 10 12:24:55 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 10 Jun 2010 13:24:55 +0300
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
	<20100610094331.GA22099@khaled-laptop>
	<12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>
Message-ID: <20100610102455.GA22535@khaled-laptop>

On Thu, Jun 10, 2010 at 11:03:31AM +0100, Yan Zhou wrote:
> Sorry for forget to attach a test file.
> Below is a minimal test file.
> 
> \documentclass{book}
> 
> \title{foo}
> \author{foo}
> 
> \begin{document}
> \maketitle
> \end{document}
> 
> Later I found that the problem seems to be related to the file name. While the file name contains space, lualatex fails, otherwise it performs good. eg, with the minimal test file as above, if I name the finale "a b.tex", in terminal, The following is produced

This sounds like a luatex (engine) bug, so please report this to luatex
developers. Anyway, it is always safer not to use spaces in file names.

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From zhouyan1014 at gmail.com  Thu Jun 10 12:29:24 2010
From: zhouyan1014 at gmail.com (Yan Zhou)
Date: Thu, 10 Jun 2010 11:29:24 +0100
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <20100610102455.GA22535@khaled-laptop>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>
	<20100610094331.GA22099@khaled-laptop>
	<12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>
	<20100610102455.GA22535@khaled-laptop>
Message-ID: <6F9E17F7-247F-47EF-A739-C2ACE043AD78@gmail.com>

I have tested it with a plain tex file using luatex (compile the source of The Texbook with no problem, of course after removing the loop at the beginning of the file) , it works well while the file name contains spaces. So I though it is related to the lualatex command ( though I think lualatex is just a link to luatex with latex formated preloaded). 


On Jun 10, 2010, at 11:24 AM, Khaled Hosny wrote:

> On Thu, Jun 10, 2010 at 11:03:31AM +0100, Yan Zhou wrote:
>> Sorry for forget to attach a test file.
>> Below is a minimal test file.
>> 
>> \documentclass{book}
>> 
>> \title{foo}
>> \author{foo}
>> 
>> \begin{document}
>> \maketitle
>> \end{document}
>> 
>> Later I found that the problem seems to be related to the file name. While the file name contains space, lualatex fails, otherwise it performs good. eg, with the minimal test file as above, if I name the finale "a b.tex", in terminal, The following is produced
> 
> This sounds like a luatex (engine) bug, so please report this to luatex
> developers. Anyway, it is always safer not to use spaces in file names.
> 
> -- 
> Khaled Hosny
> Arabic localiser and member of Arabeyes.org team
> Free font developer



From mpg at elzevir.fr  Thu Jun 10 13:01:10 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Thu, 10 Jun 2010 13:01:10 +0200
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <6F9E17F7-247F-47EF-A739-C2ACE043AD78@gmail.com>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>	<20100610094331.GA22099@khaled-laptop>	<12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>	<20100610102455.GA22535@khaled-laptop>
	<6F9E17F7-247F-47EF-A739-C2ACE043AD78@gmail.com>
Message-ID: <4C10C5F6.7010206@elzevir.fr>

Le 10/06/2010 12:29, Yan Zhou a ?crit :
> I have tested it with a plain tex file using luatex (compile the source of
> The Texbook with no problem,

Please use story.tex for your tests, texbook.tex is not meant to be compiled (or
don't say it on public mailing lists).

> So I though it is related to the lualatex command ( though I think lualatex
> is just a link to luatex with latex formated preloaded).
> 
The core problem is, luatex doesn't handle \jobname in the same way as pdftex
when in contains spaces. This is apparent with LaTeX since it tries to \input
\jobname.aux at begin document.

I seem to remember this was already discussed on the luatex list, I'll look into
the archives. In the meanwhile, I recommend that you just don't use spaces in
file names with LaTeX.

Manuel.

From mpg at elzevir.fr  Thu Jun 10 13:08:19 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Thu, 10 Jun 2010 13:08:19 +0200
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <4C10C5F6.7010206@elzevir.fr>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>	<20100610094331.GA22099@khaled-laptop>	<12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>	<20100610102455.GA22535@khaled-laptop>	<6F9E17F7-247F-47EF-A739-C2ACE043AD78@gmail.com>
	<4C10C5F6.7010206@elzevir.fr>
Message-ID: <4C10C7A3.2040006@elzevir.fr>

Le 10/06/2010 13:01, Manuel P?gouri?-Gonnard a ?crit :
> I seem to remember this was already discussed on the luatex list, I'll look into
> the archives.

Here it is: http://www.ntg.nl/pipermail/dev-luatex/2009-April/002549.html

m

From zhouyan1014 at gmail.com  Thu Jun 10 13:03:20 2010
From: zhouyan1014 at gmail.com (Yan Zhou)
Date: Thu, 10 Jun 2010 12:03:20 +0100
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <4C10C5F6.7010206@elzevir.fr>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>	<20100610094331.GA22099@khaled-laptop>	<12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>	<20100610102455.GA22535@khaled-laptop>
	<6F9E17F7-247F-47EF-A739-C2ACE043AD78@gmail.com>
	<4C10C5F6.7010206@elzevir.fr>
Message-ID: <45133E03-A251-455E-855B-A1834D10BB26@gmail.com>

Thank you for clarifying this for me. And more thanks for pointing out it is already discussed before. I will look into the archives myself too.

On Jun 10, 2010, at 12:01 PM, Manuel P?gouri?-Gonnard wrote:

> Le 10/06/2010 12:29, Yan Zhou a ?crit :
>> I have tested it with a plain tex file using luatex (compile the source of
>> The Texbook with no problem,
> 
> Please use story.tex for your tests, texbook.tex is not meant to be compiled (or
> don't say it on public mailing lists).
> 
>> So I though it is related to the lualatex command ( though I think lualatex
>> is just a link to luatex with latex formated preloaded).
>> 
> The core problem is, luatex doesn't handle \jobname in the same way as pdftex
> when in contains spaces. This is apparent with LaTeX since it tries to \input
> \jobname.aux at begin document.
> 
> I seem to remember this was already discussed on the luatex list, I'll look into
> the archives. In the meanwhile, I recommend that you just don't use spaces in
> file names with LaTeX.
> 
> Manuel.



From mpg at elzevir.fr  Thu Jun 10 14:31:46 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Thu, 10 Jun 2010 14:31:46 +0200
Subject: [lltx] spaces in \jobname
Message-ID: <4C10DB32.6050405@elzevir.fr>

Hi,

As pointed out in a recent thread [1], the problem with spaces in \jobname on
lualatex, already discussed in an older thread [2], is not fixed yet.

[1] http://tug.org/pipermail/lualatex-dev/2010-June/000678.html
[2] http://www.ntg.nl/pipermail/dev-luatex/2009-April/002549.html

In course of [2], ?lie suggested to work around the problem by redefining
\jobname in the format. This is not so easy, since we don't want to add quotes
if \jobname doesn't contain spaces, but we still want \jobname to expand in one
step.

Another idea is to inspect \jobname at \everyjob time (at which point it is
always known, according to my tests) and redefine it if it contains spaces. For
example we could modify lualatex.ini so that it ends like:

\let\dump\relax
\input latex.ltx
\everyjob\expandafter{\the\everyjob
  \begingroup
  \def\testsp#1 #2\relax{%
    \ifx\relax#2\relax
      \let\fixjobname\empty
    \else
      \edef\fixjobname{\def\noexpand\jobname{"\jobname"}}%
    \fi}%
  \edef\dotest{\noexpand\testsp\jobname\space\relax}\dotest
  \expandafter
  \endgroup\fixjobname}
\pdfprimitive\dump

(and similarly for dvilualatex.ini, so probably factor this part out in one
common file).

Tested, it seems to work. (Though it doesn't look too pretty.)

Wdyt?

Manuel.

From mpg at elzevir.fr  Thu Jun 10 15:55:25 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Thu, 10 Jun 2010 15:55:25 +0200
Subject: [lltx] spaces in \jobname
In-Reply-To: <345FF7B3-0BD4-4D58-9A7F-5297C4CA5AC8@gmail.com>
References: <4C10DB32.6050405@elzevir.fr>
	<345FF7B3-0BD4-4D58-9A7F-5297C4CA5AC8@gmail.com>
Message-ID: <4C10EECD.4000706@elzevir.fr>

Le 10/06/2010 15:51, Will Robertson a ?crit :
> On 10/06/2010, at 10:01 PM, Manuel P?gouri?-Gonnard wrote:
> 
>> Tested, it seems to work. (Though it doesn't look too pretty.)
>>
>> Wdyt?
> 
> On very first impressions seems sensible.
> How does pdflatex do it? Surely the same approach would be warranted?
> 
pdftex (web2c) autoquotes \jobname if needed, luatex doesn't. Taco is aware of
that but didn't intend to change it (sorry for not doing a summary of the thread
cited as [2] in the first place, I realise the problem isn't very clear without
this information).

Manuel.

From wspr81 at gmail.com  Thu Jun 10 15:51:02 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Thu, 10 Jun 2010 23:21:02 +0930
Subject: [lltx] spaces in \jobname
In-Reply-To: <4C10DB32.6050405@elzevir.fr>
References: <4C10DB32.6050405@elzevir.fr>
Message-ID: <345FF7B3-0BD4-4D58-9A7F-5297C4CA5AC8@gmail.com>

On 10/06/2010, at 10:01 PM, Manuel P?gouri?-Gonnard wrote:

> Tested, it seems to work. (Though it doesn't look too pretty.)
> 
> Wdyt?

On very first impressions seems sensible.
How does pdflatex do it? Surely the same approach would be warranted?

-- Will



From mpg at elzevir.fr  Sat Jun 12 19:34:20 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sat, 12 Jun 2010 19:34:20 +0200
Subject: [lltx] adapting unicode-letters to luatex
Message-ID: <4C13C51C.2070804@elzevir.fr>

Hi,

I'm following up on the recent discussion on the Luatex mailing list concerning
hyphenation in Greek not working properly with Lualatex, due to the various
\lccode's not being set properly.

I can see that in Xetex-based Plain and Latex formats, the file
unicode-letters.tex is \input-ed and takes care of such things. This file is
generated by the Perl script unicode-char-prep.pl shipped with the Xetex sources
and taking Unicode data files as its inputs (available from
<http://unicode.org/Public/UNIDATA/>).

As is, unicode-letters.tex cannot be usefully \input-ed by LuaTeX, since it
makes use of primitives (\XeTeXmathcode) and even concepts (intercharclass and
interchartoks) specific to Xetex. However, a big part of it (uccodes, lccodes,
sfcodes, catcodes, maybe mathcodes to by just adapting the primitive name) could
be shared with Luatex.

I see at least to possible ways to handle this:
1. Adapt unicode-char-prep.pl so that the generated file can be \input'ed by
both Xetex and Luatex.
2. Make a Luatex-specific version.

I've got no strong opinion on 1 vs 2, but is seems to me that it's probably
easier to have a separate Luatex version, to avoid bothering you, Jonathan,
every time something needs to be changed for LuaTeX.

What do you guys think?

Either way, I'm interested in working on it (in case the only problem is to find
someone to do it).

Manuel.

From khaledhosny at eglug.org  Sat Jun 12 19:54:51 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 12 Jun 2010 20:54:51 +0300
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <4C13C51C.2070804@elzevir.fr>
References: <4C13C51C.2070804@elzevir.fr>
Message-ID: <20100612175451.GA4299@khaled-laptop>

On Sat, Jun 12, 2010 at 07:34:20PM +0200, Manuel P?gouri?-Gonnard wrote:
> Hi,
> 
> I'm following up on the recent discussion on the Luatex mailing list concerning
> hyphenation in Greek not working properly with Lualatex, due to the various
> \lccode's not being set properly.
> 
> I can see that in Xetex-based Plain and Latex formats, the file
> unicode-letters.tex is \input-ed and takes care of such things. This file is
> generated by the Perl script unicode-char-prep.pl shipped with the Xetex sources
> and taking Unicode data files as its inputs (available from
> <http://unicode.org/Public/UNIDATA/>).
> 
> As is, unicode-letters.tex cannot be usefully \input-ed by LuaTeX, since it
> makes use of primitives (\XeTeXmathcode) and even concepts (intercharclass and
> interchartoks) specific to Xetex. However, a big part of it (uccodes, lccodes,
> sfcodes, catcodes, maybe mathcodes to by just adapting the primitive name) could
> be shared with Luatex.
> 
> I see at least to possible ways to handle this:
> 1. Adapt unicode-char-prep.pl so that the generated file can be \input'ed by
> both Xetex and Luatex.
> 2. Make a Luatex-specific version.
> 
> I've got no strong opinion on 1 vs 2, but is seems to me that it's probably
> easier to have a separate Luatex version, to avoid bothering you, Jonathan,
> every time something needs to be changed for LuaTeX.
> 
> What do you guys think?
> 
> Either way, I'm interested in working on it (in case the only problem is to find
> someone to do it).

Since it is a generated file, I see no benefit in sharing it, adapting
the perl script for luatex makes less conflict.

A loosely related issue that I was considering, is to have a Unicode
database in luatex-base, some thing like char-def.lua in ConTeXt, but
auto-generated for maintainability (Unicode is ever growing). It would be
very useful for people writing code that deals with character
proprieties (my lua bidi for example). If we ever had such database, we
can generate the required TeX file from it easily, I can also imagine
an option for doing it on the fly if one really wants.

What do you think?

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From reinhard.kotucha at web.de  Sat Jun 12 23:59:32 2010
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat, 12 Jun 2010 23:59:32 +0200
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <20100612175451.GA4299@khaled-laptop>
References: <4C13C51C.2070804@elzevir.fr> <20100612175451.GA4299@khaled-laptop>
Message-ID: <19476.836.551077.722560@zaphod.ms25.net>

On 12 June 2010 Khaled Hosny wrote:

 > On Sat, Jun 12, 2010 at 07:34:20PM +0200, Manuel P?gouri?-Gonnard wrote:
 > > Hi,
 > > 
 > > I'm following up on the recent discussion on the Luatex mailing
 > > list concerning hyphenation in Greek not working properly with
 > > Lualatex, due to the various \lccode's not being set properly.
 > > 
 > > I can see that in Xetex-based Plain and Latex formats, the file
 > > unicode-letters.tex is \input-ed and takes care of such
 > > things. This file is generated by the Perl script
 > > unicode-char-prep.pl shipped with the Xetex sources and taking
 > > Unicode data files as its inputs (available from
 > > <http://unicode.org/Public/UNIDATA/>).
 > > 
 > > As is, unicode-letters.tex cannot be usefully \input-ed by
 > > LuaTeX, since it makes use of primitives (\XeTeXmathcode) and
 > > even concepts (intercharclass and interchartoks) specific to
 > > Xetex. However, a big part of it (uccodes, lccodes, sfcodes,
 > > catcodes, maybe mathcodes to by just adapting the primitive name)
 > > could be shared with Luatex.
 > > 
 > > I see at least to possible ways to handle this:
 > > 1. Adapt unicode-char-prep.pl so that the generated file can be
 > > \input'ed by both Xetex and Luatex.
 > > 2. Make a Luatex-specific version.
 > > 
 > > I've got no strong opinion on 1 vs 2, but is seems to me that
 > > it's probably easier to have a separate Luatex version, to avoid
 > > bothering you, Jonathan, every time something needs to be changed
 > > for LuaTeX.
 > > 
 > > What do you guys think?
 > > 
 > > Either way, I'm interested in working on it (in case the only
 > > problem is to find someone to do it).
 > 
 > Since it is a generated file, I see no benefit in sharing it,
 > adapting the perl script for luatex makes less conflict.

I think that this is exactly what Manuel suggested.  Sure, it doesn't
make sense to change the generated file.  But the question is whether
it's easy enough to add support for LuaTeX.  Since Jonathan wrote the
script with XeTeX in mind, I don't know whether it's easy to provide
another back-end.  If someone is going to re-write the script, it
makes sense to have a generic internal representation (a hash in Perl
or a table in Lua from which one can create different output formats.

 > A loosely related issue that I was considering, is to have a
 > Unicode database in luatex-base, some thing like char-def.lua in
 > ConTeXt, but auto-generated for maintainability (Unicode is ever
 > growing). It would be very useful for people writing code that
 > deals with character proprieties (my lua bidi for example). If we
 > ever had such database, we can generate the required TeX file from
 > it easily, I can also imagine an option for doing it on the fly if
 > one really wants.

I agree with you that it makes sense to use the Unicode databases.
But I'm not convinced that it should be done on-the-fly.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From mpg at elzevir.fr  Sun Jun 13 00:20:11 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sun, 13 Jun 2010 00:20:11 +0200
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <19476.836.551077.722560@zaphod.ms25.net>
References: <4C13C51C.2070804@elzevir.fr> <20100612175451.GA4299@khaled-laptop>
	<19476.836.551077.722560@zaphod.ms25.net>
Message-ID: <4C14081B.4010103@elzevir.fr>

Le 12/06/2010 23:59, Reinhard Kotucha a ?crit :
> On 12 June 2010 Khaled Hosny wrote:
> 
>  > Since it is a generated file, I see no benefit in sharing it,
>  > adapting the perl script for luatex makes less conflict.
> 
> I think that this is exactly what Manuel suggested.

Actually, I suggested too ways. But this one had indeed my preference.

>  Sure, it doesn't
> make sense to change the generated file.  But the question is whether
> it's easy enough to add support for LuaTeX.  Since Jonathan wrote the
> script with XeTeX in mind, I don't know whether it's easy to provide
> another back-end.

Actually, apart from the mathcode thing (I still need to check the difference
between \XeTeXmathcode and LuaTeX's \mathcode), the initial Luatex version will
essentially be a subset of the Xetex version: removing the part about
interchar(class|toks) and obviously replacing the test about Xetex version by
something more suited to Luatex.

> If someone is going to re-write the script, it
> makes sense to have a generic internal representation (a hash in Perl
> or a table in Lua from which one can create different output formats.
>
I didn't look at the script yet, so I have no idea right now.

>  > A loosely related issue that I was considering, is to have a
>  > Unicode database in luatex-base, some thing like char-def.lua in
>  > ConTeXt, but auto-generated for maintainability (Unicode is ever
>  > growing). It would be very useful for people writing code that
>  > deals with character proprieties (my lua bidi for example). If we
>  > ever had such database, we can generate the required TeX file from
>  > it easily, I can also imagine an option for doing it on the fly if
>  > one really wants.
> 
> I agree with you that it makes sense to use the Unicode databases.
> But I'm not convinced that it should be done on-the-fly.
> 
Or the same script that parses the original Unicode database file can generate
both Lua and TeX output (I don't know it's that what you were suggesting, Reinhard).


Manuel.

From reinhard.kotucha at web.de  Sun Jun 13 01:21:38 2010
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sun, 13 Jun 2010 01:21:38 +0200
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <4C14081B.4010103@elzevir.fr>
References: <4C13C51C.2070804@elzevir.fr> <20100612175451.GA4299@khaled-laptop>
	<19476.836.551077.722560@zaphod.ms25.net>
	<4C14081B.4010103@elzevir.fr>
Message-ID: <19476.5762.542842.165257@zaphod.ms25.net>

On 13 June 2010 Manuel P?gouri?-Gonnard wrote:

 > Le 12/06/2010 23:59, Reinhard Kotucha a ?crit :
 > > I agree with you that it makes sense to use the Unicode databases.
 > > But I'm not convinced that it should be done on-the-fly.
 > > 
 > Or the same script that parses the original Unicode database file
 > can generate both Lua and TeX output (I don't know it's that what
 > you were suggesting, Reinhard).

Yes, this is exactly what I propose, at least if someone is willing do
do this and has enough time.  It's probably easier than to hijack
Jonathan's stuff.

Manuel, do you have enough time?  I assume that your thesis has
highest priority.  I hope so, at least. :)

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From wspr81 at gmail.com  Sun Jun 13 06:21:06 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sun, 13 Jun 2010 13:51:06 +0930
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <4C14081B.4010103@elzevir.fr>
References: <4C13C51C.2070804@elzevir.fr> <20100612175451.GA4299@khaled-laptop>
	<19476.836.551077.722560@zaphod.ms25.net>
	<4C14081B.4010103@elzevir.fr>
Message-ID: <542E4619-458D-4FEF-9B8D-BF911B82E007@gmail.com>

On 13/06/2010, at 7:50 AM, Manuel P?gouri?-Gonnard wrote:

> Actually, apart from the mathcode thing (I still need to check the difference
> between \XeTeXmathcode and LuaTeX's \mathcode)

You can use LuaTeX's \Umathcode; Taco wrote the unicode math support in LuaTeX to be compatible with the XeTeX extensions.

-- Will



From khaledhosny at eglug.org  Sun Jun 13 06:29:45 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 13 Jun 2010 07:29:45 +0300
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <19476.836.551077.722560@zaphod.ms25.net>
References: <4C13C51C.2070804@elzevir.fr> <20100612175451.GA4299@khaled-laptop>
	<19476.836.551077.722560@zaphod.ms25.net>
Message-ID: <20100613042945.GA3055@khaled-laptop>

On Sat, Jun 12, 2010 at 11:59:32PM +0200, Reinhard Kotucha wrote:
> On 12 June 2010 Khaled Hosny wrote:
>
>  > A loosely related issue that I was considering, is to have a
>  > Unicode database in luatex-base, some thing like char-def.lua in
>  > ConTeXt, but auto-generated for maintainability (Unicode is ever
>  > growing). It would be very useful for people writing code that
>  > deals with character proprieties (my lua bidi for example). If we
>  > ever had such database, we can generate the required TeX file from
>  > it easily, I can also imagine an option for doing it on the fly if
>  > one really wants.
> 
> I agree with you that it makes sense to use the Unicode databases.
> But I'm not convinced that it should be done on-the-fly.

I don't say it should, I say it can, as an option, so when there is a
new release of Unicode or correction to our database, one can update the
luabase package and benefit from the updates immediately without messing
with the format.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Sun Jun 13 10:03:36 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Sun, 13 Jun 2010 10:03:36 +0200
Subject: [lltx] adapting unicode-letters to luatex
In-Reply-To: <542E4619-458D-4FEF-9B8D-BF911B82E007@gmail.com>
References: <4C13C51C.2070804@elzevir.fr>
	<20100612175451.GA4299@khaled-laptop>	<19476.836.551077.722560@zaphod.ms25.net>	<4C14081B.4010103@elzevir.fr>
	<542E4619-458D-4FEF-9B8D-BF911B82E007@gmail.com>
Message-ID: <4C1490D8.3030603@elzevir.fr>

Le 13/06/2010 06:21, Will Robertson a ?crit :
> On 13/06/2010, at 7:50 AM, Manuel P?gouri?-Gonnard wrote:
> 
>> Actually, apart from the mathcode thing (I still need to check the difference
>> between \XeTeXmathcode and LuaTeX's \mathcode)
> 
> You can use LuaTeX's \Umathcode; Taco wrote the unicode math support in LuaTeX to be compatible with the XeTeX extensions.
> 
Great, thanks for the info.

Manuel.

From mpg at elzevir.fr  Mon Jun 14 13:27:30 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Mon, 14 Jun 2010 13:27:30 +0200
Subject: [lltx] spaces in \jobname
In-Reply-To: <4C10DB32.6050405@elzevir.fr>
References: <4C10DB32.6050405@elzevir.fr>
Message-ID: <4C161222.1060406@elzevir.fr>

Le 10/06/2010 14:31, Manuel P?gouri?-Gonnard a ?crit :
> Another idea is to inspect \jobname at \everyjob time (at which point it is
> always known, according to my tests) and redefine it if it contains spaces.

Ok, so I've done that (r18968 in TL).

Manuel.

From mpg at elzevir.fr  Mon Jun 14 13:30:22 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Mon, 14 Jun 2010 13:30:22 +0200
Subject: [lltx] Fail to compile documents with lualatex
In-Reply-To: <12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>
References: <17856CC0-9F20-42CA-BEDC-DF0CA06C4F8D@gmail.com>	<20100610094331.GA22099@khaled-laptop>
	<12E90ECC-7E85-48B5-A514-5604FF0295A6@gmail.com>
Message-ID: <4C1612CE.9010908@elzevir.fr>

Le 10/06/2010 12:03, Yan Zhou a ?crit :
> Later I found that the problem seems to be related to the file name. While
> the file name contains space, lualatex fails, otherwise it performs good.

This should be fixed in tomorrow's update of tlpretest. You may need to
re-generate the formats (fmtutil-sys --byengine luatex, or fmtutil if you
already have formats in your home) before it works.

Manuel.

From khaledhosny at eglug.org  Tue Jun 22 14:28:35 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 22 Jun 2010 15:28:35 +0300
Subject: [lltx] lualibs depricated function
Message-ID: <20100622122835.GA5316@khaled-laptop>

As lualibs is mainly a repackaged ConTeXt libraries, the more close to
ConTeXt it is the more simpler the maintenance.

Currently, lualibs has some aliases to ConTeXt functions, as well as
implementations of deprecated/removed ones.

I checked other lua packages and found non of these functions is used,
expect of two fpath functions is luatextra that I just fixed, so I
decided to remove them completely.

Here is a list of the removed functions so that any one using them can
adapt his code:

* aliases, used the original function instead:
  fpath           = file
  fpath.split     = file.split_path
  lfs.is_readable = file.is_readable
  lfs.is_writable = file.is_writable

* removed functions, no direct replacement (they were removed in the
  first place mostly because the implementation is not robust):
  string:stripspaces
  lpeg.space
  lpeg.newline
  table.contains_value
  table.contains_key
  table.value_position
  table.key_position
  table.remove_key
  fpath.normalize_sep
  fpath.localize_sep
  table.starts_at

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From news3 at nililand.de  Wed Jun 23 16:26:41 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Wed, 23 Jun 2010 16:26:41 +0200
Subject: [lltx] location of font cache /fontspec and microtype
Message-ID: <1esqpmd7dy3kr.dlg@nililand.de>

Hello,

1. The script mkluatexfontdb claims:

"The output database file is named otfl-fonts.lua. By default it is
placed
in $TEXMFVAR/luatex/generic/luaotfload/names"

Well in my case is not there but in the same root where the script
resides in tex/luatex/luaotfload/names. 


Is this simply a documentation error or is there something wrong
with my setup? (lualatex finds map files in my TEXMFVAR =
!!$USERPROFILE/Lokale Einstellungen/Anwendungsdaten/MiKTeX/2.7
without problems).


2. Somewhere else someone asked about lualatex + microtype. After
some tests I found the following solution:

\documentclass[fontsize=12pt]{scrartcl}
\usepackage{luaotfload}
\usepackage[EU2]{fontenc}
\usepackage{microtype}
\usepackage{lipsum}

\usepackage{fontspec}

\newfontfeature{Microtype}{protrusion=default;expansion=default;}
\setmainfont[Microtype,Ligatures=TeX]{Linux Libertine O}

%or without \newfontfeature
%\setmainfont[RawFeature={protrusion=default;expansion=default;},Ligatures=TeX]{Linux
% Libertine O}

\begin{document}
\lipsum
\end{document}

Is \newfontfeature the right command to add such new features? And
if yes what would be good names for the microtype features?
 


-- 
Ulrike Fischer 


From khaledhosny at eglug.org  Wed Jun 23 17:46:58 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 23 Jun 2010 18:46:58 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <1esqpmd7dy3kr.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
Message-ID: <20100623154658.GA2735@khaled-laptop>

On Wed, Jun 23, 2010 at 04:26:41PM +0200, Ulrike Fischer wrote:
> Hello,
> 
> 1. The script mkluatexfontdb claims:
> 
> "The output database file is named otfl-fonts.lua. By default it is
> placed
> in $TEXMFVAR/luatex/generic/luaotfload/names"
> 
> Well in my case is not there but in the same root where the script
> resides in tex/luatex/luaotfload/names. 

That was the old place, I forgot to update the documentation.

Now it is $TEXMFVAR/luatex-cache/generic/names.

> 
> 
> Is this simply a documentation error or is there something wrong
> with my setup? (lualatex finds map files in my TEXMFVAR =
> !!$USERPROFILE/Lokale Einstellungen/Anwendungsdaten/MiKTeX/2.7
> without problems).
> 
> 
> 2. Somewhere else someone asked about lualatex + microtype. After
> some tests I found the following solution:
> 
> \documentclass[fontsize=12pt]{scrartcl}
> \usepackage{luaotfload}
> \usepackage[EU2]{fontenc}
> \usepackage{microtype}
> \usepackage{lipsum}
> 
> \usepackage{fontspec}
> 
> \newfontfeature{Microtype}{protrusion=default;expansion=default;}
> \setmainfont[Microtype,Ligatures=TeX]{Linux Libertine O}
> 
> %or without \newfontfeature
> %\setmainfont[RawFeature={protrusion=default;expansion=default;},Ligatures=TeX]{Linux
> % Libertine O}
> 
> \begin{document}
> \lipsum
> \end{document}
> 
> Is \newfontfeature the right command to add such new features? And
> if yes what would be good names for the microtype features?

I was thinking about adding to new fontspec feature, Protrusion and
Expansion, since the two are quite different and should be separately
controlled. I just need to figure out how to implement it :)

PS. You don't need microtype for luaotfload features, you just have to
set: \pdfprotrudechars2 and \pdfadjustspacing2 to activate protrusion
and expansion respectively.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Thu Jun 24 00:03:13 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Thu, 24 Jun 2010 00:03:13 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <20100623154658.GA2735@khaled-laptop>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
Message-ID: <4C2284A1.8080405@elzevir.fr>

Le 23/06/2010 17:46, Khaled Hosny a ?crit :
> On Wed, Jun 23, 2010 at 04:26:41PM +0200, Ulrike Fischer wrote:
>> Hello,
>>
>> 1. The script mkluatexfontdb claims:
>>
>> "The output database file is named otfl-fonts.lua. By default it is
>> placed
>> in $TEXMFVAR/luatex/generic/luaotfload/names"
>>
>> Well in my case is not there but in the same root where the script
>> resides in tex/luatex/luaotfload/names. 
> 
> That was the old place, I forgot to update the documentation.
> 
> Now it is $TEXMFVAR/luatex-cache/generic/names.
> 
Are you sure? I thought it was $TEXMFVAR/tex/luatex/luaotfload/names now...

Manuel.

From mpg at elzevir.fr  Thu Jun 24 00:31:29 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Thu, 24 Jun 2010 00:31:29 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <4C2284A1.8080405@elzevir.fr>
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>
	<4C2284A1.8080405@elzevir.fr>
Message-ID: <4C228B41.7060605@elzevir.fr>

Le 24/06/2010 00:03, Manuel P?gouri?-Gonnard a ?crit :
> Le 23/06/2010 17:46, Khaled Hosny a ?crit :
>> On Wed, Jun 23, 2010 at 04:26:41PM +0200, Ulrike Fischer wrote:
>>> Hello,
>>>
>>> 1. The script mkluatexfontdb claims:
>>>
>>> "The output database file is named otfl-fonts.lua. By default it is
>>> placed
>>> in $TEXMFVAR/luatex/generic/luaotfload/names"
>>>
>>> Well in my case is not there but in the same root where the script
>>> resides in tex/luatex/luaotfload/names. 
>>
>> That was the old place, I forgot to update the documentation.
>>
>> Now it is $TEXMFVAR/luatex-cache/generic/names.
>>
> Are you sure? I thought it was $TEXMFVAR/tex/luatex/luaotfload/names now...
> 
Ok, I just saw the thread on the TL list, so I see you changed that. IMO, it's
better to use TEXMFVAR (and a consistent TDS location under that) rather than
TEXMFCACHE which is a context specific thing.

Manuel.

From khaledhosny at eglug.org  Thu Jun 24 04:47:16 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 05:47:16 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <4C228B41.7060605@elzevir.fr>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop> <4C2284A1.8080405@elzevir.fr>
	<4C228B41.7060605@elzevir.fr>
Message-ID: <20100624024716.GC3838@khaled-laptop>

On Thu, Jun 24, 2010 at 12:31:29AM +0200, Manuel P?gouri?-Gonnard wrote:
> Le 24/06/2010 00:03, Manuel P?gouri?-Gonnard a ?crit :
> > Le 23/06/2010 17:46, Khaled Hosny a ?crit :
> >> On Wed, Jun 23, 2010 at 04:26:41PM +0200, Ulrike Fischer wrote:
> >>> Hello,
> >>>
> >>> 1. The script mkluatexfontdb claims:
> >>>
> >>> "The output database file is named otfl-fonts.lua. By default it is
> >>> placed
> >>> in $TEXMFVAR/luatex/generic/luaotfload/names"
> >>>
> >>> Well in my case is not there but in the same root where the script
> >>> resides in tex/luatex/luaotfload/names. 
> >>
> >> That was the old place, I forgot to update the documentation.
> >>
> >> Now it is $TEXMFVAR/luatex-cache/generic/names.
> >>
> > Are you sure? I thought it was $TEXMFVAR/tex/luatex/luaotfload/names now...
> > 
> Ok, I just saw the thread on the TL list, so I see you changed that. IMO, it's
> better to use TEXMFVAR (and a consistent TDS location under that) rather than
> TEXMFCACHE which is a context specific thing.

I just fixed that VARTEXMF typo, so it should work again now. I thought
texlive-2010 had TEXMFCACHE so I added it to my texlive-2009 texmf.cnf,
that is why I didn't notice it before, I just switched to 2010 pretest.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From news3 at nililand.de  Thu Jun 24 09:56:56 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 24 Jun 2010 09:56:56 +0200
Subject: [lltx] location of font cache /fontspec and microtype
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
Message-ID: <k1xyynrfbqy8.dlg@nililand.de>

Am Wed, 23 Jun 2010 18:46:58 +0300 schrieb Khaled Hosny:

>> 1. The script mkluatexfontdb claims:
>> 
>> "The output database file is named otfl-fonts.lua. By default it is
>> placed
>> in $TEXMFVAR/luatex/generic/luaotfload/names"
>> 
>> Well in my case is not there but in the same root where the script
>> resides in tex/luatex/luaotfload/names. 
 
> That was the old place, I forgot to update the documentation.
 
> Now it is $TEXMFVAR/luatex-cache/generic/names.

I installed luaotfload two days ago (I think from the CTAN-tds, but
it also could be that I used the files in w32tex-package) and this
version uses in otfl-font-nms.lua

local names_dir      = "/tex/luatex/luaotfload/names/"
localdir  = kpse.expand_var("$TEXMFMAIN") .. names_dir,

which is the place where the font cache is found after I run the
script.


Btw: I had some problems to run the mkluatexfontdb script due to
some dubious (chess) fonts in my system font folder: The script run
a long time and then failed with a "no memory" message. It worked
fine after I removed the fonts. Is there somewhere a config file
"ignore_this_bad_fonts_please.cfg"?

I suggest also that you mention in the documentation *how* a lua
script like mkluatexfontdb.lua can be run. E.g. on windows I had to
use "texlua mkluatexfontdb.lua" which is not something a new
lua(la)tex user can guess easily. 
 

-- 
Ulrike Fischer 


From mpg at elzevir.fr  Thu Jun 24 10:10:32 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Thu, 24 Jun 2010 10:10:32 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <20100624024716.GC3838@khaled-laptop>
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>
	<4C2284A1.8080405@elzevir.fr>	<4C228B41.7060605@elzevir.fr>
	<20100624024716.GC3838@khaled-laptop>
Message-ID: <4C2312F8.5070309@elzevir.fr>

Le 24/06/2010 04:47, Khaled Hosny a ?crit :
> I just fixed that VARTEXMF typo, so it should work again now. I thought
> texlive-2010 had TEXMFCACHE so I added it to my texlive-2009 texmf.cnf,
> that is why I didn't notice it before, I just switched to 2010 pretest.
> 
Anyway, TEXMFCACHE is quite conTeXt specific and it's not even sure that conTeXt
will continue using it (at least in TL) once it'll become more multi-user. OTOH,
TEXMFVAR has been there for many years now and will probably always be, and is
well suited for this kind of thing.

So, even if TL'10 had a TEXMFCACHE variable, I'd recommend sticking to TEXMFVAR.

Manuel.

From mpg at elzevir.fr  Thu Jun 24 10:12:26 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Thu, 24 Jun 2010 10:12:26 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <k1xyynrfbqy8.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
Message-ID: <4C23136A.3040003@elzevir.fr>

Le 24/06/2010 09:56, Ulrike Fischer a ?crit :
> I suggest also that you mention in the documentation *how* a lua
> script like mkluatexfontdb.lua can be run. E.g. on windows I had to
> use "texlua mkluatexfontdb.lua" which is not something a new
> lua(la)tex user can guess easily. 
> 
FYI, in TeX Live you can run mkluatexfontdb like any other command. But I agree
that documentation for other systems never hurt, though in practice TL is the
only distro shipping luatex atm.

Manuel.

From news3 at nililand.de  Thu Jun 24 10:34:03 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 24 Jun 2010 10:34:03 +0200
Subject: [lltx] location of font cache /fontspec and microtype
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de> <4C23136A.3040003@elzevir.fr>
Message-ID: <p092xg5g8hgc.dlg@nililand.de>

Am Thu, 24 Jun 2010 10:12:26 +0200 schrieb Manuel P?gouri?-Gonnard:

> Le 24/06/2010 09:56, Ulrike Fischer a ?crit :
>> I suggest also that you mention in the documentation *how* a lua
>> script like mkluatexfontdb.lua can be run. E.g. on windows I had to
>> use "texlua mkluatexfontdb.lua" which is not something a new
>> lua(la)tex user can guess easily. 

> FYI, in TeX Live you can run mkluatexfontdb like any other command. But I agree
> that documentation for other systems never hurt, though in practice TL is the
> only distro shipping luatex atm.

Bingo. I hadn't seen this, there is a mkluatexfontdb.exe in the bin
folder of the w32tex package. I hadn't expected that because the
documentation says you should run the *script*. An .exe is not a
script for me. So I would suggest to write something like this:

To update the database manually, run the script
mkluatexfontdb.lua that is included in this package either by
calling the wrapper application mkluatexfontdb.exe or with
"texlua.exe mkluatexfontdb.lua"

-- 
Ulrike Fischer 


From khaledhosny at eglug.org  Thu Jun 24 13:56:31 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 14:56:31 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <4C2312F8.5070309@elzevir.fr>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop> <4C2284A1.8080405@elzevir.fr>
	<4C228B41.7060605@elzevir.fr> <20100624024716.GC3838@khaled-laptop>
	<4C2312F8.5070309@elzevir.fr>
Message-ID: <20100624115631.GA2868@khaled-laptop>

On Thu, Jun 24, 2010 at 10:10:32AM +0200, Manuel P?gouri?-Gonnard wrote:
> Le 24/06/2010 04:47, Khaled Hosny a ?crit :
> > I just fixed that VARTEXMF typo, so it should work again now. I thought
> > texlive-2010 had TEXMFCACHE so I added it to my texlive-2009 texmf.cnf,
> > that is why I didn't notice it before, I just switched to 2010 pretest.
> > 
> Anyway, TEXMFCACHE is quite conTeXt specific and it's not even sure that conTeXt
> will continue using it (at least in TL) once it'll become more multi-user. OTOH,
> TEXMFVAR has been there for many years now and will probably always be, and is
> well suited for this kind of thing.
> 
> So, even if TL'10 had a TEXMFCACHE variable, I'd recommend sticking to TEXMFVAR.

I just don't want to patch context files for no strong reason, the less
the difference the easier my life.

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From elie.roux at telecom-bretagne.eu  Thu Jun 24 15:16:47 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Thu, 24 Jun 2010 15:16:47 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <20100624115631.GA2868@khaled-laptop>
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>
	<4C2284A1.8080405@elzevir.fr>	<4C228B41.7060605@elzevir.fr>
	<20100624024716.GC3838@khaled-laptop>	<4C2312F8.5070309@elzevir.fr>
	<20100624115631.GA2868@khaled-laptop>
Message-ID: <4C235ABF.4090002@telecom-bretagne.eu>

Khaled Hosny a ?crit :
> I just don't want to patch context files for no strong reason, the less
> the difference the easier my life.
>   

I think this should make everyone happy:

os.setenv('TEXMFCACHE', kpse.expand_var("$TEXMFVAR"))

Thank you,
-- 
Elie

From khaledhosny at eglug.org  Thu Jun 24 19:37:47 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 20:37:47 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <4C235ABF.4090002@telecom-bretagne.eu>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop> <4C2284A1.8080405@elzevir.fr>
	<4C228B41.7060605@elzevir.fr> <20100624024716.GC3838@khaled-laptop>
	<4C2312F8.5070309@elzevir.fr> <20100624115631.GA2868@khaled-laptop>
	<4C235ABF.4090002@telecom-bretagne.eu>
Message-ID: <20100624173747.GA2557@khaled-laptop>

On Thu, Jun 24, 2010 at 03:16:47PM +0200, Elie Roux wrote:
> Khaled Hosny a ?crit :
> >I just don't want to patch context files for no strong reason, the less
> >the difference the easier my life.
> 
> I think this should make everyone happy:
> 
> os.setenv('TEXMFCACHE', kpse.expand_var("$TEXMFVAR"))

The code already tries TEXMFVAR if TEXMFCACHE is not set (well, there was
a typo but got fixed).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Thu Jun 24 19:41:57 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 20:41:57 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <p092xg5g8hgc.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de> <4C23136A.3040003@elzevir.fr>
	<p092xg5g8hgc.dlg@nililand.de>
Message-ID: <20100624174157.GB2557@khaled-laptop>

On Thu, Jun 24, 2010 at 10:34:03AM +0200, Ulrike Fischer wrote:
> Am Thu, 24 Jun 2010 10:12:26 +0200 schrieb Manuel P?gouri?-Gonnard:
> 
> > Le 24/06/2010 09:56, Ulrike Fischer a ?crit :
> >> I suggest also that you mention in the documentation *how* a lua
> >> script like mkluatexfontdb.lua can be run. E.g. on windows I had to
> >> use "texlua mkluatexfontdb.lua" which is not something a new
> >> lua(la)tex user can guess easily. 
> 
> > FYI, in TeX Live you can run mkluatexfontdb like any other command. But I agree
> > that documentation for other systems never hurt, though in practice TL is the
> > only distro shipping luatex atm.
> 
> Bingo. I hadn't seen this, there is a mkluatexfontdb.exe in the bin
> folder of the w32tex package. I hadn't expected that because the
> documentation says you should run the *script*. An .exe is not a
> script for me. So I would suggest to write something like this:
> 
> To update the database manually, run the script
> mkluatexfontdb.lua that is included in this package either by
> calling the wrapper application mkluatexfontdb.exe or with
> "texlua.exe mkluatexfontdb.lua"

But this is very Windows specific. The wrappers exist for all scripts in
a distribution, so I feel the user have to refer to his distribution
documentation to see how to run such a script. BTW, "luatex(.exe)
mkluatexfontdb.lua" will also work (if the input file has a .lua
extension then luatex will act as texlua.)

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Thu Jun 24 20:08:05 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 21:08:05 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <p092xg5g8hgc.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de> <4C23136A.3040003@elzevir.fr>
	<p092xg5g8hgc.dlg@nililand.de>
Message-ID: <20100624180805.GA2672@khaled-laptop>

On Thu, Jun 24, 2010 at 10:34:03AM +0200, Ulrike Fischer wrote:
> Am Thu, 24 Jun 2010 10:12:26 +0200 schrieb Manuel P?gouri?-Gonnard:
> 
> > Le 24/06/2010 09:56, Ulrike Fischer a ?crit :
> >> I suggest also that you mention in the documentation *how* a lua
> >> script like mkluatexfontdb.lua can be run. E.g. on windows I had to
> >> use "texlua mkluatexfontdb.lua" which is not something a new
> >> lua(la)tex user can guess easily. 
> 
> > FYI, in TeX Live you can run mkluatexfontdb like any other command. But I agree
> > that documentation for other systems never hurt, though in practice TL is the
> > only distro shipping luatex atm.
> 
> Bingo. I hadn't seen this, there is a mkluatexfontdb.exe in the bin
> folder of the w32tex package. I hadn't expected that because the
> documentation says you should run the *script*. An .exe is not a
> script for me. So I would suggest to write something like this:
> 
> To update the database manually, run the script
> mkluatexfontdb.lua that is included in this package either by
> calling the wrapper application mkluatexfontdb.exe or with
> "texlua.exe mkluatexfontdb.lua"

OK, I rewrote the font database section a bit to make it clear that the
font database will be auto-generated without manually running
mkluatexfontdb, and added the above paragraph as a footnote.

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Thu Jun 24 20:16:00 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 21:16:00 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <k1xyynrfbqy8.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
Message-ID: <20100624181600.GB2672@khaled-laptop>

On Thu, Jun 24, 2010 at 09:56:56AM +0200, Ulrike Fischer wrote:
> Am Wed, 23 Jun 2010 18:46:58 +0300 schrieb Khaled Hosny:
> 
> >> 1. The script mkluatexfontdb claims:
> >> 
> >> "The output database file is named otfl-fonts.lua. By default it is
> >> placed
> >> in $TEXMFVAR/luatex/generic/luaotfload/names"
> >> 
> >> Well in my case is not there but in the same root where the script
> >> resides in tex/luatex/luaotfload/names. 
>  
> > That was the old place, I forgot to update the documentation.
>  
> > Now it is $TEXMFVAR/luatex-cache/generic/names.
> 
> I installed luaotfload two days ago (I think from the CTAN-tds, but
> it also could be that I used the files in w32tex-package) and this
> version uses in otfl-font-nms.lua
> 
> local names_dir      = "/tex/luatex/luaotfload/names/"
> localdir  = kpse.expand_var("$TEXMFMAIN") .. names_dir,
> 
> which is the place where the font cache is found after I run the
> script.
> 
> 
> Btw: I had some problems to run the mkluatexfontdb script due to
> some dubious (chess) fonts in my system font folder: The script run
> a long time and then failed with a "no memory" message. It worked
> fine after I removed the fonts. Is there somewhere a config file
> "ignore_this_bad_fonts_please.cfg"?

We currently hard code some known problematic fonts, but such a
blacklisting file is on the todo list.

What do you thing about a plain text file with file names one per line?
May be with an optional prefix, "file:" (the default) and "name:".

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From news3 at nililand.de  Thu Jun 24 20:33:54 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 24 Jun 2010 20:33:54 +0200
Subject: [lltx] location of font cache /fontspec and microtype
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
	<20100624181600.GB2672@khaled-laptop>
Message-ID: <hjbblu3m0tqh$.dlg@nililand.de>

Am Thu, 24 Jun 2010 21:16:00 +0300 schrieb Khaled Hosny:

>> Btw: I had some problems to run the mkluatexfontdb script due to
>> some dubious (chess) fonts in my system font folder: The script run
>> a long time and then failed with a "no memory" message. It worked
>> fine after I removed the fonts. Is there somewhere a config file
>> "ignore_this_bad_fonts_please.cfg"?
> 
> We currently hard code some known problematic fonts, but such a
> blacklisting file is on the todo list.
> 
> What do you thing about a plain text file with file names one per line?
> May be with an optional prefix, "file:" (the default) and "name:".

Yes, that would be perfect.  


-- 
Ulrike Fischer 


From news3 at nililand.de  Thu Jun 24 20:44:26 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 24 Jun 2010 20:44:26 +0200
Subject: [lltx] location of font cache /fontspec and microtype
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de> <4C23136A.3040003@elzevir.fr>
	<p092xg5g8hgc.dlg@nililand.de>
	<20100624180805.GA2672@khaled-laptop>
Message-ID: <15yq7kvavib8j$.dlg@nililand.de>

Am Thu, 24 Jun 2010 21:08:05 +0300 schrieb Khaled Hosny:

> OK, I rewrote the font database section a bit to make it clear that the
> font database will be auto-generated without manually running
> mkluatexfontdb, 

I had unterstand this. My first try was to compile a document which
uses luaoftload. But due to the problem with the bad fonts I had to
run mkluatexfontdb manually to get more informations about the
source of the problem. 

-- 
Ulrike Fischer 


From khaledhosny at eglug.org  Thu Jun 24 21:35:41 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 22:35:41 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <hjbblu3m0tqh$.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
	<20100624181600.GB2672@khaled-laptop>
	<hjbblu3m0tqh$.dlg@nililand.de>
Message-ID: <20100624193541.GA2895@khaled-laptop>

On Thu, Jun 24, 2010 at 08:33:54PM +0200, Ulrike Fischer wrote:
> Am Thu, 24 Jun 2010 21:16:00 +0300 schrieb Khaled Hosny:
> 
> >> Btw: I had some problems to run the mkluatexfontdb script due to
> >> some dubious (chess) fonts in my system font folder: The script run
> >> a long time and then failed with a "no memory" message. It worked
> >> fine after I removed the fonts. Is there somewhere a config file
> >> "ignore_this_bad_fonts_please.cfg"?
> > 
> > We currently hard code some known problematic fonts, but such a
> > blacklisting file is on the todo list.
> > 
> > What do you thing about a plain text file with file names one per line?
> > May be with an optional prefix, "file:" (the default) and "name:".
> 
> Yes, that would be perfect.  

I've a, more or less, working code now, I just need a name for that
blacklist file (and please no weired, hard to remember names).


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Thu Jun 24 21:49:55 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 24 Jun 2010 22:49:55 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <15yq7kvavib8j$.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de> <4C23136A.3040003@elzevir.fr>
	<p092xg5g8hgc.dlg@nililand.de>
	<20100624180805.GA2672@khaled-laptop>
	<15yq7kvavib8j$.dlg@nililand.de>
Message-ID: <20100624194955.GA3327@khaled-laptop>

On Thu, Jun 24, 2010 at 08:44:26PM +0200, Ulrike Fischer wrote:
> Am Thu, 24 Jun 2010 21:08:05 +0300 schrieb Khaled Hosny:
> 
> > OK, I rewrote the font database section a bit to make it clear that the
> > font database will be auto-generated without manually running
> > mkluatexfontdb, 
> 
> I had unterstand this. My first try was to compile a document which
> uses luaoftload. But due to the problem with the bad fonts I had to
> run mkluatexfontdb manually to get more informations about the
> source of the problem. 

This is one of the reasons the standalone utility still useful.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Fri Jun 25 10:16:29 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 25 Jun 2010 11:16:29 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <20100624193541.GA2895@khaled-laptop>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
	<20100624181600.GB2672@khaled-laptop>
	<hjbblu3m0tqh$.dlg@nililand.de>
	<20100624193541.GA2895@khaled-laptop>
Message-ID: <20100625081629.GA13952@khaled-laptop>

On Thu, Jun 24, 2010 at 10:35:41PM +0300, Khaled Hosny wrote:
> On Thu, Jun 24, 2010 at 08:33:54PM +0200, Ulrike Fischer wrote:
> > Am Thu, 24 Jun 2010 21:16:00 +0300 schrieb Khaled Hosny:
> > 
> > >> Btw: I had some problems to run the mkluatexfontdb script due to
> > >> some dubious (chess) fonts in my system font folder: The script run
> > >> a long time and then failed with a "no memory" message. It worked
> > >> fine after I removed the fonts. Is there somewhere a config file
> > >> "ignore_this_bad_fonts_please.cfg"?
> > > 
> > > We currently hard code some known problematic fonts, but such a
> > > blacklisting file is on the todo list.
> > > 
> > > What do you thing about a plain text file with file names one per line?
> > > May be with an optional prefix, "file:" (the default) and "name:".
> > 
> > Yes, that would be perfect.  
> 
> I've a, more or less, working code now, I just need a name for that
> blacklist file (and please no weired, hard to remember names).

Given there were not much suggestions (I should not have talked about
weired names :), I went with otfl-blacklist.cnf.

There can be as much copies of this file as kpse can find (we look for
"tex" format despite of the file extension, so it can exist any where a
.tex file can) and all found files will be loaded an read.

I also dropped the prefix idea, though was already implemented, since
blacklisting fonts by name is not as reliable (we only have access to
postscript names before fully loading the font, but names users expect
can differ).

The parser is rather dump, it assumes a good formated file; one font
per line, no trailing spaces, no inline comments, lines starting with
"%" and empty lines will be ignored, any other lines will end in the
blacklist table without any further processing.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From news3 at nililand.de  Fri Jun 25 11:03:53 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Fri, 25 Jun 2010 11:03:53 +0200
Subject: [lltx] location of font cache /fontspec and microtype
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
	<20100624181600.GB2672@khaled-laptop>
	<hjbblu3m0tqh$.dlg@nililand.de>
	<20100624193541.GA2895@khaled-laptop>
	<20100625081629.GA13952@khaled-laptop>
Message-ID: <1h4uwa8uov9lg.dlg@nililand.de>

Am Fri, 25 Jun 2010 11:16:29 +0300 schrieb Khaled Hosny:


>>> >> Btw: I had some problems to run the mkluatexfontdb script due to
>>> >> some dubious (chess) fonts in my system font folder: The script run
>>> >> a long time and then failed with a "no memory" message. It worked
>>> >> fine after I removed the fonts. Is there somewhere a config file
>>> >> "ignore_this_bad_fonts_please.cfg"?
>>> > 
>>> > We currently hard code some known problematic fonts, but such a
>>> > blacklisting file is on the todo list.
>>> > 
>>> > What do you thing about a plain text file with file names one per line?
>>> > May be with an optional prefix, "file:" (the default) and "name:".
>>> 
>>> Yes, that would be perfect.  
>> 
>> I've a, more or less, working code now, I just need a name for that
>> blacklist file (and please no weired, hard to remember names).
> 
> Given there were not much suggestions (I should not have talked about
> weired names :), 

Give me a bit time ;-) I have to do some other work too ...


> I went with otfl-blacklist.cnf.

Well I was just about to suggest luaotfload-blacklist ...

> 
> There can be as much copies of this file as kpse can find (we look for
> "tex" format despite of the file extension, so it can exist any where a
> .tex file can) and all found files will be loaded an read.
> 
> I also dropped the prefix idea, though was already implemented, since
> blacklisting fonts by name is not as reliable (we only have access to
> postscript names before fully loading the font, but names users expect
> can differ).

This means that the file name like arial.ttf should be used, right?
Can pathes be used so that only versions in some folders are
excluded? This could be useful e.g. to force lualatex to use a
specific version of a font.

 
> The parser is rather dump, 

A dump parser is fine. Much easier to manage that one which is to
clever. 
 


-- 
Ulrike Fischer 


From khaledhosny at eglug.org  Fri Jun 25 13:10:55 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 25 Jun 2010 14:10:55 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <1h4uwa8uov9lg.dlg@nililand.de>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
	<20100624181600.GB2672@khaled-laptop>
	<hjbblu3m0tqh$.dlg@nililand.de>
	<20100624193541.GA2895@khaled-laptop>
	<20100625081629.GA13952@khaled-laptop>
	<1h4uwa8uov9lg.dlg@nililand.de>
Message-ID: <20100625111055.GA15792@khaled-laptop>

On Fri, Jun 25, 2010 at 11:03:53AM +0200, Ulrike Fischer wrote:
> Am Fri, 25 Jun 2010 11:16:29 +0300 schrieb Khaled Hosny:
> 
> 
> >>> >> Btw: I had some problems to run the mkluatexfontdb script due to
> >>> >> some dubious (chess) fonts in my system font folder: The script run
> >>> >> a long time and then failed with a "no memory" message. It worked
> >>> >> fine after I removed the fonts. Is there somewhere a config file
> >>> >> "ignore_this_bad_fonts_please.cfg"?
> >>> > 
> >>> > We currently hard code some known problematic fonts, but such a
> >>> > blacklisting file is on the todo list.
> >>> > 
> >>> > What do you thing about a plain text file with file names one per line?
> >>> > May be with an optional prefix, "file:" (the default) and "name:".
> >>> 
> >>> Yes, that would be perfect.  
> >> 
> >> I've a, more or less, working code now, I just need a name for that
> >> blacklist file (and please no weired, hard to remember names).
> > 
> > Given there were not much suggestions (I should not have talked about
> > weired names :), 
> 
> Give me a bit time ;-) I have to do some other work too ...
> 
> 
> > I went with otfl-blacklist.cnf.
> 
> Well I was just about to suggest luaotfload-blacklist ...
> 
> > 
> > There can be as much copies of this file as kpse can find (we look for
> > "tex" format despite of the file extension, so it can exist any where a
> > .tex file can) and all found files will be loaded an read.
> > 
> > I also dropped the prefix idea, though was already implemented, since
> > blacklisting fonts by name is not as reliable (we only have access to
> > postscript names before fully loading the font, but names users expect
> > can differ).
> 
> This means that the file name like arial.ttf should be used, right?
> Can pathes be used so that only versions in some folders are
> excluded? This could be useful e.g. to force lualatex to use a
> specific version of a font.

enteries can either be filenames or full paths, but I didn't actually
test the later.

> > The parser is rather dump, 
> 
> A dump parser is fine. Much easier to manage that one which is to
> clever. 

I'd like to handle trailing spaces and inline comments, things like:

foo.ttf % foo bar

Should be equal too:

foo.ttf

But I see no urgent need.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Fri Jun 25 14:42:32 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Fri, 25 Jun 2010 14:42:32 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <20100625111055.GA15792@khaled-laptop>
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>	<k1xyynrfbqy8.dlg@nililand.de>	<20100624181600.GB2672@khaled-laptop>	<hjbblu3m0tqh$.dlg@nililand.de>	<20100624193541.GA2895@khaled-laptop>	<20100625081629.GA13952@khaled-laptop>	<1h4uwa8uov9lg.dlg@nililand.de>
	<20100625111055.GA15792@khaled-laptop>
Message-ID: <4C24A438.9090007@elzevir.fr>

Le 25/06/2010 13:10, Khaled Hosny a ?crit :
>> A dump parser is fine. Much easier to manage that one which is to
>> clever. 
> 
> I'd like to handle trailing spaces and inline comments, things like:
> 
> foo.ttf % foo bar
> 
I think trailing spaces are important, it's quite easy to miss them with most
editors. And it's not overly complicated to remove.

Manuel.

From khaledhosny at eglug.org  Fri Jun 25 16:50:10 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 25 Jun 2010 17:50:10 +0300
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <4C24A438.9090007@elzevir.fr>
References: <1esqpmd7dy3kr.dlg@nililand.de>
	<20100623154658.GA2735@khaled-laptop>
	<k1xyynrfbqy8.dlg@nililand.de>
	<20100624181600.GB2672@khaled-laptop>
	<hjbblu3m0tqh$.dlg@nililand.de>
	<20100624193541.GA2895@khaled-laptop>
	<20100625081629.GA13952@khaled-laptop>
	<1h4uwa8uov9lg.dlg@nililand.de>
	<20100625111055.GA15792@khaled-laptop>
	<4C24A438.9090007@elzevir.fr>
Message-ID: <20100625145009.GA17662@khaled-laptop>

On Fri, Jun 25, 2010 at 02:42:32PM +0200, Manuel P?gouri?-Gonnard wrote:
> Le 25/06/2010 13:10, Khaled Hosny a ?crit :
> >> A dump parser is fine. Much easier to manage that one which is to
> >> clever. 
> > 
> > I'd like to handle trailing spaces and inline comments, things like:
> > 
> > foo.ttf % foo bar
> > 
> I think trailing spaces are important, it's quite easy to miss them with most
> editors. And it's not overly complicated to remove.

Well, it involves some pattern/lpeg magic, not what I'd consider "not
overly complicated". Any way, a bit of googling gave a function on lua
wiki, then I found that lualibs already have a string.strip() function
exactly for this, so it actually took 3 lines of code to implement (one
for inline comments).

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Fri Jun 25 17:17:47 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Fri, 25 Jun 2010 17:17:47 +0200
Subject: [lltx] location of font cache /fontspec and microtype
In-Reply-To: <20100625145009.GA17662@khaled-laptop>
References: <1esqpmd7dy3kr.dlg@nililand.de>	<20100623154658.GA2735@khaled-laptop>	<k1xyynrfbqy8.dlg@nililand.de>	<20100624181600.GB2672@khaled-laptop>	<hjbblu3m0tqh$.dlg@nililand.de>	<20100624193541.GA2895@khaled-laptop>	<20100625081629.GA13952@khaled-laptop>	<1h4uwa8uov9lg.dlg@nililand.de>	<20100625111055.GA15792@khaled-laptop>	<4C24A438.9090007@elzevir.fr>
	<20100625145009.GA17662@khaled-laptop>
Message-ID: <4C24C89B.9090600@elzevir.fr>

Le 25/06/2010 16:50, Khaled Hosny a ?crit :
>> I think trailing spaces are important, it's quite easy to miss them with most
>> editors. And it's not overly complicated to remove.
> 
> Well, it involves some pattern/lpeg magic, not what I'd consider "not
> overly complicated". Any way, a bit of googling gave a function on lua
> wiki, then I found that lualibs already have a string.strip() function
> exactly for this, so it actually took 3 lines of code to implement (one
> for inline comments).
> 
A regex for removing trailing space is not exactly waht I call overly
complicated either, but anyway, since you found a function that does that...

Thanks for implementing it,
Manuel.

From khaledhosny at eglug.org  Fri Jun 25 17:58:58 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 25 Jun 2010 18:58:58 +0300
Subject: [lltx] TTC fonts on MacOSX
In-Reply-To: <C3F2E9A2-2EDA-42AF-9826-070687F6F7DA@gmail.com>
References: <20100605223950.GA6851@khaled-laptop>
	<C3F2E9A2-2EDA-42AF-9826-070687F6F7DA@gmail.com>
Message-ID: <20100625155858.GA18203@khaled-laptop>

On Sun, Jun 06, 2010 at 11:55:43AM +0930, Will Robertson wrote:
> On 06/06/2010, at 8:09 AM, Khaled Hosny wrote:
> 
> > Thinking again about Taco's remark on TTC fonts, I think the problem is
> > not in TTC fonts generally, but in Apple supplied TTC fonts. So I
> > suggest, instead of blacklisting all TTC fonts unconditionally, we
> > should explicitly blacklist the problematic ones (or even all TTC fonts
> > from Apple).
> 
> That sounds like a very good idea.
> Happy to help with the testing, of course...

In the comming release, to be uploaded shortly, I re-enable ttc fonts on
macosx so that people can find the broken ones so we explicitly
blacklist them.

Any one on macosx is encouraged to run mkluatexfontdb with -v option and
find what file luatex is stuck with, files can then be added to
otfl-blacklist.cnf file one by one until the script runs smoothly, then
please send me the filename so we ship it with the package.

If we got nothing before texlive freeze, I'll have to globally disable
ttc fonts on macosx again.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From wspr81 at gmail.com  Fri Jun 25 18:10:58 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Fri, 25 Jun 2010 09:10:58 -0700
Subject: [lltx] TTC fonts on MacOSX
In-Reply-To: <20100625155858.GA18203@khaled-laptop>
References: <20100605223950.GA6851@khaled-laptop>
	<C3F2E9A2-2EDA-42AF-9826-070687F6F7DA@gmail.com>
	<20100625155858.GA18203@khaled-laptop>
Message-ID: <5B285297-5883-4D95-A3D0-0ECCFFC01C79@gmail.com>

On 25/06/2010, at 8:58 AM, Khaled Hosny wrote:

> In the comming release, to be uploaded shortly, I re-enable ttc fonts on
> macosx so that people can find the broken ones so we explicitly
> blacklist them.

Taco said (I think) that all Mac OS X ttc fonts were broken, so until we get time to check each one individually here's a list:

$ locate */Fonts/*.ttc
/Library/Fonts/AmericanTypewriter.ttc
/Library/Fonts/Baskerville.ttc
/Library/Fonts/Chalkboard.ttc
/Library/Fonts/Cochin.ttc
/Library/Fonts/Copperplate.ttc
/Library/Fonts/Didot.ttc
/Library/Fonts/Futura.ttc
/Library/Fonts/GillSans.ttc
/Library/Fonts/Hoefler Text.ttc
/Library/Fonts/MarkerFelt.ttc
/Library/Fonts/Optima.ttc
/Library/Fonts/Papyrus.ttc
/Library/Fonts/STHeiti Medium.ttc
/System/Library/Fonts/AquaKana.ttc
/System/Library/Fonts/HelveticaNeue.ttc
/System/Library/Fonts/LucidaGrande.ttc
/System/Library/Fonts/Menlo.ttc
/System/Library/Fonts/STHeiti Light.ttc

-- Will



From khaledhosny at eglug.org  Fri Jun 25 19:08:29 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 25 Jun 2010 20:08:29 +0300
Subject: [lltx] TTC fonts on MacOSX
In-Reply-To: <5B285297-5883-4D95-A3D0-0ECCFFC01C79@gmail.com>
References: <20100605223950.GA6851@khaled-laptop>
	<C3F2E9A2-2EDA-42AF-9826-070687F6F7DA@gmail.com>
	<20100625155858.GA18203@khaled-laptop>
	<5B285297-5883-4D95-A3D0-0ECCFFC01C79@gmail.com>
Message-ID: <20100625170829.GA18667@khaled-laptop>

On Fri, Jun 25, 2010 at 09:10:58AM -0700, Will Robertson wrote:
> On 25/06/2010, at 8:58 AM, Khaled Hosny wrote:
> 
> > In the comming release, to be uploaded shortly, I re-enable ttc fonts on
> > macosx so that people can find the broken ones so we explicitly
> > blacklist them.
> 
> Taco said (I think) that all Mac OS X ttc fonts were broken, so until we get time to check each one individually here's a list:
> 
> $ locate */Fonts/*.ttc
> /Library/Fonts/AmericanTypewriter.ttc
> /Library/Fonts/Baskerville.ttc
> /Library/Fonts/Chalkboard.ttc
> /Library/Fonts/Cochin.ttc
> /Library/Fonts/Copperplate.ttc
> /Library/Fonts/Didot.ttc
> /Library/Fonts/Futura.ttc
> /Library/Fonts/GillSans.ttc
> /Library/Fonts/Hoefler Text.ttc
> /Library/Fonts/MarkerFelt.ttc
> /Library/Fonts/Optima.ttc
> /Library/Fonts/Papyrus.ttc
> /Library/Fonts/STHeiti Medium.ttc
> /System/Library/Fonts/AquaKana.ttc
> /System/Library/Fonts/HelveticaNeue.ttc
> /System/Library/Fonts/LucidaGrande.ttc
> /System/Library/Fonts/Menlo.ttc
> /System/Library/Fonts/STHeiti Light.ttc

OK, do you think we should use base names or full paths?

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From wspr81 at gmail.com  Sat Jun 26 10:35:46 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sat, 26 Jun 2010 01:35:46 -0700
Subject: [lltx] TTC fonts on MacOSX
In-Reply-To: <20100625170829.GA18667@khaled-laptop>
References: <20100605223950.GA6851@khaled-laptop>
	<C3F2E9A2-2EDA-42AF-9826-070687F6F7DA@gmail.com>
	<20100625155858.GA18203@khaled-laptop>
	<5B285297-5883-4D95-A3D0-0ECCFFC01C79@gmail.com>
	<20100625170829.GA18667@khaled-laptop>
Message-ID: <7A1AF921-8D92-4FEF-AE13-F086BD2691EB@gmail.com>

(Sent from my iPad.)

On 25/06/2010, at 10:08 AM, Khaled Hosny <khaledhosny at eglug.org> wrote:

> On Fri, Jun 25, 2010 at 09:10:58AM -0700, Will Robertson wrote:
>> On 25/06/2010, at 8:58 AM, Khaled Hosny wrote:
>> 
>>> In the comming release, to be uploaded shortly, I re-enable ttc fonts on
>>> macosx so that people can find the broken ones so we explicitly
>>> blacklist them.
>> 
>> Taco said (I think) that all Mac OS X ttc fonts were broken, so until we get time to check each one individually here's a list:
>> 
>> $ locate */Fonts/*.ttc
>> /Library/Fonts/AmericanTypewriter.ttc
>> /Library/Fonts/Baskerville.ttc
>> /Library/Fonts/Chalkboard.ttc
>> /Library/Fonts/Cochin.ttc
>> /Library/Fonts/Copperplate.ttc
>> /Library/Fonts/Didot.ttc
>> /Library/Fonts/Futura.ttc
>> /Library/Fonts/GillSans.ttc
>> /Library/Fonts/Hoefler Text.ttc
>> /Library/Fonts/MarkerFelt.ttc
>> /Library/Fonts/Optima.ttc
>> /Library/Fonts/Papyrus.ttc
>> /Library/Fonts/STHeiti Medium.ttc
>> /System/Library/Fonts/AquaKana.ttc
>> /System/Library/Fonts/HelveticaNeue.ttc
>> /System/Library/Fonts/LucidaGrande.ttc
>> /System/Library/Fonts/Menlo.ttc
>> /System/Library/Fonts/STHeiti Light.ttc
> 
> OK, do you think we should use base names or full paths?

Full paths, just in case it's something that apple does to these fonts that causes them to be broken. 

W
> 


From news3 at nililand.de  Sun Jun 27 16:08:31 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Sun, 27 Jun 2010 16:08:31 +0200
Subject: [lltx] euxunicode
Message-ID: <1w5fa1bwh1ut0.dlg@nililand.de>

Hello,

after an update of the euenc-package I saw that it now includes a
version of xunicode euxunicode loaded in a lualatex run by
eu2enc.def.

1. I don't quite understand the need. I have been using xunicode
quite happily with lualatex. You only need to define \XeTeXpicfile
e.g. with 
\ifluatex
 \def\XeTeXpicfile{}%f?r xunicode
\fi
to cheat the ifxetex-test of xunicode.

So why maintaining two quite identical packages?

2. euxunicode contains a \@TestForWongPackage executed at
\begin{document} which also tests for xunicode. But in this case the
command is quite useless, you would get a lot of error messages
before (e.g. from all the \newcommand in xunicode). Why doesn't
euxunicode disable the loading of xunicode completly with
\expandafter\def\csname ver at xunicode.sty\endcsname?

3. euxunicode has remove "some of the more esoteric control
sequences". This cleaning-up removed also the guillemets used by
french and german and so breaks some quoting styles of the csquotes
package:

\documentclass[fontsize=12pt]{scrartcl}

\usepackage[ngerman]{babel}
\usepackage[autostyle,german=guillemets]{csquotes}
\MakeAutoQuote ??

\usepackage{luaotfload}
\usepackage{fontspec}
%\DeclareUTFcharacter[\UTFencname]{x00BB}{\guillemotright}
%\DeclareUTFcharacter[\UTFencname]{x00AB}{\guillemotleft}

\begin{document}
?abc?
\end{document}


-- 
Ulrike Fischer 


From elie.roux at telecom-bretagne.eu  Sun Jun 27 17:06:05 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Sun, 27 Jun 2010 17:06:05 +0200
Subject: [lltx] euxunicode
In-Reply-To: <1w5fa1bwh1ut0.dlg@nililand.de>
References: <1w5fa1bwh1ut0.dlg@nililand.de>
Message-ID: <4C2768DD.7090704@telecom-bretagne.eu>

Ulrike Fischer a ?crit :
> Hello,
>
> after an update of the euenc-package I saw that it now includes a
> version of xunicode euxunicode loaded in a lualatex run by
> eu2enc.def.
>
> 1. I don't quite understand the need. I have been using xunicode
> quite happily with lualatex. You only need to define \XeTeXpicfile
> e.g. with 
> \ifluatex
>  \def\XeTeXpicfile{}%f?r xunicode
> \fi
> to cheat the ifxetex-test of xunicode.
>   

This cheating seems terribly wrong... but euxunicode is also wrong 
anyway, its reason of existance if the fact that Ross Moore refuses to 
remove the test for XeTeX... I admit this is a totally ridiculous 
situation, but I'm kind of used to it in the TeX world ;)

> 2. euxunicode contains a \@TestForWongPackage executed at
> \begin{document} which also tests for xunicode. But in this case the
> command is quite useless, you would get a lot of error messages
> before (e.g. from all the \newcommand in xunicode). Why doesn't
> euxunicode disable the loading of xunicode completly with
> \expandafter\def\csname ver at xunicode.sty\endcsname?
>   

Good idea!

> 3. euxunicode has remove "some of the more esoteric control
> sequences". This cleaning-up removed also the guillemets used by
> french and german and so breaks some quoting styles of the csquotes
> package:
>
> \documentclass[fontsize=12pt]{scrartcl}
>
> \usepackage[ngerman]{babel}
> \usepackage[autostyle,german=guillemets]{csquotes}
> \MakeAutoQuote ??
>
> \usepackage{luaotfload}
> \usepackage{fontspec}
> %\DeclareUTFcharacter[\UTFencname]{x00BB}{\guillemotright}
> %\DeclareUTFcharacter[\UTFencname]{x00AB}{\guillemotleft}
>
> \begin{document}
> ?abc?
> \end{document}
>   

Interesting, I'll try to update the package.

Do you (all) think a more appropriate solution would be to make a 
euxunicode package containing

\ifluatex
 \def\XeTeXpicfile{}
\fi
\RequirePackage{xunicode}

?

Thank you,
-- 
Elie

From khaledhosny at eglug.org  Sun Jun 27 17:14:31 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 27 Jun 2010 18:14:31 +0300
Subject: [lltx] euxunicode
In-Reply-To: <4C2768DD.7090704@telecom-bretagne.eu>
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
Message-ID: <20100627151431.GA10770@khaled-laptop>

On Sun, Jun 27, 2010 at 05:06:05PM +0200, Elie Roux wrote:
> Do you (all) think a more appropriate solution would be to make a
> euxunicode package containing
> 
> \ifluatex
> \def\XeTeXpicfile{}
> \fi
> \RequirePackage{xunicode}
> 
> ?

This don't look like a good idea to me, what if there is some package or
user document that checks for \XeTeXpicfile to detect XeTeX? I know
every one should be using ifxetex, but xunicode itself shows this isn't
always true in practice.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From news3 at nililand.de  Sun Jun 27 17:37:47 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Sun, 27 Jun 2010 17:37:47 +0200
Subject: [lltx] euxunicode
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
Message-ID: <u8magunsvypz$.dlg@nililand.de>

Am Sun, 27 Jun 2010 17:06:05 +0200 schrieb Elie Roux:

>> after an update of the euenc-package I saw that it now includes a
>> version of xunicode euxunicode loaded in a lualatex run by
>> eu2enc.def.
>>
>> 1. I don't quite understand the need. I have been using xunicode
>> quite happily with lualatex. You only need to define \XeTeXpicfile
>> e.g. with 
>> \ifluatex
>>  \def\XeTeXpicfile{}%f?r xunicode
>> \fi
>> to cheat the ifxetex-test of xunicode.
>>   
> 
> This cheating seems terribly wrong... 

Well I have seen worse ;-)

> but euxunicode is also wrong 
> anyway, its reason of existance if the fact that Ross Moore refuses to 
> remove the test for XeTeX... I admit this is a totally ridiculous 
> situation, but I'm kind of used to it in the TeX world ;)

As far as I understood him (I had written him about it too) he
simply doesn't want to make the impression that xunicode is lualatex
compatible when he actually doesn't know it. 

> 
>> 2. euxunicode contains a \@TestForWongPackage executed at
>> \begin{document} which also tests for xunicode. But in this case the
>> command is quite useless, you would get a lot of error messages
>> before (e.g. from all the \newcommand in xunicode). Why doesn't
>> euxunicode disable the loading of xunicode completly with
>> \expandafter\def\csname ver at xunicode.sty\endcsname?

Looks as if gmane doesn't like the word "xunicode.sty". Well I hope
you understood. 


> Do you (all) think a more appropriate solution would be to make a 
> euxunicode package containing
> 
> \ifluatex
>  \def\XeTeXpicfile{}
> \fi
> \RequirePackage{xunicode}

I would say it would be better. There would be only one list of all
the definitions. And it would mean that xunicode is tested by the
lualatex users - and so Ross could get some feed back about possible
problems. 

Also it should be easy for xelatex users to try out lualatex. A lot
of this users load xunicode. One should avoid to force them to
remove a package or to add a lot of \ifxetex-switches -- not only to
make life easier for the users but also for people like me who tries
to explain them how to switch from pdftex to a unicode engine like
xetex or luatex.



-- 
Ulrike Fischer 


From elie.roux at telecom-bretagne.eu  Sun Jun 27 17:46:04 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Sun, 27 Jun 2010 17:46:04 +0200
Subject: [lltx] euxunicode
In-Reply-To: <u8magunsvypz$.dlg@nililand.de>
References: <1w5fa1bwh1ut0.dlg@nililand.de>	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
Message-ID: <4C27723C.80101@telecom-bretagne.eu>

Ulrike Fischer a ?crit :
> As far as I understood him (I had written him about it too) he
> simply doesn't want to make the impression that xunicode is lualatex
> compatible when he actually doesn't know it. 
>   

Precisely.

> I would say it would be better. There would be only one list of all
> the definitions. And it would mean that xunicode is tested by the
> lualatex users - and so Ross could get some feed back about possible
> problems. 
>
> Also it should be easy for xelatex users to try out lualatex. A lot
> of this users load xunicode. One should avoid to force them to
> remove a package or to add a lot of \ifxetex-switches -- not only to
> make life easier for the users but also for people like me who tries
> to explain them how to switch from pdftex to a unicode engine like
> xetex or luatex.
>
>   

I totally agree with you that there should be a way to load xunicode 
with LuaTeX, but, sadly, there is nothing I can do about it... The only 
thing we could do is to create a euxunicode package that loads it, so 
that it would be common to XeTeX and LuaTeX. Do you (all) think it would 
be a good idea to separate euxunicode from euenc? I can't remember the 
reasons why we melt it together at the first place...

Thank you,
-- 
Elie


From news3 at nililand.de  Sun Jun 27 17:48:41 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Sun, 27 Jun 2010 17:48:41 +0200
Subject: [lltx] euxunicode
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
	<20100627151431.GA10770@khaled-laptop>
Message-ID: <mz3yoaty8fdk.dlg@nililand.de>

Am Sun, 27 Jun 2010 18:14:31 +0300 schrieb Khaled Hosny:

>> \ifluatex
>> \def\XeTeXpicfile{}
>> \fi
>> \RequirePackage{xunicode}
>> 
>> ?
 
> This don't look like a good idea to me, what if there is some package or
> user document that checks for \XeTeXpicfile to detect XeTeX? 

You can alway reset \XeTeXpicfile to its orginal (perhaps undefined)
value after xunicode has been loaded


> I know every one should be using ifxetex, but xunicode itself
> shows this isn't always true in practice.

Well if xunicode would use ifxetex it would be more problematic to
cheat the test and one would have to be much more careful as this
could really affect a lot of other packages ;-)

-- 
Ulrike Fischer 


From news3 at nililand.de  Sun Jun 27 18:01:39 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Sun, 27 Jun 2010 18:01:39 +0200
Subject: [lltx] euxunicode
References: <1w5fa1bwh1ut0.dlg@nililand.de>	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu>
Message-ID: <1p6fh5pk281el.dlg@nililand.de>

Am Sun, 27 Jun 2010 17:46:04 +0200 schrieb Elie Roux:

> Do you (all) think it would be a good idea to separate euxunicode
> from euenc? I can't remember the reasons why we melt it together
> at the first place...

The .def-files of the euenc-package are the logical place for the
various \DeclareUTFcharacter-settings (T1enc.def contains the
similar declarations for T1). 

>From a logical point the various definitions
(\newcommand{\DeclareUTFcomposite}...) should be in fontenc. 

So a really sane setup would be in my opinion a xfontenc.sty which
contains the only fontenc + the xunicode definitions, various files
with sensible subsets of the declarations from xunicode which can be
loaded by the euXenc.def files or directly.

But I don't think that such a sane setup is of main priority.
Adapting polyglossia e.g. is more important. 
 
-- 
Ulrike Fischer 


From wspr81 at gmail.com  Sun Jun 27 21:22:24 2010
From: wspr81 at gmail.com (Will Robertson)
Date: Sun, 27 Jun 2010 12:22:24 -0700
Subject: [lltx] Fwd: [tex-live] PTeX engine
References: <9C727577-AEAB-4881-9690-EC81C28653CD@freenet.de>
Message-ID: <0300C4C2-F550-4F60-A111-6D6846834B3C@gmail.com>

Hi,

See below for a possible problem font to blacklist.

Begin forwarded message:

> From: Peter Dyballa <Peter_Dyballa at freenet.de>
> Date: 27 June 2010 12:05:45 PM PDT
> To: Will Robertson <wspr81 at gmail.com>
> Cc: tex-live at tug.org
> Subject: Re: [tex-live] PTeX engine
> 
> 
> Am 27.06.2010 um 20:48 schrieb Will Robertson:
> 
>> Please tell us which fonts crash (mkluatexfontdb -vvv) so we can fix/blacklist them!
> 
> mkluatexfontdb -vvv
> ...cal/texlive/2010/bin/universal-darwin/mkluatexfontdb:128: attempt to call upvalue 'log' (a nil value)

Not sure about this; I'm about to update to the most recent TL version to see if I can reproduce it.

> As mentioned three weeks ago there is one font I could determine which is provoking crashes every time: URW:GaramondNo8-Ita:2001, a TrueType font from the urwfonts-1.41 archive (having it since many years). You can find it here: http://www.ctan.org/tex-archive/support/ghostscript/AFPL/GhostPCL/.

I'm at the conference at the moment so I can't check myself; can anyone reproduce this problem with this font?

-- Will



From khaledhosny at eglug.org  Sun Jun 27 21:32:44 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 27 Jun 2010 22:32:44 +0300
Subject: [lltx] Fwd: [tex-live] PTeX engine
In-Reply-To: <0300C4C2-F550-4F60-A111-6D6846834B3C@gmail.com>
References: <9C727577-AEAB-4881-9690-EC81C28653CD@freenet.de>
	<0300C4C2-F550-4F60-A111-6D6846834B3C@gmail.com>
Message-ID: <20100627193244.GA12389@khaled-laptop>

On Sun, Jun 27, 2010 at 12:22:24PM -0700, Will Robertson wrote:
> Hi,
> 
> See below for a possible problem font to blacklist.
> 
> Begin forwarded message:
> 
> > From: Peter Dyballa <Peter_Dyballa at freenet.de>
> > Date: 27 June 2010 12:05:45 PM PDT
> > To: Will Robertson <wspr81 at gmail.com>
> > Cc: tex-live at tug.org
> > Subject: Re: [tex-live] PTeX engine
> > 
> > 
> > Am 27.06.2010 um 20:48 schrieb Will Robertson:
> > 
> >> Please tell us which fonts crash (mkluatexfontdb -vvv) so we can fix/blacklist them!
> > 
> > mkluatexfontdb -vvv
> > ...cal/texlive/2010/bin/universal-darwin/mkluatexfontdb:128: attempt to call upvalue 'log' (a nil value)
> 
> Not sure about this; I'm about to update to the most recent TL version to see if I can reproduce it.

As I said in the other thread, already fixed two days ago, but it didn't
get into texlive yet.

> > As mentioned three weeks ago there is one font I could determine which is provoking crashes every time: URW:GaramondNo8-Ita:2001, a TrueType font from the urwfonts-1.41 archive (having it since many years). You can find it here: http://www.ctan.org/tex-archive/support/ghostscript/AFPL/GhostPCL/.
> 
> I'm at the conference at the moment so I can't check myself; can anyone reproduce this problem with this font?

I get a segfault here too. I'll did a bit more testing then report it to
Taco. Either it get fixed, or we blacklist it for the time being.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Mon Jun 28 12:47:21 2010
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Mon, 28 Jun 2010 12:47:21 +0200
Subject: [lltx] euxunicode
In-Reply-To: <4C27723C.80101@telecom-bretagne.eu>
References: <1w5fa1bwh1ut0.dlg@nililand.de>	<4C2768DD.7090704@telecom-bretagne.eu>	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu>
Message-ID: <4C287DB9.7040602@elzevir.fr>

Le 27/06/2010 17:46, Elie Roux a ?crit :
> Ulrike Fischer a ?crit :
>> As far as I understood him (I had written him about it too) he
>> simply doesn't want to make the impression that xunicode is lualatex
>> compatible when he actually doesn't know it. 
>>   
> 
> Precisely.
> 
That's also what I understood. I don't find this position ridiculous as you do,
?lie, but of course the consequences are a bit annoying.

>> I would say it would be better. There would be only one list of all
>> the definitions. And it would mean that xunicode is tested by the
>> lualatex users - and so Ross could get some feed back about possible
>> problems. 
>>
Yeah, I think this is an important point (even more important than avoiding
current duplication of the definitions), this it makes it possible to hope
xunicode will be directly usable with LuaTeX in the future.

So, I'm all for making the (hopefully temporary) euxunicode.sty simply load
xunicode by cheating on the xetex test (and restoring the meaning of
XeTeXpicfile afterwards!).

Manuel.

From khaledhosny at eglug.org  Mon Jun 28 13:14:42 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 28 Jun 2010 14:14:42 +0300
Subject: [lltx] euxunicode
In-Reply-To: <4C287DB9.7040602@elzevir.fr>
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu> <4C287DB9.7040602@elzevir.fr>
Message-ID: <20100628111442.GA3304@khaled-laptop>

On Mon, Jun 28, 2010 at 12:47:21PM +0200, Manuel P?gouri?-Gonnard wrote:
> Le 27/06/2010 17:46, Elie Roux a ?crit :
> > Ulrike Fischer a ?crit :
> >> As far as I understood him (I had written him about it too) he
> >> simply doesn't want to make the impression that xunicode is lualatex
> >> compatible when he actually doesn't know it. 
> >>   
> > 
> > Precisely.
> > 
> That's also what I understood. I don't find this position ridiculous as you do,
> ?lie, but of course the consequences are a bit annoying.

I don't find it ridiculous, but rather useless, as this discussion shows
that luatex users are likely to get this worked around anyway, and
nobody will ever know that Ross doesn't deem xunicode luatex compatible,
for whatever this is supposed to mean.

In free, openly developed software, user community have to take part of
development process, if only by testing and reporting bugs, you don't
wait for 10 years to test every aspect of your software yourself before
declaring it stable.

So I don't see how fixing the check in xunicode itself is different than
cheating about it in another package.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From khaledhosny at eglug.org  Mon Jun 28 13:17:35 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 28 Jun 2010 14:17:35 +0300
Subject: [lltx] euxunicode
In-Reply-To: <4C27723C.80101@telecom-bretagne.eu>
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu>
Message-ID: <20100628111735.GB3304@khaled-laptop>

On Sun, Jun 27, 2010 at 05:46:04PM +0200, Elie Roux wrote:
>                                                     Do you (all)
> think it would be a good idea to separate euxunicode from euenc? I
> can't remember the reasons why we melt it together at the first
> place...

The idea was is that xunicode belongs to euenc and it was on Will's TODO
list to merge them together, but to avoid breaking compatibility for
xetex users, this has been done only for luatex.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From news3 at nililand.de  Mon Jun 28 16:50:49 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Mon, 28 Jun 2010 16:50:49 +0200
Subject: [lltx] euxunicode
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu> <4C287DB9.7040602@elzevir.fr>
	<20100628111442.GA3304@khaled-laptop>
Message-ID: <1el063r0ftyog.dlg@nililand.de>

Am Mon, 28 Jun 2010 14:14:42 +0300 schrieb Khaled Hosny:

> So I don't see how fixing the check in xunicode itself is different than
> cheating about it in another package.

The difference is that you can't fix the check in xunicode as it
isn't your package but you can write such a "cheating" package ;-)

Changing xunicode isn't an option currently. The only open options
are copying all the code of xunicode to another package and adapting
it (like euxunicode does it currently) or loading xunicode and using
its code by cheating a bit. 

I prefer the second because (beside other considerations) I think it
makes maintaining easier. You don't have to correct wrong
declarations in two packages.  (luaotfload reuses a lot of context
files too, and for the same reason). Also using xunicode keeps the
door open in case Ross changes his mind. 

-- 
Ulrike Fischer 


From khaledhosny at eglug.org  Mon Jun 28 16:55:11 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 28 Jun 2010 17:55:11 +0300
Subject: [lltx] euxunicode
In-Reply-To: <1el063r0ftyog.dlg@nililand.de>
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu> <4C287DB9.7040602@elzevir.fr>
	<20100628111442.GA3304@khaled-laptop>
	<1el063r0ftyog.dlg@nililand.de>
Message-ID: <20100628145511.GA7794@khaled-laptop>

On Mon, Jun 28, 2010 at 04:50:49PM +0200, Ulrike Fischer wrote:
> Am Mon, 28 Jun 2010 14:14:42 +0300 schrieb Khaled Hosny:
> 
> > So I don't see how fixing the check in xunicode itself is different than
> > cheating about it in another package.
> 
> The difference is that you can't fix the check in xunicode as it
> isn't your package but you can write such a "cheating" package ;-)

I meant from Ross's POV.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From elie.roux at telecom-bretagne.eu  Mon Jun 28 17:14:04 2010
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Mon, 28 Jun 2010 17:14:04 +0200
Subject: [lltx] euxunicode
In-Reply-To: <4C287DB9.7040602@elzevir.fr>
References: <1w5fa1bwh1ut0.dlg@nililand.de>	<4C2768DD.7090704@telecom-bretagne.eu>	<u8magunsvypz$.dlg@nililand.de>	<4C27723C.80101@telecom-bretagne.eu>
	<4C287DB9.7040602@elzevir.fr>
Message-ID: <4C28BC3C.2030400@telecom-bretagne.eu>

Manuel P?gouri?-Gonnard a ?crit :
> So, I'm all for making the (hopefully temporary) euxunicode.sty simply load
> xunicode by cheating on the xetex test (and restoring the meaning of
> XeTeXpicfile afterwards!).
>   

Hello,

I have access to the Internet only once every two days (sometimes 
everyday), but it's very annoying to work in these conditions, so if 
someone else could do the necessary operations, it would be great!

Thank you,
-- 
Elie

From news3 at nililand.de  Mon Jun 28 17:21:06 2010
From: news3 at nililand.de (Ulrike Fischer)
Date: Mon, 28 Jun 2010 17:21:06 +0200
Subject: [lltx] euxunicode
References: <1w5fa1bwh1ut0.dlg@nililand.de>
	<4C2768DD.7090704@telecom-bretagne.eu>
	<u8magunsvypz$.dlg@nililand.de>
	<4C27723C.80101@telecom-bretagne.eu> <4C287DB9.7040602@elzevir.fr>
	<20100628111442.GA3304@khaled-laptop>
	<1el063r0ftyog.dlg@nililand.de>
	<20100628145511.GA7794@khaled-laptop>
Message-ID: <iwqjcvjbjat7.dlg@nililand.de>

Am Mon, 28 Jun 2010 17:55:11 +0300 schrieb Khaled Hosny:

>>> So I don't see how fixing the check in xunicode itself is different than
>>> cheating about it in another package.
>> 
>> The difference is that you can't fix the check in xunicode as it
>> isn't your package but you can write such a "cheating" package ;-)
> 
> I meant from Ross's POV.


Well from Ross point of view the difference lies at first in the
responsability in case of problems: If he changes xunicode he would
have to correct possible incompabilities with lualatex. If you write
a "cheating package" it's up to you to handle the problems. At
second he would have to consider compability with lualatex in future
versions of xunicode. Opening xunicode for lualatex will (perhaps)
close the door to xelatex specific code which uses xetex primitives.  



-- 
Ulrike Fischer 


From khaledhosny at eglug.org  Mon Jun 28 19:35:55 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 28 Jun 2010 20:35:55 +0300
Subject: [lltx] lualibs deprecated function
In-Reply-To: <20100622122835.GA5316@khaled-laptop>
References: <20100622122835.GA5316@khaled-laptop>
Message-ID: <20100628173555.GA9749@khaled-laptop>

On Tue, Jun 22, 2010 at 03:28:35PM +0300, Khaled Hosny wrote:
> As lualibs is mainly a repackaged ConTeXt libraries, the more close to
> ConTeXt it is the more simpler the maintenance.
> 
> Currently, lualibs has some aliases to ConTeXt functions, as well as
> implementations of deprecated/removed ones.
> 
> I checked other lua packages and found non of these functions is used,
> expect of two fpath functions is luatextra that I just fixed, so I
> decided to remove them completely.

The new release has been uploaded to CTAN, it might be wise to upload
luatextra too (though the code that was fixed seems not to be used at
all).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From mpg at elzevir.fr  Wed Jun 30 14:43:25 2010
From: mpg at elzevir.fr (=?UTF-8?B?TWFudWVsIFDDqWdvdXJpw6ktR29ubmFyZA==?=)
Date: Wed, 30 Jun 2010 14:43:25 +0200
Subject: [lltx] lualibs deprecated function
In-Reply-To: <20100628173555.GA9749@khaled-laptop>
References: <20100622122835.GA5316@khaled-laptop>
	<20100628173555.GA9749@khaled-laptop>
Message-ID: <4C2B3BED.4060003@elzevir.fr>

Le 28/06/2010 19:35, Khaled Hosny a ?crit :
> The new release has been uploaded to CTAN, it might be wise to upload
> luatextra too (though the code that was fixed seems not to be used at
> all).
> 
I just uploaded it, and I'll push both of them (and otfl) to TL when luatextra
will be arrived to CTAN.

Thanks for warning us,
Manuel.

