From nomosnomos at gmail.com  Wed May  1 06:39:53 2013
From: nomosnomos at gmail.com (Dohyun Kim)
Date: Wed, 1 May 2013 13:39:53 +0900
Subject: [lltx] luaotfload refuses to load bold font of some font family
Message-ID: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>

Hi,

luaotfload package in current TL pretest has introduced a bug.  Bold
font of some, but not all, font family is not loaded by "/B" notation.
 A patch to otfl-font-nms.lua would be needed.  I am attaching a diff
file.

Regards,
--
Dohyun Kim
Seoul, Republic of Korea
-------------- next part --------------
A non-text attachment was scrubbed...
Name: patch_otfl-font-nms.diff
Type: application/octet-stream
Size: 683 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130501/e5e8d050/attachment.obj>

From Philipp.Gesang at alumni.uni-heidelberg.de  Wed May  1 09:59:39 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Wed, 1 May 2013 09:59:39 +0200
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
Message-ID: <20130501075939.GA30722@phlegethon>

Hi!

The current behavior was introduced to catch outliers with
?subfamilies?.

???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???

> luaotfload package in current TL pretest has introduced a bug.  Bold
> font of some, but not all, font family is not loaded by "/B" notation.
>  A patch to otfl-font-nms.lua would be needed.  I am attaching a diff
> file.

1) MWE, please.

2) Can you please attach the info from either

        otfinfo -i <fontname>

   or

        mtxrun --script fonts --list --info --name <fontname>

   for the font this happens with?

Thanks,
Philipp




-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130501/88d0f5e3/attachment.bin>

From nomosnomos at gmail.com  Wed May  1 12:09:27 2013
From: nomosnomos at gmail.com (Dohyun Kim)
Date: Wed, 1 May 2013 19:09:27 +0900
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <20130501075939.GA30722@phlegethon>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
Message-ID: <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>

2013/5/1 Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de>:
> Hi!
>
> The current behavior was introduced to catch outliers with
> ?subfamilies?.
>
> ???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???
>
>> luaotfload package in current TL pretest has introduced a bug.  Bold
>> font of some, but not all, font family is not loaded by "/B" notation.
>>  A patch to otfl-font-nms.lua would be needed.  I am attaching a diff
>> file.
>
> 1) MWE, please.
>

Sorry for missing MWE.  Now here it is.

\input luaotfload.sty
\font\freeserif="freeserif" at 10pt
\freeserif
Regular.
\font\freeserifbold="freeserif/B" at 10pt
\freeserifbold
Bold.
\bye

> 2) Can you please attach the info from either
>
>         otfinfo -i <fontname>
>

$ otfinfo -i /usr/local/texlive/2013/texmf-dist/fonts/opentype/public/gnu-freefont/FreeSerifBold.otf
Family:              FreeSerif
Subfamily:           Bold
Full name:           FreeSerif Bold
PostScript name:     FreeSerifBold
Version:             Version 0412.2268

Best,


From Philipp.Gesang at alumni.uni-heidelberg.de  Wed May  1 12:38:49 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Wed, 1 May 2013 12:38:49 +0200
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
 <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
Message-ID: <20130501103849.GA31270@phlegethon>

???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???

> 2013/5/1 Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de>:
> > Hi!
> >
> > The current behavior was introduced to catch outliers with
> > ?subfamilies?.
> >
> > ???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???
> >
> >> luaotfload package in current TL pretest has introduced a bug.  Bold
> >> font of some, but not all, font family is not loaded by "/B" notation.
> >>  A patch to otfl-font-nms.lua would be needed.  I am attaching a diff
> >> file.
> >
> > 1) MWE, please.
> >
> 
> Sorry for missing MWE.  Now here it is.
> 
> \input luaotfload.sty
> \font\freeserif="freeserif" at 10pt
> \freeserif
> Regular.
> \font\freeserifbold="freeserif/B" at 10pt
> \freeserifbold
> Bold.
> \bye

Thanks, can you test with this version:

  https://raw.github.com/lualatex/luaotfload/texlive2011/otfl-font-nms.lua

Best regards,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130501/1fba236a/attachment.bin>

From nomosnomos at gmail.com  Wed May  1 18:15:49 2013
From: nomosnomos at gmail.com (Dohyun Kim)
Date: Thu, 2 May 2013 01:15:49 +0900
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <20130501103849.GA31270@phlegethon>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
 <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
 <20130501103849.GA31270@phlegethon>
Message-ID: <CAFzmAm2aefER0srT2RL45b=7FxdiA9HOJa7DsmNXsv6r5hNimw@mail.gmail.com>

2013/5/1 Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de>:
> ???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???
>
>> 2013/5/1 Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de>:
>> > Hi!
>> >
>> > The current behavior was introduced to catch outliers with
>> > ?subfamilies?.
>> >
>> > ???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???
>> >
>> >> luaotfload package in current TL pretest has introduced a bug.  Bold
>> >> font of some, but not all, font family is not loaded by "/B" notation.
>> >>  A patch to otfl-font-nms.lua would be needed.  I am attaching a diff
>> >> file.
>> >
>> > 1) MWE, please.
>> >
>>
>> Sorry for missing MWE.  Now here it is.
>>
>> \input luaotfload.sty
>> \font\freeserif="freeserif" at 10pt
>> \freeserif
>> Regular.
>> \font\freeserifbold="freeserif/B" at 10pt
>> \freeserifbold
>> Bold.
>> \bye
>
> Thanks, can you test with this version:
>
>   https://raw.github.com/lualatex/luaotfload/texlive2011/otfl-font-nms.lua
>

It works.
Thanks a lot.

--
Dohyun Kim
Seoul, Republic of Korea


From ma.anselmi at gmail.com  Sat May  4 04:25:05 2013
From: ma.anselmi at gmail.com (Michael Anselmi)
Date: Fri, 3 May 2013 22:25:05 -0400
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <20130501103849.GA31270@phlegethon>
References: <20130501103849.GA31270@phlegethon>
Message-ID: <51847181.1020902@gmail.com>

Hello lualatex-dev folks,

I wanted to chime in and let you know that I've encountered a similar
issue.  Please see attached for a minimal LaTeX example, along with
otfinfo and several log, PDF outputs for comparison.  (I'm not a TeX
user, at least not directly.)

Here is the example inline for your convenience:

---------------------------------------------
\documentclass{scrartcl}

\usepackage[no-math]{fontspec}
\setmainfont{Linux Libertine O}
\setsansfont{Linux Biolinum O}

\title{Title}

\begin{document}
\maketitle

This is upright text.
\textbf{This is boldface text.}
\textit{This is italic text.}
\textbf{\emph{This is boldface italic text.}}
\end{document}
---------------------------------------------

Notice how the PDF generated by XeLaTeX appears correctly: the title is
bold upright, and the body text is bold, italic, and bold italic where
it should be.  However, in the PDF generated by LuaLaTeX there is a bold
italic title, and all of the body text is regular upright.

2013/5/1 Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de>:
> Thanks, can you test with this version:
>
>   https://raw.github.com/lualatex/luaotfload/texlive2011/otfl-
>   font-nms.lua
>
> Best regards,
> Philipp

Applying this stopgap fix helps but not completely.  Observe that the
title is still bold italic.  (Could this be an unrelated issue?)

Regards,
Michael
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bug.tar.bz2
Type: application/x-bzip
Size: 57367 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130503/48808bea/attachment-0001.bin>

From top at riopress.net  Tue May  7 20:48:41 2013
From: top at riopress.net (Michael Neubert)
Date: Tue, 7 May 2013 20:48:41 +0200
Subject: [lltx] Luaotfload and Miktex
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAACO2Fw3XhbdOrtMnrc/6HrnCgAAAEAAAAB780cyKCflDoNE40Ouhb3IBAAAAAA==@riopress.net>

Dear Luaotfload-team,

everything in my Miktex Installation worked fine till the last update of luaotfload.

Nothing is working anymore. I have read the new manual of luaotfload, but nothing works as suggested.

The automatic installation with Miktex 2.9 seems to work, but the necessary files seem not to be installed.

Calling luaotfloadtool.exe or as texlua.exe luaotfload-tool.lua has no effect and produces only the below error.

The file ?lualibs.lua? is where it should be but seems not to work with luaotfload.

 

I am absolutely desperate how to make using lualatex again for compiling. Every problem I had last 2 years I could solve, with this problem I am stuck since 2 days and I can?t find any solution. New installation of Miktex doesn?t help. mkluatexfontdb ?v obviously doesn?t work anymore and produces the same error.

 

What?s the solution?

Michael

 

 





----------------------------------------------

riopress.net

words connecting the world

 

michael neubert

dorfhauser str. 18

91367 wei?enohe

germany

 

telephone:

+49 9192 99 4840

facsimile:

+49 9192 99 4905            

----------------------------------------------

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130507/a553612c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 16540 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130507/a553612c/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 20138 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130507/a553612c/attachment-0003.png>

From top at riopress.net  Thu May  9 13:23:17 2013
From: top at riopress.net (Michael Neubert)
Date: Thu, 9 May 2013 13:23:17 +0200
Subject: [lltx] Luaotfload and Miktex
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAACO2Fw3XhbdOrtMnrc/6HrnCgAAAEAAAACvB3nYH3FZAiEogYs1PxRgBAAAAAA==@riopress.net>

Dear Luaotfload-team,

the today?s update made short tex-files compilable again without any error message (annexed: kursiv), real fractions of Linux Libertine don?t work, but this may be a problem of fontspec.

 

But my Ph.D. thesis (promotion.log) is still stuck and doesn?t compile at all, but it before 29.04.2013-update without any problem. Now there seems to be a problem with ?luatexhyphen?, a package, I didn?t even know that I am using.

 

Do you know what the problem is?

Regards

Michael

 



 

----------------------------------------------

riopress.net

words connecting the world

 

michael neubert

dorfhauser str. 18

91367 wei?enohe

germany

 

telephone:

+49 9192 99 4840

facsimile:

+49 9192 99 4905            

----------------------------------------------

 

From: Michael Neubert [mailto:top at riopress.net] 
Sent: Tuesday, May 07, 2013 8:49 PM
To: 'lualatex-dev at tug.org'
Subject: Luaotfload and Miktex
Importance: High

 

Dear Luaotfload-team,

everything in my Miktex Installation worked fine till the last update of luaotfload.

Nothing is working anymore. I have read the new manual of luaotfload, but nothing works as suggested.

The automatic installation with Miktex 2.9 seems to work, but the necessary files seem not to be installed.

Calling luaotfloadtool.exe or as texlua.exe luaotfload-tool.lua has no effect and produces only the below error.

The file ?lualibs.lua? is where it should be but seems not to work with luaotfload.

 

I am absolutely desperate how to make using lualatex again for compiling. Every problem I had last 2 years I could solve, with this problem I am stuck since 2 days and I can?t find any solution. New installation of Miktex doesn?t help. mkluatexfontdb ?v obviously doesn?t work anymore and produces the same error.

 

What?s the solution?

Michael

 

 





----------------------------------------------

riopress.net

words connecting the world

 

michael neubert

dorfhauser str. 18

91367 wei?enohe

germany

 

telephone:

+49 9192 99 4840

facsimile:

+49 9192 99 4905            

----------------------------------------------

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 24433 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0003.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 16540 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.png
Type: image/png
Size: 20138 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: kursiv.tex
Type: application/octet-stream
Size: 611 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0003.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: kursiv.log
Type: application/octet-stream
Size: 60246 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0004.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: kursiv.pdf
Type: application/pdf
Size: 20595 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0001.pdf>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: promotion.log
Type: application/octet-stream
Size: 4096 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/000ae153/attachment-0005.obj>

From Philipp.Gesang at alumni.uni-heidelberg.de  Thu May  9 19:36:37 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Thu, 9 May 2013 19:36:37 +0200
Subject: [lltx] Luaotfload and Miktex
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAACO2Fw3XhbdOrtMnrc/6HrnCgAAAEAAAACvB3nYH3FZAiEogYs1PxRgBAAAAAA==@riopress.net>
References: <!&!AAAAAAAAAAAYAAAAAAAAACO2Fw3XhbdOrtMnrc/6HrnCgAAAEAAAACvB3nYH3FZAiEogYs1PxRgBAAAAAA==@riopress.net>
Message-ID: <20130509173637.GB20616@phlegethon>

Hi Michael,

thanks for testing!

???<date: 2013-05-09, Thursday>???<from: Michael Neubert>???

> the today?s update made short tex-files compilable again
> without any error message (annexed: kursiv), real fractions of
> Linux Libertine don?t work, but this may be a problem of
> fontspec.

Fractions and text figures (onum) appear to be mutually
exclusive. Test for plain:

  \input luaotfload.sty
  %\font\libertineregular="name:Linux Libertine O:+frac;+onum" \libertineregular
  \font\libertineregular="name:Linux Libertine O:+frac" \libertineregular
  foo 1/2 \quad 1/5 \quad 355/530 \quad bar
  \bye

And latex/fontspec:

  \documentclass{article}
  \usepackage{fontspec}\setmainfont{Linux Libertine O}
  \begin{document}
    {\addfontfeature{Fractions=On}
     +onum: 1/2 \quad 1/5 \quad 355/530 \quad}\endgraf
    {\addfontfeature{Fractions=On,Numbers=Lowercase}
     +frac;+onum: 1/2 \quad 1/5 \quad 355/530 \quad}\endgraf
  \end{document}

> But my Ph.D. thesis (promotion.log) is still stuck and doesn?t
> compile at all, but it before 29.04.2013-update without any
> problem. Now there seems to be a problem with ?luatexhyphen?, a
> package, I didn?t even know that I am using.
> 
> Do you know what the problem is?

Not really. But judging from your logs your luatex binary is
*really* out of date. There?s even warning:

    Module luaotfload warning: LuaTeX v0.70 is old, v0.76 is recommended.

The font loader relies on Luatex features like node.end_of_math()
so it is likely to break with your binary. Are you certain that
you did a complete update?

Best
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130509/02c005a7/attachment.bin>

From news3 at nililand.de  Fri May 10 08:59:56 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Fri, 10 May 2013 08:59:56 +0200
Subject: [lltx] Luaotfload and Miktex
References: <!&!AAAAAAAAAAAYAAAAAAAAACO2Fw3XhbdOrtMnrc/6HrnCgAAAEAAAACvB3nYH3FZAiEogYs1PxRgBAAAAAA==@riopress.net>
 <20130509173637.GB20616@phlegethon>
Message-ID: <fhu7sm302hc2$.dlg@nililand.de>

Am Thu, 9 May 2013 19:36:37 +0200 schrieb Philipp Gesang:

> Not really. But judging from your logs your luatex binary is
> *really* out of date. There?s even warning:
> 
>     Module luaotfload warning: LuaTeX v0.70 is old, v0.76 is recommended.
> 
> The font loader relies on Luatex features like node.end_of_math()
> so it is likely to break with your binary. Are you certain that
> you did a complete update?

Miktex doesn't have luatex 0.76. And actually doesn't intend to
update until version 0.80:

To quote Christian on the mailing list:

"Usually only x.x0 versions of LuaTeX are included in the MiKTeX 
distribution. See http://luatex.org/roadmap.html:

'...major releases (x.x0 versions) are stable enough to be used for 
production work...'"

Is a newer version really necessary? 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From mailing_list at arcor.de  Fri May 10 10:35:23 2013
From: mailing_list at arcor.de (Stephan Hennig)
Date: Fri, 10 May 2013 10:35:23 +0200
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <20130501103849.GA31270@phlegethon>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
 <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
 <20130501103849.GA31270@phlegethon>
Message-ID: <518CB14B.8040005@arcor.de>

Am 01.05.2013 12:38, schrieb Philipp Gesang:
> ???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???
>> 2013/5/1 Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de>:
>> > ???<date: 2013-05-01, Wednesday>???<from: Dohyun Kim>???
>> >
>> >> luaotfload package in current TL pretest has introduced a bug.  Bold
>> >> font of some, but not all, font family is not loaded by "/B" notation.
>> >>  A patch to otfl-font-nms.lua would be needed.  I am attaching a diff
>> >> file.
>> >
>> > 1) MWE, please.

I've a similar problem using Latin Modern Mono (sorry, LaTeX only):

\listfiles
\documentclass{minimal}
\usepackage{fontspec}
\begin{document}
\ttfamily
\bfseries
\end{document}


> Thanks, can you test with this version:
> 
>   https://raw.github.com/lualatex/luaotfload/texlive2011/otfl-font-nms.lua

There's no such file in TL 2013 pretest.  Copying the file to

  \2013\texmf-dist\tex\luatex\luaotfload

beneath the other luaotfload files and running texhash didn't help with
the example.  How should I test the file?

Best regards,
Stephan Hennig


> This is LuaTeX, Version beta-0.76.0-2013050715 (rev 4627)  (format=lualatex 2013.5.8)  10 MAY 2013 10:31
>  restricted \write18 enabled.
> **test-2013
> (./test-2013.tex
> LaTeX2e <2011/06/27>
> LuaTeX adaptation of babel <v3.8m-luatex-1.5> and hyphenation patterns for engli
> sh, dumylang, nohyphenation, loaded.
> (d:/texlive/2013/texmf-dist/tex/latex/base/minimal.cls
> Document Class: minimal 2001/05/25 Standard LaTeX minimal class
> ) (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec.sty
> Package: fontspec 2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/expl3.sty
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3names.sty
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3bootstrap.sty
> Package: l3bootstrap 2013/01/08 v4420 L3 Experimental bootstrap code
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/luatex.sty
> Package: luatex 2010/03/09 v0.4 LuaTeX basic definition package (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/infwarerr.sty
> Package: infwarerr 2010/04/08 v1.3 Providing info/warning/error messages (HO)
> )
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ifluatex.sty
> Package: ifluatex 2010/03/01 v1.3 Provides the ifluatex switch (HO)
> Package ifluatex Info: LuaTeX detected.
> )
> (d:/texlive/2013/texmf-dist/tex/latex/etex-pkg/etex.sty
> Package: etex 1998/03/26 v2.0 eTeX basic definition package (PEB)
> \et at xins=\count79
> )
> \LuT at AllocAttribute=\count277
> \LuT at AllocCatcodeTable=\count278
> \CatcodeTableStack=\count279
> \CatcodeTableIniTeX=\catcodetable1
> \CatcodeTableString=\catcodetable3
> \CatcodeTableOther=\catcodetable5
> \CatcodeTableLaTeX=\catcodetable7
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/luatex-loader.sty
> Package: luatex-loader 2010/03/09 v0.4 Lua module loader (HO)
> 
> (d:/texlive/2013/texmf-dist/scripts/oberdiek/oberdiek.luatex.lua)))
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/pdftexcmds.sty
> Package: pdftexcmds 2011/11/29 v0.20 Utility functions of pdfTeX for LuaTeX (HO)
> 
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ltxcmds.sty
> Package: ltxcmds 2011/11/09 v1.22 LaTeX kernel commands for general use (HO)
> )
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ifpdf.sty
> Package: ifpdf 2011/01/30 v2.3 Provides the ifpdf switch (HO)
> Package ifpdf Info: pdfTeX in PDF mode is detected.
> )
> Package pdftexcmds Info: \pdf at primitive is available.
> Package pdftexcmds Info: \pdf at ifprimitive is available.
> Package pdftexcmds Info: \pdfdraftmode found.
> \pdftexcmds at toks=\toks14
> ))
> Package: l3names 2012/12/07 v4346 L3 Namespace for primitives
> )
> Package: expl3 2013/03/14 v4469 L3 Experimental code bundle wrapper
> 
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3basics.sty
> Package: l3basics 2013/01/10 v4428 L3 Basic definitions
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3expan.sty
> Package: l3expan 2013/02/03 v4458 L3 Argument expansion
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3tl.sty
> Package: l3tl 2013/01/08 v4415 L3 Token lists
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3seq.sty
> Package: l3seq 2013/01/12 v4434 L3 Sequences and stacks
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3int.sty
> Package: l3int 2013/01/13 v4444 L3 Integers
> \c_max_int=\count280
> \l_tmpa_int=\count281
> \l_tmpb_int=\count282
> \g_tmpa_int=\count283
> \g_tmpb_int=\count284
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3quark.sty
> Package: l3quark 2012/11/04 v4268 L3 Quarks
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3prg.sty
> Package: l3prg 2013/02/13 v4459 L3 Control structures
> \g__prg_map_int=\count285
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3clist.sty
> Package: l3clist 2013/01/08 v4414 L3 Comma separated lists
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3token.sty
> Package: l3token 2013/01/10 v4428 L3 Experimental token manipulation
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3prop.sty
> Package: l3prop 2013/01/09 v4423 L3 Property lists
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3msg.sty
> Package: l3msg 2013/01/08 v4412 L3 Messages
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3file.sty
> Package: l3file 2013/01/14 v4446 L3 File and I/O operations
> \l_iow_line_count_int=\count286
> \l__iow_target_count_int=\count287
> \l__iow_current_line_int=\count288
> \l__iow_current_word_int=\count289
> \l__iow_current_indentation_int=\count290
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3skip.sty
> Package: l3skip 2013/01/13 v4444 L3 Dimensions and skips
> \c_zero_dim=\dimen256
> \c_max_dim=\dimen257
> \l_tmpa_dim=\dimen258
> \l_tmpb_dim=\dimen259
> \g_tmpa_dim=\dimen260
> \g_tmpb_dim=\dimen261
> \c_zero_skip=\skip256
> \c_max_skip=\skip257
> \l_tmpa_skip=\skip258
> \l_tmpb_skip=\skip259
> \g_tmpa_skip=\skip260
> \g_tmpb_skip=\skip261
> \c_zero_muskip=\muskip10
> \c_max_muskip=\muskip11
> \l_tmpa_muskip=\muskip12
> \l_tmpb_muskip=\muskip13
> \g_tmpa_muskip=\muskip14
> \g_tmpb_muskip=\muskip15
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3keys.sty
> Package: l3keys 2013/02/24 v4461 L3 Experimental key-value interfaces
> \g__keyval_level_int=\count291
> \l_keys_choice_int=\count292
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3fp.sty
> Package: l3fp 2013/01/19 v4449 L3 Floating points
> \c__fp_leading_shift_int=\count293
> \c__fp_middle_shift_int=\count294
> \c__fp_trailing_shift_int=\count295
> \c__fp_big_leading_shift_int=\count296
> \c__fp_big_middle_shift_int=\count297
> \c__fp_big_trailing_shift_int=\count298
> \c__fp_Bigg_leading_shift_int=\count299
> \c__fp_Bigg_middle_shift_int=\count300
> \c__fp_Bigg_trailing_shift_int=\count301
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3box.sty
> Package: l3box 2013/01/08 v4411 L3 Experimental boxes
> \c_empty_box=\box256
> \l_tmpa_box=\box257
> \l_tmpb_box=\box258
> \g_tmpa_box=\box259
> \g_tmpb_box=\box260
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3coffins.sty
> Package: l3coffins 2012/09/09 v4212 L3 Coffin code layer
> \l__coffin_internal_box=\box261
> \l__coffin_internal_dim=\dimen262
> \l__coffin_offset_x_dim=\dimen263
> \l__coffin_offset_y_dim=\dimen264
> \l__coffin_x_dim=\dimen265
> \l__coffin_y_dim=\dimen266
> \l__coffin_x_prime_dim=\dimen267
> \l__coffin_y_prime_dim=\dimen268
> \c_empty_coffin=\box262
> \l__coffin_aligned_coffin=\box263
> \l__coffin_aligned_internal_coffin=\box264
> \l_tmpa_coffin=\box265
> \l_tmpb_coffin=\box266
> \l__coffin_display_coffin=\box267
> \l__coffin_display_coord_coffin=\box268
> \l__coffin_display_pole_coffin=\box269
> \l__coffin_display_offset_dim=\dimen269
> \l__coffin_display_x_dim=\dimen270
> \l__coffin_display_y_dim=\dimen271
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3color.sty
> Package: l3color 2012/08/29 v4156 L3 Experimental color support
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3luatex.sty
> Package: l3luatex 2012/08/03 v4049 L3 Experimental LuaTeX-specific functions
> \g__cctab_allocate_int=\count302
> \g__cctab_stack_int=\count303
> \c_code_cctab=\catcodetable9
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3candidates.sty
> Package: l3candidates 2013/03/14 v4468 L3 Experimental additions to l3kernel
> \l__box_top_dim=\dimen272
> \l__box_bottom_dim=\dimen273
> \l__box_left_dim=\dimen274
> \l__box_right_dim=\dimen275
> \l__box_top_new_dim=\dimen276
> \l__box_bottom_new_dim=\dimen277
> \l__box_left_new_dim=\dimen278
> \l__box_right_new_dim=\dimen279
> \l__box_internal_box=\box270
> \l__coffin_bounding_shift_dim=\dimen280
> \l__coffin_left_corner_dim=\dimen281
> \l__coffin_right_corner_dim=\dimen282
> \l__coffin_bottom_corner_dim=\dimen283
> \l__coffin_top_corner_dim=\dimen284
> \l__coffin_scaled_total_height_dim=\dimen285
> \l__coffin_scaled_width_dim=\dimen286
> ))
> (d:/texlive/2013/texmf-dist/tex/latex/l3packages/xparse/xparse.sty
> Package: xparse 2013/03/12 v4467 L3 Experimental document command parser
> \l__xparse_current_arg_int=\count304
> \l__xparse_m_args_int=\count305
> \l__xparse_mandatory_args_int=\count306
> \l__xparse_processor_int=\count307
> \l__xparse_v_nesting_int=\count308
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload.sty
> Package: luaotfload 2013/04/16 v2.2 OpenType layout system
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase.sty
> Package: luatexbase 2013/05/04 v0.6 Module utilities for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-compat.sty
> Package: luatexbase-compat 2011/05/24 v0.4 Compatibility tools for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-loader.sty
> Package: luatexbase-loader 2013/04/13 v0.5 Lua module loader for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase.loader.lua))
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-regs.sty
> Package: luatexbase-regs 2011/05/24 v0.4 Registers allocation for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-attr.sty
> Package: luatexbase-attr 2011/05/24 v0.4 Attributes allocation for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/attr.lua)
> \lltxb at attr@unsetvalue=\count309
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-cctb.sty
> Package: luatexbase-cctb 2011/05/24 v0.4 Catcodetable allocation for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/cctb.lua)
> \lltxb at catcodetable@alloc=\count310
> \CatcodeTableStack=\count311
> \CatcodeTableIniTeX=\luatexcatcodetable1
> \CatcodeTableString=\luatexcatcodetable3
> \CatcodeTableOther=\luatexcatcodetable5
> \CatcodeTableLaTeX=\luatexcatcodetable7
> \CatcodeTableLaTeXAtLetter=\luatexcatcodetable9
> \CatcodeTableExpl=\luatexcatcodetable11
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-mcb.sty
> Package: luatexbase-mcb 2013/04/13 v0.5 Callback management for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-modutils.sty
> Package: luatexbase-modutils 2013/04/13 v0.5 Module utilities for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/modutils.lua))
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/mcb.lua)
> Lua module: luatexbase-mcb 2013/04/13 0.5 register several functions in a callba
> ck
> ))
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload.lua)
> Lua module: luaotfload 2013/04/29 2.2 OpenType layout system.
> luaotfload: push namespace for font loader
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-merged.lua)(using w
> rite cache: d:/texlive/2013/texmf-var/luatex-cache/generic)(using read cache: d:
> /texlive/2013/texmf-var/luatex-cache/generic c:/Users/Stephan/.texlive2013/texmf
> -var/luatex-cache/generic)
> (log) luatexbase.attributes["luaotfload at kernpair"] = 1
> (log) luatexbase.attributes["luaotfload at ligacomp"] = 2
> (log) luatexbase.attributes["luaotfload at markbase"] = 3
> (log) luatexbase.attributes["luaotfload at markmark"] = 4
> (log) luatexbase.attributes["luaotfload at markdone"] = 5
> (log) luatexbase.attributes["luaotfload at cursbase"] = 6
> (log) luatexbase.attributes["luaotfload at curscurs"] = 7
> (log) luatexbase.attributes["luaotfload at cursdone"] = 8
> (log) luatexbase.attributes["luaotfload at state"] = 9
> luaotfload: ^^e2^^80^^9cI am using the merged version of 'luaotfload.lua' here. 
> If
> luaotfload:  you run into problems or experience unexpected behaviour,
> luaotfload:  and if you have ConTeXt installed you can try to delete the
> luaotfload:  file 'luaotfload-font-merged.lua' as I might then use the
> luaotfload:  possibly updated libraries. The merged version is not
> luaotfload:  supported as it is a frozen instance. Problems can be
> luaotfload:  reported to the ConTeXt mailing list.^^e2^^80^^9d
> luaotfload: pop namespace from font loader -- non-destructive
> luaotfload: fontloader loaded in 0.034 seconds
> luatexbase-mcb: inserting 'luaotfload.node_processor'
> at position 1 in 'pre_linebreak_filter'
> luatexbase-mcb: inserting 'luaotfload.node_processor'
> at position 1 in 'hpack_filter'
> luatexbase-mcb: inserting 'luaotfload.find_vf_file'
> at position 1 in 'find_vf_file'
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-lib-dir.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-override.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-loaders.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-database.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-colors.lua)
> luatexbase-mcb: creating 'luaotfload.patch_font' type 4
> luatexbase-mcb: resetting callback 'define_font'
> luatexbase-mcb: inserting 'luaotfload.define_font'
> at position 1 in 'define_font'
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-features.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-auxiliary.lua)
> luatexbase-mcb: inserting 'luaotfload.fontdata_fallbacks'
> at position 1 in 'luaotfload.patch_font'
> luatexbase-mcb: inserting 'luaotfload.aux.set_sscale_dimens'
> at position 2 in 'luaotfload.patch_font'
> luatexbase-mcb: inserting 'luaotfload.aux.patch_cambria_domh'
> at position 3 in 'luaotfload.patch_font'
> luatexbase-mcb: inserting 'luaotfload.aux.set_capheight'
> at position 4 in 'luaotfload.patch_font')
> (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec.lua)
> Lua module: fontspec 2009/12/04 2 Advanced font selection for LuaLaTeX.
> luatexbase-mcb: inserting 'fontspec.set_capheight'
> at position 5 in 'luaotfload.patch_font'
> \l_fontspec_script_int=\count312
> \l_fontspec_language_int=\count313
> \l_fontspec_strnum_int=\count314
> \l_fontspec_tmpa_dim=\dimen287
> \l_fontspec_tmpb_dim=\dimen288
> \l_fontspec_tmpc_dim=\dimen289
> Variant \tl_gset:cV already defined; not changing it on line 69
> 
> (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec-patches.sty
> Package: fontspec-patches 2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaT
> eX
> 
> (d:/texlive/2013/texmf-dist/tex/latex/base/fixltx2e.sty
> Package: fixltx2e 2006/09/13 v1.1m fixes to LaTeX
> LaTeX Info: Redefining \em on input line 420.
> )
> LaTeX Info: Redefining \em on input line 22.
> LaTeX Info: Redefining \emph on input line 30.
> LaTeX Info: Redefining \- on input line 33.
> 
> *************************************************
> * LaTeX warning: "xparse/redefine-command"
> * 
> * Redefining document command \oldstylenums with arg. spec. 'm' on line 128.
> *************************************************
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \liningnums with arg. spec. 'm' on line 132.
> .................................................
> ) (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec-luatex.sty
> Package: fontspec-luatex 2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTe
> X
> 
> (d:/texlive/2013/texmf-dist/tex/latex/base/fontenc.sty
> Package: fontenc 2005/09/27 v1.99g Standard LaTeX package
> 
> (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2enc.def
> File: eu2enc.def 2010/05/27 v0.1h Experimental Unicode font encodings
> )
> LaTeX Font Info:    Try loading font information for EU2+lmr on input line 100.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2lmr.fd
> File: eu2lmr.fd 2009/10/30 v1.6 Font defs for Latin Modern
> )
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmroman10
> -regular.luc))
> (d:/texlive/2013/texmf-dist/tex/xelatex/xunicode/xunicode.sty
> File: xunicode.sty 2011/09/09 v0.981 provides access to latin accents and many o
> ther characters in Unicode lower plane
> 
> (d:/texlive/2013/texmf-dist/tex/latex/tipa/t3enc.def
> File: t3enc.def 2001/12/31 T3 encoding
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmromansl
> ant10-regular.luc)
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmroman10
> -italic.luc)
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmroman10
> -bold.luc)
> LaTeX Font Info:    Try loading font information for EU2+lmss on input line 357.
> 
>  (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2lmss.fd
> File: eu2lmss.fd 2009/10/30 v1.6 Font defs for Latin Modern
> )
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmsans10-
> regular.luc))
> \tipaTiiicode=\count315
> \tipasavetokens=\toks15
> \tipachecktokens=\toks16
> 
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/graphicx.sty
> Package: graphicx 1999/02/16 v1.0f Enhanced LaTeX Graphics (DPC,SPQR)
> 
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/keyval.sty
> Package: keyval 1999/03/16 v1.13 key=value parser (DPC)
> \KV at toks@=\toks17
> )
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/graphics.sty
> Package: graphics 2009/02/05 v1.0o Standard LaTeX Graphics (DPC,SPQR)
> 
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/trig.sty
> Package: trig 1999/03/16 v1.09 sin cos tan (DPC)
> )
> (d:/texlive/2013/texmf-dist/tex/latex/latexconfig/graphics.cfg
> File: graphics.cfg 2010/04/23 v1.9 graphics configuration of TeX Live
> )
> Package graphics Info: Driver file: pdftex.def on input line 91.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/pdftex-def/pdftex.def
> File: pdftex.def 2011/05/27 v0.06d Graphics/color for pdfTeX
> \Gread at gobject=\count316
> ))
> \Gin at req@height=\dimen290
> \Gin at req@width=\dimen291
> ))
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \fontspec with arg. spec. 'O{}m' on line 44.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmainfont with arg. spec. 'O{}m' on line 49.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setsansfont with arg. spec. 'O{}m' on line 54.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmonofont with arg. spec. 'O{}m' on line 59.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmathrm with arg. spec. 'O{}m' on line 68.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setboldmathrm with arg. spec. 'O{}m' on line 72.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmathsf with arg. spec. 'O{}m' on line 76.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmathtt with arg. spec. 'O{}m' on line 80.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontfamily with arg. spec. 'mO{}m' on line 99.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontface with arg. spec. 'mO{}m' on line 103.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \defaultfontfeatures with arg. spec. 'om' on line
> . 111.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \addfontfeatures with arg. spec. 'm' on line 147.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontfeature with arg. spec. 'mm' on line 159.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newAATfeature with arg. spec. 'mmmm' on line 167.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newICUfeature with arg. spec. 'mmm' on line 175.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \aliasfontfeature with arg. spec. 'mm' on line
> . 204.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \aliasfontfeatureoption with arg. spec. 'mmm' on
> . line 206.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontscript with arg. spec. 'mm' on line 211.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontlanguage with arg. spec. 'mm' on line 238.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \DeclareFontsExtensions with arg. spec. 'm' on
> . line 259.
> .................................................
> Variant \prop_gput:cnV already defined; not changing it on line 586
> Variant \prop_gput:cnx already defined; not changing it on line 587
> \l_fontspec_tmp_int=\count317
> LaTeX Info: Redefining \itshape on input line 2012.
> LaTeX Info: Redefining \slshape on input line 2017.
> LaTeX Info: Redefining \scshape on input line 2022.
> LaTeX Info: Redefining \upshape on input line 2027.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec.cfg))) (./test-2013.aux
> )
> LaTeX Font Info:    Checking defaults for OML/cmm/m/it on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for T1/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OT1/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OMS/cmsy/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OMX/cmex/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for U/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for T3/cmr/m/n on input line 4.
> LaTeX Font Info:    Try loading font information for T3+cmr on input line 4.
>  (d:/texlive/2013/texmf-dist/tex/latex/tipa/t3cmr.fd
> File: t3cmr.fd 2001/12/31 TIPA font definitions
> )
> LaTeX Font Info:    ... okay on input line 4.
> 
> (d:/texlive/2013/texmf-dist/tex/context/base/supp-pdf.mkii
> [Loading MPS to PDF converter (version 2006.09.02).]
> \scratchcounter=\count318
> \scratchdimen=\dimen292
> \scratchbox=\box271
> \nofMPsegments=\count319
> \nofMParguments=\count320
> \everyMPshowfont=\toks18
> \MPscratchCnt=\count321
> \MPscratchDim=\dimen293
> \MPnumerator=\count322
> \makeMPintoPDFobject=\count323
> \everyMPtoPDFconversion=\toks19
> ) (d:/texlive/2013/texmf-dist/tex/latex/oberdiek/epstopdf-base.sty
> Package: epstopdf-base 2010/02/09 v2.5 Base part for package epstopdf
> 
> (d:/texlive/2013/texmf-dist/tex/latex/oberdiek/grfext.sty
> Package: grfext 2010/08/19 v1.1 Manage graphics extensions (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/kvdefinekeys.sty
> Package: kvdefinekeys 2011/04/07 v1.3 Define keys (HO)
> ))
> (d:/texlive/2013/texmf-dist/tex/latex/oberdiek/kvoptions.sty
> Package: kvoptions 2011/06/30 v3.11 Key value format for package options (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/kvsetkeys.sty
> Package: kvsetkeys 2012/04/25 v1.16 Key value parser (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/etexcmds.sty
> Package: etexcmds 2011/02/16 v1.5 Avoid name clashes with e-TeX commands (HO)
> )))
> Package grfext Info: Graphics extension search list:
> (grfext)             [.png,.pdf,.jpg,.mps,.jpeg,.jbig2,.jb2,.PNG,.PDF,.JPG,.JPEG
> ,.JBIG2,.JB2,.eps]
> (grfext)             \AppendGraphicsExtensions on input line 452.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg
> File: epstopdf-sys.cfg 2010/07/13 v1.3 Configuration of (r)epstopdf for TeX Live
> 
> ))
> .................................................
> . fontspec info: "setup-math"
> . 
> . Adjusting the maths setup (use [no-math] to avoid this).
> .................................................
> \symlegacymaths=\mathgroup4
> LaTeX Font Info:    Overwriting symbol font `legacymaths' in version `bold'
> (Font)                  OT1/cmr/m/n --> OT1/cmr/bx/n on input line 4.
> LaTeX Font Info:    Redeclaring math accent \acute on input line 4.
> LaTeX Font Info:    Redeclaring math accent \grave on input line 4.
> LaTeX Font Info:    Redeclaring math accent \ddot on input line 4.
> LaTeX Font Info:    Redeclaring math accent \tilde on input line 4.
> LaTeX Font Info:    Redeclaring math accent \bar on input line 4.
> LaTeX Font Info:    Redeclaring math accent \breve on input line 4.
> LaTeX Font Info:    Redeclaring math accent \check on input line 4.
> LaTeX Font Info:    Redeclaring math accent \hat on input line 4.
> LaTeX Font Info:    Redeclaring math accent \dot on input line 4.
> LaTeX Font Info:    Redeclaring math accent \mathring on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \colon on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Gamma on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Delta on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Theta on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Lambda on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Xi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Pi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Sigma on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Upsilon on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Phi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Psi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Omega on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \mathdollar on input line 4.
> LaTeX Font Info:    Redeclaring symbol font `operators' on input line 4.
> LaTeX Font Info:    Encoding `OT1' has changed to `EU2' for symbol font
> (Font)              `operators' in the math version `normal' on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `normal'
> (Font)                  OT1/cmr/m/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Encoding `OT1' has changed to `EU2' for symbol font
> (Font)              `operators' in the math version `bold' on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `bold'
> (Font)                  OT1/cmr/bx/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `normal'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathrm' in version `normal'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathit' in version `normal'
> (Font)                  OT1/cmr/m/it --> EU2/lmr/m/it on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathbf' in version `normal'
> (Font)                  OT1/cmr/bx/n --> EU2/lmr/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathsf' in version `normal'
> (Font)                  OT1/cmss/m/n --> EU2/lmss/m/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathtt' in version `normal'
> (Font)                  OT1/cmtt/m/n --> EU2/lmtt/m/n on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `bold'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathrm' in version `bold'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathit' in version `bold'
> (Font)                  OT1/cmr/bx/it --> EU2/lmr/bx/it on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathsf' in version `bold'
> (Font)                  OT1/cmss/bx/n --> EU2/lmss/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathtt' in version `bold'
> (Font)                  OT1/cmtt/m/n --> EU2/lmtt/bx/n on input line 4.
> LaTeX Font Info:    Try loading font information for EU2+lmtt on input line 5.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2lmtt.fd
> File: eu2lmtt.fd 2009/10/30 v1.6 Font defs for Latin Modern
> )
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmmono10-
> regular.luc)
> LaTeX Font Info:    Font shape `EU2/lmtt/bx/n' in size <10> not available
> (Font)              Font shape `EU2/lmtt/b/n' tried instead on input line 6.
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ?latn?, falling back to ?dflt
> ?(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmmonolt1
> 0-bold.luc)
> luaotfload | load: auto-selecting default features for script: dflt
> luaotfload | db: reload initiated; reason: ?unresolved font name: ?d??
> luaotfload | db: reload initiated; reason: ?unresolved font name: ?d??
> luaotfload | db: Font names database saved
> fonts : font with asked name 'd' is not found using lookup 'anon'
> fonts : unknown font 'd', loading aborted
> ! Font \EU2/lmtt/b/n/10=d:/texlive/2013/texmf-dist/fonts/opentype/public/lm/lmmo
> nolt10-bold.otf not loadable: metric data not found or bad.
> <to be read again> 
> \relax 
> l.6 \bfseries
>            
> ? 
> (./test-2013.aux)
> 
>  *File List*
>  minimal.cls    2001/05/25 Standard LaTeX minimal class
> fontspec.sty    2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
>    expl3.sty    2013/03/14 v4469 L3 Experimental code bundle wrapper
>  l3names.sty    2012/12/07 v4346 L3 Namespace for primitives
> l3bootstrap.sty    2013/01/08 v4420 L3 Experimental bootstrap code
>   luatex.sty    2010/03/09 v0.4 LuaTeX basic definition package (HO)
> infwarerr.sty    2010/04/08 v1.3 Providing info/warning/error messages (HO)
> ifluatex.sty    2010/03/01 v1.3 Provides the ifluatex switch (HO)
>     etex.sty    1998/03/26 v2.0 eTeX basic definition package (PEB)
> luatex-loader.sty    2010/03/09 v0.4 Lua module loader (HO)
> pdftexcmds.sty    2011/11/29 v0.20 Utility functions of pdfTeX for LuaTeX (HO)
>  ltxcmds.sty    2011/11/09 v1.22 LaTeX kernel commands for general use (HO)
>    ifpdf.sty    2011/01/30 v2.3 Provides the ifpdf switch (HO)
> l3basics.sty    2013/01/10 v4428 L3 Basic definitions
>  l3expan.sty    2013/02/03 v4458 L3 Argument expansion
>     l3tl.sty    2013/01/08 v4415 L3 Token lists
>    l3seq.sty    2013/01/12 v4434 L3 Sequences and stacks
>    l3int.sty    2013/01/13 v4444 L3 Integers
>  l3quark.sty    2012/11/04 v4268 L3 Quarks
>    l3prg.sty    2013/02/13 v4459 L3 Control structures
>  l3clist.sty    2013/01/08 v4414 L3 Comma separated lists
>  l3token.sty    2013/01/10 v4428 L3 Experimental token manipulation
>   l3prop.sty    2013/01/09 v4423 L3 Property lists
>    l3msg.sty    2013/01/08 v4412 L3 Messages
>   l3file.sty    2013/01/14 v4446 L3 File and I/O operations
>   l3skip.sty    2013/01/13 v4444 L3 Dimensions and skips
>   l3keys.sty    2013/02/24 v4461 L3 Experimental key-value interfaces
>     l3fp.sty    2013/01/19 v4449 L3 Floating points
>    l3box.sty    2013/01/08 v4411 L3 Experimental boxes
> l3coffins.sty    2012/09/09 v4212 L3 Coffin code layer
>  l3color.sty    2012/08/29 v4156 L3 Experimental color support
> l3luatex.sty    2012/08/03 v4049 L3 Experimental LuaTeX-specific functions
> l3candidates.sty    2013/03/14 v4468 L3 Experimental additions to l3kernel
>   xparse.sty    2013/03/12 v4467 L3 Experimental document command parser
> luaotfload.sty    2013/04/16 v2.2 OpenType layout system
> luatexbase.sty    2013/05/04 v0.6 Module utilities for LuaTeX
> luatexbase-compat.sty    2011/05/24 v0.4 Compatibility tools for LuaTeX
> luatexbase-loader.sty    2013/04/13 v0.5 Lua module loader for LuaTeX
> luatexbase-regs.sty    2011/05/24 v0.4 Registers allocation for LuaTeX
> luatexbase-attr.sty    2011/05/24 v0.4 Attributes allocation for LuaTeX
> luatexbase-cctb.sty    2011/05/24 v0.4 Catcodetable allocation for LuaTeX
> luatexbase-mcb.sty    2013/04/13 v0.5 Callback management for LuaTeX
> luatexbase-modutils.sty    2013/04/13 v0.5 Module utilities for LuaTeX
> fontspec-patches.sty    2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
> 
> fixltx2e.sty    2006/09/13 v1.1m fixes to LaTeX
> fontspec-luatex.sty    2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
>  fontenc.sty
>   eu2enc.def    2010/05/27 v0.1h Experimental Unicode font encodings
>   eu2lmr.fd    2009/10/30 v1.6 Font defs for Latin Modern
> xunicode.sty    2011/09/09 v0.981 provides access to latin accents and many othe
> r characters in Unicode lower plane
>  eu2lmss.fd    2009/10/30 v1.6 Font defs for Latin Modern
> graphicx.sty    1999/02/16 v1.0f Enhanced LaTeX Graphics (DPC,SPQR)
>   keyval.sty    1999/03/16 v1.13 key=value parser (DPC)
> graphics.sty    2009/02/05 v1.0o Standard LaTeX Graphics (DPC,SPQR)
>     trig.sty    1999/03/16 v1.09 sin cos tan (DPC)
> graphics.cfg    2010/04/23 v1.9 graphics configuration of TeX Live
>   pdftex.def    2011/05/27 v0.06d Graphics/color for pdfTeX
> fontspec.cfg
>    t3cmr.fd    2001/12/31 TIPA font definitions
> supp-pdf.mkii
> epstopdf-base.sty    2010/02/09 v2.5 Base part for package epstopdf
>   grfext.sty    2010/08/19 v1.1 Manage graphics extensions (HO)
> kvdefinekeys.sty    2011/04/07 v1.3 Define keys (HO)
> kvoptions.sty    2011/06/30 v3.11 Key value format for package options (HO)
> kvsetkeys.sty    2012/04/25 v1.16 Key value parser (HO)
> etexcmds.sty    2011/02/16 v1.5 Avoid name clashes with e-TeX commands (HO)
> epstopdf-sys.cfg    2010/07/13 v1.3 Configuration of (r)epstopdf for TeX Live
>  eu2lmtt.fd    2009/10/30 v1.6 Font defs for Latin Modern
>  ***********
> 
>  )
> 
> Here is how much of LuaTeX's memory you used:
>  14935 strings out of 494761
>  100000,383344 words of node,token memory allocated
>  264 words of node memory still in use:
>    3 hlist, 1 vlist, 1 rule, 2 glue, 3 attribute, 35 glue_spec, 3 attribute_list
> , 1 write nodes
>    avail lists: 2:8,3:1,6:3,7:1,9:1
>  18211 multiletter control sequences out of 65536+600000
>  21 fonts using 1018987 bytes
>  48i,1n,30p,362b,85s stack positions out of 5000i,500n,10000p,200000b,100000s
> No pages of output.
> 
> PDF statistics: 0 PDF objects out of 1000 (max. 8388607)
>  0 named destinations out of 1000 (max. 131072)
>  1 words of extra memory for PDF output out of 10000 (max. 10000000)
> 


From mailing_list at arcor.de  Fri May 10 18:40:18 2013
From: mailing_list at arcor.de (Stephan Hennig)
Date: Fri, 10 May 2013 18:40:18 +0200
Subject: [lltx] luatexbase and module version
Message-ID: <518D22F2.6020202@arcor.de>

Hi,

luatexbase-modutils provides means to test if and what version of a
module is loaded.  I want to test if a certain version of package
luatexbase-attr is loaded, but the attached code returns nil.

Alternatively, I could check if a particular feature foo is present via

  if luatexbase.foo then

instead, but I wonder why applying the interface provided in
luatexbase-modutils to package luatexbase shouldn't work.

BTW, as you can see from the log file, package luatexbase-attr from
luatexbase v0.6 identifies itself as 2011/05/24 v0.4.  I know, there
have indeed been recent changes to luatexbase-attr.  Is that package
version and date intentional?

Best regards,
Stephan Hennig


\listfiles
\documentclass{article}
\usepackage{luatexbase}
\begin{document}
\directlua{
  local v = luatexbase.get_module_version('luatexbase')
  texio.write_nl(tostring(v))
}
\end{document}


> This is LuaTeX, Version beta-0.76.0-2013050715 (rev 4627)  (format=lualatex 2013.5.8)  10 MAY 2013 14:51
>  restricted \write18 enabled.
> **test-version
> (./test-version.tex
> LaTeX2e <2011/06/27>
> LuaTeX adaptation of babel <v3.8m-luatex-1.5> and hyphenation patterns for engli
> sh, dumylang, nohyphenation, loaded.
> (d:/texlive/2013/texmf-dist/tex/latex/base/article.cls
> Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
> (d:/texlive/2013/texmf-dist/tex/latex/base/size10.clo
> File: size10.clo 2007/10/19 v1.4h Standard LaTeX file (size option)
> )
> \c at part=\count79
> \c at section=\count80
> \c at subsection=\count81
> \c at subsubsection=\count82
> \c at paragraph=\count83
> \c at subparagraph=\count84
> \c at figure=\count85
> \c at table=\count86
> \abovecaptionskip=\skip41
> \belowcaptionskip=\skip42
> \bibindent=\dimen102
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase.sty
> Package: luatexbase 2013/05/04 v0.6 Module utilities for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ifluatex.sty
> Package: ifluatex 2010/03/01 v1.3 Provides the ifluatex switch (HO)
> Package ifluatex Info: LuaTeX detected.
> )
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/luatex.sty
> Package: luatex 2010/03/09 v0.4 LuaTeX basic definition package (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/infwarerr.sty
> Package: infwarerr 2010/04/08 v1.3 Providing info/warning/error messages (HO)
> )
> (d:/texlive/2013/texmf-dist/tex/latex/etex-pkg/etex.sty
> Package: etex 1998/03/26 v2.0 eTeX basic definition package (PEB)
> \et at xins=\count87
> )
> \LuT at AllocAttribute=\count277
> \LuT at AllocCatcodeTable=\count278
> \CatcodeTableStack=\count279
> \CatcodeTableIniTeX=\catcodetable1
> \CatcodeTableString=\catcodetable3
> \CatcodeTableOther=\catcodetable5
> \CatcodeTableLaTeX=\catcodetable7
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/luatex-loader.sty
> Package: luatex-loader 2010/03/09 v0.4 Lua module loader (HO)
> 
> (d:/texlive/2013/texmf-dist/scripts/oberdiek/oberdiek.luatex.lua)))
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-compat.sty
> Package: luatexbase-compat 2011/05/24 v0.4 Compatibility tools for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-loader.sty
> Package: luatexbase-loader 2013/04/13 v0.5 Lua module loader for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase.loader.lua))
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-regs.sty
> Package: luatexbase-regs 2011/05/24 v0.4 Registers allocation for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-attr.sty
> Package: luatexbase-attr 2011/05/24 v0.4 Attributes allocation for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/attr.lua)
> \lltxb at attr@unsetvalue=\count280
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-cctb.sty
> Package: luatexbase-cctb 2011/05/24 v0.4 Catcodetable allocation for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/cctb.lua)
> \lltxb at catcodetable@alloc=\count281
> \CatcodeTableStack=\count282
> \CatcodeTableIniTeX=\luatexcatcodetable1
> \CatcodeTableString=\luatexcatcodetable3
> \CatcodeTableOther=\luatexcatcodetable5
> \CatcodeTableLaTeX=\luatexcatcodetable7
> \CatcodeTableLaTeXAtLetter=\luatexcatcodetable9
> \CatcodeTableExpl=\luatexcatcodetable11
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-mcb.sty
> Package: luatexbase-mcb 2013/04/13 v0.5 Callback management for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-modutils.sty
> Package: luatexbase-modutils 2013/04/13 v0.5 Module utilities for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/modutils.lua))
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/mcb.lua)
> Lua module: luatexbase-mcb 2013/04/13 0.5 register several functions in a callba
> ck
> ))
> (./test-version.aux)
> LaTeX Font Info:    Checking defaults for OML/cmm/m/it on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for T1/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OT1/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OMS/cmsy/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OMX/cmex/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for U/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> 
> nil (./test-version.aux)
> 
>  *File List*
>  article.cls    2007/10/19 v1.4h Standard LaTeX document class
>   size10.clo    2007/10/19 v1.4h Standard LaTeX file (size option)
> luatexbase.sty    2013/05/04 v0.6 Module utilities for LuaTeX
> ifluatex.sty    2010/03/01 v1.3 Provides the ifluatex switch (HO)
>   luatex.sty    2010/03/09 v0.4 LuaTeX basic definition package (HO)
> infwarerr.sty    2010/04/08 v1.3 Providing info/warning/error messages (HO)
>     etex.sty    1998/03/26 v2.0 eTeX basic definition package (PEB)
> luatex-loader.sty    2010/03/09 v0.4 Lua module loader (HO)
> luatexbase-compat.sty    2011/05/24 v0.4 Compatibility tools for LuaTeX
> luatexbase-loader.sty    2013/04/13 v0.5 Lua module loader for LuaTeX
> luatexbase-regs.sty    2011/05/24 v0.4 Registers allocation for LuaTeX
> luatexbase-attr.sty    2011/05/24 v0.4 Attributes allocation for LuaTeX
> luatexbase-cctb.sty    2011/05/24 v0.4 Catcodetable allocation for LuaTeX
> luatexbase-mcb.sty    2013/04/13 v0.5 Callback management for LuaTeX
> luatexbase-modutils.sty    2013/04/13 v0.5 Module utilities for LuaTeX
>  ***********
> 
>  )
> 
> Here is how much of LuaTeX's memory you used:
>  489 strings out of 494761
>  100000,89155 words of node,token memory allocated
>  262 words of node memory still in use:
>    2 hlist, 1 vlist, 1 rule, 2 glue, 39 glue_spec, 2 write nodes
>    avail lists: 2:12,3:1,6:3,7:1,9:1
>  4157 multiletter control sequences out of 65536+600000
>  15 fonts using 431807 bytes
>  32i,1n,23p,161b,36s stack positions out of 5000i,500n,10000p,200000b,100000s
> No pages of output.
> 
> PDF statistics: 0 PDF objects out of 1000 (max. 8388607)
>  0 named destinations out of 1000 (max. 131072)
>  1 words of extra memory for PDF output out of 10000 (max. 10000000)
> 

From Philipp.Gesang at alumni.uni-heidelberg.de  Fri May 10 20:16:18 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 10 May 2013 20:16:18 +0200
Subject: [lltx] luatexbase and module version
In-Reply-To: <518D22F2.6020202@arcor.de>
References: <518D22F2.6020202@arcor.de>
Message-ID: <20130510181618.GA10067@phlegethon>

???<Datum: Friday, 10. May 2013>???<Von: Stephan Hennig>???

> luatexbase-modutils provides means to test if and what version of a
> module is loaded.  I want to test if a certain version of package
> luatexbase-attr is loaded, but the attached code returns nil.

nil signals that there is no entry of this name.

> Alternatively, I could check if a particular feature foo is present via
> 
>   if luatexbase.foo then
> 
> instead, but I wonder why applying the interface provided in
> luatexbase-modutils to package luatexbase shouldn't work.

attr doesn?t currently use the interface since it is loaded
before modutils. But you are correct, the version info of
luatexbase should be accessible; I?ll make a tracker item.

> BTW, as you can see from the log file, package luatexbase-attr from
> luatexbase v0.6 identifies itself as 2011/05/24 v0.4.  I know, there
> have indeed been recent changes to luatexbase-attr.  Is that package
> version and date intentional?

Not all version strings have been updated so far.

Best
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130510/7dd784ec/attachment.bin>

From mailing_list at arcor.de  Sat May 11 00:12:12 2013
From: mailing_list at arcor.de (Stephan Hennig)
Date: Sat, 11 May 2013 00:12:12 +0200
Subject: [lltx] luatexbase and module version
In-Reply-To: <20130510181618.GA10067@phlegethon>
References: <518D22F2.6020202@arcor.de> <20130510181618.GA10067@phlegethon>
Message-ID: <518D70BC.3060806@arcor.de>

Am 10.05.2013 20:16, schrieb Philipp Gesang:

> attr doesn?t currently use the interface since it is loaded
> before modutils.

Will that change in a future version?


> But you are correct, the version info of luatexbase should be
> accessible; I?ll make a tracker item.

Thanks!

Best regards,
Stephan Hennig


From elie.roux at telecom-bretagne.eu  Sat May 11 09:31:59 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Sat, 11 May 2013 09:31:59 +0200
Subject: [lltx] luatexbase and module version
In-Reply-To: <518D22F2.6020202@arcor.de>
References: <518D22F2.6020202@arcor.de>
Message-ID: <518DF3EF.6030601@telecom-bretagne.eu>

Dear Stephan,

> luatexbase-modutils provides means to test if and what version of a
> module is loaded.  I want to test if a certain version of package
> luatexbase-attr is loaded, but the attached code returns nil.

It's true, the luatexbase modules don't use the module functions. I will 
change it very soon.

> Alternatively, I could check if a particular feature foo is present via
>
>    if luatexbase.foo then
>
> instead, but I wonder why applying the interface provided in
> luatexbase-modutils to package luatexbase shouldn't work.

There is no valid reason...

> BTW, as you can see from the log file, package luatexbase-attr from
> luatexbase v0.6 identifies itself as 2011/05/24 v0.4.  I know, there
> have indeed been recent changes to luatexbase-attr.  Is that package
> version and date intentional?

No, this is clearly wrong, my bad...

I'll upload a new version today or tomorrow...

Thank you!
-- 
Elie

From elie.roux at telecom-bretagne.eu  Sat May 11 18:56:53 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Sat, 11 May 2013 18:56:53 +0200
Subject: [lltx] luatexbase and module version
In-Reply-To: <518D22F2.6020202@arcor.de>
References: <518D22F2.6020202@arcor.de>
Message-ID: <518E7855.20902@telecom-bretagne.eu>

Dear Stephan,

Is https://github.com/lualatex/luatexbase/ ok for you? It should appear 
soon on CTAN.

Thank you,
-- 
Elie

From mailing_list at arcor.de  Sat May 11 20:23:53 2013
From: mailing_list at arcor.de (Stephan Hennig)
Date: Sat, 11 May 2013 20:23:53 +0200
Subject: [lltx] luatexbase and module version
In-Reply-To: <518E7855.20902@telecom-bretagne.eu>
References: <518D22F2.6020202@arcor.de> <518E7855.20902@telecom-bretagne.eu>
Message-ID: <518E8CB9.70803@arcor.de>

Dear ?lie,

Am 11.05.2013 18:56, schrieb ?lie Roux:

> Is https://github.com/lualatex/luatexbase/ ok for you?

Yes, thanks for the prompt action!

Best regards,
Stephan Hennig


From mailing_list at arcor.de  Mon May 13 18:29:43 2013
From: mailing_list at arcor.de (Stephan Hennig)
Date: Mon, 13 May 2013 18:29:43 +0200
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <518CB14B.8040005@arcor.de>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
 <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
 <20130501103849.GA31270@phlegethon> <518CB14B.8040005@arcor.de>
Message-ID: <519114F7.8040302@arcor.de>

Am 10.05.2013 10:35, schrieb Stephan Hennig:

> I've a similar problem using Latin Modern Mono (sorry, LaTeX only):
> 
> \listfiles
> \documentclass{minimal}
> \usepackage{fontspec}
> \begin{document}
> \ttfamily
> \bfseries
> \end{document}

The problem is still present after today's update of luaotfload.  New
log file attached.

Best regards,
Stephan Hennig


> This is LuaTeX, Version beta-0.76.0-2013050715 (rev 4627)  (format=lualatex 2013.5.8)  13 MAY 2013 09:46
>  restricted \write18 enabled.
> **test-2013
> (./test-2013.tex
> LaTeX2e <2011/06/27>
> LuaTeX adaptation of babel <v3.8m-luatex-1.5> and hyphenation patterns for engli
> sh, dumylang, nohyphenation, loaded.
> (d:/texlive/2013/texmf-dist/tex/latex/base/minimal.cls
> Document Class: minimal 2001/05/25 Standard LaTeX minimal class
> ) (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec.sty
> Package: fontspec 2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/expl3.sty
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3names.sty
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3bootstrap.sty
> Package: l3bootstrap 2013/01/08 v4420 L3 Experimental bootstrap code
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/luatex.sty
> Package: luatex 2010/03/09 v0.4 LuaTeX basic definition package (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/infwarerr.sty
> Package: infwarerr 2010/04/08 v1.3 Providing info/warning/error messages (HO)
> )
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ifluatex.sty
> Package: ifluatex 2010/03/01 v1.3 Provides the ifluatex switch (HO)
> Package ifluatex Info: LuaTeX detected.
> )
> (d:/texlive/2013/texmf-dist/tex/latex/etex-pkg/etex.sty
> Package: etex 1998/03/26 v2.0 eTeX basic definition package (PEB)
> \et at xins=\count79
> )
> \LuT at AllocAttribute=\count277
> \LuT at AllocCatcodeTable=\count278
> \CatcodeTableStack=\count279
> \CatcodeTableIniTeX=\catcodetable1
> \CatcodeTableString=\catcodetable3
> \CatcodeTableOther=\catcodetable5
> \CatcodeTableLaTeX=\catcodetable7
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/luatex-loader.sty
> Package: luatex-loader 2010/03/09 v0.4 Lua module loader (HO)
> 
> (d:/texlive/2013/texmf-dist/scripts/oberdiek/oberdiek.luatex.lua)))
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/pdftexcmds.sty
> Package: pdftexcmds 2011/11/29 v0.20 Utility functions of pdfTeX for LuaTeX (HO)
> 
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ltxcmds.sty
> Package: ltxcmds 2011/11/09 v1.22 LaTeX kernel commands for general use (HO)
> )
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/ifpdf.sty
> Package: ifpdf 2011/01/30 v2.3 Provides the ifpdf switch (HO)
> Package ifpdf Info: pdfTeX in PDF mode is detected.
> )
> Package pdftexcmds Info: \pdf at primitive is available.
> Package pdftexcmds Info: \pdf at ifprimitive is available.
> Package pdftexcmds Info: \pdfdraftmode found.
> \pdftexcmds at toks=\toks14
> ))
> Package: l3names 2012/12/07 v4346 L3 Namespace for primitives
> )
> Package: expl3 2013/03/14 v4469 L3 Experimental code bundle wrapper
> 
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3basics.sty
> Package: l3basics 2013/01/10 v4428 L3 Basic definitions
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3expan.sty
> Package: l3expan 2013/02/03 v4458 L3 Argument expansion
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3tl.sty
> Package: l3tl 2013/01/08 v4415 L3 Token lists
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3seq.sty
> Package: l3seq 2013/01/12 v4434 L3 Sequences and stacks
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3int.sty
> Package: l3int 2013/01/13 v4444 L3 Integers
> \c_max_int=\count280
> \l_tmpa_int=\count281
> \l_tmpb_int=\count282
> \g_tmpa_int=\count283
> \g_tmpb_int=\count284
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3quark.sty
> Package: l3quark 2012/11/04 v4268 L3 Quarks
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3prg.sty
> Package: l3prg 2013/02/13 v4459 L3 Control structures
> \g__prg_map_int=\count285
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3clist.sty
> Package: l3clist 2013/01/08 v4414 L3 Comma separated lists
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3token.sty
> Package: l3token 2013/01/10 v4428 L3 Experimental token manipulation
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3prop.sty
> Package: l3prop 2013/01/09 v4423 L3 Property lists
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3msg.sty
> Package: l3msg 2013/01/08 v4412 L3 Messages
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3file.sty
> Package: l3file 2013/01/14 v4446 L3 File and I/O operations
> \l_iow_line_count_int=\count286
> \l__iow_target_count_int=\count287
> \l__iow_current_line_int=\count288
> \l__iow_current_word_int=\count289
> \l__iow_current_indentation_int=\count290
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3skip.sty
> Package: l3skip 2013/01/13 v4444 L3 Dimensions and skips
> \c_zero_dim=\dimen256
> \c_max_dim=\dimen257
> \l_tmpa_dim=\dimen258
> \l_tmpb_dim=\dimen259
> \g_tmpa_dim=\dimen260
> \g_tmpb_dim=\dimen261
> \c_zero_skip=\skip256
> \c_max_skip=\skip257
> \l_tmpa_skip=\skip258
> \l_tmpb_skip=\skip259
> \g_tmpa_skip=\skip260
> \g_tmpb_skip=\skip261
> \c_zero_muskip=\muskip10
> \c_max_muskip=\muskip11
> \l_tmpa_muskip=\muskip12
> \l_tmpb_muskip=\muskip13
> \g_tmpa_muskip=\muskip14
> \g_tmpb_muskip=\muskip15
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3keys.sty
> Package: l3keys 2013/02/24 v4461 L3 Experimental key-value interfaces
> \g__keyval_level_int=\count291
> \l_keys_choice_int=\count292
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3fp.sty
> Package: l3fp 2013/01/19 v4449 L3 Floating points
> \c__fp_leading_shift_int=\count293
> \c__fp_middle_shift_int=\count294
> \c__fp_trailing_shift_int=\count295
> \c__fp_big_leading_shift_int=\count296
> \c__fp_big_middle_shift_int=\count297
> \c__fp_big_trailing_shift_int=\count298
> \c__fp_Bigg_leading_shift_int=\count299
> \c__fp_Bigg_middle_shift_int=\count300
> \c__fp_Bigg_trailing_shift_int=\count301
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3box.sty
> Package: l3box 2013/01/08 v4411 L3 Experimental boxes
> \c_empty_box=\box256
> \l_tmpa_box=\box257
> \l_tmpb_box=\box258
> \g_tmpa_box=\box259
> \g_tmpb_box=\box260
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3coffins.sty
> Package: l3coffins 2012/09/09 v4212 L3 Coffin code layer
> \l__coffin_internal_box=\box261
> \l__coffin_internal_dim=\dimen262
> \l__coffin_offset_x_dim=\dimen263
> \l__coffin_offset_y_dim=\dimen264
> \l__coffin_x_dim=\dimen265
> \l__coffin_y_dim=\dimen266
> \l__coffin_x_prime_dim=\dimen267
> \l__coffin_y_prime_dim=\dimen268
> \c_empty_coffin=\box262
> \l__coffin_aligned_coffin=\box263
> \l__coffin_aligned_internal_coffin=\box264
> \l_tmpa_coffin=\box265
> \l_tmpb_coffin=\box266
> \l__coffin_display_coffin=\box267
> \l__coffin_display_coord_coffin=\box268
> \l__coffin_display_pole_coffin=\box269
> \l__coffin_display_offset_dim=\dimen269
> \l__coffin_display_x_dim=\dimen270
> \l__coffin_display_y_dim=\dimen271
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3color.sty
> Package: l3color 2012/08/29 v4156 L3 Experimental color support
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3luatex.sty
> Package: l3luatex 2012/08/03 v4049 L3 Experimental LuaTeX-specific functions
> \g__cctab_allocate_int=\count302
> \g__cctab_stack_int=\count303
> \c_code_cctab=\catcodetable9
> )
> (d:/texlive/2013/texmf-dist/tex/latex/l3kernel/l3candidates.sty
> Package: l3candidates 2013/03/14 v4468 L3 Experimental additions to l3kernel
> \l__box_top_dim=\dimen272
> \l__box_bottom_dim=\dimen273
> \l__box_left_dim=\dimen274
> \l__box_right_dim=\dimen275
> \l__box_top_new_dim=\dimen276
> \l__box_bottom_new_dim=\dimen277
> \l__box_left_new_dim=\dimen278
> \l__box_right_new_dim=\dimen279
> \l__box_internal_box=\box270
> \l__coffin_bounding_shift_dim=\dimen280
> \l__coffin_left_corner_dim=\dimen281
> \l__coffin_right_corner_dim=\dimen282
> \l__coffin_bottom_corner_dim=\dimen283
> \l__coffin_top_corner_dim=\dimen284
> \l__coffin_scaled_total_height_dim=\dimen285
> \l__coffin_scaled_width_dim=\dimen286
> ))
> (d:/texlive/2013/texmf-dist/tex/latex/l3packages/xparse/xparse.sty
> Package: xparse 2013/03/12 v4467 L3 Experimental document command parser
> \l__xparse_current_arg_int=\count304
> \l__xparse_m_args_int=\count305
> \l__xparse_mandatory_args_int=\count306
> \l__xparse_processor_int=\count307
> \l__xparse_v_nesting_int=\count308
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload.sty
> Package: luaotfload 2013/05/10 v2.2 OpenType layout system
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase.sty
> Package: luatexbase 2013/05/11 v0.6 Resource management for the LuaTeX macro pro
> grammer
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-compat.sty
> Package: luatexbase-compat 2011/05/24 v0.4 Compatibility tools for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-modutils.sty
> Package: luatexbase-modutils 2013/05/11 v0.6 Module utilities for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-loader.sty
> Package: luatexbase-loader 2013/05/11 v0.6 Lua module loader for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase.loader.lua))
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/modutils.lua)
> Lua module: luatexbase-modutils 2013/05/11 0.6 Module utilities for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-regs.sty
> Package: luatexbase-regs 2011/05/24 v0.4 Registers allocation for LuaTeX
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-attr.sty
> Package: luatexbase-attr 2013/05/11 v0.6 Attributes allocation for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/attr.lua)
> Lua module: luatexbase-attr 2013/05/11 0.6 Attributes allocation for LuaTeX
> \lltxb at attr@unsetvalue=\count309
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-cctb.sty
> Package: luatexbase-cctb 2013/05/11 v0.6 Catcodetable allocation for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/cctb.lua)
> Lua module: luatexbase-cctb 2013/05/11 0.6 Catcodetable allocation for LuaTeX
> \lltxb at catcodetable@alloc=\count310
> \CatcodeTableStack=\count311
> \CatcodeTableIniTeX=\luatexcatcodetable1
> \CatcodeTableString=\luatexcatcodetable3
> \CatcodeTableOther=\luatexcatcodetable5
> \CatcodeTableLaTeX=\luatexcatcodetable7
> \CatcodeTableLaTeXAtLetter=\luatexcatcodetable9
> \CatcodeTableExpl=\luatexcatcodetable11
> )
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/luatexbase-mcb.sty
> Package: luatexbase-mcb 2013/05/11 v0.6 Callback management for LuaTeX
> 
> (d:/texlive/2013/texmf-dist/tex/luatex/luatexbase/mcb.lua)
> Lua module: luatexbase-mcb 2013/05/11 0.6 register several functions in a callba
> ck
> ))
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload.lua)
> Lua module: luaotfload 2013/04/29 2.2 OpenType layout system.
> luaotfload: push namespace for font loader
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-merged.lua)(using w
> rite cache: d:/texlive/2013/texmf-var/luatex-cache/generic)(using read cache: d:
> /texlive/2013/texmf-var/luatex-cache/generic c:/Users/Stephan/.texlive2013/texmf
> -var/luatex-cache/generic)
> luatexbase-attr: luatexbase.attributes["luaotfload at kernpair"] = 1
> luatexbase-attr: luatexbase.attributes["luaotfload at ligacomp"] = 2
> luatexbase-attr: luatexbase.attributes["luaotfload at markbase"] = 3
> luatexbase-attr: luatexbase.attributes["luaotfload at markmark"] = 4
> luatexbase-attr: luatexbase.attributes["luaotfload at markdone"] = 5
> luatexbase-attr: luatexbase.attributes["luaotfload at cursbase"] = 6
> luatexbase-attr: luatexbase.attributes["luaotfload at curscurs"] = 7
> luatexbase-attr: luatexbase.attributes["luaotfload at cursdone"] = 8
> luatexbase-attr: luatexbase.attributes["luaotfload at state"] = 9
> luaotfload: ???I am using the merged version of 'luaotfload.lua' here. If
> luaotfload:  you run into problems or experience unexpected behaviour,
> luaotfload:  and if you have ConTeXt installed you can try to delete the
> luaotfload:  file 'luaotfload-font-merged.lua' as I might then use the
> luaotfload:  possibly updated libraries. The merged version is not
> luaotfload:  supported as it is a frozen instance. Problems can be
> luaotfload:  reported to the ConTeXt mailing list.???
> luaotfload: pop namespace from font loader -- non-destructive
> luaotfload: fontloader loaded in 0.034 seconds
> luatexbase-mcb: inserting 'luaotfload.node_processor'
> at position 1 in 'pre_linebreak_filter'
> luatexbase-mcb: inserting 'luaotfload.node_processor'
> at position 1 in 'hpack_filter'
> luatexbase-mcb: inserting 'luaotfload.find_vf_file'
> at position 1 in 'find_vf_file'
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-lib-dir.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-override.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-loaders.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-database.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-colors.lua)
> luatexbase-mcb: creating 'luaotfload.patch_font' type 4
> luatexbase-mcb: resetting callback 'define_font'
> luatexbase-mcb: inserting 'luaotfload.define_font'
> at position 1 in 'define_font'
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-features.lua)
> (d:/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-auxiliary.lua)
> luatexbase-mcb: inserting 'luaotfload.fontdata_fallbacks'
> at position 1 in 'luaotfload.patch_font'
> luatexbase-mcb: inserting 'luaotfload.aux.set_sscale_dimens'
> at position 2 in 'luaotfload.patch_font'
> luatexbase-mcb: inserting 'luaotfload.aux.patch_cambria_domh'
> at position 3 in 'luaotfload.patch_font'
> luatexbase-mcb: inserting 'luaotfload.aux.set_capheight'
> at position 4 in 'luaotfload.patch_font')
> (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec.lua)
> Lua module: fontspec 2009/12/04 2 Advanced font selection for LuaLaTeX.
> luatexbase-mcb: inserting 'fontspec.set_capheight'
> at position 5 in 'luaotfload.patch_font'
> \l_fontspec_script_int=\count312
> \l_fontspec_language_int=\count313
> \l_fontspec_strnum_int=\count314
> \l_fontspec_tmpa_dim=\dimen287
> \l_fontspec_tmpb_dim=\dimen288
> \l_fontspec_tmpc_dim=\dimen289
> Variant \tl_gset:cV already defined; not changing it on line 69
> 
> (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec-patches.sty
> Package: fontspec-patches 2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaT
> eX
> 
> (d:/texlive/2013/texmf-dist/tex/latex/base/fixltx2e.sty
> Package: fixltx2e 2006/09/13 v1.1m fixes to LaTeX
> LaTeX Info: Redefining \em on input line 420.
> )
> LaTeX Info: Redefining \em on input line 22.
> LaTeX Info: Redefining \emph on input line 30.
> LaTeX Info: Redefining \- on input line 33.
> 
> *************************************************
> * LaTeX warning: "xparse/redefine-command"
> * 
> * Redefining document command \oldstylenums with arg. spec. 'm' on line 128.
> *************************************************
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \liningnums with arg. spec. 'm' on line 132.
> .................................................
> ) (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec-luatex.sty
> Package: fontspec-luatex 2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTe
> X
> 
> (d:/texlive/2013/texmf-dist/tex/latex/base/fontenc.sty
> Package: fontenc 2005/09/27 v1.99g Standard LaTeX package
> 
> (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2enc.def
> File: eu2enc.def 2010/05/27 v0.1h Experimental Unicode font encodings
> )
> LaTeX Font Info:    Try loading font information for EU2+lmr on input line 100.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2lmr.fd
> File: eu2lmr.fd 2009/10/30 v1.6 Font defs for Latin Modern
> )
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmroman10
> -regular.luc))
> (d:/texlive/2013/texmf-dist/tex/xelatex/xunicode/xunicode.sty
> File: xunicode.sty 2011/09/09 v0.981 provides access to latin accents and many o
> ther characters in Unicode lower plane
> 
> (d:/texlive/2013/texmf-dist/tex/latex/tipa/t3enc.def
> File: t3enc.def 2001/12/31 T3 encoding
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmromansl
> ant10-regular.luc)
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmroman10
> -italic.luc)
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmroman10
> -bold.luc)
> LaTeX Font Info:    Try loading font information for EU2+lmss on input line 357.
> 
>  (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2lmss.fd
> File: eu2lmss.fd 2009/10/30 v1.6 Font defs for Latin Modern
> )
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmsans10-
> regular.luc))
> \tipaTiiicode=\count315
> \tipasavetokens=\toks15
> \tipachecktokens=\toks16
> 
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/graphicx.sty
> Package: graphicx 1999/02/16 v1.0f Enhanced LaTeX Graphics (DPC,SPQR)
> 
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/keyval.sty
> Package: keyval 1999/03/16 v1.13 key=value parser (DPC)
> \KV at toks@=\toks17
> )
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/graphics.sty
> Package: graphics 2009/02/05 v1.0o Standard LaTeX Graphics (DPC,SPQR)
> 
> (d:/texlive/2013/texmf-dist/tex/latex/graphics/trig.sty
> Package: trig 1999/03/16 v1.09 sin cos tan (DPC)
> )
> (d:/texlive/2013/texmf-dist/tex/latex/latexconfig/graphics.cfg
> File: graphics.cfg 2010/04/23 v1.9 graphics configuration of TeX Live
> )
> Package graphics Info: Driver file: pdftex.def on input line 91.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/pdftex-def/pdftex.def
> File: pdftex.def 2011/05/27 v0.06d Graphics/color for pdfTeX
> \Gread at gobject=\count316
> ))
> \Gin at req@height=\dimen290
> \Gin at req@width=\dimen291
> ))
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \fontspec with arg. spec. 'O{}m' on line 44.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmainfont with arg. spec. 'O{}m' on line 49.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setsansfont with arg. spec. 'O{}m' on line 54.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmonofont with arg. spec. 'O{}m' on line 59.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmathrm with arg. spec. 'O{}m' on line 68.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setboldmathrm with arg. spec. 'O{}m' on line 72.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmathsf with arg. spec. 'O{}m' on line 76.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \setmathtt with arg. spec. 'O{}m' on line 80.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontfamily with arg. spec. 'mO{}m' on line 99.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontface with arg. spec. 'mO{}m' on line 103.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \defaultfontfeatures with arg. spec. 'om' on line
> . 111.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \addfontfeatures with arg. spec. 'm' on line 147.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontfeature with arg. spec. 'mm' on line 159.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newAATfeature with arg. spec. 'mmmm' on line 167.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newICUfeature with arg. spec. 'mmm' on line 175.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \aliasfontfeature with arg. spec. 'mm' on line
> . 204.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \aliasfontfeatureoption with arg. spec. 'mmm' on
> . line 206.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontscript with arg. spec. 'mm' on line 211.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \newfontlanguage with arg. spec. 'mm' on line 238.
> .................................................
> .................................................
> . LaTeX info: "xparse/define-command"
> . 
> . Defining document command \DeclareFontsExtensions with arg. spec. 'm' on
> . line 259.
> .................................................
> Variant \prop_gput:cnV already defined; not changing it on line 586
> Variant \prop_gput:cnx already defined; not changing it on line 587
> \l_fontspec_tmp_int=\count317
> LaTeX Info: Redefining \itshape on input line 2012.
> LaTeX Info: Redefining \slshape on input line 2017.
> LaTeX Info: Redefining \scshape on input line 2022.
> LaTeX Info: Redefining \upshape on input line 2027.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/fontspec/fontspec.cfg))) (./test-2013.aux
> )
> LaTeX Font Info:    Checking defaults for OML/cmm/m/it on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for T1/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OT1/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OMS/cmsy/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for OMX/cmex/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for U/cmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    ... okay on input line 4.
> LaTeX Font Info:    Checking defaults for T3/cmr/m/n on input line 4.
> LaTeX Font Info:    Try loading font information for T3+cmr on input line 4.
>  (d:/texlive/2013/texmf-dist/tex/latex/tipa/t3cmr.fd
> File: t3cmr.fd 2001/12/31 TIPA font definitions
> )
> LaTeX Font Info:    ... okay on input line 4.
> 
> (d:/texlive/2013/texmf-dist/tex/context/base/supp-pdf.mkii
> [Loading MPS to PDF converter (version 2006.09.02).]
> \scratchcounter=\count318
> \scratchdimen=\dimen292
> \scratchbox=\box271
> \nofMPsegments=\count319
> \nofMParguments=\count320
> \everyMPshowfont=\toks18
> \MPscratchCnt=\count321
> \MPscratchDim=\dimen293
> \MPnumerator=\count322
> \makeMPintoPDFobject=\count323
> \everyMPtoPDFconversion=\toks19
> ) (d:/texlive/2013/texmf-dist/tex/latex/oberdiek/epstopdf-base.sty
> Package: epstopdf-base 2010/02/09 v2.5 Base part for package epstopdf
> 
> (d:/texlive/2013/texmf-dist/tex/latex/oberdiek/grfext.sty
> Package: grfext 2010/08/19 v1.1 Manage graphics extensions (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/kvdefinekeys.sty
> Package: kvdefinekeys 2011/04/07 v1.3 Define keys (HO)
> ))
> (d:/texlive/2013/texmf-dist/tex/latex/oberdiek/kvoptions.sty
> Package: kvoptions 2011/06/30 v3.11 Key value format for package options (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/kvsetkeys.sty
> Package: kvsetkeys 2012/04/25 v1.16 Key value parser (HO)
> 
> (d:/texlive/2013/texmf-dist/tex/generic/oberdiek/etexcmds.sty
> Package: etexcmds 2011/02/16 v1.5 Avoid name clashes with e-TeX commands (HO)
> )))
> Package grfext Info: Graphics extension search list:
> (grfext)             [.png,.pdf,.jpg,.mps,.jpeg,.jbig2,.jb2,.PNG,.PDF,.JPG,.JPEG
> ,.JBIG2,.JB2,.eps]
> (grfext)             \AppendGraphicsExtensions on input line 452.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg
> File: epstopdf-sys.cfg 2010/07/13 v1.3 Configuration of (r)epstopdf for TeX Live
> 
> ))
> .................................................
> . fontspec info: "setup-math"
> . 
> . Adjusting the maths setup (use [no-math] to avoid this).
> .................................................
> \symlegacymaths=\mathgroup4
> LaTeX Font Info:    Overwriting symbol font `legacymaths' in version `bold'
> (Font)                  OT1/cmr/m/n --> OT1/cmr/bx/n on input line 4.
> LaTeX Font Info:    Redeclaring math accent \acute on input line 4.
> LaTeX Font Info:    Redeclaring math accent \grave on input line 4.
> LaTeX Font Info:    Redeclaring math accent \ddot on input line 4.
> LaTeX Font Info:    Redeclaring math accent \tilde on input line 4.
> LaTeX Font Info:    Redeclaring math accent \bar on input line 4.
> LaTeX Font Info:    Redeclaring math accent \breve on input line 4.
> LaTeX Font Info:    Redeclaring math accent \check on input line 4.
> LaTeX Font Info:    Redeclaring math accent \hat on input line 4.
> LaTeX Font Info:    Redeclaring math accent \dot on input line 4.
> LaTeX Font Info:    Redeclaring math accent \mathring on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \colon on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Gamma on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Delta on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Theta on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Lambda on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Xi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Pi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Sigma on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Upsilon on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Phi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Psi on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \Omega on input line 4.
> LaTeX Font Info:    Redeclaring math symbol \mathdollar on input line 4.
> LaTeX Font Info:    Redeclaring symbol font `operators' on input line 4.
> LaTeX Font Info:    Encoding `OT1' has changed to `EU2' for symbol font
> (Font)              `operators' in the math version `normal' on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `normal'
> (Font)                  OT1/cmr/m/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Encoding `OT1' has changed to `EU2' for symbol font
> (Font)              `operators' in the math version `bold' on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `bold'
> (Font)                  OT1/cmr/bx/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `normal'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathrm' in version `normal'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/m/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathit' in version `normal'
> (Font)                  OT1/cmr/m/it --> EU2/lmr/m/it on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathbf' in version `normal'
> (Font)                  OT1/cmr/bx/n --> EU2/lmr/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathsf' in version `normal'
> (Font)                  OT1/cmss/m/n --> EU2/lmss/m/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathtt' in version `normal'
> (Font)                  OT1/cmtt/m/n --> EU2/lmtt/m/n on input line 4.
> LaTeX Font Info:    Overwriting symbol font `operators' in version `bold'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathrm' in version `bold'
> (Font)                  EU2/lmr/m/n --> EU2/lmr/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathit' in version `bold'
> (Font)                  OT1/cmr/bx/it --> EU2/lmr/bx/it on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathsf' in version `bold'
> (Font)                  OT1/cmss/bx/n --> EU2/lmss/bx/n on input line 4.
> LaTeX Font Info:    Overwriting math alphabet `\mathtt' in version `bold'
> (Font)                  OT1/cmtt/m/n --> EU2/lmtt/bx/n on input line 4.
> LaTeX Font Info:    Try loading font information for EU2+lmtt on input line 5.
> 
> (d:/texlive/2013/texmf-dist/tex/latex/euenc/eu2lmtt.fd
> File: eu2lmtt.fd 2009/10/30 v1.6 Font defs for Latin Modern
> )
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmmono10-
> regular.luc)
> LaTeX Font Info:    Font shape `EU2/lmtt/bx/n' in size <10> not available
> (Font)              Font shape `EU2/lmtt/b/n' tried instead on input line 6.
> luaotfload | load: auto-selecting default features for script: latn
> luaotfload | load: no defaults for script ???latn???, falling back to ???dflt
> ???(load luc: d:/texlive/2013/texmf-var/luatex-cache/generic/fonts/otf/lmmonolt1
> 0-bold.luc)
> luaotfload | load: auto-selecting default features for script: dflt
> luaotfload | db: reload initiated; reason: ???unresolved font name: ???d??????
> luaotfload | db: reload initiated; reason: ???unresolved font name: ???d??????
> luaotfload | db: Font names database saved
> fonts : font with asked name 'd' is not found using lookup 'anon'
> fonts : unknown font 'd', loading aborted
> ! Font \EU2/lmtt/b/n/10=d:/texlive/2013/texmf-dist/fonts/opentype/public/lm/lmmo
> nolt10-bold.otf not loadable: metric data not found or bad.
> <to be read again> 
> \relax 
> l.6 \bfseries
>            
> ? 
> (./test-2013.aux)
> 
>  *File List*
>  minimal.cls    2001/05/25 Standard LaTeX minimal class
> fontspec.sty    2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
>    expl3.sty    2013/03/14 v4469 L3 Experimental code bundle wrapper
>  l3names.sty    2012/12/07 v4346 L3 Namespace for primitives
> l3bootstrap.sty    2013/01/08 v4420 L3 Experimental bootstrap code
>   luatex.sty    2010/03/09 v0.4 LuaTeX basic definition package (HO)
> infwarerr.sty    2010/04/08 v1.3 Providing info/warning/error messages (HO)
> ifluatex.sty    2010/03/01 v1.3 Provides the ifluatex switch (HO)
>     etex.sty    1998/03/26 v2.0 eTeX basic definition package (PEB)
> luatex-loader.sty    2010/03/09 v0.4 Lua module loader (HO)
> pdftexcmds.sty    2011/11/29 v0.20 Utility functions of pdfTeX for LuaTeX (HO)
>  ltxcmds.sty    2011/11/09 v1.22 LaTeX kernel commands for general use (HO)
>    ifpdf.sty    2011/01/30 v2.3 Provides the ifpdf switch (HO)
> l3basics.sty    2013/01/10 v4428 L3 Basic definitions
>  l3expan.sty    2013/02/03 v4458 L3 Argument expansion
>     l3tl.sty    2013/01/08 v4415 L3 Token lists
>    l3seq.sty    2013/01/12 v4434 L3 Sequences and stacks
>    l3int.sty    2013/01/13 v4444 L3 Integers
>  l3quark.sty    2012/11/04 v4268 L3 Quarks
>    l3prg.sty    2013/02/13 v4459 L3 Control structures
>  l3clist.sty    2013/01/08 v4414 L3 Comma separated lists
>  l3token.sty    2013/01/10 v4428 L3 Experimental token manipulation
>   l3prop.sty    2013/01/09 v4423 L3 Property lists
>    l3msg.sty    2013/01/08 v4412 L3 Messages
>   l3file.sty    2013/01/14 v4446 L3 File and I/O operations
>   l3skip.sty    2013/01/13 v4444 L3 Dimensions and skips
>   l3keys.sty    2013/02/24 v4461 L3 Experimental key-value interfaces
>     l3fp.sty    2013/01/19 v4449 L3 Floating points
>    l3box.sty    2013/01/08 v4411 L3 Experimental boxes
> l3coffins.sty    2012/09/09 v4212 L3 Coffin code layer
>  l3color.sty    2012/08/29 v4156 L3 Experimental color support
> l3luatex.sty    2012/08/03 v4049 L3 Experimental LuaTeX-specific functions
> l3candidates.sty    2013/03/14 v4468 L3 Experimental additions to l3kernel
>   xparse.sty    2013/03/12 v4467 L3 Experimental document command parser
> luaotfload.sty    2013/05/10 v2.2 OpenType layout system
> luatexbase.sty    2013/05/11 v0.6 Resource management for the LuaTeX macro progr
> ammer
> luatexbase-compat.sty    2011/05/24 v0.4 Compatibility tools for LuaTeX
> luatexbase-modutils.sty    2013/05/11 v0.6 Module utilities for LuaTeX
> luatexbase-loader.sty    2013/05/11 v0.6 Lua module loader for LuaTeX
> luatexbase-regs.sty    2011/05/24 v0.4 Registers allocation for LuaTeX
> luatexbase-attr.sty    2013/05/11 v0.6 Attributes allocation for LuaTeX
> luatexbase-cctb.sty    2013/05/11 v0.6 Catcodetable allocation for LuaTeX
> luatexbase-mcb.sty    2013/05/11 v0.6 Callback management for LuaTeX
> fontspec-patches.sty    2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
> 
> fixltx2e.sty    2006/09/13 v1.1m fixes to LaTeX
> fontspec-luatex.sty    2013/03/16 v2.3a Font selection for XeLaTeX and LuaLaTeX
>  fontenc.sty
>   eu2enc.def    2010/05/27 v0.1h Experimental Unicode font encodings
>   eu2lmr.fd    2009/10/30 v1.6 Font defs for Latin Modern
> xunicode.sty    2011/09/09 v0.981 provides access to latin accents and many othe
> r characters in Unicode lower plane
>  eu2lmss.fd    2009/10/30 v1.6 Font defs for Latin Modern
> graphicx.sty    1999/02/16 v1.0f Enhanced LaTeX Graphics (DPC,SPQR)
>   keyval.sty    1999/03/16 v1.13 key=value parser (DPC)
> graphics.sty    2009/02/05 v1.0o Standard LaTeX Graphics (DPC,SPQR)
>     trig.sty    1999/03/16 v1.09 sin cos tan (DPC)
> graphics.cfg    2010/04/23 v1.9 graphics configuration of TeX Live
>   pdftex.def    2011/05/27 v0.06d Graphics/color for pdfTeX
> fontspec.cfg
>    t3cmr.fd    2001/12/31 TIPA font definitions
> supp-pdf.mkii
> epstopdf-base.sty    2010/02/09 v2.5 Base part for package epstopdf
>   grfext.sty    2010/08/19 v1.1 Manage graphics extensions (HO)
> kvdefinekeys.sty    2011/04/07 v1.3 Define keys (HO)
> kvoptions.sty    2011/06/30 v3.11 Key value format for package options (HO)
> kvsetkeys.sty    2012/04/25 v1.16 Key value parser (HO)
> etexcmds.sty    2011/02/16 v1.5 Avoid name clashes with e-TeX commands (HO)
> epstopdf-sys.cfg    2010/07/13 v1.3 Configuration of (r)epstopdf for TeX Live
>  eu2lmtt.fd    2009/10/30 v1.6 Font defs for Latin Modern
>  ***********
> 
>  )
> 
> Here is how much of LuaTeX's memory you used:
>  14935 strings out of 494761
>  100000,383344 words of node,token memory allocated
>  264 words of node memory still in use:
>    3 hlist, 1 vlist, 1 rule, 2 glue, 3 attribute, 35 glue_spec, 3 attribute_list
> , 1 write nodes
>    avail lists: 2:8,3:1,6:3,7:1,9:1
>  18211 multiletter control sequences out of 65536+600000
>  21 fonts using 1018987 bytes
>  48i,1n,30p,362b,85s stack positions out of 5000i,500n,10000p,200000b,100000s
> No pages of output.
> 
> PDF statistics: 0 PDF objects out of 1000 (max. 8388607)
>  0 named destinations out of 1000 (max. 131072)
>  1 words of extra memory for PDF output out of 10000 (max. 10000000)
> 


From Philipp.Gesang at alumni.uni-heidelberg.de  Mon May 13 20:06:40 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Mon, 13 May 2013 20:06:40 +0200
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <519114F7.8040302@arcor.de>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
 <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
 <20130501103849.GA31270@phlegethon> <518CB14B.8040005@arcor.de>
 <519114F7.8040302@arcor.de>
Message-ID: <20130513180640.GA23446@phlegethon>

Hi Stephan,

thanks for the report.

???<Datum: Monday, 13. May 2013>???<Von: Stephan Hennig>???

> > I've a similar problem using Latin Modern Mono (sorry, LaTeX only):
> > 
> > \listfiles
> > \documentclass{minimal}
> > \usepackage{fontspec}
> > \begin{document}
> > \ttfamily
> > \bfseries
> > \end{document}
> 
> The problem is still present after today's update of luaotfload.  New
> log file attached.
 
<snip />

> > luaotfload | load: auto-selecting default features for script: dflt
> > luaotfload | db: reload initiated; reason: ???unresolved font name: ???d??????
> > luaotfload | db: reload initiated; reason: ???unresolved font name: ???d??????
> > luaotfload | db: Font names database saved
> > fonts : font with asked name 'd' is not found using lookup 'anon'
> > fonts : unknown font 'd', loading aborted
> > ! Font \EU2/lmtt/b/n/10=d:/texlive/2013/texmf-dist/fonts/opentype/public/lm/lmmo
> > nolt10-bold.otf not loadable: metric data not found or bad.

Something defines a font by an absolute path, but uses the wrong
lookup for this. As absolute paths contain a ?:? on Windows, this
confuses the parser which in turn tries to load the font ?d?.

Could you apply below patch to luaotfload-features.lua and report
back?

Thanks
Philipp




diff --git a/luaotfload-features.lua b/luaotfload-features.lua
index e732ed9..af4ef67 100644
--- a/luaotfload-features.lua
+++ b/luaotfload-features.lua
@@ -980,9 +980,8 @@ local subfont           = P"(" * Cg((1 - S"()")^1, "sub") * P")"
 --- top-level rules ---------------------------------------------------
 --- \font\foo=<specification>:<features>
 local features          = Cg(feature_list, "features")
-local specification     = (prefixed + unprefixed)
-                        * subfont^-1
-                        * modifier_list^-1
+local specification     = prefixed * subfont^-1 * modifier_list^-1
+                        + unprefixed * modifier_list^-1 * P(-1)
 local font_request      = Ct(path_lookup   * (colon^-1 * features)^-1
                            + specification * (colon    * features)^-1)
 
@@ -1053,7 +1052,7 @@ local handle_request = function (specification)
             specification.specification)
         report("log", 0, "load", "use square bracket syntax or consult the documentation.")
         specification.name      = specification.specification
-        specification.lookup    = "file"
+        specification.lookup    = "path"
         return specification
     end
     local lookup, name = select_lookup(request)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130513/4d68cbe6/attachment.bin>

From mailing_list at arcor.de  Mon May 13 22:45:14 2013
From: mailing_list at arcor.de (Stephan Hennig)
Date: Mon, 13 May 2013 22:45:14 +0200
Subject: [lltx] luaotfload refuses to load bold font of some font family
In-Reply-To: <20130513180640.GA23446@phlegethon>
References: <CAFzmAm2UvgTBhOWH5Ssu5_82VDC5Nvz5eCwebV25nTWP5=JkBg@mail.gmail.com>
 <20130501075939.GA30722@phlegethon>
 <CAFzmAm1rj66_AD-=q88MZ74-Mc-miB3qb-yN8=3nz=4ASfE=5A@mail.gmail.com>
 <20130501103849.GA31270@phlegethon> <518CB14B.8040005@arcor.de>
 <519114F7.8040302@arcor.de> <20130513180640.GA23446@phlegethon>
Message-ID: <519150DA.9090702@arcor.de>

Am 13.05.2013 20:06, schrieb Philipp Gesang:

> Could you apply below patch to luaotfload-features.lua and report
> back?

Works fine with the patch.  Thanks!

Best regards,
Stephan Hennig


From news3 at nililand.de  Wed May 15 11:16:45 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Wed, 15 May 2013 11:16:45 +0200
Subject: [lltx] Problems with fontspec and ligatures
Message-ID: <qzory9stwpjv$.dlg@nililand.de>

I downloaded today a new luaotfload from the link mentioned in issue
72 as I had this problem too:
https://github.com/lualatex/luaotfload/issues/72

Now if I run this document in a texlive 2013 pretest updated today:

\documentclass{book}
\usepackage{fontspec}
\usepackage{ifluatex}
\begin{document}
\fontspec[Ligatures=NoCommon]{Latin Modern Roman}
off fit fly office baffle

\ifluatex
\font\test="file:lmroman10-regular.otf:mode=node;script=latn;language=DFLT;+liga;"
\test off fit fly office baffle

\font\test="file:lmroman10-regular.otf:mode=node;script=latn;language=DFLT;-liga;"
\test off fit fly office baffle

\font\test="file:lmroman10-regular.otf:mode=node;-liga;"
\test off fit fly office baffle
\fi
\end{document}

I get

Font LatinModernRoman does not contain any OpenType `Script'
information.
...............................................

fontspec warning: "icu-feature-not-exist-in-font"
* 
* OpenType
feature 'Ligatures=NoCommon' (-liga) not available for font
*
'LatinModernRoman' with script '' and language ''.


And the ligatures are not disabled (NoCommon doesn't work).

With xelatex there is no problem. 

Also calling the fonts with the low-level commands works as
expected. So imho it is a fontspec problem ;-).


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Wed May 15 11:46:34 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Wed, 15 May 2013 11:46:34 +0200
Subject: [lltx] Problems with fontspec and ligatures
In-Reply-To: <qzory9stwpjv$.dlg@nililand.de>
References: <qzory9stwpjv$.dlg@nililand.de>
Message-ID: <20130515094610.GA5498@phlegethon>

???<Datum: Wednesday, 15. May 2013>???<Von: Ulrike Fischer>???

> I downloaded today a new luaotfload from the link mentioned in issue
> 72 as I had this problem too:
> https://github.com/lualatex/luaotfload/issues/72
> 
> Now if I run this document in a texlive 2013 pretest updated today:
> 
> \documentclass{book}
> \usepackage{fontspec}
> \usepackage{ifluatex}
> \begin{document}
> \fontspec[Ligatures=NoCommon]{Latin Modern Roman}
> off fit fly office baffle
> 
> \ifluatex
> \font\test="file:lmroman10-regular.otf:mode=node;script=latn;language=DFLT;+liga;"
> \test off fit fly office baffle
> 
> \font\test="file:lmroman10-regular.otf:mode=node;script=latn;language=DFLT;-liga;"
> \test off fit fly office baffle
> 
> \font\test="file:lmroman10-regular.otf:mode=node;-liga;"
> \test off fit fly office baffle
> \fi
> \end{document}
> 
> I get
> 
> Font LatinModernRoman does not contain any OpenType `Script'
> information.
> ...............................................
> 
> fontspec warning: "icu-feature-not-exist-in-font"
> * 
> * OpenType
> feature 'Ligatures=NoCommon' (-liga) not available for font
> *
> 'LatinModernRoman' with script '' and language ''.
> 
> 
> And the ligatures are not disabled (NoCommon doesn't work).
> 
> With xelatex there is no problem. 
> 
> Also calling the fonts with the low-level commands works as
> expected. So imho it is a fontspec problem ;-).

Indeed. But we have fallbacks, one of which was disabled because
of an unrelated issue. Can you test this file and report back:

    https://raw.github.com/phi-gamma/luaotfload/master/luaotfload-auxiliary.lua

Thank you
Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130515/8b461584/attachment.bin>

From news3 at nililand.de  Wed May 15 11:57:13 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Wed, 15 May 2013 11:57:13 +0200
Subject: [lltx] Problems with fontspec and ligatures
References: <qzory9stwpjv$.dlg@nililand.de> <20130515094610.GA5498@phlegethon>
Message-ID: <1kf9w1uxk8lqj.dlg@nililand.de>

Am Wed, 15 May 2013 11:46:34 +0200 schrieb Philipp Gesang:


>> And the ligatures are not disabled (NoCommon doesn't work).

>> Also calling the fonts with the low-level commands works as
>> expected. So imho it is a fontspec problem ;-).
> 
> Indeed. But we have fallbacks, one of which was disabled because
> of an unrelated issue. Can you test this file and report back:
 
>     https://raw.github.com/phi-gamma/luaotfload/master/luaotfload-auxiliary.lua

This work. Now fontspec reports

fontspec: script 'latn' exists in font 'LMRoman10-Regular'
fontspec:
feature '-liga' for language 'DFLT' and script 'latn' exists in font
'
LMRoman10-Regular'

(I tried also to enable Ligatures and also with DejaVu Serif and it
work fine too). 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From news3 at nililand.de  Thu May 16 11:25:57 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 16 May 2013 11:25:57 +0200
Subject: [lltx] Conflict with Miktex and the new oberdiek.luatex.lua
Message-ID: <1hmg8renn4gzu$.dlg@nililand.de>

I'm currently trying to do some tests with miktex and the various
new versions of lua-packages to identify potential problems. 

Do this extend I attached  texmf-dist of a current TL2013 pretest to
my miktex system (I love the easy way to attach and remove roots in
miktex ;-)). 

A small document using fontspec then leads to an error. The older
luatex of miktex stumbles over this line in oberdiek.luatex.lua

table.insert(package.searchers, kpse_module_loader)

There is no problem if I change the line to:

table.insert(package.loaders, kpse_module_loader) 

Could some luatex version check been added to this file?


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From elie.roux at telecom-bretagne.eu  Thu May 16 12:16:35 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Thu, 16 May 2013 12:16:35 +0200
Subject: [lltx] Conflict with Miktex and the new oberdiek.luatex.lua
In-Reply-To: <1hmg8renn4gzu$.dlg@nililand.de>
References: <1hmg8renn4gzu$.dlg@nililand.de>
Message-ID: <5194B203.8080709@telecom-bretagne.eu>

Dear Ulrike,

Sadly, we are not in charge of the oberdiek bundle. We provided a patch 
for it to work in TeXLive 2013 because Heiko was not responding and it 
was a blocking issue for TeXLive 2013 pretest, but this should 
definitely be reported to the author. I don't think it's our or 
TeXLive's responsibility to provide patches for oberdiek bundle or for 
MikTeX... Anyway, you can ask Karl to commit a patch in TeXLive's svn 
for MikTeX compatibility, though it sounds a bit weird, it's up to him 
to decide.

We also provided other patches that might not work with MikTeX, one was 
in pdftexcmds.lua and another in hologo.sty.

Thank you,
-- 
Elie

From news3 at nililand.de  Thu May 16 15:14:10 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 16 May 2013 15:14:10 +0200
Subject: [lltx] Conflict with Miktex and the new oberdiek.luatex.lua
References: <1hmg8renn4gzu$.dlg@nililand.de>
 <5194B203.8080709@telecom-bretagne.eu>
Message-ID: <87rp07p2ii0h.dlg@nililand.de>

Am Thu, 16 May 2013 12:16:35 +0200 schrieb ?lie Roux:

> Dear Ulrike,
> 
> Sadly, we are not in charge of the oberdiek bundle. We provided a patch 
> for it to work in TeXLive 2013 because Heiko was not responding and it 
> was a blocking issue for TeXLive 2013 pretest, but this should 
> definitely be reported to the author. I don't think it's our or 
> TeXLive's responsibility to provide patches for oberdiek bundle or for 
> MikTeX...

Sure. But on the other side if you patch a file it doesn't do any
harm to patch it in a way that works with more then one version.
After all it is quite possible that some of the developers will need
to run tests with older binaries. 

> Anyway, you can ask Karl to commit a patch in TeXLive's svn 
> for MikTeX compatibility, though it sounds a bit weird, it's up to him 
> to decide.

I have now added temporarly a test to my version of the file

if tex.luatexversion < 76
 then
 table.insert(package.loaders, kpse_module_loader)
 else
 table.insert(package.searchers, kpse_module_loader)
end

 
> We also provided other patches that might not work with MikTeX, one was 
> in pdftexcmds.lua and another in hologo.sty.

I will keep this in mind in case I run into some error. Until then I
will left them unchanged. 

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From elie.roux at telecom-bretagne.eu  Thu May 16 15:31:20 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Thu, 16 May 2013 15:31:20 +0200
Subject: [lltx] Conflict with Miktex and the new oberdiek.luatex.lua
In-Reply-To: <87rp07p2ii0h.dlg@nililand.de>
References: <1hmg8renn4gzu$.dlg@nililand.de>
 <5194B203.8080709@telecom-bretagne.eu> <87rp07p2ii0h.dlg@nililand.de>
Message-ID: <5194DFA8.9000604@telecom-bretagne.eu>

 >
> Sure. But on the other side if you patch a file it doesn't do any
> harm to patch it in a way that works with more then one version.
> After all it is quite possible that some of the developers will need
> to run tests with older binaries.

Sure. Actually I thought I did this kind of test, but I didn't (maybe I 
sent Karl the wrong version)... Anyway, the other files shouldn't pose 
problems with old binaries, only this one. Maybe your version should be 
uploaded to MikTeX? Also, I was wondering: is what you're doing (taking 
texlive tree with MikTeX binary) something others might do?

By the way, polyglossia won't work for French with LuaTeX < 0.76 
(because of node.end_of_math()).

Thank you,
-- 
Elie

From news3 at nililand.de  Thu May 16 15:56:30 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Thu, 16 May 2013 15:56:30 +0200
Subject: [lltx] Conflict with Miktex and the new oberdiek.luatex.lua
References: <1hmg8renn4gzu$.dlg@nililand.de>
 <5194B203.8080709@telecom-bretagne.eu> <87rp07p2ii0h.dlg@nililand.de>
 <5194DFA8.9000604@telecom-bretagne.eu>
Message-ID: <k5u19feydnwa$.dlg@nililand.de>

Am Thu, 16 May 2013 15:31:20 +0200 schrieb ?lie Roux:

>  >
>> Sure. But on the other side if you patch a file it doesn't do any
>> harm to patch it in a way that works with more then one version.
>> After all it is quite possible that some of the developers will need
>> to run tests with older binaries.
> 
> Sure. Actually I thought I did this kind of test, but I didn't (maybe I 
> sent Karl the wrong version)... Anyway, the other files shouldn't pose 
> problems with old binaries, only this one. Maybe your version should be 
> uploaded to MikTeX? Also, I was wondering: is what you're doing (taking 
> texlive tree with MikTeX binary) something others might do?

Well yes, everyone can easily attach a tree. On the other side
texlive-dist is a very large tree, it will be searched before the
main tree of miktex and miktex will see everything: ini-files,
updmap.cfg etc. So this can affect formats, scripts, documentation,
font maps files ...  

So I don't think it is a good idea to add this tree permantly to
miktex. But for tests it is fine.

But I have other trees with local files which I added to both
systems and use with both systems. This works fine. - But it is much
more confortable to add and remove a tree in miktex then in TeXLive.
I simply call initexmf --register-root=path/to/root and initexmf
--unregister-root=path/to/root.

> By the way, polyglossia won't work for French with LuaTeX < 0.76 
> (because of node.end_of_math()).

As polyglossia until now didn't work for luatex at all I would say
that's not so problematic.

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From cap.sensitive at gmail.com  Thu May 16 23:21:03 2013
From: cap.sensitive at gmail.com (Bill Sun)
Date: Thu, 16 May 2013 14:21:03 -0700
Subject: [lltx] luaotfload v2.2 cannot load system font
Message-ID: <20130516212103.GA9276@Thomas>

Hi,

I updated my texlive 2013 pretest on May 14, and luaotfload was updated
to v2.2 (2013/05/10). After the update, no matter I use fontspec or
luaotfload package in the preamble, lualatex cannot load system font.
Both produce the same error message.

System info:
texlive 2013 pretest, last update on May 16. Archlinux x86_64.

Here's the error message:
    ! LuaTeX error .../texlive/texmf-dist/tex/luatex/luaotfload/luaotfload.lua:85: a
    ttempt to index global 'dir' (a nil value)
    stack traceback:
            .../texlive/texmf-dist/tex/luatex/luaotfload/luaotfload.lua:85: in main chunk
            [C]: in function 'require'
            ...pt/texlive/texmf-dist/tex/luatex/luatexbase/modutils.lua:57: in function 're
    quire_module'
            [string "\directlua "]:1: in main chunk.
    \lltxb at requirelua ...xluaescapestring {#2}" \fi )}

    l.41 \fi

Regards.

From kakuto at fuk.kindai.ac.jp  Sat May 18 03:59:36 2013
From: kakuto at fuk.kindai.ac.jp (Akira Kakuto)
Date: Sat, 18 May 2013 10:59:36 +0900
Subject: [lltx]  luaotfload v2.2 cannot load system font
Message-ID: <EF83511F7DEB4168BC5A5126F18DA427@CJ3001517a>

> I updated my texlive 2013 pretest on May 14, and luaotfload was updated
> to v2.2 (2013/05/10). After the update, no matter I use fontspec or
> luaotfload package in the preamble, lualatex cannot load system font.
> Both produce the same error message.

Try the attached test.diff.
Pardon me if the test.diff is wrong.

Best regards,
Akira KAKUTO
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.diff
Type: application/octet-stream
Size: 931 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130518/d8afa7b2/attachment.obj>

From kakuto at fuk.kindai.ac.jp  Sat May 18 04:17:24 2013
From: kakuto at fuk.kindai.ac.jp (Akira Kakuto)
Date: Sat, 18 May 2013 11:17:24 +0900
Subject: [lltx] luaotfload v2.2 cannot load system font
Message-ID: <FFC6EBF5510D4FF69990891B615D6817@CJ3001517a>

Hi,

> Try the attached test.diff.
> Pardon me if the test.diff is wrong.

Please ignore the test.diff, which is apparently wrong.
Sorry for the noise.

Best regards,
Akira KAKUTO


From Philipp.Gesang at alumni.uni-heidelberg.de  Sat May 18 09:08:09 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sat, 18 May 2013 09:08:09 +0200
Subject: [lltx] luaotfload v2.2 cannot load system font
In-Reply-To: <EF83511F7DEB4168BC5A5126F18DA427@CJ3001517a>
References: <EF83511F7DEB4168BC5A5126F18DA427@CJ3001517a>
Message-ID: <20130518070809.GA29910@phlegethon>

Dear Akira, others,

???<date: 2013-05-18, Saturday>???<from: Akira Kakuto>???

> >I updated my texlive 2013 pretest on May 14, and luaotfload was updated
> >to v2.2 (2013/05/10). After the update, no matter I use fontspec or
> >luaotfload package in the preamble, lualatex cannot load system font.
> >Both produce the same error message.
> 
> Try the attached test.diff.
> Pardon me if the test.diff is wrong.
> 
> Best regards,
> Akira KAKUTO

Hans agreed to have the fontloader create the cache directory if
it doesn?t exist. The code will be part of today?s upload.

Best regards
Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130518/6b3cc8ca/attachment.bin>

From herbs at wideopenwest.com  Mon May 20 14:07:40 2013
From: herbs at wideopenwest.com (Herbert Schulz)
Date: Mon, 20 May 2013 07:07:40 -0500
Subject: [lltx] luaotfload bug
Message-ID: <6109525B-15B2-4C65-AE5A-46835456DF06@wideopenwest.com>

Howdy,

Yesterday I reported a bug where luaotfload threw an error if TEXMFHOME was already created on the mactex list. Karl suggested that I should have reported the problem to this list and said that the problem had been corrected.

After today's update luaotfload no longer throws an error and crashes but rather presents the message

(/usr/local/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-merged.lua)
quiting: fix your writable cache pathFailure to make 'lucidaot.pdf'

instead.

This is still incorrect behavior compared to previous years and the behavior of pdftex, e.g., if it needs to build a font from mf source on the fly. The correct behavior is to create TEXMFHOME on the fly.

Please reply to me directly since I'm not a member of the list.

Good Luck,

Herb Schulz
(herbs at wideopenwest dot com)





From Philipp.Gesang at alumni.uni-heidelberg.de  Mon May 20 17:54:13 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Mon, 20 May 2013 17:54:13 +0200
Subject: [lltx] luaotfload bug
In-Reply-To: <6109525B-15B2-4C65-AE5A-46835456DF06@wideopenwest.com>
References: <6109525B-15B2-4C65-AE5A-46835456DF06@wideopenwest.com>
Message-ID: <20130520155413.GA30122@phlegethon>

???<date: 2013-05-20, Monday>???<from: Herbert Schulz>???

> Howdy,
> 
> Yesterday I reported a bug where luaotfload threw an error if TEXMFHOME was already created on the mactex list. Karl suggested that I should have reported the problem to this list and said that the problem had been corrected.
> 
> After today's update luaotfload no longer throws an error and crashes but rather presents the message
> 
> (/usr/local/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-merged.lua)
> quiting: fix your writable cache pathFailure to make 'lucidaot.pdf'
> 
> instead.
> 
> This is still incorrect behavior compared to previous years and the behavior of pdftex, e.g., if it needs to build a font from mf source on the fly. The correct behavior is to create TEXMFHOME on the fly.
> 
> Please reply to me directly since I'm not a member of the list.

Hi Herbert,

thanks for reporting. This problem was masked on my system
because the cache directories are created when the format is
built. Apparently there?s a thinko in the code that chooses a
writable path; I?ll report it to Hans.

> This is still incorrect behavior compared to previous years and
> the behavior of pdftex, e.g., if it needs to build a font from mf
> source on the fly. The correct behavior is to create TEXMFHOME on
> the fly.

TEXMFHOME isn?t used, at least not directly; the font loader
checks TEXMFCACHE, TEXMFVAR, and VARTEXMF (in this order) and
will (should) pick the first writable one.

Best regards
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130520/b2746d1d/attachment.bin>

From herbs at wideopenwest.com  Mon May 20 18:17:47 2013
From: herbs at wideopenwest.com (Herbert Schulz)
Date: Mon, 20 May 2013 11:17:47 -0500
Subject: [lltx] luaotfload bug
In-Reply-To: <20130520155413.GA30122@phlegethon>
References: <6109525B-15B2-4C65-AE5A-46835456DF06@wideopenwest.com>
 <20130520155413.GA30122@phlegethon>
Message-ID: <DEF61063-FD76-450B-A3BE-1021324349AB@wideopenwest.com>


On May 20, 2013, at 10:54 AM, Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de> wrote:

> ???<date: 2013-05-20, Monday>???<from: Herbert Schulz>???
> 
>> Howdy,
>> 
>> Yesterday I reported a bug where luaotfload threw an error if TEXMFHOME was already created on the mactex list. Karl suggested that I should have reported the problem to this list and said that the problem had been corrected.
>> 
>> After today's update luaotfload no longer throws an error and crashes but rather presents the message
>> 
>> (/usr/local/texlive/2013/texmf-dist/tex/luatex/luaotfload/luaotfload-merged.lua)
>> quiting: fix your writable cache pathFailure to make 'lucidaot.pdf'
>> 
>> instead.
>> 
>> This is still incorrect behavior compared to previous years and the behavior of pdftex, e.g., if it needs to build a font from mf source on the fly. The correct behavior is to create TEXMFHOME on the fly.
>> 
>> Please reply to me directly since I'm not a member of the list.
> 
> Hi Herbert,
> 
> thanks for reporting. This problem was masked on my system
> because the cache directories are created when the format is
> built. Apparently there?s a thinko in the code that chooses a
> writable path; I?ll report it to Hans.
> 
>> This is still incorrect behavior compared to previous years and
>> the behavior of pdftex, e.g., if it needs to build a font from mf
>> source on the fly. The correct behavior is to create TEXMFHOME on
>> the fly.
> 
> TEXMFHOME isn?t used, at least not directly; the font loader
> checks TEXMFCACHE, TEXMFVAR, and VARTEXMF (in this order) and
> will (should) pick the first writable one.
> 
> Best regards
> Philipp
> 


Howdy,

I forgot to Reply All, so I apologize to Philipp for the double post.

Sorry, a typo on my part, it should create any parts of TEXMFVAR (NOT TEXMHOME) that don't already exist. E.g. on the Mac TEXMFVAR is ~/Library/texlive/2013/texmf-var but ~/Library/texlive already exists since I also have TL2012 so 2013/texmf-var needs to be built. For new users the complete path needs to be build. All this should be transparent to the user.

Good Luck,

Herb Schulz
(herbs at wideopenwest dot com)





From bvoisin at icloud.com  Tue May 21 08:57:08 2013
From: bvoisin at icloud.com (Bruno Voisin)
Date: Tue, 21 May 2013 08:57:08 +0200
Subject: [lltx] Possible bug in LuaLaTeX algorithm for equation number
	positioning
Message-ID: <8C2AE71B-31E2-4E2A-ADC9-3D0EE1604FBB@icloud.com>

Hi,

The following creates an equation slightly too long for the equation number to fit on the same line (on a setup with A4 as the default page size).

In LaTeX and XeLaTeX the equation number appears flush right on the next line, but in LuaLaTeX it appears flush left.

I'm not a member of this list, so if you need further info please contact me directly.

Bruno Voisin

\documentclass[12pt]{article}
%
\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{\oddsidemargin}
\setlength{\textwidth}{\paperwidth}
\addtolength{\textwidth}{-2in}
%
\begin{document}
\begin{equation}
  \int_0^y
  \sqrt{y^2-t^2}
  \cos\left(a\sqrt{y^2-t^2}\right)
  \cos(bt)\,\mathrm{d}t =
  \frac{\pi}{2}y^2
  \left[
    \frac{J_1\left(y\sqrt{a^2+b^2}\right)}
         {y\sqrt{a^2+b^2}}-
    \frac{a^2}{a^2+b^2}
    J_2\left(y\sqrt{a^2+b^2}\right)
  \right].
\end{equation}
\end{document}




From reinhard.kotucha at web.de  Fri May 24 01:18:22 2013
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Fri, 24 May 2013 01:18:22 +0200
Subject: [lltx] luaotfload-database.lua
Message-ID: <20894.41918.387569.270899@zaphod.ms25.net>

Hi,
I'm not familiar with the new version of luaotfload at all, but there
is one thing which looks strange in luaotfload-database.lua at a first
glance:

    if os_type == "windows" or os_type == "msdos" then
        --- ms platfom specific stuff
        path_normalize = function (path)
            path = stringgsub(path, '\\', '/')
            path = stringlower(path)
            path = stringgsub(path, '^/cygdrive/(%a)/', '%1:/')
 
I assume that neither Windows nor MS-DOG are aware of /cygdrive.

And as far as Cygwin is concerned, though it's clearly a Unix system,
it makes sense to scan both, the standard Unix font directories
(/usr/[local/]share/fonts) as well as /cygdrive/c/windows/fonts .

It seems that only the latter is supported though Cygwin users expect
that Unix font directories are supported in the first place.

Admittedly, I looked into the code a few minutes ago for the first
time and don't have enough time to investigate further today, but I
think that it can't hurt to mention my observations.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From Philipp.Gesang at alumni.uni-heidelberg.de  Fri May 24 12:21:56 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 24 May 2013 12:21:56 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20894.41918.387569.270899@zaphod.ms25.net>
References: <20894.41918.387569.270899@zaphod.ms25.net>
Message-ID: <20130524102156.GA14084@phlegethon>

Hi Reinhard,

???<Datum: Friday, 24. May 2013>???<Von: Reinhard Kotucha>???

> I'm not familiar with the new version of luaotfload at all, but there
> is one thing which looks strange in luaotfload-database.lua at a first
> glance:
> 
>     if os_type == "windows" or os_type == "msdos" then
>         --- ms platfom specific stuff
>         path_normalize = function (path)
>             path = stringgsub(path, '\\', '/')
>             path = stringlower(path)
>             path = stringgsub(path, '^/cygdrive/(%a)/', '%1:/')
>  
> I assume that neither Windows nor MS-DOG are aware of /cygdrive.
> 
> And as far as Cygwin is concerned, though it's clearly a Unix system,
> it makes sense to scan both, the standard Unix font directories
> (/usr/[local/]share/fonts) as well as /cygdrive/c/windows/fonts .
> 
> It seems that only the latter is supported though Cygwin users expect
> that Unix font directories are supported in the first place.
> 
> Admittedly, I looked into the code a few minutes ago for the first
> time and don't have enough time to investigate further today, but I
> think that it can't hurt to mention my observations.

the section you are referencing has been modified recently:

    https://github.com/lualatex/luaotfload/commit/635541532080e2b86d9cc28b85ad96d88e57b413

Cygwin should now be handled the same way as linux. Could you
check if the changes address your point and report back? The code
should be on CTAN in soon.

Thanks
Philipp


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130524/1b3f098e/attachment.bin>

From reinhard.kotucha at web.de  Sat May 25 06:00:44 2013
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat, 25 May 2013 06:00:44 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20130524102156.GA14084@phlegethon>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
Message-ID: <20896.14188.427800.473796@zaphod.ms25.net>

On 2013-05-24 at 12:21:56 +0200, Philipp Gesang wrote:

 > Hi Reinhard,
 > 
 > ???<Datum: Friday, 24. May 2013>???<Von: Reinhard Kotucha>???
 > 
 > > I'm not familiar with the new version of luaotfload at all, but there
 > > is one thing which looks strange in luaotfload-database.lua at a first
 > > glance:
 > > 
 > >     if os_type == "windows" or os_type == "msdos" then
 > >         --- ms platfom specific stuff
 > >         path_normalize = function (path)
 > >             path = stringgsub(path, '\\', '/')
 > >             path = stringlower(path)
 > >             path = stringgsub(path, '^/cygdrive/(%a)/', '%1:/')
 > >  
 > > I assume that neither Windows nor MS-DOG are aware of /cygdrive.
 > > 
 > > And as far as Cygwin is concerned, though it's clearly a Unix system,
 > > it makes sense to scan both, the standard Unix font directories
 > > (/usr/[local/]share/fonts) as well as /cygdrive/c/windows/fonts .
 > > 
 > > It seems that only the latter is supported though Cygwin users expect
 > > that Unix font directories are supported in the first place.
 > > 
 > > Admittedly, I looked into the code a few minutes ago for the first
 > > time and don't have enough time to investigate further today, but I
 > > think that it can't hurt to mention my observations.
 > 
 > the section you are referencing has been modified recently:
 > 
 >     https://github.com/lualatex/luaotfload/commit/635541532080e2b86d9cc28b85ad96d88e57b413
 > 
 > Cygwin should now be handled the same way as linux. Could you
 > check if the changes address your point and report back? The code
 > should be on CTAN in soon.

Yes, it looks good now.

BTW, there is another thing I'd like to mention:

I've written a program using luaotfload.  This program is called by
another program and runs in the background, i.e. users don't see what
LuaTeX prints to screen.  I develop under Linux but the program is
usually run under Windows.

The first version invoked luaotfload at run time.  It turned out that
the font cache is problematic for many reasons in this application.
Everything has to work out-of-the-box, I can't expect that users
(physicians) are able to fix problems with file permissions or so
themselves and the fact that some system fonts have to be blacklisted
manually is even more problematic.

The current version runs luaotfload (and reads the cache) when the
format file is created.  This solves many problems.  Everything is
extremely fast and the cache isn't used at all (it even doesn't exist
in the runtime environment).  However, at run time fonts are loaded
with absolute paths and I had to patch otfl-font-def.lua in order to
strip the path component from the font filename.  Then the font is
found by kpathsea at run time.

The patch (see attachment) works fine for me, but in general it would
make more sense to check in luaotfload whether a font is in a system
font directory or in a TEXMF tree and strip the path component only if
the latter is true.

It doesn't make a difference when luaotfload is loaded at run time
(because the cache is re-generated if necessary) but it makes a
difference if it's in a format file.

In short:  Everything in TEXMF trees should be found by kpathsea.

Regards,
  Reinhard


-------------- next part --------------
A non-text attachment was scrubbed...
Name: otfl-font-def.lua.diff
Type: application/octet-stream
Size: 1647 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130525/a8a81a73/attachment.obj>
-------------- next part --------------

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From Philipp.Gesang at alumni.uni-heidelberg.de  Sat May 25 13:53:59 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sat, 25 May 2013 13:53:59 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20896.14188.427800.473796@zaphod.ms25.net>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
Message-ID: <20130525115359.GA18765@phlegethon>

???<Datum: Saturday, 25. May 2013>???<Von: Reinhard Kotucha>???

> On 2013-05-24 at 12:21:56 +0200, Philipp Gesang wrote:
> 
>  > Cygwin should now be handled the same way as linux. Could you
>  > check if the changes address your point and report back? The code
>  > should be on CTAN in soon.
> 
> Yes, it looks good now.

Great.

> BTW, there is another thing I'd like to mention:
> 
> I've written a program using luaotfload.  This program is called by
> another program and runs in the background, i.e. users don't see what
> LuaTeX prints to screen.  I develop under Linux but the program is
> usually run under Windows.
> 
> The first version invoked luaotfload at run time.  It turned out that
> the font cache is problematic for many reasons in this application.
> Everything has to work out-of-the-box, I can't expect that users
> (physicians) are able to fix problems with file permissions or so
> themselves and the fact that some system fonts have to be blacklisted
> manually is even more problematic.

I agree, it?s unfortunate. But since faulty fonts freeze the
interpeter there isn?t much we can do about it at the Lua end.
(Context has the same problem, but afaics it doesn?t occur while
building the database because only .otf files are analyzed with
fontloader.open().)

Btw. you sound like this happens more often than it we are aware
of. Do you by any chance have some candidates for the blacklist
that you?d like to share?

> The current version runs luaotfload (and reads the cache) when the
> format file is created.

I don?t understand. There shouldn?t be any cache files at that
time. Also, which format are you using?

>                          This solves many problems.  Everything is
> extremely fast and the cache isn't used at all (it even doesn't exist
> in the runtime environment).

I don?t think that?s the case. It should be darned slow without
the cache.

>                               However, at run time fonts are loaded
> with absolute paths and I had to patch otfl-font-def.lua in order to
> strip the path component from the font filename.  Then the font is
> found by kpathsea at run time.
> The patch (see attachment) works fine for me, but in general it would

1) Use the patch_font callback for this kind of hack.
2) fontdata.filename = fontdata.filename and string.gsub(fontdata.filename, "^.*/", "")
3) With a file: and path: lookup this would be mapped back to an
   absolute path for the reason listed below, so it?s kind of
   pointless.

> make more sense to check in luaotfload whether a font is in a system
> font directory or in a TEXMF tree and strip the path component only if
> the latter is true.

Can you give the current Luaotfload a try (in the pretest)? We
don?t actually require kpse to load fonts anymore, only to
collect their whereabouts for the database. File names are hashed
and the corresponding absolute paths are retrieved from the
index. At runtime there is no distinction between texmf and
system fonts whatsoever anymore.

> It doesn't make a difference when luaotfload is loaded at run time
> (because the cache is re-generated if necessary) but it makes a
> difference if it's in a format file.
> 
> In short:  Everything in TEXMF trees should be found by kpathsea.

Why? The files are already indexed.

Best regards
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130525/16dcbcbb/attachment.bin>

From reinhard.kotucha at web.de  Sun May 26 03:27:09 2013
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sun, 26 May 2013 03:27:09 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20130525115359.GA18765@phlegethon>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
Message-ID: <20897.25837.287526.401869@zaphod.ms25.net>

On 2013-05-25 at 13:53:59 +0200, Philipp Gesang wrote:

 > ???<Datum: Saturday, 25. May 2013>???<Von: Reinhard Kotucha>???
 > 
 > > On 2013-05-24 at 12:21:56 +0200, Philipp Gesang wrote:
 > > 
 > >  > Cygwin should now be handled the same way as linux. Could you
 > >  > check if the changes address your point and report back? The code
 > >  > should be on CTAN in soon.
 > > 
 > > Yes, it looks good now.
 > 
 > Great.
 > 
 > > BTW, there is another thing I'd like to mention:
 > > 
 > > I've written a program using luaotfload.  This program is called by
 > > another program and runs in the background, i.e. users don't see what
 > > LuaTeX prints to screen.  I develop under Linux but the program is
 > > usually run under Windows.
 > > 
 > > The first version invoked luaotfload at run time.  It turned out that
 > > the font cache is problematic for many reasons in this application.
 > > Everything has to work out-of-the-box, I can't expect that users
 > > (physicians) are able to fix problems with file permissions or so
 > > themselves and the fact that some system fonts have to be blacklisted
 > > manually is even more problematic.
 > 
 > I agree, it?s unfortunate. But since faulty fonts freeze the
 > interpeter there isn?t much we can do about it at the Lua end.
 > (Context has the same problem, but afaics it doesn?t occur while
 > building the database because only .otf files are analyzed with
 > fontloader.open().)
 > 
 > Btw. you sound like this happens more often than it we are aware
 > of. Do you by any chance have some candidates for the blacklist
 > that you?d like to share?

Hi Philipp,
no, there are no problems on *my* system, but I don't have access to
the systems the program actually runs on.

 > > The current version runs luaotfload (and reads the cache) when the
 > > format file is created.
 > 
 > I don?t understand. There shouldn?t be any cache files at that
 > time. Also, which format are you using?

I create my own format file.  luaotfload is loaded just after LaTeX.
All Open Type fonts I need are also defined in the format file.  Thus,
the font cache is used only when the format file is created.

The problem occurs at run time when the PDF file is created.  Since
luaotfload defines the font with an absolute path, the program isn't
portable anymore.  However, if I remove the path component then
kpathsea will find the font.  At least if it's in a TEXMF tree.  But
this is always the case here because everything else isn't portable.

 > > This solves many problems.  Everything is extremely fast and the
 > > cache isn't used at all (it even doesn't exist in the runtime
 > > environment).
 > 
 > I don?t think that?s the case. It should be darned slow without
 > the cache.

It's even faster because everything which is time consuming is done
when the format file is created.  At run time the font is loaded again
in order to put a subset into the PDF file.  This takes some time but
can't be avoided anyway.

Please note that *I* create the format file under Linux and then run
the TeX file from a program which traces system calls (open, stat) in
order to create a tiny TeX system in another directory.  This
directory contains everything users need and it's what users get.

 > > However, at run time fonts are loaded with absolute paths and I
 > > had to patch otfl-font-def.lua in order to strip the path
 > > component from the font filename.  Then the font is found by
 > > kpathsea at run time.  The patch (see attachment) works fine for
 > > me, but in general it would
 > 
 > 1) Use the patch_font callback for this kind of hack.
 > 2) fontdata.filename = fontdata.filename and string.gsub(fontdata.filename, "^.*/", "")
 > 3) With a file: and path: lookup this would be mapped back to an
 >    absolute path for the reason listed below, so it?s kind of
 >    pointless.

I'll have to investigate which solution is best.  With the old version
of luaotfload I found out that I couldn't change anything after the
fonts had been specified:

  \font\foo=bar.ttf at 12pt

And before that there were no paths to strip.  So I think that using a
callback is the only solution to avoid patching luaotfload.

 > > make more sense to check in luaotfload whether a font is in a system
 > > font directory or in a TEXMF tree and strip the path component only if
 > > the latter is true.
 > 
 > Can you give the current Luaotfload a try (in the pretest)? We
 > don?t actually require kpse to load fonts anymore, only to
 > collect their whereabouts for the database. File names are hashed
 > and the corresponding absolute paths are retrieved from the
 > index. At runtime there is no distinction between texmf and
 > system fonts whatsoever anymore.

I tried the version from CTAN now and when I create the format file I
get the message (in the log file and on stdout)

  \font\foo=/usr/share/fonts/bar.ttf at 12pt

whereas with the _patched_ old version of luaotfload I got

  \font\foo=bar.ttf at 12pt

 > > It doesn't make a difference when luaotfload is loaded at run time
 > > (because the cache is re-generated if necessary) but it makes a
 > > difference if it's in a format file.
 > > 
 > > In short:  Everything in TEXMF trees should be found by kpathsea.
 > 
 > Why? The files are already indexed.

I suppose that my previous mail didn't describe clearly what I'm
actually doing.  But I still think that it's better to strip the path
component from fonts in TEXMF directories.  It probably doesn't matter
when fonts are loaded by luaotfload at run time.

There is another, quite nasty, problem:

If you have the same font installed in a TEXMF tree and in a system
font directory, luaotfload is using the system font.  This is very bad.   

There might be different versions of a particular font with the same
file name.  CentOS switched from teTeX to TeXLive-2007 recently.  You
can imagine how old the system fonts are on this system.  If somebody
installs TL from tug.org, I suppose that he wants to use the versions
provided by TeX Live.  Or even newer versions in own TEXMF trees.

I'm not familiar with the luaotfload code, but I suppose that this
behavior is not intended.  I suppose that it has something to do with
hashes.  If a font name is used as a key in a hash, everything depends
on the way the hash is created.

If font names are used as keys in a hash and system fonts are scanned
_after_ fonts in TEXMF trees, it's clear that system fonts always win
because they overwrite existing keys.

Anyway, IMO it's a severe bug if luaotfload ignores everything set up
in texmf.cnf and uses (probably ancient) system fonts instead.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From Philipp.Gesang at alumni.uni-heidelberg.de  Sun May 26 11:10:08 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sun, 26 May 2013 11:10:08 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20897.25837.287526.401869@zaphod.ms25.net>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
Message-ID: <20130526091008.GA27518@phlegethon>

Hi Reinhard!

???<Datum: Sunday, 26. May 2013>???<Von: Reinhard Kotucha>???

>  > > The current version runs luaotfload (and reads the cache) when the
>  > > format file is created.
>  > 
>  > I don?t understand. There shouldn?t be any cache files at that
>  > time. Also, which format are you using?
> 
> I create my own format file.

Okay, that was the missing bit.

>                               luaotfload is loaded just after LaTeX.
> All Open Type fonts I need are also defined in the format file.  Thus,
> the font cache is used only when the format file is created.
> 
> The problem occurs at run time when the PDF file is created.  Since
> luaotfload defines the font with an absolute path, the program isn't
> portable anymore.  However, if I remove the path component then
> kpathsea will find the font.  At least if it's in a TEXMF tree.  But
> this is always the case here because everything else isn't portable.

There is also aux.scan_external_dir() for including fonts from directories
that weren?t indexed.

>  > > This solves many problems.  Everything is extremely fast and the
>  > > cache isn't used at all (it even doesn't exist in the runtime
>  > > environment).
>  > 
>  > I don?t think that?s the case. It should be darned slow without
>  > the cache.
> 
> It's even faster because everything which is time consuming is done
> when the format file is created.  At run time the font is loaded again
> in order to put a subset into the PDF file.  This takes some time but
> can't be avoided anyway.
> 
> Please note that *I* create the format file under Linux and then run
> the TeX file from a program which traces system calls (open, stat) in
> order to create a tiny TeX system in another directory.  This
> directory contains everything users need and it's what users get.
> 
>  > > However, at run time fonts are loaded with absolute paths and I
>  > > had to patch otfl-font-def.lua in order to strip the path
>  > > component from the font filename.  Then the font is found by
>  > > kpathsea at run time.  The patch (see attachment) works fine for
>  > > me, but in general it would
>  > 
>  > 1) Use the patch_font callback for this kind of hack.
>  > 2) fontdata.filename = fontdata.filename and string.gsub(fontdata.filename, "^.*/", "")
>  > 3) With a file: and path: lookup this would be mapped back to an
>  >    absolute path for the reason listed below, so it?s kind of
>  >    pointless.
> 
> I'll have to investigate which solution is best.  With the old version
> of luaotfload I found out that I couldn't change anything after the
> fonts had been specified:
> 
>   \font\foo=bar.ttf at 12pt

Better: \font\foo="file:bar.ttf" at 12pt

> And before that there were no paths to strip.  So I think that using a
> callback is the only solution to avoid patching luaotfload.

You could also replace the file resolver.

    fonts.definers.resolvers.file = function (spec)
      --- rewrite spec.name here
    end

>  > > make more sense to check in luaotfload whether a font is in a system
>  > > font directory or in a TEXMF tree and strip the path component only if
>  > > the latter is true.
>  > 
>  > Can you give the current Luaotfload a try (in the pretest)? We
>  > don?t actually require kpse to load fonts anymore, only to
>  > collect their whereabouts for the database. File names are hashed
>  > and the corresponding absolute paths are retrieved from the
>  > index. At runtime there is no distinction between texmf and
>  > system fonts whatsoever anymore.
> 
> I tried the version from CTAN now and when I create the format file I
> get the message (in the log file and on stdout)
> 
>   \font\foo=/usr/share/fonts/bar.ttf at 12pt
> 
> whereas with the _patched_ old version of luaotfload I got
> 
>   \font\foo=bar.ttf at 12pt

Yes, that is expected. As I said, we keep the paths in the
database so there isn?t a need for the extra calls to kpse.

>  > > It doesn't make a difference when luaotfload is loaded at run time
>  > > (because the cache is re-generated if necessary) but it makes a
>  > > difference if it's in a format file.
>  > > 
>  > > In short:  Everything in TEXMF trees should be found by kpathsea.
>  > 
>  > Why? The files are already indexed.
> 
> I suppose that my previous mail didn't describe clearly what I'm
> actually doing.  But I still think that it's better to strip the path
> component from fonts in TEXMF directories.  It probably doesn't matter
> when fonts are loaded by luaotfload at run time.
> 
> There is another, quite nasty, problem:
> 
> If you have the same font installed in a TEXMF tree and in a system
> font directory, luaotfload is using the system font.  This is very bad.   

Well, isn?t that the reason why I installed that font in the
first place?

> There might be different versions of a particular font with the same
> file name.  CentOS switched from teTeX to TeXLive-2007 recently.

Which would mean an outdated *texmf*.

>                                                                   You
> can imagine how old the system fonts are on this system.

Usually, when someone asks for help with their distro?s tex
packages, the first thing they?re told is to drop it in favor of
texlive (or the minimals). This is not limited to tex, btw., but
quite common with other languages that come with dedicated
package management.

>                                                           If somebody
> installs TL from tug.org, I suppose that he wants to use the versions
> provided by TeX Live.  Or even newer versions in own TEXMF trees.

Or those in ~/.fonts, which is *the* canonical directory to
install your preferred fonts in.

> I'm not familiar with the luaotfload code, but I suppose that this
> behavior is not intended.  I suppose that it has something to do with
> hashes.  If a font name is used as a key in a hash, everything depends
> on the way the hash is created.
> 
> If font names are used as keys in a hash and system fonts are scanned
> _after_ fonts in TEXMF trees, it's clear that system fonts always win
> because they overwrite existing keys.

That?s pretty much it, yes. Order matters.

> Anyway, IMO it's a severe bug if luaotfload ignores everything set up
> in texmf.cnf and uses (probably ancient) system fonts instead.

Or an ancient texlive on an up-to-date system. Stranger things
have happened.

Since you are loading fonts by their filename and don?t care for
system fonts, you probably have no need for a names database. We
could make it optional, I guess, by installing a kpse-only file:
resolver and omitting the others. This could be toggled by
setting a flag in config.luaotfload.

The texmf vs. system fonts matter could be made configurable as
well, allowing the user to prioritize as they see fit. This would
require either a dotfile or separate tables in the database for
each of the search paths. Either way, it?s a more complex
addition so it?ll probably require testing.

For a start, you can test with this branch:

    https://github.com/phi-gamma/luaotfload/commits/texmf-fonts

it restores the previous behavior of not indexing full paths for
texmf fonts and also prefers them over system fonts.

Best
Philipp


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130526/1e9ad3a6/attachment.bin>

From news3 at nililand.de  Sun May 26 12:15:26 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Sun, 26 May 2013 12:15:26 +0200
Subject: [lltx] luaotfload-database.lua
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon>
Message-ID: <n5u82ioized2$.dlg@nililand.de>

Am Sun, 26 May 2013 11:10:08 +0200 schrieb Philipp Gesang:


>> If you have the same font installed in a TEXMF tree and in a system
>> font directory, luaotfload is using the system font.  This is very bad.   
 
> Well, isn?t that the reason why I installed that font in the
> first place?

>> If somebody installs TL from tug.org, I suppose that he wants to
>> use the versions provided by TeX Live.  Or even newer versions
>> in own TEXMF trees.
 
> Or those in ~/.fonts, which is *the* canonical directory to
> install your preferred fonts in.

...

> The texmf vs. system fonts matter could be made configurable as
> well, allowing the user to prioritize as they see fit. 

As with xetex it can lead to a broken output if xetex and xdvipdfmx
choose different fonts I'm fighting with the "how to handle font
versions" problem already for some time - I had to add a
<rejectfont> to my conf-file to avoid clashes. You simply can't
avoid that some fonts come back in a texmf tree through updates.

Imho some configuration options are needed in the future but on two
levels:

On the tex system level: 
- When the tex system installs an open type font it should be
possible to choose the installation location (texmf or system) (and
use it later for updates).

On the luaotfload level:
- luaotfload should warn if a font exists twice 
- it should be configurable which location is prefered (comparable
to the "dvipspreferoutline" of updmap) - if possible also on a font
basis so that one can override the general decision for specific
fonts. 

(I agree with you that one can't know which font a user want to use.
So there is no sensible default location.)

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From reinhard.kotucha at web.de  Mon May 27 00:50:00 2013
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Mon, 27 May 2013 00:50:00 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20130526091008.GA27518@phlegethon>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon>
Message-ID: <20898.37272.62627.459916@zaphod.ms25.net>

On 2013-05-26 at 11:10:08 +0200, Philipp Gesang wrote:

 > You could also replace the file resolver.
 > 
 >     fonts.definers.resolvers.file = function (spec)
 >       --- rewrite spec.name here
 >     end

Hi Philipp,
spec.name contains the name without a path, so I suppose that the path
is added somewhere else later.

Using the patch_font callback works fine.

 > > If you have the same font installed in a TEXMF tree and in a system
 > > font directory, luaotfload is using the system font.  This is very bad.   
 > 
 > Well, isn?t that the reason why I installed that font in the
 > first place?
 > 
 > > There might be different versions of a particular font with the same
 > > file name.  CentOS switched from teTeX to TeXLive-2007 recently.
 > 
 > Which would mean an outdated *texmf*.
 > 
 > > You can imagine how old the system fonts are on this system.
 > 
 > Usually, when someone asks for help with their distro?s tex
 > packages, the first thing they?re told is to drop it in favor of
 > texlive (or the minimals). This is not limited to tex, btw., but
 > quite common with other languages that come with dedicated
 > package management.
 >
 > > If somebody installs TL from tug.org, I suppose that he wants to
 > > use the versions provided by TeX Live.  Or even newer versions in
 > > own TEXMF trees.
 > 
 > Or those in ~/.fonts, which is *the* canonical directory to
 > install your preferred fonts in.
 
I maintain a TeX Live system on a server, so the only way to make
fonts accessible to all machines is to put them into a TEXMF tree.

 > Since you are loading fonts by their filename and don?t care for
 > system fonts, you probably have no need for a names database. We
 > could make it optional, I guess, by installing a kpse-only file:
 > resolver and omitting the others. This could be toggled by
 > setting a flag in config.luaotfload.

Yes, making it configurable is certainly a good idea.

 > The texmf vs. system fonts matter could be made configurable as
 > well, allowing the user to prioritize as they see fit. This would
 > require either a dotfile or separate tables in the database for
 > each of the search paths. Either way, it?s a more complex
 > addition so it?ll probably require testing.
 > 
 > For a start, you can test with this branch:
 > 
 >     https://github.com/phi-gamma/luaotfload/commits/texmf-fonts
 > 
 > it restores the previous behavior of not indexing full paths for
 > texmf fonts and also prefers them over system fonts.

It prefers texmf fonts but they are still specified with a full path.
The latter has always been the case in the TL-2012 version.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From reinhard.kotucha at web.de  Mon May 27 02:09:50 2013
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Mon, 27 May 2013 02:09:50 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <51A1B939.5020004@telecom-bretagne.eu>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <51A1B939.5020004@telecom-bretagne.eu>
Message-ID: <20898.42062.723293.558421@zaphod.ms25.net>

On 2013-05-26 at 09:26:49 +0200, ?lie Roux wrote:

 > Dear Reinhard,
 > 
 > I'm sorry this is quite off-topic, but you seem to already have done 
 > things I have on my todolist!
 > 
 > > It's even faster because everything which is time consuming is done
 > > when the format file is created.  At run time the font is loaded again
 > > in order to put a subset into the PDF file.  This takes some time but
 > > can't be avoided anyway.
 > 
 > So you confirm that loading fonts in the format speeds up things 
 > significantly?

Hi ?lie,
yes, because luaotfload doesn't have to do its work at run time.

 > By the way, did you not run into these bugs:
 > 
 > http://tracker.luatex.org/view.php?id=824
 > http://tracker.luatex.org/view.php?id=825

I don't load a format file when creating a new one, i.e. I don't use
\&lualatex.  Using a single .ini file works.

However, if I use \RequirePackage{pgfplots} in my .ini file I get a
runtime error:
  PANIC: unprotected error in call to Lua API (object in use)
  /bin/sh: line 1: 12102 Aborted                 (core dumped) 

This happens on the third page, so it probably clashes my stuff.

 > ? I'm planning to work on them, but it's far from being obvious... Do 
 > you know if things exist to "decompile" the format in a human-readable 
 > way? I used to have a tool to do this with dvi, but I've never seen it 
 > with TeX format...

No Idea.  Maybe Taco or Karl can tell you more.

 > > Please note that *I* create the format file under Linux and then run
 > > the TeX file from a program which traces system calls (open, stat) in
 > > order to create a tiny TeX system in another directory.  This
 > > directory contains everything users need and it's what users get.
 > 
 > Are you using home-made code or something available somewhere? If it's 
 > your own, would you be ready to share it? This is something I definitely 
 > wanted to try but haven't got the time yet...

I've written my own tool but it has to be adapted for TL2013
(texmf-dist vs. texmf).  Also, the creation of symlinks needs to be
revised.

There is also another tool on CTAN written by Heiko.  I've forgotten
its name, but you may find it here:

  http://ctan.org/tex-archive/macros/latex/contrib/oberdiek

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From Philipp.Gesang at alumni.uni-heidelberg.de  Mon May 27 23:48:16 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Mon, 27 May 2013 23:48:16 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20898.37272.62627.459916@zaphod.ms25.net>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon>
 <20898.37272.62627.459916@zaphod.ms25.net>
Message-ID: <20130527214816.GA3896@phlegethon>

Hi Reinhard!

???<Datum: Monday, 27. May 2013>???<Von: Reinhard Kotucha>???

> On 2013-05-26 at 11:10:08 +0200, Philipp Gesang wrote:
> 
>  > You could also replace the file resolver.
>  > 
>  >     fonts.definers.resolvers.file = function (spec)
>  >       --- rewrite spec.name here
>  >     end
> 
> Hi Philipp,
> spec.name contains the name without a path, so I suppose that the path
> is added somewhere else later.

The resolver replaces the file name along with other fields of
the spec. If it doesn?t resolve to a full path, then check_otf()
(see font-otf.lua) will do it at a later stage; if it can locate
the font, anyways. Sorry for the mislead.

Replacing the resolver is a bit crude in my eyes, so I added a
gimmick: the ?my? lookup that lets you call your own resolver in
a ?luaotfload.resolve_font? callback. Here?s a demo:

    https://bitbucket.org/phg/lua-la-tex-tests/src/9e3a0f/pln-lookup-callback-1.tex

It can?t solve your problem, though.

> Using the patch_font callback works fine.

That would depend on how the font is \dump?ed. Having never
looked at that code I can?t predict what might happen (?lie
might). But since the path information is lost it is possible
that this will fail with non-texmf fonts.

>  > > If somebody installs TL from tug.org, I suppose that he wants to
>  > > use the versions provided by TeX Live.  Or even newer versions in
>  > > own TEXMF trees.
>  > 
>  > Or those in ~/.fonts, which is *the* canonical directory to
>  > install your preferred fonts in.
>  
> I maintain a TeX Live system on a server, so the only way to make
> fonts accessible to all machines is to put them into a TEXMF tree.

>  > Since you are loading fonts by their filename and don?t care for
>  > system fonts, you probably have no need for a names database. We
>  > could make it optional, I guess, by installing a kpse-only file:
>  > resolver and omitting the others. This could be toggled by
>  > setting a flag in config.luaotfload.
> 
> Yes, making it configurable is certainly a good idea.

There is now a dedicated kpse: lookup that bypasses the database
entirely. Example:

    \input luaotfload.sty
    \font\foo = "kpse:Iwona-Regular.otf:+onum"
    \font\bar = "kpse:Iwona-Regular.otf:+smcp"

    {\foo baz {\bar whatever} xyzzy}\par
    \bye

>  > The texmf vs. system fonts matter could be made configurable as
>  > well, allowing the user to prioritize as they see fit. This would
>  > require either a dotfile or separate tables in the database for
>  > each of the search paths. Either way, it?s a more complex
>  > addition so it?ll probably require testing.
>  > 
>  > For a start, you can test with this branch:
>  > 
>  >     https://github.com/phi-gamma/luaotfload/commits/texmf-fonts
>  > 
>  > it restores the previous behavior of not indexing full paths for
>  > texmf fonts and also prefers them over system fonts.
> 
> It prefers texmf fonts but they are still specified with a full path.
> The latter has always been the case in the TL-2012 version.

This is caused by the fontloader and thus outside of our sphere
of influence.

Furthermore, luaotfload-tool now has an option --prefer-texmf
that prioritizes fonts in the tex tree. To achieve that, the
filename data needs to be reorganized a bit, so I incremented the
database version. Don?t forget to erase the font cache. For this
to work during a tex run you have to set the ?prioritize? field
before loading luaotfload:

    \directlua{
      config                       = config or { }
      config.luaotfload            = config.luaotfload or { }
      config.luaotfload.prioritize = "texmf"
    }
    \input luaotfload.sty

All these additions are still experimental and require testing.

Best regards
Philipp




> 
> Regards,
>   Reinhard
> 
> -- 
> ----------------------------------------------------------------------------
> Reinhard Kotucha                                      Phone: +49-511-3373112
> Marschnerstr. 25
> D-30167 Hannover                              mailto:reinhard.kotucha at web.de
> ----------------------------------------------------------------------------
> Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
> ----------------------------------------------------------------------------
> 

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130527/756998ac/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Mon May 27 23:57:43 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Mon, 27 May 2013 23:57:43 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <n5u82ioized2$.dlg@nililand.de>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon> <n5u82ioized2$.dlg@nililand.de>
Message-ID: <20130527215743.GB3896@phlegethon>

Hi Ulrike!

???<Datum: Sunday, 26. May 2013>???<Von: Ulrike Fischer>???

> Am Sun, 26 May 2013 11:10:08 +0200 schrieb Philipp Gesang:
> 
> 
> >> If you have the same font installed in a TEXMF tree and in a system
> >> font directory, luaotfload is using the system font.  This is very bad.   
>  
> > Well, isn?t that the reason why I installed that font in the
> > first place?
> 
> >> If somebody installs TL from tug.org, I suppose that he wants to
> >> use the versions provided by TeX Live.  Or even newer versions
> >> in own TEXMF trees.
>  
> > Or those in ~/.fonts, which is *the* canonical directory to
> > install your preferred fonts in.
> 
> ...
> 
> > The texmf vs. system fonts matter could be made configurable as
> > well, allowing the user to prioritize as they see fit. 
> 
> As with xetex it can lead to a broken output if xetex and xdvipdfmx
> choose different fonts I'm fighting with the "how to handle font
> versions" problem already for some time - I had to add a
> <rejectfont> to my conf-file to avoid clashes. You simply can't
> avoid that some fonts come back in a texmf tree through updates.
> 
> Imho some configuration options are needed in the future but on two
> levels:
> 
> On the tex system level: 
> - When the tex system installs an open type font it should be
> possible to choose the installation location (texmf or system) (and
> use it later for updates).
>
> On the luaotfload level:
> - luaotfload should warn if a font exists twice 

It does now with --verbose=2 or greater.

> - it should be configurable which location is prefered (comparable
> to the "dvipspreferoutline" of updmap)

Now: luaotfload-tool --prefer-texmf.

>                                        - if possible also on a font
> basis so that one can override the general decision for specific
> fonts. 

Don?t absolute paths cover that?

> (I agree with you that one can't know which font a user want to use.
> So there is no sensible default location.)

Absolutely.

Best
Philipp




> 
> -- 
> Ulrike Fischer 
> http://www.troubleshooting-tex.de/
> 

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130527/74b2dd11/attachment.bin>

From arthur.reutenauer at normalesup.org  Tue May 28 02:00:47 2013
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Tue, 28 May 2013 01:00:47 +0100
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20898.42062.723293.558421@zaphod.ms25.net>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <51A1B939.5020004@telecom-bretagne.eu>
 <20898.42062.723293.558421@zaphod.ms25.net>
Message-ID: <20130528000046.GP31062@phare.normalesup.org>

On Mon, May 27, 2013 at 02:09:50AM +0200, Reinhard Kotucha wrote:
> On 2013-05-26 at 09:26:49 +0200, ?lie Roux wrote:
>> ? I'm planning to work on them, but it's far from being obvious... Do 
>> you know if things exist to "decompile" the format in a human-readable 
>> way? I used to have a tool to do this with dvi, but I've never seen it 
>> with TeX format...
> 
> No Idea.  Maybe Taco or Karl can tell you more.

  I don't know what email Reinhard is replying to, but there is a
command-line switch "-debug-format" to TeX engines, that gives you some
information about the format files, as in:

	luatex -fmt luatex.fmt -debug-format \\bye

		Arthur

From elie.roux at telecom-bretagne.eu  Tue May 28 09:13:43 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Tue, 28 May 2013 09:13:43 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20130528000046.GP31062@phare.normalesup.org>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <51A1B939.5020004@telecom-bretagne.eu>
 <20898.42062.723293.558421@zaphod.ms25.net>
 <20130528000046.GP31062@phare.normalesup.org>
Message-ID: <51A45927.3050202@telecom-bretagne.eu>

Dear all,

> 	luatex -fmt luatex.fmt -debug-format \\bye

Thank you very much for the pointer!
-- 
Elie

From arthur.reutenauer at normalesup.org  Tue May 28 09:17:19 2013
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Tue, 28 May 2013 08:17:19 +0100
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <51A45927.3050202@telecom-bretagne.eu>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <51A1B939.5020004@telecom-bretagne.eu>
 <20898.42062.723293.558421@zaphod.ms25.net>
 <20130528000046.GP31062@phare.normalesup.org>
 <51A45927.3050202@telecom-bretagne.eu>
Message-ID: <20130528071719.GS31062@phare.normalesup.org>

  I found out about it by roaming through the source, three years ago, I
was very proud of myself :-)

	Arthur

From news3 at nililand.de  Tue May 28 16:23:31 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Tue, 28 May 2013 16:23:31 +0200
Subject: [lltx] luaotfload-database.lua
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon> <n5u82ioized2$.dlg@nililand.de>
 <20130527215743.GB3896@phlegethon>
Message-ID: <1vlpha1093yv4$.dlg@nililand.de>

Am Mon, 27 May 2013 23:57:43 +0200 schrieb Philipp Gesang:

> Hi Ulrike!

>> - it should be configurable which location is prefered (comparable
>> to the "dvipspreferoutline" of updmap)
> 
> Now: luaotfload-tool --prefer-texmf.
> 
>>                                        - if possible also on a font
>> basis so that one can override the general decision for specific
>> fonts. 
> 
> Don?t absolute paths cover that?

Completly hard coded pathes would be imho not really sensible: I
e.g. have tex systems on 3 PC's. But one could naturally use kpse to
get the texmf-path and so keep the documents more or less portable. 

But I was more thinking about a way to handle the configuration more
centralized. I have e.g. currently miktex, TL12 and TL13. All three
tex-systems have access to the same local texmf-tree where I have
stored some local fonts, blacklists for luaotfload etc. I think it
would be useful to have there some configuration file, where I could
put instructions like "if libertine is in the texmf-tree then use
it".  


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Tue May 28 19:17:21 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 28 May 2013 19:17:21 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <1vlpha1093yv4$.dlg@nililand.de>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon> <n5u82ioized2$.dlg@nililand.de>
 <20130527215743.GB3896@phlegethon> <1vlpha1093yv4$.dlg@nililand.de>
Message-ID: <20130528171721.GA7510@phlegethon>

???<Datum: Tuesday, 28. May 2013>???<Von: Ulrike Fischer>???

> Am Mon, 27 May 2013 23:57:43 +0200 schrieb Philipp Gesang:
> 
> > Hi Ulrike!
> 
> >> - it should be configurable which location is prefered (comparable
> >> to the "dvipspreferoutline" of updmap)
> > 
> > Now: luaotfload-tool --prefer-texmf.
> > 
> >>                                        - if possible also on a font
> >> basis so that one can override the general decision for specific
> >> fonts. 
> > 
> > Don?t absolute paths cover that?
> 
> Completly hard coded pathes would be imho not really sensible: I
> e.g. have tex systems on 3 PC's. But one could naturally use kpse to
> get the texmf-path and so keep the documents more or less portable. 
> 
> But I was more thinking about a way to handle the configuration more
> centralized. I have e.g. currently miktex, TL12 and TL13. All three
> tex-systems have access to the same local texmf-tree where I have
> stored some local fonts, blacklists for luaotfload etc. I think it
> would be useful to have there some configuration file, where I could
> put instructions like "if libertine is in the texmf-tree then use
> it".  

This would be a simple matter of drawing up some DSL for
configuration. Then we keep extending it with every feature
request and in a couple years from now we?d end up with some
informally specified bug-ridden implementation of SQL.

Joke aside, your problem can easily be solved by symlinking the
fonts you need for a document to a subdirectory. (We could
add an option to dump a list of used font files so you can script
that part.) This way you can determine precisely which files will
be embedded. Conditional font choices like you suggest would only
add another potential source of errors.

Also, if we got rid of the ban on ?write18?, we could use
fontconfig instead of the database. It allows you to write rules
for matching fonts against different criteria. (E.g. I have a
personal substitution set that eliminates the ms core fonts from
about every graphical application except when they are embedded
in pdfs.) We shouldn?t reinvent the wheel when there?s lots of
other aspects that could be improved, for instance the logging
mechanism. [1]

Best regards
Philipp

[1] I?m aware that fontconfig probably won?t be available on
    Windows. But there should be some equivalent functionality
    that other programs use when they ?access system fonts?.




-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130528/9950973d/attachment.bin>

From elie.roux at telecom-bretagne.eu  Tue May 28 19:35:06 2013
From: elie.roux at telecom-bretagne.eu (=?UTF-8?B?w4lsaWUgUm91eA==?=)
Date: Tue, 28 May 2013 19:35:06 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <20130528171721.GA7510@phlegethon>
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon> <n5u82ioized2$.dlg@nililand.de>
 <20130527215743.GB3896@phlegethon> <1vlpha1093yv4$.dlg@nililand.de>
 <20130528171721.GA7510@phlegethon>
Message-ID: <51A4EACA.7050406@telecom-bretagne.eu>

Dear all,

> [1] I?m aware that fontconfig probably won?t be available on
>      Windows. But there should be some equivalent functionality
>      that other programs use when they ?access system fonts?.

In fact I discovered by mistake that yes, fontconfig is available under 
Windows, and it's provided by TeXLive ! 
http://tug.org/svn/texlive/trunk/Master/bin/win32/ I guess the reason is 
that it's used by XeTeX. So I guess it should be available everywhere.

Thank you,
-- 
Elie

From herbs at wideopenwest.com  Tue May 28 19:41:26 2013
From: herbs at wideopenwest.com (Herbert Schulz)
Date: Tue, 28 May 2013 12:41:26 -0500
Subject: [lltx] luaotfload crashing on Mac OS X 10.5 on PPC
Message-ID: <F11D2035-18C6-49CF-9D00-B57279FA537F@wideopenwest.com>

Howdy,

All updates as of 2013/05/28. Both luaotfload and luaotfload-tool are throwing errors under Mac OS X 10.5 PPC. I see multiple errors of the type:

malloc: *** error for object 0xXXXXXXX: Non-aligned pointer being freed

where 0xXXXXXXX is a HEX address. This is happening when either tool is creating the lualatex font cache. Note: TEMFVAR already exists. Note: Eventually the task completes, the compilation completes and the final pdf file is created so this is not a crash.

Good Luck,

Herb Schulz
(herbs at wideopenwest dot com)





From Philipp.Gesang at alumni.uni-heidelberg.de  Tue May 28 19:42:18 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 28 May 2013 19:42:18 +0200
Subject: [lltx] luaotfload-database.lua
In-Reply-To: <51A4EACA.7050406@telecom-bretagne.eu>
References: <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon> <n5u82ioized2$.dlg@nililand.de>
 <20130527215743.GB3896@phlegethon> <1vlpha1093yv4$.dlg@nililand.de>
 <20130528171721.GA7510@phlegethon>
 <51A4EACA.7050406@telecom-bretagne.eu>
Message-ID: <20130528174218.GA9382@phlegethon>

???<date: 2013-05-28, Tuesday>???<from: ?lie Roux>???

> Dear all,
> 
> >[1] I?m aware that fontconfig probably won?t be available on
> >     Windows. But there should be some equivalent functionality
> >     that other programs use when they ?access system fonts?.
> 
> In fact I discovered by mistake that yes, fontconfig is available
> under Windows, and it's provided by TeXLive !
> http://tug.org/svn/texlive/trunk/Master/bin/win32/ I guess the
> reason is that it's used by XeTeX. So I guess it should be available
> everywhere.

Thank you very much, you just saved me from diving into the Xetex
sources to find out how it does that on Windows! Great find.

Best
Philipp

> 
> Thank you,
> -- 
> Elie

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130528/a1465a74/attachment.bin>

From herbs at wideopenwest.com  Wed May 29 14:06:52 2013
From: herbs at wideopenwest.com (Herbert Schulz)
Date: Wed, 29 May 2013 07:06:52 -0500
Subject: [lltx] Today's update
Message-ID: <BF2260EB-07AC-4289-9311-80A092D5C94A@wideopenwest.com>

Howdy,

With today's update of luaotfload the TEXMFVAR is properly constructed when the font cache is first created. Thanks to all for that fix.

PS: It would be nice if there was a message that the font cache was being constructed and that could take a long time.

The many malloc warning messages for luaotfload and luaotfload-tool under OS X 10.5 (at least PPC) are still present when creating the font cache. To be expected since I first discovered that yesterday. Note: the process continues and the cache seems to be properly created since the files compile correctly.

Please CC me directly since I don't subscribe to this list.

Good Luck,

Herb Schulz
(herbs at wideopenwest dot com)





From Philipp.Gesang at alumni.uni-heidelberg.de  Wed May 29 15:18:21 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Wed, 29 May 2013 15:18:21 +0200
Subject: [lltx] Today's update
In-Reply-To: <BF2260EB-07AC-4289-9311-80A092D5C94A@wideopenwest.com>
References: <BF2260EB-07AC-4289-9311-80A092D5C94A@wideopenwest.com>
Message-ID: <20130529131821.GA12196@phlegethon>

Hi Herbert,

???<date: 2013-05-29, Wednesday>???<from: Herbert Schulz>???

> With today's update of luaotfload the TEXMFVAR is properly
> constructed when the font cache is first created. Thanks to all
> for that fix.

you?re welcome. Thank you for testing.

> PS: It would be nice if there was a message that the font cache
> was being constructed and that could take a long time.

Are you referring to the font cache or the names database? Both
can be very slow. When luaotfload builds a new database it should
print this:

    luaotfload | db: Font names database not found, generating new one.

At least here it does. Anyways, this is only half of a two-line
message that is being truncated due to the way how texio works
(happens all the time cause we can?t flush output manually).
It?s possible that on your terminal nothing is printed at all
(check the log, the message should be there).

I?ll see what I can do about it.

> The many malloc warning messages for luaotfload and
> luaotfload-tool under OS X 10.5 (at least PPC) are still present
> when creating the font cache. To be expected since I first
> discovered that yesterday. Note: the process continues and the
> cache seems to be properly created since the files compile
> correctly.

I read your other message to the list but I?m afraid I can?t
reproduce this on my system (not a mac). If others have the same
problem it might be best to report it to the luatex list.

Best regards
Philipp


> Please CC me directly since I don't subscribe to this list.
> 
> Good Luck,
> 
> Herb Schulz
> (herbs at wideopenwest dot com)
> 
> 
> 
> 

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: not available
URL: <http://tug.org/pipermail/lualatex-dev/attachments/20130529/233efab6/attachment.bin>

From herbs at wideopenwest.com  Wed May 29 15:34:25 2013
From: herbs at wideopenwest.com (Herbert Schulz)
Date: Wed, 29 May 2013 08:34:25 -0500
Subject: [lltx] Today's update
In-Reply-To: <20130529131821.GA12196@phlegethon>
References: <BF2260EB-07AC-4289-9311-80A092D5C94A@wideopenwest.com>
 <20130529131821.GA12196@phlegethon>
Message-ID: <AC2D8003-AE7F-4023-A0EF-C83D1A7FC31F@wideopenwest.com>


On May 29, 2013, at 8:18 AM, Philipp Gesang <Philipp.Gesang at alumni.uni-heidelberg.de> wrote:

> ...
> Are you referring to the font cache or the names database? Both
> can be very slow. When luaotfload builds a new database it should
> print this:
> 
>    luaotfload | db: Font names database not found, generating new one.
> 
> At least here it does. Anyways, this is only half of a two-line
> message that is being truncated due to the way how texio works
> (happens all the time cause we can?t flush output manually).
> It?s possible that on your terminal nothing is printed at all
> (check the log, the message should be there).
> 

Howdy,

I don't think I saw that message on the console while compiling the file. Now I see that it seems to appear on the console AFTER the work is done. 

> I?ll see what I can do about it.
> 
>> The many malloc warning messages for luaotfload and
>> luaotfload-tool under OS X 10.5 (at least PPC) are still present
>> when creating the font cache. To be expected since I first
>> discovered that yesterday. Note: the process continues and the
>> cache seems to be properly created since the files compile
>> correctly.
> 
> I read your other message to the list but I?m afraid I can?t
> reproduce this on my system (not a mac). If others have the same
> problem it might be best to report it to the luatex list.
> 
> Best regards
> Philipp

I'm only seeing it when I test on a Mac OS X 10.5 PPC system. I don't have access to an Intel system running OS X 10.5 so I don't know if it's only with PPC or a general 10.5 warning. I don't have access to any systems with OS X 10.6 so haven't tested there. Under OS X 10.7 and 10.8 there are no warnings.

Good Luck,

Herb Schulz
(herbs at wideopenwest dot com)





From news3 at nililand.de  Fri May 31 12:35:07 2013
From: news3 at nililand.de (Ulrike Fischer)
Date: Fri, 31 May 2013 12:35:07 +0200
Subject: [lltx] luaotfload-database.lua
References: <20894.41918.387569.270899@zaphod.ms25.net>
 <20130524102156.GA14084@phlegethon>
 <20896.14188.427800.473796@zaphod.ms25.net>
 <20130525115359.GA18765@phlegethon>
 <20897.25837.287526.401869@zaphod.ms25.net>
 <20130526091008.GA27518@phlegethon> <n5u82ioized2$.dlg@nililand.de>
 <20130527215743.GB3896@phlegethon> <1vlpha1093yv4$.dlg@nililand.de>
 <20130528171721.GA7510@phlegethon>
Message-ID: <15rehtuvzih3v$.dlg@nililand.de>

Am Tue, 28 May 2013 19:17:21 +0200 schrieb Philipp Gesang:

>> But I was more thinking about a way to handle the configuration more
>> centralized. I have e.g. currently miktex, TL12 and TL13. All three
>> tex-systems have access to the same local texmf-tree where I have
>> stored some local fonts, blacklists for luaotfload etc. I think it
>> would be useful to have there some configuration file, where I could
>> put instructions like "if libertine is in the texmf-tree then use
>> it".  
 
> This would be a simple matter of drawing up some DSL for
> configuration. Then we keep extending it with every feature
> request and in a couple years from now we?d end up with some
> informally specified bug-ridden implementation of SQL.

;-). Actually I was thinking about a simple way to blacklist a
folder or a font. And when I worded it in this way I realized that
perhaps the blacklist configuration file could be used. Can one use
kpse-Variables and "Wildcards" in the blacklist configuration file? 

> Also, if we got rid of the ban on ?write18?, we could use
> fontconfig instead of the database. 

But on the other side would fontconfig give back a much information
as does the current database (which I find quite useful)? 

> It allows you to write rules
> for matching fonts against different criteria. (E.g. I have a
> personal substitution set that eliminates the ms core fonts from
> about every graphical application except when they are embedded
> in pdfs.) 

> [1] I?m aware that fontconfig probably won?t be available on
>     Windows. But there should be some equivalent functionality
>     that other programs use when they ?access system fonts?.

As I wrote somewhere in the beginning I'm using fontconfig to avoid
clashed when using xelatex. On windows fontconfig comes with the
TeX-System. But miktex and texlive differ in the locations and the
naming for local configuration files:

miktex uses  fontconfig/config/localfonts2.conf,
texlive as far as I can see fonts/conf/local.conf


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


