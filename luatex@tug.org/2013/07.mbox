From evan.cooch at gmail.com  Mon Jul  1 15:10:04 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Mon, 1 Jul 2013 09:10:04 -0400
Subject: [luatex] [MiKTeX] detailed 'diagnostic' of MikTeX/Lua*/fontspec
 issues
In-Reply-To: <10kx0r1k4mzau$.dlg@nililand.de>
References: <51CF2666.1000406@gmail.com> <51CF4066.7050200@gmail.com>
 <51CF4EAB.5060002@gmail.com> <16roliva0u40k$.dlg@nililand.de>
 <51D04F1C.7090009@gmail.com> <uldr9zikqxmy.dlg@nililand.de>
 <51D05F60.9030303@gmail.com> <10kx0r1k4mzau$.dlg@nililand.de>
Message-ID: <51D17FAC.30200@gmail.com>


On 7/1/2013 6:14 AM, Ulrike Fischer wrote:
> Am Sun, 30 Jun 2013 12:40:00 -0400 schrieb Evan Cooch:
>
>>> And there are many other possible causes like e.g. a bug in the
>>> luaotfload code. Do you really think randomly trying out more and
>>> more installation variants is a sensible way to find you what's
>>> going on?
>>
>> So, I can either assume a problem in the code, or a strange install
>> sequence.  You prefer the former, I assume the latter.
> No. I didn't have any preference regarding the source or the
> solution of your problem. But when I see thousands of possible
> routes I don't start running and explore them one by one in the hope
> that one of them will lead me to my goal. I try to gather
> informations which allow me to reduce the number of possibles
> routes. I don't try to repair something immediatly, I try to
> understand the problem by running debug tools and doing simple tests
> - like changing the folder.
>
>
>

Fair enough - but changing the folder is not something that would have 
occurred to me.

Regardless - that worked!

From evan.cooch at gmail.com  Tue Jul  2 15:11:44 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 09:11:44 -0400
Subject: [luatex] detailed 'diagnostic' of MikTeX/Lua*/fontspec issues
In-Reply-To: <20130630101716.GA32014@phlegethon>
References: <51CF2666.1000406@gmail.com> <20130629195612.GA30064@phlegethon>
 <51CF4018.2030803@gmail.com> <20130629223145.GA30374@phlegethon>
 <51CF776A.3080800@gmail.com> <20130630101716.GA32014@phlegethon>
Message-ID: <51D2D190.30400@gmail.com>


On 6/30/2013 6:17 AM, Philipp Gesang wrote:
> ???<date: 2013-06-29, Saturday>???<from: Evan Cooch>???
>
>>>>> Not a luaotfload thing, as I wrote previously, this could be a
>>>>> buggy font. Does it terminate correctly if you run:
>>>>>
>>>>>      luaotfload-tool --update --force --verbose=5 --dry-run
>>>>>
>>>>> ?
>>>> No -- with or without the --dry-run flag, it terminates. The
>>>> termination always occurs after it has started scanning my working
>>>> directory (which happens to be the Desktop for my account, which
>>>> again is an admin account).
>>> Please try the attached patch for luaotfload.
>>>
>> OK - if you tell me what to do with the patch. If this was a Linux
>> machine, I know how to apply patches. This is a Windows machine - do
>> I need to run something, or simply copy and paste from the patch
>> into something else?
>>
>> Thanks!
> Sorry, I didn't consider that. Here's the patched file:
>
>      https://gist.github.com/phi-gamma/5894615
>
> Best regards,
> Philipp
>


Tried the patch -- doesn't seem to ork. When I run luaotfload-tool 
--update --force, I now get an error about database not found, and a 
bunch of other error messages:


... (x86)\MiKTeX 2.9\scripts\luaotfload\luaotfload-tool.lua:135: module 'luaotfload-database' not found:
	no field package.preload['luaotfload-database']
	[luatexbase.loader] Loading error:
	...MiKTeX 2.9/tex/luatex/luaotfload/luaotfload-database.lua:2: unexpected symbol near '<'
	[kpse C searcher] file not found: 'luaotfload-database'




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20130702/37056617/attachment.html>

From evan.cooch at gmail.com  Tue Jul  2 15:31:40 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 09:31:40 -0400
Subject: [luatex] luaotfload no longer finding fonts in TEXMF
Message-ID: <51D2D63C.8040300@gmail.com>

Pre-recent updates to MikTeX 2.9, in order to allow luaotfload to 'find' 
fonts installed in TEXMF (say, XITS), especially (only?) if you 
installed for 'all users', you had to tweak lualibs-dir.lua, adding

P("(")  / "%%(" +
P(")")  / "%%)" +

around line around line 95, just before "P(1)". This worked perfectly.

After the updates, you (in theory) needed to tweak 2 files (around line 150 in the updated files)

lualibs-dir.lua (in tex\luatex\lualibs)

luaotflod-lib-dir.lua (in tex\luatex\luaotfload)


However, despite making these changes, luaotfload-tool doesn't seem to find the finds. If I run

luaotfload-tool --update --force --vvv

and watch things chug along, I can see it entering into (say the XITS subdirectory), but not finding any fonts, even though the fonts are actually there.


So, something isn't working. The fact that we need to hack things to get luaotfload to find the fonts in the first place seems problematic -- not sure why it isn't the default to escape ( and ) to let it find the fonts (although apparently that hack no longer works).

Suggestions? I can brute-force a solution by moving fonts from TEXMF to OS fonts directory (whereupon luaotfload-tool finds them just fine), but...I shouldn't have to.


From evan.cooch at gmail.com  Tue Jul  2 16:43:16 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 10:43:16 -0400
Subject: [luatex] luaotfload no longer finding fonts in TEXMF
In-Reply-To: <51D2D63C.8040300@gmail.com>
References: <51D2D63C.8040300@gmail.com>
Message-ID: <51D2E704.2040607@gmail.com>


On 7/2/2013 9:31 AM, Evan Cooch wrote:
> Pre-recent updates to MikTeX 2.9, in order to allow luaotfload to 
> 'find' fonts installed in TEXMF (say, XITS), especially (only?) if you 
> installed for 'all users', you had to tweak lualibs-dir.lua, adding
>
> P("(")  / "%%(" +
> P(")")  / "%%)" +
>
> around line around line 95, just before "P(1)". This worked perfectly.
>
> After the updates, you (in theory) needed to tweak 2 files (around 
> line 150 in the updated files)
>
> lualibs-dir.lua (in tex\luatex\lualibs)
>
> luaotflod-lib-dir.lua (in tex\luatex\luaotfload)
>
>
> However, despite making these changes, luaotfload-tool doesn't seem to 
> find the finds. If I run
>
> luaotfload-tool --update --force --vvv
>
> and watch things chug along, I can see it entering into (say the XITS 
> subdirectory), but not finding any fonts, even though the fonts are 
> actually there.
>
>
> So, something isn't working. The fact that we need to hack things to 
> get luaotfload to find the fonts in the first place seems problematic 
> -- not sure why it isn't the default to escape ( and ) to let it find 
> the fonts (although apparently that hack no longer works).
>
> Suggestions? I can brute-force a solution by moving fonts from TEXMF 
> to OS fonts directory (whereupon luaotfload-tool finds them just 
> fine), but...I shouldn't have to.
>
>

So, I did another re-install, re-hacked the files (as noted above), but 
this time, ran luaotfload-tool --update --force twice: once as admin, 
and once as user. Seems to have cured the problem. The first time I 
tried it, I ran luaotfload-tool as user only. Apparently, I either need 
to run it as admin, or need to run it as both user and admin.

Either way, seems to work. My original query about 'why we need to do 
this in the first instance' stands.

From Philipp.Gesang at alumni.uni-heidelberg.de  Tue Jul  2 17:06:33 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 2 Jul 2013 17:06:33 +0200
Subject: [luatex] detailed 'diagnostic' of MikTeX/Lua*/fontspec issues
In-Reply-To: <51D2D190.30400@gmail.com>
References: <51CF2666.1000406@gmail.com> <20130629195612.GA30064@phlegethon>
 <51CF4018.2030803@gmail.com> <20130629223145.GA30374@phlegethon>
 <51CF776A.3080800@gmail.com> <20130630101716.GA32014@phlegethon>
 <51D2D190.30400@gmail.com>
Message-ID: <20130702150633.GA24394@phlegethon>

???<date: 2013-07-02, Tuesday>???<from: Evan Cooch>???

> 
> On 6/30/2013 6:17 AM, Philipp Gesang wrote:
> >???<date: 2013-06-29, Saturday>???<from: Evan Cooch>???
> >
> >>>>>Not a luaotfload thing, as I wrote previously, this could be a
> >>>>>buggy font. Does it terminate correctly if you run:
> >>>>>
> >>>>>     luaotfload-tool --update --force --verbose=5 --dry-run
> >>>>>
> >>>>>?
> >>>>No -- with or without the --dry-run flag, it terminates. The
> >>>>termination always occurs after it has started scanning my working
> >>>>directory (which happens to be the Desktop for my account, which
> >>>>again is an admin account).
> >>>Please try the attached patch for luaotfload.
> >>>
> >>OK - if you tell me what to do with the patch. If this was a Linux
> >>machine, I know how to apply patches. This is a Windows machine - do
> >>I need to run something, or simply copy and paste from the patch
> >>into something else?
> >>
> >>Thanks!
> >Sorry, I didn't consider that. Here's the patched file:
> >
> >     https://gist.github.com/phi-gamma/5894615
> >
> >Best regards,
> >Philipp
> >
> 
> 
> Tried the patch -- doesn't seem to ork. When I run luaotfload-tool
> --update --force, I now get an error about database not found, and a
> bunch of other error messages:
> 
> 
> ... (x86)\MiKTeX 2.9\scripts\luaotfload\luaotfload-tool.lua:135: module 'luaotfload-database' not found:
> 	no field package.preload['luaotfload-database']
> 	[luatexbase.loader] Loading error:
> 	...MiKTeX 2.9/tex/luatex/luaotfload/luaotfload-database.lua:2: unexpected symbol near '<'
> 	[kpse C searcher] file not found: 'luaotfload-database'
> 

As the message says, something on line 2 of your
luaotfload-database.lua makes the parser choke. Since ?>? isn?t
supposed to be anywhere near that line I suspect that your file
is corrupt.

Best,
Philipp


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130702/97855460/attachment.bin>

From evan.cooch at gmail.com  Tue Jul  2 17:24:20 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 11:24:20 -0400
Subject: [luatex] detailed 'diagnostic' of MikTeX/Lua*/fontspec issues
In-Reply-To: <20130702150633.GA24394@phlegethon>
References: <51CF2666.1000406@gmail.com> <20130629195612.GA30064@phlegethon>
 <51CF4018.2030803@gmail.com> <20130629223145.GA30374@phlegethon>
 <51CF776A.3080800@gmail.com> <20130630101716.GA32014@phlegethon>
 <51D2D190.30400@gmail.com> <20130702150633.GA24394@phlegethon>
Message-ID: <51D2F0A4.6090505@gmail.com>


On 7/2/2013 11:06 AM, Philipp Gesang wrote:
> ???<date: 2013-07-02, Tuesday>???<from: Evan Cooch>???
>
>> On 6/30/2013 6:17 AM, Philipp Gesang wrote:
>>> ???<date: 2013-06-29, Saturday>???<from: Evan Cooch>???
>>>
>>>>>>> Not a luaotfload thing, as I wrote previously, this could be a
>>>>>>> buggy font. Does it terminate correctly if you run:
>>>>>>>
>>>>>>>      luaotfload-tool --update --force --verbose=5 --dry-run
>>>>>>>
>>>>>>> ?
>>>>>> No -- with or without the --dry-run flag, it terminates. The
>>>>>> termination always occurs after it has started scanning my working
>>>>>> directory (which happens to be the Desktop for my account, which
>>>>>> again is an admin account).
>>>>> Please try the attached patch for luaotfload.
>>>>>
>>>> OK - if you tell me what to do with the patch. If this was a Linux
>>>> machine, I know how to apply patches. This is a Windows machine - do
>>>> I need to run something, or simply copy and paste from the patch
>>>> into something else?
>>>>
>>>> Thanks!
>>> Sorry, I didn't consider that. Here's the patched file:
>>>
>>>      https://gist.github.com/phi-gamma/5894615
>>>
>>> Best regards,
>>> Philipp
>>>
>>
>> Tried the patch -- doesn't seem to ork. When I run luaotfload-tool
>> --update --force, I now get an error about database not found, and a
>> bunch of other error messages:
>>
>>
>> ... (x86)\MiKTeX 2.9\scripts\luaotfload\luaotfload-tool.lua:135: module 'luaotfload-database' not found:
>> 	no field package.preload['luaotfload-database']
>> 	[luatexbase.loader] Loading error:
>> 	...MiKTeX 2.9/tex/luatex/luaotfload/luaotfload-database.lua:2: unexpected symbol near '<'
>> 	[kpse C searcher] file not found: 'luaotfload-database'
>>
> As the message says, something on line 2 of your
> luaotfload-database.lua makes the parser choke. Since ?>? isn?t
> supposed to be anywhere near that line I suspect that your file
> is corrupt.
>
> Best,
> Philipp
>
>

Thanks -- I'll try again (although not sure how a copy/paste of an ASCII 
text file could be corrupt). Nonetheless....

From Philipp.Gesang at alumni.uni-heidelberg.de  Tue Jul  2 17:31:00 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 2 Jul 2013 17:31:00 +0200
Subject: [luatex] luaotfload no longer finding fonts in TEXMF
In-Reply-To: <51D2E704.2040607@gmail.com>
References: <51D2D63C.8040300@gmail.com>
 <51D2E704.2040607@gmail.com>
Message-ID: <20130702153100.GB24394@phlegethon>

???<date: 2013-07-02, Tuesday>???<from: Evan Cooch>???

> 
> On 7/2/2013 9:31 AM, Evan Cooch wrote:
> >Pre-recent updates to MikTeX 2.9, in order to allow luaotfload to
> >'find' fonts installed in TEXMF (say, XITS), especially (only?) if
> >you installed for 'all users', you had to tweak lualibs-dir.lua,
> >adding
> >
> >P("(")  / "%%(" +
> >P(")")  / "%%)" +
> >
> >around line around line 95, just before "P(1)". This worked perfectly.
> >
> >After the updates, you (in theory) needed to tweak 2 files (around
> >line 150 in the updated files)
> >
> >lualibs-dir.lua (in tex\luatex\lualibs)
> >
> >luaotflod-lib-dir.lua (in tex\luatex\luaotfload)
> >
> >
> >However, despite making these changes, luaotfload-tool doesn't
> >seem to find the finds. If I run
> >
> >luaotfload-tool --update --force --vvv
> >
> >and watch things chug along, I can see it entering into (say the
> >XITS subdirectory), but not finding any fonts, even though the
> >fonts are actually there.
> >
> >
> >So, something isn't working. The fact that we need to hack things
> >to get luaotfload to find the fonts in the first place seems
> >problematic -- not sure why it isn't the default to escape ( and )
> >to let it find the fonts (although apparently that hack no longer
> >works).
> >
> >Suggestions? I can brute-force a solution by moving fonts from
> >TEXMF to OS fonts directory (whereupon luaotfload-tool finds them
> >just fine), but...I shouldn't have to.
> >
> >
> 
> So, I did another re-install, re-hacked the files (as noted above),
> but this time, ran luaotfload-tool --update --force twice: once as
> admin, and once as user. Seems to have cured the problem. The first
> time I tried it, I ran luaotfload-tool as user only. Apparently, I
> either need to run it as admin, or need to run it as both user and
> admin.

You should never run luaotfload-tool with root privileges. In
fact if there was a cross-platform way to check for the uid I
would make it refuse to run as root. The font index is created in
the $TEXMFCACHE or $TEXMFVAR of each user. You can find out where
that is like so:

    kpse.set_program_name "luatex"
    local dirs = { "$TEXMFCACHE", "$TEXMFVAR" }
    for i=1, #dirs do
      print(dirs[i], kpse.expand_path (dirs[i]))
    end

Of the printed paths the first one that proves to be writable
wins and is created if it does not yet exist. Since the paths are
different for root, the index would be written at a location that
is not writable (or even accessible) with ordinary privileges.

> Either way, seems to work. My original query about 'why we need to
> do this in the first instance' stands.

The alternative is sticking with ASCII-only paths.

Anyways, as globbing appears to be unreliable on Windows systems
I just replaced the calls to dir.glob () with generic directory
walks. A nice side effect is that the dependency on l-dir.lua is
unnecessary now, so the next version of luaotfload will ship
without it.

Best,
Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130702/dbbd3afa/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Tue Jul  2 18:10:05 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 2 Jul 2013 18:10:05 +0200
Subject: [luatex] MacTeX 2013, problem with ttf fonts
In-Reply-To: <20130630215519.GJ6734@web.de>
References: <20130630215519.GJ6734@web.de>
Message-ID: <20130702161005.GA25008@phlegethon>

???<date: 2013-06-30, Sunday>???<from: Stefan Kr?ger>???

> Hi,
> 
> when typesetting the following tex document with lualatex, I'm getting
> 
> "Italic.ttf at 10.95ptItalic.ttf at 9.0ptUpper left"
> 
> in the output pdf.
> 
> Minimal tex sample:
> 
> \documentclass{scrartcl}
> \usepackage{fontspec}
> \setmainfont{Cambria}
> \usepackage[automark]{scrpage2}
> \clearscrheadfoot
> \ihead{\footnotesize Upper left}
> \cfoot{}
> 
> \begin{document}
> \pagestyle{scrheadings}
> Hello, world.
> \end{document}

Here this runs flawlessly with Cambria Version 1.01.

> $ lualatex -v
> This is LuaTeX, Version beta-0.76.0-2013061817  (TeX Live 2013) (rev 4627)
> 
> The Cambria font is from Microsoft Office 2011 (format: ttf).

What are the file names? If they contain spaces, can you remove
those and try again (delete the cache as well)? If you are
willing to update, the dev version [1] should work with spaces in
filenames.

[1] https://github.com/phi-gamma/luaotfload

Best,

Philipp


-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130702/632f8415/attachment.bin>

From evan.cooch at gmail.com  Tue Jul  2 21:06:00 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 15:06:00 -0400
Subject: [luatex] luaotfload no longer finding fonts in TEXMF
In-Reply-To: <20130702153100.GB24394@phlegethon>
References: <51D2D63C.8040300@gmail.com> <51D2E704.2040607@gmail.com>
 <20130702153100.GB24394@phlegethon>
Message-ID: <51D32498.2000800@gmail.com>




> You should never run luaotfload-tool with root privileges. In
> fact if there was a cross-platform way to check for the uid I
> would make it refuse to run as root. The font index is created in
> the $TEXMFCACHE or $TEXMFVAR of each user. You can find out where
> that is like so:
>
>      kpse.set_program_name "luatex"
>      local dirs = { "$TEXMFCACHE", "$TEXMFVAR" }
>      for i=1, #dirs do
>        print(dirs[i], kpse.expand_path (dirs[i]))
>      end
>
> Of the printed paths the first one that proves to be writable
> wins and is created if it does not yet exist. Since the paths are
> different for root, the index would be written at a location that
> is not writable (or even accessible) with ordinary privileges.

Problem is confused on system (OS) where a 'user' account and a 'root' 
account are de facto the same thing.  There are a number of applications 
(I refuse to say 'apps' as a bit of token personal Luddism on my part) 
where this pairtng of 'run as user' and 'run again as admin' are 
necessary. Some other applications, if you run something as admin, 
migrate things out to each user account, and so forth.  Life is arguably 
simpler is some respects to not install MikteX for 'any user' unless you 
really need to. I generally have installed it that way not out of 
necessity (on most of my machines, I'm the only user) but because tht is 
the default install option, and it hasn't - generally - made much 
difference.

>
>> Either way, seems to work. My original query about 'why we need to
>> do this in the first instance' stands.
> The alternative is sticking with ASCII-only paths.
>
> Anyways, as globbing appears to be unreliable on Windows systems
> I just replaced the calls to dir.glob () with generic directory
> walks. A nice side effect is that the dependency on l-dir.lua is
> unnecessary now, so the next version of luaotfload will ship
> without it.
>
>

Interesting -- will look for it in future.  In the meantime, might be 
worth a general recommendation to simply move font trees out of TEXMF 
and into OS. Sure save a lot of hassles, and confusion for newcomers to 
this issue.


From pintar at post.harvard.edu  Tue Jul  2 22:34:37 2013
From: pintar at post.harvard.edu (Jura Pintar)
Date: Tue, 2 Jul 2013 16:34:37 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7)
In-Reply-To: <mailman.3920.1372778676.3597.luatex@tug.org>
References: <mailman.3920.1372778676.3597.luatex@tug.org>
Message-ID: <51D3395D.7020408@post.harvard.edu>

Dear all,

After thinking about it a bit, I see that there are two different 
problems with luaotfload on my machine.

First, it seems to hang on particular paths that might have something 
weird going on with them; this isn't such a big deal, as long as we 
avoid putting our working directories in odd places.

Second, and this is a bigger problem, when using MiKTeX (x64), the 
location of the cache is not properly resolved (i.e. luaotfload tries 
using the undefined $TEXMFCACHE, instead of trying $TEXMFVAR, and the 
database ends up in the working folder). This, naturally, isn't a 
problem with TeX Live, and since I have the two distributions installed 
in parallel, I can confirm that everything works with it (so presumably 
the problem is not due to some peculiarity of my system).

When the code

local cachepaths=kpse.expand_var('$TEXMFCACHE') or ""
   if cachepaths=="" then
cachepaths=kpse.expand_var('$TEXMFVAR') or ""
   end
if cachepaths=="" then
   cachepaths=kpse.expand_var('$VARTEXMF') or ""
end
if cachepaths=="" then
   cachepaths="."
end

in luaotfload-merged.lua and/or luaotfload-basics-gen.lua is replaced 
with the legacy code

   local cachepaths
   if kpse.expand_var('$TEXMFCACHE')~='$TEXMFCACHE' then
     cachepaths=kpse.expand_var('$TEXMFCACHE')
   elseif kpse.expand_var('$TEXMFVAR')~='$TEXMFVAR' then
     cachepaths=kpse.expand_var('$TEXMFVAR')
   end
   if not cachepaths then
     cachepaths="."
   end

the problem is resolved, and the database is generated and correctly 
placed in the directory determined by $TEXMFVAR.

I haven't much experience at all with Lua so I'm not sure what exactly 
is going on here. I get the legacy code, and why it gets us the right 
result (because $TEXMFCACHE expands to $TEXMFCACHE when it is undefined 
- like under MiKTeX), but I don't quite get the syntax with 'or' in the 
newer code. Do people (esp. Philipp, of course) have an idea why this is 
happening?

Best,

Jura


P.S. On an unrelated note, I've noticed that the compilation time with 
LuaLaTeX under MiKTeX x64 (with all the latest updates) is considerably 
greater than the compilation of the same files under TeX Live (more than 
three times as long for some files, in fact). What might be the reason 
for that?

From evan.cooch at gmail.com  Wed Jul  3 02:17:07 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 20:17:07 -0400
Subject: [luatex] problem after 'in place update'
Message-ID: <51D36D83.1020306@gmail.com>

So, for the past few days, I've been working out the various steps 
needed to get the latest MikTeX 2.9 updates working. In the process, I 
usually did a full re-install of MikTeX, and then updated from there. 
Finlly got things working.

However, on one of my machines, I deciided to try an in place update -- 
not re-installing from scratch. Went through all the same steps. While 
standard laTeX docuemnts compile perfectly, I've had some problems with 
some of my lua* compile attempts, involving an error message I've not 
seen before, but which I think is due to some 'font weirdness' -- I've 
copied the relevant parts of the log below. Can anyone help me decipher 
what the error is, and what I need to do to resolve it.  If it helps, 
I've also put the call to fontspec and related things at the bottom 
(note: this compiled perfectly before the upgrade...and yes, I've 
updated lualatexiniconfig.tex to handle unicode-math. Thats not the 
problem.)

Command Line:   lualatex.exe --shell-escape --enable-write18 
"lecture_notes.tex"
Startup Folder: C:\Users\egc\Desktop\notes

This is LuaTeX, Version beta-0.76.0-2013062419 (rev 4627)
  \write18 enabled.

<snip>


("C:/Program Files (x86)/MiKTeX 
2.9/tex/generic/oberdiek/gettitlestring.sty"))(l
oad luc: 
$TEXMFCACHE/luatex-cache/generic/fonts/otf/lmsans17-regular.luc)(load l
uc: $TEXMFCACHE/luatex-cache/generic/fonts/otf/lmsans10-bold.luc)(load 
luc: $TEX
MFCACHE/luatex-cache/generic/fonts/otf/lmsans17-oblique.luc)
luaotfload | db: reload initiated; reason: ?EURoeunresolved font name: 
?EUR~c?EUR^(TM)?EUR?
luaotfload | db: Font names database saved
! Font \EU2/lmss/m/sl/17.28=c:/program not loadable: metric data not 
found or ba
d.
<to be read again>
f
l.64

?


\usepackage{fontspec}
\setmainfont{Minion Pro}
\usepackage[partial=literal]{unicode-math}
\setmathfont{Asana Math}
\setmathfont[range=\mathup]  {Minion Pro}
\setmathfont[range=\mathbfup]{Minion Pro Bold}
\setmathfont[range=\mathbfit]{Minion Pro Bold Italic}
\setmathfont[range=\mathit]  {Minion Pro Italic}
%%% re-load main math font to ensure correct MATH table values are used:
\setmathfont[range={\mathtt->\mathtt}]{Asana Math}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20130702/c2d2b447/attachment-0001.html>

From evan.cooch at gmail.com  Wed Jul  3 02:31:27 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Tue, 2 Jul 2013 20:31:27 -0400
Subject: [luatex] problem after 'in place update'
In-Reply-To: <51D36D83.1020306@gmail.com>
References: <51D36D83.1020306@gmail.com>
Message-ID: <51D370DF.5000301@gmail.com>


>
>
> \usepackage{fontspec}
> \setmainfont{Minion Pro}
> \usepackage[partial=literal]{unicode-math}
> \setmathfont{Asana Math}
> \setmathfont[range=\mathup]  {Minion Pro}
> \setmathfont[range=\mathbfup]{Minion Pro Bold}
> \setmathfont[range=\mathbfit]{Minion Pro Bold Italic}
> \setmathfont[range=\mathit]  {Minion Pro Italic}
> %%% re-load main math font to ensure correct MATH table values are used:
> \setmathfont[range={\mathtt->\mathtt}]{Asana Math}


For what its worth, simplifying the above to

\usepackage{fontspec}
\setmainfont{Minion Pro}
\usepackage{unicode-math}
\setmathfont{Asana Math}


makes no difference. Same error.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20130702/cb5819f9/attachment.html>

From Philipp.Gesang at alumni.uni-heidelberg.de  Wed Jul  3 10:33:38 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Wed, 3 Jul 2013 10:33:38 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7)
In-Reply-To: <51D3395D.7020408@post.harvard.edu>
References: <mailman.3920.1372778676.3597.luatex@tug.org>
 <51D3395D.7020408@post.harvard.edu>
Message-ID: <20130703083338.GA14773@phlegethon>

Hi Jura!

???<date: 2013-07-02, Tuesday>???<from: Jura Pintar>???

> Dear all,
> 
> After thinking about it a bit, I see that there are two different
> problems with luaotfload on my machine.
> 
> First, it seems to hang on particular paths that might have
> something weird going on with them; this isn't such a big deal, as
> long as we avoid putting our working directories in odd places.
> 
> Second, and this is a bigger problem, when using MiKTeX (x64), the
> location of the cache is not properly resolved (i.e. luaotfload
> tries using the undefined $TEXMFCACHE, instead of trying $TEXMFVAR,
> and the database ends up in the working folder). This, naturally,
> isn't a problem with TeX Live, and since I have the two
> distributions installed in parallel, I can confirm that everything
> works with it (so presumably the problem is not due to some
> peculiarity of my system).
> 
> When the code
> 
> local cachepaths=kpse.expand_var('$TEXMFCACHE') or ""
>   if cachepaths=="" then
> cachepaths=kpse.expand_var('$TEXMFVAR') or ""
>   end
> if cachepaths=="" then
>   cachepaths=kpse.expand_var('$VARTEXMF') or ""
> end
> if cachepaths=="" then
>   cachepaths="."
> end
> 
> in luaotfload-merged.lua and/or luaotfload-basics-gen.lua is
> replaced with the legacy code
> 
>   local cachepaths
>   if kpse.expand_var('$TEXMFCACHE')~='$TEXMFCACHE' then
>     cachepaths=kpse.expand_var('$TEXMFCACHE')
>   elseif kpse.expand_var('$TEXMFVAR')~='$TEXMFVAR' then
>     cachepaths=kpse.expand_var('$TEXMFVAR')
>   end
>   if not cachepaths then
>     cachepaths="."
>   end

This one avoids an extra call (please test):

  local cachepaths = kpse.expand_var('$TEXMFCACHE')
  if cachepaths == "$TEXMFCACHE" then
    cachepaths = kpse.expand_var('$TEXMFVAR')
  end
  if cachepaths == "$TEXMFVAR" then
    cachepaths = kpse.expand_var('$VARTEXMF')
  end

Thanks for bringing that to my attention; I?ve forwarded your bug
report to Hans.

I think I?ll upload a fixed version to CTAN this week.

Best,
Philipp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130703/a4b9932a/attachment.bin>

From evan.cooch at gmail.com  Wed Jul  3 12:54:26 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Wed, 3 Jul 2013 06:54:26 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7)
In-Reply-To: <20130703083338.GA14773@phlegethon>
References: <mailman.3920.1372778676.3597.luatex@tug.org>
 <51D3395D.7020408@post.harvard.edu> <20130703083338.GA14773@phlegethon>
Message-ID: <51D402E2.8020005@gmail.com>

I have a query which *may* be related to this thread - apologies if not.


On 7/3/2013 4:33 AM, Philipp Gesang wrote:
> H
> Second, and this is a bigger problem, when using MiKTeX (x64), the
> location of the cache is not properly resolved (i.e. luaotfload
> tries using the undefined $TEXMFCACHE, instead of trying $TEXMFVAR,
> and the database ends up in the working folder). This, naturally,
> isn't a problem with TeX Live, and since I have the two
> distributions installed in parallel, I can confirm that everything
> works with it (so presumably the problem is not due to some
> peculiarity of my system).
>
> W


I did a MikTeX 2.9  install for 'just' me W9n 7, 32-bit MikTeX), updated 
everything, an all seems to work, but with a behaviour I think is either 
'strange', or 'a problem'.

Specifically, if I try to compile something using lualatex in 
\directory\abc, then the first time I compile the file, luaotfload 
complains about not finding the font database, and then proceeds to 
generate a new one, which is puts in a new subidrectory 
\directory\abc\$TEXMFCACHE, In %TECMFCACHE there is a subdirectory 
called luatex-cache, which contains the generic subdirectory, which 
(finally) contains the names and fonts subdirectories. Now, afte the 
initial comile, then when I re-compile that or any other .tex file in  
\directory\abc, it compiles fine, and doesn't recreate the fonts DB. If 
the file I'm compiling uses a 'new' font, luaotfload recognizes this, 
and then updates the font DB in $TEXMFCACHE, in that directory. So, all 
seems to work...

  ...but, why is $TEXMFCACHE created in each working directory? Why 
isn't it put in some global subdirectory thats in the path, so that it 
isn't recreated everyt time to start working from a new directory (and 
so I don't have $TEXMFCACHE directories all over the place)? Whats 
strange is that when I look at  my user directory (c:\users\egc), I see 
that $TEXMFCACHE is/was created at some point. And while 
C:\Users\egc\$TEXMFCACHE does contain a luatex-cache\generic 
subdirectory, C:\Users\egc\$TEXMFCACHE\luatex-cache\generic contains 
only a names subdirectory (no fonts subdirectory), and \names is empty.

Is this normal behaviour, or a 'bug' for MikTeX installs? Or something 
else altogether?

As I said, things are working fine, but it puzzles me why $TEXMFCACHE is 
being generated for each working directory where I have .tex files I'm 
compiling with lualatex.

Thanks in advance...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20130703/d487613c/attachment.html>

From pintar at post.harvard.edu  Thu Jul  4 01:33:41 2013
From: pintar at post.harvard.edu (Jura Pintar)
Date: Wed, 3 Jul 2013 19:33:41 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7)
In-Reply-To: <mailman.7.1372845601.23803.luatex@tug.org>
References: <mailman.7.1372845601.23803.luatex@tug.org>
Message-ID: <51D4B4D5.6010809@post.harvard.edu>

Hi Philipp,

Glad to be of some use!
> This one avoids an extra call (please test):
>
>    local cachepaths = kpse.expand_var('$TEXMFCACHE')
>    if cachepaths == "$TEXMFCACHE" then
>      cachepaths = kpse.expand_var('$TEXMFVAR')
>    end
>    if cachepaths == "$TEXMFVAR" then
>      cachepaths = kpse.expand_var('$VARTEXMF')
>    end
>
> Thanks for bringing that to my attention; I?ve forwarded your bug
> report to Hans.
>
> I think I?ll upload a fixed version to CTAN this week.
I've tested the latest code and it's working fine. But shouldn't it also 
have

   if cachepaths == "$VARTEXMF" then
     cachepaths = "."
   end

at the end, to maintain the old behaviour, or do you think the 
precautionary behaviour should be changed?

Evan,

> Is this normal behaviour, or a 'bug' for MikTeX installs? Or something
> else altogether?
>
> As I said, things are working fine, but it puzzles me why $TEXMFCACHE is
> being generated for each working directory where I have .tex files I'm
> compiling with lualatex.

There isn't supposed to be a directory *called* $TEXMFCACHE. $TEXMFCACHE 
is a kpathsea variable whose value is the path where the database should 
be created. But this variable is not defined under MiKTeX, and upon 
seeing that it's not defined, luaotfload is supposed to put the database 
in a folder with the path given by the value of the variable $TEXMFVAR 
(the default value in MiKTeX on Win 7 is 
C:\Users\<USERNAME>\AppData\MiKTeX\2.9 and you can test the value on 
your system by typing kpsewhich --expand-var=$TEXMFVAR in the Command 
Prompt, or by looking in the Roots panel of the MiKTeX settings 
application). The bug we've been discussing keeps luaotfload from doing 
that, which is why your database ends up where it does (and the problem 
doesn't apply to TeX Live, because the $TEXMFCACHE variable is defined 
in that setup).

Best,

Jura


From Philipp.Gesang at alumni.uni-heidelberg.de  Thu Jul  4 09:50:12 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Thu, 4 Jul 2013 09:50:12 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7)
In-Reply-To: <51D4B4D5.6010809@post.harvard.edu>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu>
Message-ID: <20130704075012.GB10756@phlegethon>

Hi Jura!

???<date: 2013-07-03, Wednesday>???<from: Jura Pintar>???

> Glad to be of some use!
> >This one avoids an extra call (please test):
> >
> >   local cachepaths = kpse.expand_var('$TEXMFCACHE')
> >   if cachepaths == "$TEXMFCACHE" then
> >     cachepaths = kpse.expand_var('$TEXMFVAR')
> >   end
> >   if cachepaths == "$TEXMFVAR" then
> >     cachepaths = kpse.expand_var('$VARTEXMF')
> >   end
> >
> >Thanks for bringing that to my attention; I?ve forwarded your bug
> >report to Hans.
> >
> >I think I?ll upload a fixed version to CTAN this week.
> I've tested the latest code and it's working fine. But shouldn't it
> also have
> 
>   if cachepaths == "$VARTEXMF" then
>     cachepaths = "."
>   end
>
> at the end, to maintain the old behaviour, or do you think the
> precautionary behaviour should be changed?

Yes, you can add that. There will be some additional fallbacks
(system defaults like for instance /tmp) in the near future.

> >Is this normal behaviour, or a 'bug' for MikTeX installs? Or something
> >else altogether?
> >
> >As I said, things are working fine, but it puzzles me why $TEXMFCACHE is
> >being generated for each working directory where I have .tex files I'm
> >compiling with lualatex.
> 
> There isn't supposed to be a directory *called* $TEXMFCACHE.
> $TEXMFCACHE is a kpathsea variable whose value is the path where the
> database should be created.

Exactly. When the code was moved from expand_path to expand_var,
we kept the check for the empty string, but expand_var returns
the input if it cannot expand the variables. It?s simply a bug
that doesn?t occur on systems (e.g. TL 2013) where both are
defined.

>                             But this variable is not defined under
> MiKTeX, and upon seeing that it's not defined, luaotfload is
> supposed to put the database in a folder with the path given by the
> value of the variable $TEXMFVAR (the default value in MiKTeX on Win
> 7 is C:\Users\<USERNAME>\AppData\MiKTeX\2.9 and you can test the
> value on your system by typing kpsewhich --expand-var=$TEXMFVAR in
> the Command Prompt, or by looking in the Roots panel of the MiKTeX
> settings application). The bug we've been discussing keeps
> luaotfload from doing that, which is why your database ends up where
> it does (and the problem doesn't apply to TeX Live, because the
> $TEXMFCACHE variable is defined in that setup).

Fwiw version 2.3 went up to CTAN yesterday. You can get the zip at:

    https://github.com/lualatex/luaotfload/releases

(choose the tds one). This version introduces incompatible
changes so remember to delete the cache directories after
updating.

Best,
Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130704/e9bc0d99/attachment.bin>

From evan.cooch at gmail.com  Fri Jul  5 21:18:10 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Fri, 5 Jul 2013 15:18:10 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7)
In-Reply-To: <20130704075012.GB10756@phlegethon>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
Message-ID: <51D71BF2.9020006@gmail.com>

Exactly. When the code was moved from expand_path to expand_var, we kept 
the check for the empty string, but expand_var returns the input if it 
cannot expand the variables. It?s simply a bug that doesn?t occur on 
systems (e.g. TL 2013) where both are defined.
>>                              But this variable is not defined under
>> MiKTeX, and upon seeing that it's not defined, luaotfload is
>> supposed to put the database in a folder with the path given by the
>> value of the variable $TEXMFVAR (the default value in MiKTeX on Win
>> 7 is C:\Users\<USERNAME>\AppData\MiKTeX\2.9 and you can test the
>> value on your system by typing kpsewhich --expand-var=$TEXMFVAR in
>> the Command Prompt, or by looking in the Roots panel of the MiKTeX
>> settings application). The bug we've been discussing keeps
>> luaotfload from doing that, which is why your database ends up where
>> it does (and the problem doesn't apply to TeX Live, because the
>> $TEXMFCACHE variable is defined in that setup).
> Fwiw version 2.3 went up to CTAN yesterday. You can get the zip at:
>
>      https://github.com/lualatex/luaotfload/releases
>
> (choose the tds one). This version introduces incompatible
> changes so remember to delete the cache directories after
> updating.
>
> Best,
> Philipp

Well, I haven't done exhaustive testing, but so far, looks like the beta 
code (2.3) is working as it should.


Thanks!!!



From evan.cooch at gmail.com  Fri Jul  5 22:14:55 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Fri, 5 Jul 2013 16:14:55 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20130704075012.GB10756@phlegethon>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
Message-ID: <51D7293F.40509@gmail.com>


>>                              But this variable is not defined under
>> MiKTeX, and upon seeing that it's not defined, luaotfload is
>> supposed to put the database in a folder with the path given by the
>> value of the variable $TEXMFVAR (the default value in MiKTeX on Win
>> 7 is C:\Users\<USERNAME>\AppData\MiKTeX\2.9 and you can test the
>> value on your system by typing kpsewhich --expand-var=$TEXMFVAR in
>> the Command Prompt, or by looking in the Roots panel of the MiKTeX
>> settings application). The bug we've been discussing keeps
>> luaotfload from doing that, which is why your database ends up where
>> it does (and the problem doesn't apply to TeX Live, because the
>> $TEXMFCACHE variable is defined in that setup).
> Fwiw version 2.3 went up to CTAN yesterday. You can get the zip at:
>
>      https://github.com/lualatex/luaotfload/releases
>
> (choose the tds one). This version introduces incompatible
> changes so remember to delete the cache directories after
> updating.
>
>

Quick followup:

1\ so, should running luaotfload-tool --update --force create the 
approrpate names DB and font cache?

If so, then

2\ where is it trying to write it? Using MikTeX 2.9, installed just for 
a single user (me!), under Windows 7.


I ask because I may have spoken too soon about 2.3 working.  I'd run a 
few tests, which seemed to compile, then I remembered I needed to delete 
old cache'. So, went into \users\me\AppData\Local\MikTeX\2.9 and deleted 
luatex-cache (and all the subdirs contained therein).

Then, after rebuilding the .fmt files for luatex and lualatex (just in 
case), tried a simple compile of the MWE I've been using (see earlier 
posts).  Chugs along, then luaotfload | db claims it can't find the DB 
(good), and then says its going to generate a new one. I see that now in 
\users\me\AppData\Local\MikTeX\2.9 and deleted luatex-cache the process 
has created \generic, which contains \names and \\fonts (which contains 
\of and a bunch of fonts).


But...\names is empty!  And, while trying to build the database, I got 
*lots* (dozens and dozens) of messages like

luaotfload  | cache | could not write to cache
luaotfload | cache could not write lookup cache
luaotfload | cach could not write to cache 
[1{C:/Users/me/AppData/Local.../MikTeX/2.9/pdftex/config/pdftex.map


Now, in my MWE, I'm using unicode-math, and Asana Math for the font. 
Ulrike Fischer pointed out that to use unicode-math, you have to hack 
lualatexiniconfig.tex, to add 'umath' to tex.extraprimitives. Did that, 
and rebuilt the .fmt files, yet again.. When I look in 
\generic\fonts\itf, I see asanamath.lua, so luaotfload is at least 
getting that far. But, nothing in the \names directory.

Makes no difference. Every time I try to compile the MWE, luaotfload 
keps trying to rebuild the DB, presumably because it hasn't stored 
anything in \names. So, for the moment, situation is actually worse than 
before. Previously, once the $TEXMFCACHE directory was written in a 
working directory, it was always there, and thus lualatex only had to 
build it the first time.  Now, $TEXMFCACHE isn't being written, at all!

Sorry...



From evan.cooch at gmail.com  Fri Jul  5 22:29:12 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Fri, 5 Jul 2013 16:29:12 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20130704075012.GB10756@phlegethon>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
Message-ID: <51D72C98.2050103@gmail.com>

Sorry about the length of the following, but I thought the complete log 
from my last attempt to compile the MWE might be informative. Also, 
worth noting the MWE does, eventually compile, and the PDF is generated, 
but the DB is *not* being created, which means luaotfload trys to 
recreate it every time I try to compile something.

Needless to say, that won't suffice.... ;-)

Here is the log:

This is LuaTeX, Version beta-0.76.0-2013062419 (rev 4627) 
(format=lualatex 2013.7.5) 5 JUL 2013 16:16
\write18 enabled.
**lua-mwe.tex
(C:/Users/egc/Desktop/crap/lua-mwe.tex
LaTeX2e <2011/06/27>
Babel <v3.8m> and hyphenation patterns for english, afrikaans, 
ancientgreek, ara
bic, armenian, assamese, basque, bengali, bokmal, bulgarian, catalan, 
coptic, cr
oatian, czech, danish, dutch, esperanto, estonian, farsi, finnish, 
french, galic
ian, german, german-x-2013-05-26, greek, gujarati, hindi, hungarian, 
icelandic,
indonesian, interlingua, irish, italian, kannada, kurmanji, latin, 
latvian, lith
uanian, malayalam, marathi, mongolian, mongolianlmc, monogreek, ngerman, 
ngerman
-x-2013-05-26, nynorsk, oriya, panjabi, pinyin, polish, portuguese, 
romanian, ru
ssian, sanskrit, serbian, slovak, slovenian, spanish, swedish, 
swissgerman, tami
l, telugu, turkish, turkmen, ukenglish, ukrainian, uppersorbian, 
usenglishmax, w
elsh, loaded.
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/base/size11.clo
File: size11.clo 2007/10/19 v1.4h Standard LaTeX file (size option)
)
\c at part=\count79
\c at section=\count80
\c at subsection=\count81
\c at subsubsection=\count82
\c at paragraph=\count83
\c at subparagraph=\count84
\c at figure=\count85
\c at table=\count86
\abovecaptionskip=\skip41
\belowcaptionskip=\skip42
\bibindent=\dimen102
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/fontspec/fontspec.sty
Package: fontspec 2013/05/20 v2.3c Font selection for XeLaTeX and LuaLaTeX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/expl3.sty
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3names.sty
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3bootstrap.sty
Package: l3bootstrap 2013/01/08 v4420 L3 Experimental bootstrap code

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/luatex.sty
Package: luatex 2010/03/09 v0.4 LuaTeX basic definition package (HO)

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/infwarerr.sty
Package: infwarerr 2010/04/08 v1.3 Providing info/warning/error messages 
(HO)
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/ifluatex.sty
Package: ifluatex 2010/03/01 v1.3 Provides the ifluatex switch (HO)
Package ifluatex Info: LuaTeX detected.
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/misc/etex.sty
Package: etex 1998/03/26 v2.0 eTeX basic definition package (PEB)
\et at xins=\count87
)
\LuT at AllocAttribute=\count277
\LuT at AllocCatcodeTable=\count278
\CatcodeTableStack=\count279
\CatcodeTableIniTeX=\catcodetable1
\CatcodeTableString=\catcodetable3
\CatcodeTableOther=\catcodetable5
\CatcodeTableLaTeX=\catcodetable7

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/luatex-loader.sty
Package: luatex-loader 2010/03/09 v0.4 Lua module loader (HO)

(C:/Users/egc/Desktop/egc/text/MikTeX/scripts/oberdiek/oberdiek.luatex.lua)))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/pdftexcmds.sty
Package: pdftexcmds 2011/11/29 v0.20 Utility functions of pdfTeX for 
LuaTeX (HO)


(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/ltxcmds.sty
Package: ltxcmds 2011/11/09 v1.22 LaTeX kernel commands for general use (HO)
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/ifpdf.sty
Package: ifpdf 2011/01/30 v2.3 Provides the ifpdf switch (HO)
Package ifpdf Info: pdfTeX in PDF mode is detected.
)
Package pdftexcmds Info: \pdf at primitive is available.
Package pdftexcmds Info: \pdf at ifprimitive is available.
Package pdftexcmds Info: \pdfdraftmode found.
\pdftexcmds at toks=\toks14
))
Package: l3names 2012/12/07 v4346 L3 Namespace for primitives
)
Package: expl3 2013/03/14 v4469 L3 Experimental code bundle wrapper

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3basics.sty
Package: l3basics 2013/01/10 v4428 L3 Basic definitions
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3expan.sty
Package: l3expan 2013/02/03 v4458 L3 Argument expansion
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3tl.sty
Package: l3tl 2013/01/08 v4415 L3 Token lists
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3seq.sty
Package: l3seq 2013/01/12 v4434 L3 Sequences and stacks
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3int.sty
Package: l3int 2013/01/13 v4444 L3 Integers
\c_max_int=\count280
\l_tmpa_int=\count281
\l_tmpb_int=\count282
\g_tmpa_int=\count283
\g_tmpb_int=\count284
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3quark.sty
Package: l3quark 2012/11/04 v4268 L3 Quarks
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3prg.sty
Package: l3prg 2013/02/13 v4459 L3 Control structures
\g__prg_map_int=\count285
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3clist.sty
Package: l3clist 2013/01/08 v4414 L3 Comma separated lists
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3token.sty
Package: l3token 2013/01/10 v4428 L3 Experimental token manipulation
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3prop.sty
Package: l3prop 2013/01/09 v4423 L3 Property lists
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3msg.sty
Package: l3msg 2013/01/08 v4412 L3 Messages
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3file.sty
Package: l3file 2013/01/14 v4446 L3 File and I/O operations
\l_iow_line_count_int=\count286
\l__iow_target_count_int=\count287
\l__iow_current_line_int=\count288
\l__iow_current_word_int=\count289
\l__iow_current_indentation_int=\count290
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3skip.sty
Package: l3skip 2013/01/13 v4444 L3 Dimensions and skips
\c_zero_dim=\dimen256
\c_max_dim=\dimen257
\l_tmpa_dim=\dimen258
\l_tmpb_dim=\dimen259
\g_tmpa_dim=\dimen260
\g_tmpb_dim=\dimen261
\c_zero_skip=\skip256
\c_max_skip=\skip257
\l_tmpa_skip=\skip258
\l_tmpb_skip=\skip259
\g_tmpa_skip=\skip260
\g_tmpb_skip=\skip261
\c_zero_muskip=\muskip10
\c_max_muskip=\muskip11
\l_tmpa_muskip=\muskip12
\l_tmpb_muskip=\muskip13
\g_tmpa_muskip=\muskip14
\g_tmpb_muskip=\muskip15
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3keys.sty
Package: l3keys 2013/02/24 v4461 L3 Experimental key-value interfaces
\g__keyval_level_int=\count291
\l_keys_choice_int=\count292
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3fp.sty
Package: l3fp 2013/01/19 v4449 L3 Floating points
\c__fp_leading_shift_int=\count293
\c__fp_middle_shift_int=\count294
\c__fp_trailing_shift_int=\count295
\c__fp_big_leading_shift_int=\count296
\c__fp_big_middle_shift_int=\count297
\c__fp_big_trailing_shift_int=\count298
\c__fp_Bigg_leading_shift_int=\count299
\c__fp_Bigg_middle_shift_int=\count300
\c__fp_Bigg_trailing_shift_int=\count301
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3box.sty
Package: l3box 2013/01/08 v4411 L3 Experimental boxes
\c_empty_box=\box256
\l_tmpa_box=\box257
\l_tmpb_box=\box258
\g_tmpa_box=\box259
\g_tmpb_box=\box260
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3coffins.sty
Package: l3coffins 2012/09/09 v4212 L3 Coffin code layer
\l__coffin_internal_box=\box261
\l__coffin_internal_dim=\dimen262
\l__coffin_offset_x_dim=\dimen263
\l__coffin_offset_y_dim=\dimen264
\l__coffin_x_dim=\dimen265
\l__coffin_y_dim=\dimen266
\l__coffin_x_prime_dim=\dimen267
\l__coffin_y_prime_dim=\dimen268
\c_empty_coffin=\box262
\l__coffin_aligned_coffin=\box263
\l__coffin_aligned_internal_coffin=\box264
\l_tmpa_coffin=\box265
\l_tmpb_coffin=\box266
\l__coffin_display_coffin=\box267
\l__coffin_display_coord_coffin=\box268
\l__coffin_display_pole_coffin=\box269
\l__coffin_display_offset_dim=\dimen269
\l__coffin_display_x_dim=\dimen270
\l__coffin_display_y_dim=\dimen271
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3color.sty
Package: l3color 2012/08/29 v4156 L3 Experimental color support
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3luatex.sty
Package: l3luatex 2012/08/03 v4049 L3 Experimental LuaTeX-specific functions
\g__cctab_allocate_int=\count302
\g__cctab_stack_int=\count303
\c_code_cctab=\catcodetable9
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3kernel/l3candidates.sty
Package: l3candidates 2013/03/14 v4468 L3 Experimental additions to l3kernel
\l__box_top_dim=\dimen272
\l__box_bottom_dim=\dimen273
\l__box_left_dim=\dimen274
\l__box_right_dim=\dimen275
\l__box_top_new_dim=\dimen276
\l__box_bottom_new_dim=\dimen277
\l__box_left_new_dim=\dimen278
\l__box_right_new_dim=\dimen279
\l__box_internal_box=\box270
\l__coffin_bounding_shift_dim=\dimen280
\l__coffin_left_corner_dim=\dimen281
\l__coffin_right_corner_dim=\dimen282
\l__coffin_bottom_corner_dim=\dimen283
\l__coffin_top_corner_dim=\dimen284
\l__coffin_scaled_total_height_dim=\dimen285
\l__coffin_scaled_width_dim=\dimen286
))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3packages/xparse/xparse.sty
Package: xparse 2013/03/12 v4467 L3 Experimental document command parser
\l__xparse_current_arg_int=\count304
\l__xparse_m_args_int=\count305
\l__xparse_mandatory_args_int=\count306
\l__xparse_processor_int=\count307
\l__xparse_v_nesting_int=\count308
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload.sty
Package: luaotfload 2013/05/23 v2.3d OpenType layout system

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase.sty
Package: luatexbase 2013/05/11 v0.6 Resource management for the LuaTeX 
macro pro
grammer

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-compat.s
ty
Package: luatexbase-compat 2011/05/24 v0.4 Compatibility tools for LuaTeX
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-modutils
.sty
Package: luatexbase-modutils 2013/05/11 v0.6 Module utilities for LuaTeX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-loader.s
ty
Package: luatexbase-loader 2013/05/11 v0.6 Lua module loader for LuaTeX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase.loader.lu
a))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/modutils.lua)
Lua module: luatexbase-modutils 2013/05/11 0.6 Module utilities for LuaTeX
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-regs.sty
Package: luatexbase-regs 2011/05/24 v0.4 Registers allocation for LuaTeX
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-attr.sty
Package: luatexbase-attr 2013/05/11 v0.6 Attributes allocation for LuaTeX
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/attr.lua)
Lua module: luatexbase-attr 2013/05/11 0.6 Attributes allocation for LuaTeX
\lltxb at attr@unsetvalue=\count309
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-cctb.sty
Package: luatexbase-cctb 2013/05/11 v0.6 Catcodetable allocation for LuaTeX
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/cctb.lua)
Lua module: luatexbase-cctb 2013/05/11 0.6 Catcodetable allocation for 
LuaTeX
\lltxb at catcodetable@alloc=\count310
\CatcodeTableStack=\count311
\CatcodeTableIniTeX=\luatexcatcodetable1
\CatcodeTableString=\luatexcatcodetable3
\CatcodeTableOther=\luatexcatcodetable5
\CatcodeTableLaTeX=\luatexcatcodetable7
\CatcodeTableLaTeXAtLetter=\luatexcatcodetable9
\CatcodeTableExpl=\luatexcatcodetable11
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/luatexbase-mcb.sty
Package: luatexbase-mcb 2013/05/11 v0.6 Callback management for LuaTeX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luatexbase/mcb.lua)
Lua module: luatexbase-mcb 2013/05/11 0.6 register several functions in 
a callba
ck
))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload.lua)
Lua module: luaotfload 2013/06/02 2.3 OpenType layout system.
luaotfload: push namespace for font loader
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-merged.lu
a)(using cache: C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic)
luatexbase-attr: luatexbase.attributes["luaotfload at kernpair"] = 1
luatexbase-attr: luatexbase.attributes["luaotfload at ligacomp"] = 2
luatexbase-attr: luatexbase.attributes["luaotfload at markbase"] = 3
luatexbase-attr: luatexbase.attributes["luaotfload at markmark"] = 4
luatexbase-attr: luatexbase.attributes["luaotfload at markdone"] = 5
luatexbase-attr: luatexbase.attributes["luaotfload at cursbase"] = 6
luatexbase-attr: luatexbase.attributes["luaotfload at curscurs"] = 7
luatexbase-attr: luatexbase.attributes["luaotfload at cursdone"] = 8
luatexbase-attr: luatexbase.attributes["luaotfload at state"] = 9
luaotfload: ???I am using the merged version of 'luaotfload.lua' here. If
luaotfload: you run into problems or experience unexpected behaviour,
luaotfload: and if you have ConTeXt installed you can try to delete the
luaotfload: file 'luaotfload-font-merged.lua' as I might then use the
luaotfload: possibly updated libraries. The merged version is not
luaotfload: supported as it is a frozen instance. Problems can be
luaotfload: reported to the ConTeXt mailing list.???
luaotfload: pop namespace from font loader -- non-destructive
luaotfload: fontloader loaded in 0.156 seconds
luatexbase-mcb: inserting 'luaotfload.node_processor'
at position 1 in 'pre_linebreak_filter'
luatexbase-mcb: inserting 'luaotfload.node_processor'
at position 1 in 'hpack_filter'
luatexbase-mcb: inserting 'luaotfload.find_vf_file'
at position 1 in 'find_vf_file'
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-override.
lua)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-loaders.l
ua)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-database.
lua)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-colors.lu
a)
luatexbase-mcb: creating 'luaotfload.resolve_font' type 4
luatexbase-mcb: creating 'luaotfload.patch_font' type 4
luatexbase-mcb: resetting callback 'define_font'
luatexbase-mcb: inserting 'luaotfload.define_font'
at position 1 in 'define_font'
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-features.
lua)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-extralibs
.lua)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-typo-krn.
lua)
luatexbase-attr: luatexbase.attributes["luaotfload at kern"] = 12
luatexbase-attr: luatexbase.attributes["luaotfload at fontkern"] = 13
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-letterspa
ce.lua)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/luatex/luaotfload/luaotfload-auxiliary
.lua)
luatexbase-mcb: inserting 'luaotfload.rewrite_fontname'
at position 1 in 'luaotfload.patch_font'
luatexbase-mcb: inserting 'luaotfload.aux.set_sscale_dimens'
at position 2 in 'luaotfload.patch_font'
luatexbase-mcb: inserting 'luaotfload.aux.patch_cambria_domh'
at position 3 in 'luaotfload.patch_font'
luatexbase-mcb: inserting 'luaotfload.aux.set_capheight'
at position 4 in 'luaotfload.patch_font')
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/fontspec/fontspec.lua)
Lua module: fontspec 2013/05/20 2.3c Advanced font selection for LuaLaTeX.
\l_fontspec_script_int=\count312
\l_fontspec_language_int=\count313
\l_fontspec_strnum_int=\count314
\l_fontspec_tmpa_dim=\dimen287
\l_fontspec_tmpb_dim=\dimen288
\l_fontspec_tmpc_dim=\dimen289
Variant \tl_gset:cV already defined; not changing it on line 69

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/fontspec/fontspec-patches.sty
Package: fontspec-patches 2013/05/20 v2.3c Font selection for XeLaTeX 
and LuaLaT
eX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/base/fixltx2e.sty
Package: fixltx2e 2006/09/13 v1.1m fixes to LaTeX
LaTeX Info: Redefining \em on input line 420.
)
LaTeX Info: Redefining \em on input line 22.
LaTeX Info: Redefining \emph on input line 30.
LaTeX Info: Redefining \- on input line 33.

*************************************************
* LaTeX warning: "xparse/redefine-command"
*
* Redefining document command \oldstylenums with arg. spec. 'm' on line 128.
*************************************************
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \liningnums with arg. spec. 'm' on line 132.
.................................................
) 
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/fontspec/fontspec-luatex.sty
Package: fontspec-luatex 2013/05/20 v2.3c Font selection for XeLaTeX and 
LuaLaTe
X

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/base/fontenc.sty
Package: fontenc 2005/09/27 v1.99g Standard LaTeX package

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/euenc/eu2enc.def
File: eu2enc.def 2010/05/27 v0.1h Experimental Unicode font encodings
)
LaTeX Font Info: Try loading font information for EU2+lmr on input line 100.

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/euenc/eu2lmr.fd
File: eu2lmr.fd 2009/10/30 v1.6 Font defs for Latin Modern
)
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???
luaotfload | db: Font names database not found, generating new one.
luaotfload | db : Font names database not found, generating new one.
luaotfload | db: This can take several minutes; please be patient.
luaotfload | db : This can take several minutes; please be patient.
luaotfload | db: Failed to save names database
luaotfload | db : Failed to save names database
luaotfload | db: Database creation unsuccessful.
luaotfload | db : Database creation unsuccessful.(load luc: 
C:/Users/egc/AppData
/Local/MiKTeX/2.9/luatex-cache/generic/fonts/otf/lmroman10-regular.luc))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/xelatex/xunicode/xunicode.sty
File: xunicode.sty 2011/09/09 v0.981 provides access to latin accents 
and many o
ther characters in Unicode lower plane

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/tipa/t3enc.def
File: t3enc.def 2001/12/31 T3 encoding
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???(load luc: 
C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/fonts/o
tf/lmromanslant10-regular.luc)
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???(load luc: 
C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/fonts/o
tf/lmroman10-italic.luc)
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???(load luc: 
C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/fonts/o
tf/lmroman10-bold.luc)
LaTeX Font Info: Try loading font information for EU2+lmss on input line 
357.


(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/euenc/eu2lmss.fd
File: eu2lmss.fd 2009/10/30 v1.6 Font defs for Latin Modern
)
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???(load luc: 
C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/fonts/o
tf/lmsans10-regular.luc))
\tipaTiiicode=\count315
\tipasavetokens=\toks15
\tipachecktokens=\toks16
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/graphics/graphicx.sty
Package: graphicx 1999/02/16 v1.0f Enhanced LaTeX Graphics (DPC,SPQR)

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/graphics/keyval.sty
Package: keyval 1999/03/16 v1.13 key=value parser (DPC)
\KV at toks@=\toks17
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/graphics/graphics.sty
Package: graphics 2009/02/05 v1.0o Standard LaTeX Graphics (DPC,SPQR)

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/graphics/trig.sty
Package: trig 1999/03/16 v1.09 sin cos tan (DPC)
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/00miktex/graphics.cfg
File: graphics.cfg 2007/01/18 v1.5 graphics configuration of teTeX/TeXLive
)
Package graphics Info: Driver file: pdftex.def on input line 91.

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/pdftex-def/pdftex.def
File: pdftex.def 2011/05/27 v0.06d Graphics/color for pdfTeX
\Gread at gobject=\count316
))
\Gin at req@height=\dimen290
\Gin at req@width=\dimen291
))
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \fontspec with arg. spec. 'O{}m' on line 44.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setmainfont with arg. spec. 'O{}m' on line 49.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setsansfont with arg. spec. 'O{}m' on line 54.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setmonofont with arg. spec. 'O{}m' on line 59.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setmathrm with arg. spec. 'O{}m' on line 68.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setboldmathrm with arg. spec. 'O{}m' on 
line 72.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setmathsf with arg. spec. 'O{}m' on line 76.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setmathtt with arg. spec. 'O{}m' on line 80.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newfontfamily with arg. spec. 'mO{}m' on 
line 99.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newfontface with arg. spec. 'mO{}m' on line 
103.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \defaultfontfeatures with arg. spec. 'om' on 
line
. 111.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \addfontfeatures with arg. spec. 'm' on line 
147.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newfontfeature with arg. spec. 'mm' on line 
159.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newAATfeature with arg. spec. 'mmmm' on 
line 167.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newICUfeature with arg. spec. 'mmm' on line 
175.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \aliasfontfeature with arg. spec. 'mm' on line
. 204.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \aliasfontfeatureoption with arg. spec. 'mmm' on
. line 206.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newfontscript with arg. spec. 'mm' on line 211.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \newfontlanguage with arg. spec. 'mm' on 
line 238.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \DeclareFontsExtensions with arg. spec. 'm' on
. line 259.
.................................................
Variant \prop_gput:cnV already defined; not changing it on line 586
Variant \prop_gput:cnx already defined; not changing it on line 587
\l_fontspec_tmp_int=\count317
LaTeX Info: Redefining \itshape on input line 2008.
LaTeX Info: Redefining \slshape on input line 2013.
LaTeX Info: Redefining \scshape on input line 2018.
LaTeX Info: Redefining \upshape on input line 2023.

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/fontspec/fontspec.cfg)))
\g__file_internal_ior=\read1
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | cache: No lookup cache, creating empty.
luaotfload | cache : No lookup cache, creating empty.
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache(load luc: 
C:/Users/egc/AppData/Loc
al/MiKTeX/2.9/luatex-cache/generic/fonts/otf/minionpro-regular.luc)
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 21 (MinionPro-Regular) defines feature kern for 
script latn
luaotfload: font no 21 (MinionPro-Regular) defines feature kern for 
script latn
\g_fontspec_family_Minion Pro_int=\count318
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 21 (MinionPro-Regular) defines feature smcp for 
script latn
with language dflt
luaotfload: font no 21 (MinionPro-Regular) defines feature smcp for 
script latn
with language dflt
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='bold' found: 
minionpro
-bold.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache(load luc: 
C:/Users/egc/AppData/Loc
al/MiKTeX/2.9/luatex-cache/generic/fonts/otf/minionpro-bold.luc)
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='bold' found: 
minionpro
-bold.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 22 (MinionPro-Bold) defines feature smcp for script 
latn wit
h language dflt
luaotfload: font no 22 (MinionPro-Bold) defines feature smcp for script 
latn wit
h language dflt
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='italic' found: 
minionp
ro-it.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache(load luc: 
C:/Users/egc/AppData/Loc
al/MiKTeX/2.9/luatex-cache/generic/fonts/otf/minionpro-it.luc)
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='italic' found: 
minionp
ro-it.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 23 (MinionPro-It) defines feature smcp for script 
latn with
language dflt
luaotfload: font no 23 (MinionPro-It) defines feature smcp for script 
latn with
language dflt
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='bolditalic' 
found: min
ionpro-boldit.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache(load luc: 
C:/Users/egc/AppData/Loc
al/MiKTeX/2.9/luatex-cache/generic/fonts/otf/minionpro-boldit.luc)
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='minionpro', subfamily='bolditalic' 
found: min
ionpro-boldit.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 24 (MinionPro-BoldIt) defines feature smcp for 
script latn w
ith language dflt
luaotfload: font no 24 (MinionPro-BoldIt) defines feature smcp for 
script latn w
ith language dflt
.................................................
. fontspec info: "defining-font"
.
. Font family 'MinionPro(0)' created for font 'Minion Pro' with options [].
.
. This font family consists of the following shapes:
.
. * 'normal' with NFSS spec.:
. <->"MinionPro:mode=node;script=latn;language=DFLT;"
.
. * 'small caps' with NFSS spec.:
. <->"MinionPro:mode=node;script=latn;language=DFLT;+smcp;"
.
. * 'bold' with NFSS spec.:
. <->"MinionPro/B:mode=node;script=latn;language=DFLT;"
.
. * 'bold small caps' with NFSS spec.:
. <->"MinionPro/B:mode=node;script=latn;language=DFLT;+smcp;"
.
. * 'italic' with NFSS spec.:
. <->"MinionPro/I:mode=node;script=latn;language=DFLT;"
.
. * 'italic small caps' with NFSS spec.:
. <->"MinionPro/I:mode=node;script=latn;language=DFLT;+smcp;"
.
. * 'bold italic' with NFSS spec.:
. <->"MinionPro/BI:mode=node;script=latn;language=DFLT;"
.
. * 'bold italic small caps' with NFSS spec.:
. <->"MinionPro/BI:mode=node;script=latn;language=DFLT;+smcp;"
.................................................
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/unicode-math/unicode-math.sty
Package: unicode-math 2013/05/04 v0.7e Unicode maths in XeLaTeX and LuaLaTeX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/ifxetex/ifxetex.sty
Package: ifxetex 2010/09/12 v0.6 Provides ifxetex conditional
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/l3packages/l3keys2e/l3keys2e.st
y
Package: l3keys2e 2013/03/12 v4467 LaTeX2e option processing using 
LaTeX3 keys
) (C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/catchfile.sty
Package: catchfile 2011/03/01 v1.6 Catch the contents of a file (HO)

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/generic/oberdiek/etexcmds.sty
Package: etexcmds 2011/02/16 v1.5 Avoid name clashes with e-TeX commands 
(HO)
))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/base/fix-cm.sty
Package: fix-cm 2006/09/13 v1.1m fixes to LaTeX

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/base/ts1enc.def
File: ts1enc.def 2001/06/05 v3.0e (jk/car/fm) Standard LaTeX file
))
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/filehook/filehook.sty
Package: filehook 2011/10/12 v0.5d Hooks for input files
)
Variant \tl_put_right:cx already defined; not changing it on line 50
Variant \seq_if_in:NVTF already defined; not changing it on line 51
\g_um_fam_int=\count319
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \unimathsetup with arg. spec. 'm' on line 108.
.................................................

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/unicode-math/unicode-math-luate
x.sty
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/lualatex/lualatex-math/lualatex-math.
sty
Package: lualatex-math 2013/01/13 v1.2 Patches for mathematics 
typesetting with
LuaLaTeX
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/etoolbox/etoolbox.sty
Package: etoolbox 2011/01/03 v2.1 e-TeX tools for LaTeX
\etb at tempcnta=\count320
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/lualatex/lualatex-math/lualatex-math.l
ua)
Lua module: lualatex-math 2011/05/05 0.1 Patches for mathematics 
typesetting wit
h LuaLaTeX
.................................................
. lualatex-math info: "patch-macro"
.
. I'm going to patch macro \new at mathgroup.
.................................................
)
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/unicode-math/unicode-math.lua)
Lua module: unicode-math 2013/05/04 0.3 Unicode math typesetting for 
LuaLaTeX
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \setmathfont with arg. spec. 'O{}m' on line 441.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \addnolimits with arg. spec. 'm' on line 639.
.................................................
.................................................
. LaTeX info: "xparse/define-command"
.
. Defining document command \removenolimits with arg. spec. 'm' on line 642.
.................................................

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/unicode-math/unicode-math-table
.tex)
\g_um_primekern_muskip=\muskip16
\l_um_primecount_int=\count321
))
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache(load luc: 
C:/Users/egc/AppData/Loc
al/MiKTeX/2.9/luatex-cache/generic/fonts/otf/asana-math.luc)
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 26 (Asana-Math) defines feature kern for script math
\g_fontspec_family_Asana Math_int=\count322
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 26 (Asana-Math) defines feature ssty for script math 
with la
nguage dflt
luaotfload: font no 26 (Asana-Math) defines feature ssty for script math 
with la
nguage dflt
luaotfload: font no 26 (Asana-Math) does not define feature smcp for 
script math
with language dflt
luaotfload: no font with id 26
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='bold' found: 
asana-mat
h.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
.................................................
. fontspec info: "no-font-shape"
.
. Could not resolve font AsanaMath/B (it probably doesn't exist).
.................................................
.................................................
. fontspec info: "defining-font"
.
. Font family 'AsanaMath(0)' created for font 'Asana Math' with options
. 
[Renderer=Basic,BoldItalicFont={},ItalicFont={},Script=Math,SizeFeatures={{Siz
e=10-},{Size=7-10,Font=Asana
. Math,Style=MathScript},{Size=-7,Font=Asana 
Math,Style=MathScriptScript}},].
.
. This font family consists of the following shapes:
.
. * 'normal' with NFSS spec.:
.
. 
<10->"AsanaMath:mode=base;script=math;language=DFLT;"<7-10>"AsanaMath:mode=bas
e;script=math;language=DFLT;+ssty=0;"<-7>"AsanaMath:mode=base;script=math;langua
ge=DFLT;+ssty=1;"
.................................................
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 27 (Asana-Math) defines feature kern for script math
LaTeX Font Info: Encoding `OT1' has changed to `EU2' for symbol font
(Font) `operators' in the math version `normal' on input line 6.
LaTeX Font Info: Overwriting symbol font `operators' in version `normal'
(Font) OT1/cmr/m/n --> EU2/AsanaMath(0)/m/n on input line 6.
LaTeX Font Info: Encoding `OT1' has changed to `EU2' for symbol font
(Font) `operators' in the math version `bold' on input line 6.
LaTeX Font Info: Overwriting symbol font `operators' in version `bold'
(Font) OT1/cmr/bx/n --> EU2/AsanaMath(0)/bx/n on input line 6.
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 26 (Asana-Math) defines feature kern for script math
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 26 (Asana-Math) defines feature ssty for script math 
with la
nguage dflt
luaotfload: font no 26 (Asana-Math) defines feature ssty for script math 
with la
nguage dflt
luaotfload: font no 26 (Asana-Math) does not define feature smcp for 
script math
with language dflt
luaotfload: no font with id 26
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='bold' found: 
asana-mat
h.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
.................................................
. fontspec info: "no-font-shape"
.
. Could not resolve font AsanaMath/B (it probably doesn't exist).
.................................................
.................................................
. fontspec info: "defining-font"
.
. Font family 'AsanaMath(1)' created for font 'Asana Math' with options
. 
[Renderer=Basic,BoldItalicFont={},ItalicFont={},Script=Math,SizeFeatures={{Siz
e=10-},{Size=7-10,Font=Asana
. Math,Style=MathScript},{Size=-7,Font=Asana
. Math,Style=MathScriptScript}},,Scale=1.00001,FontAdjustment={\fontdimen
. 8\font =475136sp\relax \fontdimen 9\font =393216sp\relax \fontdimen 
10\font
. =32768sp\relax \fontdimen 11\font =465305.6sp\relax \fontdimen 12\font
. =327680sp\relax \fontdimen 13\font =236584.96sp\relax \fontdimen 14\font
. =236584.96sp\relax \fontdimen 15\font =193986.56sp\relax \fontdimen 
16\font
. =137625.6sp\relax \fontdimen 17\font =0sp\relax \fontdimen 18\font
. =150732.8sp\relax \fontdimen 19\font =145489.92sp\relax \fontdimen 20\font
. =0pt\relax \fontdimen 21\font =0pt\relax \fontdimen 22\font
. =177602.56sp\relax }].
.
. This font family consists of the following shapes:
.
. * 'normal' with NFSS spec.:
.
. 
<10->s*[1.00001]"AsanaMath:mode=base;script=math;language=DFLT;"<7-10>s*[1.000
01]"AsanaMath:mode=base;script=math;language=DFLT;+ssty=0;"<-7>s*[1.00001]"Asana
Math:mode=base;script=math;language=DFLT;+ssty=1;"
. and font adjustment code:
. \fontdimen 8\font =475136sp\relax \fontdimen 9\font =393216sp\relax
. \fontdimen 10\font =32768sp\relax \fontdimen 11\font =465305.6sp\relax
. \fontdimen 12\font =327680sp\relax \fontdimen 13\font =236584.96sp\relax
. \fontdimen 14\font =236584.96sp\relax \fontdimen 15\font 
=193986.56sp\relax
. \fontdimen 16\font =137625.6sp\relax \fontdimen 17\font =0sp\relax
. \fontdimen 18\font =150732.8sp\relax \fontdimen 19\font =145489.92sp\relax
. \fontdimen 20\font =0pt\relax \fontdimen 21\font =0pt\relax \fontdimen
. 22\font =177602.56sp\relax
.................................................
LaTeX Font Info: Encoding `OMS' has changed to `EU2' for symbol font
(Font) `symbols' in the math version `normal' on input line 6.
LaTeX Font Info: Overwriting symbol font `symbols' in version `normal'
(Font) OMS/cmsy/m/n --> EU2/AsanaMath(1)/m/n on input line 6.
LaTeX Font Info: Encoding `OMS' has changed to `EU2' for symbol font
(Font) `symbols' in the math version `bold' on input line 6.
LaTeX Font Info: Overwriting symbol font `symbols' in version `bold'
(Font) OMS/cmsy/b/n --> EU2/AsanaMath(1)/bx/n on input line 6.
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 26 (Asana-Math) defines feature kern for script math
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload: font no 26 (Asana-Math) defines feature ssty for script math 
with la
nguage dflt
luaotfload: font no 26 (Asana-Math) defines feature ssty for script math 
with la
nguage dflt
luaotfload: font no 26 (Asana-Math) does not define feature smcp for 
script math
with language dflt
luaotfload: no font with id 26
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | resolve: Font family='asanamath', subfamily='bold' found: 
asana-mat
h.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
.................................................
. fontspec info: "no-font-shape"
.
. Could not resolve font AsanaMath/B (it probably doesn't exist).
.................................................
.................................................
. fontspec info: "defining-font"
.
. Font family 'AsanaMath(2)' created for font 'Asana Math' with options
. 
[Renderer=Basic,BoldItalicFont={},ItalicFont={},Script=Math,SizeFeatures={{Siz
e=10-},{Size=7-10,Font=Asana
. Math,Style=MathScript},{Size=-7,Font=Asana
. Math,Style=MathScriptScript}},,Scale=0.99999,FontAdjustment={\fontdimen
. 8\font =38666.24sp\relax \fontdimen 9\font =72744.96sp\relax \fontdimen
. 10\font =109445.12sp\relax \fontdimen 11\font =131072sp\relax \fontdimen
. 12\font =393216sp\relax \fontdimen 13\font =0pt\relax }].
.
. This font family consists of the following shapes:
.
. * 'normal' with NFSS spec.:
.
. 
<10->s*[0.99999]"AsanaMath:mode=base;script=math;language=DFLT;"<7-10>s*[0.999
99]"AsanaMath:mode=base;script=math;language=DFLT;+ssty=0;"<-7>s*[0.99999]"Asana
Math:mode=base;script=math;language=DFLT;+ssty=1;"
. and font adjustment code:
. \fontdimen 8\font =38666.24sp\relax \fontdimen 9\font =72744.96sp\relax
. \fontdimen 10\font =109445.12sp\relax \fontdimen 11\font =131072sp\relax
. \fontdimen 12\font =393216sp\relax \fontdimen 13\font =0pt\relax
.................................................
LaTeX Font Info: Encoding `OMX' has changed to `EU2' for symbol font
(Font) `largesymbols' in the math version `normal' on input line 6.

LaTeX Font Info: Overwriting symbol font `largesymbols' in version `normal'
(Font) OMX/cmex/m/n --> EU2/AsanaMath(2)/m/n on input line 6.
LaTeX Font Info: Encoding `OMX' has changed to `EU2' for symbol font
(Font) `largesymbols' in the math version `bold' on input line 6.
LaTeX Font Info: Overwriting symbol font `largesymbols' in version `bold'
(Font) OMX/cmex/m/n --> EU2/AsanaMath(2)/bx/n on input line 6.
.................................................
. lualatex-math info: "patch-macro"
.
. I'm going to patch macro \frac.
.................................................

(C:/Users/egc/Desktop/crap/lua-mwe.aux)
LaTeX Font Info: Checking defaults for OML/cmm/m/it on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for T1/cmr/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for OT1/cmr/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for OMS/cmsy/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for OMX/cmex/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for U/cmr/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for EU2/lmr/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for T3/cmr/m/n on input line 9.
LaTeX Font Info: Try loading font information for T3+cmr on input line 9.

(C:/Users/egc/Desktop/egc/text/MikTeX/tex/latex/tipa/t3cmr.fd
File: t3cmr.fd 2001/12/31 TIPA font definitions
)
LaTeX Font Info: ... okay on input line 9.
LaTeX Font Info: Checking defaults for TS1/cmr/m/n on input line 9.
LaTeX Font Info: ... okay on input line 9.
luaotfload | load: auto-selecting default features for script: latn
luaotfload | load: no defaults for script ???latn???, falling back to 
???dflt
???
luaotfload | resolve: Font family='minionpro', subfamily='regular' 
found: minion
pro-regular.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
(C:/Users/egc/Desktop/egc/text/MikTeX/tex/context/base/supp-pdf.mkii
[Loading MPS to PDF converter (version 2006.09.02).]
\scratchcounter=\count323
\scratchdimen=\dimen292
\scratchbox=\box271
\nofMPsegments=\count324
\nofMParguments=\count325
\everyMPshowfont=\toks18
\MPscratchCnt=\count326
\MPscratchDim=\dimen293
\MPnumerator=\count327
\makeMPintoPDFobject=\count328
\everyMPtoPDFconversion=\toks19
)
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | load: auto-selecting default features for script: dflt
luaotfload | load: auto-selecting default features for script: dflt
LaTeX Font Info: Font shape `EU2/AsanaMath(1)/m/n' will be
(Font) scaled to size 10.95015pt on input line 13.
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
LaTeX Font Info: Font shape `EU2/AsanaMath(1)/m/n' will be
(Font) scaled to size 8.00012pt on input line 13.
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
LaTeX Font Info: Font shape `EU2/AsanaMath(1)/m/n' will be
(Font) scaled to size 6.00009pt on input line 13.
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
LaTeX Font Info: Font shape `EU2/AsanaMath(2)/m/n' will be
(Font) scaled to size 10.94983pt on input line 13.
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
LaTeX Font Info: Font shape `EU2/AsanaMath(2)/m/n' will be
(Font) scaled to size 7.99988pt on input line 13.
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache
LaTeX Font Info: Font shape `EU2/AsanaMath(2)/m/n' will be
(Font) scaled to size 5.99991pt on input line 13.
luaotfload | load: auto-selecting default features for script: math
luaotfload | load: no defaults for script ???math???, falling back to 
???dflt
???
luaotfload | resolve: Font family='asanamath', subfamily='regular' 
found: asana-
math.otf
luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache [1

{C:/Users/egc/AppData/Local/MiKTeX/2.9/pdftex/config/pdftex.map}] 
(C:/Users/egc
/Desktop/crap/lua-mwe.aux) )

Here is how much of LuaTeX's memory you used:
20217 strings out of 494074
125171,552014 words of node,token memory allocated
321 words of node memory still in use:
nodes
avail lists: 
1:52,2:738,3:25,4:88,5:106,6:243,7:3,8:3,9:528,10:989,11:512,12:
228
23369 multiletter control sequences out of 65536+200000
40 fonts using 6131611 bytes
48i,4n,43p,959b,163s stack positions out of 5000i,500n,10000p,200000b,50000s
<C:/Users/egc/Desktop/egc/text/MikTeX/fonts/opentype/public/asana-math/asana-mat
h.otf><C:/Windows/Fonts/minionpro-regular.otf>
Output written on lua-mwe.pdf (1 page, 9555 bytes).

PDF statistics: 20 PDF objects out of 1000 (max. 8388607)
0 named destinations out of 1000 (max. 131072)
1 words of extra memory for PDF output out of 10000 (max. 10000000)



From reinhard.kotucha at web.de  Sat Jul  6 01:34:46 2013
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat, 6 Jul 2013 01:34:46 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <51D72C98.2050103@gmail.com>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu>
 <20130704075012.GB10756@phlegethon> <51D72C98.2050103@gmail.com>
Message-ID: <20951.22550.398030.208602@zaphod.ms25.net>

On 2013-07-05 at 16:29:12 -0400, Evan Cooch wrote:

 > luaotfload | cache : Could not write lookup cache
 > luaotfload | cache: Could not write to cache
 > luaotfload | cache : Could not write to cache [1

Certainly a problem with file permissions.  Philipp, it would be very
helpful if luaotfload prints the full path+filename to the log file
before opening the file.  "Could not write" can either mean that the
the target directory isn't writable, but it can also mean that it
tries to create the file somewhere else.

If it's known where luaotfload is trying to create the file, then Evan
can investigate file permissions of this particular directory.

However, file permissions are a pain under Windows.  A colleague has
two files with the same name but different content in one and the same
directory.  When he logs in as a mortal user he gets the the older
version but when he logs in as administrator he gets the newer one.
These things are extremely difficult to debug.  Good luck!

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From Philipp.Gesang at alumni.uni-heidelberg.de  Sat Jul  6 02:14:04 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sat, 6 Jul 2013 02:14:04 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <51D7293F.40509@gmail.com>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu>
 <20130704075012.GB10756@phlegethon> <51D7293F.40509@gmail.com>
Message-ID: <20130706001404.GA8915@phlegethon>

???<date: 2013-07-05, Friday>???<from: Evan Cooch>???

> 
> >>                             But this variable is not defined under
> >>MiKTeX, and upon seeing that it's not defined, luaotfload is
> >>supposed to put the database in a folder with the path given by the
> >>value of the variable $TEXMFVAR (the default value in MiKTeX on Win
> >>7 is C:\Users\<USERNAME>\AppData\MiKTeX\2.9 and you can test the
> >>value on your system by typing kpsewhich --expand-var=$TEXMFVAR in
> >>the Command Prompt, or by looking in the Roots panel of the MiKTeX
> >>settings application). The bug we've been discussing keeps
> >>luaotfload from doing that, which is why your database ends up where
> >>it does (and the problem doesn't apply to TeX Live, because the
> >>$TEXMFCACHE variable is defined in that setup).
> >Fwiw version 2.3 went up to CTAN yesterday. You can get the zip at:
> >
> >     https://github.com/lualatex/luaotfload/releases
> >
> >(choose the tds one). This version introduces incompatible
> >changes so remember to delete the cache directories after
> >updating.
> >
> >
> 
> Quick followup:
> 
> 1\ so, should running luaotfload-tool --update --force create the
> approrpate names DB and font cache?
> 
> If so, then
> 
> 2\ where is it trying to write it?

Run ?luaotfload-tool --help?. Near the end it should print the
cache paths, e.g.:

    The font database will be saved to
       /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/names/luaotfload-names.lua
       /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/names/luaotfload-names.luc

    <snip />
    
    The font cache will be written to
       /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/fonts

The path prefix (configured in texmf.cnf; in this case
/home/phg/src/texlive2013/) must be writable for the user that is
running luatex; the subdirectories under it will be created, even
if you only run luaotfload-tool without options.

>                                    Using MikTeX 2.9, installed just
> for a single user (me!), under Windows 7.

> I ask because I may have spoken too soon about 2.3 working.  I'd run
> a few tests, which seemed to compile, then I remembered I needed to
> delete old cache'. So, went into \users\me\AppData\Local\MikTeX\2.9
> and deleted luatex-cache (and all the subdirs contained therein).

According to your log file that is where the font loader writes
its cache files to:

    C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/

The names db should reside in a subdirectory ?/names?, the font
cache under ?/fonts/?. If deleted, it will be recreated the next
time you run luaotfload-tool or luatex with luaotload. Can you
post the permissions of these directories and the files in them?

Best,
Philipp



-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130706/5860b0db/attachment.bin>

From evan.cooch at gmail.com  Sat Jul  6 02:27:55 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Fri, 5 Jul 2013 20:27:55 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20130706001404.GA8915@phlegethon>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
 <51D7293F.40509@gmail.com> <20130706001404.GA8915@phlegethon>
Message-ID: <51D7648B.3090400@gmail.com>

C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/ The names db 
should reside in a subdirectory ?/names?, the font cache under 
?/fonts/?. If deleted, it will be recreated the next time you run 
luaotfload-tool or luatex with luaotload. Can you post the permissions 
of these directories and the files in them? Best, Philipp
.. i will tomorrow, but I'm doubtful it is a 'permissions issue':

1\ I installed MikTeX for myself only (meaning, when I' logged into my 
account, my userid owns any files/directories that get created by any 
process that I start (including luaotfload)

2\ luaotfload creates the directories correctly, and fills \fonts with 
the fonts. It creates \names, but doesn't put anything into the 
directory. So, if luaotfload as a process creates the directory, then it 
must have read/write for the directory.

I think something else more fundamental is at play.

From Philipp.Gesang at alumni.uni-heidelberg.de  Sat Jul  6 02:27:09 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sat, 6 Jul 2013 02:27:09 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20951.22550.398030.208602@zaphod.ms25.net>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu>
 <20130704075012.GB10756@phlegethon> <51D72C98.2050103@gmail.com>
 <20951.22550.398030.208602@zaphod.ms25.net>
Message-ID: <20130706002709.GB8915@phlegethon>

Hi Reinhard!

???<Datum: Saturday, 06. July 2013>???<Von: Reinhard Kotucha>???

> On 2013-07-05 at 16:29:12 -0400, Evan Cooch wrote:
> 
>  > luaotfload | cache : Could not write lookup cache
>  > luaotfload | cache: Could not write to cache
>  > luaotfload | cache : Could not write to cache [1
> 
> Certainly a problem with file permissions.  Philipp, it would be very
> helpful if luaotfload prints the full path+filename to the log file
> before opening the file.

The filenames are listed with absolute paths when running
luaotfload-tool --help.  Anyways, I just rewrote [1] the writer
functions in question to be more verbose on failure.

>                           "Could not write" can either mean that the
> the target directory isn't writable, but it can also mean that it
> tries to create the file somewhere else.

The strange thing is, though, that the fontloader apparently
writes to the font cache without issue, even though it uses the
exact same mechanism as the database writer ...

> However, file permissions are a pain under Windows.  A colleague has
> two files with the same name but different content in one and the same
> directory.  When he logs in as a mortal user he gets the the older
> version but when he logs in as administrator he gets the newer one.
> These things are extremely difficult to debug.  Good luck!

I?m aware of some but by no means all of the pitfalls. That?s why
luaotfload relies heavily on Hans?s code (tested on Win) for
filesystem related stuff.

Best,
Philipp

[1] https://github.com/phi-gamma/luaotfload/commit/c917abdd4c6032b1e715555bc626a987b014e4ab
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130706/b8591f58/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Sat Jul  6 02:27:09 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sat, 6 Jul 2013 02:27:09 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20951.22550.398030.208602@zaphod.ms25.net>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu>
 <20130704075012.GB10756@phlegethon> <51D72C98.2050103@gmail.com>
 <20951.22550.398030.208602@zaphod.ms25.net>
Message-ID: <20130706002709.GB8915@phlegethon>

Hi Reinhard!

???<Datum: Saturday, 06. July 2013>???<Von: Reinhard Kotucha>???

> On 2013-07-05 at 16:29:12 -0400, Evan Cooch wrote:
> 
>  > luaotfload | cache : Could not write lookup cache
>  > luaotfload | cache: Could not write to cache
>  > luaotfload | cache : Could not write to cache [1
> 
> Certainly a problem with file permissions.  Philipp, it would be very
> helpful if luaotfload prints the full path+filename to the log file
> before opening the file.

The filenames are listed with absolute paths when running
luaotfload-tool --help.  Anyways, I just rewrote [1] the writer
functions in question to be more verbose on failure.

>                           "Could not write" can either mean that the
> the target directory isn't writable, but it can also mean that it
> tries to create the file somewhere else.

The strange thing is, though, that the fontloader apparently
writes to the font cache without issue, even though it uses the
exact same mechanism as the database writer ...

> However, file permissions are a pain under Windows.  A colleague has
> two files with the same name but different content in one and the same
> directory.  When he logs in as a mortal user he gets the the older
> version but when he logs in as administrator he gets the newer one.
> These things are extremely difficult to debug.  Good luck!

I?m aware of some but by no means all of the pitfalls. That?s why
luaotfload relies heavily on Hans?s code (tested on Win) for
filesystem related stuff.

Best,
Philipp

[1] https://github.com/phi-gamma/luaotfload/commit/c917abdd4c6032b1e715555bc626a987b014e4ab
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130706/b8591f58/attachment-0001.bin>

From evan.cooch at gmail.com  Sat Jul  6 15:44:54 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Sat, 6 Jul 2013 09:44:54 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20130706001404.GA8915@phlegethon>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
 <51D7293F.40509@gmail.com> <20130706001404.GA8915@phlegethon>
Message-ID: <51D81F56.9010801@gmail.com>


> Run ?luaotfload-tool --help?. Near the end it should print the
> cache paths, e.g.:
>
>      The font database will be saved to
>         /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/names/luaotfload-names.lua
>         /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/names/luaotfload-names.luc
>
>      <snip />
>      
>      The font cache will be written to
>         /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/fonts
>
> The path prefix (configured in texmf.cnf; in this case
> /home/phg/src/texlive2013/) must be writable for the user that is
> running luatex; the subdirectories under it will be created, even
> if you only run luaotfload-tool without options.


Well, perhaps a clue. When I run luaotfload-tool help, it shows me

The font database will be saved to:
c:/users/egc/AppData/Local/MikTeX/2.9/luatex-cache/generic/names/luaotfload-names.lua
c:/users/egc/AppData/Local/MikTeX/2.9/luatex-cache/generic/names/luaotfload-names.luc

and then...nothing else. I get no statement about where the font cache 
will be written to (i.e., I don't see anything like

The font cache will be written to
        /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/fonts



In fact other than the statements about where the font database will be 
written to, runing luaotfload-tool --help shows me nothing else. At all.



>
> nd all the subdirs contained therein).
> According to your log file that is where the font loader writes
> its cache files to:
>
>      C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/
>
> The names db should reside in a subdirectory ?/names?, the font
> cache under ?/fonts/?. If deleted, it will be recreated the next
> time you run luaotfload-tool or luatex with luaotload. Can you
> post the permissions of these directories and the files in them?
>


This might be the clue. If I delete luatex-cache from 
c:/users/egc/AppData/Local/MikTeX/2.9/ (i.e., start over), bring up a 
command shell, and then run

luaotfload-tool --update --force

It creates luatex-cache, then generic, and then names but...then quits 
with the following error message:

luatofload | db: scanning TEXMF and OS fonts...
luaotfload -tool: Windows API error 5: Access is denied.
luaotfload-tool: Data: C:/users/egc/Templates

and then it exits.

Now, whats odd is that I get the above if I run luaotfload-tool. But, if 
instead, I (i) delete the luatex-cache file (again, start over), and 
then try to compile a MWE that uses fontspec, it grinds along, then

luaotfload | db : Font name database not found, generating a new one.
luaotfload | db: This can take several minutes; please be patient.

and, as before, \fonts and \names get created, \fonts contains the 
fonts, but \names is empty.

So, even though I 'shouldn't', I bring up a cmd window, and as admin, 
run luaotfload-tool --update --force. Runs to completion. Fonts in 
\fonts, and (importantly) in \names, see luaotfload-names.lua and 
luaotfload-names.luc

Now, try to compile MWE, and once again, I get all those ... could not 
write to cache messages. Document compiles, but still...


if it matters --

From evan.cooch at gmail.com  Sat Jul  6 16:45:03 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Sat, 6 Jul 2013 10:45:03 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20130706002709.GB8915@phlegethon>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
 <51D72C98.2050103@gmail.com> <20951.22550.398030.208602@zaphod.ms25.net>
 <20130706002709.GB8915@phlegethon>
Message-ID: <51D82D6F.3090702@gmail.com>


> I?m aware of some but by no means all of the pitfalls. That?s why
> luaotfload relies heavily on Hans?s code (tested on Win) for
> filesystem related stuff.
>
> Best,
> Philipp
>
> [1] https://github.com/phi-gamma/luaotfload/commit/c917abdd4c6032b1e715555bc626a987b014e4ab


I'll pull the latest file off git later today.

From Philipp.Gesang at alumni.uni-heidelberg.de  Sat Jul  6 19:14:00 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sat, 6 Jul 2013 19:14:00 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <51D81F56.9010801@gmail.com>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu>
 <20130704075012.GB10756@phlegethon> <51D7293F.40509@gmail.com>
 <20130706001404.GA8915@phlegethon> <51D81F56.9010801@gmail.com>
Message-ID: <20130706171254.GA5147@tartaros>

Hi Evan,

???<date: 2013-07-06, Saturday>???<from: Evan Cooch>???

> Well, perhaps a clue. When I run luaotfload-tool help, it shows me
> 
> The font database will be saved to:
> c:/users/egc/AppData/Local/MikTeX/2.9/luatex-cache/generic/names/luaotfload-names.lua
> c:/users/egc/AppData/Local/MikTeX/2.9/luatex-cache/generic/names/luaotfload-names.luc

looks ok so far.

> and then...nothing else. I get no statement about where the font
> cache will be written to (i.e., I don't see anything like
> 
> The font cache will be written to
>        /home/phg/src/texlive2013/texmf-var/luatex-cache/generic/fonts

That line has been there since this commit:

    https://github.com/lualatex/luaotfload/commit/00fd07c628af41b0709d25fd00805385be561459#L3R202

and is definitely part of the v2.3 zip. Something?s off with your
install. You can check whether you?re running the correct version
with luaotfload-tool --version.

> In fact other than the statements about where the font database will
> be written to, runing luaotfload-tool --help shows me nothing else.
> At all.

It should print 59 lines of usage info.

If I remember correctly, Windows distributions use binary
wrappers for Lua scripts. Maybe the one for luaotfload-tool.lua
points to an old version of the file?

> >nd all the subdirs contained therein).
> >According to your log file that is where the font loader writes
> >its cache files to:
> >
> >     C:/Users/egc/AppData/Local/MiKTeX/2.9/luatex-cache/generic/
> >
> >The names db should reside in a subdirectory ?/names?, the font
> >cache under ?/fonts/?. If deleted, it will be recreated the next
> >time you run luaotfload-tool or luatex with luaotload. Can you
> >post the permissions of these directories and the files in them?
> >
> 
> 
> This might be the clue. If I delete luatex-cache from
> c:/users/egc/AppData/Local/MikTeX/2.9/ (i.e., start over), bring up
> a command shell, and then run
> 
> luaotfload-tool --update --force
> 
> It creates luatex-cache, then generic, and then names but...then
> quits with the following error message:
> 
> luatofload | db: scanning TEXMF and OS fonts...
> luaotfload -tool: Windows API error 5: Access is denied.
> luaotfload-tool: Data: C:/users/egc/Templates

Weird. Google hints that this is a Miktex-specific error:
http://tex.stackexchange.com/q/51799, indicating a problem with
permissions.

> and then it exits.
> 
> So, even though I 'shouldn't', I bring up a cmd window, and as
> admin, run luaotfload-tool --update --force. Runs to completion.
> Fonts in \fonts, and (importantly) in \names, see
> luaotfload-names.lua and luaotfload-names.luc

If they end up in the correct cache tree, then the script runs
fine.

> Now, try to compile MWE, and once again, I get all those ... could
> not write to cache messages. Document compiles, but still...

With normal settings Luaotfload will resolve font name requests
only once and then save them to disk. For this to work it is
essential that the cache be writable during the Luatex run -- if
you run the script with root privileges then that cache directory
ends up owned by root (on Linux, anyways) and can?t be written to
with user rights.

Best,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130706/a76d5a40/attachment.bin>

From evan.cooch at gmail.com  Sat Jul  6 19:35:53 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Sat, 6 Jul 2013 13:35:53 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <20130706171254.GA5147@tartaros>
References: <mailman.7.1372845601.23803.luatex@tug.org>
 <51D4B4D5.6010809@post.harvard.edu> <20130704075012.GB10756@phlegethon>
 <51D7293F.40509@gmail.com> <20130706001404.GA8915@phlegethon>
 <51D81F56.9010801@gmail.com> <20130706171254.GA5147@tartaros>
Message-ID: <51D85579.7020900@gmail.com>


> That line has been there since this commit:
>
>      https://github.com/lualatex/luaotfload/commit/00fd07c628af41b0709d25fd00805385be561459#L3R202
>
> and is definitely part of the v2.3 zip. Something?s off with your
> install. You can check whether you?re running the correct version
> with luaotfload-tool --version.

mkluatexfontdb 2.3
database version 2.207

>> In fact other than the statements about where the font database will
>> be written to, runing luaotfload-tool --help shows me nothing else.
>> At all.
> It should print 59 lines of usage info.


I tried again. It doesn't. Only the 2 lines I reported earlier.

>
> If I remember correctly, Windows distributions use binary
> wrappers for Lua scripts. Maybe the one for luaotfload-tool.lua
> points to an old version of the file?
>
>
Alas, only one version on the machine.

About all I can do at this point is try a full re-install, and see what 
happens. I can install as a user (i.e., install 'just for me'), or as 
admin (i.e, 'install for everyone').

While this doesn't take heroically long, it takes longer than I have 
time for today.

What you/we need is someone else with a MiklTeX install under Windows 7 
(Pro, if that matters), to see if they're having the same problem.

From jura.pintar at gmail.com  Sat Jul  6 22:53:30 2013
From: jura.pintar at gmail.com (Jura Pintar)
Date: Sat, 6 Jul 2013 16:53:30 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <mailman.5.1373104802.18277.luatex@tug.org>
References: <mailman.5.1373104802.18277.luatex@tug.org>
Message-ID: <51D883CA.2080908@gmail.com>

I can confirm Evan?s problem on Windows 7 Pro x64 with MiKTeX 64-bit and 
the latest versions the luaotfload files from GitHub (and full 
permissions granted to the current user, all other users, 
Administrators, and the System on the MiKTeX default $TEXMFVAR folder). 
I can also confirm that the same version of luaotfload works with no 
problems at all on the same machine under TeX Live 2013.

I expect Philipp has the diagnosis right - the MiKTeX binary wrapper for 
the luaotfload-tool probably needs to be updated.

Best,

Jura



From evan.cooch at gmail.com  Sat Jul  6 23:13:38 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Sat, 6 Jul 2013 17:13:38 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <51D883CA.2080908@gmail.com>
References: <mailman.5.1373104802.18277.luatex@tug.org>
 <51D883CA.2080908@gmail.com>
Message-ID: <51D88882.50503@gmail.com>

In some ways, thats great news (meaning: at least it isn't *just me*, 
and is not the *fault* of *just my computer*).

On 7/6/2013 4:53 PM, Jura Pintar wrote:
> I can confirm Evan?s problem on Windows 7 Pro x64 with MiKTeX 64-bit 
> and the latest versions the luaotfload files from GitHub (and full 
> permissions granted to the current user, all other users, 
> Administrators, and the System on the MiKTeX default $TEXMFVAR 
> folder). I can also confirm that the same version of luaotfload works 
> with no problems at all on the same machine under TeX Live 2013.
>
> I expect Philipp has the diagnosis right - the MiKTeX binary wrapper 
> for the luaotfload-tool probably needs to be updated.
>
> Best,
>
> Jura
>
>
>


From jura.pintar at gmail.com  Sun Jul  7 13:54:18 2013
From: jura.pintar at gmail.com (Jura Pintar)
Date: Sun, 7 Jul 2013 07:54:18 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <mailman.5636.1373145239.3597.luatex@tug.org>
References: <mailman.5636.1373145239.3597.luatex@tug.org>
Message-ID: <51D956EA.7070501@gmail.com>

> I expect Philipp has the diagnosis right - the MiKTeX binary wrapper 
> for the luaotfload-tool probably needs to be updated.

A bit more evidence: passing luaotfload-tool.lua --help as an argument 
to texlua under MiKTeX gives the desired result (i.e. 57 lines are 
printed), but calling luaotfload-tool.exe --help does not (under TeX 
Live, both work as they ought).

By the way, the Windows Command Prompt doesn't display unicode 
characaters by default, so it would be better for Windows users if the 
command line tools like luaotfload-tool were to avoid them (quotation 
marks come out garbled, in particular).

Jura


From evan.cooch at gmail.com  Sun Jul  7 17:37:56 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Sun, 7 Jul 2013 11:37:56 -0400
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <51D956EA.7070501@gmail.com>
References: <mailman.5636.1373145239.3597.luatex@tug.org>
 <51D956EA.7070501@gmail.com>
Message-ID: <CAFKs89GEpJp1K3iSN8mf7SpksfmBQ8d3uAnC3XAYNwm5XguzVw@mail.gmail.com>

Cmd.exe /u starts a command prompt with UTF-16 support, but still, fair
point.
On Jul 7, 2013 7:54 AM, "Jura Pintar" <jura.pintar at gmail.com> wrote:

> I expect Philipp has the diagnosis right - the MiKTeX binary wrapper for
>> the luaotfload-tool probably needs to be updated.
>>
>
> A bit more evidence: passing luaotfload-tool.lua --help as an argument to
> texlua under MiKTeX gives the desired result (i.e. 57 lines are printed),
> but calling luaotfload-tool.exe --help does not (under TeX Live, both work
> as they ought).
>
> By the way, the Windows Command Prompt doesn't display unicode characaters
> by default, so it would be better for Windows users if the command line
> tools like luaotfload-tool were to avoid them (quotation marks come out
> garbled, in particular).
>
> Jura
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20130707/4e8760bc/attachment.html>

From elie.roux at telecom-bretagne.eu  Mon Jul  8 16:24:42 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Mon, 8 Jul 2013 16:24:42 +0200
Subject: [luatex] \hyphenpenalty not working
Message-ID: <51DACBAA.7000208@telecom-bretagne.eu>

Dear all,

It seems that \hyphenpenalty is not working at all in LuaTeX. See the 
difference between the outputs of LuaTeX and pdfTeX on the following 
example:

\hyphenpenalty=-10000
ab\discretionary{-}{-}{-}cd
\bye

P.S.: I have reporter the issue on http://tracker.luatex.org/view.php?id=842

Thank you!
-- 
Elie

From taco at elvenkind.com  Mon Jul  8 16:37:34 2013
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 8 Jul 2013 16:37:34 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DACBAA.7000208@telecom-bretagne.eu>
References: <51DACBAA.7000208@telecom-bretagne.eu>
Message-ID: <51DACEAE.4040300@elvenkind.com>

On 07/08/2013 04:24 PM, ?lie Roux wrote:
> Dear all,
>
> It seems that \hyphenpenalty is not working at all in LuaTeX. See the
> difference between the outputs of LuaTeX and pdfTeX on the following
> example:
>
> \hyphenpenalty=-10000
> ab\discretionary{-}{-}{-}cd
> \bye

I think that bug is only for negative values? I tested some positive 
ones, and these seemed ok.


From elie.roux at telecom-bretagne.eu  Mon Jul  8 17:05:28 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Mon, 8 Jul 2013 17:05:28 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DACEAE.4040300@elvenkind.com>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com>
Message-ID: <51DAD538.40200@telecom-bretagne.eu>

Dear Taco,

Thank you very much for your quick answer!

> I think that bug is only for negative values? I tested some positive
> ones, and these seemed ok.

I have to say I don't know how to test positive values simply... I'll 
try though.

Thank you,
-- 
Elie

From elie.roux at telecom-bretagne.eu  Mon Jul  8 19:48:44 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Mon, 8 Jul 2013 19:48:44 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DAD538.40200@telecom-bretagne.eu>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
Message-ID: <51DAFB7C.5050907@telecom-bretagne.eu>

Le 08/07/2013 17:05, ?lie Roux a ?crit :
> Dear Taco,
>
> Thank you very much for your quick answer!
>
>> I think that bug is only for negative values? I tested some positive
>> ones, and these seemed ok.
>
> I have to say I don't know how to test positive values simply... I'll
> try though.

There is something more I don't understand: if you take the following 
example:

\hsize=2cm
aaaaab\discretionary{1}{2}{3}\penalty-10000cd

\hyphenpenalty=-10000
aaaaab\discretionary{1}{2}{3}cd
\bye

(with pdfTeX), hyphenpenalty seems to be something more than just a 
penalty after the discretionary. The question is: how is it possible to 
set it with nodes? Discretionary nodes don't have a "penalty" field (not 
in the manual at least)...

Thank you!
-- 
Elie

From pragma at wxs.nl  Mon Jul  8 23:09:24 2013
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 8 Jul 2013 23:09:24 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DAFB7C.5050907@telecom-bretagne.eu>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
 <51DAFB7C.5050907@telecom-bretagne.eu>
Message-ID: <51DB2A84.70701@wxs.nl>

On 7/8/2013 7:48 PM, ?lie Roux wrote:
> Le 08/07/2013 17:05, ?lie Roux a ?crit :
>> Dear Taco,
>>
>> Thank you very much for your quick answer!
>>
>>> I think that bug is only for negative values? I tested some positive
>>> ones, and these seemed ok.
>>
>> I have to say I don't know how to test positive values simply... I'll
>> try though.
>
> There is something more I don't understand: if you take the following
> example:
>
> \hsize=2cm
> aaaaab\discretionary{1}{2}{3}\penalty-10000cd
>
> \hyphenpenalty=-10000
> aaaaab\discretionary{1}{2}{3}cd
> \bye
>
> (with pdfTeX), hyphenpenalty seems to be something more than just a
> penalty after the discretionary. The question is: how is it possible to
> set it with nodes? Discretionary nodes don't have a "penalty" field (not
> in the manual at least)...

afaik (ex) hyphenpenalty is only applied with automatic discretionaries 
(the ones inserted by the hyphenation pass)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From zappathustra at free.fr  Tue Jul  9 00:52:41 2013
From: zappathustra at free.fr (Paul Isambert)
Date: Tue, 9 Jul 2013 00:52:41 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DACEAE.4040300@elvenkind.com>
Message-ID: <1277123363.56763403.1373323961783.JavaMail.root@zimbra54-e10.priv.proxad.net>

Taco Hoekwater <taco at elvenkind.com> a ?crit:
> On 07/08/2013 04:24 PM, ?lie Roux wrote:
> > Dear all,
> >
> > It seems that \hyphenpenalty is not working at all in LuaTeX. See the
> > difference between the outputs of LuaTeX and pdfTeX on the following
> > example:
> >
> > \hyphenpenalty=-10000
> > ab\discretionary{-}{-}{-}cd
> > \bye
> 
> I think that bug is only for negative values? I tested some positive 
> ones, and these seemed ok.

Hasty remarks:

There seems to be some interaction with \pretolerance.

If you add \pretolerance=-10000, LuaTeX does break at the penalty.

Also, there is some interaction with one-liners:

  \hyphenpenalty=-10000
  \pretolerance=0
  Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  \bye

does not break at hyphens (in PDFTeX and LuaTeX), whereas (note the explicit
disc)

  \hyphenpenalty=-10000
  % \pretolerance=0
  Lorem ip\-sum dolor sit amet, consectetur adipiscing elit.
  \bye

breaks at all hyphens in PDFTeX but not LuaTeX unless you uncomment the second
line, and finally

  \hyphenpenalty=-10000
  \pretolerance=0
  Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  \bye

breaks for all engines.

There might be some interaction with normal behavior, but I?ll admit
I?m too incompetent here to do more than those remarks, hoping they?ll
be helpful.

Best,
Paul


From elie.roux at telecom-bretagne.eu  Tue Jul  9 09:18:33 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Tue, 9 Jul 2013 09:18:33 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DB2A84.70701@wxs.nl>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
 <51DAFB7C.5050907@telecom-bretagne.eu> <51DB2A84.70701@wxs.nl>
Message-ID: <51DBB949.3070402@telecom-bretagne.eu>

> afaik (ex) hyphenpenalty is only applied with automatic discretionaries
> (the ones inserted by the hyphenation pass)

This doesn't seem the be the case with the attached example, it clearly 
shows that \hyphenpenalty is applied to explicit \discretionaries too...

Let's put it another way: how can I make LuaTeX behave the same way as 
pdfTeX on the last line of the attached example? I really need it for a 
software, and I don't believe it's possible by patchin nodes, isn't it?

Thank you,
-- 
Elie
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hyphenpenalty.tex
Type: text/x-tex
Size: 458 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130709/51150bed/attachment-0003.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hyphenpenalty-luatex.pdf
Type: application/x-pdf
Size: 10852 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130709/51150bed/attachment-0004.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hyphenpenalty-pdftex.pdf
Type: application/x-pdf
Size: 10954 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130709/51150bed/attachment-0005.bin>

From elie.roux at telecom-bretagne.eu  Tue Jul  9 09:34:23 2013
From: elie.roux at telecom-bretagne.eu (=?UTF-8?B?w4lsaWUgUm91eA==?=)
Date: Tue, 9 Jul 2013 09:34:23 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <1277123363.56763403.1373323961783.JavaMail.root@zimbra54-e10.priv.proxad.net>
References: <1277123363.56763403.1373323961783.JavaMail.root@zimbra54-e10.priv.proxad.net>
Message-ID: <51DBBCFF.8060001@telecom-bretagne.eu>

> There seems to be some interaction with \pretolerance.
>
> If you add \pretolerance=-10000, LuaTeX does break at the penalty.

Let me try to understand what's going on...

On http://www.tug.org/utilities/plain/cseq.html#pretolerance-rp it says 
that if you set pretolerance to a negative value (and indeed -1 is 
enough to get the expected result), TeX will skip its first attempt to 
build the paragraph without hyphenation.

This means that:

  * in pdfTeX, the first attempt results in breaking at the discretionary
    due to hyphenpenalty

  * in LuaTeX, the hyphenpenalty is not taken into account in the first
    attempt (which is the big difference), but if the first attempt is
    skipped with pretolerance=-1, then it's taken into account in the
    second attempt

Am I correct?

Would it be possible to make hyphenpenalty taken into account in the 
first attempt?

Thank you,
-- 
Elie

From elie.roux at telecom-bretagne.eu  Tue Jul  9 10:26:49 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Tue, 9 Jul 2013 10:26:49 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DBC62A.1060200@wxs.nl>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
 <51DAFB7C.5050907@telecom-bretagne.eu> <51DB2A84.70701@wxs.nl>
 <51DBB949.3070402@telecom-bretagne.eu> <51DBC62A.1060200@wxs.nl>
Message-ID: <51DBC949.6040404@telecom-bretagne.eu>

> As you inject discretionaries the best you can do is inject specific
> penalties (maybe combined with glue) as that is more predictable.

The problem is that if I do that, I have to make \pretolerance=-1, 
otherwise the cut will be after the discretionary (its third argument 
will be used), not "on" it (using its first and second arguments)... I 
don't know if you read luatex at tug.org, but I believe I have found what 
was going on:

http://tug.org/pipermail/luatex/2013-July/004516.html

> Anyhow, at first sight I see no issue with luatex (as we have clearly
> separated hyphenation, ligaturing and kerning stages there i trust
> luatex more).
>
> \showframe % \everypar{}
>
> \starttext
>
> \startbuffer
> % this cuts after the discretionary
> {aaaaab\discretionary{1}{2}{3}\penalty-10000cd\par}
> % this doesn't cut
> {aaaaab\discretionary{1}{2}{3}cd\par}
> % this cuts on the discretionary (both pdfTeX and LuaTeX)
> {\hyphenpenalty=-10000 aaaaab\discretionary{1}{2}{3}cd\par}
> % with pdfTeX: it cuts on the discretionary
> % with LuaTeX: it doesn't cut
> {aaaaab\discretionary{1}{2}{3}cd \par}
> \stopbuffer
>
> \dostepwiserecurse{30}{70}{1}
> {\hsize #1pt
> \framed[width=\hsize]{\the\hsize}\par
> \getbuffer
> \page}
>
> \stoptext
>
> Ok, one can see how \hyphenpenalty=-10000 controls the tolerance i.e.
> permits a bit more overflow but that's to be expected.

I have to say I cannot compile your example... but I definitely believe 
that if there is a change (\hyphenpenalty ignored during first attempt 
of line breaking), it should be documented in the manual... maybe there 
could be an option for it?

Thank you!
-- 
Elie

From taco at elvenkind.com  Tue Jul  9 10:44:01 2013
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 9 Jul 2013 10:44:01 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DBC949.6040404@telecom-bretagne.eu>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
 <51DAFB7C.5050907@telecom-bretagne.eu> <51DB2A84.70701@wxs.nl>
 <51DBB949.3070402@telecom-bretagne.eu> <51DBC62A.1060200@wxs.nl>
 <51DBC949.6040404@telecom-bretagne.eu>
Message-ID: <9F59578D-1A9A-44B4-953B-87A64989EAB5@elvenkind.com>


On Jul 9, 2013, at 10:26 AM, ?lie Roux <elie.roux at telecom-bretagne.eu> wrote:
> 
> I have to say I cannot compile your example... but I definitely believe that if there is a change (\hyphenpenalty ignored during first attempt of line breaking), it should be documented in the manual... maybe there could be an option for it?

I now vaguely recall writing an optimisation where the first attempt is skipped under some circumstances, and that could
be the problem here (apparently that does not take into account possible negative values of \hyphenpenalty). I had 
forgotten about that optimisation, but it seems that that is what is going on.

Best wishes,
Taco

From elie.roux at telecom-bretagne.eu  Tue Jul  9 10:51:59 2013
From: elie.roux at telecom-bretagne.eu (=?ISO-8859-1?Q?=C9lie_Roux?=)
Date: Tue, 9 Jul 2013 10:51:59 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <9F59578D-1A9A-44B4-953B-87A64989EAB5@elvenkind.com>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
 <51DAFB7C.5050907@telecom-bretagne.eu> <51DB2A84.70701@wxs.nl>
 <51DBB949.3070402@telecom-bretagne.eu> <51DBC62A.1060200@wxs.nl>
 <51DBC949.6040404@telecom-bretagne.eu>
 <9F59578D-1A9A-44B4-953B-87A64989EAB5@elvenkind.com>
Message-ID: <51DBCF2F.8080404@telecom-bretagne.eu>

> I now vaguely recall writing an optimisation where the first attempt
> is skipped under some circumstances, and that could be the problem
> here (apparently that does not take into account possible negative
> values of \hyphenpenalty). I had forgotten about that optimisation,
> but it seems that that is what is going on.

Oh, ok! What will you do about this? Will you document the current
behaviour as the LuaTeX behaviour, or will there be an option to change it?

Thank you!
-- 
Elie

From taco at elvenkind.com  Tue Jul  9 11:04:47 2013
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 9 Jul 2013 11:04:47 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DBCF2F.8080404@telecom-bretagne.eu>
References: <51DACBAA.7000208@telecom-bretagne.eu>
 <51DACEAE.4040300@elvenkind.com> <51DAD538.40200@telecom-bretagne.eu>
 <51DAFB7C.5050907@telecom-bretagne.eu> <51DB2A84.70701@wxs.nl>
 <51DBB949.3070402@telecom-bretagne.eu> <51DBC62A.1060200@wxs.nl>
 <51DBC949.6040404@telecom-bretagne.eu>
 <9F59578D-1A9A-44B4-953B-87A64989EAB5@elvenkind.com>
 <51DBCF2F.8080404@telecom-bretagne.eu>
Message-ID: <AFE4869B-9A9E-43BD-9A39-6EB9F90C9A57@elvenkind.com>


On Jul 9, 2013, at 10:51 AM, ?lie Roux <elie.roux at telecom-bretagne.eu> wrote:

>> I now vaguely recall writing an optimisation where the first attempt
>> is skipped under some circumstances, and that could be the problem
>> here (apparently that does not take into account possible negative
>> values of \hyphenpenalty). I had forgotten about that optimisation,
>> but it seems that that is what is going on.
> 
> Oh, ok! What will you do about this? Will you document the current
> behaviour as the LuaTeX behaviour, or will there be an option to change it?
> 
> Thank you!

That optimisation should just go away again (I hope I can find it still).





From elie.roux at telecom-bretagne.eu  Tue Jul  9 14:01:14 2013
From: elie.roux at telecom-bretagne.eu (=?UTF-8?B?w4lsaWUgUm91eA==?=)
Date: Tue, 9 Jul 2013 14:01:14 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DBF5B1.7080109@wxs.nl>
References: <1277123363.56763403.1373323961783.JavaMail.root@zimbra54-e10.priv.proxad.net>
 <51DBBCFF.8060001@telecom-bretagne.eu> <51DBF5B1.7080109@wxs.nl>
Message-ID: <51DBFB8A.9090903@telecom-bretagne.eu>

> in the first pass there is no hyphenation at all, only the replace field
> is consulted so there is no reason to take that penalty into account

This makes sense! Though one can argue that an explicit \discretionary 
is not mandatorily an hyphen? The case of Gregorian scores is of course 
very specific, but it's part of the exceptions...

In any case, such a difference with the TeX algorithm should be documented!

Thank you,
-- 
Elie

From pragma at wxs.nl  Tue Jul  9 13:36:17 2013
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 9 Jul 2013 13:36:17 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DBBCFF.8060001@telecom-bretagne.eu>
References: <1277123363.56763403.1373323961783.JavaMail.root@zimbra54-e10.priv.proxad.net>
 <51DBBCFF.8060001@telecom-bretagne.eu>
Message-ID: <51DBF5B1.7080109@wxs.nl>

On 7/9/2013 9:34 AM, ?lie Roux wrote:
>> There seems to be some interaction with \pretolerance.
>>
>> If you add \pretolerance=-10000, LuaTeX does break at the penalty.
>
> Let me try to understand what's going on...
>
> On http://www.tug.org/utilities/plain/cseq.html#pretolerance-rp it says
> that if you set pretolerance to a negative value (and indeed -1 is
> enough to get the expected result), TeX will skip its first attempt to
> build the paragraph without hyphenation.
>
> This means that:
>
>   * in pdfTeX, the first attempt results in breaking at the discretionary
>     due to hyphenpenalty
>
>   * in LuaTeX, the hyphenpenalty is not taken into account in the first
>     attempt (which is the big difference), but if the first attempt is
>     skipped with pretolerance=-1, then it's taken into account in the
>     second attempt
>
> Am I correct?
>
> Would it be possible to make hyphenpenalty taken into account in the
> first attempt?

in the first pass there is no hyphenation at all, only the replace field 
is consulted so there is no reason to take that penalty into account

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Jul  9 20:18:13 2013
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 9 Jul 2013 20:18:13 +0200
Subject: [luatex] \hyphenpenalty not working
In-Reply-To: <51DBFB8A.9090903@telecom-bretagne.eu>
References: <1277123363.56763403.1373323961783.JavaMail.root@zimbra54-e10.priv.proxad.net>
 <51DBBCFF.8060001@telecom-bretagne.eu> <51DBF5B1.7080109@wxs.nl>
 <51DBFB8A.9090903@telecom-bretagne.eu>
Message-ID: <51DC53E5.9060402@wxs.nl>

On 7/9/2013 2:01 PM, ?lie Roux wrote:
>> in the first pass there is no hyphenation at all, only the replace field
>> is consulted so there is no reason to take that penalty into account
>
> This makes sense! Though one can argue that an explicit \discretionary
> is not mandatorily an hyphen? The case of Gregorian scores is of course
> very specific, but it's part of the exceptions...
>
> In any case, such a difference with the TeX algorithm should be documented!

the first pass not being hyphenated has not to be documented as it's 
standard tex behaviour (however, ignoring category 1-3 dics nodes in 
pass one is, see a previous mail to you/taco, although that can become 
optional)

concerning comparison with pdftex: as luatex separates the hyphenating, 
ligaturing and kerning passes (and needs no reconstruction mechanisms 
when unboxing and re-breaking is involved) there will always be some 
incompatibilities, and these are mentioned in the manual

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From luatex at nililand.de  Wed Jul 10 17:33:41 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Wed, 10 Jul 2013 17:33:41 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
Message-ID: <1iripw093blf6$.dlg@nililand.de>

I found some time to update today miktex and texlive and would like
to report some luaotfload problem.

I used a small document for the tests which loads an system font:

\documentclass{scrartcl}
\usepackage{fontspec}
\setmainfont{Arial}
\begin{document}
blub
\end{document}

I deleted the fonts caches before the tests. 

Problems
1. luaotfload can't create the font database on-the-fly during the
compilation:

luaotfload | db : Font names database not found, generating new one.
luaotfload | db : This can take several minutes; please be patient.
luaotfload | db : Failed to save names database
luaotfload | db : Database creation unsuccessful.

And there is nothing in the "names" folder.
This happens in texlive + miktex. 

Running 
  luaotfload-tool --update --force --vv
works fine and creates the database. 


2. Miktex/installation specific:
Miktex hanges while create the cache for a new font and shows a lua
prompt:

luaotfload | db : Database creation unsuccessful.
luaotfload | load : loading the extended glyph list from ConTeXt
lua> 

The problem seems to be that luaotfload tries to load font-age.lua
which doesn't exist on a normal miktex system (there is not context)

3. lualatex compiles fine after I created the font databases with
luaotfload-tool, but the log (both systems) shows a lot of this
messages:

luaotfload | cache : Could not write lookup cache
luaotfload | cache: Could not write to cache
luaotfload | cache : Could not write to cache


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From luatex at nililand.de  Wed Jul 10 18:48:37 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Wed, 10 Jul 2013 18:48:37 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <1iripw093blf6$.dlg@nililand.de>
Message-ID: <x4doql3lamre$.dlg@nililand.de>

Am Wed, 10 Jul 2013 17:33:41 +0200 schrieb Ulrike Fischer:

> I found some time to update today miktex and texlive and would like
> to report some luaotfload problem.

I forgot: I used the version on CTAN

luaotfload 2013/05/23 v2.3d OpenType layout system

I can perhaps test the git version tomorrow. 

And I have simple single user installations. 

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Wed Jul 10 18:56:40 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Wed, 10 Jul 2013 18:56:40 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <x4doql3lamre$.dlg@nililand.de>
References: <1iripw093blf6$.dlg@nililand.de>
 <x4doql3lamre$.dlg@nililand.de>
Message-ID: <20130710165640.GA16900@phlegethon>

???<Datum: Wednesday, 10. July 2013>???<Von: Ulrike Fischer>???

> Am Wed, 10 Jul 2013 17:33:41 +0200 schrieb Ulrike Fischer:
> 
> > I found some time to update today miktex and texlive and would like
> > to report some luaotfload problem.
> 
> I forgot: I used the version on CTAN
> 
> luaotfload 2013/05/23 v2.3d OpenType layout system
> 
> I can perhaps test the git version tomorrow. 
> 
> And I have simple single user installations. 

Missing files; thanks for reporting. Can you please check this
new release instead:

  https://github.com/lualatex/luaotfload/releases/v2.3a

There?s a tds zip as well.

Thanks,
Philipp


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130710/48b92151/attachment.bin>

From evan.cooch at gmail.com  Wed Jul 10 18:57:19 2013
From: evan.cooch at gmail.com (Evan Cooch)
Date: Wed, 10 Jul 2013 12:57:19 -0400
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <1iripw093blf6$.dlg@nililand.de>
References: <1iripw093blf6$.dlg@nililand.de>
Message-ID: <51DD926F.5020805@gmail.com>

Have a look throught the last ~2 weeks of maillist archives. This issue 
has been discussed a fair bit, and it *appears* as if the problem is an 
outdated wrapper for *.lua scripts in the latest MikTeX.

On 7/10/2013 11:33 AM, Ulrike Fischer wrote:
> I found some time to update today miktex and texlive and would like
> to report some luaotfload problem.
>
> I used a small document for the tests which loads an system font:
>
> \documentclass{scrartcl}
> \usepackage{fontspec}
> \setmainfont{Arial}
> \begin{document}
> blub
> \end{document}
>
> I deleted the fonts caches before the tests.
>
> Problems
> 1. luaotfload can't create the font database on-the-fly during the
> compilation:
>
> luaotfload | db : Font names database not found, generating new one.
> luaotfload | db : This can take several minutes; please be patient.
> luaotfload | db : Failed to save names database
> luaotfload | db : Database creation unsuccessful.
>
> And there is nothing in the "names" folder.
> This happens in texlive + miktex.
>
> Running
>    luaotfload-tool --update --force --vv
> works fine and creates the database.
>
>
> 2. Miktex/installation specific:
> Miktex hanges while create the cache for a new font and shows a lua
> prompt:
>
> luaotfload | db : Database creation unsuccessful.
> luaotfload | load : loading the extended glyph list from ConTeXt
> lua>
>
> The problem seems to be that luaotfload tries to load font-age.lua
> which doesn't exist on a normal miktex system (there is not context)
>
> 3. lualatex compiles fine after I created the font databases with
> luaotfload-tool, but the log (both systems) shows a lot of this
> messages:
>
> luaotfload | cache : Could not write lookup cache
> luaotfload | cache: Could not write to cache
> luaotfload | cache : Could not write to cache
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20130710/e0690cab/attachment.html>

From stadtkind2 at gmx.de  Wed Jul 10 23:10:07 2013
From: stadtkind2 at gmx.de (Stefan =?iso-8859-1?Q?Kr=FCger?=)
Date: Wed, 10 Jul 2013 23:10:07 +0200
Subject: [luatex] MacTex 2013 + updates, typesetting with lualatex takes ages
Message-ID: <20130710211007.GV6734@web.de>

Hi,

after running tlmgr update --all, typesetting (all my documents!) the
following the document with lualatex:

\documentclass{article}
\usepackage{luatextra}
\begin{document}
Hello, world.
\end{document}

takes ages here. :(

real	0m53.85s
user	0m50.92s
sys	0m2.24s

Adding the following line

\setmainfont{Helvetica Neue}

makes it crawl even more:

real	11m35.54s
user	11m6.48s
sys	0m22.06s

The lualatex process spins on 1 CPU with ~ 100 % user. Any idea what could
cause this?

PS: xelatex and pdflatex are fine

Regards,

Stefan

From luatex at nililand.de  Thu Jul 11 10:34:11 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Thu, 11 Jul 2013 10:34:11 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <1iripw093blf6$.dlg@nililand.de> <x4doql3lamre$.dlg@nililand.de>
 <20130710165640.GA16900@phlegethon>
Message-ID: <ey7q35y9ra3m$.dlg@nililand.de>

Am Wed, 10 Jul 2013 18:56:40 +0200 schrieb Philipp Gesang:


> Missing files; thanks for reporting. Can you please check this
> new release instead:
> 
>   https://github.com/lualatex/luaotfload/releases/v2.3a
> 
> There?s a tds zip as well.

I tested the tds with miktex. I deleted the font cache and the
font-age.lua before the tests. Everythings seems to be fine with
this version:

- font database is created without problem during the compilation
(and is at the expected place). 
- the cache for a single font is created. 
- luaotfload now loads: loading the Adobe glyph list
- no suspicious " Could not write lookup cache" in the log or
terminal output.


And while I was at it I also added a test for a font in a texmf with
parentheses and spaces and it worked fine:

G:/texmf (space)/fonts/truetype/sil/doulossil-r.ttf




-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From luatex at nililand.de  Thu Jul 11 11:11:13 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Thu, 11 Jul 2013 11:11:13 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <1iripw093blf6$.dlg@nililand.de> <51DD926F.5020805@gmail.com>
Message-ID: <16rje4fez90tn.dlg@nililand.de>

Am Wed, 10 Jul 2013 12:57:19 -0400 schrieb Evan Cooch:

> Have a look throught the last ~2 weeks of maillist archives. This issue 
> has been discussed a fair bit, and it *appears* as if the problem is an 
> outdated wrapper for *.lua scripts in the latest MikTeX.

Well if you had really read my description you would have realized
that the issues I described can be reproduced with miktex **and**
texlive. The only miktex specific problem I reported is a missing
font-age.lua file. 

Also I didn't have a problem to run the wrapper luaotfload-tool.


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Thu Jul 11 11:53:33 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Thu, 11 Jul 2013 11:53:33 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <ey7q35y9ra3m$.dlg@nililand.de>
References: <1iripw093blf6$.dlg@nililand.de> <x4doql3lamre$.dlg@nililand.de>
 <20130710165640.GA16900@phlegethon> <ey7q35y9ra3m$.dlg@nililand.de>
Message-ID: <20130711095333.GA25111@phlegethon>

???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???

> Am Wed, 10 Jul 2013 18:56:40 +0200 schrieb Philipp Gesang:
> 
> 
> > Missing files; thanks for reporting. Can you please check this
> > new release instead:
> > 
> >   https://github.com/lualatex/luaotfload/releases/v2.3a
> > 
> > There?s a tds zip as well.
> 
> I tested the tds with miktex. I deleted the font cache and the
> font-age.lua before the tests. Everythings seems to be fine with
> this version:
> 
> - font database is created without problem during the compilation
> (and is at the expected place). 
> - the cache for a single font is created. 
> - luaotfload now loads: loading the Adobe glyph list
> - no suspicious " Could not write lookup cache" in the log or
> terminal output.
> 
> 
> And while I was at it I also added a test for a font in a texmf with
> parentheses and spaces and it worked fine:
> 
> G:/texmf (space)/fonts/truetype/sil/doulossil-r.ttf

Glad to see it working.

While you?re at it, would you be willing to help me out a bit?
I?ve added a somewhat experimental self-test that you can run
like so:

  luaotfload-tool --diagnose=files,permissions

Could you check if this works on your windows machine and paste
the output somewhere? I?m genuinely curious whether the
permissions tests yield meaningful results on win as they are
described only briefly in the Luatex manual. That?d be really
helpful!

Thanks,
Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130711/93e3155d/attachment.bin>

From luatex at nililand.de  Thu Jul 11 12:35:12 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Thu, 11 Jul 2013 12:35:12 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <1iripw093blf6$.dlg@nililand.de> <x4doql3lamre$.dlg@nililand.de>
 <20130710165640.GA16900@phlegethon> <ey7q35y9ra3m$.dlg@nililand.de>
 <20130711095333.GA25111@phlegethon>
Message-ID: <zid7dsyioz0z.dlg@nililand.de>

Am Thu, 11 Jul 2013 11:53:33 +0200 schrieb Philipp Gesang:

> ???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???
> 
>> Am Wed, 10 Jul 2013 18:56:40 +0200 schrieb Philipp Gesang:
>> 
>> 
>>> Missing files; thanks for reporting. Can you please check this
>>> new release instead:
>>> 
>>>   https://github.com/lualatex/luaotfload/releases/v2.3a
>>> 
>>> There?s a tds zip as well.
>> 
>> I tested the tds with miktex. I deleted the font cache and the
>> font-age.lua before the tests. Everythings seems to be fine with
>> this version:
>> 
>> - font database is created without problem during the compilation
>> (and is at the expected place). 
>> - the cache for a single font is created. 
>> - luaotfload now loads: loading the Adobe glyph list
>> - no suspicious " Could not write lookup cache" in the log or
>> terminal output.
>> 
>> 
>> And while I was at it I also added a test for a font in a texmf with
>> parentheses and spaces and it worked fine:
>> 
>> G:/texmf (space)/fonts/truetype/sil/doulossil-r.ttf
> 
> Glad to see it working.
> 
> While you?re at it, would you be willing to help me out a bit?
> I?ve added a somewhat experimental self-test that you can run
> like so:
> 
>   luaotfload-tool --diagnose=files,permissions
> 
> Could you check if this works on your windows machine and paste
> the output somewhere? I?m genuinely curious whether the
> permissions tests yield meaningful results on win as they are
> described only briefly in the Luatex manual. That?d be really
> helpful!

First try:

G:\Z-Test>luaotfload-tool  --diagnose=files.permissions
luaotfload | diagnose : Loading file hashes.
luaotfload | diagnose : Everything appears to be in order, you may
sleep well.

Well that's a comforting message ;-)

But if I correct the error (dot instead of comma in the list) I get
this (I replaced only my username). Remark the error at the end. The
result is similar with TL13):

G:\Z-Test>luaotfload-tool  --diagnose=files,permissions
luaotfload | diagnose : Loading file hashes.
luaotfload | diagnose : ================ verify files
=================
luaotfload | diagnose : Luaotfload revision
7548fbfccfb6a85e73cacdf62e945c4e5fb7
8e78.
luaotfload | diagnose : Committed by Philipp Gesang
<phg42.2a at gmail.com>.
luaotfload | diagnose : Timestamp 2013-07-10 18:18:21 +0200.
luaotfload | diagnose : Testing 25 files for integrity.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/scripts/luaotfload/mkstatu
s.
luaotfload | diagnose : Ok, mkstatus passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/scripts/luaotfload/mkglyph
list.
luaotfload | diagnose : Ok, mkglyphlist passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/scripts/luaotfload/mkchara
cters.
luaotfload | diagnose : Ok, mkcharacters passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-typo-krn.lua.
luaotfload | diagnose : Ok, luaotfload-typo-krn.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/scripts/luaotfload/luaotfl
oad-tool.lua.
luaotfload | diagnose : Ok, luaotfload-tool.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-override.lua.
luaotfload | diagnose : Ok, luaotfload-override.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-merged.lua.
luaotfload | diagnose : Ok, luaotfload-merged.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload.lua.
luaotfload | diagnose : Ok, luaotfload.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-loaders.lua.
luaotfload | diagnose : Ok, luaotfload-loaders.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-letterspace.lua.
luaotfload | diagnose : Ok, luaotfload-letterspace.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-glyphlist.lua.
luaotfload | diagnose : Ok, luaotfload-glyphlist.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-fonts-tfm.lua.
luaotfload | diagnose : Ok, luaotfload-fonts-tfm.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-fonts-lua.lua.
luaotfload | diagnose : Ok, luaotfload-fonts-lua.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-fonts-ext.lua.
luaotfload | diagnose : Ok, luaotfload-fonts-ext.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-fonts-enc.lua.
luaotfload | diagnose : Ok, luaotfload-fonts-enc.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-fonts-def.lua.
luaotfload | diagnose : Ok, luaotfload-fonts-def.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-fonts-cbk.lua.
luaotfload | diagnose : Ok, luaotfload-fonts-cbk.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-features.lua.
luaotfload | diagnose : Ok, luaotfload-features.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-extralibs.lua.
luaotfload | diagnose : Ok, luaotfload-extralibs.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-database.lua.
luaotfload | diagnose : Ok, luaotfload-database.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-colors.lua.
luaotfload | diagnose : Ok, luaotfload-colors.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-characters.lua.
luaotfload | diagnose : Ok, luaotfload-characters.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-basics-nod.lua.
luaotfload | diagnose : Ok, luaotfload-basics-nod.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-basics-gen.lua.
luaotfload | diagnose : Ok, luaotfload-basics-gen.lua passed.
luaotfload | diagnose : File:
G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
tfload-auxiliary.lua.
luaotfload | diagnose : Ok, luaotfload-auxiliary.lua passed.
luaotfload | diagnose : =============== file permissions
==============
luaotfload | diagnose : Checking permissions of
C:/Users/XXXX/AppData/Local/
MiKTeX/2.9/luatex-cache/generic//.
...p\luaotfload-test\scripts\luaotfload\luaotfload-tool.lua:1046:
attempt to index local 'attributes' (a nil value)



-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From jura.pintar at gmail.com  Thu Jul 11 15:21:51 2013
From: jura.pintar at gmail.com (Jura Pintar)
Date: Thu, 11 Jul 2013 09:21:51 -0400
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <mailman.7485.1373534331.3597.luatex@tug.org>
References: <mailman.7485.1373534331.3597.luatex@tug.org>
Message-ID: <51DEB16F.9000002@gmail.com>

With the latest version from GitHub (2.3a) I can also compile Ulrike's 
test document on the fly after deleting luatex-cache in both TeX Live 
2013 and MiKTeX 64-bit (both up to date). However...

> Well if you had really read my description you would have realized
> that the issues I described can be reproduced with miktex **and**
> texlive. The only miktex specific problem I reported is a missing
> font-age.lua file.
>
> Also I didn't have a problem to run the wrapper luaotfload-tool.

Ulrike, when you run luaotfload-tool --help under MiKTeX and under TeX 
Live, do you get the same output?

With the latest luaotfload update from GitHub, I still don't (the MiKTeX 
version prints the old help message of cca. 20 lines, the TeX Live 
version prints cca. 60 lines, ending with "The font cache will be 
written to..."). This is with the 64-bit MiKTeX, by the way.

In both distributions the new help message is issued when one does 
texlua /path/to/luaotfload-tool.lua --help.

> While you're at it, would you be willing to help me out a bit?
> I've added a somewhat experimental self-test that you can run
> like so:
>
>    luaotfload-tool --diagnose=files,permissions
>
> Could you check if this works on your windows machine and paste
> the output somewhere?

Philipp, I get the same result as Ulrike, with both distributions.

Best,

Jura





From stadtkind2 at gmx.de  Thu Jul 11 15:43:46 2013
From: stadtkind2 at gmx.de (Stefan =?iso-8859-1?Q?Kr=FCger?=)
Date: Thu, 11 Jul 2013 15:43:46 +0200
Subject: [luatex] MacTex 2013 + updates,
	typesetting with lualatex takes ages
In-Reply-To: <20130710211007.GV6734@web.de>
References: <20130710211007.GV6734@web.de>
Message-ID: <20130711134346.GW6734@gmx.de>

On Wed, 10 Jul 2013, Stefan Kr?ger wrote:

> Hi,
> 
> after running tlmgr update --all, typesetting (all my documents!) the
> following the document with lualatex:
> 
> \documentclass{article}
> \usepackage{luatextra}
> \begin{document}
> Hello, world.
> \end{document}
> 
> takes ages here. :(
> 
> real	0m53.85s
> user	0m50.92s
> sys	0m2.24s
> 
> Adding the following line
> 
> \setmainfont{Helvetica Neue}
> 
> makes it crawl even more:
> 
> real	11m35.54s
> user	11m6.48s
> sys	0m22.06s
> 
> The lualatex process spins on 1 CPU with ~ 100 % user. Any idea what could
> cause this?
> 
> PS: xelatex and pdflatex are fine
> 
> Regards,
> 
> Stefan

Hi,

replying to myself, this seems to be fixed by running
luaotfload-tool --update --force -vv (thanks to Ulrike Fischer).

Also thanks to Philipp Gesang for fixing the issue with fonts which contain
spaces in the file name(s).

:)

From luatex at nililand.de  Thu Jul 11 17:01:12 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Thu, 11 Jul 2013 17:01:12 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com>
Message-ID: <1h06vo4lu1s1k.dlg@nililand.de>

Am Thu, 11 Jul 2013 09:21:51 -0400 schrieb Jura Pintar:

> Ulrike, when you run luaotfload-tool --help under MiKTeX and under TeX 
> Live, do you get the same output?

No. But this is not caused by the binary wrapper of miktex pointing
to a wrong file: I get the same behaviour if I delete the lua-files
in the main miktex tree and so only the git files exists.
And -V always shows the git version number. 

The different messages are caused by an option:

luaotfload-tool --alias=luaotfload-tool --help : new message
luaotfload-tool --alias=mkluatexfontdb --help  : old message

Philipp: should I make a bug report so that miktex changes the
luaotfload-tool call? 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From jura.pintar at gmail.com  Thu Jul 11 17:37:27 2013
From: jura.pintar at gmail.com (Jura Pintar)
Date: Thu, 11 Jul 2013 11:37:27 -0400
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <mailman.7485.1373534331.3597.luatex@tug.org>
References: <mailman.7485.1373534331.3597.luatex@tug.org>
Message-ID: <51DED137.4030900@gmail.com>

> The different messages are caused by an option:
>
> luaotfload-tool --alias=luaotfload-tool --help : new message
> luaotfload-tool --alias=mkluatexfontdb --help  : old message

Mystery solved! Thanks!

J.

From Philipp.Gesang at alumni.uni-heidelberg.de  Sun Jul 14 15:10:30 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sun, 14 Jul 2013 15:10:30 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <1h06vo4lu1s1k.dlg@nililand.de>
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com> <1h06vo4lu1s1k.dlg@nililand.de>
Message-ID: <20130714131030.GA12271@phlegethon>

Hi Ulrike, others,

???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???

> Am Thu, 11 Jul 2013 09:21:51 -0400 schrieb Jura Pintar:
> 
> > Ulrike, when you run luaotfload-tool --help under MiKTeX and under TeX 
> > Live, do you get the same output?
> 
> No. But this is not caused by the binary wrapper of miktex pointing
> to a wrong file: I get the same behaviour if I delete the lua-files
> in the main miktex tree and so only the git files exists.
> And -V always shows the git version number. 
> 
> The different messages are caused by an option:
> 
> luaotfload-tool --alias=luaotfload-tool --help : new message
> luaotfload-tool --alias=mkluatexfontdb --help  : old message
> 
> Philipp: should I make a bug report so that miktex changes the
> luaotfload-tool call? 

I finally got around to install the Win32 version of Texlive
through Wine. In the cmd shell, luaotfload-tool --help correctly
displays the long message while mkluatexfontdb --help gives the
compatibility one. The cache paths are resolved correctly as
well, so there?s nothing wrong with the script as such, and
forcing the ?--alias? should be unnecessary.

So, yes, if you run luaotfload-tool --help and don?t get the
complete message, then this needs fixing on the Miktex side. The
script only accepts ?mkluatexfontdb? as an alias so we don?t
break existing scripts.

Best,
Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130714/9dac6d16/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Sun Jul 14 15:21:21 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sun, 14 Jul 2013 15:21:21 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <zid7dsyioz0z.dlg@nililand.de>
References: <1iripw093blf6$.dlg@nililand.de> <x4doql3lamre$.dlg@nililand.de>
 <20130710165640.GA16900@phlegethon> <ey7q35y9ra3m$.dlg@nililand.de>
 <20130711095333.GA25111@phlegethon> <zid7dsyioz0z.dlg@nililand.de>
Message-ID: <20130714132121.GB12271@phlegethon>

???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???

> Am Thu, 11 Jul 2013 11:53:33 +0200 schrieb Philipp Gesang:
> 
> > ???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???
> > 
> >> Am Wed, 10 Jul 2013 18:56:40 +0200 schrieb Philipp Gesang:
> >> 
> >> 
> >>> Missing files; thanks for reporting. Can you please check this
> >>> new release instead:
> >>> 
> >>>   https://github.com/lualatex/luaotfload/releases/v2.3a
> >>> 
> >>> There?s a tds zip as well.
> >> 
> >> I tested the tds with miktex. I deleted the font cache and the
> >> font-age.lua before the tests. Everythings seems to be fine with
> >> this version:
> >> 
> >> - font database is created without problem during the compilation
> >> (and is at the expected place). 
> >> - the cache for a single font is created. 
> >> - luaotfload now loads: loading the Adobe glyph list
> >> - no suspicious " Could not write lookup cache" in the log or
> >> terminal output.
> >> 
> >> 
> >> And while I was at it I also added a test for a font in a texmf with
> >> parentheses and spaces and it worked fine:
> >> 
> >> G:/texmf (space)/fonts/truetype/sil/doulossil-r.ttf
> > 
> > Glad to see it working.
> > 
> > While you?re at it, would you be willing to help me out a bit?
> > I?ve added a somewhat experimental self-test that you can run
> > like so:
> > 
> >   luaotfload-tool --diagnose=files,permissions
> > 
> > Could you check if this works on your windows machine and paste
> > the output somewhere? I?m genuinely curious whether the
> > permissions tests yield meaningful results on win as they are
> > described only briefly in the Luatex manual. That?d be really
> > helpful!
> 
>                                                               I get
> this (I replaced only my username). Remark the error at the end. The
> result is similar with TL13):
> 
> G:\Z-Test>luaotfload-tool  --diagnose=files,permissions
> luaotfload | diagnose : Loading file hashes.
> luaotfload | diagnose : ================ verify files
> =================
> luaotfload | diagnose : Luaotfload revision
> 7548fbfccfb6a85e73cacdf62e945c4e5fb7
> 8e78.
> luaotfload | diagnose : Committed by Philipp Gesang
> <phg42.2a at gmail.com>.
> luaotfload | diagnose : Timestamp 2013-07-10 18:18:21 +0200.
> luaotfload | diagnose : Testing 25 files for integrity.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/scripts/luaotfload/mkstatu
> s.
> luaotfload | diagnose : Ok, mkstatus passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/scripts/luaotfload/mkglyph
> list.
> luaotfload | diagnose : Ok, mkglyphlist passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/scripts/luaotfload/mkchara
> cters.
> luaotfload | diagnose : Ok, mkcharacters passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-typo-krn.lua.
> luaotfload | diagnose : Ok, luaotfload-typo-krn.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/scripts/luaotfload/luaotfl
> oad-tool.lua.
> luaotfload | diagnose : Ok, luaotfload-tool.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-override.lua.
> luaotfload | diagnose : Ok, luaotfload-override.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-merged.lua.
> luaotfload | diagnose : Ok, luaotfload-merged.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload.lua.
> luaotfload | diagnose : Ok, luaotfload.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-loaders.lua.
> luaotfload | diagnose : Ok, luaotfload-loaders.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-letterspace.lua.
> luaotfload | diagnose : Ok, luaotfload-letterspace.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-glyphlist.lua.
> luaotfload | diagnose : Ok, luaotfload-glyphlist.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-fonts-tfm.lua.
> luaotfload | diagnose : Ok, luaotfload-fonts-tfm.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-fonts-lua.lua.
> luaotfload | diagnose : Ok, luaotfload-fonts-lua.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-fonts-ext.lua.
> luaotfload | diagnose : Ok, luaotfload-fonts-ext.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-fonts-enc.lua.
> luaotfload | diagnose : Ok, luaotfload-fonts-enc.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-fonts-def.lua.
> luaotfload | diagnose : Ok, luaotfload-fonts-def.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-fonts-cbk.lua.
> luaotfload | diagnose : Ok, luaotfload-fonts-cbk.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-features.lua.
> luaotfload | diagnose : Ok, luaotfload-features.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-extralibs.lua.
> luaotfload | diagnose : Ok, luaotfload-extralibs.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-database.lua.
> luaotfload | diagnose : Ok, luaotfload-database.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-colors.lua.
> luaotfload | diagnose : Ok, luaotfload-colors.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-characters.lua.
> luaotfload | diagnose : Ok, luaotfload-characters.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-basics-nod.lua.
> luaotfload | diagnose : Ok, luaotfload-basics-nod.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-basics-gen.lua.
> luaotfload | diagnose : Ok, luaotfload-basics-gen.lua passed.
> luaotfload | diagnose : File:
> G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> tfload-auxiliary.lua.
> luaotfload | diagnose : Ok, luaotfload-auxiliary.lua passed.
> luaotfload | diagnose : =============== file permissions
> ==============
> luaotfload | diagnose : Checking permissions of
> C:/Users/XXXX/AppData/Local/
> MiKTeX/2.9/luatex-cache/generic//.
> ...p\luaotfload-test\scripts\luaotfload\luaotfload-tool.lua:1046:
> attempt to index local 'attributes' (a nil value)

The good news is: all files appear to be in order. The bad news
is that lfs.attributes() doesn?t seem to work in a Win
environment. Would have been too easy ... Anyways, I?ll
investigate alternatives to this.

Best,
Philipp


-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130714/fdfb971e/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Sun Jul 14 15:24:44 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sun, 14 Jul 2013 15:24:44 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <CAFKs89GEpJp1K3iSN8mf7SpksfmBQ8d3uAnC3XAYNwm5XguzVw@mail.gmail.com>
References: <mailman.5636.1373145239.3597.luatex@tug.org>
 <51D956EA.7070501@gmail.com>
 <CAFKs89GEpJp1K3iSN8mf7SpksfmBQ8d3uAnC3XAYNwm5XguzVw@mail.gmail.com>
Message-ID: <20130714132444.GC12271@phlegethon>

???<date: 2013-07-07, Sunday>???<from: Evan Cooch>???

> Cmd.exe /u starts a command prompt with UTF-16 support, but still, fair
> point.

Also, iirc the PSH terminal supports unicode.

Best,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130714/3e3c9852/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Sun Jul 14 16:03:16 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Sun, 14 Jul 2013 16:03:16 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <20130714132121.GB12271@phlegethon>
References: <1iripw093blf6$.dlg@nililand.de> <x4doql3lamre$.dlg@nililand.de>
 <20130710165640.GA16900@phlegethon> <ey7q35y9ra3m$.dlg@nililand.de>
 <20130711095333.GA25111@phlegethon> <zid7dsyioz0z.dlg@nililand.de>
 <20130714132121.GB12271@phlegethon>
Message-ID: <20130714140316.GD12271@phlegethon>

???<Datum: Sunday, 14. July 2013>???<Von: Philipp Gesang>???

> ???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???
> 
> > Am Thu, 11 Jul 2013 11:53:33 +0200 schrieb Philipp Gesang:
> > 
> > > ???<Datum: Thursday, 11. July 2013>???<Von: Ulrike Fischer>???
> > > 
> > >> Am Wed, 10 Jul 2013 18:56:40 +0200 schrieb Philipp Gesang:
> > >> 
> > >> 
> > >>> Missing files; thanks for reporting. Can you please check this
> > >>> new release instead:
> > >>> 
> > >>>   https://github.com/lualatex/luaotfload/releases/v2.3a
> > >>> 
> > >>> There?s a tds zip as well.
> > >> 
> > >> I tested the tds with miktex. I deleted the font cache and the
> > >> font-age.lua before the tests. Everythings seems to be fine with
> > >> this version:
> > >> 
> > >> - font database is created without problem during the compilation
> > >> (and is at the expected place). 
> > >> - the cache for a single font is created. 
> > >> - luaotfload now loads: loading the Adobe glyph list
> > >> - no suspicious " Could not write lookup cache" in the log or
> > >> terminal output.
> > >> 
> > >> 
> > >> And while I was at it I also added a test for a font in a texmf with
> > >> parentheses and spaces and it worked fine:
> > >> 
> > >> G:/texmf (space)/fonts/truetype/sil/doulossil-r.ttf
> > > 
> > > Glad to see it working.
> > > 
> > > While you?re at it, would you be willing to help me out a bit?
> > > I?ve added a somewhat experimental self-test that you can run
> > > like so:
> > > 
> > >   luaotfload-tool --diagnose=files,permissions
> > > 
> > > Could you check if this works on your windows machine and paste
> > > the output somewhere? I?m genuinely curious whether the
> > > permissions tests yield meaningful results on win as they are
> > > described only briefly in the Luatex manual. That?d be really
> > > helpful!
> > 
> >                                                               I get
> > this (I replaced only my username). Remark the error at the end. The
> > result is similar with TL13):
> > 
> > G:\Z-Test>luaotfload-tool  --diagnose=files,permissions
> > luaotfload | diagnose : Loading file hashes.
> > luaotfload | diagnose : ================ verify files
> > =================
> > luaotfload | diagnose : Luaotfload revision
> > 7548fbfccfb6a85e73cacdf62e945c4e5fb7
> > 8e78.
> > luaotfload | diagnose : Committed by Philipp Gesang
> > <phg42.2a at gmail.com>.
> > luaotfload | diagnose : Timestamp 2013-07-10 18:18:21 +0200.
> > luaotfload | diagnose : Testing 25 files for integrity.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/scripts/luaotfload/mkstatu
> > s.
> > luaotfload | diagnose : Ok, mkstatus passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/scripts/luaotfload/mkglyph
> > list.
> > luaotfload | diagnose : Ok, mkglyphlist passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/scripts/luaotfload/mkchara
> > cters.
> > luaotfload | diagnose : Ok, mkcharacters passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-typo-krn.lua.
> > luaotfload | diagnose : Ok, luaotfload-typo-krn.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/scripts/luaotfload/luaotfl
> > oad-tool.lua.
> > luaotfload | diagnose : Ok, luaotfload-tool.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-override.lua.
> > luaotfload | diagnose : Ok, luaotfload-override.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-merged.lua.
> > luaotfload | diagnose : Ok, luaotfload-merged.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload.lua.
> > luaotfload | diagnose : Ok, luaotfload.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-loaders.lua.
> > luaotfload | diagnose : Ok, luaotfload-loaders.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-letterspace.lua.
> > luaotfload | diagnose : Ok, luaotfload-letterspace.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-glyphlist.lua.
> > luaotfload | diagnose : Ok, luaotfload-glyphlist.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-fonts-tfm.lua.
> > luaotfload | diagnose : Ok, luaotfload-fonts-tfm.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-fonts-lua.lua.
> > luaotfload | diagnose : Ok, luaotfload-fonts-lua.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-fonts-ext.lua.
> > luaotfload | diagnose : Ok, luaotfload-fonts-ext.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-fonts-enc.lua.
> > luaotfload | diagnose : Ok, luaotfload-fonts-enc.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-fonts-def.lua.
> > luaotfload | diagnose : Ok, luaotfload-fonts-def.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-fonts-cbk.lua.
> > luaotfload | diagnose : Ok, luaotfload-fonts-cbk.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-features.lua.
> > luaotfload | diagnose : Ok, luaotfload-features.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-extralibs.lua.
> > luaotfload | diagnose : Ok, luaotfload-extralibs.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-database.lua.
> > luaotfload | diagnose : Ok, luaotfload-database.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-colors.lua.
> > luaotfload | diagnose : Ok, luaotfload-colors.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-characters.lua.
> > luaotfload | diagnose : Ok, luaotfload-characters.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-basics-nod.lua.
> > luaotfload | diagnose : Ok, luaotfload-basics-nod.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-basics-gen.lua.
> > luaotfload | diagnose : Ok, luaotfload-basics-gen.lua passed.
> > luaotfload | diagnose : File:
> > G:/Temp/luaotfload-test/tex/luatex/luaotfload/luao
> > tfload-auxiliary.lua.
> > luaotfload | diagnose : Ok, luaotfload-auxiliary.lua passed.
> > luaotfload | diagnose : =============== file permissions
> > ==============
> > luaotfload | diagnose : Checking permissions of
> > C:/Users/XXXX/AppData/Local/
> > MiKTeX/2.9/luatex-cache/generic//.
> > ...p\luaotfload-test\scripts\luaotfload\luaotfload-tool.lua:1046:
> > attempt to index local 'attributes' (a nil value)
> 
> The good news is: all files appear to be in order. The bad news
> is that lfs.attributes() doesn?t seem to work in a Win
> environment.

I take that back, it works, it just doesn?t take kindly to
trailing slashes. If that is handled properly, the diagnostics
run fine.

Philipp

-- 
()  ascii ribbon campaign - against html e-mail
/\  www.asciiribbon.org   - against proprietary attachments
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130714/bc6461e0/attachment-0001.bin>

From luatex at nililand.de  Sun Jul 14 16:04:38 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Sun, 14 Jul 2013 16:04:38 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com> <1h06vo4lu1s1k.dlg@nililand.de>
 <20130714131030.GA12271@phlegethon>
Message-ID: <4cum8qcijkkr.dlg@nililand.de>

Am Sun, 14 Jul 2013 15:10:30 +0200 schrieb Philipp Gesang:

>> The different messages are caused by an option:
>> 
>> luaotfload-tool --alias=luaotfload-tool --help : new message
>> luaotfload-tool --alias=mkluatexfontdb --help  : old message
>> 
>> Philipp: should I make a bug report so that miktex changes the
>> luaotfload-tool call? 
> 
> I finally got around to install the Win32 version of Texlive
> through Wine. In the cmd shell, luaotfload-tool --help correctly
> displays the long message while mkluatexfontdb --help gives the
> compatibility one. The cache paths are resolved correctly as
> well, so there?s nothing wrong with the script as such, and
> forcing the ?--alias? should be unnecessary.
> 
> So, yes, if you run luaotfload-tool --help and don?t get the
> complete message, then this needs fixing on the Miktex side. The
> script only accepts ?mkluatexfontdb? as an alias so we don?t
> break existing scripts.

Ok, I will make a miktex bugreport and suggest that

luaotfload-tool.exe =
luaotfload-tool --alias=luaotfload-tool 

and 
mkluatexfontdb.exe =
luaotfload-tool --alias=mkluatexfontdb 



-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From luatex at nililand.de  Mon Jul 15 10:03:59 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Mon, 15 Jul 2013 10:03:59 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com> <1h06vo4lu1s1k.dlg@nililand.de>
 <20130714131030.GA12271@phlegethon>
Message-ID: <1axx87shanz30$.dlg@nililand.de>

Am Sun, 14 Jul 2013 15:10:30 +0200 schrieb Philipp Gesang:

> So, yes, if you run luaotfload-tool --help and don?t get the
> complete message, then this needs fixing on the Miktex side.

It is imho necessary that the new luaotfload (the 2.3 fixes) goes to
CTAN before Christian can fix the binary wrapper. When will you
release it?


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Mon Jul 15 20:03:18 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Mon, 15 Jul 2013 20:03:18 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <1axx87shanz30$.dlg@nililand.de>
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com> <1h06vo4lu1s1k.dlg@nililand.de>
 <20130714131030.GA12271@phlegethon>
 <1axx87shanz30$.dlg@nililand.de>
Message-ID: <20130715180318.GA20789@phlegethon>

???<Datum: Monday, 15. July 2013>???<Von: Ulrike Fischer>???

> Am Sun, 14 Jul 2013 15:10:30 +0200 schrieb Philipp Gesang:
> 
> > So, yes, if you run luaotfload-tool --help and don?t get the
> > complete message, then this needs fixing on the Miktex side.
> 
> It is imho necessary that the new luaotfload (the 2.3 fixes) goes to
> CTAN before Christian can fix the binary wrapper. When will you
> release it?

The fixes were uploaded before I put up the github release. CTAN
shows version 2.3a, that?s the one.

Best,
Philipp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130715/3d39bbe0/attachment.bin>

From Herbert.Voss at FU-Berlin.DE  Mon Jul 15 21:28:18 2013
From: Herbert.Voss at FU-Berlin.DE (Herbert Voss)
Date: Mon, 15 Jul 2013 21:28:18 +0200
Subject: [luatex] babel, fontspec und lualatex
Message-ID: <51E44D52.7070307@FU-Berlin.DE>

WIth current TL 2013, LuaLaTeX, and babel I get an additional
space between\TeX and nic
With polyglossia or using XeLaTeX everything is fine.

Herbert


%%lualatex test

\documentclass[12pt]{article}
\usepackage{fontspec}
\iftrue
%\iffalse
   \usepackage[ngerman]{babel}
\else
   \usepackage{polyglossia}

\setmainlanguage[spelling=new,latesthyphen=true,babelshorthands=true{german}
\fi
\begin{document}
\Huge
{\itshape\TeX nic}
\sffamily
\textit{\TeX nic}
\textsl{\TeX nic}

\end{document}

From luatex at nililand.de  Tue Jul 16 10:17:56 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Tue, 16 Jul 2013 10:17:56 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com> <1h06vo4lu1s1k.dlg@nililand.de>
 <20130714131030.GA12271@phlegethon> <1axx87shanz30$.dlg@nililand.de>
 <20130715180318.GA20789@phlegethon>
Message-ID: <1izexoailby6v$.dlg@nililand.de>

Am Mon, 15 Jul 2013 20:03:18 +0200 schrieb Philipp Gesang:


>> It is imho necessary that the new luaotfload (the 2.3 fixes) goes to
>> CTAN before Christian can fix the binary wrapper. When will you
>> release it?
> 
> The fixes were uploaded before I put up the github release. CTAN
> shows version 2.3a, that?s the one.

I hadn't realized this (there was no announcement). I will tell
Christian that he should update luaotfload. 

Btw: The naming of the versions are a bit confusing. Miktex has
currently

  [2013/05/23 v2.3d OpenType layout system]

and the version on CTAN is

  [2013/07/10 v2.3a OpenType layout system]

You are counting backward ;-)

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From luatex at nililand.de  Tue Jul 16 11:05:31 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Tue, 16 Jul 2013 11:05:31 +0200
Subject: [luatex] babel, fontspec und lualatex
References: <51E44D52.7070307@FU-Berlin.DE>
Message-ID: <1n4exf1ifxw3v$.dlg@nililand.de>

Am Mon, 15 Jul 2013 21:28:18 +0200 schrieb Herbert Voss:

> WIth current TL 2013, LuaLaTeX, and babel I get an additional
> space between\TeX and nic
> With polyglossia or using XeLaTeX everything is fine.

The new babel redefines the \TeX command and surrounds it by
\textlatin and this reveals a bug:
 
\fontdimen1 is wrong with lualatex (it is 0pt) and now the tests for
italic correction fails as latex doesn't realize that a slanted font
is involved:


\documentclass[12pt]{article}

\usepackage[english]{babel}
\usepackage{fontspec}


\begin{document}
\Huge



{\itshape
 \the\fontdimen1\font %0pt with lualatex, 0.25pt with xelatex

 \textlatin{XXXX}nic

  XXXXnic
}



{\itshape \fontdimen1\font=0.25pt

 \textlatin{XXXX}nic  
 
  XXXXnic
}

\end{document} 

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From luatex at nililand.de  Tue Jul 16 12:36:29 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Tue, 16 Jul 2013 12:36:29 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
References: <mailman.5636.1373145239.3597.luatex@tug.org>
 <51D956EA.7070501@gmail.com>
 <CAFKs89GEpJp1K3iSN8mf7SpksfmBQ8d3uAnC3XAYNwm5XguzVw@mail.gmail.com>
 <20130714132444.GC12271@phlegethon>
Message-ID: <powfg91xsoie.dlg@nililand.de>

Am Sun, 14 Jul 2013 15:24:44 +0200 schrieb Philipp Gesang:

>>> By the way, the Windows Command Prompt doesn't display unicode 
>>> characaters by default, so it would be better for Windows users if the 
>>> command line tools like luaotfload-tool were to avoid them (quotation 
>>> marks come out garbled, in particular).

>> Cmd.exe /u starts a command prompt with UTF-16 support, but still, fair
>> point.
 
> Also, iirc the PSH terminal supports unicode.

Well I played a bit around but I can't improve the output of the
cmd.  

And the main problem are the quotes: 
luaotfload | db : Font ???myriadpro-regular.otf??? already indexed

(It is a bit better if I change to another font like Lucida Console
or Consolas, then I see only three boxes, but I don't like the
fonts). 

Couldn't the quotes be changed to ascii?

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Tue Jul 16 21:42:51 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 16 Jul 2013 21:42:51 +0200
Subject: [luatex] luaotfload problems (MiKTeX/Windows 7) | not solved
In-Reply-To: <powfg91xsoie.dlg@nililand.de>
References: <mailman.5636.1373145239.3597.luatex@tug.org>
 <51D956EA.7070501@gmail.com>
 <CAFKs89GEpJp1K3iSN8mf7SpksfmBQ8d3uAnC3XAYNwm5XguzVw@mail.gmail.com>
 <20130714132444.GC12271@phlegethon> <powfg91xsoie.dlg@nililand.de>
Message-ID: <20130716194251.GA24112@phlegethon>

???<Datum: Tuesday, 16. July 2013>???<Von: Ulrike Fischer>???

> Am Sun, 14 Jul 2013 15:24:44 +0200 schrieb Philipp Gesang:
> 
> >>> By the way, the Windows Command Prompt doesn't display unicode 
> >>> characaters by default, so it would be better for Windows users if the 
> >>> command line tools like luaotfload-tool were to avoid them (quotation 
> >>> marks come out garbled, in particular).
> 
> >> Cmd.exe /u starts a command prompt with UTF-16 support, but still, fair
> >> point.
>  
> > Also, iirc the PSH terminal supports unicode.
> 
> Well I played a bit around but I can't improve the output of the
> cmd.  
> 
> And the main problem are the quotes: 
> luaotfload | db : Font ???myriadpro-regular.otf??? already indexed
> 
> (It is a bit better if I change to another font like Lucida Console
> or Consolas, then I see only three boxes, but I don't like the
> fonts). 
> 
> Couldn't the quotes be changed to ascii?

Ok, quotes removed from the output.

Best,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130716/a15c6e98/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Tue Jul 16 21:51:28 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Tue, 16 Jul 2013 21:51:28 +0200
Subject: [luatex] luaotfload problems on windows (TL + Miktex)
In-Reply-To: <1izexoailby6v$.dlg@nililand.de>
References: <mailman.7485.1373534331.3597.luatex@tug.org>
 <51DEB16F.9000002@gmail.com> <1h06vo4lu1s1k.dlg@nililand.de>
 <20130714131030.GA12271@phlegethon>
 <1axx87shanz30$.dlg@nililand.de>
 <20130715180318.GA20789@phlegethon>
 <1izexoailby6v$.dlg@nililand.de>
Message-ID: <20130716195128.GB24112@phlegethon>

???<Datum: Tuesday, 16. July 2013>???<Von: Ulrike Fischer>???

> Am Mon, 15 Jul 2013 20:03:18 +0200 schrieb Philipp Gesang:
> 
> 
> >> It is imho necessary that the new luaotfload (the 2.3 fixes) goes to
> >> CTAN before Christian can fix the binary wrapper. When will you
> >> release it?
> > 
> > The fixes were uploaded before I put up the github release. CTAN
> > shows version 2.3a, that?s the one.
> 
> I hadn't realized this (there was no announcement). I will tell
> Christian that he should update luaotfload. 
> 
> Btw: The naming of the versions are a bit confusing. Miktex has
> currently
> 
>   [2013/05/23 v2.3d OpenType layout system]

Should have been 2.3. Side effect of my workaround for dtx.

> and the version on CTAN is
> 
>   [2013/07/10 v2.3a OpenType layout system]
> 
> You are counting backward ;-)

Wouldn?t be the first TeX-related software with a bizarre
versioning scheme ... but no, just a leaky regex.

Best,
Philipp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130716/e8ffb85c/attachment.bin>

From luatex at nililand.de  Mon Jul 22 15:04:26 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Mon, 22 Jul 2013 15:04:26 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
Message-ID: <80hh000iaukj$.dlg@nililand.de>

During a test I run into the following problem:

The luaotfload-names.lua created by miktex contains pathes of
subfolders of my test document (the document is in z-test, and this
folder is a complete jungle of various subfolders, and imho z-temp
got there only due to some faulty mouse click):

g:/z-test/z-temp/biolinum_re-0.3.7.otf

Running the same document with texlive doesn't give this pathes in
the cache file. So where do they come from?

(I don't think that it is a problem with the luaotfload version as I
get the same problem if I attach the texmf-dist of texlive as first
root in miktex).


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Mon Jul 22 22:23:25 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Mon, 22 Jul 2013 22:23:25 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
In-Reply-To: <80hh000iaukj$.dlg@nililand.de>
References: <80hh000iaukj$.dlg@nililand.de>
Message-ID: <20130722202325.GA7128@phlegethon>

???<Datum: Monday, 22. July 2013>???<Von: Ulrike Fischer>???

> During a test I run into the following problem:
> 
> The luaotfload-names.lua created by miktex contains pathes of
> subfolders of my test document (the document is in z-test, and this
> folder is a complete jungle of various subfolders, and imho z-temp
> got there only due to some faulty mouse click):
> 
> g:/z-test/z-temp/biolinum_re-0.3.7.otf
> 
> Running the same document with texlive doesn't give this pathes in
> the cache file. So where do they come from?

Does not happen here, neither with native Linux nor Wine, so all
I can offer is speculation:

1. $OSFONTDIR includes ?.?;
2. in your document you specify a local font directory (via
   fontspec) that is included with aux.scan_external_dir();
3. there?s a symlink in one of your font directories leading to
   that subdirectory or the font files therein.

If none of the above applies, then how exactly did you generate
the names database? Can you reproduce it and do you have a log?

Best,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130722/9d2d98d9/attachment.bin>

From luatex at nililand.de  Tue Jul 23 10:23:34 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Tue, 23 Jul 2013 10:23:34 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
References: <80hh000iaukj$.dlg@nililand.de> <20130722202325.GA7128@phlegethon>
Message-ID: <t4usgdkncjl3.dlg@nililand.de>

Am Mon, 22 Jul 2013 22:23:25 +0200 schrieb Philipp Gesang:


>> During a test I run into the following problem:
>> 
>> The luaotfload-names.lua created by miktex contains pathes of
>> subfolders of my test document (the document is in z-test, and this
>> folder is a complete jungle of various subfolders, and imho z-temp
>> got there only due to some faulty mouse click):
>> 
>> g:/z-test/z-temp/biolinum_re-0.3.7.otf
>> 
>> Running the same document with texlive doesn't give this pathes in
>> the cache file. So where do they come from?
> 
> Does not happen here, neither with native Linux nor Wine, so all
> I can offer is speculation:
> 
> 1. $OSFONTDIR includes ?.?;

No, it is simply C:\windows\fonts

> 2. in your document you specify a local font directory (via
>    fontspec) that is included with aux.scan_external_dir();
> 3. there?s a symlink in one of your font directories leading to
>    that subdirectory or the font files therein.
> 
> If none of the above applies, then how exactly did you generate
> the names database? Can you reproduce it and do you have a log?

I can reproduce it without problems and it is not related to a
document but to the folder from where luaotfload-tool is called. If
I start it in z-test I get all fonts in subfolders in z-test. If I
start in F:/install I have fonts from there:

["filename"]="f:/install/schriften/vera/ttf-bitstream-vera-1.10/vera.ttf",

 
The log file also show that the current directory is scanned:

luaotfload | db : Scanning TEXMF and OS fonts...
luaotfload | db : Scanning directory F:/Install
luaotfload | db : 18 font files detected
luaotfload | db : Loading font
?f:/install/schriften/vera/ttf-bitstream-vera-1.10/vera.ttf?


While in texlive the tool starts with a texmf-tree:

luaotfload | db : Scanning TEXMF and OS fonts...
luaotfload | db : Scanning directory
e:/TeX/UFlocaltexmf/fonts/opentype


Despite the fact that the fonts in the subfolders are listed
miktex-luatex can't find and use them (that's how I stumbled over
the problem: I was looping over luaoftload-names.lua and got "font
not found errors"). Fonts in the current directory works fine in
both systems. 
 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Fri Jul 26 11:31:30 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 26 Jul 2013 11:31:30 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
In-Reply-To: <t4usgdkncjl3.dlg@nililand.de>
References: <80hh000iaukj$.dlg@nililand.de> <20130722202325.GA7128@phlegethon>
 <t4usgdkncjl3.dlg@nililand.de>
Message-ID: <20130726093130.GA24596@phlegethon>

???<Datum: Tuesday, 23. July 2013>???<Von: Ulrike Fischer>???

> Am Mon, 22 Jul 2013 22:23:25 +0200 schrieb Philipp Gesang:
> 
> 
> >> During a test I run into the following problem:
> >> 
> >> The luaotfload-names.lua created by miktex contains pathes of
> >> subfolders of my test document (the document is in z-test, and this
> >> folder is a complete jungle of various subfolders, and imho z-temp
> >> got there only due to some faulty mouse click):
> >> 
> >> g:/z-test/z-temp/biolinum_re-0.3.7.otf
> >> 
> >> Running the same document with texlive doesn't give this pathes in
> >> the cache file. So where do they come from?
> > 
> > Does not happen here, neither with native Linux nor Wine, so all
> > I can offer is speculation:
> > 
> > 1. $OSFONTDIR includes ?.?;
> 
> No, it is simply C:\windows\fonts
> 
> > 2. in your document you specify a local font directory (via
> >    fontspec) that is included with aux.scan_external_dir();
> > 3. there?s a symlink in one of your font directories leading to
> >    that subdirectory or the font files therein.
> > 
> > If none of the above applies, then how exactly did you generate
> > the names database? Can you reproduce it and do you have a log?
> 
> I can reproduce it without problems and it is not related to a
> document but to the folder from where luaotfload-tool is called. If
> I start it in z-test I get all fonts in subfolders in z-test. If I
> start in F:/install I have fonts from there:
> 
> ["filename"]="f:/install/schriften/vera/ttf-bitstream-vera-1.10/vera.ttf",
> 
>  
> The log file also show that the current directory is scanned:
> 
> luaotfload | db : Scanning TEXMF and OS fonts...
> luaotfload | db : Scanning directory F:/Install
> luaotfload | db : 18 font files detected
> luaotfload | db : Loading font
> ?f:/install/schriften/vera/ttf-bitstream-vera-1.10/vera.ttf?
> 
> 
> While in texlive the tool starts with a texmf-tree:
> 
> luaotfload | db : Scanning TEXMF and OS fonts...
> luaotfload | db : Scanning directory
> e:/TeX/UFlocaltexmf/fonts/opentype
> 
> 
> Despite the fact that the fonts in the subfolders are listed
> miktex-luatex can't find and use them (that's how I stumbled over
> the problem: I was looping over luaoftload-names.lua and got "font
> not found errors"). Fonts in the current directory works fine in
> both systems. 

Weird. Can you please post the output of below script? Thanks!
Philipp
  

#!/usr/bin/env texlua

kpse.set_program_name "luatex"
require "lualibs"

print (string.rep ("-", 71))
print (kpse.expand_path "$OSFONTDIR")

print (string.rep ("-", 71))
print (kpse.expand_path "$OPENTYPEFONTS")
print (string.rep ("-", 71))
inspect (file.splitpath (kpse.expand_path "$OPENTYPEFONTS"))

print (string.rep ("-", 71))
print (kpse.expand_path "$TTFONTS")
print (string.rep ("-", 71))
inspect (file.splitpath (kpse.expand_path "$TTFONTS"))

print (string.rep ("-", 71))

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130726/88a59d9d/attachment.bin>

From luatex at nililand.de  Fri Jul 26 12:00:46 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Fri, 26 Jul 2013 12:00:46 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
References: <80hh000iaukj$.dlg@nililand.de> <20130722202325.GA7128@phlegethon>
 <t4usgdkncjl3.dlg@nililand.de> <20130726093130.GA24596@phlegethon>
Message-ID: <1keu72ohy53u5.dlg@nililand.de>

Am Fri, 26 Jul 2013 11:31:30 +0200 schrieb Philipp Gesang:

>>>> During a test I run into the following problem:
>>>> 
>>>> The luaotfload-names.lua created by miktex contains pathes of
>>>> subfolders of my test document (the document is in z-test, and this
>>>> folder is a complete jungle of various subfolders, and imho z-temp
>>>> got there only due to some faulty mouse click):
>>>> 
>>>> g:/z-test/z-temp/biolinum_re-0.3.7.otf
>>>> 
>>>> Running the same document with texlive doesn't give this pathes in
>>>> the cache file. So where do they come from?
>>> 
>>> Does not happen here, neither with native Linux nor Wine, so all
>>> I can offer is speculation:
>>> 
>>> 1. $OSFONTDIR includes ?.?;
>> 
>> No, it is simply C:\windows\fonts
>> 
>>> 2. in your document you specify a local font directory (via
>>>    fontspec) that is included with aux.scan_external_dir();
>>> 3. there?s a symlink in one of your font directories leading to
>>>    that subdirectory or the font files therein.
>>> 
>>> If none of the above applies, then how exactly did you generate
>>> the names database? Can you reproduce it and do you have a log?
>> 
>> I can reproduce it without problems and it is not related to a
>> document but to the folder from where luaotfload-tool is called. If
>> I start it in z-test I get all fonts in subfolders in z-test. If I
>> start in F:/install I have fonts from there:
>> 
>> ["filename"]="f:/install/schriften/vera/ttf-bitstream-vera-1.10/vera.ttf",
>> 
>>  
>> The log file also show that the current directory is scanned:
>> 
>> luaotfload | db : Scanning TEXMF and OS fonts...
>> luaotfload | db : Scanning directory F:/Install
>> luaotfload | db : 18 font files detected
>> luaotfload | db : Loading font
>> ?f:/install/schriften/vera/ttf-bitstream-vera-1.10/vera.ttf?
>> 
>> 
>> While in texlive the tool starts with a texmf-tree:
>> 
>> luaotfload | db : Scanning TEXMF and OS fonts...
>> luaotfload | db : Scanning directory
>> e:/TeX/UFlocaltexmf/fonts/opentype
>> 
>> 
>> Despite the fact that the fonts in the subfolders are listed
>> miktex-luatex can't find and use them (that's how I stumbled over
>> the problem: I was looping over luaoftload-names.lua and got "font
>> not found errors"). Fonts in the current directory works fine in
>> both systems. 
> 
> Weird. Can you please post the output of below script? Thanks!

I tested the script with TL + Miktex. The obvious difference is:

The miktex output starts everywhere like this:

table={
 "G:/Z-Test",

while TL13 output start like this:

table={
 ".",

in both cases a sensible list of font folders follows. 


I also ran
G:\Z-Test>kpsewhich --expand-path=$OPENTYPEFONTS

and can see there the same behaviour: Miktex shows the actual name
of the current folder, while TL shows ".". 

So probably luaotfload doesn't realize that G:\test is the current
folder and so starts to scan the subfolders. Should this problem be
addressed in luaotfload or should miktex change the output of
--expand-path? 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From listas at tex-tipografia.com  Fri Jul 26 12:19:23 2013
From: listas at tex-tipografia.com (Javier Bezos)
Date: Fri, 26 Jul 2013 12:19:23 +0200
Subject: [luatex] babel, fontspec und lualatex
In-Reply-To: <1n4exf1ifxw3v$.dlg@nililand.de>
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
Message-ID: <51F24D2B.3060908@tex-tipografia.com>

Ulrike,

> The new babel redefines the \TeX command and surrounds it by
> \textlatin and this reveals a bug:

Do you know if it works with the old (3.8) babel? (I've not tried
it out yet -- just back from holidays). I have not changed this part
(afaik :-)) because I'm still investigating how to fix the whole
\text<script> stuff in a backward compatible way.

Javier

From luatex at nililand.de  Fri Jul 26 12:24:59 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Fri, 26 Jul 2013 12:24:59 +0200
Subject: [luatex] babel, fontspec und lualatex
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
 <51F24D2B.3060908@tex-tipografia.com>
Message-ID: <8ceiv4kdqlla$.dlg@nililand.de>

Am Fri, 26 Jul 2013 12:19:23 +0200 schrieb Javier Bezos:

> Ulrike,
> 
>> The new babel redefines the \TeX command and surrounds it by
>> \textlatin and this reveals a bug:
> 
> Do you know if it works with the old (3.8) babel? (I've not tried
> it out yet -- just back from holidays). I have not changed this part
> (afaik :-)) because I'm still investigating how to fix the whole
> \text<script> stuff in a backward compatible way.

miktex still has Babel <v3.8m>, so I could test: There is the same
problem, the fontdimen is 0 and there is to much space between X and
n. 

Imho the correct solution would be that luatex/luaotfload sets
\fontdimen1 for italic fonts to a sensible positiv value. 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Fri Jul 26 12:25:26 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 26 Jul 2013 12:25:26 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
In-Reply-To: <1keu72ohy53u5.dlg@nililand.de>
References: <80hh000iaukj$.dlg@nililand.de> <20130722202325.GA7128@phlegethon>
 <t4usgdkncjl3.dlg@nililand.de> <20130726093130.GA24596@phlegethon>
 <1keu72ohy53u5.dlg@nililand.de>
Message-ID: <20130726102525.GB24596@phlegethon>

???<Datum: Friday, 26. July 2013>???<Von: Ulrike Fischer>???

> Am Fri, 26 Jul 2013 11:31:30 +0200 schrieb Philipp Gesang:
> 
> >>> 1. $OSFONTDIR includes ?.?;
> >> 
> >> No, it is simply C:\windows\fonts

Btw. as you were asking to distinguish texmf from system fonts
earlier: $OSFONTDIR as a kpathsea variable will be treated in the
texmf category. Set $OSFONTDIR to the empty string to avoid that.
Luaotfload will then scan $WINDIR/fonts independently.

> >> Despite the fact that the fonts in the subfolders are listed
> >> miktex-luatex can't find and use them (that's how I stumbled over
> >> the problem: I was looping over luaoftload-names.lua and got "font
> >> not found errors"). Fonts in the current directory works fine in
> >> both systems. 
> > 
> > Weird. Can you please post the output of below script? Thanks!
> 
> I tested the script with TL + Miktex. The obvious difference is:
> 
> The miktex output starts everywhere like this:
> 
> table={
>  "G:/Z-Test",
> 
> while TL13 output start like this:
> 
> table={
>  ".",
> 
> in both cases a sensible list of font folders follows. 
> 
> 
> I also ran
> G:\Z-Test>kpsewhich --expand-path=$OPENTYPEFONTS
> 
> and can see there the same behaviour: Miktex shows the actual name
> of the current folder, while TL shows ".". 

*That?s it*, exactly!

> So probably luaotfload doesn't realize that G:\test is the current
> folder and so starts to scan the subfolders. Should this problem be
> addressed in luaotfload or should miktex change the output of
> --expand-path? 

I probably could add a check for whether a path equals the
abspath of ?.?, though I find Miktex?s behavior counterintuitive
to say the least. Is that expected on Win?

Best,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130726/8832cf42/attachment.bin>

From luatex at nililand.de  Fri Jul 26 12:54:20 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Fri, 26 Jul 2013 12:54:20 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
References: <80hh000iaukj$.dlg@nililand.de> <20130722202325.GA7128@phlegethon>
 <t4usgdkncjl3.dlg@nililand.de> <20130726093130.GA24596@phlegethon>
 <1keu72ohy53u5.dlg@nililand.de> <20130726102525.GB24596@phlegethon>
Message-ID: <hwo3ojtf1nip$.dlg@nililand.de>

Am Fri, 26 Jul 2013 12:25:26 +0200 schrieb Philipp Gesang:


>>>>> 1. $OSFONTDIR includes ?.?;
 
>>>> No, it is simply C:\windows\fonts
> 
> Btw. as you were asking to distinguish texmf from system fonts
> earlier: $OSFONTDIR as a kpathsea variable will be treated in the
> texmf category. Set $OSFONTDIR to the empty string to avoid that.
> Luaotfload will then scan $WINDIR/fonts independently.

I haven't set $OSFONDIR myself. There is no environment variable.
But miktex outputs a value when I use kpsewhich --expand-var. (BTW:
the output of TL and miktex is here too slightly different:

Miktex: C:/Windows/Fonts
TL: C:/Windows/fonts//

(notice the // at the end).


 
>> I also ran
>> G:\Z-Test>kpsewhich --expand-path=$OPENTYPEFONTS
>> 
>> and can see there the same behaviour: Miktex shows the actual name
>> of the current folder, while TL shows ".". 
> 
> *That?s it*, exactly!
> 
>> So probably luaotfload doesn't realize that G:\test is the current
>> folder and so starts to scan the subfolders. Should this problem be
>> addressed in luaotfload or should miktex change the output of
>> --expand-path? 
> 
> I probably could add a check for whether a path equals the
> abspath of ?.?, though I find Miktex?s behavior counterintuitive
> to say the least. Is that expected on Win?

Well my TeXlive is also in Windows ;-)

Imho the question is if in an expanded path a variable like "."
should be expanded to the current directory or not. 

But the question is: Why does luaotfload add a scan of subfolders at
all?

The output of kpse.expand_path "$OPENTYPEFONTS" contains already all
sensible subfolders, e.g.

"D:/MiKTeX2.9/fonts/opentype/public/asana-math"
"d:/texlive/2013/texmf-dist/fonts/opentype/public/Asana-Math",



-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Fri Jul 26 12:59:55 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 26 Jul 2013 12:59:55 +0200
Subject: [luatex] babel, fontspec und lualatex
In-Reply-To: <8ceiv4kdqlla$.dlg@nililand.de>
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
 <51F24D2B.3060908@tex-tipografia.com>
 <8ceiv4kdqlla$.dlg@nililand.de>
Message-ID: <20130726105955.GC24596@phlegethon>

???<Datum: Friday, 26. July 2013>???<Von: Ulrike Fischer>???

> Am Fri, 26 Jul 2013 12:19:23 +0200 schrieb Javier Bezos:
> 
> > Ulrike,
> > 
> >> The new babel redefines the \TeX command and surrounds it by
> >> \textlatin and this reveals a bug:
> > 
> > Do you know if it works with the old (3.8) babel? (I've not tried
> > it out yet -- just back from holidays). I have not changed this part
> > (afaik :-)) because I'm still investigating how to fix the whole
> > \text<script> stuff in a backward compatible way.
> 
> miktex still has Babel <v3.8m>, so I could test: There is the same
> problem, the fontdimen is 0 and there is to much space between X and
> n. 
> 
> Imho the correct solution would be that luatex/luaotfload sets
> \fontdimen1 for italic fonts to a sensible positiv value. 

What?s ?a sensible value? if italic correction is done on node
level? There?s tfmdata.properties.autoitalicamount and
tfmdata.parameters.slantfactor if you need the information [0].
We could certainly set further fontdimensions in addition to the
one we do already (no. 8), but if we spend time on that part then
why not supply the entire list in one go? Someone knowledgeable
about font parameters and how they translate to the original
values would have to supply the code, though, especially when it
comes to the more delicate parts described in appendix G.

Best,
Philipp


[0] luaotfload-fonts-ext.lua
    https://github.com/phi-gamma/luaotfload/blob/master/luaotfload-fonts-ext.lua#L19

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130726/9a8ac865/attachment-0001.bin>

From luatex at nililand.de  Fri Jul 26 13:06:23 2013
From: luatex at nililand.de (Ulrike Fischer)
Date: Fri, 26 Jul 2013 13:06:23 +0200
Subject: [luatex] babel, fontspec und lualatex
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
 <51F24D2B.3060908@tex-tipografia.com> <8ceiv4kdqlla$.dlg@nililand.de>
 <20130726105955.GC24596@phlegethon>
Message-ID: <wh9cy5oekc7l.dlg@nililand.de>

Am Fri, 26 Jul 2013 12:59:55 +0200 schrieb Philipp Gesang:

>> Imho the correct solution would be that luatex/luaotfload sets
>> \fontdimen1 for italic fonts to a sensible positiv value. 

> What?s ?a sensible value? if italic correction is done on node
> level? There?s tfmdata.properties.autoitalicamount and
> tfmdata.parameters.slantfactor if you need the information [0].
> We could certainly set further fontdimensions in addition to the
> one we do already (no. 8), but if we spend time on that part then
> why not supply the entire list in one go? Someone knowledgeable
> about font parameters and how they translate to the original
> values would have to supply the code, though, especially when it
> comes to the more delicate parts described in appendix G.

Perhaps one should ask Jonathan Kew. A similar discussion came up
for xelatex some years ago and he added at the request of Will
Robertston values of some of the standard fontdimens.

http://tug.org/mailman/htdig/xetex/2005-October/002692.html
http://tug.org/mailman/htdig/xetex/2005-December/002847.html



-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From Philipp.Gesang at alumni.uni-heidelberg.de  Fri Jul 26 13:12:44 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 26 Jul 2013 13:12:44 +0200
Subject: [luatex] luaotfload-tool lists fonts in subfolders
In-Reply-To: <hwo3ojtf1nip$.dlg@nililand.de>
References: <80hh000iaukj$.dlg@nililand.de> <20130722202325.GA7128@phlegethon>
 <t4usgdkncjl3.dlg@nililand.de> <20130726093130.GA24596@phlegethon>
 <1keu72ohy53u5.dlg@nililand.de> <20130726102525.GB24596@phlegethon>
 <hwo3ojtf1nip$.dlg@nililand.de>
Message-ID: <20130726111244.GD24596@phlegethon>

???<Datum: Friday, 26. July 2013>???<Von: Ulrike Fischer>???

> Am Fri, 26 Jul 2013 12:25:26 +0200 schrieb Philipp Gesang:
> 
> 
> >>>>> 1. $OSFONTDIR includes ?.?;
>  
> >>>> No, it is simply C:\windows\fonts
> > 
> > Btw. as you were asking to distinguish texmf from system fonts
> > earlier: $OSFONTDIR as a kpathsea variable will be treated in the
> > texmf category. Set $OSFONTDIR to the empty string to avoid that.
> > Luaotfload will then scan $WINDIR/fonts independently.
> 
> I haven't set $OSFONDIR myself.

Then it comes from texmf.cnf. You might have to temporarily set
it to the empty string before running luaotfload-tool. Maybe
there could be an option to skip $OSFONTDIR and the likes.

>                                 There is no environment variable.
> But miktex outputs a value when I use kpsewhich --expand-var. (BTW:
> the output of TL and miktex is here too slightly different:
> 
> Miktex: C:/Windows/Fonts
> TL: C:/Windows/fonts//
> 
> (notice the // at the end).

This should be harmless, except for the quirks of the lfs
library.

> >> I also ran
> >> G:\Z-Test>kpsewhich --expand-path=$OPENTYPEFONTS
> >> 
> >> and can see there the same behaviour: Miktex shows the actual name
> >> of the current folder, while TL shows ".". 
> > 
> > *That?s it*, exactly!
> > 
> >> So probably luaotfload doesn't realize that G:\test is the current
> >> folder and so starts to scan the subfolders. Should this problem be
> >> addressed in luaotfload or should miktex change the output of
> >> --expand-path? 
> > 
> > I probably could add a check for whether a path equals the
> > abspath of ?.?, though I find Miktex?s behavior counterintuitive
> > to say the least. Is that expected on Win?
> 
> Well my TeXlive is also in Windows ;-)

I noticed TL tends to be more forgiving for Unixish assumptions.

> Imho the question is if in an expanded path a variable like "."
> should be expanded to the current directory or not. 
> 
> But the question is: Why does luaotfload add a scan of subfolders at
> all?

Because I didn?t consider that case when I rewrote the directory
scanner. I just commited a change that suppresses recursion into
subdirs so the problem might disappear with the next release.

Best,
Philipp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130726/9d026348/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Fri Jul 26 13:27:29 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 26 Jul 2013 13:27:29 +0200
Subject: [luatex] babel, fontspec und lualatex
In-Reply-To: <wh9cy5oekc7l.dlg@nililand.de>
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
 <51F24D2B.3060908@tex-tipografia.com>
 <8ceiv4kdqlla$.dlg@nililand.de> <20130726105955.GC24596@phlegethon>
 <wh9cy5oekc7l.dlg@nililand.de>
Message-ID: <20130726112729.GE24596@phlegethon>

???<Datum: Friday, 26. July 2013>???<Von: Ulrike Fischer>???

> Am Fri, 26 Jul 2013 12:59:55 +0200 schrieb Philipp Gesang:
> 
> >> Imho the correct solution would be that luatex/luaotfload sets
> >> \fontdimen1 for italic fonts to a sensible positiv value. 
> 
> > What?s ?a sensible value? if italic correction is done on node
> > level? There?s tfmdata.properties.autoitalicamount and
> > tfmdata.parameters.slantfactor if you need the information [0].
> > We could certainly set further fontdimensions in addition to the
> > one we do already (no. 8), but if we spend time on that part then
> > why not supply the entire list in one go? Someone knowledgeable
> > about font parameters and how they translate to the original
> > values would have to supply the code, though, especially when it
> > comes to the more delicate parts described in appendix G.
> 
> Perhaps one should ask Jonathan Kew. A similar discussion came up
> for xelatex some years ago and he added at the request of Will
> Robertston values of some of the standard fontdimens.
> 
> http://tug.org/mailman/htdig/xetex/2005-October/002692.html
> http://tug.org/mailman/htdig/xetex/2005-December/002847.html

I opened a tracker item for anyone willing to contribute:

  https://github.com/lualatex/luaotfload/issues/112

but this is definitely going to take a while.

Best,
Philipp
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130726/abcf7285/attachment.bin>

From khaledhosny at eglug.org  Fri Jul 26 13:40:09 2013
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 26 Jul 2013 13:40:09 +0200
Subject: [luatex] babel, fontspec und lualatex
In-Reply-To: <20130726105955.GC24596@phlegethon>
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
 <51F24D2B.3060908@tex-tipografia.com>
 <8ceiv4kdqlla$.dlg@nililand.de> <20130726105955.GC24596@phlegethon>
Message-ID: <20130726114008.GA25064@khaled-laptop>

On Fri, Jul 26, 2013 at 12:59:55PM +0200, Philipp Gesang wrote:
> ???<Datum: Friday, 26. July 2013>???<Von: Ulrike Fischer>???
> 
> > Am Fri, 26 Jul 2013 12:19:23 +0200 schrieb Javier Bezos:
> > 
> > > Ulrike,
> > > 
> > >> The new babel redefines the \TeX command and surrounds it by
> > >> \textlatin and this reveals a bug:
> > > 
> > > Do you know if it works with the old (3.8) babel? (I've not tried
> > > it out yet -- just back from holidays). I have not changed this part
> > > (afaik :-)) because I'm still investigating how to fix the whole
> > > \text<script> stuff in a backward compatible way.
> > 
> > miktex still has Babel <v3.8m>, so I could test: There is the same
> > problem, the fontdimen is 0 and there is to much space between X and
> > n. 
> > 
> > Imho the correct solution would be that luatex/luaotfload sets
> > \fontdimen1 for italic fonts to a sensible positiv value. 
> 
> What?s ?a sensible value? if italic correction is done on node
> level?

Note that \fontdimen1 is *not* italic correction, but the italic angle
of the font i.e. its slant amount.

> Someone knowledgeable about font parameters and how they translate to
> the original values would have to supply the code, though,

ConTeXt code in luaotfload already does that, at least I see that
copytotfm() sets parameters.slant for italic fonts, so someone needs to
check why this is not working as expected.

> especially when it comes to the more delicate parts described in
> appendix G.

You don?t need to worry about math font dimentions, the OpenType math
machinary does not need them (they might even confuse LuaTeX to thing it
is dealing with an old font) and old math fonts should have them in the
loaded TFM files already.

Regards,
Khaled
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: Digital signature
URL: <http://tug.org/pipermail/luatex/attachments/20130726/bdad4303/attachment.bin>

From Philipp.Gesang at alumni.uni-heidelberg.de  Fri Jul 26 14:45:40 2013
From: Philipp.Gesang at alumni.uni-heidelberg.de (Philipp Gesang)
Date: Fri, 26 Jul 2013 14:45:40 +0200
Subject: [luatex] babel, fontspec und lualatex
In-Reply-To: <20130726114008.GA25064@khaled-laptop>
References: <51E44D52.7070307@FU-Berlin.DE> <1n4exf1ifxw3v$.dlg@nililand.de>
 <51F24D2B.3060908@tex-tipografia.com>
 <8ceiv4kdqlla$.dlg@nililand.de> <20130726105955.GC24596@phlegethon>
 <20130726114008.GA25064@khaled-laptop>
Message-ID: <20130726124540.GA26503@phlegethon>

???<date: 2013-07-26, Friday>???<from: Khaled Hosny>???

> On Fri, Jul 26, 2013 at 12:59:55PM +0200, Philipp Gesang wrote:
> > ???<Datum: Friday, 26. July 2013>???<Von: Ulrike Fischer>???
> > 
> > > Am Fri, 26 Jul 2013 12:19:23 +0200 schrieb Javier Bezos:
> > > 
> > > > Ulrike,
> > > > 
> > > >> The new babel redefines the \TeX command and surrounds it by
> > > >> \textlatin and this reveals a bug:
> > > > 
> > > > Do you know if it works with the old (3.8) babel? (I've not tried
> > > > it out yet -- just back from holidays). I have not changed this part
> > > > (afaik :-)) because I'm still investigating how to fix the whole
> > > > \text<script> stuff in a backward compatible way.
> > > 
> > > miktex still has Babel <v3.8m>, so I could test: There is the same
> > > problem, the fontdimen is 0 and there is to much space between X and
> > > n. 
> > > 
> > > Imho the correct solution would be that luatex/luaotfload sets
> > > \fontdimen1 for italic fonts to a sensible positiv value. 
> > 
> > What?s ?a sensible value? if italic correction is done on node
> > level?
> 
> Note that \fontdimen1 is *not* italic correction, but the italic angle
> of the font i.e. its slant amount.
> 
> > Someone knowledgeable about font parameters and how they translate to
> > the original values would have to supply the code, though,
> 
> ConTeXt code in luaotfload already does that, at least I see that
> copytotfm() sets parameters.slant for italic fonts, so someone needs to
> check why this is not working as expected.
> 
> > especially when it comes to the more delicate parts described in
> > appendix G.
> 
> You don?t need to worry about math font dimentions, the OpenType math
> machinary does not need them (they might even confuse LuaTeX to thing it
> is dealing with an old font) and old math fonts should have them in the
> loaded TFM files already.


This line:

  http://repo.or.cz/w/context.git/blob/refs/heads/origin:/tex/context/base/font-otf.lua#l1954

rounds the value of parameters.slant to -0. If I scale it to the
point size:

  parameters.slant=- math.round(math.tan(italicangle*math.pi/180) * 2^16)

I get the same output visually with babel as with polyglossia in
Herbert?s original example.

I?ll put Hans in the CC since he know?s best.

Best,
Philipp

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 490 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20130726/c0ee98f4/attachment.bin>

