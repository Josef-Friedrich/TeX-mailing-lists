From skostysh at lyx.org  Sun Nov  1 18:18:53 2020
From: skostysh at lyx.org (Scott Kostyshak)
Date: Sun, 1 Nov 2020 12:18:53 -0500
Subject: [luatex] Assertion from texlang.c with reproducible example
In-Reply-To: <CAG5iGsCuV_DQa76f4BwF+B4zR9xxKOA=qfbRVzvt042EA+8=1A@mail.gmail.com>
References: <20201030030430.4y4i6bdpwx633qs7@vbox-VirtualBox>
 <CAG5iGsCuV_DQa76f4BwF+B4zR9xxKOA=qfbRVzvt042EA+8=1A@mail.gmail.com>
Message-ID: <20201101171853.zpferngu73jgqthp@tallinn>

On Fri, Oct 30, 2020 at 08:16:08PM +0100, luigi scarso wrote:
> On Fri, Oct 30, 2020 at 4:05 AM Scott Kostyshak <skostysh at lyx.org> wrote:
> 
> > I receive an assertion when trying to compile the following example with
> > lualatex:
> >
> > ----------------------------------
> > \documentclass{book}
> > \usepackage{fontspec}
> > \setmainfont[Ligatures=TeX]{FreeSerif}
> > \setsansfont[Ligatures=TeX]{FreeSans}
> > \setmonofont{FreeMono}
> > \usepackage{polyglossia}
> > \setdefaultlanguage{hebrew}
> > \setotherlanguage{english}
> > \begin{document}
> > ?- ?-\textquotedbl\textenglish[variant=american]{Page~1}?,
> > \end{document}
> > ----------------------------------
> >
> > The assertion is the following:
> >
> > (/usr/local/texlive/2020/texmf-dist/tex/latex/base/ts1cmr.fd)lualatex:
> > ../../../texk/web2c/luatexdir/lang/texlang.c:986: hnj_hyphenation:
> > Assertion `(((varmem[(wordstart)].hh.u.B1) & (1 << 0)) &&
> > !((varmem[(wordstart)].hh.u.B1) & (1 << 1) ) &&
> > !((varmem[(wordstart)].hh.u.B1) & (1 << 2) ))' failed.
> >
> > I also get the assertion if I try with lualatex-dev. I'm on an updated TeX
> > Live 2020 on Ubuntu 20.10.
> >
> > Can others reproduce?
> >
> > Scott
> >
> 
> yes, confirmed.

Thanks for confirming, Luigi.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 488 bytes
Desc: not available
URL: <https://tug.org/pipermail/luatex/attachments/20201101/3621fb52/attachment.sig>

From k.sasha1994 at yandex.ru  Thu Nov  5 05:00:00 2020
From: k.sasha1994 at yandex.ru (Alexander Kozlovskiy)
Date: Thu, 5 Nov 2020 07:00:00 +0300
Subject: [luatex] How to redefine command with optional argument using expl3?
Message-ID: <15a5af56-f646-1a3d-036b-fe3fd0e3b2e5@yandex.ru>

Hello everybody. I want to redefine \table/tabular environments,to do 
autotagging of this environments. I know,what \tabular have one 
mandatory argument,and one optional,and optional argument use in 
\maketitle command. Please,help me redefine \tabular command,to fix 
error,which happens during compilation in latex.

! LaTeX Error: Illegal character in array arg.

I know,what this error happens because according to debug,first 
argument,which optional, [t] separate to three arguments: [ t and ],but 
i dont know,how to solve this issue. Also i know,what for different 
packages optional argument can be different,but how it handle using 
expl3,i haven't any idea. Thanks everybody very much for any 
help,because i dont know,how to solve this.

\documentclass{article}
\usepackage{tagpdf}
\tagpdfsetup{tabsorder=structure,uncompress,activate-all,add-new-tag=Title/P,interwordspace=true} 

\ExplSyntaxOn
\makeatletter
\prop_gset_from_keyval:Nn{\g__tables_prop}{table=0,endtable=1,table*=0,endtable*=1,tabular=0,endtabular=1,tabular*=0,endtabular*=1,tabbing=0,endtabbing=1,tabbing*=0,endtabbing*=1} 

\prop_map_inline:Nn \g__tables_prop{
\cs_set_eq:cc{orig@#1}{#1}
\int_case:nnF{#2}
{
{0} %somethin with \begin,e.g \begin{tabular}
{
\cs_gset_protected:cpn{#1}##1{
\cs_new_protected:Npn \l__tab_char: {
\tagmcend
\tagstructend
\tagstructend
\tagstructbegin{tag=TD}
\tagstructbegin{tag=P}
\tagmcbegin{tag=P}
 ??? \c_alignment_token
}
\char_set_active_eq:NN \& \l__tab_char:
\char_set_catcode_active:N \&
\tagstructbegin{tag=Table}
\tagstructbegin{tag=TBody}
\use:c{orig@#1}{##1}
\message{argument~##1}
}
}
{1} %somethin with \end,e.g \end{tabular}
{
\cs_gset_protected:cpn{#1}{
\use:c{orig@#1}
\tagstructend
\tagstructend
}
}
}
{}
}
\makeatother
\ExplSyntaxOff
\author{Alexandr Kozlovskiy}
\title{test}
\begin{document}
\tagstructbegin{tag=Document}
\maketitle{} %error
\makeatletter
%this code works ok.
\begin{tabular}{ccc}
1&2&3
\end{tabular}
\tagstructend
\end{document}

From eduardoochs at gmail.com  Thu Nov  5 09:14:26 2020
From: eduardoochs at gmail.com (Eduardo Ochs)
Date: Thu, 5 Nov 2020 05:14:26 -0300
Subject: [luatex] Problem with package.searchers in TeXLive 2020
Message-ID: <CADs++6hC1JymUNOdJtaH+9Pkg8HHk+YsLcRk16VUgXKCuD3KgQ@mail.gmail.com>

I am getting a strange error with TeXLive 2020 here that I don't get
with TeXLive 2019. The error is:

  .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:378:
    attempt to call a nil value (field 'cpath specification')
  stack traceback:
  .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:378:
    in local 'lookup'
  .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:402:
    in function
<.../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:392>
        [C]: in function 'require'
        dednat6/dednat6.lua:58: in main chunk
        [C]: in function 'dofile'
        dednat6load.lua:58: in main chunk
        [C]: in function 'dofile'
        [\directlua]:1: in main chunk.
  l.50 \directlua{dofile "dednat6load.lua"}

and what I understood after a few hours trying to debug this is that
the culprit on my side is this chunk of code:

  package.loaders = package.loaders or package.searchers
  local function lualoader(modulename) ... end
  table.insert(package.loaders, 2, lualoader)

in this file:

  http://angg.twu.net/dednat6/dednat6/lualoader.lua.html

it seems that my code confuses the part of the code in

  /usr/local/texlive/2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua

that comes from lualibs-package.lua... I tkdiff'ed the versions of
lualibs-package.lua from TeXLive 2019 and TeXLive 2020 by doing

  tkdiff \
    /usr/local/texlive/2019/texmf-dist/tex/luatex/lualibs/lualibs-package.lua \
    /usr/local/texlive/2020/texmf-dist/tex/luatex/lualibs/lualibs-package.lua

and I found that the function "helpers" contains this code,

  builtin    = {
      ["preload table"]       = searchers[1+offset], -- special case,
built-in libs
      ["path specification"]  = searchers[2+offset],
      ["cpath specification"] = searchers[3+offset],
      ["all in one fallback"] = searchers[4+offset], -- special case,
combined libs
  },

that supposes that users will not insert their own functions in the
middle of the table package.searchers... but there's a LOT in the code
in lualibs-package.lua that I don't understand - including the parts
that changed from 2019 to 2020.

What should I do? Should I change my code that adds a new searcher to
package.searchers? How? All the users of Dednat6 that I have conctact
with use Dednat6 both on recent TeXLives and on TeXLive 2016/2017 -
for Arxiv-related reasons - so I need to find a solution that works on
as many versions of TeXLive as possible...

  Thanks in advance!
    Eduardo Ochs
    http://angg.twu.net/dednat6.html
    http://angg.twu.net/math-b.html

From luigi.scarso at gmail.com  Thu Nov  5 10:15:53 2020
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 5 Nov 2020 10:15:53 +0100
Subject: [luatex] Problem with package.searchers in TeXLive 2020
In-Reply-To: <CADs++6hC1JymUNOdJtaH+9Pkg8HHk+YsLcRk16VUgXKCuD3KgQ@mail.gmail.com>
References: <CADs++6hC1JymUNOdJtaH+9Pkg8HHk+YsLcRk16VUgXKCuD3KgQ@mail.gmail.com>
Message-ID: <CAG5iGsA9mZpD4_nG1WepRSBQC-gEM_CaG59A9Cd3F9uc2JxvFw@mail.gmail.com>

On Thu, Nov 5, 2020 at 9:15 AM Eduardo Ochs <eduardoochs at gmail.com> wrote:

> I am getting a strange error with TeXLive 2020 here that I don't get
> with TeXLive 2019. The error is:
>
>   .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:378:
>     attempt to call a nil value (field 'cpath specification')
>   stack traceback:
>   .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:378:
>     in local 'lookup'
>   .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:402:
>     in function
> <.../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:392>
>         [C]: in function 'require'
>         dednat6/dednat6.lua:58: in main chunk
>         [C]: in function 'dofile'
>         dednat6load.lua:58: in main chunk
>         [C]: in function 'dofile'
>         [\directlua]:1: in main chunk.
>   l.50 \directlua{dofile "dednat6load.lua"}
>

Is it reproducible with luatex (not lualatex) in some way e.g. by means of
luatex-plain ?

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201105/b678492e/attachment.html>

From eduardoochs at gmail.com  Thu Nov  5 10:58:22 2020
From: eduardoochs at gmail.com (Eduardo Ochs)
Date: Thu, 5 Nov 2020 06:58:22 -0300
Subject: [luatex] Problem with package.searchers in TeXLive 2020
In-Reply-To: <CAG5iGsA9mZpD4_nG1WepRSBQC-gEM_CaG59A9Cd3F9uc2JxvFw@mail.gmail.com>
References: <CADs++6hC1JymUNOdJtaH+9Pkg8HHk+YsLcRk16VUgXKCuD3KgQ@mail.gmail.com>
 <CAG5iGsA9mZpD4_nG1WepRSBQC-gEM_CaG59A9Cd3F9uc2JxvFw@mail.gmail.com>
Message-ID: <CADs++6gFJxmpHM7sfahdLshYBgW4+5XLV71Yx=vnv5Sara5sBQ@mail.gmail.com>

No, dednat6 runs fine on the luatex of TeXLive 2020.
The problem is really in the Lua code in:

  /usr/local/texlive/2020/texmf-dist/tex/luatex/lualibs/

As those files are in a directory that doesn't say "latex"
anywhere - they are from ConTeXt - I though that this
could be the right place to ask, but now I am with the
feeling that it is not... =/

Where is the right place to discuss this?
Thanks in advance and sorry for the noise,
  Eduardo Ochs

On Thu, 5 Nov 2020 at 06:17, luigi scarso <luigi.scarso at gmail.com> wrote:
>
>
>
> On Thu, Nov 5, 2020 at 9:15 AM Eduardo Ochs <eduardoochs at gmail.com> wrote:
>>
>> I am getting a strange error with TeXLive 2020 here that I don't get
>> with TeXLive 2019. The error is:
>>
>>   .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:378:
>>     attempt to call a nil value (field 'cpath specification')
>>   stack traceback:
>>   .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:378:
>>     in local 'lookup'
>>   .../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:402:
>>     in function
>> <.../2020/texmf-dist/tex/luatex/lualibs/lualibs-basic-merged.lua:392>
>>         [C]: in function 'require'
>>         dednat6/dednat6.lua:58: in main chunk
>>         [C]: in function 'dofile'
>>         dednat6load.lua:58: in main chunk
>>         [C]: in function 'dofile'
>>         [\directlua]:1: in main chunk.
>>   l.50 \directlua{dofile "dednat6load.lua"}
>
>
> Is it reproducible with luatex (not lualatex) in some way e.g. by means of luatex-plain ?
>
> --
> luigi

From luigi.scarso at gmail.com  Thu Nov  5 11:37:47 2020
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 5 Nov 2020 11:37:47 +0100
Subject: [luatex] Problem with package.searchers in TeXLive 2020
In-Reply-To: <CADs++6gFJxmpHM7sfahdLshYBgW4+5XLV71Yx=vnv5Sara5sBQ@mail.gmail.com>
References: <CADs++6hC1JymUNOdJtaH+9Pkg8HHk+YsLcRk16VUgXKCuD3KgQ@mail.gmail.com>
 <CAG5iGsA9mZpD4_nG1WepRSBQC-gEM_CaG59A9Cd3F9uc2JxvFw@mail.gmail.com>
 <CADs++6gFJxmpHM7sfahdLshYBgW4+5XLV71Yx=vnv5Sara5sBQ@mail.gmail.com>
Message-ID: <CAG5iGsCeeLcw89-9Aq5VCbwfdYn=uC2Lrmxv6+nG6464jtWmGw@mail.gmail.com>

On Thu, Nov 5, 2020 at 10:59 AM Eduardo Ochs <eduardoochs at gmail.com> wrote:

> No, dednat6 runs fine on the luatex of TeXLive 2020.
> The problem is really in the Lua code in:
>
>   /usr/local/texlive/2020/texmf-dist/tex/luatex/lualibs/
>
> As those files are in a directory that doesn't say "latex"
> anywhere - they are from ConTeXt - I though that this
> could be the right place to ask, but now I am with the
> feeling that it is not... =/
>

well, given that lualibs is under luatex it could be a luatex problem...
anyway, you can also try at
https://tex.stackexchange.com/

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201105/b973086b/attachment.html>

From luatex at nililand.de  Thu Nov  5 14:19:44 2020
From: luatex at nililand.de (Ulrike Fischer)
Date: Thu, 5 Nov 2020 14:19:44 +0100
Subject: [luatex] Problem with package.searchers in TeXLive 2020
References: <CADs++6hC1JymUNOdJtaH+9Pkg8HHk+YsLcRk16VUgXKCuD3KgQ@mail.gmail.com>
Message-ID: <fxcg3ts18c1e.dlg@nililand.de>

Am Thu, 5 Nov 2020 05:14:26 -0300 schrieb Eduardo Ochs:

> What should I do?

lualibs is only a merged copy from context files. So we are not
really maintaining it. But you could add an issue at

  https://github.com/latex3/lualibs/issues

anyway. 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From alessi at robertalessi.net  Sat Nov  7 19:39:37 2020
From: alessi at robertalessi.net (Robert Alessi)
Date: Sat, 7 Nov 2020 19:39:37 +0100
Subject: [luatex] luatex and minted
Message-ID: <20201107183937.GA18505@robertalessi.net>

Dear all,

I have no idea why the following all of a sudden fails to compile with
lualatex (I run an up-to-date texlive 2020):

--------------------snip--------------------
\documentclass{article}

\usepackage{minted}

\begin{document}

\begin{minted}{latex}
   a-'
\end{minted}

\end{document}
--------------------snip--------------------

Remarks:
--------

1. The error message I get:
(./_minted-test/C1B3C74AA35F87A14838FF588F40D6B6715769D21B52E45A
A7CE8C545C6279BA.pygtexlualatex: ../../../texk/web2c/luatexdir/lang/texlang.c:986: hnj_hyphenation: Assertion `(((varmem[(wordstart)].hh.u.B1) & (1 << 0)) && !((varmem[(wordstart)].hh.u.B1) & (1 << 1) ) && !((varmem[(wordstart)].hh.u.B1) & (1 << 2) ))' failed.

2. If I remove the straight single quotation mark so as to write a-
   instead of a-' it passes.

3. xelatex and pdflatex work on this file.

4. I tried lualatex-dev --shell-escape but no avail.

Any ideas would be much appreciated!

Best,

Robert


From luigi.scarso at gmail.com  Sun Nov  8 00:08:57 2020
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sun, 8 Nov 2020 00:08:57 +0100
Subject: [luatex] luatex and minted
In-Reply-To: <20201107183937.GA18505@robertalessi.net>
References: <20201107183937.GA18505@robertalessi.net>
Message-ID: <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>

On Sat, Nov 7, 2020 at 7:40 PM Robert Alessi <alessi at robertalessi.net>
wrote:

> Dear all,
>
> I have no idea why the following all of a sudden fails to compile with
> lualatex (I run an up-to-date texlive 2020):
>
> --------------------snip--------------------
> \documentclass{article}
>
> \usepackage{minted}
>
> \begin{document}
>
> \begin{minted}{latex}
>    a-'
> \end{minted}
>
> \end{document}
> --------------------snip--------------------
>
> Remarks:
> --------
>
> 1. The error message I get:
> (./_minted-test/C1B3C74AA35F87A14838FF588F40D6B6715769D21B52E45A
> A7CE8C545C6279BA.pygtexlualatex:
> ../../../texk/web2c/luatexdir/lang/texlang.c:986: hnj_hyphenation:
> Assertion `(((varmem[(wordstart)].hh.u.B1) & (1 << 0)) &&
> !((varmem[(wordstart)].hh.u.B1) & (1 << 1) ) &&
> !((varmem[(wordstart)].hh.u.B1) & (1 << 2) ))' failed.
>
> 2. If I remove the straight single quotation mark so as to write a-
>    instead of a-' it passes.
>
> 3. xelatex and pdflatex work on this file.
>
> 4. I tried lualatex-dev --shell-escape but no avail.
>
> Any ideas would be much appreciated!
>
> Best,
>
> Robert
>
>
It's the same problem as in
Assertion from texlang.c with reproducible example
<https://tug.org/pipermail/luatex/2020-November/007424.html>

( the hyphenation expects a simple word, but
the word doesn't start with a character.)
For the moment I will make a better error message.


-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201108/52af0b07/attachment.html>

From d.p.carlisle at gmail.com  Sun Nov  8 00:47:39 2020
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Sat, 7 Nov 2020 23:47:39 +0000
Subject: [luatex] luatex and minted
In-Reply-To: <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
References: <20201107183937.GA18505@robertalessi.net>
 <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
Message-ID: <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>

On Sat, 7 Nov 2020 at 23:10, luigi scarso <luigi.scarso at gmail.com> wrote:

>
>
> On Sat, Nov 7, 2020 at 7:40 PM Robert Alessi <alessi at robertalessi.net>
> wrote:
>
>> Dear all,
>>
>> I have no idea why the following all of a sudden fails to compile with
>> lualatex (I run an up-to-date texlive 2020):
>>
>> --------------------snip--------------------
>> \documentclass{article}
>>
>> \usepackage{minted}
>>
>> \begin{document}
>>
>> \begin{minted}{latex}
>>    a-'
>> \end{minted}
>>
>> \end{document}
>> --------------------snip--------------------
>>
>> Remarks:
>> --------
>>
>> 1. The error message I get:
>> (./_minted-test/C1B3C74AA35F87A14838FF588F40D6B6715769D21B52E45A
>> A7CE8C545C6279BA.pygtexlualatex:
>> ../../../texk/web2c/luatexdir/lang/texlang.c:986: hnj_hyphenation:
>> Assertion `(((varmem[(wordstart)].hh.u.B1) & (1 << 0)) &&
>> !((varmem[(wordstart)].hh.u.B1) & (1 << 1) ) &&
>> !((varmem[(wordstart)].hh.u.B1) & (1 << 2) ))' failed.
>>
>> 2. If I remove the straight single quotation mark so as to write a-
>>    instead of a-' it passes.
>>
>> 3. xelatex and pdflatex work on this file.
>>
>> 4. I tried lualatex-dev --shell-escape but no avail.
>>
>> Any ideas would be much appreciated!
>>
>> Best,
>>
>> Robert
>>
>>
> It's the same problem as in
> Assertion from texlang.c with reproducible example
> <https://tug.org/pipermail/luatex/2020-November/007424.html>
>
> ( the hyphenation expects a simple word, but
> the word doesn't start with a character.)
> For the moment I will make a better error message.
>
>
> --
> luigi
>


ah so a workaround for the OP would be to hide the quote in a box so
hyphenation is back in more normal territory

\documentclass{article}

\usepackage{minted}

\begingroup
\makeatletter
\catcode`\'=\active
\gdef\minted at patch@PYGZsq at i{\gdef\PYGZsq{\mbox{'}}}
\endgroup

\begin{document}

\begin{minted}{latex}
   a-'
\end{minted}

\end{document}

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201107/76f4e299/attachment.html>

From alessi at robertalessi.net  Sun Nov  8 10:59:18 2020
From: alessi at robertalessi.net (Robert Alessi)
Date: Sun, 8 Nov 2020 10:59:18 +0100
Subject: [luatex] luatex and minted
In-Reply-To: <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>
References: <20201107183937.GA18505@robertalessi.net>
 <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
 <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>
Message-ID: <20201108095918.GA9048@robertalessi.net>

Thank you both.  I didn't pay attention to Scott's previous post,
sorry about that.

On Sat, Nov 07, 2020 at 11:47:39PM +0000, David Carlisle wrote:
> On Sat, 7 Nov 2020 at 23:10, luigi scarso <luigi.scarso at gmail.com> wrote:
> 

[...]

> >>
> > It's the same problem as in
> > Assertion from texlang.c with reproducible example
> > <https://tug.org/pipermail/luatex/2020-November/007424.html>
> >
> > ( the hyphenation expects a simple word, but
> > the word doesn't start with a character.)
> > For the moment I will make a better error message.

I now think it is clear enough ;)

> > luigi
> 
> 
> ah so a workaround for the OP would be to hide the quote in a box so
> hyphenation is back in more normal territory
> 
> \documentclass{article}
> 
> \usepackage{minted}
> 
> \begingroup
> \makeatletter
> \catcode`\'=\active
> \gdef\minted at patch@PYGZsq at i{\gdef\PYGZsq{\mbox{'}}}
> \endgroup
> 
> \begin{document}
> 
> \begin{minted}{latex}
>    a-'
> \end{minted}
> 
> \end{document}

This works, thank you!  Unfortunately, the following fails for the
same reason (namely ` instead of '):

---------------snip---------------
\documentclass{article}

\usepackage{minted}

\begingroup
\makeatletter
\catcode`\'=\active
\gdef\minted at patch@PYGZsq at i{\gdef\PYGZsq{\mbox{'}}}
\endgroup

\begin{document}

\begin{minted}{latex}
   a-`
\end{minted}

\end{document}
---------------snip---------------

Another way would be to have the hyphen itself inserted in a box, like
so: \def\PYGZhy{\mbox{\char`\-}}

This work, but unfortunately \PYGZhy is only defined in the
'default-pyg-prefix.pygstyle' file that is generated inside minted
output dir.  However, as this file is untouched if it exists, one can
modify this file after the first run.

Or this may boils down to inserting this in the preamble:

---------------snip---------------
\usepackage{etoolbox}
\usepackage{minted}
\makeatletter
\patchcmd{\minted at checkstyle}{\minted at input{%
          \minted at outputdir\minted at cachedir/\ifstrempty{#1}{default-pyg-prefix}{#1}.pygstyle}%
      }{\minted at input{%
          \minted at outputdir\minted at cachedir/\ifstrempty{#1}{default-pyg-prefix}{#1}.pygstyle}%
        \def\PYGZhy{\mbox{\char`\-}}}{}{}
\makeatother
---------------snip---------------

Thanks again!

Robert

> David

From alessi at robertalessi.net  Sun Nov  8 11:06:02 2020
From: alessi at robertalessi.net (Robert Alessi)
Date: Sun, 8 Nov 2020 11:06:02 +0100
Subject: [luatex] luatex and minted
In-Reply-To: <20201108095918.GA9048@robertalessi.net>
References: <20201107183937.GA18505@robertalessi.net>
 <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
 <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>
 <20201108095918.GA9048@robertalessi.net>
Message-ID: <20201108100602.GB9048@robertalessi.net>

This has nothing to do with luatex/minted, but anyway please read
"this workS" and "this may boil down to" below...

R.

On Sun, Nov 08, 2020 at 10:59:18AM +0100, Robert Alessi wrote:
> Thank you both.  I didn't pay attention to Scott's previous post,
> sorry about that.
> 
> On Sat, Nov 07, 2020 at 11:47:39PM +0000, David Carlisle wrote:
> > On Sat, 7 Nov 2020 at 23:10, luigi scarso <luigi.scarso at gmail.com> wrote:
> > 
> 
> [...]
> 
> > >>
> > > It's the same problem as in
> > > Assertion from texlang.c with reproducible example
> > > <https://tug.org/pipermail/luatex/2020-November/007424.html>
> > >
> > > ( the hyphenation expects a simple word, but
> > > the word doesn't start with a character.)
> > > For the moment I will make a better error message.
> 
> I now think it is clear enough ;)
> 
> > > luigi
> > 
> > 
> > ah so a workaround for the OP would be to hide the quote in a box so
> > hyphenation is back in more normal territory
> > 
> > \documentclass{article}
> > 
> > \usepackage{minted}
> > 
> > \begingroup
> > \makeatletter
> > \catcode`\'=\active
> > \gdef\minted at patch@PYGZsq at i{\gdef\PYGZsq{\mbox{'}}}
> > \endgroup
> > 
> > \begin{document}
> > 
> > \begin{minted}{latex}
> >    a-'
> > \end{minted}
> > 
> > \end{document}
> 
> This works, thank you!  Unfortunately, the following fails for the
> same reason (namely ` instead of '):
> 
> ---------------snip---------------
> \documentclass{article}
> 
> \usepackage{minted}
> 
> \begingroup
> \makeatletter
> \catcode`\'=\active
> \gdef\minted at patch@PYGZsq at i{\gdef\PYGZsq{\mbox{'}}}
> \endgroup
> 
> \begin{document}
> 
> \begin{minted}{latex}
>    a-`
> \end{minted}
> 
> \end{document}
> ---------------snip---------------
> 
> Another way would be to have the hyphen itself inserted in a box, like
> so: \def\PYGZhy{\mbox{\char`\-}}
> 
> This work, but unfortunately \PYGZhy is only defined in the
> 'default-pyg-prefix.pygstyle' file that is generated inside minted
> output dir.  However, as this file is untouched if it exists, one can
> modify this file after the first run.
> 
> Or this may boils down to inserting this in the preamble:
> 
> ---------------snip---------------
> \usepackage{etoolbox}
> \usepackage{minted}
> \makeatletter
> \patchcmd{\minted at checkstyle}{\minted at input{%
>           \minted at outputdir\minted at cachedir/\ifstrempty{#1}{default-pyg-prefix}{#1}.pygstyle}%
>       }{\minted at input{%
>           \minted at outputdir\minted at cachedir/\ifstrempty{#1}{default-pyg-prefix}{#1}.pygstyle}%
>         \def\PYGZhy{\mbox{\char`\-}}}{}{}
> \makeatother
> ---------------snip---------------
> 
> Thanks again!
> 
> Robert
> 
> > David

From luigi.scarso at gmail.com  Sun Nov  8 11:26:51 2020
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sun, 8 Nov 2020 11:26:51 +0100
Subject: [luatex] luatex and minted
In-Reply-To: <20201108095918.GA9048@robertalessi.net>
References: <20201107183937.GA18505@robertalessi.net>
 <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
 <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>
 <20201108095918.GA9048@robertalessi.net>
Message-ID: <CAG5iGsC8n5WtEJ1=BoUJPaBmFPLA+G+b7DOoMxks=S1v-CPkTQ@mail.gmail.com>

On Sun, Nov 8, 2020 at 11:00 AM Robert Alessi <alessi at robertalessi.net>
wrote:

>
> This works, thank you!  Unfortunately, the following fails for the
> same reason (namely ` instead of '):
>

Indeed, this is the reason why  it's still unclear if it's a lualatex issue
or a luatex ( as in tl2020 ) issue.
In luatex the code that raised the assert didn't change, but it's not
enough to exclude wrong behaviour.

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201108/3d953921/attachment-0001.html>

From d.p.carlisle at gmail.com  Mon Nov  9 09:44:53 2020
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 9 Nov 2020 08:44:53 +0000
Subject: [luatex] luatex and minted
In-Reply-To: <CAG5iGsC8n5WtEJ1=BoUJPaBmFPLA+G+b7DOoMxks=S1v-CPkTQ@mail.gmail.com>
References: <20201107183937.GA18505@robertalessi.net>
 <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
 <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>
 <20201108095918.GA9048@robertalessi.net>
 <CAG5iGsC8n5WtEJ1=BoUJPaBmFPLA+G+b7DOoMxks=S1v-CPkTQ@mail.gmail.com>
Message-ID: <CAEW6iOiawNfbUMUonWPX1Cm_HgasbqLYH0YPNHdWU0uTcJMskw@mail.gmail.com>

On Sun, 8 Nov 2020 at 10:27, luigi scarso <luigi.scarso at gmail.com> wrote:

>
>
> On Sun, Nov 8, 2020 at 11:00 AM Robert Alessi <alessi at robertalessi.net>
> wrote:
>
>>
>> This works, thank you!  Unfortunately, the following fails for the
>> same reason (namely ` instead of '):
>>
>
> Indeed, this is the reason why  it's still unclear if it's a lualatex
> issue or a luatex ( as in tl2020 ) issue.
> In luatex the code that raised the assert didn't change, but it's not
> enough to exclude wrong behaviour.
>
> --
> luigi
>

Luigi, shouldn't on the face of it an assert always be considered an issue
in the code raising the assert?
Marcel helped narrow this down to a plain tex example


\setbox0\hbox{"}
X-\unhbox0
\bye



which produces

This is LuaTeX, Version 1.12.0 (TeX Live 2020)
 restricted system commands enabled.
(./as.texassertion "is_simple_character(wordstart)" failed: file
"../../../texk/
web2c/luatexdir/lang/texlang.c", line 986, function: hnj_hyphenation
Aborted (core dumped)

I get the same in luatex 1.11.2  but it works in luatex 1.07.0

David


So I think it is definitely a luatex issue not in the tex or Lua code here.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201109/d7ffa64d/attachment.html>

From luigi.scarso at gmail.com  Mon Nov  9 10:10:53 2020
From: luigi.scarso at gmail.com (luigi scarso)
Date: Mon, 9 Nov 2020 10:10:53 +0100
Subject: [luatex] luatex and minted
In-Reply-To: <CAEW6iOiawNfbUMUonWPX1Cm_HgasbqLYH0YPNHdWU0uTcJMskw@mail.gmail.com>
References: <20201107183937.GA18505@robertalessi.net>
 <CAG5iGsBNgQ6mp8=nbwGGb3DAsef4Uz=67FLSnRzFcihfAQTspw@mail.gmail.com>
 <CAEW6iOgxZW7MW5-F2ERgLrkLD791amJ6cT02+inu2E2hREQ2rA@mail.gmail.com>
 <20201108095918.GA9048@robertalessi.net>
 <CAG5iGsC8n5WtEJ1=BoUJPaBmFPLA+G+b7DOoMxks=S1v-CPkTQ@mail.gmail.com>
 <CAEW6iOiawNfbUMUonWPX1Cm_HgasbqLYH0YPNHdWU0uTcJMskw@mail.gmail.com>
Message-ID: <CAG5iGsDWk8VZJ+hGMLdNG_X=1YD-U1-MPOmvqH5HcdBhPAnBdQ@mail.gmail.com>

On Mon, Nov 9, 2020 at 9:45 AM David Carlisle <d.p.carlisle at gmail.com>
wrote:

>
> Luigi, shouldn't on the face of it an assert always be considered an issue
> in the code raising the assert?
>
>
Sure, but there are several ways to consider an assert.
In luatex we tend to use it to mark a condition that should be discussed
(as we are doing now)
and finally removed,  i.e. replaced by an error  or  solved by a fix.
The part of the code is the same in 1.10 and 1.12 but
[luatex] Assertion from texlang.c with reproducible example
is ok with 1.10
while now we know the plain luatex fails in both cases.



-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201109/d6ef6303/attachment.html>

From mail at md.sy.gs  Thu Nov 26 09:43:23 2020
From: mail at md.sy.gs (Matthias Deeg)
Date: Thu, 26 Nov 2020 09:43:23 +0100
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
	correctly
Message-ID: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>

Hello everybody,

yesterday, I've stumbled upon the issue that lualatex or respectively
luahbtex cannot correctly process paths containing a tilde (~) which
results in not finding the given TeX file.

I have initially found this issue on a Windows system where short
Windows paths (8.3 format) containing ~ where used (e.g.
C:\Users\TEST_B~1\AppData\Local\Temp\report\report.tex).

This issue also occurs on Linux systems, as the following two examples
illustrate.

$ lualatex "/home/matt/reports/test~report/report.tex"
This is LuaHBTeX, Version 1.12.0 (TeX Live 2020/Arch Linux)
 restricted system commands enabled.
! I can't find file `/home/matt/reports/test'.
<to be read again>
\protect
<*> /home/matt/reports/test~
                         report/report.tex
(Press Enter to retry, or Control-D to exit)
Please type another input file name:


$ lualatex /home/matt/reports/test\~report/report.tex



This is LuaHBTeX, Version 1.12.0 (TeX Live 2020/Arch Linux)
 restricted system commands enabled.
! I can't find file `/home/matt/reports/test'.
<to be read again>
\protect
<*> /home/matt/reports/test~
                         report/report.tex
(Press Enter to retry, or Control-D to exit)
Please type another input file name:

From P.Taylor at Hellenic-Institute.Uk  Thu Nov 26 11:23:48 2020
From: P.Taylor at Hellenic-Institute.Uk (Philip Taylor)
Date: Thu, 26 Nov 2020 10:23:48 +0000
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
 correctly
In-Reply-To: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
Message-ID: <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>

Would one not expect that, Matthias ? The tilde is a reserved (active) 
character in TeX.
Philip Taylor
--------
Matthias Deeg wrote:
> Hello everybody,
>
> yesterday, I've stumbled upon the issue that lualatex or respectively
> luahbtex cannot correctly process paths containing a tilde (~) which
> results in not finding the given TeX file.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201126/5cc880bc/attachment.html>

From mail at md.sy.gs  Thu Nov 26 11:46:16 2020
From: mail at md.sy.gs (Matthias Deeg)
Date: Thu, 26 Nov 2020 11:46:16 +0100
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
 correctly
In-Reply-To: <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
 <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>
Message-ID: <12a3f215-82eb-6f92-0f32-c7d60c7f5709@md.sy.gs>

Hello Philip,

I did not expect that the command line argument TEXNAME is interpreted
as TeX, but simply as a path within the used file system (e.g. NTFS or
ext4) where ~ is valid character.

So what I have expected was lualatex opening, reading, and processing
the file provided via the TEXNAME argument. Thus, there shouldn't be a
different behavior concerning the following two commands using different
paths:

lualatex "/home/matt/reports/test~report/report.tex"

lualatex "/home/matt/reports/test-report/report.tex"


On 26.11.20 11:23, Philip Taylor wrote:
> Would one not expect that, Matthias ?? The tilde is a reserved (active)
> character in TeX.
> Philip Taylor
> --------
> Matthias Deeg wrote:
>> Hello everybody,
>>
>> yesterday, I've stumbled upon the issue that lualatex or respectively
>> luahbtex cannot correctly process paths containing a tilde (~) which
>> results in not finding the given TeX file.
> 

From luatex at nililand.de  Thu Nov 26 12:01:46 2020
From: luatex at nililand.de (Ulrike Fischer)
Date: Thu, 26 Nov 2020 12:01:46 +0100
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
	correctly
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
 <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>
 <12a3f215-82eb-6f92-0f32-c7d60c7f5709@md.sy.gs>
Message-ID: <11bf1p4dhdhyd$.dlg@nililand.de>

Am Thu, 26 Nov 2020 11:46:16 +0100 schrieb Matthias Deeg:

> I did not expect that the command line argument TEXNAME is interpreted
> as TeX,

But it is. If you would use a command 

lualatex \mycommand/report.tex

you would get an error about the unknown command. 

Which is the reason why on windows you have to use / in pathes
everywhere when using tex. 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From P.Taylor at Hellenic-Institute.Uk  Thu Nov 26 12:02:06 2020
From: P.Taylor at Hellenic-Institute.Uk (Philip Taylor)
Date: Thu, 26 Nov 2020 11:02:06 +0000
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
 correctly
In-Reply-To: <12a3f215-82eb-6f92-0f32-c7d60c7f5709@md.sy.gs>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
 <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>
 <12a3f215-82eb-6f92-0f32-c7d60c7f5709@md.sy.gs>
Message-ID: <d8e09de2-788e-3e49-2a44-84d8645dfba9@Hellenic-Institute.Uk>

Now I am confused, Matthias ? where does "TEXNAME" come into it ?? In 
your example, there was no instance of "TEXNAME" but rather a direct use 
of the tilde :
> $ lualatex "/home/matt/reports/test~report/report.tex"
Are you now saying that that was not the actual test, but that what you 
actually wrote was :

> $ lualatex TEXNAME

where "TEXNAME" was an logical name, environment variable, or similar ?

Anyhow, regardless of whether or not the tilde was explicit or implicit, 
it will be processed by TeX, and will therefore be subject to expansion.
Consider this from another perspective ? if you were to write :

> $ tex \expandafter \def \csname my:file\endcsname {Source.tex}\input 
> \csname my:file\endcsname

you would expect TeX to try to open a file "Source.tex", would you not 
?? And indeed it does :

> This is TeX, Version 3.14159265 (TeX Live 2020/W32TeX) (preloaded 
> format=tex)
>
> *\end
> ! I can't find file `Source.tex'.
> <to be read again>
> ?????????????????? \end
> <*> \end
>
> (Press Enter to retry, or Control-Z to exit)
> Please type another input file name:

Thus /everything/ that follows the imperative "tex" at the command 
prompt is interpreted as TeX source, and is not interpreted specially 
just because it /might/ be a file name.

/Philip Taylor/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201126/f5fdbb85/attachment.html>

From d.p.carlisle at gmail.com  Thu Nov 26 12:11:51 2020
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Thu, 26 Nov 2020 11:11:51 +0000
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
	correctly
In-Reply-To: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
Message-ID: <CAEW6iOi4o7SqOvngUw+Y=FDxkCUL27sZ_zfeO1t-2g75+iZNcw@mail.gmail.com>

You need to stop ~ expanding to non-breaking space so this works


 lualatex 'test\string~report'
This is LuaHBTeX, Version 1.12.0 (TeX Live 2020)
 restricted system commands enabled.
(./test~report.tex
LaTeX2e <2020-10-01> patch level 2


the single quotes here are bash syntax on the command line, in other
command lines you may need to protect the \ in \string in other ways.

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201126/5f102e8b/attachment.html>

From mail at md.sy.gs  Thu Nov 26 12:28:57 2020
From: mail at md.sy.gs (Matthias Deeg)
Date: Thu, 26 Nov 2020 12:28:57 +0100
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
 correctly
In-Reply-To: <d8e09de2-788e-3e49-2a44-84d8645dfba9@Hellenic-Institute.Uk>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
 <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>
 <12a3f215-82eb-6f92-0f32-c7d60c7f5709@md.sy.gs>
 <d8e09de2-788e-3e49-2a44-84d8645dfba9@Hellenic-Institute.Uk>
Message-ID: <7117963a-2ec6-4f30-a57b-2bc30580eb17@md.sy.gs>

TEXNAME comes from the lualatex or luahbtex help and had in my examples
the following values:

"/home/matt/reports/test~report/report.tex"
"/home/matt/reports/test-report/report.tex"

The beginning of the lualatex help text on my system is as follows:

$ lualatex --help
Usage: luahbtex --lua=FILE [OPTION]... [TEXNAME[.tex]] [COMMANDS]
   or: luahbtex --lua=FILE [OPTION]... \FIRST-LINE
   or: luahbtex --lua=FILE [OPTION]... &FMT ARGS
  Run LuaHBTeX on TEXNAME, usually creating TEXNAME.pdf.
  Any remaining COMMANDS are processed as luatex input, after TEXNAME is
read.

  Alternatively, if the first non-option argument begins with a backslash,
  luahbtex interprets all non-option arguments as an input line.

  Alternatively, if the first non-option argument begins with a &, the
  next word is taken as the FMT to read, overriding all else.  Any
  remaining arguments are processed as above.

  If no arguments or options are specified, prompt for input.
(...)


Maybe I'm just understanding the [[TEXNAME[.tex]] part of the help
wrong. And according to the help text, the first non-option argument can
have different meanings. But I don't see why lualatex/luahbtex would try
to interpret a path argument (TEXNAME) as valid TeX code. I expect
lualatex/luahbtex to interpret the file content of the provided TeX file
as TeX when the TEXNAME argument is actually an existing file in the
file system.


On 26.11.20 12:02, Philip Taylor wrote:
> Now I am confused, Matthias ? where does "TEXNAME" come into it ?? In
> your example, there was no instance of "TEXNAME" but rather a direct use
> of the tilde :
>> $ lualatex "/home/matt/reports/test~report/report.tex"
> Are you now saying that that was not the actual test, but that what you
> actually wrote was :
> 
>> $ lualatex TEXNAME
> 
> where "TEXNAME" was an logical name, environment variable, or similar ?
> 
> Anyhow, regardless of whether or not the tilde was explicit or implicit,
> it will be processed by TeX, and will therefore be subject to expansion.?
> Consider this from another perspective ? if you were to write :
> 
>> $ tex \expandafter \def \csname my:file\endcsname {Source.tex}\input
>> \csname my:file\endcsname
> 
> you would expect TeX to try to open a file "Source.tex", would you not
> ?? And indeed it does :
> 
>> This is TeX, Version 3.14159265 (TeX Live 2020/W32TeX) (preloaded
>> format=tex)
>>
>> *\end
>> ! I can't find file `Source.tex'.
>> <to be read again>
>> ?????????????????? \end
>> <*> \end
>>
>> (Press Enter to retry, or Control-Z to exit)
>> Please type another input file name:
> 
> Thus /everything/ that follows the imperative "tex" at the command
> prompt is interpreted as TeX source, and is not interpreted specially
> just because it /might/ be a file name.
> 
> /Philip Taylor/

From P.Taylor at Hellenic-Institute.Uk  Thu Nov 26 12:45:00 2020
From: P.Taylor at Hellenic-Institute.Uk (Philip Taylor)
Date: Thu, 26 Nov 2020 11:45:00 +0000
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
 correctly
In-Reply-To: <7117963a-2ec6-4f30-a57b-2bc30580eb17@md.sy.gs>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
 <228d1a22-fa49-e592-ad31-fe7d0838aa60@Hellenic-Institute.Uk>
 <12a3f215-82eb-6f92-0f32-c7d60c7f5709@md.sy.gs>
 <d8e09de2-788e-3e49-2a44-84d8645dfba9@Hellenic-Institute.Uk>
 <7117963a-2ec6-4f30-a57b-2bc30580eb17@md.sy.gs>
Message-ID: <2b236102-16b4-3474-3e17-86c0e199b698@Hellenic-Institute.Uk>

Matthias Deeg wrote:
> TEXNAME comes from the lualatex or luahbtex help and had in my examples
> the following values:
>
> The beginning of the lualatex help text on my system is as follows:
>
> $ lualatex --help
> Usage: luahbtex --lua=FILE [OPTION]... [TEXNAME[.tex]] [COMMANDS]
>     or: luahbtex --lua=FILE [OPTION]... \FIRST-LINE
>     or: luahbtex --lua=FILE [OPTION]... &FMT ARGS
>    Run LuaHBTeX on TEXNAME, usually creating TEXNAME.pdf.
>    Any remaining COMMANDS are processed as luatex input, after TEXNAME is
> read.
>
>    Alternatively, if the first non-option argument begins with a backslash,
>    luahbtex interprets all non-option arguments as an input line.
>
>    Alternatively, if the first non-option argument begins with a &, the
>    next word is taken as the FMT to read, overriding all else.  Any
>    remaining arguments are processed as above.
>
>    If no arguments or options are specified, prompt for input.
> (...)
>
Then I would suggest that either the help text is inaccurate or the 
implementation is non-compliant, depending on which one regards as 
authoritative.? [TEXNAME[.tex]] is in no way treated specially ? if it 
includes anything other than \catcode {letter|other} characters, they 
will be interpreted by TeX just as if they were in a TeX source file.

Philip Taylor
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201126/96c18563/attachment.html>

From luigi.scarso at gmail.com  Thu Nov 26 13:36:03 2020
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 26 Nov 2020 13:36:03 +0100
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
	correctly
In-Reply-To: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
Message-ID: <CAG5iGsB8xVzrYx4bTdr5xZ8k=34p_hbc_XXwYdzqE+wviYgmSw@mail.gmail.com>

On Thu, Nov 26, 2020 at 11:22 AM Matthias Deeg <mail at md.sy.gs> wrote:

> Hello everybody,
>
> yesterday, I've stumbled upon the issue that lualatex or respectively
> luahbtex cannot correctly process paths containing a tilde (~) which
> results in not finding the given TeX file.
>
>
Can you test with tex, pdftex and xetex ?


-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201126/11404394/attachment.html>

From d.p.carlisle at gmail.com  Thu Nov 26 13:46:51 2020
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Thu, 26 Nov 2020 12:46:51 +0000
Subject: [luatex] lualatex cannot process paths containing a tilde (~)
	correctly
In-Reply-To: <CAG5iGsB8xVzrYx4bTdr5xZ8k=34p_hbc_XXwYdzqE+wviYgmSw@mail.gmail.com>
References: <4ffdcfe7-b853-cbae-a7b1-819f25052ee3@md.sy.gs>
 <CAG5iGsB8xVzrYx4bTdr5xZ8k=34p_hbc_XXwYdzqE+wviYgmSw@mail.gmail.com>
Message-ID: <CAEW6iOiiF4+KC-3fnTOoE7t_7R8US_zkDBuhV3DA9a3qZ_Gahw@mail.gmail.com>

On Thu, 26 Nov 2020 at 12:36, luigi scarso <luigi.scarso at gmail.com> wrote:

>
>
> On Thu, Nov 26, 2020 at 11:22 AM Matthias Deeg <mail at md.sy.gs> wrote:
>
>> Hello everybody,
>>
>> yesterday, I've stumbled upon the issue that lualatex or respectively
>> luahbtex cannot correctly process paths containing a tilde (~) which
>> results in not finding the given TeX file.
>>
>>
> Can you test with tex, pdftex and xetex ?
>

they all work the same way here.  ~ is expanded to whatever definition it
has in the format unless you use \string or \detokenize or whatever.


>
> --
> luigi
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://tug.org/pipermail/luatex/attachments/20201126/72355975/attachment-0001.html>

