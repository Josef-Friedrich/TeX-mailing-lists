From rpspringuel at gmail.com  Mon May  2 21:42:20 2016
From: rpspringuel at gmail.com (Br. Samuel Springuel)
Date: Mon, 2 May 2016 15:42:20 -0400
Subject: [luatex] TexLive 2016 Pretest Bug: Paper
Message-ID: <ee6dcd21-3c5f-8425-7d19-5d18115c167d@gmail.com>

When using the TeXLive 2016 Pretest, the geometry package does not 
appear to be able to change the paper size when using the LuaLaTeX 
engine.  The failure is silent (no error or warning).

For instance, if the default paper size is set to letter (as it is on my 
system), then the following document will come out on letter paper:

\documentclass{article}

\usepackage{geometry}
\geometry{a4paper}

\listfiles

\begin{document}
Test
\end{document}

Test system is Linux Ubuntu 14.04.

My guess is that this has to do with the backend changes in LuaTeX 0.85.

Log file from compiling above document:
> This is LuaTeX, Version 0.95.0 (TeX Live 2016)  (format=lualatex 2016.5.2)  2 MAY 2016 15:40
>  restricted system commands enabled.
> **debugging.tex
> (./debugging.tex
> LaTeX2e <2016/03/31>
> Babel <3.9r> and hyphenation patterns for 1 language(s) loaded.
> (/usr/local/texlive/2016/texmf-dist/tex/latex/base/article.cls
> Document Class: article 2014/09/29 v1.4h Standard LaTeX document class
> (/usr/local/texlive/2016/texmf-dist/tex/latex/base/size10.clo
> File: size10.clo 2014/09/29 v1.4h Standard LaTeX file (size option)
> )
> \c at part=\count79
> \c at section=\count80
> \c at subsection=\count81
> \c at subsubsection=\count82
> \c at paragraph=\count83
> \c at subparagraph=\count84
> \c at figure=\count85
> \c at table=\count86
> \abovecaptionskip=\skip41
> \belowcaptionskip=\skip42
> \bibindent=\dimen102
> )
> (/usr/local/texlive/2016/texmf-dist/tex/latex/geometry/geometry.sty
> Package: geometry 2010/09/12 v5.6 Page Geometry
>
> (/usr/local/texlive/2016/texmf-dist/tex/latex/graphics/keyval.sty
> Package: keyval 2014/10/28 v1.15 key=value parser (DPC)
> \KV at toks@=\toks14
> )
> (/usr/local/texlive/2016/texmf-dist/tex/generic/ifpdf/ifpdf.sty
> Package: ifpdf 2016/04/04 v3.0 Provides the ifpdf switch
> )
> (/usr/local/texlive/2016/texmf-dist/tex/generic/oberdiek/ifvtex.sty
> Package: ifvtex 2010/03/01 v1.5 Detect VTeX and its facilities (HO)
> Package ifvtex Info: VTeX not detected.
> )
> (/usr/local/texlive/2016/texmf-dist/tex/generic/ifxetex/ifxetex.sty
> Package: ifxetex 2010/09/12 v0.6 Provides ifxetex conditional
> )
> \Gm at cnth=\count87
> \Gm at cntv=\count88
> \c at Gm@tempcnt=\count89
> \Gm at bindingoffset=\dimen103
> \Gm at wd@mp=\dimen104
> \Gm at odd@mp=\dimen105
> \Gm at even@mp=\dimen106
> \Gm at layoutwidth=\dimen107
> \Gm at layoutheight=\dimen108
> \Gm at layouthoffset=\dimen109
> \Gm at layoutvoffset=\dimen110
> \Gm at dimlist=\toks15
> )
> (./debugging.aux)
> \openout1 = debugging.aux
>
> LaTeX Font Info:    Checking defaults for OML/cmm/m/it on input line 8.
> LaTeX Font Info:    ... okay on input line 8.
> LaTeX Font Info:    Checking defaults for T1/cmr/m/n on input line 8.
> LaTeX Font Info:    ... okay on input line 8.
> LaTeX Font Info:    Checking defaults for OT1/cmr/m/n on input line 8.
> LaTeX Font Info:    ... okay on input line 8.
> LaTeX Font Info:    Checking defaults for OMS/cmsy/m/n on input line 8.
> LaTeX Font Info:    ... okay on input line 8.
> LaTeX Font Info:    Checking defaults for OMX/cmex/m/n on input line 8.
> LaTeX Font Info:    ... okay on input line 8.
> LaTeX Font Info:    Checking defaults for U/cmr/m/n on input line 8.
> LaTeX Font Info:    ... okay on input line 8.
>
> *geometry* driver: auto-detecting
> *geometry* detected driver: pdftex
> *geometry* verbose mode - [ preamble ] result:
> * driver: pdftex
> * paper: a4paper
> * layout: <same size as paper>
> * layoutoffset:(h,v)=(0.0pt,0.0pt)
> * modes:
> * h-part:(L,W,R)=(89.62709pt, 418.25368pt, 89.6271pt)
> * v-part:(T,H,B)=(101.40665pt, 591.5302pt, 152.11pt)
> * \paperwidth=597.50787pt
> * \paperheight=845.04684pt
> * \textwidth=418.25368pt
> * \textheight=591.5302pt
> * \oddsidemargin=17.3571pt
> * \evensidemargin=17.3571pt
> * \topmargin=-7.86334pt
> * \headheight=12.0pt
> * \headsep=25.0pt
> * \topskip=10.0pt
> * \footskip=30.0pt
> * \marginparwidth=65.0pt
> * \marginparsep=11.0pt
> * \columnsep=10.0pt
> * \skip\footins=9.0pt plus 4.0pt minus 2.0pt
> * \hoffset=0.0pt
> * \voffset=0.0pt
> * \mag=1000
> * \@twocolumnfalse
> * \@twosidefalse
> * \@mparswitchfalse
> * \@reversemarginfalse
> * (1in=72.27pt=25.4mm, 1cm=28.453pt)
>
> [1
>
> {/usr/local/texlive/2016/texmf-var/fonts/map/pdftex/updmap/pdftex.map}]
> (./debugging.aux)
>
>  *File List*
>  article.cls    2014/09/29 v1.4h Standard LaTeX document class
>   size10.clo    2014/09/29 v1.4h Standard LaTeX file (size option)
> geometry.sty    2010/09/12 v5.6 Page Geometry
>   keyval.sty    2014/10/28 v1.15 key=value parser (DPC)
>    ifpdf.sty    2016/04/04 v3.0 Provides the ifpdf switch
>   ifvtex.sty    2010/03/01 v1.5 Detect VTeX and its facilities (HO)
>  ifxetex.sty    2010/09/12 v0.6 Provides ifxetex conditional
>  ***********
>
> )
>
> Here is how much of LuaTeX's memory you used:
>  753 strings out of 495119
>  100000,89155 words of node,token memory allocated
>  346 words of node memory still in use:
>    2 hlist, 1 vlist, 1 rule, 7 glue, 39 glue_spec, 1 write nodes
>    avail lists: 2:12,3:3,4:1,5:11,6:6,7:22,8:1,9:6
>  4351 multiletter control sequences out of 65536+600000
>  15 fonts using 632831 bytes
>  23i,4n,23p,131b,121s stack positions out of 5000i,500n,10000p,200000b,100000s
> </usr/local/texlive/2016/texmf-dist/fonts/type1/public/amsfonts/cm/cmr10.pfb>
> Output written on debugging.pdf (1 page, 10593 bytes).
>
> PDF statistics: 12 PDF objects out of 1000 (max. 8388607)
>  7 compressed objects within 1 object stream
>  0 named destinations out of 1000 (max. 131072)
>  1 words of extra memory for PDF output out of 10000 (max. 10000000)

-- 
?????????????????????????
Br. Samuel, OSB
St. Anselm?s Abbey
Washington, DC
(R. Padraic Springuel)

PAX ? ???????

From d.p.carlisle at gmail.com  Mon May  2 23:37:32 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 2 May 2016 22:37:32 +0100
Subject: [luatex] TexLive 2016 Pretest Bug: Paper
In-Reply-To: <ee6dcd21-3c5f-8425-7d19-5d18115c167d@gmail.com>
References: <ee6dcd21-3c5f-8425-7d19-5d18115c167d@gmail.com>
Message-ID: <CAEW6iOjri-tz-W8urq=6Bj361tSE_OEbJ5514OA1s7KZZJp7Zg@mail.gmail.com>

This has been reported and and update is promised.

As with most luatex based packages broken by the new luatex you can add

\RequirePackage{luatex85}

to the start of the document until the package is updated.

David


On 2 May 2016 at 20:42, Br. Samuel Springuel <rpspringuel at gmail.com> wrote:
> When using the TeXLive 2016 Pretest, the geometry package does not appear to
> be able to change the paper size when using the LuaLaTeX engine.  The
> failure is silent (no error or warning).
>
> For instance, if the default paper size is set to letter (as it is on my
> system), then the following document will come out on letter paper:
>
> \documentclass{article}
>
> \usepackage{geometry}
> \geometry{a4paper}
>
> \listfiles
>
> \begin{document}
> Test
> \end{document}
>
> Test system is Linux Ubuntu 14.04.
>
> My guess is that this has to do with the backend changes in LuaTeX 0.85.
>
> Log file from compiling above document:
>>
>> This is LuaTeX, Version 0.95.0 (TeX Live 2016)  (format=lualatex 2016.5.2)
>> 2 MAY 2016 15:40
>>  restricted system commands enabled.
>> **debugging.tex
>> (./debugging.tex
>> LaTeX2e <2016/03/31>
>> Babel <3.9r> and hyphenation patterns for 1 language(s) loaded.
>> (/usr/local/texlive/2016/texmf-dist/tex/latex/base/article.cls
>> Document Class: article 2014/09/29 v1.4h Standard LaTeX document class
>> (/usr/local/texlive/2016/texmf-dist/tex/latex/base/size10.clo
>> File: size10.clo 2014/09/29 v1.4h Standard LaTeX file (size option)
>> )
>> \c at part=\count79
>> \c at section=\count80
>> \c at subsection=\count81
>> \c at subsubsection=\count82
>> \c at paragraph=\count83
>> \c at subparagraph=\count84
>> \c at figure=\count85
>> \c at table=\count86
>> \abovecaptionskip=\skip41
>> \belowcaptionskip=\skip42
>> \bibindent=\dimen102
>> )
>> (/usr/local/texlive/2016/texmf-dist/tex/latex/geometry/geometry.sty
>> Package: geometry 2010/09/12 v5.6 Page Geometry
>>
>> (/usr/local/texlive/2016/texmf-dist/tex/latex/graphics/keyval.sty
>> Package: keyval 2014/10/28 v1.15 key=value parser (DPC)
>> \KV at toks@=\toks14
>> )
>> (/usr/local/texlive/2016/texmf-dist/tex/generic/ifpdf/ifpdf.sty
>> Package: ifpdf 2016/04/04 v3.0 Provides the ifpdf switch
>> )
>> (/usr/local/texlive/2016/texmf-dist/tex/generic/oberdiek/ifvtex.sty
>> Package: ifvtex 2010/03/01 v1.5 Detect VTeX and its facilities (HO)
>> Package ifvtex Info: VTeX not detected.
>> )
>> (/usr/local/texlive/2016/texmf-dist/tex/generic/ifxetex/ifxetex.sty
>> Package: ifxetex 2010/09/12 v0.6 Provides ifxetex conditional
>> )
>> \Gm at cnth=\count87
>> \Gm at cntv=\count88
>> \c at Gm@tempcnt=\count89
>> \Gm at bindingoffset=\dimen103
>> \Gm at wd@mp=\dimen104
>> \Gm at odd@mp=\dimen105
>> \Gm at even@mp=\dimen106
>> \Gm at layoutwidth=\dimen107
>> \Gm at layoutheight=\dimen108
>> \Gm at layouthoffset=\dimen109
>> \Gm at layoutvoffset=\dimen110
>> \Gm at dimlist=\toks15
>> )
>> (./debugging.aux)
>> \openout1 = debugging.aux
>>
>> LaTeX Font Info:    Checking defaults for OML/cmm/m/it on input line 8.
>> LaTeX Font Info:    ... okay on input line 8.
>> LaTeX Font Info:    Checking defaults for T1/cmr/m/n on input line 8.
>> LaTeX Font Info:    ... okay on input line 8.
>> LaTeX Font Info:    Checking defaults for OT1/cmr/m/n on input line 8.
>> LaTeX Font Info:    ... okay on input line 8.
>> LaTeX Font Info:    Checking defaults for OMS/cmsy/m/n on input line 8.
>> LaTeX Font Info:    ... okay on input line 8.
>> LaTeX Font Info:    Checking defaults for OMX/cmex/m/n on input line 8.
>> LaTeX Font Info:    ... okay on input line 8.
>> LaTeX Font Info:    Checking defaults for U/cmr/m/n on input line 8.
>> LaTeX Font Info:    ... okay on input line 8.
>>
>> *geometry* driver: auto-detecting
>> *geometry* detected driver: pdftex
>> *geometry* verbose mode - [ preamble ] result:
>> * driver: pdftex
>> * paper: a4paper
>> * layout: <same size as paper>
>> * layoutoffset:(h,v)=(0.0pt,0.0pt)
>> * modes:
>> * h-part:(L,W,R)=(89.62709pt, 418.25368pt, 89.6271pt)
>> * v-part:(T,H,B)=(101.40665pt, 591.5302pt, 152.11pt)
>> * \paperwidth=597.50787pt
>> * \paperheight=845.04684pt
>> * \textwidth=418.25368pt
>> * \textheight=591.5302pt
>> * \oddsidemargin=17.3571pt
>> * \evensidemargin=17.3571pt
>> * \topmargin=-7.86334pt
>> * \headheight=12.0pt
>> * \headsep=25.0pt
>> * \topskip=10.0pt
>> * \footskip=30.0pt
>> * \marginparwidth=65.0pt
>> * \marginparsep=11.0pt
>> * \columnsep=10.0pt
>> * \skip\footins=9.0pt plus 4.0pt minus 2.0pt
>> * \hoffset=0.0pt
>> * \voffset=0.0pt
>> * \mag=1000
>> * \@twocolumnfalse
>> * \@twosidefalse
>> * \@mparswitchfalse
>> * \@reversemarginfalse
>> * (1in=72.27pt=25.4mm, 1cm=28.453pt)
>>
>> [1
>>
>> {/usr/local/texlive/2016/texmf-var/fonts/map/pdftex/updmap/pdftex.map}]
>> (./debugging.aux)
>>
>>  *File List*
>>  article.cls    2014/09/29 v1.4h Standard LaTeX document class
>>   size10.clo    2014/09/29 v1.4h Standard LaTeX file (size option)
>> geometry.sty    2010/09/12 v5.6 Page Geometry
>>   keyval.sty    2014/10/28 v1.15 key=value parser (DPC)
>>    ifpdf.sty    2016/04/04 v3.0 Provides the ifpdf switch
>>   ifvtex.sty    2010/03/01 v1.5 Detect VTeX and its facilities (HO)
>>  ifxetex.sty    2010/09/12 v0.6 Provides ifxetex conditional
>>  ***********
>>
>> )
>>
>> Here is how much of LuaTeX's memory you used:
>>  753 strings out of 495119
>>  100000,89155 words of node,token memory allocated
>>  346 words of node memory still in use:
>>    2 hlist, 1 vlist, 1 rule, 7 glue, 39 glue_spec, 1 write nodes
>>    avail lists: 2:12,3:3,4:1,5:11,6:6,7:22,8:1,9:6
>>  4351 multiletter control sequences out of 65536+600000
>>  15 fonts using 632831 bytes
>>  23i,4n,23p,131b,121s stack positions out of
>> 5000i,500n,10000p,200000b,100000s
>>
>> </usr/local/texlive/2016/texmf-dist/fonts/type1/public/amsfonts/cm/cmr10.pfb>
>> Output written on debugging.pdf (1 page, 10593 bytes).
>>
>> PDF statistics: 12 PDF objects out of 1000 (max. 8388607)
>>  7 compressed objects within 1 object stream
>>  0 named destinations out of 1000 (max. 131072)
>>  1 words of extra memory for PDF output out of 10000 (max. 10000000)
>
>
> --
> ?????????????????????????
> Br. Samuel, OSB
> St. Anselm?s Abbey
> Washington, DC
> (R. Padraic Springuel)
>
> PAX ? ???????



-- 
http://dpcarlisle.blogspot.com/


From rpspringuel at gmail.com  Fri May  6 01:52:45 2016
From: rpspringuel at gmail.com (Br. Samuel Springuel)
Date: Thu, 5 May 2016 19:52:45 -0400
Subject: [luatex] LuaLaTeX 0.95 and xcolor
Message-ID: <8abdacb8-99e9-8b4b-3df9-f670660e10df@gmail.com>

The attached document compiles fine using LuaLaTeX 0.80 (TeXLive 2015), 
but under LuaLaTeX 0.95 (TeXLive 2016) an error is raised by the xcolor 
package stating that `gregoriocolor` is not defined.

Both pdfLaTeX 3.14159265-2.6-1.40.16 (TeX Live 2015) and 
3.14159265-2.6-1.40.17 (TeXLive 2016) compile the document fine.  I have 
reported the error to the author of xcolor, but thought you might also 
like to know about it given that the error requires LuaLaTeX to trigger.
-- 
?????????????????????????
Br. Samuel, OSB
St. Anselm?s Abbey
Washington, DC
(R. Padraic Springuel)

PAX ? ???????
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Main.tex
Type: application/x-tex
Size: 580 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160505/896ba234/attachment.tex>

From d.p.carlisle at gmail.com  Fri May  6 02:06:05 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Fri, 6 May 2016 01:06:05 +0100
Subject: [luatex] LuaLaTeX 0.95 and xcolor
In-Reply-To: <8abdacb8-99e9-8b4b-3df9-f670660e10df@gmail.com>
References: <8abdacb8-99e9-8b4b-3df9-f670660e10df@gmail.com>
Message-ID: <CAEW6iOjFqHikKRqFR62Tu1_2CHnX1hf=JwJhMpfrfCJ=RaJ36Q@mail.gmail.com>

On 6 May 2016 at 00:52, Br. Samuel Springuel <rpspringuel at gmail.com> wrote:
> The attached document compiles fine using LuaLaTeX 0.80 (TeXLive 2015), but
> under LuaLaTeX 0.95 (TeXLive 2016) an error is raised by the xcolor package
> stating that `gregoriocolor` is not defined.
>
> Both pdfLaTeX 3.14159265-2.6-1.40.16 (TeX Live 2015) and
> 3.14159265-2.6-1.40.17 (TeXLive 2016) compile the document fine.  I have
> reported the error to the author of xcolor, but thought you might also like
> to know about it given that the error requires LuaLaTeX to trigger.
> --
> ?????????????????????????
> Br. Samuel, OSB
> St. Anselm?s Abbey
> Washington, DC
> (R. Padraic Springuel)
>
> PAX ? ???????



this has been reported but I'm not sure Uwe Kern is around these days.

Until the package is update for the new luated you can force pdftex
compatibilty  by

\RequirePackage{luatex85}%%%<<<
\documentclass[11pt]{article}

\usepackage[pdftex]{xcolor}%%%<<<


David


From herbs at wideopenwest.com  Fri May  6 19:57:55 2016
From: herbs at wideopenwest.com (Herbert Schulz)
Date: Fri, 6 May 2016 12:57:55 -0500
Subject: [luatex] Lucida Math OT Problems
Message-ID: <4832E91D-9A00-4C85-B8B9-B1D4067882F8@wideopenwest.com>

Howdy,

Enclosed is a section of a sample document that comes with the Lucida Bright OT fonts. The section contains a demo of special properties of the Lucida Math OT fonts (ss01, ss02, ss03, ss04, ss05 and ss20) and seems to hang lualatex.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: LucidaMathOTProperties.tex.zip
Type: application/zip
Size: 1133 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160506/68184ef2/attachment.zip>
-------------- next part --------------


Good Luck,

Herb Schulz
(herbs at wideopenwest dot com)






From frank.mittelbach at latex-project.org  Tue May 10 14:45:51 2016
From: frank.mittelbach at latex-project.org (Frank Mittelbach)
Date: Tue, 10 May 2016 14:45:51 +0200
Subject: [luatex] whatsit generation
Message-ID: <5731D7FF.8090109@latex-project.org>

can somebody help with a (probably) trivial question?

I would like to generate a user-defined whatsit (8,44) with type = table 
(116)

but my idea what "116 a Lua token list in Lua table form" means seems to 
be wrong. I thought something like

   local n = node.new ( 8, 44 )  %-- whatsit subtype = user-defined
   n.user_id  = 5
   n.type  = 116
   n.value = {ht = 100 , dp = 10}

should work, but that doesn't seem to be right, at least n.value.ht is 
"nil" afterwards

thanks
frank




From luatex at nililand.de  Wed May 11 19:26:04 2016
From: luatex at nililand.de (Ulrike Fischer)
Date: Wed, 11 May 2016 19:26:04 +0200
Subject: [luatex] assertion error
Message-ID: <oou9rb0s2a84$.dlg@nililand.de>

With this latex document

\documentclass{article}
\pdfextension mapline{=cmr10 DejaVuSans "T1Encoding ReEncodeFont"
<[tex256.enc <DejaVuSans.ttf}
\begin{document}
blub
\end{document}

I get on windows 7 with luatex (from tl 2016 pretest) 
an error from the 

"Microsoft Visual C++ Runtime library"

The error message says:

Assertion failed!
Program: D:\texlive\2016\bin\win32\luatex.exe
File: utils/avl.c
Line: 744

Expression tree !=NULL

With luatex from TL 2015 (and \pdfmapline) there is no problem. 

I don't really want to use a font like this. I ran into the error
while comparing the output of some fonts. The real error came from
arial.ttf, I replaced it by dejavusans as this is part of texlive.


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From d.p.carlisle at gmail.com  Wed May 11 19:46:25 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Wed, 11 May 2016 18:46:25 +0100
Subject: [luatex] assertion error
In-Reply-To: <oou9rb0s2a84$.dlg@nililand.de>
References: <oou9rb0s2a84$.dlg@nililand.de>
Message-ID: <CAEW6iOh7Oi7bhKmwTDzoh7yc4mZccs5jsYqFurNbiU2j_h=+zw@mail.gmail.com>

On 11 May 2016 at 18:26, Ulrike Fischer <luatex at nililand.de> wrote:
> With this latex document
>
> \documentclass{article}
> \pdfextension mapline{=cmr10 DejaVuSans "T1Encoding ReEncodeFont"
> <[tex256.enc <DejaVuSans.ttf}
> \begin{document}
> blub
> \end{document}
>
> I get on windows 7 with luatex (from tl 2016 pretest)
> an error from the
>
> "Microsoft Visual C++ Runtime library"
>
> The error message says:
>
> Assertion failed!
> Program: D:\texlive\2016\bin\win32\luatex.exe
> File: utils/avl.c
> Line: 744
>
> Expression tree !=NULL
>
> With luatex from TL 2015 (and \pdfmapline) there is no problem.
>
> I don't really want to use a font like this. I ran into the error
> while comparing the output of some fonts. The real error came from
> arial.ttf, I replaced it by dejavusans as this is part of texlive.
>
>
> --
> Ulrike Fischer
> http://www.troubleshooting-tex.de/
>

essentially the same in a cygwin build:

assertion "tree != NULL" failed: file
"../../../texk/web2c/luatexdir/utils/avl.c", line 744, function:
avl_destroy
Aborted (core dumped)

David

From luigi.scarso at gmail.com  Wed May 11 19:54:16 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Wed, 11 May 2016 19:54:16 +0200
Subject: [luatex] assertion error
In-Reply-To: <CAEW6iOh7Oi7bhKmwTDzoh7yc4mZccs5jsYqFurNbiU2j_h=+zw@mail.gmail.com>
References: <oou9rb0s2a84$.dlg@nililand.de>
 <CAEW6iOh7Oi7bhKmwTDzoh7yc4mZccs5jsYqFurNbiU2j_h=+zw@mail.gmail.com>
Message-ID: <CAG5iGsBcYnFw+GxKiE=5y_d8XQ1R+tppFVRoabSh1SddGOaYAQ@mail.gmail.com>

On Wed, May 11, 2016 at 7:46 PM, David Carlisle <d.p.carlisle at gmail.com>
wrote:

> On 11 May 2016 at 18:26, Ulrike Fischer <luatex at nililand.de> wrote:
> > With this latex document
> >
> > \documentclass{article}
> > \pdfextension mapline{=cmr10 DejaVuSans "T1Encoding ReEncodeFont"
> > <[tex256.enc <DejaVuSans.ttf}
> > \begin{document}
> > blub
> > \end{document}
> >
> > I get on windows 7 with luatex (from tl 2016 pretest)
> > an error from the
> >
> > "Microsoft Visual C++ Runtime library"
> >
> > The error message says:
> >
> > Assertion failed!
> > Program: D:\texlive\2016\bin\win32\luatex.exe
> > File: utils/avl.c
> > Line: 744
> >
> > Expression tree !=NULL
> >
> > With luatex from TL 2015 (and \pdfmapline) there is no problem.
> >
> > I don't really want to use a font like this. I ran into the error
> > while comparing the output of some fonts. The real error came from
> > arial.ttf, I replaced it by dejavusans as this is part of texlive.
> >
> >
> > --
> > Ulrike Fischer
> > http://www.troubleshooting-tex.de/
> >
>
> essentially the same in a cygwin build:
>
> assertion "tree != NULL" failed: file
> "../../../texk/web2c/luatexdir/utils/avl.c", line 744, function:
> avl_destroy
> Aborted (core dumped)
>
> David
>
ok, seen it, I have a backtrace of the dump.

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160511/74ab751f/attachment-0001.html>

From pragma at wxs.nl  Wed May 11 23:57:35 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 11 May 2016 23:57:35 +0200
Subject: [luatex] whatsit generation
In-Reply-To: <5731D7FF.8090109@latex-project.org>
References: <5731D7FF.8090109@latex-project.org>
Message-ID: <28983f6c-5d32-50b7-9d38-b50167297709@wxs.nl>

On 5/10/2016 2:45 PM, Frank Mittelbach wrote:
> can somebody help with a (probably) trivial question?
>
> I would like to generate a user-defined whatsit (8,44) with type = table
> (116)
>
> but my idea what "116 a Lua token list in Lua table form" means seems to
> be wrong. I thought something like
>
>   local n = node.new ( 8, 44 )  %-- whatsit subtype = user-defined
>   n.user_id  = 5
>   n.type  = 116
>   n.value = {ht = 100 , dp = 10}
>
> should work, but that doesn't seem to be right, at least n.value.ht is
> "nil" afterwards

in current luatex user defined nodes have subtype 8

116 refers to tables that contain a token list (a table of triplets 
starting with a ref count dummy) which is probably not that useful

as i was sure that at some point we added a lua table type too i checked 
the manual and found out that we don't actually mantion it there

the magic type number is 108

(i'll update the manual)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Thu May 12 00:02:04 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 12 May 2016 00:02:04 +0200
Subject: [luatex] whatsit generation
In-Reply-To: <28983f6c-5d32-50b7-9d38-b50167297709@wxs.nl>
References: <5731D7FF.8090109@latex-project.org>
 <28983f6c-5d32-50b7-9d38-b50167297709@wxs.nl>
Message-ID: <79dcd414-1026-3403-31eb-c47fdaf60fde@wxs.nl>

On 5/11/2016 11:57 PM, Hans Hagen wrote:

> the magic type number is 108

and actually value then can be any lua type (but storing numbers using 
the number subtype is more efficient)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From frank.mittelbach at latex-project.org  Thu May 12 08:26:00 2016
From: frank.mittelbach at latex-project.org (Frank Mittelbach)
Date: Thu, 12 May 2016 08:26:00 +0200
Subject: [luatex] whatsit generation
In-Reply-To: <28983f6c-5d32-50b7-9d38-b50167297709@wxs.nl>
References: <5731D7FF.8090109@latex-project.org>
 <28983f6c-5d32-50b7-9d38-b50167297709@wxs.nl>
Message-ID: <573421F8.6080406@latex-project.org>

Hi Hans

>
> in current luatex user defined nodes have subtype 8

yeah well, as you know my program is currently TL2015 based (ie .085 ) 
for some reason :-)
>
> 116 refers to tables that contain a token list (a table of triplets
> starting with a ref count dummy) which is probably not that useful

yes, looks like it

> as i was sure that at some point we added a lua table type too i checked
> the manual and found out that we don't actually mantion it there
>
> the magic type number is 108

cool, just what I was looking for. I need to pass several values and in 
that case using the number type is not so good, right now I used string 
and decompose afterwards but a table is better

thanks
frank


From pragma at wxs.nl  Thu May 12 10:47:02 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 12 May 2016 10:47:02 +0200
Subject: [luatex] whatsit generation
In-Reply-To: <573421F8.6080406@latex-project.org>
References: <5731D7FF.8090109@latex-project.org>
 <28983f6c-5d32-50b7-9d38-b50167297709@wxs.nl>
 <573421F8.6080406@latex-project.org>
Message-ID: <b7eebbba-4026-d1f3-d1a6-b9776f2f09af@wxs.nl>

Hi,
> cool, just what I was looking for. I need to pass several values and in
> that case using the number type is not so good, right now I used string
> and decompose afterwards but a table is better

off topic:

in that case you could have done:

n.value = "return {ht = 100, wd = 10}"

t = load(n.value)() -- or loadstring depending on lua version

which is quite ok performance wise

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From luigi.scarso at gmail.com  Fri May 13 08:53:28 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Fri, 13 May 2016 08:53:28 +0200
Subject: [luatex] assertion error
In-Reply-To: <CAG5iGsBcYnFw+GxKiE=5y_d8XQ1R+tppFVRoabSh1SddGOaYAQ@mail.gmail.com>
References: <oou9rb0s2a84$.dlg@nililand.de>
 <CAEW6iOh7Oi7bhKmwTDzoh7yc4mZccs5jsYqFurNbiU2j_h=+zw@mail.gmail.com>
 <CAG5iGsBcYnFw+GxKiE=5y_d8XQ1R+tppFVRoabSh1SddGOaYAQ@mail.gmail.com>
Message-ID: <CAG5iGsB03nkq8MMmn2Z2jfq3nGAtZXWy4qLf6cAyudmNFEJEVg@mail.gmail.com>

On Wed, May 11, 2016 at 7:54 PM, luigi scarso <luigi.scarso at gmail.com>
wrote:

>
>
> On Wed, May 11, 2016 at 7:46 PM, David Carlisle <d.p.carlisle at gmail.com>
> wrote:
>
>> On 11 May 2016 at 18:26, Ulrike Fischer <luatex at nililand.de> wrote:
>> > With this latex document
>> >
>> > \documentclass{article}
>> > \pdfextension mapline{=cmr10 DejaVuSans "T1Encoding ReEncodeFont"
>> > <[tex256.enc <DejaVuSans.ttf}
>> > \begin{document}
>> > blub
>> > \end{document}
>> >
>> > I get on windows 7 with luatex (from tl 2016 pretest)
>> > an error from the
>> >
>> > "Microsoft Visual C++ Runtime library"
>> >
>> > The error message says:
>> >
>> > Assertion failed!
>> > Program: D:\texlive\2016\bin\win32\luatex.exe
>> > File: utils/avl.c
>> > Line: 744
>> >
>> > Expression tree !=NULL
>> >
>> > With luatex from TL 2015 (and \pdfmapline) there is no problem.
>> >
>> > I don't really want to use a font like this. I ran into the error
>> > while comparing the output of some fonts. The real error came from
>> > arial.ttf, I replaced it by dejavusans as this is part of texlive.
>> >
>> >
>> > --
>> > Ulrike Fischer
>> > http://www.troubleshooting-tex.de/
>> >
>>
>> essentially the same in a cygwin build:
>>
>> assertion "tree != NULL" failed: file
>> "../../../texk/web2c/luatexdir/utils/avl.c", line 744, function:
>> avl_destroy
>> Aborted (core dumped)
>>
>> David
>>
> ok, seen it, I have a backtrace of the dump.
>
> --
> luigi
>

fixed in TeXLive revision 41085 (thanks to A. Kakuto).

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160513/8727e0d3/attachment.html>

From fischer at unix-ag.uni-kl.de  Fri May 13 10:58:24 2016
From: fischer at unix-ag.uni-kl.de (Thomas Fischer)
Date: Fri, 13 May 2016 10:58:24 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
Message-ID: <20160513085824.GA2899@hs-p-000415.hs.local>

Hello,

in LuaTeX's bug tracker (see link below), this issue has been reported as fixed. However, despite using luatex 0.80, I can still reproduce this issue.
Apprarently, I am not the only one who is affected. For example, see this comment on LaTeX Stack Exchange:
http://tex.stackexchange.com/questions/229896/is-it-possible-to-allow-linebreaks-in-the-isbn-number-of-auto-generated-biblio#comment719972_229896

My luatex version reports itself as:
This is LuaTeX, Version beta-0.80.0 (TeX Live 2015/Arch Linux) (rev 5238)

Is my version still too old or is the bug maybe not yet completely fixed?

Bye,
Thomas


--8<----8<----8<----8<----8<----8<----8<--

On Tue, Feb 24, 2015 at 10:29 PM, Joseph Wright <
joseph.wright at morningstar2.co.uk> wrote:

> Hello all,
>
> With minimal example
>
>     \hsize=1.1cm %
>     \noindent
>     \hbox{}
>     12-34-56
>
>     \lccode`\2=`\2 %
>     \lccode`\3=`\3 %
>     \lccode`\4=`\4 %
>     \noindent
>     \hbox{}
>     12-34-56
>     \bye
>
> LuaTeX as in TL2014 fails to break the first in the first paragraph but
> does so in the second, whilst pdfTeX and XeTeX break both. Is this a
> deliberate change of behaviour?
>

Thank you for the report. I have added the item 925
http://tracker.luatex.org/view.php?id=925


From luatex at nililand.de  Fri May 13 18:00:44 2016
From: luatex at nililand.de (Ulrike Fischer)
Date: Fri, 13 May 2016 18:00:44 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
References: <20160513085824.GA2899@hs-p-000415.hs.local>
Message-ID: <h7bhdmvhup73.dlg@nililand.de>

Am Fri, 13 May 2016 10:58:24 +0200 schrieb Thomas Fischer:

> Hello,
> 
> in LuaTeX's bug tracker (see link below), this issue has been reported as fixed. However, despite using luatex 0.80, I can still reproduce this issue.
> Apprarently, I am not the only one who is affected. For example, see this comment on LaTeX Stack Exchange:
> http://tex.stackexchange.com/questions/229896/is-it-possible-to-allow-linebreaks-in-the-isbn-number-of-auto-generated-biblio#comment719972_229896
> 
> My luatex version reports itself as:
> This is LuaTeX, Version beta-0.80.0 (TeX Live 2015/Arch Linux) (rev 5238)
> 
> Is my version still too old or is the bug maybe not yet completely fixed?

Your version is too old. But I still see the issue in the newest
luatex from TL2016 pretest. So I would say it has not been fixed. 


-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


> 
> --8<----8<----8<----8<----8<----8<----8<--
> 
> On Tue, Feb 24, 2015 at 10:29 PM, Joseph Wright <
> joseph.wright at morningstar2.co.uk> wrote:
> 
>> Hello all,
>>
>> With minimal example
>>
>>     \hsize=1.1cm %
>>     \noindent
>>     \hbox{}
>>     12-34-56
>>
>>     \lccode`\2=`\2 %
>>     \lccode`\3=`\3 %
>>     \lccode`\4=`\4 %
>>     \noindent
>>     \hbox{}
>>     12-34-56
>>     \bye
>>
>> LuaTeX as in TL2014 fails to break the first in the first
paragraph but
>> does so in the second, whilst pdfTeX and XeTeX break both. Is
this a
>> deliberate change of behaviour?
>>
> 
> Thank you for the report. I have added the item 925
> http://tracker.luatex.org/view.php?id=925


From pragma at wxs.nl  Sat May 14 16:35:32 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 14 May 2016 16:35:32 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
In-Reply-To: <h7bhdmvhup73.dlg@nililand.de>
References: <20160513085824.GA2899@hs-p-000415.hs.local>
 <h7bhdmvhup73.dlg@nililand.de>
Message-ID: <241214c4-a32c-7697-4b9a-9d89941a9834@wxs.nl>

On 5/13/2016 6:00 PM, Ulrike Fischer wrote:
> Am Fri, 13 May 2016 10:58:24 +0200 schrieb Thomas Fischer:
>
>> Hello,
>>
>> in LuaTeX's bug tracker (see link below), this issue has been reported as fixed. However, despite using luatex 0.80, I can still reproduce this issue.
>> Apprarently, I am not the only one who is affected. For example, see this comment on LaTeX Stack Exchange:
>> http://tex.stackexchange.com/questions/229896/is-it-possible-to-allow-linebreaks-in-the-isbn-number-of-auto-generated-biblio#comment719972_229896
>>
>> My luatex version reports itself as:
>> This is LuaTeX, Version beta-0.80.0 (TeX Live 2015/Arch Linux) (rev 5238)
>>
>> Is my version still too old or is the bug maybe not yet completely fixed?
>
> Your version is too old. But I still see the issue in the newest
> luatex from TL2016 pretest. So I would say it has not been fixed.

luatex has \hjcode for this (it initializes from lccodes but from then 
on works with hjcodes thereby untangling character casing from hyphenation)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From luatex at nililand.de  Sat May 14 18:07:50 2016
From: luatex at nililand.de (Ulrike Fischer)
Date: Sat, 14 May 2016 18:07:50 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
References: <20160513085824.GA2899@hs-p-000415.hs.local>
 <h7bhdmvhup73.dlg@nililand.de> <241214c4-a32c-7697-4b9a-9d89941a9834@wxs.nl>
Message-ID: <rscn6k1u6bc4$.dlg@nililand.de>

Am Sat, 14 May 2016 16:35:32 +0200 schrieb Hans Hagen:

>>
>> Your version is too old. But I still see the issue in the newest
>> luatex from TL2016 pretest. So I would say it has not been fixed.
> 
> luatex has \hjcode for this (it initializes from lccodes but from then 
> on works with hjcodes thereby untangling character casing from hyphenation)

Changing the \hjcode enables the hyphenation (like changing the
\lccode) but this doesn't answer the question if it is deliberate
that there is no global hyphenation point after the hyphen.  

Do I have to set all \hjcodes to be able to get an break after an
hyphen?

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From vk489 at uowmail.edu.au  Sun May 15 09:37:08 2016
From: vk489 at uowmail.edu.au (Vafa Khalighi)
Date: Sun, 15 May 2016 17:37:08 +1000
Subject: [luatex] What's wrong with LuaTeX v0.95.0?
Message-ID: <CABPrwP0Y9H_gWkaAEqjcNiRRgCQ7jtdn++wEx+ebbFGG75B6_g@mail.gmail.com>

Hi

I have been a lollipop user (http://ctan.org/pkg/lollipop) since 15 years
ago and its developer from April 2014. For the past 15 years, I have only
been using Knuth's TeX engine since that gives me all I want. If you try to
build the lollipop format for Knuth's TeX by:

tex -ini   -jobname=lollipop -progname=lollipop lollipop.ini


and process the following minimal example with lollipop format:


\Start

Let's say $x$ is a variable

\Stop

You see no problem in the output. However, if you build the format by
using luatex v0.95.0 by


luatex -ini   -jobname=lollipop -progname=lollipop lollipop.ini


and process the same file, then the x in the inline math mode
disappears. Should not luatex at least behave like Knuth's TeX engine?
Does anyone know what is wrong here?

The content of my lollipop.ini is

\scrollmode
\input lollipop
\dump
\endinput


Vafa
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160515/23cd522b/attachment-0001.html>

From joseph.wright at morningstar2.co.uk  Sun May 15 10:02:11 2016
From: joseph.wright at morningstar2.co.uk (Joseph Wright)
Date: Sun, 15 May 2016 09:02:11 +0100
Subject: [luatex] What's wrong with LuaTeX v0.95.0?
In-Reply-To: <CABPrwP0Y9H_gWkaAEqjcNiRRgCQ7jtdn++wEx+ebbFGG75B6_g@mail.gmail.com>
References: <CABPrwP0Y9H_gWkaAEqjcNiRRgCQ7jtdn++wEx+ebbFGG75B6_g@mail.gmail.com>
Message-ID: <57382D03.60502@morningstar2.co.uk>

On 15/05/2016 08:37, Vafa Khalighi wrote:
> Hi
> 
> I have been a lollipop user (http://ctan.org/pkg/lollipop) since 15 years
> ago and its developer from April 2014. For the past 15 years, I have only
> been using Knuth's TeX engine since that gives me all I want. If you try to
> build the lollipop format for Knuth's TeX by:
> 
> tex -ini   -jobname=lollipop -progname=lollipop lollipop.ini
> 
> 
> and process the following minimal example with lollipop format:
> 
> 
> \Start
> 
> Let's say $x$ is a variable
> 
> \Stop
> 
> You see no problem in the output. However, if you build the format by
> using luatex v0.95.0 by
> 
> 
> luatex -ini   -jobname=lollipop -progname=lollipop lollipop.ini
> 
> 
> and process the same file, then the x in the inline math mode
> disappears. Should not luatex at least behave like Knuth's TeX engine?
> Does anyone know what is wrong here?
> 
> The content of my lollipop.ini is
> 
> \scrollmode
> \input lollipop
> \dump
> \endinput
> 
> 
> Vafa
> 

There've been some changes in the internals of handling \Umathcode,
which at least in LaTeX terms requires some updates to parts of the
codebase. What I notice here is that the \Umathcode for 'x' is certainly
wrong, and doing

% Set up extra primitives
\ifx\directlua\undefined\else
  \directlua{tex.enableprimitives("",tex.extraprimitives())}%
\fi
% Direct PDF output for convenience
\ifx\pdfouput\undefined
  \outputmode=1 %
\else
  \pdfoutput=1 %
\fi

\Start

\Umathcodenum`x=31457400 %

%\showtokens\expandafter{\the\Umathcode`\x }%
Let's say $x$ is a variable

\Stop

works.

Joseph

From vk489 at uowmail.edu.au  Sun May 15 11:10:17 2016
From: vk489 at uowmail.edu.au (Vafa Khalighi)
Date: Sun, 15 May 2016 19:10:17 +1000
Subject: [luatex] What's wrong with LuaTeX v0.95.0?
In-Reply-To: <57382D03.60502@morningstar2.co.uk>
References: <CABPrwP0Y9H_gWkaAEqjcNiRRgCQ7jtdn++wEx+ebbFGG75B6_g@mail.gmail.com>
 <57382D03.60502@morningstar2.co.uk>
Message-ID: <CABPrwP2S4A_gUWaHpQTQYrR6cM1tZ9dzcL8UORK_Pv5GXde4cQ@mail.gmail.com>

Hi Joseph

Thanks for taking your time to look at this. I can see now that what I need
to fix but still I would say that LuaTeX breaks TeX's backward
compatibility.

On Sun, May 15, 2016 at 6:02 PM, Joseph Wright <
joseph.wright at morningstar2.co.uk> wrote:

> On 15/05/2016 08:37, Vafa Khalighi wrote:
> > Hi
> >
> > I have been a lollipop user (http://ctan.org/pkg/lollipop) since 15
> years
> > ago and its developer from April 2014. For the past 15 years, I have only
> > been using Knuth's TeX engine since that gives me all I want. If you try
> to
> > build the lollipop format for Knuth's TeX by:
> >
> > tex -ini   -jobname=lollipop -progname=lollipop lollipop.ini
> >
> >
> > and process the following minimal example with lollipop format:
> >
> >
> > \Start
> >
> > Let's say $x$ is a variable
> >
> > \Stop
> >
> > You see no problem in the output. However, if you build the format by
> > using luatex v0.95.0 by
> >
> >
> > luatex -ini   -jobname=lollipop -progname=lollipop lollipop.ini
> >
> >
> > and process the same file, then the x in the inline math mode
> > disappears. Should not luatex at least behave like Knuth's TeX engine?
> > Does anyone know what is wrong here?
> >
> > The content of my lollipop.ini is
> >
> > \scrollmode
> > \input lollipop
> > \dump
> > \endinput
> >
> >
> > Vafa
> >
>
> There've been some changes in the internals of handling \Umathcode,
> which at least in LaTeX terms requires some updates to parts of the
> codebase. What I notice here is that the \Umathcode for 'x' is certainly
> wrong, and doing
>
> % Set up extra primitives
> \ifx\directlua\undefined\else
>   \directlua{tex.enableprimitives("",tex.extraprimitives())}%
> \fi
> % Direct PDF output for convenience
> \ifx\pdfouput\undefined
>   \outputmode=1 %
> \else
>   \pdfoutput=1 %
> \fi
>
> \Start
>
> \Umathcodenum`x=31457400 %
>
> %\showtokens\expandafter{\the\Umathcode`\x }%
> Let's say $x$ is a variable
>
> \Stop
>
> works.
>
> Joseph
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160515/edb66656/attachment-0001.html>

From joseph.wright at morningstar2.co.uk  Sun May 15 11:14:47 2016
From: joseph.wright at morningstar2.co.uk (Joseph Wright)
Date: Sun, 15 May 2016 10:14:47 +0100
Subject: [luatex] What's wrong with LuaTeX v0.95.0?
In-Reply-To: <CABPrwP2S4A_gUWaHpQTQYrR6cM1tZ9dzcL8UORK_Pv5GXde4cQ@mail.gmail.com>
References: <CABPrwP0Y9H_gWkaAEqjcNiRRgCQ7jtdn++wEx+ebbFGG75B6_g@mail.gmail.com>
 <57382D03.60502@morningstar2.co.uk>
 <CABPrwP2S4A_gUWaHpQTQYrR6cM1tZ9dzcL8UORK_Pv5GXde4cQ@mail.gmail.com>
Message-ID: <57383E07.8030303@morningstar2.co.uk>

On 15/05/2016 10:10, Vafa Khalighi wrote:
> Hi Joseph
> 
> Thanks for taking your time to look at this. I can see now that what I need
> to fix but still I would say that LuaTeX breaks TeX's backward
> compatibility.

LuaTeX is *explicitly* not 100% compatible with TeX90 in a variety of areas.

Joseph


From pragma at wxs.nl  Sun May 15 13:20:01 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 15 May 2016 13:20:01 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
In-Reply-To: <rscn6k1u6bc4$.dlg@nililand.de>
References: <20160513085824.GA2899@hs-p-000415.hs.local>
 <h7bhdmvhup73.dlg@nililand.de> <241214c4-a32c-7697-4b9a-9d89941a9834@wxs.nl>
 <rscn6k1u6bc4$.dlg@nililand.de>
Message-ID: <c22715e3-3dd7-7454-269e-10fd0bdde5ae@wxs.nl>

On 5/14/2016 6:07 PM, Ulrike Fischer wrote:
> Am Sat, 14 May 2016 16:35:32 +0200 schrieb Hans Hagen:
>
>>>
>>> Your version is too old. But I still see the issue in the newest
>>> luatex from TL2016 pretest. So I would say it has not been fixed.
>>
>> luatex has \hjcode for this (it initializes from lccodes but from then
>> on works with hjcodes thereby untangling character casing from hyphenation)
>
> Changing the \hjcode enables the hyphenation (like changing the
> \lccode) but this doesn't answer the question if it is deliberate
> that there is no global hyphenation point after the hyphen.
>
> Do I have to set all \hjcodes to be able to get an break after an
> hyphen?

there are several things happening:

(1) The hyphen char is only looked at when there is a valid (in terms of 
subtype, language and hjcode) character left of it; this all relates to 
the split in stages, language and hyphenation properties carried with 
glyphs, language specific hyphens etc. This is how luatex works.

(2) The word start is determined by checks against node types.

(3) The same is true for word ends.

So, this is why

     \parindent0pt \hsize=1.1cm
     12-34-56 \par
     12-34-\hbox{56} \par
     12-34-\vrule width 1em height 1.5ex \par
     12-\hbox{34}-56 \par
     12-\vrule width 1em height 1.5ex-56 \par
     \hjcode`\1=`\1 \hjcode`\2=`\2 \hjcode`\3=`\3 \hjcode`\4=`\4
     \vskip.5cm
     12-34-56 \par
     12-34-\hbox{56} \par
     12-34-\vrule width 1em height 1.5ex \par
     12-\hbox{34}-56 \par
     12-\vrule width 1em height 1.5ex-56 \par

gives different results than in pdftex.

Now, (1) is what luatex does, so that's unlikely to change (there are 
some more subtle differences anyway and we don't aim at complete 
compatibility).

The (2) and (3) conditions are currently a bit strict and can be made to 
include e.g. boxes and rules. I played with it and the easiest solution 
is just an option: be more like pdftex in that respect, but provide a 
flag to be strict (1=start of word, 2=end of word, 3=both). This seems 
to work ok (at least at my end, but i didn't check extensively).

But as we are in code freeze stage this will not happen in 0.95 (i need 
to think of a proper name for a variable anyway).

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From luatex at nililand.de  Sun May 15 14:39:50 2016
From: luatex at nililand.de (Ulrike Fischer)
Date: Sun, 15 May 2016 14:39:50 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
References: <20160513085824.GA2899@hs-p-000415.hs.local>
 <h7bhdmvhup73.dlg@nililand.de> <241214c4-a32c-7697-4b9a-9d89941a9834@wxs.nl>
 <rscn6k1u6bc4$.dlg@nililand.de> <c22715e3-3dd7-7454-269e-10fd0bdde5ae@wxs.nl>
Message-ID: <1vr6qr05c1dna$.dlg@nililand.de>

Am Sun, 15 May 2016 13:20:01 +0200 schrieb Hans Hagen:

> there are several things happening:

I played a bit with various length and came up with this

\parindent0pt \hsize=0.1cm \relax
     12-34-56-78-12-34-56-78 \par


Curiously it breaks after the first hyphen:

12-
34-56-78-12-34-56-78

Is this to be expected?
-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From pragma at wxs.nl  Mon May 16 10:20:26 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 16 May 2016 10:20:26 +0200
Subject: [luatex] No hyphenation when \lccodes zero with explicit hyphens
In-Reply-To: <1vr6qr05c1dna$.dlg@nililand.de>
References: <20160513085824.GA2899@hs-p-000415.hs.local>
 <h7bhdmvhup73.dlg@nililand.de> <241214c4-a32c-7697-4b9a-9d89941a9834@wxs.nl>
 <rscn6k1u6bc4$.dlg@nililand.de> <c22715e3-3dd7-7454-269e-10fd0bdde5ae@wxs.nl>
 <1vr6qr05c1dna$.dlg@nililand.de>
Message-ID: <49c457fe-c121-d525-a4b1-c132077307e3@wxs.nl>

On 5/15/2016 2:39 PM, Ulrike Fischer wrote:
> Am Sun, 15 May 2016 13:20:01 +0200 schrieb Hans Hagen:
>
>> there are several things happening:
>
> I played a bit with various length and came up with this
>
> \parindent0pt \hsize=0.1cm \relax
>      12-34-56-78-12-34-56-78 \par
>
>
> Curiously it breaks after the first hyphen:
>
> 12-
> 34-56-78-12-34-56-78
>
> Is this to be expected?

not really i think, i'll check it (it might have to do with successive - 
catching in order to avoid -- ligature mess up)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From skostysh at lyx.org  Tue May 17 00:27:38 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Mon, 16 May 2016 18:27:38 -0400
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015 behavior:
 dvilualatex fails because of pdfpageheight
Message-ID: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>

Hi,

I expect this change was on purpose and it makes sense (because we are
exporting to DVI so perhaps \pdf* commands are meaningless?), but I just
wanted to confirm.

Using the dvilualatex command, the following example compiled
successfully with up-to-date TL 2015, but fails with TL 2016 pretest.

---------------------
\documentclass[a4paper,english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{luainputenc}

\makeatletter

\pdfpageheight\paperheight
\pdfpagewidth\paperwidth


\makeatother

\usepackage{babel}
\begin{document}
abc
\end{document}
---------------------

Attached is the .log file.

Can someone confirm that this change was indeed intended and that it
is not expected to change back?

Scott
-------------- next part --------------
This is LuaTeX, Version 0.95.0 (TeX Live 2016)  (format=dvilualatex 2016.5.16)  16 MAY 2016 13:17
 restricted system commands enabled.
**mwe.tex
(./mwe.tex
LaTeX2e <2016/03/31>
Babel <3.9r> and hyphenation patterns for 1 language(s) loaded.
(/usr/local/texlive/2016/texmf-dist/tex/latex/base/article.cls
Document Class: article 2014/09/29 v1.4h Standard LaTeX document class
(/usr/local/texlive/2016/texmf-dist/tex/latex/base/size10.clo
File: size10.clo 2014/09/29 v1.4h Standard LaTeX file (size option)
)
\c at part=\count79
\c at section=\count80
\c at subsection=\count81
\c at subsubsection=\count82
\c at paragraph=\count83
\c at subparagraph=\count84
\c at figure=\count85
\c at table=\count86
\abovecaptionskip=\skip41
\belowcaptionskip=\skip42
\bibindent=\dimen102
)
(/usr/local/texlive/2016/texmf-dist/tex/latex/base/fontenc.sty
Package: fontenc 2005/09/27 v1.99g Standard LaTeX package

(/usr/local/texlive/2016/texmf-dist/tex/latex/base/t1enc.def
File: t1enc.def 2005/09/27 v1.99g Standard LaTeX file
LaTeX Font Info:    Redeclaring font encoding T1 on input line 48.
))
(/usr/local/texlive/2016/texmf-dist/tex/lualatex/luainputenc/luainputenc.sty
Package: luainputenc 2010/11/19 v0.973 inputenc package for LuaTeX

(/usr/local/texlive/2016/texmf-dist/tex/generic/oberdiek/ifluatex.sty
Package: ifluatex 2010/03/01 v1.3 Provides the ifluatex switch (HO)
Package ifluatex Info: LuaTeX detected.
)
(/usr/local/texlive/2016/texmf-dist/tex/generic/ifxetex/ifxetex.sty
Package: ifxetex 2010/09/12 v0.6 Provides ifxetex conditional
)
(/usr/local/texlive/2016/texmf-dist/tex/luatex/luatexbase/luatexbase.sty
Package: luatexbase 2015/10/04 v1.3 luatexbase interface to LuaTeX 

(/usr/local/texlive/2016/texmf-dist/tex/luatex/ctablestack/ctablestack.sty
Package: ctablestack 2015/10/01 v1.0 Catcode table stable support
\@catcodetablestackcnt=\count87
)
\CatcodeTableOther=\catcodetable5
\CatcodeTableExpl=\catcodetable6
)
Lua module: luainputenc 2010/05/10 0.97 Lua simple inputenc package.
\inpenc at prehook=\toks14
\inpenc at posthook=\toks15
Inserting `luainputenc.fake_utf_write' at position 1 in `process_output_buffer'.
Inserting `luainputenc.fake_utf_read' at position 1 in `process_input_buffer'.
(/usr/local/texlive/2016/texmf-dist/tex/latex/base/latin9.def
File: latin9.def 2015/03/17 v1.2c Input encoding file
))
! Undefined control sequence.
l.10 \pdfpageheight
                 \paperheight
? X


Here is how much of LuaTeX's memory you used:
 726 strings out of 495114
 100000,89155 words of node,token memory allocated 319 words of node memory still in use:
   1 hlist, 1 rule, 1 dir, 5 glue, 39 glue_spec, 1 write nodes
   avail lists: 2:12,3:1,4:1,5:2,7:1,8:1,9:3
 4319 multiletter control sequences out of 65536+600000
 16 fonts using 674207 bytes
 25i,0n,17p,134b,37s stack positions out of 5000i,500n,10000p,200000b,100000s
No pages of output.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160516/ea140923/attachment.bin>

From d.p.carlisle at gmail.com  Tue May 17 00:33:20 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 16 May 2016 23:33:20 +0100
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
Message-ID: <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>

you will see the same in lualatex whether writing to pdf or dvi.

The new luatex does not define most of the \pdfxxxx commands coming
from pdftex, see the luatex manual.

The luatex85 package is available to alias most of the old names back
as a quick fix until documents and packages are updated to use the new
forms.

David


On 16 May 2016 at 23:27, Scott Kostyshak <skostysh at lyx.org> wrote:
> Hi,
>
> I expect this change was on purpose and it makes sense (because we are
> exporting to DVI so perhaps \pdf* commands are meaningless?), but I just
> wanted to confirm.
>
> Using the dvilualatex command, the following example compiled
> successfully with up-to-date TL 2015, but fails with TL 2016 pretest.
>
> ---------------------
> \documentclass[a4paper,english]{article}
> \usepackage[T1]{fontenc}
> \usepackage[latin9]{luainputenc}
>
> \makeatletter
>
> \pdfpageheight\paperheight
> \pdfpagewidth\paperwidth
>
>
> \makeatother
>
> \usepackage{babel}
> \begin{document}
> abc
> \end{document}
> ---------------------
>
> Attached is the .log file.
>
> Can someone confirm that this change was indeed intended and that it
> is not expected to change back?
>
> Scott



-- 
http://dpcarlisle.blogspot.com/

From skostysh at lyx.org  Tue May 17 01:29:40 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Mon, 16 May 2016 19:29:40 -0400
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
Message-ID: <20160516232940.eeoashyv7zc5dh5k@cotopaxi>

Thanks for the quick reply, David.

So to make sure I understand, it is not expected that the example I sent
will compile successfully in the future (because it does not fall into
the situation you mentioned of "packages are updated to use the new
forms"). Did I get that right?

I looked at the manual and I see in 10.1 Primitives overlap that
\pdfpagewidth is an alias of \pagewidth. So I suppose the solution in
the example I gave is to just remove the following two lines:

\pdfpageheight\paperheight
\pdfpagewidth\paperwidth

If I remove those two lines will the behavior (imagine more complex
documents) be the same for newer luatex compared to using an older
luatex with those two lines included? Will it be the same as without
those two lines for older luatex (i.e. were those two lines always
useless)?

As you could probably guess, I don't know much about luatex. But LyX
exports LuaTeX so I'm trying to figure out exactly what we need to
change.

Thanks for your help on this,

Scott

On Mon, May 16, 2016 at 11:33:20PM +0100, David Carlisle wrote:
> you will see the same in lualatex whether writing to pdf or dvi.
> 
> The new luatex does not define most of the \pdfxxxx commands coming
> from pdftex, see the luatex manual.
> 
> The luatex85 package is available to alias most of the old names back
> as a quick fix until documents and packages are updated to use the new
> forms.
> 
> David
> 
> 
> On 16 May 2016 at 23:27, Scott Kostyshak <skostysh at lyx.org> wrote:
> > Hi,
> >
> > I expect this change was on purpose and it makes sense (because we are
> > exporting to DVI so perhaps \pdf* commands are meaningless?), but I just
> > wanted to confirm.
> >
> > Using the dvilualatex command, the following example compiled
> > successfully with up-to-date TL 2015, but fails with TL 2016 pretest.
> >
> > ---------------------
> > \documentclass[a4paper,english]{article}
> > \usepackage[T1]{fontenc}
> > \usepackage[latin9]{luainputenc}
> >
> > \makeatletter
> >
> > \pdfpageheight\paperheight
> > \pdfpagewidth\paperwidth
> >
> >
> > \makeatother
> >
> > \usepackage{babel}
> > \begin{document}
> > abc
> > \end{document}
> > ---------------------
> >
> > Attached is the .log file.
> >
> > Can someone confirm that this change was indeed intended and that it
> > is not expected to change back?
> >
> > Scott
> 
> 
> 
> -- 
> http://dpcarlisle.blogspot.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160516/5f22ce86/attachment-0001.bin>

From d.p.carlisle at gmail.com  Tue May 17 01:44:35 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Tue, 17 May 2016 00:44:35 +0100
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
Message-ID: <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>

no the pure luatex syntax (from 0.85 on is)

\pageheight\paperheight
\pagewidth\paperwidth

as (in these cases) the primitives have simply been renamed dropping
the pdf prefix

but in general adding

\RequirePackage{luatex85}

at the top of the file will fix most of the incompatibilities, in
particular luatex85.sty has

\let\pdfpagewidth        \pagewidth
\let\pdfpageheight       \pageheight

which means that if you load that package \pdfpagewidth   and
\pagewidth may be used interchangeably for the same primitive length
register.

David


On 17 May 2016 at 00:29, Scott Kostyshak <skostysh at lyx.org> wrote:
> Thanks for the quick reply, David.
>
> So to make sure I understand, it is not expected that the example I sent
> will compile successfully in the future (because it does not fall into
> the situation you mentioned of "packages are updated to use the new
> forms"). Did I get that right?
>
> I looked at the manual and I see in 10.1 Primitives overlap that
> \pdfpagewidth is an alias of \pagewidth. So I suppose the solution in
> the example I gave is to just remove the following two lines:
>
> \pdfpageheight\paperheight
> \pdfpagewidth\paperwidth
>
> If I remove those two lines will the behavior (imagine more complex
> documents) be the same for newer luatex compared to using an older
> luatex with those two lines included? Will it be the same as without
> those two lines for older luatex (i.e. were those two lines always
> useless)?
>
> As you could probably guess, I don't know much about luatex. But LyX
> exports LuaTeX so I'm trying to figure out exactly what we need to
> change.
>
> Thanks for your help on this,
>
> Scott
>
> On Mon, May 16, 2016 at 11:33:20PM +0100, David Carlisle wrote:
>> you will see the same in lualatex whether writing to pdf or dvi.
>>
>> The new luatex does not define most of the \pdfxxxx commands coming
>> from pdftex, see the luatex manual.
>>
>> The luatex85 package is available to alias most of the old names back
>> as a quick fix until documents and packages are updated to use the new
>> forms.
>>
>> David
>>
>>
>> On 16 May 2016 at 23:27, Scott Kostyshak <skostysh at lyx.org> wrote:
>> > Hi,
>> >
>> > I expect this change was on purpose and it makes sense (because we are
>> > exporting to DVI so perhaps \pdf* commands are meaningless?), but I just
>> > wanted to confirm.
>> >
>> > Using the dvilualatex command, the following example compiled
>> > successfully with up-to-date TL 2015, but fails with TL 2016 pretest.
>> >
>> > ---------------------
>> > \documentclass[a4paper,english]{article}
>> > \usepackage[T1]{fontenc}
>> > \usepackage[latin9]{luainputenc}
>> >
>> > \makeatletter
>> >
>> > \pdfpageheight\paperheight
>> > \pdfpagewidth\paperwidth
>> >
>> >
>> > \makeatother
>> >
>> > \usepackage{babel}
>> > \begin{document}
>> > abc
>> > \end{document}
>> > ---------------------
>> >
>> > Attached is the .log file.
>> >
>> > Can someone confirm that this change was indeed intended and that it
>> > is not expected to change back?
>> >
>> > Scott
>>
>>
>>
>> --
>> http://dpcarlisle.blogspot.com/



-- 
http://dpcarlisle.blogspot.com/

From skostysh at lyx.org  Tue May 17 02:07:49 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Mon, 16 May 2016 20:07:49 -0400
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
Message-ID: <20160517000749.2oajl52byknno4dn@cotopaxi>

Ah I understand better now.

If we use the new syntax of

\pageheight\paperheight
\pagewidth\paperwidth

then it also works with luatex 0.8 (when I say "works" I just mean
compiles; I did not check the intended effect). Is there an older
version of luatex for which the above does not work and the
\pdfpageheight\paperheight syntax does work?

Thanks,

Scott

On Tue, May 17, 2016 at 12:44:35AM +0100, David Carlisle wrote:
> no the pure luatex syntax (from 0.85 on is)
> 
> \pageheight\paperheight
> \pagewidth\paperwidth
> 
> as (in these cases) the primitives have simply been renamed dropping
> the pdf prefix
> 
> but in general adding
> 
> \RequirePackage{luatex85}
> 
> at the top of the file will fix most of the incompatibilities, in
> particular luatex85.sty has
> 
> \let\pdfpagewidth        \pagewidth
> \let\pdfpageheight       \pageheight
> 
> which means that if you load that package \pdfpagewidth   and
> \pagewidth may be used interchangeably for the same primitive length
> register.
> 
> David
> 
> 
> On 17 May 2016 at 00:29, Scott Kostyshak <skostysh at lyx.org> wrote:
> > Thanks for the quick reply, David.
> >
> > So to make sure I understand, it is not expected that the example I sent
> > will compile successfully in the future (because it does not fall into
> > the situation you mentioned of "packages are updated to use the new
> > forms"). Did I get that right?
> >
> > I looked at the manual and I see in 10.1 Primitives overlap that
> > \pdfpagewidth is an alias of \pagewidth. So I suppose the solution in
> > the example I gave is to just remove the following two lines:
> >
> > \pdfpageheight\paperheight
> > \pdfpagewidth\paperwidth
> >
> > If I remove those two lines will the behavior (imagine more complex
> > documents) be the same for newer luatex compared to using an older
> > luatex with those two lines included? Will it be the same as without
> > those two lines for older luatex (i.e. were those two lines always
> > useless)?
> >
> > As you could probably guess, I don't know much about luatex. But LyX
> > exports LuaTeX so I'm trying to figure out exactly what we need to
> > change.
> >
> > Thanks for your help on this,
> >
> > Scott
> >
> > On Mon, May 16, 2016 at 11:33:20PM +0100, David Carlisle wrote:
> >> you will see the same in lualatex whether writing to pdf or dvi.
> >>
> >> The new luatex does not define most of the \pdfxxxx commands coming
> >> from pdftex, see the luatex manual.
> >>
> >> The luatex85 package is available to alias most of the old names back
> >> as a quick fix until documents and packages are updated to use the new
> >> forms.
> >>
> >> David
> >>
> >>
> >> On 16 May 2016 at 23:27, Scott Kostyshak <skostysh at lyx.org> wrote:
> >> > Hi,
> >> >
> >> > I expect this change was on purpose and it makes sense (because we are
> >> > exporting to DVI so perhaps \pdf* commands are meaningless?), but I just
> >> > wanted to confirm.
> >> >
> >> > Using the dvilualatex command, the following example compiled
> >> > successfully with up-to-date TL 2015, but fails with TL 2016 pretest.
> >> >
> >> > ---------------------
> >> > \documentclass[a4paper,english]{article}
> >> > \usepackage[T1]{fontenc}
> >> > \usepackage[latin9]{luainputenc}
> >> >
> >> > \makeatletter
> >> >
> >> > \pdfpageheight\paperheight
> >> > \pdfpagewidth\paperwidth
> >> >
> >> >
> >> > \makeatother
> >> >
> >> > \usepackage{babel}
> >> > \begin{document}
> >> > abc
> >> > \end{document}
> >> > ---------------------
> >> >
> >> > Attached is the .log file.
> >> >
> >> > Can someone confirm that this change was indeed intended and that it
> >> > is not expected to change back?
> >> >
> >> > Scott
> >>
> >>
> >>
> >> --
> >> http://dpcarlisle.blogspot.com/
> 
> 
> 
> -- 
> http://dpcarlisle.blogspot.com/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160516/e5331d7b/attachment-0001.bin>

From luatex at nililand.de  Tue May 17 10:32:33 2016
From: luatex at nililand.de (Ulrike Fischer)
Date: Tue, 17 May 2016 10:32:33 +0200
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi>
Message-ID: <7qcz832jqkt1$.dlg@nililand.de>

Am Mon, 16 May 2016 20:07:49 -0400 schrieb Scott Kostyshak:

> If we use the new syntax of
> 
> \pageheight\paperheight
> \pagewidth\paperwidth

Why don't you do as David suggest and load the luatex85 package?

luatex85 can also be loaded if you compile with pdflatex and
xelatex, it will then quit silently and so you can use
\pdfpageheight\paperheight in all formats (\pageheight would give an
error with pdflatex and xelatex). 


> Using the dvilualatex command

Why are you doing this? 

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From skostysh at lyx.org  Tue May 17 19:25:51 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Tue, 17 May 2016 13:25:51 -0400
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <7qcz832jqkt1$.dlg@nililand.de>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi> <7qcz832jqkt1$.dlg@nililand.de>
Message-ID: <20160517172551.lfd4aye64g5rli3u@cotopaxi>

On Tue, May 17, 2016 at 10:32:33AM +0200, Ulrike Fischer wrote:
> Am Mon, 16 May 2016 20:07:49 -0400 schrieb Scott Kostyshak:
> 
> > If we use the new syntax of
> > 
> > \pageheight\paperheight
> > \pagewidth\paperwidth
> 
> Why don't you do as David suggest and load the luatex85 package?

Because the package is quite new and many LyX users do not have it. One
possibility is to use the package if it is available and not use it if
it is not (without changing any of the other code exported by LyX). Do
you think this would lead to good results for users? Specifically, do
you think a significant amount of users (imagine a diverse mix of
Mac/Win/Linux) would have LaTeX installations with "new luatex" but
without the luatex85 package available? My guess is that it is not that
common. Let's add on the further condition that a user of LyX actually
*uses* LuaTeX.

In the long-run, it would be nice for LyX to eventually export correct
LuaTeX code and not rely on a transition package.

> luatex85 can also be loaded if you compile with pdflatex and
> xelatex, it will then quit silently and so you can use
> \pdfpageheight\paperheight in all formats (\pageheight would give an
> error with pdflatex and xelatex). 
> 
> 
> > Using the dvilualatex command
> 
> Why are you doing this? 

I don't and I don't even know why anyone would want to. But LyX supports
exporting to DVI via dvilualatex and as long as we support that I will
try my best to make sure it works properly. We have made a lot of tests
for code that LyX exports. When one of those tests goes from passing to
failing, I try to investigate whether it is a regression in an
underlying package or if (as in this case) we need to change something
in LyX's export. The challenge when we change something is often
ensuring that the exported code still works for old LaTeX installations.

Thanks for the reply, Ulrike.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160517/6548038e/attachment.bin>

From will at wspr.io  Wed May 18 07:38:28 2016
From: will at wspr.io (Will Robertson)
Date: Wed, 18 May 2016 15:08:28 +0930
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <20160517172551.lfd4aye64g5rli3u@cotopaxi>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi> <7qcz832jqkt1$.dlg@nililand.de>
 <20160517172551.lfd4aye64g5rli3u@cotopaxi>
Message-ID: <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>

On 18 May 2016, at 2:55 AM, Scott Kostyshak <skostysh at lyx.org> wrote:
> 
> On Tue, May 17, 2016 at 10:32:33AM +0200, Ulrike Fischer wrote:
>> Am Mon, 16 May 2016 20:07:49 -0400 schrieb Scott Kostyshak:
>> 
>>> If we use the new syntax of
>>> 
>>> \pageheight\paperheight
>>> \pagewidth\paperwidth
>> 
>> Why don't you do as David suggest and load the luatex85 package?
> 
> Because the package is quite new and many LyX users do not have it. One
> possibility is to use the package if it is available and not use it if
> it is not (without changing any of the other code exported by LyX). Do
> you think this would lead to good results for users? Specifically, do
> you think a significant amount of users (imagine a diverse mix of
> Mac/Win/Linux) would have LaTeX installations with "new luatex" but
> without the luatex85 package available? My guess is that it is not that
> common. Let's add on the further condition that a user of LyX actually
> *uses* LuaTeX.

It should be fine to have something like

    \IfFileExists{luatex85.sty}{\usepackage{luatex85}}{}

for the time being. This should catch 99.999% of users?

Cheers,
Will



From H.vanderMeer at uva.nl  Wed May 18 08:39:06 2016
From: H.vanderMeer at uva.nl (Meer, Hans van der)
Date: Wed, 18 May 2016 06:39:06 +0000
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi> <7qcz832jqkt1$.dlg@nililand.de>
 <20160517172551.lfd4aye64g5rli3u@cotopaxi>
 <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
Message-ID: <D7F9BDC2-E348-4542-932F-2CA7BBC330AB@uva.nl>


On 18 May 2016, at 07:38, Will Robertson <will at wspr.io<mailto:will at wspr.io>> wrote:
It should be fine to have something like

   \IfFileExists{luatex85.sty}{\usepackage{luatex85}}{}

for the time being. This should catch 99.999% of users?

This is the macro I am using to find if a file exists and act upon it. Hope this helps.

% .... File finding ...........................................................

% If #1.#2 or #1 exists execute #3{#1} and return \iftrue else only return \iffalse.
% do not forget to close with \fi or with \else...\fi
% Use #3=\gobbleoneargument to effectively kill #3{file}.
% Use #3=\relax to leave file behind.
% Use #3={\def\macrotodefine} to define file as macro content.
\def\iffilewithsuffix#1#2#3{%
\let\mynext\iftrue
\doiffileelse{#1.#2}% existence of #1.#2 tested
{#3{#1.#2}}% #1.#2 does exist
{\doiffileelse{#1}% existence of #1 tested
{#3{#1}}% #1 exists
{\let\mynext\iffalse}% neither file exists remove macro call
}%
\mynext
}
\def\ifexistfilewithsuffix#1#2{%
\let\mynext\iftrue
\doifnotfile{#1.#2}{\doifnotfile{#1}{\let\mynext\iffalse}}%
\mynext
}

Hans van der Meer



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160518/44c42062/attachment-0001.html>

From skostysh at lyx.org  Wed May 18 09:10:59 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Wed, 18 May 2016 03:10:59 -0400
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi> <7qcz832jqkt1$.dlg@nililand.de>
 <20160517172551.lfd4aye64g5rli3u@cotopaxi>
 <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
Message-ID: <20160518071059.lqm5wkjwfe5e674o@cotopaxi>

On Wed, May 18, 2016 at 03:08:28PM +0930, Will Robertson wrote:
> On 18 May 2016, at 2:55 AM, Scott Kostyshak <skostysh at lyx.org> wrote:
> > 
> > On Tue, May 17, 2016 at 10:32:33AM +0200, Ulrike Fischer wrote:
> >> Am Mon, 16 May 2016 20:07:49 -0400 schrieb Scott Kostyshak:
> >> 
> >>> If we use the new syntax of
> >>> 
> >>> \pageheight\paperheight
> >>> \pagewidth\paperwidth
> >> 
> >> Why don't you do as David suggest and load the luatex85 package?
> > 
> > Because the package is quite new and many LyX users do not have it. One
> > possibility is to use the package if it is available and not use it if
> > it is not (without changing any of the other code exported by LyX). Do
> > you think this would lead to good results for users? Specifically, do
> > you think a significant amount of users (imagine a diverse mix of
> > Mac/Win/Linux) would have LaTeX installations with "new luatex" but
> > without the luatex85 package available? My guess is that it is not that
> > common. Let's add on the further condition that a user of LyX actually
> > *uses* LuaTeX.
> 
> It should be fine to have something like
> 
>     \IfFileExists{luatex85.sty}{\usepackage{luatex85}}{}
> 
> for the time being. This should catch 99.999% of users?
 
Sounds good to me. I think this is a good strategy.

Thanks,

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160518/af7f03fc/attachment.bin>

From skostysh at lyx.org  Wed May 18 09:11:29 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Wed, 18 May 2016 03:11:29 -0400
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <D7F9BDC2-E348-4542-932F-2CA7BBC330AB@uva.nl>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi> <7qcz832jqkt1$.dlg@nililand.de>
 <20160517172551.lfd4aye64g5rli3u@cotopaxi>
 <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
 <D7F9BDC2-E348-4542-932F-2CA7BBC330AB@uva.nl>
Message-ID: <20160518071129.2rxxpohv6ylxkz5k@cotopaxi>

On Wed, May 18, 2016 at 06:39:06AM +0000, Meer, Hans van der wrote:
> 
> On 18 May 2016, at 07:38, Will Robertson <will at wspr.io<mailto:will at wspr.io>> wrote:
> It should be fine to have something like
> 
>    \IfFileExists{luatex85.sty}{\usepackage{luatex85}}{}
> 
> for the time being. This should catch 99.999% of users?
> 
> This is the macro I am using to find if a file exists and act upon it. Hope this helps.
> 
> % .... File finding ...........................................................
> 
> % If #1.#2 or #1 exists execute #3{#1} and return \iftrue else only return \iffalse.
> % do not forget to close with \fi or with \else...\fi
> % Use #3=\gobbleoneargument to effectively kill #3{file}.
> % Use #3=\relax to leave file behind.
> % Use #3={\def\macrotodefine} to define file as macro content.
> \def\iffilewithsuffix#1#2#3{%
> \let\mynext\iftrue
> \doiffileelse{#1.#2}% existence of #1.#2 tested
> {#3{#1.#2}}% #1.#2 does exist
> {\doiffileelse{#1}% existence of #1 tested
> {#3{#1}}% #1 exists
> {\let\mynext\iffalse}% neither file exists remove macro call
> }%
> \mynext
> }
> \def\ifexistfilewithsuffix#1#2{%
> \let\mynext\iftrue
> \doifnotfile{#1.#2}{\doifnotfile{#1}{\let\mynext\iffalse}}%
> \mynext
> }
> 
> Hans van der Meer
> 
> 

Thanks Hans and everyone else for all the help.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160518/9e14816c/attachment.bin>

From reinhard.kotucha at web.de  Thu May 19 01:04:43 2016
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Thu, 19 May 2016 01:04:43 +0200
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi>	<7qcz832jqkt1$.dlg@nililand.de>
 <20160517172551.lfd4aye64g5rli3u@cotopaxi>
 <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
Message-ID: <22332.62731.512693.141609@zaphod.ms25.net>

On 2016-05-18 at 15:08:28 +0930, Will Robertson wrote:

 > It should be fine to have something like
 > 
 >     \IfFileExists{luatex85.sty}{\usepackage{luatex85}}{}
 > 
 > for the time being. This should catch 99.999% of users?

Sure.

Someone said on a mailing list said that package authors who support a
beta version of LuaTeX should keep their stuff up-to-date.

But this is not the only problem.  The main problem is that LuaTeX was
compatible with pdfTeX in the past and that many people are using
packages designed for pdfTeX.  I suppose that many packages don't work
anymore.

Isn't it better to put some code derived from luatex85.sty into the
format file which creates a warning message whenever a deprecated
control sequence is used?

Unfortunately there is not much time until TeX Live 2016 is released.

Regards,
  Reinhard

-- 
------------------------------------------------------------------
Reinhard Kotucha                            Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                    mailto:reinhard.kotucha at web.de
------------------------------------------------------------------

From d.p.carlisle at gmail.com  Thu May 19 01:27:24 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Thu, 19 May 2016 00:27:24 +0100
Subject: [luatex] Confirm change in TL 2016-pretest vs. TL 2015
 behavior: dvilualatex fails because of pdfpageheight
In-Reply-To: <22332.62731.512693.141609@zaphod.ms25.net>
References: <20160516222738.agr4izmnpt2p3xzp@cotopaxi>
 <CAEW6iOi6yP-5fqZJ3aEeNQixOCEwsBhYf_FfnT-t1Q1mWkeG+A@mail.gmail.com>
 <20160516232940.eeoashyv7zc5dh5k@cotopaxi>
 <CAEW6iOg7K_3-NZEh+DeVqSxrNU4RY9OJGBdFwJtDJLt8eb9E7A@mail.gmail.com>
 <20160517000749.2oajl52byknno4dn@cotopaxi>	<7qcz832jqkt1$.dlg@nililand.de>
 <20160517172551.lfd4aye64g5rli3u@cotopaxi>
 <45FEDA7E-550E-4B19-AA7B-0976CCDE7DBA@wspr.io>
 <22332.62731.512693.141609@zaphod.ms25.net>
Message-ID: <CAEW6iOi7f2W435e80DYnBufkthjpt=tmOLPCdbZwJisrOVHNsA@mail.gmail.com>

On 19 May 2016 at 00:04, Reinhard Kotucha <reinhard.kotucha at web.de> wrote:
> On 2016-05-18 at 15:08:28 +0930, Will Robertson wrote:
>
>  > It should be fine to have something like
>  >
>  >     \IfFileExists{luatex85.sty}{\usepackage{luatex85}}{}
>  >
>  > for the time being. This should catch 99.999% of users?
>
> Sure.
>
> Someone said on a mailing list said that package authors who support a
> beta version of LuaTeX should keep their stuff up-to-date.
>
> But this is not the only problem.  The main problem is that LuaTeX was
> compatible with pdfTeX in the past and that many people are using
> packages designed for pdfTeX.  I suppose that many packages don't work
> anymore.

It's not _that_ many (search for `\pdf[a-z]` in y0ur texlive tree, and
while not all are updated yet
most maintainers  have been contacted (or at least, efforts have been
made to contact them)

>
> Isn't it better to put some code derived from luatex85.sty into the
> format file which creates a warning message whenever a deprecated
> control sequence is used?
>
> Unfortunately there is not much time until TeX Live 2016 is released.
>

No, on balance I/we think it is better not to do that, see for example
discussion on texlive list

http://tug.org/pipermail/tex-live/2016-May/038443.html

David

From joseph.wright at morningstar2.co.uk  Fri May 20 22:58:37 2016
From: joseph.wright at morningstar2.co.uk (Joseph Wright)
Date: Fri, 20 May 2016 21:58:37 +0100
Subject: [luatex] \vsplit issue
Message-ID: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>

Hello all,

The example

    \setbox0=\vbox{a\par b\par c\par d}
    \setbox2=\vsplit0 to 2cm %
    %\showboxbreadth\maxdimen
    %\showboxdepth\maxdimen
    %\showbox2 %
    \bye

gives an underful vbox with pdfTeX, leading to a warning and box trace
in the log. The same isn't the case for LuaTeX (v0.95 from TL'16), which
comes from the fact the box is no longer the same size:

    > \box2=
    \vbox(40.30554+0.0)x469.75499, direction TLT

from LuaTeX, wherease pdfTeX gives

    > \box2=
    \vbox(56.9055+0.0)x469.75499, glue set 5.53333

An error?

Joseph

From luigi.scarso at gmail.com  Fri May 20 23:58:00 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Fri, 20 May 2016 23:58:00 +0200
Subject: [luatex] \vsplit issue
In-Reply-To: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>
References: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>
Message-ID: <CAG5iGsCc4RYhqPnCab48fHQ-J9MxLZrE9p4D5U7j2rNG1Gfqnw@mail.gmail.com>

On Fri, May 20, 2016 at 10:58 PM, Joseph Wright <
joseph.wright at morningstar2.co.uk> wrote:

> Hello all,
>
> The example
>
>     \setbox0=\vbox{a\par b\par c\par d}
>     \setbox2=\vsplit0 to 2cm %
>     %\showboxbreadth\maxdimen
>     %\showboxdepth\maxdimen
>     %\showbox2 %
>     \bye
>
> gives an underful vbox with pdfTeX, leading to a warning and box trace
> in the log. The same isn't the case for LuaTeX (v0.95 from TL'16), which
> comes from the fact the box is no longer the same size:
>
>     > \box2=
>     \vbox(40.30554+0.0)x469.75499, direction TLT
>
> from LuaTeX, wherease pdfTeX gives
>
>     > \box2=
>     \vbox(56.9055+0.0)x469.75499, glue set 5.53333
>
> An error?
>
> Joseph
>

thank you for the report, we are seeing it.

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160520/4c31da14/attachment.html>

From luigi.scarso at gmail.com  Sat May 21 00:19:55 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sat, 21 May 2016 00:19:55 +0200
Subject: [luatex] \vsplit issue
In-Reply-To: <CAG5iGsCc4RYhqPnCab48fHQ-J9MxLZrE9p4D5U7j2rNG1Gfqnw@mail.gmail.com>
References: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>
 <CAG5iGsCc4RYhqPnCab48fHQ-J9MxLZrE9p4D5U7j2rNG1Gfqnw@mail.gmail.com>
Message-ID: <CAG5iGsCVMZmjJ+EAfVw=jLWSUUtGTbG6oO72Tqz0rTWm-Ci_oQ@mail.gmail.com>

On Fri, May 20, 2016 at 11:58 PM, luigi scarso <luigi.scarso at gmail.com>
wrote:

>
>
> On Fri, May 20, 2016 at 10:58 PM, Joseph Wright <
> joseph.wright at morningstar2.co.uk> wrote:
>
>> Hello all,
>>
>> The example
>>
>>     \setbox0=\vbox{a\par b\par c\par d}
>>     \setbox2=\vsplit0 to 2cm %
>>     %\showboxbreadth\maxdimen
>>     %\showboxdepth\maxdimen
>>     %\showbox2 %
>>     \bye
>>
>> gives an underful vbox with pdfTeX, leading to a warning and box trace
>> in the log. The same isn't the case for LuaTeX (v0.95 from TL'16), which
>> comes from the fact the box is no longer the same size:
>>
>>     > \box2=
>>     \vbox(40.30554+0.0)x469.75499, direction TLT
>>
>> from LuaTeX, wherease pdfTeX gives
>>
>>     > \box2=
>>     \vbox(56.9055+0.0)x469.75499, glue set 5.53333
>>
>> An error?
>>
>> Joseph
>>
>
> thank you for the report, we are seeing it.
>
> --
> luigi
>
It's a bug:
we have a patch, but we also want to implement upto

\vsplit to 2cm
\vsplit upto 2cm

so this keyword saves a \setbox2\vbox{\unvbox2}

We will commit it to experimental (which is already 0.96.0,
and in any case not for trunk and 0.95.0, tl is frozen.

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160521/2a777f35/attachment-0001.html>

From luigi.scarso at gmail.com  Sat May 21 00:40:50 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sat, 21 May 2016 00:40:50 +0200
Subject: [luatex] \vsplit issue
In-Reply-To: <CAG5iGsCVMZmjJ+EAfVw=jLWSUUtGTbG6oO72Tqz0rTWm-Ci_oQ@mail.gmail.com>
References: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>
 <CAG5iGsCc4RYhqPnCab48fHQ-J9MxLZrE9p4D5U7j2rNG1Gfqnw@mail.gmail.com>
 <CAG5iGsCVMZmjJ+EAfVw=jLWSUUtGTbG6oO72Tqz0rTWm-Ci_oQ@mail.gmail.com>
Message-ID: <CAG5iGsBw36Yk_wTreS0Zycc5=Sf6VVsWQBuCmyYCoAG+07tLuw@mail.gmail.com>

On Sat, May 21, 2016 at 12:19 AM, luigi scarso <luigi.scarso at gmail.com>
wrote:

>
>
> On Fri, May 20, 2016 at 11:58 PM, luigi scarso <luigi.scarso at gmail.com>
> wrote:
>
>>
>>
>> On Fri, May 20, 2016 at 10:58 PM, Joseph Wright <
>> joseph.wright at morningstar2.co.uk> wrote:
>>
>>> Hello all,
>>>
>>> The example
>>>
>>>     \setbox0=\vbox{a\par b\par c\par d}
>>>     \setbox2=\vsplit0 to 2cm %
>>>     %\showboxbreadth\maxdimen
>>>     %\showboxdepth\maxdimen
>>>     %\showbox2 %
>>>     \bye
>>>
>>> gives an underful vbox with pdfTeX, leading to a warning and box trace
>>> in the log. The same isn't the case for LuaTeX (v0.95 from TL'16), which
>>> comes from the fact the box is no longer the same size:
>>>
>>>     > \box2=
>>>     \vbox(40.30554+0.0)x469.75499, direction TLT
>>>
>>> from LuaTeX, wherease pdfTeX gives
>>>
>>>     > \box2=
>>>     \vbox(56.9055+0.0)x469.75499, glue set 5.53333
>>>
>>> An error?
>>>
>>> Joseph
>>>
>>
>> thank you for the report, we are seeing it.
>>
>> --
>> luigi
>>
> It's a bug:
> we have a patch, but we also want to implement upto
>
> \vsplit to 2cm
> \vsplit upto 2cm
>
> so this keyword saves a \setbox2\vbox{\unvbox2}
>
> We will commit it to experimental (which is already 0.96.0,
>
>
 ------------------------------------------------------------------------
r6017 | luigi | 2016-05-21 00:40:03 +0200 (Sat, 21 May 2016) | 1 line
Changed paths:
   M /branches/experimental/source/texk/web2c/luatexdir/tex/packaging.w

fix for vsplit and new upto (HH)
------------------------------------------------------------------------


-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160521/fc0d9081/attachment.html>

From luigi.scarso at gmail.com  Sat May 21 13:46:13 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sat, 21 May 2016 13:46:13 +0200
Subject: [luatex] \vsplit issue
In-Reply-To: <CAG5iGsBw36Yk_wTreS0Zycc5=Sf6VVsWQBuCmyYCoAG+07tLuw@mail.gmail.com>
References: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>
 <CAG5iGsCc4RYhqPnCab48fHQ-J9MxLZrE9p4D5U7j2rNG1Gfqnw@mail.gmail.com>
 <CAG5iGsCVMZmjJ+EAfVw=jLWSUUtGTbG6oO72Tqz0rTWm-Ci_oQ@mail.gmail.com>
 <CAG5iGsBw36Yk_wTreS0Zycc5=Sf6VVsWQBuCmyYCoAG+07tLuw@mail.gmail.com>
Message-ID: <CAG5iGsDWRsahkE8=f-_w3cOMsNWrkrTLS-mVogbRDPS77GJZpA@mail.gmail.com>

On Sat, May 21, 2016 at 12:40 AM, luigi scarso <luigi.scarso at gmail.com>
wrote:

>
>
> On Sat, May 21, 2016 at 12:19 AM, luigi scarso <luigi.scarso at gmail.com>
> wrote:
>
>>
>>
>> On Fri, May 20, 2016 at 11:58 PM, luigi scarso <luigi.scarso at gmail.com>
>> wrote:
>>
>>>
>>>
>>> On Fri, May 20, 2016 at 10:58 PM, Joseph Wright <
>>> joseph.wright at morningstar2.co.uk> wrote:
>>>
>>>> Hello all,
>>>>
>>>> The example
>>>>
>>>>     \setbox0=\vbox{a\par b\par c\par d}
>>>>     \setbox2=\vsplit0 to 2cm %
>>>>     %\showboxbreadth\maxdimen
>>>>     %\showboxdepth\maxdimen
>>>>     %\showbox2 %
>>>>     \bye
>>>>
>>>> gives an underful vbox with pdfTeX, leading to a warning and box trace
>>>> in the log. The same isn't the case for LuaTeX (v0.95 from TL'16), which
>>>> comes from the fact the box is no longer the same size:
>>>>
>>>>     > \box2=
>>>>     \vbox(40.30554+0.0)x469.75499, direction TLT
>>>>
>>>> from LuaTeX, wherease pdfTeX gives
>>>>
>>>>     > \box2=
>>>>     \vbox(56.9055+0.0)x469.75499, glue set 5.53333
>>>>
>>>> An error?
>>>>
>>>> Joseph
>>>>
>>>
>>> thank you for the report, we are seeing it.
>>>
>>> --
>>> luigi
>>>
>> It's a bug:
>> we have a patch, but we also want to implement upto
>>
>> \vsplit to 2cm
>> \vsplit upto 2cm
>>
>> so this keyword saves a \setbox2\vbox{\unvbox2}
>>
>> We will commit it to experimental (which is already 0.96.0,
>>
>>
>  ------------------------------------------------------------------------
> r6017 | luigi | 2016-05-21 00:40:03 +0200 (Sat, 21 May 2016) | 1 line
> Changed paths:
>    M /branches/experimental/source/texk/web2c/luatexdir/tex/packaging.w
>
> fix for vsplit and new upto (HH)
> ------------------------------------------------------------------------
>
>
> --
> luigi
>


------------------------------------------------------------------------
r6018 | luigi | 2016-05-21 13:45:32 +0200 (Sat, 21 May 2016) | 1 line
Changed paths:
   M /branches/experimental/manual/luatex-callbacks.tex
   M /branches/experimental/manual/luatex-enhancements.tex
   M /branches/experimental/manual/luatex.pdf

updated manual (HH)
------------------------------------------------------------------------

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160521/f6edea6f/attachment.html>

From joseph.wright at morningstar2.co.uk  Sat May 21 14:53:29 2016
From: joseph.wright at morningstar2.co.uk (Joseph Wright)
Date: Sat, 21 May 2016 13:53:29 +0100
Subject: [luatex] \vsplit issue
In-Reply-To: <CAG5iGsDWRsahkE8=f-_w3cOMsNWrkrTLS-mVogbRDPS77GJZpA@mail.gmail.com>
References: <95338f0e-28a2-6ae6-8841-772fb2c98d78@morningstar2.co.uk>
 <CAG5iGsCc4RYhqPnCab48fHQ-J9MxLZrE9p4D5U7j2rNG1Gfqnw@mail.gmail.com>
 <CAG5iGsCVMZmjJ+EAfVw=jLWSUUtGTbG6oO72Tqz0rTWm-Ci_oQ@mail.gmail.com>
 <CAG5iGsBw36Yk_wTreS0Zycc5=Sf6VVsWQBuCmyYCoAG+07tLuw@mail.gmail.com>
 <CAG5iGsDWRsahkE8=f-_w3cOMsNWrkrTLS-mVogbRDPS77GJZpA@mail.gmail.com>
Message-ID: <148f3572-1bdb-3279-82d8-e4885146e089@morningstar2.co.uk>

On 21/05/2016 12:46, luigi scarso wrote:
> On Sat, May 21, 2016 at 12:40 AM, luigi scarso <luigi.scarso at gmail.com>
> wrote:
> 
>>
>>
>> On Sat, May 21, 2016 at 12:19 AM, luigi scarso <luigi.scarso at gmail.com>
>> wrote:
>>
>>>
>>>
>>> On Fri, May 20, 2016 at 11:58 PM, luigi scarso <luigi.scarso at gmail.com>
>>> wrote:
>>>
>>>>
>>>>
>>>> On Fri, May 20, 2016 at 10:58 PM, Joseph Wright <
>>>> joseph.wright at morningstar2.co.uk> wrote:
>>>>
>>>>> Hello all,
>>>>>
>>>>> The example
>>>>>
>>>>>     \setbox0=\vbox{a\par b\par c\par d}
>>>>>     \setbox2=\vsplit0 to 2cm %
>>>>>     %\showboxbreadth\maxdimen
>>>>>     %\showboxdepth\maxdimen
>>>>>     %\showbox2 %
>>>>>     \bye
>>>>>
>>>>> gives an underful vbox with pdfTeX, leading to a warning and box trace
>>>>> in the log. The same isn't the case for LuaTeX (v0.95 from TL'16), which
>>>>> comes from the fact the box is no longer the same size:
>>>>>
>>>>>     > \box2=
>>>>>     \vbox(40.30554+0.0)x469.75499, direction TLT
>>>>>
>>>>> from LuaTeX, wherease pdfTeX gives
>>>>>
>>>>>     > \box2=
>>>>>     \vbox(56.9055+0.0)x469.75499, glue set 5.53333
>>>>>
>>>>> An error?
>>>>>
>>>>> Joseph
>>>>>
>>>>
>>>> thank you for the report, we are seeing it.
>>>>
>>>> --
>>>> luigi
>>>>
>>> It's a bug:
>>> we have a patch, but we also want to implement upto
>>>
>>> \vsplit to 2cm
>>> \vsplit upto 2cm
>>>
>>> so this keyword saves a \setbox2\vbox{\unvbox2}
>>>
>>> We will commit it to experimental (which is already 0.96.0,
>>>
>>>
>>  ------------------------------------------------------------------------
>> r6017 | luigi | 2016-05-21 00:40:03 +0200 (Sat, 21 May 2016) | 1 line
>> Changed paths:
>>    M /branches/experimental/source/texk/web2c/luatexdir/tex/packaging.w
>>
>> fix for vsplit and new upto (HH)
>> ------------------------------------------------------------------------
>>
>>
>> --
>> luigi
>>
> 
> 
> ------------------------------------------------------------------------
> r6018 | luigi | 2016-05-21 13:45:32 +0200 (Sat, 21 May 2016) | 1 line
> Changed paths:
>    M /branches/experimental/manual/luatex-callbacks.tex
>    M /branches/experimental/manual/luatex-enhancements.tex
>    M /branches/experimental/manual/luatex.pdf
> 
> updated manual (HH)
> ------------------------------------------------------------------------

Thanks for that: use case for new keyword quite clear :-)

Joseph


From skostysh at lyx.org  Sun May 22 09:52:33 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Sun, 22 May 2016 03:52:33 -0400
Subject: [luatex] What's wrong with LuaTeX v0.95.0?
In-Reply-To: <57383E07.8030303@morningstar2.co.uk>
References: <CABPrwP0Y9H_gWkaAEqjcNiRRgCQ7jtdn++wEx+ebbFGG75B6_g@mail.gmail.com>
 <57382D03.60502@morningstar2.co.uk>
 <CABPrwP2S4A_gUWaHpQTQYrR6cM1tZ9dzcL8UORK_Pv5GXde4cQ@mail.gmail.com>
 <57383E07.8030303@morningstar2.co.uk>
Message-ID: <CAO7dr0j-FQ0_oKrdBr3qxqvQu3KMCT5g7M1670sLLOXUNn0-4w@mail.gmail.com>

On Sun, May 15, 2016 at 5:14 AM, Joseph Wright
<joseph.wright at morningstar2.co.uk> wrote:
> On 15/05/2016 10:10, Vafa Khalighi wrote:
>> Hi Joseph
>>
>> Thanks for taking your time to look at this. I can see now that what I need
>> to fix but still I would say that LuaTeX breaks TeX's backward
>> compatibility.
>
> LuaTeX is *explicitly* not 100% compatible with TeX90 in a variety of areas.
>
> Joseph

Further, since LuaTeX is marked as beta, it seems to be that it is
fair to make drastic changes if viewed as having important benefits.

Scott

From skostysh at lyx.org  Mon May 23 00:49:14 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Sun, 22 May 2016 18:49:14 -0400
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
Message-ID: <20160522224914.z222n4blrugc6iib@cotopaxi>

Dear all,

The following example fails to compile with dvilualatex, with or without
the luatex85 package. Is this expected? It compiles without error with
TL 2015.

-----
\documentclass{article}
\usepackage{luatex85}
\usepackage[T1]{fontenc}
\usepackage[latin9]{luainputenc}
\usepackage{hyperref}

\begin{document}
hello
\end{document}
-----

I get the following error:

-----
! unexpected use of \pdffeedback.
\pdftexversion ->\numexpr \pdffeedback 
                                       version\relax 
l.4771 \ifnum\pdftexversion
                         =140 %
-----

By the way, I don't actually use dvilualatex but I have no idea if some
of our users do so that is why I'm interested.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160522/07dfede7/attachment.bin>

From d.p.carlisle at gmail.com  Mon May 23 03:10:07 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 23 May 2016 02:10:07 +0100
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <20160522224914.z222n4blrugc6iib@cotopaxi>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
Message-ID: <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>

On 22 May 2016 at 23:49, Scott Kostyshak <skostysh at lyx.org> wrote:
> Dear all,
>
> The following example fails to compile with dvilualatex, with or without
> the luatex85 package. Is this expected?

Not totally unexpected.

>  It compiles without error with
> TL 2015.
>
> -----
> \documentclass{article}
> \usepackage{luatex85}
> \usepackage[T1]{fontenc}
> \usepackage[latin9]{luainputenc}
> \usepackage{hyperref}
>
> \begin{document}
> hello
> \end{document}
> -----
>
> I get the following error:
>
> -----
> ! unexpected use of \pdffeedback.
> \pdftexversion ->\numexpr \pdffeedback
>                                        version\relax
> l.4771 \ifnum\pdftexversion
>                          =140 %
> -----
>
> By the way, I don't actually use dvilualatex but I have no idea if some
> of our users do so that is why I'm interested.
>
> Scott

Actually more worrying than the fact that it gives an error in
dviluatex is that it does
the wrong thing without error in luatex it's comparing the number to
140 but luatex
sets this (somewhat arbitrarily) to 40 so even when it is set in pdf
mode the numeric
test is meaningless.

the "40" might be an issue for luatex but anyway the main issue is
that hyperref shouldn't
be testing this at all in luatex now. I'll see what I can do.

https://github.com/ho-tex/hyperref/issues


better than this list for hyperref specific issues.



David

From skostysh at lyx.org  Mon May 23 03:35:55 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Sun, 22 May 2016 21:35:55 -0400
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
Message-ID: <20160523013555.dfzxfadr6rq4godi@cotopaxi>

On Mon, May 23, 2016 at 02:10:07AM +0100, David Carlisle wrote:
> On 22 May 2016 at 23:49, Scott Kostyshak <skostysh at lyx.org> wrote:
> > Dear all,
> >
> > The following example fails to compile with dvilualatex, with or without
> > the luatex85 package. Is this expected?
> 
> Not totally unexpected.
> 
> >  It compiles without error with
> > TL 2015.
> >
> > -----
> > \documentclass{article}
> > \usepackage{luatex85}
> > \usepackage[T1]{fontenc}
> > \usepackage[latin9]{luainputenc}
> > \usepackage{hyperref}
> >
> > \begin{document}
> > hello
> > \end{document}
> > -----
> >
> > I get the following error:
> >
> > -----
> > ! unexpected use of \pdffeedback.
> > \pdftexversion ->\numexpr \pdffeedback
> >                                        version\relax
> > l.4771 \ifnum\pdftexversion
> >                          =140 %
> > -----
> >
> > By the way, I don't actually use dvilualatex but I have no idea if some
> > of our users do so that is why I'm interested.
> >
> > Scott
> 
> Actually more worrying than the fact that it gives an error in
> dviluatex is that it does
> the wrong thing without error in luatex it's comparing the number to
> 140 but luatex
> sets this (somewhat arbitrarily) to 40 so even when it is set in pdf
> mode the numeric
> test is meaningless.
> 
> the "40" might be an issue for luatex but anyway the main issue is
> that hyperref shouldn't
> be testing this at all in luatex now. I'll see what I can do.

Thanks for taking a look.

> https://github.com/ho-tex/hyperref/issues
> 
> 
> better than this list for hyperref specific issues.

OK, since hyperref worked well with other engines and it used to work
well in the older LuaTeX version I thought the issue was more likely to
be LuaTeX-specific.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160522/74358042/attachment-0001.bin>

From frank.mittelbach at latex-project.org  Mon May 23 08:05:10 2016
From: frank.mittelbach at latex-project.org (Frank Mittelbach)
Date: Mon, 23 May 2016 08:05:10 +0200
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <20160523013555.dfzxfadr6rq4godi@cotopaxi>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
 <20160523013555.dfzxfadr6rq4godi@cotopaxi>
Message-ID: <57429D96.7070301@latex-project.org>

Am 23.05.16 um 03:35 schrieb Scott Kostyshak:
> OK, since hyperref worked well with other engines and it used to work
> well in the older LuaTeX version I thought the issue was more likely to
> be LuaTeX-specific.

well it is, isn't it? if luatex still maintains such a value but now 
claims it is derived from a much earlier version

From d.p.carlisle at gmail.com  Mon May 23 08:45:27 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 23 May 2016 07:45:27 +0100
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <20160523013555.dfzxfadr6rq4godi@cotopaxi>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
 <20160523013555.dfzxfadr6rq4godi@cotopaxi>
Message-ID: <CAEW6iOg-HK--0ZrHDWoW_mc+_z_jzpNth0U+vpggwbVtCr=LDg@mail.gmail.com>

On 23 May 2016 at 02:35, Scott Kostyshak <skostysh at lyx.org> wrote:


>
> OK, since hyperref worked well with other engines and it used to work
> well in the older LuaTeX version I thought the issue was more likely to
> be LuaTeX-specific.
>
> Scott



As Frank just replied, the fact that luatex returns 40 is an issue
with luatex, but in general
luatex in texlive 2016 is intentionally incompatible with previous
versions so it then falls
on package maintainers to try to keep up. In general they won't be on
this list, except that
the packages involved here (luatex85.sty, pdftexcmds,sty,hyperref,sty)
all seem to involve
a maintainer sat at this keyboard....


David

From luigi.scarso at gmail.com  Mon May 23 09:59:06 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Mon, 23 May 2016 09:59:06 +0200
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
Message-ID: <CAG5iGsDyF70TXPyLvxNeSuKycXc7Y043LthKVGQGrNwxx0h9Yw@mail.gmail.com>

On Mon, May 23, 2016 at 3:10 AM, David Carlisle <d.p.carlisle at gmail.com>
wrote:

> On 22 May 2016 at 23:49, Scott Kostyshak <skostysh at lyx.org> wrote:
> > Dear all,
> >
> > The following example fails to compile with dvilualatex, with or without
> > the luatex85 package. Is this expected?
>
> Not totally unexpected.
>
> >  It compiles without error with
> > TL 2015.
> >
> > -----
> > \documentclass{article}
> > \usepackage{luatex85}
> > \usepackage[T1]{fontenc}
> > \usepackage[latin9]{luainputenc}
> > \usepackage{hyperref}
> >
> > \begin{document}
> > hello
> > \end{document}
> > -----
> >
> > I get the following error:
> >
> > -----
> > ! unexpected use of \pdffeedback.
> > \pdftexversion ->\numexpr \pdffeedback
> >                                        version\relax
> > l.4771 \ifnum\pdftexversion
> >                          =140 %
> > -----
> >
> > By the way, I don't actually use dvilualatex but I have no idea if some
> > of our users do so that is why I'm interested.
> >
> > Scott
>
> Actually more worrying than the fact that it gives an error in
> dviluatex is that it does
> the wrong thing without error in luatex it's comparing the number to
> 140 but luatex
> sets this (somewhat arbitrarily) to 40 so even when it is set in pdf
> mode the numeric
> test is meaningless.
>
> the "40" might be an issue for luatex but anyway the main issue is
> that hyperref shouldn't
> be testing this at all in luatex now. I'll see what I can do.
>
> https://github.com/ho-tex/hyperref/issues
>
>
> better than this list for hyperref specific issues.
>
>
>
> David
>

we have now
/* codes not really needed but cleaner when testing */

#define pdftex_version  40  /* these values will not change any more */
#define pdftex_revision "0" /* these values will not change any more */

and we can change them

#define pdftex_version  140  /* these values will not change any more */
#define pdftex_revision "0" /* these values will not change any more */

but in luatex
a macro package can better do \newcount\pdftexversion \pdftexversion=140
because very likely they will disappear in luatex 1.0 .


-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160523/f52768a1/attachment-0001.html>

From d.p.carlisle at gmail.com  Mon May 23 10:11:04 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 23 May 2016 09:11:04 +0100
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <CAG5iGsDyF70TXPyLvxNeSuKycXc7Y043LthKVGQGrNwxx0h9Yw@mail.gmail.com>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
 <CAG5iGsDyF70TXPyLvxNeSuKycXc7Y043LthKVGQGrNwxx0h9Yw@mail.gmail.com>
Message-ID: <CAEW6iOhd_hQtTp8p3NT5j84FMgoZ3J56bSYPVKQopEqjFmaaJw@mail.gmail.com>

On 23 May 2016 at 08:59, luigi scarso <luigi.scarso at gmail.com> wrote:
>

>
> we have now
> /* codes not really needed but cleaner when testing */
>
> #define pdftex_version  40  /* these values will not change any more */
> #define pdftex_revision "0" /* these values will not change any more */
>
> and we can change them
>
> #define pdftex_version  140  /* these values will not change any more */
> #define pdftex_revision "0" /* these values will not change any more */
>
> but in luatex
> a macro package can better do \newcount\pdftexversion \pdftexversion=140
> because very likely they will disappear in luatex 1.0 .
>
>
> --
> luigi


Yes I think in luatex85.sty we should do

% \pdffeedback version not defined in dvi mode and curiously set to 40
in pdf mode
\protected\def\pdftexversion     {\numexpr 140\relax}
 \def\pdftexrevision    {7}

% \protected\def\pdftexversion     {\numexpr\pdffeedback version\relax}
 %\def\pdftexrevision    {\pdffeedback revision}

but in any case packages shouldn't be testing this in luatex, this is
just to help with the changeover.

So 40 is a bit odd, probably making it 140 or deleting it makes sense.

David



David

From d.p.carlisle at gmail.com  Mon May 23 13:11:54 2016
From: d.p.carlisle at gmail.com (David Carlisle)
Date: Mon, 23 May 2016 12:11:54 +0100
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <20160522224914.z222n4blrugc6iib@cotopaxi>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
Message-ID: <CAEW6iOhAHZ1u5Gmjf2CiZsWoSiyffvsyv--NzsTrFz5mUFhjJw@mail.gmail.com>

On 22 May 2016 at 23:49, Scott Kostyshak <skostysh at lyx.org> wrote:
> Dear all,
>
> The following example fails to compile with dvilualatex, with or without
> the luatex85 package. Is this expected? It compiles without error with
> TL 2015.
>
> -----
> \documentclass{article}
> \usepackage{luatex85}
> \usepackage[T1]{fontenc}
> \usepackage[latin9]{luainputenc}
> \usepackage{hyperref}
>
> \begin{document}
> hello
> \end{document}
> -----
>
> I get the following error:
>
> -----
> ! unexpected use of \pdffeedback.


I have updated pdftexcmds at source to not do that test in luatex, and
the test file now runs without error
in lualatex and dvilualatex with or without the luatex85 package/

https://github.com/ho-tex/oberdiek/commit/36b13d011ffc08945a29275eb4dcca7602f5191c


Also updated luatex85.sty so that \pdftexversion has a usable number
even in dvi mode (so the test would
not give an error even if it had not been avoided)

https://github.com/josephwright/luatex85/commit/e584c63ddf498feadbfc214d91ee7e2099900f61

(Will post to ctan later, after updates for texlive 2016 re-enabled)

David

From skostysh at lyx.org  Tue May 24 00:20:13 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Mon, 23 May 2016 18:20:13 -0400
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <CAEW6iOg-HK--0ZrHDWoW_mc+_z_jzpNth0U+vpggwbVtCr=LDg@mail.gmail.com>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhjjrUmO8vx+NsSVGreSrS3DMBmHyx3DmczfBqbM+Px1A@mail.gmail.com>
 <20160523013555.dfzxfadr6rq4godi@cotopaxi>
 <CAEW6iOg-HK--0ZrHDWoW_mc+_z_jzpNth0U+vpggwbVtCr=LDg@mail.gmail.com>
Message-ID: <20160523222013.j2iycwwuyz25vgu4@cotopaxi>

On Mon, May 23, 2016 at 07:45:27AM +0100, David Carlisle wrote:
> On 23 May 2016 at 02:35, Scott Kostyshak <skostysh at lyx.org> wrote:
> 
> 
> >
> > OK, since hyperref worked well with other engines and it used to work
> > well in the older LuaTeX version I thought the issue was more likely to
> > be LuaTeX-specific.
> >
> > Scott
> 
> 
> 
> As Frank just replied, the fact that luatex returns 40 is an issue
> with luatex, but in general
> luatex in texlive 2016 is intentionally incompatible with previous
> versions so it then falls
> on package maintainers to try to keep up. In general they won't be on
> this list, except that
> the packages involved here (luatex85.sty, pdftexcmds,sty,hyperref,sty)
> all seem to involve
> a maintainer sat at this keyboard....

Makes sense. I will try to figure out the best places to report each
change of behavior that I come across. What really makes it complicated
is my ignorance. I do not know much about the internals of LaTeX, much
less LuaTeX. But as I learn more I'll get better about having a good
guess for where to report. Your explanations now and in the past have
helped my understanding and are much appreciated. Thanks for your
patience and help.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160523/a399b6fc/attachment.bin>

From skostysh at lyx.org  Tue May 24 00:22:42 2016
From: skostysh at lyx.org (Scott Kostyshak)
Date: Mon, 23 May 2016 18:22:42 -0400
Subject: [luatex] dvilualatex fails with hyperref in TL 2016 pretest
In-Reply-To: <CAEW6iOhAHZ1u5Gmjf2CiZsWoSiyffvsyv--NzsTrFz5mUFhjJw@mail.gmail.com>
References: <20160522224914.z222n4blrugc6iib@cotopaxi>
 <CAEW6iOhAHZ1u5Gmjf2CiZsWoSiyffvsyv--NzsTrFz5mUFhjJw@mail.gmail.com>
Message-ID: <20160523222242.wtb2npsyhuajlzl4@cotopaxi>

On Mon, May 23, 2016 at 12:11:54PM +0100, David Carlisle wrote:
> On 22 May 2016 at 23:49, Scott Kostyshak <skostysh at lyx.org> wrote:
> > Dear all,
> >
> > The following example fails to compile with dvilualatex, with or without
> > the luatex85 package. Is this expected? It compiles without error with
> > TL 2015.
> >
> > -----
> > \documentclass{article}
> > \usepackage{luatex85}
> > \usepackage[T1]{fontenc}
> > \usepackage[latin9]{luainputenc}
> > \usepackage{hyperref}
> >
> > \begin{document}
> > hello
> > \end{document}
> > -----
> >
> > I get the following error:
> >
> > -----
> > ! unexpected use of \pdffeedback.
> 
> 
> I have updated pdftexcmds at source to not do that test in luatex, and
> the test file now runs without error
> in lualatex and dvilualatex with or without the luatex85 package/
> 
> https://github.com/ho-tex/oberdiek/commit/36b13d011ffc08945a29275eb4dcca7602f5191c
> 
> 
> Also updated luatex85.sty so that \pdftexversion has a usable number
> even in dvi mode (so the test would
> not give an error even if it had not been avoided)
> 
> https://github.com/josephwright/luatex85/commit/e584c63ddf498feadbfc214d91ee7e2099900f61
> 
> (Will post to ctan later, after updates for texlive 2016 re-enabled)

Thanks for the quick actions, David!

By the way, if you ever have a patch and would like for me to apply it
locally and run my large set of tests to see if any compilations go from
passing to failing, feel free to let me know.

Scott
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://tug.org/pipermail/luatex/attachments/20160523/ac8ff472/attachment-0001.bin>

From H.vanderMeer at uva.nl  Wed May 25 12:12:16 2016
From: H.vanderMeer at uva.nl (Meer, Hans van der)
Date: Wed, 25 May 2016 10:12:16 +0000
Subject: [luatex] upcoming release
In-Reply-To: <5613E0E1.4000509@wxs.nl>
References: <4F6AB221-637C-4103-9A54-3EF87482545D@gmail.com>
 <560E9EA7.4010406@wxs.nl> <22031.10763.680030.803059@zaphod.ms25.net>
 <56105858.5070203@wxs.nl> <22032.38297.127059.511422@zaphod.ms25.net>
 <5610EDF6.9010306@wxs.nl> <5613E0E1.4000509@wxs.nl>
Message-ID: <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>


> On 06 Oct 2015, at 16:55, Hans Hagen <pragma at wxs.nl> wrote:
> 
> \let\pdftexversion \luatexversion

The \luatexversion macro troubles me.

\starttext
  \luatexversion
\stoptext

gives the error: You can't use `\luatexversion' in vertical mode

It cannot be put into \hbox, \vbox, \framed or as \par\luatexversion\par without generating an error.
In contrast \contextversion behaves very friendly.
Can they made both to behave in the same way? The friendly one of course ;-)

By the way, this is with LuaTeX, Version 0.95.0. 

Hans van der Meer






From luigi.scarso at gmail.com  Wed May 25 12:19:11 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Wed, 25 May 2016 12:19:11 +0200
Subject: [luatex] upcoming release
In-Reply-To: <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>
References: <4F6AB221-637C-4103-9A54-3EF87482545D@gmail.com>
 <560E9EA7.4010406@wxs.nl>	<22031.10763.680030.803059@zaphod.ms25.net>
 <56105858.5070203@wxs.nl>	<22032.38297.127059.511422@zaphod.ms25.net>
 <5610EDF6.9010306@wxs.nl>	<5613E0E1.4000509@wxs.nl>
 <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>
Message-ID: <CAG5iGsAucJ6XMrBEMikPT13te1rq_n068rGEO9ThUq3S8eQmrQ@mail.gmail.com>

On Wed, May 25, 2016 at 12:12 PM, Meer, Hans van der <H.vanderMeer at uva.nl>
wrote:

>
> > On 06 Oct 2015, at 16:55, Hans Hagen <pragma at wxs.nl> wrote:
> >
> > \let\pdftexversion \luatexversion
>
> The \luatexversion macro troubles me.
>
> \starttext
>   \luatexversion
> \stoptext
>
> gives the error: You can't use `\luatexversion' in vertical mode
>
>
\starttext
\the\luatexversion
\stoptext



-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160525/5f125f50/attachment.html>

From lists at homerow.info  Wed May 25 12:29:50 2016
From: lists at homerow.info (Marco Patzer)
Date: Wed, 25 May 2016 12:29:50 +0200
Subject: [luatex] upcoming release
In-Reply-To: <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>
References: <4F6AB221-637C-4103-9A54-3EF87482545D@gmail.com>
 <560E9EA7.4010406@wxs.nl>	<22031.10763.680030.803059@zaphod.ms25.net>
 <56105858.5070203@wxs.nl>	<22032.38297.127059.511422@zaphod.ms25.net>
 <5610EDF6.9010306@wxs.nl>	<5613E0E1.4000509@wxs.nl>
 <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>
Message-ID: <20160525122950.395bbe76@homerow>

On Wed, 25 May 2016 10:12:16 +0000
"Meer, Hans van der" <H.vanderMeer at uva.nl> wrote:

> > On 06 Oct 2015, at 16:55, Hans Hagen <pragma at wxs.nl> wrote:
> > 
> > \let\pdftexversion \luatexversion  
> 
> The \luatexversion macro troubles me.
> 
> \starttext
>   \luatexversion
> \stoptext
> 
> gives the error: You can't use `\luatexversion' in vertical mode

\starttext
  \the\luatexversion
\stoptext

Marco

From luatex at nililand.de  Wed May 25 13:45:58 2016
From: luatex at nililand.de (Ulrike Fischer)
Date: Wed, 25 May 2016 13:45:58 +0200
Subject: [luatex] luatex documentation typos: whatsits <-> whatits
Message-ID: <16pdkb5tfslje$.dlg@nililand.de>


There are quite a number of "whatits" in the documentation. 

-- 
Ulrike Fischer 
http://www.troubleshooting-tex.de/


From H.vanderMeer at uva.nl  Wed May 25 13:52:27 2016
From: H.vanderMeer at uva.nl (Meer, Hans van der)
Date: Wed, 25 May 2016 11:52:27 +0000
Subject: [luatex] upcoming release
In-Reply-To: <20160525122950.395bbe76@homerow>
References: <4F6AB221-637C-4103-9A54-3EF87482545D@gmail.com>
 <560E9EA7.4010406@wxs.nl> <22031.10763.680030.803059@zaphod.ms25.net>
 <56105858.5070203@wxs.nl> <22032.38297.127059.511422@zaphod.ms25.net>
 <5610EDF6.9010306@wxs.nl> <5613E0E1.4000509@wxs.nl>
 <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>
 <20160525122950.395bbe76@homerow>
Message-ID: <EEFBD7DD-7FA7-4E55-8D2B-52EBBC1C86FE@uva.nl>


> On 25 May 2016, at 12:29, Marco Patzer <lists at homerow.info> wrote:
> 
> On Wed, 25 May 2016 10:12:16 +0000
> "Meer, Hans van der" <H.vanderMeer at uva.nl> wrote:
> 
>>> On 06 Oct 2015, at 16:55, Hans Hagen <pragma at wxs.nl> wrote:
>>> 
>>> \let\pdftexversion \luatexversion  
>> 
>> The \luatexversion macro troubles me.
>> 
>> \starttext
>>  \luatexversion
>> \stoptext
>> 
>> gives the error: You can't use `\luatexversion' in vertical mode
> 
> \starttext
>  \the\luatexversion
> \stoptext

I was fooled by the lookalike \contextversion.
Still it is a bit strange that one has to call "\the\luatexversion" whereas for the revisionnumber just "\luatexrevision" is the call to place.
Is it a viable request to ask for a change here and let "\luatexversion" have the effect of what now "\the\luatexversion" does?
I guess this means to change the name of a register and defining \luatexversion as the access to that register.

Hans van der Meer






From pragma at wxs.nl  Wed May 25 14:22:35 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 25 May 2016 14:22:35 +0200
Subject: [luatex] upcoming release
In-Reply-To: <EEFBD7DD-7FA7-4E55-8D2B-52EBBC1C86FE@uva.nl>
References: <4F6AB221-637C-4103-9A54-3EF87482545D@gmail.com>
 <560E9EA7.4010406@wxs.nl> <22031.10763.680030.803059@zaphod.ms25.net>
 <56105858.5070203@wxs.nl> <22032.38297.127059.511422@zaphod.ms25.net>
 <5610EDF6.9010306@wxs.nl> <5613E0E1.4000509@wxs.nl>
 <ECB807F6-0AA6-490A-B697-66F09A857C8D@uva.nl>
 <20160525122950.395bbe76@homerow>
 <EEFBD7DD-7FA7-4E55-8D2B-52EBBC1C86FE@uva.nl>
Message-ID: <d14f8ba1-772f-223e-e6f3-4ceaa0c35329@wxs.nl>

On 5/25/2016 1:52 PM, Meer, Hans van der wrote:
>
>> On 25 May 2016, at 12:29, Marco Patzer <lists at homerow.info> wrote:
>>
>> On Wed, 25 May 2016 10:12:16 +0000
>> "Meer, Hans van der" <H.vanderMeer at uva.nl> wrote:
>>
>>>> On 06 Oct 2015, at 16:55, Hans Hagen <pragma at wxs.nl> wrote:
>>>>
>>>> \let\pdftexversion \luatexversion
>>>
>>> The \luatexversion macro troubles me.
>>>
>>> \starttext
>>>  \luatexversion
>>> \stoptext
>>>
>>> gives the error: You can't use `\luatexversion' in vertical mode
>>
>> \starttext
>>  \the\luatexversion
>> \stoptext
>
> I was fooled by the lookalike \contextversion.
> Still it is a bit strange that one has to call "\the\luatexversion" whereas for the revisionnumber just "\luatexrevision" is the call to place.
> Is it a viable request to ask for a change here and let "\luatexversion" have the effect of what now "\the\luatexversion" does?
> I guess this means to change the name of a register and defining \luatexversion as the access to that register.

nothing will change ... it has been that way with version numbers since 
ages (dates from the time that revision could also be a letter or whatever)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From luigi.scarso at gmail.com  Wed May 25 14:40:37 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Wed, 25 May 2016 14:40:37 +0200
Subject: [luatex] luatex documentation typos: whatsits <-> whatits
In-Reply-To: <16pdkb5tfslje$.dlg@nililand.de>
References: <16pdkb5tfslje$.dlg@nililand.de>
Message-ID: <CAG5iGsC26VrYeDvKjeDCRfK5S8UwXCU_G7Ok=7RNuOhdGfxDLQ@mail.gmail.com>

On Wed, May 25, 2016 at 1:45 PM, Ulrike Fischer <luatex at nililand.de> wrote:

>
> There are quite a number of "whatits" in the documentation.
>
> --
> Ulrike Fischer
> http://www.troubleshooting-tex.de/
>
> Thank you for the report,
fixed in experimental

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://tug.org/pipermail/luatex/attachments/20160525/2ace0d3e/attachment.html>

