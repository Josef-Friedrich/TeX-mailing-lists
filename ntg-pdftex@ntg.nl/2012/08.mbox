From pdftex-bugs at sarovar.org  Mon Aug  6 15:29:04 2012
From: pdftex-bugs at sarovar.org (pdftex-bugs at sarovar.org)
Date: Mon, 06 Aug 2012 18:59:04 +0530
Subject: [NTG-pdftex] =?utf-8?q?=5Bpdftex-Bugs=5D=5B4352=5D_=22Badly_forme?=
	=?utf-8?q?d_number=22_errors?=
Message-ID: <E1SyNMm-0002tB-GC@sarovar.org>

Bugs item #4352, was opened at 2012-08-06 15:29
Status: Open
Priority: 3
Submitted By: Emmanuel Beffara (xunam)
Assigned to: Nobody (None)
Summary: "Badly formed number" errors 
Category: Fonts
Group: None
Resolution: None


Initial Comment:
For some time (can't remember precisely when it started) I have been getting errors for PDFs using my "French Cursive" font family. There are many things involved when this bug happens, so it is hard to pinpoint exactly where it comes from, but I have the impression it might happen in pdfTeX.

It happens with PDF documents generated by pdfTeX using some particular fonts. The symptom is error messages of the form

    Error (2319): Badly formatted number

when viewing the PDFs using any software that uses the Poppler library. The number in the messages is variable. Despite these messages, documents are properly displayed and printed.

Any document using the current CTAN version of frcursive exhibits this problem. I attach a minimal example of a font that also produces the error. The procedure of the included Makefile is:
 1. make the PFB font and the TFM file from the MF source, using mftrace
 2. compile a minimalistic document with pdftex
 3. convert it to PS using pdftops (which uses poppler)
Step 3 produces the error message.

I should add that I experimented a bit on this minimal example:
  - if I make the PDF using tex and dvipdfm, the error disappears (which is why I though pdftex was part of the bug)
  - if I change the character width from -0.111 pt# to e.g. 0.111 pt# or -0.11 pt#, the error disappears

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=4352&group_id=106

From pdftex-bugs at sarovar.org  Mon Aug  6 20:18:06 2012
From: pdftex-bugs at sarovar.org (pdftex-bugs at sarovar.org)
Date: Mon, 06 Aug 2012 23:48:06 +0530
Subject: [NTG-pdftex] =?utf-8?q?=5Bpdftex-Bugs=5D=5B4352=5D_=22Badly_forme?=
	=?utf-8?q?d_number=22_errors?=
Message-ID: <E1SyRsU-0006FJ-1q@sarovar.org>

Bugs item #4352, was opened at 2012-08-06 15:29
Status: Open
Priority: 3
Submitted By: Emmanuel Beffara (xunam)
Assigned to: Nobody (None)
Summary: "Badly formed number" errors 
Category: Fonts
Group: None
Resolution: None


Initial Comment:
For some time (can't remember precisely when it started) I have been getting errors for PDFs using my "French Cursive" font family. There are many things involved when this bug happens, so it is hard to pinpoint exactly where it comes from, but I have the impression it might happen in pdfTeX.

It happens with PDF documents generated by pdfTeX using some particular fonts. The symptom is error messages of the form

    Error (2319): Badly formatted number

when viewing the PDFs using any software that uses the Poppler library. The number in the messages is variable. Despite these messages, documents are properly displayed and printed.

Any document using the current CTAN version of frcursive exhibits this problem. I attach a minimal example of a font that also produces the error. The procedure of the included Makefile is:
 1. make the PFB font and the TFM file from the MF source, using mftrace
 2. compile a minimalistic document with pdftex
 3. convert it to PS using pdftops (which uses poppler)
Step 3 produces the error message.

I should add that I experimented a bit on this minimal example:
  - if I make the PDF using tex and dvipdfm, the error disappears (which is why I though pdftex was part of the bug)
  - if I change the character width from -0.111 pt# to e.g. 0.111 pt# or -0.11 pt#, the error disappears

----------------------------------------------------------------------

Comment By: Reinhard Kotucha (reinhard)
Date: 2012-08-06 20:18

Message:
The file foo.pfb contains much too large values for hsbw:

  2 index /CharStrings 2 dict dup begin
  /.notdef {
	0 32757 hsbw
	endchar
	} ND
  /a {
	0 32757 hsbw
	endchar
	} ND

The first argument of hsbw is the side bearing, usually < 100, the second argument denotes the glyph width, usually < 1000.

Since 32757 > 2^16, it might be an implementation limit of some programs.

Furthermore, when I extract and disassemble the font included in the resulting PDF file, the result is exactly the same.  Hence pdftex includes it "as is".  I suppose that the problem either originates from mftrace or the metafont sources.

You can use the program t1disasm in order to  disassemble fonts.  See also:

 http://partners.adobe.com/public/developer/en/font/T1_SPEC.PDF

Regards,
  Reinhard


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=4352&group_id=106

From pdftex-bugs at sarovar.org  Tue Aug  7 07:35:30 2012
From: pdftex-bugs at sarovar.org (pdftex-bugs at sarovar.org)
Date: Tue, 07 Aug 2012 11:05:30 +0530
Subject: [NTG-pdftex] =?utf-8?q?=5Bpdftex-Bugs=5D=5B4352=5D_=22Badly_forme?=
	=?utf-8?q?d_number=22_errors?=
Message-ID: <E1SycS2-0003Cz-73@sarovar.org>

Bugs item #4352, was opened at 2012-08-06 15:29
Status: Open
Priority: 3
Submitted By: Emmanuel Beffara (xunam)
Assigned to: Nobody (None)
Summary: "Badly formed number" errors 
Category: Fonts
Group: None
Resolution: None


Initial Comment:
For some time (can't remember precisely when it started) I have been getting errors for PDFs using my "French Cursive" font family. There are many things involved when this bug happens, so it is hard to pinpoint exactly where it comes from, but I have the impression it might happen in pdfTeX.

It happens with PDF documents generated by pdfTeX using some particular fonts. The symptom is error messages of the form

    Error (2319): Badly formatted number

when viewing the PDFs using any software that uses the Poppler library. The number in the messages is variable. Despite these messages, documents are properly displayed and printed.

Any document using the current CTAN version of frcursive exhibits this problem. I attach a minimal example of a font that also produces the error. The procedure of the included Makefile is:
 1. make the PFB font and the TFM file from the MF source, using mftrace
 2. compile a minimalistic document with pdftex
 3. convert it to PS using pdftops (which uses poppler)
Step 3 produces the error message.

I should add that I experimented a bit on this minimal example:
  - if I make the PDF using tex and dvipdfm, the error disappears (which is why I though pdftex was part of the bug)
  - if I change the character width from -0.111 pt# to e.g. 0.111 pt# or -0.11 pt#, the error disappears

----------------------------------------------------------------------

Comment By: Emmanuel Beffara (xunam)
Date: 2012-08-07 07:35

Message:
Indeed, this glyph width is wrong. The intended value is actually negative (reading it as 2^15 - 11 gives a more reasonable value of -11, assuming negative widths are allowed, which seems to be the case reading the T1 spec). So the problem here is probably on the side of mftrace.

Nevertheless, this is not what causes the problem I originally described. With the example I uploaded, if I change the width in the metafont source from -0.111pt# to -0.11pt#, then the "Badly formatted number" error disappears but the PFB file is exactly the same (not considering creation dates) and t1disasm shows the same (invalid) width. The only difference is in the TFM file. Hence I do think pdftex does something wrong. 

With character width -0.111pt#, tftopl on the TFM file yields

    (CHARACTER C a
       (CHARWD R -0.011099)
       )

(with width -0.11pt# we get -0.011 here) and 'pdfshow t.pdf 5' (using pdfshow from the mupdf tools) yields

    5 0 obj
    <<
      /Type /ObjStm
      /N 7
      /First 40
      /Length 342
      /Filter /FlateDecode
    >>
    stream
[...]
    <<
    /Font << /F51 4 0 R >>
    /ProcSet [ /PDF /Text ]
    >>
    [-11.-1]
[...]

which indeed looks wrong. With width -0.11pt# this "-11.-1" is replaced by "0".
If I make the PDF using tex and dvipdfm, disassembling the corresponding object in the final PDF shows that the value written by dvipdfm is "-11.1".

----------------------------------------------------------------------

Comment By: Reinhard Kotucha (reinhard)
Date: 2012-08-06 20:18

Message:
The file foo.pfb contains much too large values for hsbw:

  2 index /CharStrings 2 dict dup begin
  /.notdef {
	0 32757 hsbw
	endchar
	} ND
  /a {
	0 32757 hsbw
	endchar
	} ND

The first argument of hsbw is the side bearing, usually < 100, the second argument denotes the glyph width, usually < 1000.

Since 32757 > 2^16, it might be an implementation limit of some programs.

Furthermore, when I extract and disassemble the font included in the resulting PDF file, the result is exactly the same.  Hence pdftex includes it "as is".  I suppose that the problem either originates from mftrace or the metafont sources.

You can use the program t1disasm in order to  disassemble fonts.  See also:

 http://partners.adobe.com/public/developer/en/font/T1_SPEC.PDF

Regards,
  Reinhard


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=4352&group_id=106

From pdftex-bugs at sarovar.org  Tue Aug 21 00:41:21 2012
From: pdftex-bugs at sarovar.org (pdftex-bugs at sarovar.org)
Date: Tue, 21 Aug 2012 04:11:21 +0530
Subject: [NTG-pdftex] =?utf-8?q?=5Bpdftex-Bugs=5D=5B4354=5D_Wrong_stream_l?=
	=?utf-8?q?ength_if_=5Cpdfcompresslevel=3D0?=
Message-ID: <E1T3aev-000540-MI@sarovar.org>

Bugs item #4354, was opened at 2012-08-21 00:41
Status: Open
Priority: 3
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Wrong stream length if \pdfcompresslevel=0 
Category: None
Group: None
Resolution: None


Initial Comment:
The patch is based on pdftex 3.1415926-1.50.0-alpha-20080414-2.2
(svn checkout http://foundry.supelec.fr/svn/pdftex/trunk).

It fixes:

* If \pdfcompresslevel=0, then some lengths are wrong
  because of final newline.

* New lines after "obj" and before "endobj" for dict objects added.
  PDF/A wants this in "6.1.8 Indirect objects".

Test:

\pdfobjcompresslevel=0
\pdfcompresslevel=0
\documentclass{article}
\usepackage[pdfa]{hyperref}
\usepackage{bookmark}
\begin{document}
\tableofcontents
\section{Hello World}
\label{sec:hello}
See \ref{sec:hello}.
\end{document}

Fix: pdftex.web.diff patches pdftexdir/pdftex.web.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=4354&group_id=106

From pdftex-bugs at sarovar.org  Thu Aug 23 22:35:20 2012
From: pdftex-bugs at sarovar.org (pdftex-bugs at sarovar.org)
Date: Fri, 24 Aug 2012 02:05:20 +0530
Subject: [NTG-pdftex] =?utf-8?q?=5Bpdftex-Bugs=5D=5B4355=5D_Problems_in_fo?=
	=?utf-8?q?nt_installation?=
Message-ID: <E1T4e7c-0002RK-BF@sarovar.org>

Bugs item #4355, was opened at 2012-08-23 17:35
Status: Open
Priority: 3
Submitted By: Hamilton Bueno (hamiltonpb)
Assigned to: Nobody (None)
Summary: Problems in font installation 
Category: None
Group: None
Resolution: None


Initial Comment:
After installation of MathPro 2 fonts (mtpro2), I am having problems concerning pdflatex. If I run Winedt/XeLatex/Miktex (Windows) or TexWorks/XeLateX/TexLive (Ubuntu), I have no problems (but only if I use latin1 encoding). See attached file. 

However, if I change to PdfLatex I run into problems using Texworks/PdfLatex/TexLive (Ubuntu): I get the following message:

This is pdfTeX, Version 3.1415926-1.40.10 (TeX Live 2009/Debian)
entering extended mode
(./testMTP2LaTeX.tex
LaTeX2e <2009/09/24>
Babel <v3.8l> and hyphenation patterns for english, usenglishmax, dumylang, noh
yphenation, portuguese, loaded.
(/usr/share/texmf-texlive/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(/usr/share/texmf-texlive/tex/latex/base/size10.clo))
(/usr/local/share/texmf/tex/latex/mtpro2.sty) (./testMTP2LaTeX.aux) [1{/var/lib
/texmf/fonts/map/pdftex/updmap/pdftex.map}] [2] [3] (./testMTP2LaTeX.aux)
kpathsea: Running mktexpk --mfmode / --bdpi 600 --mag 4+0/600 --dpi 2400 mt2exf
mktexpk: don't know how to create bitmap font for mt2exf.
kpathsea: Appending font creation commands to missfont.log.
 )
!pdfTeX error: /usr/bin/pdflatex (file mt2exf): Font mt2exf at 2400 not found
 ==> Fatal error occurred, no output PDF file produced!

Under Windows it is weird: I get the message that the system can't find the file it is running...

Many thanks, 
Hamilton Bueno


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=4355&group_id=106

