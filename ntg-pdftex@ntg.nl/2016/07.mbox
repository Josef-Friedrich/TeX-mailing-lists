From pali.rohar at gmail.com  Wed Jul  6 14:26:20 2016
From: pali.rohar at gmail.com (Pali =?utf-8?q?Roh=C3=A1r?=)
Date: Wed, 6 Jul 2016 14:26:20 +0200
Subject: [NTG-pdftex] [PATCH v3] pdftex - Add support for encfile and
	\pdfgentounicode for PK fonts
Message-ID: <201607061426.20338@pali>

... continued thread "[pdftex] pdftex - Encoding for metafont PK fonts"

This patch allows to specify encoding file also for bitmap PK fonts 
(generated by MetaFont) and add support for \pdfgentounicode primitive 
for these fonts.

Example for csb12 (CSFonts, Latin 2 encoding):

\nopagenumbers
\pdfmapline{+csb12 <csr.enc}
\pdfglyphtounicode{ccaron}{010D}
\pdfgentounicode=1
\font\csb=csb12
\csb \char232
\bye

Char 232 (0xE8) in font csb12 is 'Ä' (LATIN SMALL LETTER C WITH CARON) 
and glyph name for 'Ä' is /ccaron. Unicode character is 0+010D.

Note that U+OOE8 (decimal 232) is 'Ã¨' (LATIN SMALL LETTER E WITH GRAVE) 
which is reason why encoding file (csr.enc) is needed. Unicode is 
extension of Latin 1 (character positions 127-255 are same) so this is 
reason why Latin 1 PK fonts works fine without encoding files...

In V3 version of patch I added check for duplicate glyph names to 
prevent generating incorrect PDF files. Duplicates of glyph names are 
not used and default glyph name used by pdftex "\a<number>" is used as 
before. And I added small extension to pdftex-t.tex documentation as 
Karl Berry wanted.

-- 
Pali RohÃ¡r
pali.rohar at gmail.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdftex-pkfonts-encfile-tounicode-v3.patch
Type: text/x-patch
Size: 6094 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/ntg-pdftex/attachments/20160706/6fb4efc0/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdftex-t.tex-pkfonts-encfile.patch
Type: text/x-patch
Size: 541 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/ntg-pdftex/attachments/20160706/6fb4efc0/attachment-0001.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <http://mailman.ntg.nl/pipermail/ntg-pdftex/attachments/20160706/6fb4efc0/attachment.sig>

From karl at freefriends.org  Wed Jul  6 23:18:44 2016
From: karl at freefriends.org (Karl Berry)
Date: Wed, 6 Jul 2016 21:18:44 GMT
Subject: [NTG-pdftex] [PATCH v3] pdftex - Add support for encfile and
	\pdfgentounicode for PK fonts
In-Reply-To: <201607061426.20338@pali>
Message-ID: <201607062118.u66LIiG8022545@freefriends.org>

    \pdfmapline{+csb12 <csr.enc}

Thanks for the updated patch.  (It's usually better to just send patches
to ntg-pdftex instead of cross-posting.)

    \pdfmapline{+csb12 <csr.enc}

Thanks for the example.  But I have to ask: if there's any chance of
your making an example that uses some MF font that is in TeX Live (e.g.,
laorm10.mf -- Cyrillic (meta)fonts that don't exist in Type 1), that
would be highly useful, since clearly I cannot run the example with your
personal fonts.

If you don't want to, that's ok, I'll get to it eventually.  --best, karl.

From pali.rohar at gmail.com  Sun Jul 10 17:00:30 2016
From: pali.rohar at gmail.com (Pali =?utf-8?q?Roh=C3=A1r?=)
Date: Sun, 10 Jul 2016 17:00:30 +0200
Subject: [NTG-pdftex] [PATCH v3] pdftex - Add support for encfile and
	\pdfgentounicode for PK fonts
In-Reply-To: <201607062118.u66LIiG8022545@freefriends.org>
References: <201607062118.u66LIiG8022545@freefriends.org>
Message-ID: <201607101700.30320@pali>

On Wednesday 06 July 2016 23:18:44 Karl Berry wrote:
>     \pdfmapline{+csb12 <csr.enc}
> 
> Thanks for the updated patch.  (It's usually better to just send
> patches to ntg-pdftex instead of cross-posting.)
> 
>     \pdfmapline{+csb12 <csr.enc}
> 
> Thanks for the example.  But I have to ask: if there's any chance of
> your making an example that uses some MF font that is in TeX Live
> (e.g., laorm10.mf -- Cyrillic (meta)fonts that don't exist in Type
> 1), that would be highly useful, since clearly I cannot run the
> example with your personal fonts.
> 
> If you don't want to, that's ok, I'll get to it eventually.  --best,
> karl.

Hi! Here is example with cmb12 and olsl12 fonts. Those ara available in 
texlive-fonts-extra package on Debian. I hope that texnansx.enc contains 
correct encoding vector for those fonts. It is available in texlive-base 
package on Debian. Here "ffi" is ligature and so it is one (non Latin1) 
character.

\nopagenumbers
\input glyphtounicode
\pdfgentounicode=1
\pdfmapline{+olsl12 <texnansx.enc}
\pdfmapline{+cmb12 <texnansx.enc}
\font\olsl=olsl12
\font\cmb=olsl12
\olsl ffi \cmb ffi
\bye

-- 
Pali RohÃ¡r
pali.rohar at gmail.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <http://mailman.ntg.nl/pipermail/ntg-pdftex/attachments/20160710/458d6fd5/attachment.sig>

