From ms@artcom-gmbh.de  Wed Feb  5 16:19:53 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 5 Feb 2003 17:19:53 +0100
Subject: [NTG-pdftex] Link to pdftex.exe on www.pdftex.org
Message-ID: <20030205161953.GV16880@artcom8.artcom-gmbh.de>

Fabrice,
www.pdftex.org currently has links to the binaries of pdf{e}TeX
for most operating systems. I'm a bit confused about the size of
win32/pdftex.exe and fear that most of pdftex is hidden in some
dll. Is it even possible to get a new pdfTeX for win32 by
downloading only some files and putting them into a TL7
installation? And which files would that be?

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Fri Feb  7 16:14:25 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Fri, 7 Feb 2003 17:14:25 +0100
Subject: [NTG-pdftex] 1.10b
Message-ID: <20030207161425.GN16880@artcom8.artcom-gmbh.de>

Hi,
I'd like to continue developement as there are at least two bugs
that need fixing:
- the patch regarding PDF:-specials
- pdftex currently only looks at the filename to detect the
  filetype. That makes it impossible to include a pdf named other
  than .pdf

Can we resume working in source.developement without an immediate
distribution of intermediate versions via web2c et.al.?

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From pragma@wxs.nl  Fri Feb  7 16:37:07 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Fri, 07 Feb 2003 17:37:07 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030207161425.GN16880@artcom8.artcom-gmbh.de>
Message-ID: <5.1.0.14.1.20030207173615.03b44058@server-1>

At 05:14 PM 2/7/2003 +0100, Martin Schroeder wrote:
>Hi,
>I'd like to continue developement as there are at least two bugs
>that need fixing:
>- the patch regarding PDF:-specials
>- pdftex currently only looks at the filename to detect the
>   filetype. That makes it impossible to include a pdf named other
>   than .pdf
>
>Can we resume working in source.developement without an immediate
>distribution of intermediate versions via web2c et.al.?

also on the todo list:

- later map entries may overload preceding ones without annoying message
- map file loading after first page

Hans

-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From te@dbs.uni-hannover.de  Fri Feb  7 18:51:27 2003
From: te@dbs.uni-hannover.de (Thomas Esser)
Date: Fri, 7 Feb 2003 19:51:27 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: Your message of Fri, 07 Feb 2003 17:37:07 +0100
 <5.1.0.14.1.20030207173615.03b44058@server-1>
References: <20030207161425.GN16880@artcom8.artcom-gmbh.de> <5.1.0.14.1.20030207173615.03b44058@server-1>
Message-ID: <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de>

> also on the todo list:

What about the things that Heiko Oberdieck has proposed:
  http://omnibus.uni-freiburg.de/~oberdiek/pdftex.html

And I remember that bug one bug was reported after pdftex-1.10a was
declared "frozen". That bug was even approved by Thanh...

Thomas

From hartmut_henkel@gmx.de  Fri Feb  7 19:48:23 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Fri, 7 Feb 2003 20:48:23 +0100 (CET)
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <5.1.0.14.1.20030207173615.03b44058@server-1>
Message-ID: <Pine.LNX.4.44.0302072043240.2698-100000@hahepc1.hahe>

On Fri, 7 Feb 2003, Hans Hagen wrote:

> also on the todo list:
> - later map entries may overload preceding ones without annoying message
> Hans

...and probably getting myfonts.map precedence in current dir over more
global fontmap files (I tried a patch on this), to get it working
similarily to dvips. And I would remove the warning completely; it's
also not issued by dvips.

Greetings Hartmut


From hartmut_henkel@gmx.de  Sat Feb  8 15:15:18 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Sat, 8 Feb 2003 16:15:18 +0100 (CET)
Subject: [NTG-pdftex] pdfximage does not trigger page
In-Reply-To: <Pine.LNX.4.44.0302072043240.2698-100000@hahepc1.hahe>
Message-ID: <Pine.LNX.4.44.0302081604560.8040-100000@hahepc1.hahe>

Funny effect: Trying to include two pages of a pdf document on separate
pages, with \vfill\eject inbetween...

\pdfximage width \hsize page 5 {AnnualReport.pdf}
\pdfrefximage\pdflastximage
\vfill\eject
\pdfximage width \hsize page 10 {AnnualReport.pdf}
\pdfrefximage\pdflastximage
\bye

...produces only one page:

This is pdfTeX, Version 3.14159-1.10a (Web2C 7.4.5)
(./x.tex{/usr/local/teTeX/share/texmf/pdftex/config/pdftex.cfg}
Overfull \vbox (598.49954pt too high) has occurred while \output is
active
[1{/usr/local/teTeX/share/texmf/dvips/config/pdftex.map}
Warning: pdftex (file myfonts.map): cannot open font map file
 <./AnnualReport.pdf> <./AnnualReport.pdf>] )
(see the transcript file for additional
information){/usr/local/teTeX/share/tex
mf/dvips/tetex/f7b6d320.enc}</usr/local/teTeX/share/texmf/fonts/type1/bluesky/c
m/cmr10.pfb>
Output written on x.pdf (1 page, 196748 bytes).
Transcript written on x.log.

Both included pages appear on output page 1! Obviously the 1st page was
not detected to be anything printable. Is this ok?

When I put in addition a real letter on the 1st page, e. g. by...

a\vfill\eject

...I get the desired two pages:
 <./AnnualReport.pdf>] [2 <./AnnualReport.pdf>] )

Greetings Hartmut


From The Thanh Han <hanthethanh@fptnet.com.vn>  Sat Feb  8 01:24:09 2003
From: The Thanh Han <hanthethanh@fptnet.com.vn> (The Thanh Han)
Date: Sat, 8 Feb 2003 08:24:09 +0700
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <Pine.LNX.4.44.0302072043240.2698-100000@hahepc1.hahe>
References: <5.1.0.14.1.20030207173615.03b44058@server-1> <Pine.LNX.4.44.0302072043240.2698-100000@hahepc1.hahe>
Message-ID: <20030208012409.GA2401@pc.thanh.home>

uf, so many things to do.

Please give me a few more months -- I am *really* overloaded now.

Regards,
Thanh

On Fri, Feb 07, 2003 at 08:48:23PM +0100, Hartmut Henkel wrote:
> On Fri, 7 Feb 2003, Hans Hagen wrote:
> 
> > also on the todo list:
> > - later map entries may overload preceding ones without annoying message
> > Hans
> 
> ...and probably getting myfonts.map precedence in current dir over more
> global fontmap files (I tried a patch on this), to get it working
> similarily to dvips. And I would remove the warning completely; it's
> also not issued by dvips.
> 
> Greetings Hartmut
> 
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex@ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex

From The Thanh Han <hanthethanh@fptnet.com.vn>  Sun Feb  9 01:41:12 2003
From: The Thanh Han <hanthethanh@fptnet.com.vn> (The Thanh Han)
Date: Sun, 9 Feb 2003 08:41:12 +0700
Subject: [NTG-pdftex] pdfximage does not trigger page
In-Reply-To: <Pine.LNX.4.44.0302081604560.8040-100000@hahepc1.hahe>
References: <Pine.LNX.4.44.0302072043240.2698-100000@hahepc1.hahe> <Pine.LNX.4.44.0302081604560.8040-100000@hahepc1.hahe>
Message-ID: <20030209014112.GC1968@pc.thanh.home>

\pdfrefximage\pdflastximage inserts a whatsit node (something similar to
\special, \write,...) Thus it is not considered as something printable.
Try the same with eg \special and the result will be the same.

Regards,
Thanh

On Sat, Feb 08, 2003 at 04:15:18PM +0100, Hartmut Henkel wrote:
> Funny effect: Trying to include two pages of a pdf document on separate
> pages, with \vfill\eject inbetween...
> 
> \pdfximage width \hsize page 5 {AnnualReport.pdf}
> \pdfrefximage\pdflastximage
> \vfill\eject
> \pdfximage width \hsize page 10 {AnnualReport.pdf}
> \pdfrefximage\pdflastximage
> \bye
> 
> ...produces only one page:
> 
> This is pdfTeX, Version 3.14159-1.10a (Web2C 7.4.5)
> (./x.tex{/usr/local/teTeX/share/texmf/pdftex/config/pdftex.cfg}
> Overfull \vbox (598.49954pt too high) has occurred while \output is
> active
> [1{/usr/local/teTeX/share/texmf/dvips/config/pdftex.map}
> Warning: pdftex (file myfonts.map): cannot open font map file
>  <./AnnualReport.pdf> <./AnnualReport.pdf>] )
> (see the transcript file for additional
> information){/usr/local/teTeX/share/tex
> mf/dvips/tetex/f7b6d320.enc}</usr/local/teTeX/share/texmf/fonts/type1/bluesky/c
> m/cmr10.pfb>
> Output written on x.pdf (1 page, 196748 bytes).
> Transcript written on x.log.
> 
> Both included pages appear on output page 1! Obviously the 1st page was
> not detected to be anything printable. Is this ok?
> 
> When I put in addition a real letter on the 1st page, e. g. by...
> 
> a\vfill\eject
> 
> ...I get the desired two pages:
>  <./AnnualReport.pdf>] [2 <./AnnualReport.pdf>] )
> 
> Greetings Hartmut
> 
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex@ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex

From ms@artcom-gmbh.de  Tue Feb 11 15:36:37 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Tue, 11 Feb 2003 16:36:37 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de>
References: <20030207161425.GN16880@artcom8.artcom-gmbh.de> <5.1.0.14.1.20030207173615.03b44058@server-1> <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de>
Message-ID: <20030211153637.GH371@artcom8.artcom-gmbh.de>

On 2003-02-07 19:51:27 +0100, Thomas Esser wrote:
> > also on the todo list:
> 
> What about the things that Heiko Oberdieck has proposed:
>   http://omnibus.uni-freiburg.de/~oberdiek/pdftex.html

The fit visible is next. 
The map files need a bit more thinking.

> And I remember that bug one bug was reported after pdftex-1.10a was
> declared "frozen". That bug was even approved by Thanh...

Was that [pdftex] pdfTeX, Edmac and margin kerning?

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From pragma@wxs.nl  Tue Feb 11 16:41:42 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Tue, 11 Feb 2003 17:41:42 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030211153637.GH371@artcom8.artcom-gmbh.de>
References: <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de>
 <20030207161425.GN16880@artcom8.artcom-gmbh.de>
 <5.1.0.14.1.20030207173615.03b44058@server-1>
 <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de>
Message-ID: <5.1.0.14.1.20030211174025.02e9a798@server-1>

At 04:36 PM 2/11/2003 +0100, Martin Schroeder wrote:
>On 2003-02-07 19:51:27 +0100, Thomas Esser wrote:
> > > also on the todo list:
> >
> > What about the things that Heiko Oberdieck has proposed:
> >   http://omnibus.uni-freiburg.de/~oberdiek/pdftex.html
>
>The fit visible is next.

Not sure about that; does this affect other things/defaults? Changing ref 
points ...

>The map files need a bit more thinking.

indeed, esp since the optimization only looks at the first 8 chars of a 
filename if i remember right;

Hans

-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From te@dbs.uni-hannover.de  Tue Feb 11 17:19:56 2003
From: te@dbs.uni-hannover.de (Thomas Esser)
Date: Tue, 11 Feb 2003 18:19:56 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: Your message of Tue, 11 Feb 2003 16:36:37 +0100
 <20030211153637.GH371@artcom8.artcom-gmbh.de>
References: <20030207161425.GN16880@artcom8.artcom-gmbh.de> <5.1.0.14.1.20030207173615.03b44058@server-1> <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de> <20030211153637.GH371@artcom8.artcom-gmbh.de>
Message-ID: <200302111719.h1BHJuiV025974@gauss.dbs.uni-hannover.de>

> Was that [pdftex] pdfTeX, Edmac and margin kerning?

No, I mean that bugreport which included an explanation about a wrong
offset and a fix...

Thomas

From hartmut_henkel@gmx.de  Tue Feb 11 22:25:47 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Tue, 11 Feb 2003 23:25:47 +0100 (CET)
Subject: [NTG-pdftex] 1.10b mapfiles parsing
In-Reply-To: <5.1.0.14.1.20030207173615.03b44058@server-1>
Message-ID: <Pine.LNX.4.44.0302112311400.11794-100000@hahepc1.hahe>

A quick-and-dirty way to overrun existing map entries by later
duplicates might be to reset them to nontfm and proceed with scanning.
Then also the hierarchy of mapfiles from global (read first, lowest) to
local (read last, highest) seems correct (the annoying message might be
skipped :-)

Do multiple nontfms hurt?

Greetings Hartmut


--- mapfile-orig.c	Sun Oct  6 15:17:07 2002
+++ mapfile.c	Tue Feb 11 22:59:19 2003
@@ -141,8 +141,8 @@
         else {
             for (e = fm_tab; e < fm_ptr; e++)
                 if (e->tfm_name != nontfm && strcmp(e->tfm_name, buf) == 0) {
-                    pdftex_warn("entry for `%s' already exists, duplicates ignored", buf);
-                    goto bad_line;
+                    pdftex_warn("entry for `%s' already exists, will be ignored", buf);
+		    e->tfm_name = nontfm;
                 }
             set_field(tfm_name);
         }


On Fri, 7 Feb 2003, Hans Hagen wrote:

> At 05:14 PM 2/7/2003 +0100, Martin Schroeder wrote:
>
> also on the todo list:
>
> - later map entries may overload preceding ones without annoying message
> - map file loading after first page
>
> Hans


From ms@artcom-gmbh.de  Wed Feb 12 12:09:43 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 12 Feb 2003 13:09:43 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <200302111719.h1BHJuiV025974@gauss.dbs.uni-hannover.de>
References: <20030207161425.GN16880@artcom8.artcom-gmbh.de> <5.1.0.14.1.20030207173615.03b44058@server-1> <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de> <20030211153637.GH371@artcom8.artcom-gmbh.de> <200302111719.h1BHJuiV025974@gauss.dbs.uni-hannover.de>
Message-ID: <20030212120943.GP371@artcom8.artcom-gmbh.de>

On 2003-02-11 18:19:56 +0100, Thomas Esser wrote:
> No, I mean that bugreport which included an explanation about a wrong
> offset and a fix...

That was str_in_str. Fixed.

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From sebastian.rahtz@computing-services.oxford.ac.uk  Fri Feb  7 15:18:24 2003
From: sebastian.rahtz@computing-services.oxford.ac.uk (Sebastian Rahtz)
Date: Fri, 7 Feb 2003 16:18:24 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030207161425.GN16880@artcom8.artcom-gmbh.de>
References: <20030207161425.GN16880@artcom8.artcom-gmbh.de>
Message-ID: <20030207151824.GD31120@spqr>

On Fri, Feb 07, 2003 at 05:14:25PM +0100, Martin Schroeder wrote:
> 
> Can we resume working in source.developement without an immediate
> distribution of intermediate versions via web2c et.al.?

yes, definitely. thats the way to proceed.

-- 
Sebastian Rahtz      OUCS Information Manager
13 Banbury Road, Oxford OX2 6NN. Phone +44 1865 283431

From ms@artcom-gmbh.de  Thu Feb 13 16:13:18 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Thu, 13 Feb 2003 17:13:18 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <5.1.0.14.1.20030211174025.02e9a798@server-1>
References: <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de> <20030207161425.GN16880@artcom8.artcom-gmbh.de> <5.1.0.14.1.20030207173615.03b44058@server-1> <200302071851.h17IpR1f031075@gauss.dbs.uni-hannover.de> <5.1.0.14.1.20030211174025.02e9a798@server-1>
Message-ID: <20030213161318.GB371@artcom8.artcom-gmbh.de>

On 2003-02-11 17:41:42 +0100, Hans Hagen wrote:
> >The fit visible is next.
> 
> Not sure about that; does this affect other things/defaults? Changing ref 
> points ...

At least it breaks nothing in my testsuite. I'll submit that.

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From oberdiek@uni-freiburg.de  Mon Feb 17 11:46:06 2003
From: oberdiek@uni-freiburg.de (Heiko Oberdiek)
Date: Mon, 17 Feb 2003 12:46:06 +0100
Subject: [NTG-pdftex] 1.10b
Message-ID: <20030217114606.GA1651@linux.vpn.uni-freiburg.de>

At Tue, 11 Feb 2003 17:41:42 +0100 Hans Hagen wrote:
>
> At 04:36 PM 2/11/2003 +0100, Martin Schroeder wrote:
> >On 2003-02-07 19:51:27 +0100, Thomas Esser wrote:
> > > > also on the todo list:
> > >
> > > What about the things that Heiko Oberdieck has proposed:
> > >   http://omnibus.uni-freiburg.de/~oberdiek/pdftex.html
>
> >The map files need a bit more thinking.
>
> indeed, esp since the optimization only looks at the first 8 chars of a 
> filename if i remember right;

No, you have already given that hint last year and I have changed
the patch using all chars.

To make it clear, the patch improves the performance of
the *current* map file handling of pdfTeX. It saves me
*much* time in comparison to the binary of TeXLive 7.

But for *future* versions we should find an agreement
about the behaviour of pdfTeX regarding map files,
eg:
* Map files:
  * Where can they specified?
    * config file (pdftex.cfg)
    * support of other config files
    * config files given on command line
    * map files given on command line
    * config files given by command
    * map files given by command
    * ...
  * When they are evaluated?
    * static, first use
    * dynamic changes possible?
  * Which order?
    * default, if no map file is given?
    * adding mapfiles
    * replacing mapfiles
    * order ...
    * ...
* Map entries:
  * later entries are ignored with warning (current)
  * later entries replaces older ones silently
  * syntax ...
  * ...

I hope I will find some time next days to give a suggestion for a
specification. One aim can be to make the behaviour similar to
dvips.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

From pragma@wxs.nl  Mon Feb 17 12:08:14 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Mon, 17 Feb 2003 13:08:14 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
Message-ID: <5.1.0.14.1.20030217130419.02973008@server-1>

At 12:46 PM 2/17/2003 +0100, Heiko Oberdiek wrote:

>No, you have already given that hint last year and I have changed
>the patch using all chars.

ok, thanks

>To make it clear, the patch improves the performance of
>the *current* map file handling of pdfTeX. It saves me
>*much* time in comparison to the binary of TeXLive 7.

sure, apart from being slow, the double loop was kind of strange (even 
searching in a quick sorted list was problably faster -)

>But for *future* versions we should find an agreement
>about the behaviour of pdfTeX regarding map files,
>eg:
>* Map files:
>   * Where can they specified?
>     * config file (pdftex.cfg)
>     * support of other config files
>     * config files given on command line
>     * map files given on command line
>     * config files given by command
>     * map files given by command
>     * ...
>   * When they are evaluated?
>     * static, first use
>     * dynamic changes possible?
>   * Which order?
>     * default, if no map file is given?
>     * adding mapfiles
>     * replacing mapfiles
>     * order ...
>     * ...
>* Map entries:
>   * later entries are ignored with warning (current)
>   * later entries replaces older ones silently
>   * syntax ...
>   * ...

sure, even cooking up a better map file syntax makes sense; also we can use 
more prefixes (+filename, -filename, ++filename)

>I hope I will find some time next days to give a suggestion for a
>specification. One aim can be to make the behaviour similar to
>dvips.

forget about dvips, as far as i know, pdftex things made it back into 
dvips, so that can happen again this time; let's not carry the burden from 
the past

Hans
-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From oberdiek@uni-freiburg.de  Mon Feb 17 12:35:41 2003
From: oberdiek@uni-freiburg.de (Heiko Oberdiek)
Date: Mon, 17 Feb 2003 13:35:41 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <5.1.0.14.1.20030217130419.02973008@server-1>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <5.1.0.14.1.20030217130419.02973008@server-1>
Message-ID: <20030217123541.GA2103@linux.vpn.uni-freiburg.de>

On Mon, Feb 17, 2003 at 01:08:14PM +0100, Hans Hagen wrote:

> forget about dvips, as far as i know, pdftex things made it back into 
> dvips, so that can happen again this time; let's not carry the burden from 
> the past

Dream:
Good ideas of dvips + good ideas of pdfTeX + other good ideas,
and the result is used both in pdfTeX and dvips, so that
map files can be shared without changes.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

From ms@artcom-gmbh.de  Mon Feb 17 13:47:23 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Mon, 17 Feb 2003 14:47:23 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
Message-ID: <20030217134723.GC12556@artcom8.artcom-gmbh.de>

On 2003-02-17 12:46:06 +0100, Heiko Oberdiek wrote:
> > indeed, esp since the optimization only looks at the first 8 chars of a 
> > filename if i remember right;
> 
> No, you have already given that hint last year and I have changed
> the patch using all chars.

It's in (#2878). Porting this to hash.h is left as an exercise
for those who know kpathsea. I must confess I hate the lack of
comments in mapfile.c ...

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Mon Feb 17 14:23:27 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Mon, 17 Feb 2003 15:23:27 +0100
Subject: [NTG-pdftex] Re: [pdftex] Re: Patch PreventInfoDictDupes
In-Reply-To: <20030216012713.GE6512@lucien.kn-bremen.de>
References: <20021001081631.GA949@linux> <20030209023328.GA5297@linux> <20030216012713.GE6512@lucien.kn-bremen.de>
Message-ID: <20030217142327.GD12556@artcom8.artcom-gmbh.de>

On 2003-02-16 02:27:14 +0100, Martin Schröder wrote:
> On 2003-02-09 03:33:28 +0100, Heiko Oberdiek wrote:
> > Now I have written a patch. It looks for the info token
> > list for the presence of keys. If they are set, then
> > the default settings of pdfTeX are suppressed.
> 
> Thanks. I must confess I overlooked this patch.

It's in (#2880). I've removed <Output the info object@> as it was
superfluous.

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Mon Feb 17 14:26:04 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Mon, 17 Feb 2003 15:26:04 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030217134723.GC12556@artcom8.artcom-gmbh.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de>
Message-ID: <20030217142603.GE12556@artcom8.artcom-gmbh.de>

On 2003-02-17 14:47:23 +0100, Martin Schröder wrote:
> It's in (#2878). Porting this to hash.h is left as an exercise

Any open bugs left?

Major changes since 1.10a
-------------------------
- Bugfix: When setting the /Producer, /Creator or /CreationDate keys with
  /pdfinfo pdfTeX would also insert default values which caused duplicate keys
  in the info dict (see
  http://tug.org/pipermail/pdftex/2003-February/003524.html).

- The reading of mapfiles is much faster (see
  http://tug.org/pipermail/pdftex/2002-July/002843.html).
  
- Bugfix: AR5 had problems with the CTM when displaying in "fit visible" mode
  (see http://tug.org/pipermail/pdftex/2002-May/002688.html).

- Bugfix: str_in_str had wrong indices (see
  http://tug.org/pipermail/pdftex/2002-March/002367.html).

- Bugfix: decimal_digits defaulted to 0, which caused problems with included
  images when including pdfs (see
  http://tug.org/pipermail/pdftex/2003-February/003518.html). 
  It now defaults to 4.
  
- Bugfix: the type of included images was decided based only on the extensions;
  now pdfTeX looks for magic bytes at the start of files (see
  http://tug.org/pipermail/pdftex/2003-February/003519.html)

-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From oberdiek@uni-freiburg.de  Mon Feb 17 14:45:51 2003
From: oberdiek@uni-freiburg.de (Heiko Oberdiek)
Date: Mon, 17 Feb 2003 15:45:51 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030217142603.GE12556@artcom8.artcom-gmbh.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de>
Message-ID: <20030217144551.GA5609@linux.vpn.uni-freiburg.de>

On Mon, Feb 17, 2003 at 03:26:04PM +0100, Martin Schroeder wrote:

> On 2003-02-17 14:47:23 +0100, Martin Schröder wrote:
> > It's in (#2878). Porting this to hash.h is left as an exercise
> 
> Any open bugs left?

Yes, "Bug LiteralSpaceFirstSpace", see my posting in the
pdfTeX mailing list of 2002/02/16. But I do not have a
good fix (only a wild and quite untested guess).

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 

From te@dbs.uni-hannover.de  Mon Feb 17 20:13:28 2003
From: te@dbs.uni-hannover.de (Thomas Esser)
Date: Mon, 17 Feb 2003 21:13:28 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: Your message of Mon, 17 Feb 2003 13:08:14 +0100
 <5.1.0.14.1.20030217130419.02973008@server-1>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <5.1.0.14.1.20030217130419.02973008@server-1>
Message-ID: <200302172013.h1HKDSdZ027262@gauss.dbs.uni-hannover.de>

> forget about dvips, as far as i know, pdftex things made it back into 
> dvips, so that can happen again this time; let's not carry the burden from 
> the past

I am not aware of many things that dvips has taken over from pdftex.
The only thing I know is the font subsetting module which origins from
dvips. It was improved for pdftex and put back into dvips. Clearly,
this was painless for dvips.

As for other new stuff, I suggest that you don't just assume that
dvips will follow everything. Better get in touch with Tomas Rokicki
before doing that.

Thomas

From pragma@wxs.nl  Mon Feb 17 21:41:21 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Mon, 17 Feb 2003 22:41:21 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <200302172013.h1HKDSdZ027262@gauss.dbs.uni-hannover.de>
References: <Your message of Mon, 17 Feb 2003 13:08:14 +0100  <5.1.0.14.1.20030217130419.02973008@server-1>
 <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
 <5.1.0.14.1.20030217130419.02973008@server-1>
Message-ID: <5.1.0.14.1.20030217224023.023196b0@remote-1>

At 09:13 PM 2/17/2003 +0100, you wrote:
> > forget about dvips, as far as i know, pdftex things made it back into
> > dvips, so that can happen again this time; let's not carry the burden from
> > the past
>
>I am not aware of many things that dvips has taken over from pdftex.
>The only thing I know is the font subsetting module which origins from
>dvips. It was improved for pdftex and put back into dvips. Clearly,
>this was painless for dvips.

right, i was indeed refering to this part

>As for other new stuff, I suggest that you don't just assume that
>dvips will follow everything. Better get in touch with Tomas Rokicki
>before doing that.

i'm not that familiar with dvips; how different are the map files?

Hans
-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From hartmut_henkel@gmx.de  Mon Feb 17 22:00:16 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Mon, 17 Feb 2003 23:00:16 +0100 (CET)
Subject: [NTG-pdftex] 1.10b pdftoepdf.cc: convertNumToPDF()
In-Reply-To: <20030217134723.GC12556@artcom8.artcom-gmbh.de>
Message-ID: <Pine.LNX.4.44.0302172241010.8279-100000@hahepc1.hahe>

Hi pdftex fans,

function convertNumToPDF() has the feature, that if it gets numbers with
6 nonzero digits after the decimal point, it will not append a '\0' to
the number string in the buffer. Then you get more than 6 digits after
the point: whatever is left in the buffer until the next '\0'. And the
rounding isn't clear. In the patched version below the rounding is at
+/- 1/2 eps; the check for small numbers can be omitted by the way.

Here is the output from the test program below for some numbers:

input <orig> <patched>
10.00005000 <10.000049> <10.00005>
 2.12345600 <2.1234569> <2.123456>
 0.00000040 <0> <0>
 0.00000050 <0> <0.000001>
 0.00000100 <0.0000019> <0.000001>
 9.00000000 <9> <9>
 9.99999940 <9.9999999> <9.999999>
 9.99999950 <9.9999999> <10>
 9.99999990 <9.9999999> <10>
10.00000040 <10> <10>
10.00000050 <10> <10.000001>
10.00000100 <10> <10.000001>
10.00000200 <10.000002> <10.000002>
 9.99999990 <9.9999992> <10>
 9.49999949 <9.4999992> <9.499999>
 9.49999950 <9.4999992> <9.5>
 9.49999951 <9.4999992> <9.5>

Below is the program for producing this list with the patch. Have fun.

Greetings Hartmut


#include <stdlib.h>
#include <stdio.h>
#include <math.h>

static char *convertNumToPDF_orig(double n)
{
    /* converts double to string; very small and very large numbers are NOT
     * converted to scientific notation.
     * n must be a number or real confirming to the implementation limits of
     * PDF as specified in appendix C.1 of the pdf ref.
     * These are:
     * maximum value of ints is +2^32
     * maximum value of reals is +2^15
     * smalles values of reals is 1/(2^16)
     */
    static int precision = 6;
    static int fact = (int) 1E6;	/* must be 10^precision */
    static double epsilon = 1E-6;	/* must be 10^-precision */
    static char buf[64];
    // handle very small values: return 0
    if (fabs(n) < epsilon) {
	buf[0] = '0';
	buf[1] = '\0';
    } else {
	char ints[64];
	int bindex = 0, sindex = 0;
	int ival, fval, i;
	// handle the sign part if n is negative
	if (n < 0) {
	    buf[bindex++] = '-';
	    n = -n;
	}
	// handle the integer part, simply with sprintf
	ival = (int) floor(n);
	n -= ival;
	sprintf(ints, "%d", ival);
	while (ints[sindex] != 0)
	    buf[bindex++] = ints[sindex++];
	// handle the fractional part up to 'precision' digits
	fval = (int) floor(n * fact);
	if (fval) {
	    // set a dot
	    buf[bindex++] = '.';
	    sindex = bindex + precision - 1;
	    // fill up trailing zeros with the string terminator NULL
	    while (((fval % 10) == 0) && (sindex >= bindex)) {
		buf[sindex--] = '\0';
		fval /= 10;
	    }
	    // fill up the fractional part back to front
	    while (sindex >= bindex) {
		buf[sindex--] = (fval % 10) + '0';
		fval /= 10;
	    }
	} else
	    buf[bindex++] = 0;
    }
    return (char *) buf;
}

static char *convertNumToPDF(double n)
{
    /* converts double to string; very small and very large numbers are NOT
     * converted to scientific notation.
     * n must be a number or real confirming to the implementation limits of
     * PDF as specified in appendix C.1 of the pdf ref.
     * These are:
     * maximum value of ints is +2^32
     * maximum value of reals is +2^15
     * smalles values of reals is 1/(2^16)
     */
    static int precision = 6;
    static int fact = (int) 1E6;	/* must be 10^precision */
    static double epsilon = 1E-6;	/* must be 10^-precision */
    static char buf[64];
    char ints[64];
    int bindex = 0, sindex = 0;
    int ival, fval, i;
    // handle the sign part if n is negative
    if (n < 0) {
	buf[bindex++] = '-';
	n = -n;
    }
    // handle the integer part, simply with sprintf
    n += 0.5 * epsilon;
    ival = (int) floor(n);
    n -= ival;
    sprintf(ints, "%d", ival);
    while (ints[sindex] != 0)
	buf[bindex++] = ints[sindex++];
    // handle the fractional part up to 'precision' digits
    fval = (int) floor(n * fact);
    if (fval) {
	// set a dot
	buf[bindex++] = '.';
	sindex = bindex + precision;
	buf[sindex--] = '\0';
	// fill up trailing zeros with the string terminator NULL
	while (((fval % 10) == 0) && (sindex >= bindex)) {
	    buf[sindex--] = '\0';
	    fval /= 10;
	}
	// fill up the fractional part back to front
	while (sindex >= bindex) {
	    buf[sindex--] = (fval % 10) + '0';
	    fval /= 10;
	}
    } else
	buf[bindex++] = 0;
    return (char *) buf;
}

int main()
{
    double z[] =
	{ 10.00005, 2.123456, 0.0000004, 0.0000005, 0.000001, 9, 9.9999994,
	9.9999995,
	9.9999999, 10.0000004, 10.0000005, 10.000001, 10.000002, 9.9999999,
	9.49999949, 9.4999995, 9.49999951
    };
    char *buf_orig, *buf;
    int i;

    printf("input <orig> <patched>\n");
    for (i = 0; i < 17; i++) {
	buf_orig = convertNumToPDF_orig(z[i]);
	buf = convertNumToPDF(z[i]);

	printf("%11.8f <%s> <%s>\n", z[i], buf_orig, buf);
    }
    return 0;
}


From te@dbs.uni-hannover.de  Mon Feb 17 22:03:14 2003
From: te@dbs.uni-hannover.de (Thomas Esser)
Date: Mon, 17 Feb 2003 23:03:14 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: Your message of Mon, 17 Feb 2003 22:41:21 +0100
 <5.1.0.14.1.20030217224023.023196b0@remote-1>
References: <Your message of Mon, 17 Feb 2003 13:08:14 +0100  <5.1.0.14.1.20030217130419.02973008@server-1>
 <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
 <5.1.0.14.1.20030217130419.02973008@server-1> <5.1.0.14.1.20030217224023.023196b0@remote-1>
Message-ID: <200302172203.h1HM3Er7020035@gauss.dbs.uni-hannover.de>

> i'm not that familiar with dvips; how different are the map files?

pdftex has a numeric "bit" field that is rarely used (dvips does not have it)
pdftex can omit the ps-fontname (for dvips, you can't)

That's it (at least afaik).

So, most files are well perfectly sharable. Users of teTeX can just drop
dvips-style map files into updmap and it generates a fine map for pdftex
out of it (updmap automatically omits the ps-fontname if Slant/Extend
is used; pdftex should be fixed to make this unnesessary).

Thomas

From pragma@wxs.nl  Tue Feb 18 07:55:18 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Tue, 18 Feb 2003 08:55:18 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <200302172203.h1HM3Er7020035@gauss.dbs.uni-hannover.de>
References: <Your message of Mon, 17 Feb 2003 22:41:21 +0100  <5.1.0.14.1.20030217224023.023196b0@remote-1>
 <Your message of Mon, 17 Feb 2003 13:08:14 +0100  <5.1.0.14.1.20030217130419.02973008@server-1>
 <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
 <5.1.0.14.1.20030217130419.02973008@server-1>
 <5.1.0.14.1.20030217224023.023196b0@remote-1>
Message-ID: <5.1.0.14.1.20030218085405.023159f0@server-1>

At 11:03 PM 2/17/2003 +0100, Thomas Esser wrote:
> > i'm not that familiar with dvips; how different are the map files?
>
>pdftex has a numeric "bit" field that is rarely used (dvips does not have it)
>pdftex can omit the ps-fontname (for dvips, you can't)
>
>That's it (at least afaik).
>
>So, most files are well perfectly sharable. Users of teTeX can just drop
>dvips-style map files into updmap and it generates a fine map for pdftex
>out of it (updmap automatically omits the ps-fontname if Slant/Extend
>is used; pdftex should be fixed to make this unnesessary).

so, how about something -"fontname" which tells pdftex to ignore the 
fontname (which sometimes is handy) andis ignores by dvips?

also, dvips can ignore the numeric bit, which brings them close together

Hans


-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From ms@artcom-gmbh.de  Tue Feb 18 12:52:41 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Tue, 18 Feb 2003 13:52:41 +0100
Subject: [NTG-pdftex] 1.10b pdftoepdf.cc: convertNumToPDF()
In-Reply-To: <Pine.LNX.4.44.0302172241010.8279-100000@hahepc1.hahe>
References: <Pine.LNX.4.44.0302172241010.8279-100000@hahepc1.hahe>
Message-ID: <20030218125241.GK12556@artcom8.artcom-gmbh.de>

On 2003-02-17 23:00:16 +0100, Hartmut Henkel wrote:
> Below is the program for producing this list with the patch. Have fun.

Thanks. It's in (#2896).

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From tkacvins@cox.net  Tue Feb 18 21:05:06 2003
From: tkacvins@cox.net (Tom Kacvinsky)
Date: Tue, 18 Feb 2003 16:05:06 -0500
Subject: [NTG-pdftex] dvips vs. pdftex fontmaps
In-Reply-To: <5.1.0.14.1.20030218085405.023159f0@server-1>
Message-ID: <r01050400-0922-BEEC6500435A11D7AB7020ACA1530198@[10.0.1.2]>

Let us not forget "/PaintType 2 def" in a dvips fontmap, which places
that entry in the Type 1 dictionary and Type 1 rasterizers understand. 
Not so with PDF files.  The outline paint type has to be set with a text
state operator in a PDF file -- the Type 1 dictionary value is ignored.

Tom

On 2003/02/18 at 08:55, Hans Hagen <pragma@wxs.nl> wrote:

> At 11:03 PM 2/17/2003 +0100, Thomas Esser wrote:
> 
> > > i'm not that familiar with dvips; how different are the map files?
> >
> > pdftex has a numeric "bit" field that is rarely used (dvips does
> > not have it) pdftex can omit the ps-fontname (for dvips, you can't)
> >
> > That's it (at least afaik).
> >
> > So, most files are well perfectly sharable. Users of teTeX can just
> > drop dvips-style map files into updmap and it generates a fine map
> > for pdftex out of it (updmap automatically omits the ps-fontname if
> > Slant/Extend is used; pdftex should be fixed to make this
> > unnesessary).
> 
> so, how about something -"fontname" which tells pdftex to ignore the
> fontname (which sometimes is handy) andis ignores by dvips?
> 
> also, dvips can ignore the numeric bit, which brings them close
> together

From hartmut_henkel@gmx.de  Wed Feb 19 23:11:51 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Thu, 20 Feb 2003 00:11:51 +0100 (CET)
Subject: [NTG-pdftex] 1.10b pdftoepdf.cc: AVL search tree
In-Reply-To: <20030218125241.GK12556@artcom8.artcom-gmbh.de>
Message-ID: <Pine.LNX.4.44.0302192353580.29275-100000@hahepc1.hahe>

Hi pdfTeX fans,

in the last few days I have fiddled around with application of AVL
trees, and as an experiment replaced the linked list PdfDocuments in
file pdftoepdf.cc by an AVL search tree. It was quite straight-forward.
Once the coredumps go away, it works :-) The patch you find on my
homepage:

w w w . c i r c u i t w i z a r d . d e

I use the nice AVL implementation GNU libavl by Ben Pfaff, it is
compact, looks very mature/stable, extremely well documented, and it's
unter the GNU Public License, Good.

These AVL trees give a pretty high lookup speed, so one probably might
give them a try for other dictionary lookup tasks within pdfTeX.

(However I already failed miserably before, when trying to replace the
fm_tab list for mapfile entries by such an AVL tree. The fm_tab list
stuff is so widely scattered over many places within the pdftex sources,
that a replacement by a search tree would be a major overhaul; but it
seems to be possible. Anyway we have the nice hashing by Heiko.)

The patch is still rather raw, but as it basically does the wanted, I
thought I should push it out for discussion.

Greetings Hartmut



From hartmut_henkel@gmx.de  Wed Feb 19 23:32:05 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Thu, 20 Feb 2003 00:32:05 +0100 (CET)
Subject: [NTG-pdftex] 1.10b pdftoepdf.cc: Document Deletion
In-Reply-To: <20030218125241.GK12556@artcom8.artcom-gmbh.de>
Message-ID: <Pine.LNX.4.44.0302200014050.29638-100000@hahepc1.hahe>

It seems that currently pdftex deletes/re-reads documents when they are
to be multiply included, see the log for a 4-page pdf file, its page 1
included by:

\pdfximage width \hsize page 1 {prod_brochure.pdf}
\hbox{\pdfrefximage\pdflastximage} \vfill\eject
\pdfximage width \hsize page 1 {prod_brochure.pdf}
\hbox{\pdfrefximage\pdflastximage} \vfill\eject \end

See the log below. Shouldn't such a request include the file only once,
and later only make a reference to the first page object? When I
uncomment the (pdf_doc->occurence)--; line, I get much smaller file
size, 120278 bytes in this case. Is the occurence stuff broken, or do I
do something wrong?

Greetings Hartmut


Log (with #define DEBUG):

This is pdfTeX, Version 3.14159-1.10a (Web2C 7.4.5)
(./y.tex{/usr/local/teTeX/share/texmf/pdftex/config/pdftex.cfg}
Creating ./prod_brochure.pdf (0)

Reading information on ./prod_brochure.pdf
 [1{/usr/local/t
eTeX/share/texmf/dvips/config/pdftex.map} <./prod_brochure.pdf
Decrementing ./prod_brochure.pdf (-1)
>
Deleting ./prod_brochure.pdf
]
Creating ./prod_brochure.pdf (0)

Reading information on ./prod_brochure.pdf
 [2 <./prod_bro
chure.pdf
Decrementing ./prod_brochure.pdf (-1)
>
Deleting ./prod_brochure.pdf
] ){/usr/local/teTeX/share/texmf/dvips/tetex/f7b6d320.enc}</usr/local
/teTeX/share/texmf/fonts/type1/bluesky/cm/cmr10.pfb>
Output written on y.pdf (2 pages, 229447 bytes).
Transcript written on y.log.



From ms@artcom-gmbh.de  Thu Feb 20 09:25:41 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Thu, 20 Feb 2003 10:25:41 +0100
Subject: [NTG-pdftex] 1.10b pdftoepdf.cc: Document Deletion
In-Reply-To: <Pine.LNX.4.44.0302200014050.29638-100000@hahepc1.hahe>
References: <Pine.LNX.4.44.0302200014050.29638-100000@hahepc1.hahe>
Message-ID: <20030220092541.GF26479@artcom8.artcom-gmbh.de>

On 2003-02-20 00:32:05 +0100, Hartmut Henkel wrote:
> \pdfximage width \hsize page 1 {prod_brochure.pdf}
> \hbox{\pdfrefximage\pdflastximage} \vfill\eject
> \pdfximage width \hsize page 1 {prod_brochure.pdf}
> \hbox{\pdfrefximage\pdflastximage} \vfill\eject \end
> 
> See the log below. Shouldn't such a request include the file only once,
> and later only make a reference to the first page object? When I

No. That would work if you commented out line 3 in the example
(with pdftex.def that happens automagically). You tell pdftex to
include prod_brochure.pdf twice. :-)

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From The Thanh Han <hanthethanh@fptnet.com.vn>  Thu Feb 20 00:33:37 2003
From: The Thanh Han <hanthethanh@fptnet.com.vn> (The Thanh Han)
Date: Thu, 20 Feb 2003 07:33:37 +0700
Subject: [NTG-pdftex] 1.10b pdftoepdf.cc: AVL search tree
In-Reply-To: <Pine.LNX.4.44.0302192353580.29275-100000@hahepc1.hahe>
References: <20030218125241.GK12556@artcom8.artcom-gmbh.de> <Pine.LNX.4.44.0302192353580.29275-100000@hahepc1.hahe>
Message-ID: <20030220003337.GC1965@pc.thanh.home>

Hi,

I would prefer using consistent structure. Thus if we consider using libavl
reasonable, we should use it everywhere when possible.

I think apart from a few typographic extensions which are rarely used, the
only strength of pdftex is speed, so yes we need to pay attention to this.
For average users it doesn't make much sense, but for some applications it
might be quite a plus.

Thanh


On Thu, Feb 20, 2003 at 12:11:51AM +0100, Hartmut Henkel wrote:
> Hi pdfTeX fans,
> 
> in the last few days I have fiddled around with application of AVL
> trees, and as an experiment replaced the linked list PdfDocuments in
> file pdftoepdf.cc by an AVL search tree. It was quite straight-forward.
> Once the coredumps go away, it works :-) The patch you find on my
> homepage:
> 
> w w w . c i r c u i t w i z a r d . d e
> 
> I use the nice AVL implementation GNU libavl by Ben Pfaff, it is
> compact, looks very mature/stable, extremely well documented, and it's
> unter the GNU Public License, Good.
> 
> These AVL trees give a pretty high lookup speed, so one probably might
> give them a try for other dictionary lookup tasks within pdfTeX.
> 
> (However I already failed miserably before, when trying to replace the
> fm_tab list for mapfile entries by such an AVL tree. The fm_tab list
> stuff is so widely scattered over many places within the pdftex sources,
> that a replacement by a search tree would be a major overhaul; but it
> seems to be possible. Anyway we have the nice hashing by Heiko.)
> 
> The patch is still rather raw, but as it basically does the wanted, I
> thought I should push it out for discussion.
> 
> Greetings Hartmut
> 
> 
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex@ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex

From hartmut_henkel@gmx.de  Sun Feb 23 18:19:42 2003
From: hartmut_henkel@gmx.de (Hartmut Henkel)
Date: Sun, 23 Feb 2003 19:19:42 +0100 (CET)
Subject: [NTG-pdftex] AVL trees for fast fontmap storage/access
In-Reply-To: <20030220003337.GC1965@pc.thanh.home>
Message-ID: <Pine.LNX.4.44.0302231905050.2485-100000@hahepc1.hahe>

Hi,

there's another _experimental_ patch: I have replaced the fm_tab array
for fontmaps in pdftex by two AVL trees, and modified the fmlookup(),
tfmoffm() etc. functions accordingly. Now the pdffontmap list in
pdftex.ch contains pointers (instead of indices) to the fm_entry
entries.

The mapfile reading speed then is great: 100000 lines of mapfile need a
fraction of a second on my 400 MHz PC. AVL in principle allows to
replace fm_entry entries while filling the tree. Beware: The patch is
buggy, most likely around reading TT fontmaps, as I need to understand
things around the mk_ext_fm() function; never came along TTFs.

For the curious, the patch is at w w w . c i r c u i t w i z a r d . d e

Greetings Hartmut


On Thu, 20 Feb 2003, The Thanh Han wrote:

> Hi,
>
> I would prefer using consistent structure. Thus if we consider using
> libavl reasonable, we should use it everywhere when possible.


From pragma@wxs.nl  Mon Feb 24 08:08:25 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Mon, 24 Feb 2003 09:08:25 +0100
Subject: [NTG-pdftex] AVL trees for fast fontmap storage/access
In-Reply-To: <Pine.LNX.4.44.0302231905050.2485-100000@hahepc1.hahe>
References: <20030220003337.GC1965@pc.thanh.home>
Message-ID: <5.1.0.14.1.20030224085837.035cef50@server-1>

At 07:19 PM 2/23/2003 +0100, Hartmut Henkel wrote:
>Hi,
>
>there's another _experimental_ patch: I have replaced the fm_tab array
>for fontmaps in pdftex by two AVL trees, and modified the fmlookup(),
>tfmoffm() etc. functions accordingly. Now the pdffontmap list in
>pdftex.ch contains pointers (instead of indices) to the fm_entry
>entries.
>
>The mapfile reading speed then is great: 100000 lines of mapfile need a
>fraction of a second on my 400 MHz PC. AVL in principle allows to
>replace fm_entry entries while filling the tree. Beware: The patch is
>buggy, most likely around reading TT fontmaps, as I need to understand
>things around the mk_ext_fm() function; never came along TTFs.

interesting, i wonder how complicated it is to have such trees accessible 
by primitives (\newhash, \sethash, \gethash) in order to store strings 
(later to be processed by scantokens or so).


Hans
-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From ms@artcom-gmbh.de  Mon Feb 24 13:24:36 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Mon, 24 Feb 2003 14:24:36 +0100
Subject: [NTG-pdftex] Re: [pdftex] Bug in 1.10a: \pdfximage with pdf file and width
In-Reply-To: <Pine.LNX.4.44.0302231217360.30574-100000@hahepc1.hahe>
References: <20030210101120.GA4347@linux> <Pine.LNX.4.44.0302231217360.30574-100000@hahepc1.hahe>
Message-ID: <20030224132436.GD30077@artcom8.artcom-gmbh.de>

On 2003-02-23 12:46:32 +0100, Hartmut Henkel wrote:
> Below is a suggestion for patching pdftex.ch, factors with 6 digits
> after the decimal point. Including scaled 4 m size pdf images seems
> still to work :-) The images have right size even with decimal_digits =
> 0. Did I miss any overall scaling stuff there?

Seems not so. The patch is in (#2928).

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Mon Feb 24 15:34:37 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Mon, 24 Feb 2003 16:34:37 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030217144551.GA5609@linux.vpn.uni-freiburg.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de>
Message-ID: <20030224153436.GF30077@artcom8.artcom-gmbh.de>

On 2003-02-17 15:45:51 +0100, Heiko Oberdiek wrote:
> On Mon, Feb 17, 2003 at 03:26:04PM +0100, Martin Schroeder wrote:
> > Any open bugs left?
> 
> Yes, "Bug LiteralSpaceFirstSpace", see my posting in the
> pdfTeX mailing list of 2002/02/16. But I do not have a
> good fix (only a wild and quite untested guess).

I'd like to release 1.10b tomorrow. Anything that must be fixed
till then? For LiteralSpaceFirstSpace I'd like to have Thanh's
blessing for a fix.

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From pragma@wxs.nl  Mon Feb 24 23:21:26 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Tue, 25 Feb 2003 00:21:26 +0100
Subject: [NTG-pdftex] Re: [pdftex] Bug in 1.10a: \pdfximage with pdf file and width
In-Reply-To: <Pine.LNX.4.44.0302241925010.2948-100000@hahepc1.hahe>
References: <5.1.0.14.1.20030224090938.035d2d08@server-1>
Message-ID: <5.1.0.14.1.20030225001430.025bd098@remote-1>

At 07:44 PM 2/24/2003 +0100, you wrote:
>On Mon, 24 Feb 2003, Hans Hagen wrote:
>
> > mediaboxes (in xforms etc) should also be as accurate as possible since
> > otherwise the viewers clip engine starts spoiling things
>
>Scaling seems to be precise everywhere now. There is no scale in the
>xforms, the /Matrix [1 0 0 1 0 0] is used.
>
>But /BBox dimensions ARE rounded to these decimal_digits when written
>out, as are also still the width and height of the PDF images.
>
>Do you suggest, that even the width and height of images and xforms
>should be written out with max. number digits? It costs nearly nothing,
>but this is currently NOT done. If you complain quickly enough, it might
>go into the next release. :-) This is in pdftex.ch code lines 3549,
>3550, 8274, 8275, 8286, 8290.


those dimensions should indeed be precise (and better be rounded up (nth 
digit) than down in order not to clip lines

Hans

-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From The Thanh Han <hanthethanh@fptnet.com.vn>  Mon Feb 24 23:58:18 2003
From: The Thanh Han <hanthethanh@fptnet.com.vn> (The Thanh Han)
Date: Tue, 25 Feb 2003 06:58:18 +0700
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030224153436.GF30077@artcom8.artcom-gmbh.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de> <20030224153436.GF30077@artcom8.artcom-gmbh.de>
Message-ID: <20030224235818.GA1942@pc.thanh.home>

On Mon, Feb 24, 2003 at 04:34:37PM +0100, Martin Schroeder wrote:
> On 2003-02-17 15:45:51 +0100, Heiko Oberdiek wrote:
> > On Mon, Feb 17, 2003 at 03:26:04PM +0100, Martin Schroeder wrote:
> > > Any open bugs left?
> > 
> > Yes, "Bug LiteralSpaceFirstSpace", see my posting in the
> > pdfTeX mailing list of 2002/02/16. But I do not have a
> > good fix (only a wild and quite untested guess).
> 
> I'd like to release 1.10b tomorrow. Anything that must be fixed
> till then? For LiteralSpaceFirstSpace I'd like to have Thanh's
> blessing for a fix.

this fix must be tested very well -- otherwise it can break everything.

Thanh

From ms@artcom-gmbh.de  Wed Feb 26 10:17:54 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 26 Feb 2003 11:17:54 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030224235818.GA1942@pc.thanh.home>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de> <20030224153436.GF30077@artcom8.artcom-gmbh.de> <20030224235818.GA1942@pc.thanh.home>
Message-ID: <20030226101754.GN30077@artcom8.artcom-gmbh.de>

On 2003-02-25 06:58:18 +0700, The Thanh Han wrote:
> this fix must be tested very well -- otherwise it can break everything.

Which is why I haven't included any patch yet.

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Wed Feb 26 12:09:06 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 26 Feb 2003 13:09:06 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030224153436.GF30077@artcom8.artcom-gmbh.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de> <20030224153436.GF30077@artcom8.artcom-gmbh.de>
Message-ID: <20030226120905.GA27130@artcom8.artcom-gmbh.de>

On 2003-02-24 16:34:37 +0100, Martin Schröder wrote:
> I'd like to release 1.10b tomorrow. Anything that must be fixed

I've moved the version to 1.10b (#2932). Sebastian, would you
please integrate it and update source.tar.bz2?

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Wed Feb 26 14:50:45 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 26 Feb 2003 15:50:45 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030226120905.GA27130@artcom8.artcom-gmbh.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de> <20030224153436.GF30077@artcom8.artcom-gmbh.de> <20030226120905.GA27130@artcom8.artcom-gmbh.de>
Message-ID: <20030226145045.GC27130@artcom8.artcom-gmbh.de>

On 2003-02-26 13:09:06 +0100, Martin Schröder wrote:
> I've moved the version to 1.10b (#2932). Sebastian, would you
> please integrate it and update source.tar.bz2?

Not yet -- Hartmut just found a potential overflow in the
non-pdf-inclusion. Stay tuned. :-(

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From ms@artcom-gmbh.de  Wed Feb 26 15:10:41 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 26 Feb 2003 16:10:41 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030226145045.GC27130@artcom8.artcom-gmbh.de>
References: <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de> <20030224153436.GF30077@artcom8.artcom-gmbh.de> <20030226120905.GA27130@artcom8.artcom-gmbh.de> <20030226145045.GC27130@artcom8.artcom-gmbh.de>
Message-ID: <20030226151041.GE27130@artcom8.artcom-gmbh.de>

On 2003-02-26 15:50:45 +0100, Martin Schröder wrote:
> Not yet -- Hartmut just found a potential overflow in the
> non-pdf-inclusion. Stay tuned. :-(

#2933 should fix this.

    if not is_pdf_image(image) then begin
        pdf_print_real(ext_xn_over_d(pdf_width(p), 
                       10000, one_bp), 4); {1000000,6 leads to overflows with large images}
        pdf_print(" 0 0 ");
        pdf_print_real(ext_xn_over_d(pdf_height(p) + pdf_depth(p), 
                       10000, one_bp), 4); {1000000,6 leads to overflows with large images}
        pdf_out(" ");
        pdf_print_bp(pdf_x(cur_h)); pdf_out(" ");
        pdf_print_bp(pdf_y(cur_v));
    end

Best regards
        Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10


From pragma@wxs.nl  Wed Feb 26 18:01:18 2003
From: pragma@wxs.nl (Hans Hagen)
Date: Wed, 26 Feb 2003 19:01:18 +0100
Subject: [NTG-pdftex] 1.10b
In-Reply-To: <20030226145045.GC27130@artcom8.artcom-gmbh.de>
References: <20030226120905.GA27130@artcom8.artcom-gmbh.de>
 <20030217114606.GA1651@linux.vpn.uni-freiburg.de>
 <20030217134723.GC12556@artcom8.artcom-gmbh.de>
 <20030217142603.GE12556@artcom8.artcom-gmbh.de>
 <20030217144551.GA5609@linux.vpn.uni-freiburg.de>
 <20030224153436.GF30077@artcom8.artcom-gmbh.de>
 <20030226120905.GA27130@artcom8.artcom-gmbh.de>
Message-ID: <5.1.0.14.1.20030226185953.0242e410@server-1>

Hi Martin,

Can you also add a primitive \pdftrailer which acts like the catalog but 
adds content to the trailer object? We may need this for reaching pdf/x 
compatibility.

Hans

-------------------------------------------------------------------------
                                   Hans Hagen | PRAGMA ADE | pragma@wxs.nl
                       Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
  tel: +31 (0)38 477 53 69 | fax: +31 (0)38 477 53 74 | www.pragma-ade.com
-------------------------------------------------------------------------
                        information: http://www.pragma-ade.com/roadmap.pdf
                     documentation: http://www.pragma-ade.com/showcase.pdf
-------------------------------------------------------------------------


From ms@artcom-gmbh.de  Wed Feb 26 19:34:46 2003
From: ms@artcom-gmbh.de (Martin Schroeder)
Date: Wed, 26 Feb 2003 20:34:46 +0100
Subject: [NTG-pdftex] \pdftrailer (was: 1.10b)
In-Reply-To: <5.1.0.14.1.20030226185953.0242e410@server-1>
References: <20030226120905.GA27130@artcom8.artcom-gmbh.de> <20030217114606.GA1651@linux.vpn.uni-freiburg.de> <20030217134723.GC12556@artcom8.artcom-gmbh.de> <20030217142603.GE12556@artcom8.artcom-gmbh.de> <20030217144551.GA5609@linux.vpn.uni-freiburg.de> <20030224153436.GF30077@artcom8.artcom-gmbh.de> <20030226120905.GA27130@artcom8.artcom-gmbh.de> <5.1.0.14.1.20030226185953.0242e410@server-1>
Message-ID: <20030226193446.GA10428@lucien.kn-bremen.de>

On 2003-02-26 19:01:18 +0100, Hans Hagen wrote:
> Can you also add a primitive \pdftrailer which acts like the catalog but 
> adds content to the trailer object? We may need this for reaching pdf/x 
> compatibility.

Will do in 1.11a

Best regards
    Martin
-- 
               Martin Schröder, MS@ArtCom-GmbH.DE
          ArtCom GmbH, Grazer Straße 8, D-28359 Bremen
          Voice +49 421 20419-44 / Fax +49 421 20419-10

