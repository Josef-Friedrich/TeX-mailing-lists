From jackos1 at poczta.onet.pl  Fri Jul  1 00:04:13 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul  1 00:04:31 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C419F7.8000302@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl>
Message-ID: <42C46C5D.2040804@poczta.onet.pl>

Hi,

i've asked several everyday-TeX-users (but quite new to pdfTeX) what 
they think about prefixes. \pdf* prefix for commands not related to PDF 
are *more* confusing than non-prefixed that may occasionally conflict 
with macros.

> Hans:
> \ext (extensions) -> \extmatch

IMHO much better than \pdfmatch. However, in 2010 nobody will remember 
that regex support was an extension in 2005. All prefixes encounter this 
problem. Thus, I agree with Taco, that if some command can't be grep-ed 
in representative TeX archives, it can be used as a new primitive.

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From reinhard.kotucha at web.de  Fri Jul  1 00:26:26 2005
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Fri Jul  1 00:26:35 2005
Subject: [NTG-pdftex] input 
In-Reply-To: <42C3E109.1050804@wxs.nl>
References: <42C3E109.1050804@wxs.nl>
Message-ID: <17092.29074.36978.387312@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

  > Hi, how about

  > \pdfinput {filename} 
  > \pdfopenin {filename} 
  > \pdfopenout {filename}

Hi,
if you provide new primitives, it would be nice to have a switch which
forces \pdfopenout to create a file with the name <filename>.

It's quite annoying that `\openout\x=Makefile' creates a file
`Makefile.tex'.

As far as \input and \openin is concerned, Knuth's rule is clear
(first search for <filename> and then for <filename>.tex).  This is ok,
but kpathsea's search strategy is wrong.

But a good solution for \openout is really appreciated.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Jul  1 01:37:55 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jul  1 01:39:38 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C46C5D.2040804@poczta.onet.pl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
Message-ID: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>

On Fri, Jul 01, 2005 at 12:04:13AM +0200, Pawel Jackowski wrote:

> i've asked several everyday-TeX-users (but quite new to pdfTeX) what 
> they think about prefixes. \pdf* prefix for commands not related to PDF 
> are *more* confusing than non-prefixed that may occasionally conflict 
> with macros.
> 
> >Hans:
> >\ext (extensions) -> \extmatch
> 
> IMHO much better than \pdfmatch. However, in 2010 nobody will remember 
> that regex support was an extension in 2005. All prefixes encounter this 
> problem. Thus, I agree with Taco, that if some command can't be grep-ed 
> in representative TeX archives, it can be used as a new primitive.

And what about packages, macros that are not released?
Documents are allowed to contain macro definitions. Thus
existing documents can break because of added new primitives.
With prefixes and reserved namespaces, document and package
writers have the chance to avoid name clashes with future
versions of pdfTeX. Without is asking for unnecessary trouble.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From jackos1 at poczta.onet.pl  Fri Jul  1 09:11:13 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul  1 09:11:29 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>	<42C419F7.8000302@wxs.nl>
	<42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
Message-ID: <42C4EC91.5060902@poczta.onet.pl>

Hi,

> Heiko:
> And what about packages, macros that are not released?
> Documents are allowed to contain macro definitions. Thus
> existing documents can break because of added new primitives[...]

Nope, since macros defined in the document will always override the 
primitive meaning. The document will NOT crash and won't need a 
primitive meaning of the clashed command, since was prepared before the 
command was implemented.

Documents could break if some syntax would change but I belive it will 
never happen. I can't imagine a situation, where some old document 
crashes because of a new primitive redefined in the document.

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Fri Jul  1 10:38:54 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jul  1 10:38:46 2005
Subject: [NTG-pdftex] input
In-Reply-To: <17092.29074.36978.387312@zarniwoop.ms25.local>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
Message-ID: <42C5011E.8020501@wxs.nl>

Reinhard Kotucha wrote:
>>>>>>"Hans" == Hans Hagen <pragma@wxs.nl> writes:
> 
> 
>   > Hi, how about
> 
>   > \pdfinput {filename} 
>   > \pdfopenin {filename} 
>   > \pdfopenout {filename}
> 
> Hi,
> if you provide new primitives, it would be nice to have a switch which
> forces \pdfopenout to create a file with the name <filename>.
> 
> It's quite annoying that `\openout\x=Makefile' creates a file
> `Makefile.tex'.
> 
> As far as \input and \openin is concerned, Knuth's rule is clear
> (first search for <filename> and then for <filename>.tex).  This is ok,
> but kpathsea's search strategy is wrong.

you can influence that in the texmf.cnf file

allow_multiple_suffixes = f

otherwise you will get searches for reinhard.kotucha.tex first if you ask for
reinhard.kotucha explicitly (years ago, when i was running tex over a network i 
noticed that this was slowing down tex a lot and then fabrice made that option)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Fri Jul  1 10:44:13 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jul  1 10:44:02 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
Message-ID: <42C5025D.6050905@wxs.nl>

Heiko Oberdiek wrote:

> existing documents can break because of added new primitives.

a small chance; such a package does not know about the primitive; the only 
danger can be in:

- core latex uses a new primitive
- old package overloads overloads new primitive by macro
- core latex functionality fails

but, for new primitives

> With prefixes and reserved namespaces, document and package
> writers have the chance to avoid name clashes with future
> versions of pdfTeX. Without is asking for unnecessary trouble.

partially true, what if users have \pdf or whatever as prefix for their own 
macros? as said ... etex introduced primitives that clashed with context (and 
probably with other stuff around as well; \protected, \expanded, 
\interactionmode, those \if's etc are all candidates; and yet, we now default to 
etex as engine)

so ... there is always the danger of a clash; the best we can do is to provide a 
list of new primitives in a separate file so that users can use that list to 
parse all their local stuff for clashes.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Jul  1 15:08:16 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jul  1 15:10:52 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C5025D.6050905@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C5025D.6050905@wxs.nl>
Message-ID: <20050701130816.GA2673@m0A0232D2.vpn.uni-freiburg.de>

On Fri, Jul 01, 2005 at 10:44:13AM +0200, Hans Hagen wrote:

> Heiko Oberdiek wrote:
> 
> >existing documents can break because of added new primitives.
> 
> a small chance; such a package does not know about the primitive; the only 
> danger can be in:
> 
> - core latex uses a new primitive
> - old package overloads overloads new primitive by macro
> - core latex functionality fails

For example, package foo defines:
  \newcommand{\match}...
and fails with error message. Then we have frequent news
groups postings:
  "After pdfTeX update package foo is not working, ..."
or
  "Error message after pdfTeX update, ..."
In the eyes of the readers, pdfTeX is guilty, not the
best advertisment for pdfTeX.
And in the worst(normal) case author of package foo doesn't
have time for an update or cannot be found.

> but, for new primitives
> 
> >With prefixes and reserved namespaces, document and package
> >writers have the chance to avoid name clashes with future
> >versions of pdfTeX. Without is asking for unnecessary trouble.
> 
> partially true, what if users have \pdf or whatever as prefix for their own 
> macros?

But users have the chance to know, that there are "reserved"
prefixes and can avoid future name clashes, when new
primitives are introduced.

> as said ... etex introduced primitives that clashed with context 
> (and probably with other stuff around as well; \protected, \expanded, 
> \interactionmode, those \if's etc are all candidates; and yet, we now 
> default to etex as engine)

Perhaps we can ask the etex people, their experience and what
they would do.

> so ... there is always the danger of a clash; the best we can do is to 
> provide a list of new primitives in a separate file so that users can use 
> that list to parse all their local stuff for clashes.

And they would have to do it again and again for each new version
of pdfTeX that introduces new primitives.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
From oberdiek at uni-freiburg.de  Fri Jul  1 15:16:01 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jul  1 15:15:54 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C4EC91.5060902@poczta.onet.pl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
Message-ID: <20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>

On Fri, Jul 01, 2005 at 09:11:13AM +0200, Pawel Jackowski wrote:

> >Heiko:
> >And what about packages, macros that are not released?
> >Documents are allowed to contain macro definitions. Thus
> >existing documents can break because of added new primitives[...]
> 
> Nope, since macros defined in the document will always override the 
> primitive meaning. The document will NOT crash and won't need a 
> primitive meaning of the clashed command, since was prepared before the 
> command was implemented.

Examples with a new primitive: \match

Szenario A: User defines macro:
  \newcommand{\match}{Hello World}
  ==> Error message, \match already defined.

Szenario B:
  \def\match!#1!#2!#3{...}

  Some package (hyperref, ...) uses the new primitive:
  \match{...}{...}
  ==> Document fails with: Use of \match doesn't match its definition.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Fri Jul  1 16:13:59 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jul  1 16:14:07 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42C54FA7.6010002@wxs.nl>

Heiko Oberdiek wrote:
> On Fri, Jul 01, 2005 at 09:11:13AM +0200, Pawel Jackowski wrote:
> 
> 
>>>Heiko:
>>>And what about packages, macros that are not released?
>>>Documents are allowed to contain macro definitions. Thus
>>>existing documents can break because of added new primitives[...]
>>
>>Nope, since macros defined in the document will always override the 
>>primitive meaning. The document will NOT crash and won't need a 
>>primitive meaning of the clashed command, since was prepared before the 
>>command was implemented.
> 
> 
> Examples with a new primitive: \match
> 
> Szenario A: User defines macro:
>   \newcommand{\match}{Hello World}
>   ==> Error message, \match already defined.
> 
> Szenario B:
>   \def\match!#1!#2!#3{...}
> 
>   Some package (hyperref, ...) uses the new primitive:
>   \match{...}{...}
>   ==> Document fails with: Use of \match doesn't match its definition.

so, for latex the solution would be (in the latex specific initialization file):

\let\pdfmatch\match \let\match\undefined

That way you get (1) a prefix (one that will not clash with other prefixes) and 
(2) we keep tex prefix-clean

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Jul  1 16:23:02 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jul  1 16:22:32 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C54FA7.6010002@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
Message-ID: <20050701142301.GA3029@m0A0232D2.vpn.uni-freiburg.de>

On Fri, Jul 01, 2005 at 04:13:59PM +0200, Hans Hagen wrote:

> >  Some package (hyperref, ...) uses the new primitive:
> >  \match{...}{...}
> >  ==> Document fails with: Use of \match doesn't match its definition.
> 
> so, for latex the solution would be (in the latex specific initialization 
> file):
> 
> \let\pdfmatch\match \let\match\undefined
> 
> That way you get (1) a prefix (one that will not clash with other prefixes) 
> and (2) we keep tex prefix-clean

But then a package doesn't know, whether there is a special format
that remaps the primitives. First it must guess the name of the
primitive, before using it. And there are packages that work with
different formats (eg. plain and latex). Thus this way does not
provide a reliable solution.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
From Fabrice.Popineau at supelec.fr  Fri Jul  1 17:51:35 2005
From: Fabrice.Popineau at supelec.fr (Fabrice Popineau)
Date: Fri Jul  1 17:51:31 2005
Subject: [NTG-pdftex] input
In-Reply-To: <42C5011E.8020501@wxs.nl> (Hans Hagen's message of "Fri, 01 Jul
	2005 10:38:54 +0200")
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C5011E.8020501@wxs.nl>
Message-ID: <8y0q4j94.fsf@esemetz.metz.supelec.fr>

* Hans Hagen <pragma@wxs.nl> writes:

    > you can influence that in the texmf.cnf file

    > allow_multiple_suffixes = f

I think this is windows only.

Fabrice

From martin at oneiros.de  Fri Jul  1 20:04:27 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul  1 20:21:49 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C54FA7.6010002@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
Message-ID: <20050701180427.GB24398@lucien.kn-bremen.de>

On 2005-07-01 16:13:59 +0200, Hans Hagen wrote:
> so, for latex the solution would be (in the latex specific initialization 
> file):
> 
> \let\pdfmatch\match \let\match\undefined
> 
> That way you get (1) a prefix (one that will not clash with other prefixes) 
> and (2) we keep tex prefix-clean

Yes, that would be possible (e.g. in pdftexconfig.tex in tetex).
But it needs a special format and it's non-portable. The reverse
would also be possible: \let\match\ptexmatch

Our "problem" is that TeX, the LaTeX kernel and plain.tex are
very stable, so nobody expects new primitives from the engine.
And we don't want to break backwards compatibility with old
documents.

The only way for this is a reserved namespace like \ptex (it
seems only texinfo uses it, and it's use won't break with a new
pdftex).

I suggest introducing non-pdf-extensions with \ptex$foo.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From hartmut_henkel at gmx.de  Fri Jul  1 20:47:56 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jul  1 20:47:59 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050701180427.GB24398@lucien.kn-bremen.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl> <20050701180427.GB24398@lucien.kn-bremen.de>
Message-ID: <Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>

On Fri, 1 Jul 2005, Martin Schr?der wrote:

> On 2005-07-01 16:13:59 +0200, Hans Hagen wrote:
> > so, for latex the solution would be (in the latex specific
> > initialization file):
> >
> > \let\pdfmatch\match \let\match\undefined
> >
> > That way you get (1) a prefix (one that will not clash with other
> > prefixes) and (2) we keep tex prefix-clean
>
> Yes, that would be possible (e.g. in pdftexconfig.tex in tetex). But
> it needs a special format and it's non-portable. The reverse would
> also be possible: \let\match\ptexmatch

maybe one could find a way to enable new primitives, so that they are
hidden if not enabled. Maybe removing the primitive name strings from
the hash and keeping them somewhere safe until they are required? Like
\use\match? A little like in Perl...

Regards, Hartmut
From taco at elvenkind.com  Fri Jul  1 22:10:27 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri Jul  1 22:13:04 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>	<42C419F7.8000302@wxs.nl>
	<42C46C5D.2040804@poczta.onet.pl>	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C4EC91.5060902@poczta.onet.pl>	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
Message-ID: <42C5A333.9040904@elvenkind.com>

Hartmut Henkel wrote:
> 
> 
> maybe one could find a way to enable new primitives, so that they are
> hidden if not enabled. Maybe removing the primitive name strings from
> the hash and keeping them somewhere safe until they are required? Like
> \use\match? A little like in Perl...

I'm pondering on Hans' \primitive\par notion, which is almost the same
idea. After  \let\par\undefined, \primitive\par should still execute a
\par internal command, so Hans' and your idea seem two facets of the
same jewel.


Taco

From hartmut_henkel at gmx.de  Fri Jul  1 23:53:40 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jul  1 23:53:45 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C5A333.9040904@elvenkind.com>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl> <20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
Message-ID: <Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>

On Fri, 1 Jul 2005, Taco Hoekwater wrote:
> Hartmut Henkel wrote:
> > maybe one could find a way to enable new primitives, so that they
> > are hidden if not enabled. Maybe removing the primitive name strings
> > from the hash and keeping them somewhere safe until they are
> > required? Like \use\match? A little like in Perl...
>
> I'm pondering on Hans' \primitive\par notion, which is almost the same
> idea. After \let\par\undefined, \primitive\par should still execute a
> \par internal command, so Hans' and your idea seem two facets of the
> same jewel.

yes, difference might be that i meant it in the sense that \use\match
wouldn't execute \match, it would only install it at its destined
position within the hash (if that's possible at all), so that you from
then on can call it by a simple \match. (which gets tricky if in the
meantime a macro with the same name has been defined)

Regards, Hartmut
From reinhard.kotucha at web.de  Sat Jul  2 00:11:48 2005
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat Jul  2 00:12:01 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050701180427.GB24398@lucien.kn-bremen.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
Message-ID: <17093.49060.10208.873085@zarniwoop.ms25.local>

>>>>> "Martin" == Martin Schr?der <martin@oneiros.de> writes:

  > [...]
  > Our "problem" is that TeX, the LaTeX kernel and plain.tex are very
  > stable, so nobody expects new primitives from the engine.  And we
  > don't want to break backwards compatibility with old documents.

  > The only way for this is a reserved namespace like \ptex (it seems
  > only texinfo uses it, and it's use won't break with a new pdftex).

You never can be sure that a new primitive leads to a name clash.  The
only thing you can do is to invent names for new primitives which are
quite unlikely to be used by macro writers.

So Martin's idea is not bad...

  > I suggest introducing non-pdf-extensions with \ptex$foo.

... though I prefer, instead of using `$', to make use of the fact
that TeX is case sensitive.  (\PTEXfoo instead of \ptex$foo).

I think that it is quite unlikely that someone wrote a macro yet which
name begins with `PTEX'.  Though \catcode changes might provide a
higher level of security, I think that changing \catcodes makes the
primitives too inconvenient to use.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From jackos1 at poczta.onet.pl  Sat Jul  2 00:36:13 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sat Jul  2 00:37:10 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <17093.49060.10208.873085@zarniwoop.ms25.local>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>	<42C419F7.8000302@wxs.nl>
	<42C46C5D.2040804@poczta.onet.pl>	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C4EC91.5060902@poczta.onet.pl>	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>	<42C54FA7.6010002@wxs.nl>	<20050701180427.GB24398@lucien.kn-bremen.de>
	<17093.49060.10208.873085@zarniwoop.ms25.local>
Message-ID: <42C5C55D.2000806@poczta.onet.pl>

 > Reinhard:
> I think that it is quite unlikely that someone wrote a macro yet which
> name begins with `PTEX'[...]

The last chance the user has to avoid *any* clashes with *any* 
primitives in own home made macros is to use \CAPITALS. IMHO we should 
never steal this chance...

-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From reinhard.kotucha at web.de  Sat Jul  2 00:40:23 2005
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat Jul  2 00:40:43 2005
Subject: [NTG-pdftex] input
In-Reply-To: <8y0q4j94.fsf@esemetz.metz.supelec.fr>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C5011E.8020501@wxs.nl> <8y0q4j94.fsf@esemetz.metz.supelec.fr>
Message-ID: <17093.50775.110862.883567@zarniwoop.ms25.local>

>>>>> "Fabrice" == Fabrice Popineau <Fabrice.Popineau@supelec.fr> writes:

  >> allow_multiple_suffixes = f

  > I think this is windows only.

It would be nice if this option would go into web2c.


But there is still the problem with \openout.  I suppose that this can
only be fixed in pdfTeX rather than in web2c/kpathsea.

Cheers,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From taco at elvenkind.com  Sat Jul  2 00:49:36 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat Jul  2 00:52:16 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
Message-ID: <42C5C880.5010101@elvenkind.com>

Hartmut Henkel wrote:
> On Fri, 1 Jul 2005, Taco Hoekwater wrote:
> 
>>Hartmut Henkel wrote:
>>
>>>maybe one could find a way to enable new primitives, so that they
>>>are hidden if not enabled. Maybe removing the primitive name strings
>>>from the hash and keeping them somewhere safe until they are
>>>required? Like \use\match? A little like in Perl...
>>
>>I'm pondering on Hans' \primitive\par notion, which is almost the same
>>idea. After \let\par\undefined, \primitive\par should still execute a
>>\par internal command, so Hans' and your idea seem two facets of the
>>same jewel.
> 
> yes, difference might be that i meant it in the sense that \use\match
> wouldn't execute \match, it would only install it at its destined
> position within the hash (if that's possible at all), so that you from
> then on can call it by a simple \match. (which gets tricky if in the
> meantime a macro with the same name has been defined)

The jewel is to be able to reference a specific internal command,
regardless of the current execution context. I have some ideas on
how this could be done, but I still need some time to think it
through. I'll post an initial proposal soon, I hope.

Taco

From martin at oneiros.de  Sat Jul  2 01:32:10 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jul  2 09:33:02 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <17093.49060.10208.873085@zarniwoop.ms25.local>
References: <42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<17093.49060.10208.873085@zarniwoop.ms25.local>
Message-ID: <20050701233210.GG24398@lucien.kn-bremen.de>

On 2005-07-02 00:11:48 +0200, Reinhard Kotucha wrote:
>   > I suggest introducing non-pdf-extensions with \ptex$foo.
> 
> ... though I prefer, instead of using `$', to make use of the fact
> that TeX is case sensitive.  (\PTEXfoo instead of \ptex$foo).

Uh, I use $foo as a generic placeholder (think of shell
parameters). So no $ in the names, just \ptexfoo.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Sat Jul  2 16:12:55 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sat Jul  2 16:12:40 2005
Subject: [NTG-pdftex] input
In-Reply-To: <17092.29074.36978.387312@zarniwoop.ms25.local>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
Message-ID: <42C6A0E7.3070206@wxs.nl>

Reinhard Kotucha wrote:
>>>>>>"Hans" == Hans Hagen <pragma@wxs.nl> writes:
> 
> 
>   > Hi, how about
> 
>   > \pdfinput {filename} 
>   > \pdfopenin {filename} 
>   > \pdfopenout {filename}
> 
> Hi,
> if you provide new primitives, it would be nice to have a switch which
> forces \pdfopenout to create a file with the name <filename>.
> 
> It's quite annoying that `\openout\x=Makefile' creates a file
> `Makefile.tex'.

how about instead of a switch an extra:

\pdfopenoutfile {filename}

that does not add the suffix; that way one can also say:

\let\pdfopenout\pdfopenoutfile

in order to loose the auto .tex appending

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat Jul  2 16:20:46 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sat Jul  2 16:20:33 2005
Subject: [NTG-pdftex] input
In-Reply-To: <17093.50775.110862.883567@zarniwoop.ms25.local>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C5011E.8020501@wxs.nl> <8y0q4j94.fsf@esemetz.metz.supelec.fr>
	<17093.50775.110862.883567@zarniwoop.ms25.local>
Message-ID: <42C6A2BE.7090902@wxs.nl>

Reinhard Kotucha wrote:
>>>>>>"Fabrice" == Fabrice Popineau <Fabrice.Popineau@supelec.fr> writes:
> 
> 
>   >> allow_multiple_suffixes = f
> 
>   > I think this is windows only.

you're kidding, i knew that \input http://whatever... and for a while quoted 
filenames was windows only, but i thoight that this one made it into web2c; i 
wonder how much more got lost over time ... (some mp and etex patches)

> It would be nice if this option would go into web2c.

sure, but .... http://www.fptex.org/xemtex-7.html ... shows some light on this


Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat Jul  2 16:36:39 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sat Jul  2 16:36:22 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050701142301.GA3029@m0A0232D2.vpn.uni-freiburg.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701142301.GA3029@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42C6A677.4040605@wxs.nl>

Heiko Oberdiek wrote:
> On Fri, Jul 01, 2005 at 04:13:59PM +0200, Hans Hagen wrote:
> 
> 
>>> Some package (hyperref, ...) uses the new primitive:
>>> \match{...}{...}
>>> ==> Document fails with: Use of \match doesn't match its definition.
>>
>>so, for latex the solution would be (in the latex specific initialization 
>>file):
>>
>>\let\pdfmatch\match \let\match\undefined
>>
>>That way you get (1) a prefix (one that will not clash with other prefixes) 
>>and (2) we keep tex prefix-clean
> 
> 
> But then a package doesn't know, whether there is a special format
> that remaps the primitives. First it must guess the name of the
> primitive, before using it. And there are packages that work with
> different formats (eg. plain and latex). Thus this way does not
> provide a reliable solution.

it depends, if you have a (latex) convention that the prefix is \pdf then it can 
test for

   \ifx\pdfmatch\undefined ...

etc. Since latex packages work for latex only it will not hurt anything outside 
that scope.

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Sat Jul  2 20:19:30 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jul  2 20:46:09 2005
Subject: [NTG-pdftex] Re: Uniform and Normal Distribution Pseudo-random
	numbers patch
In-Reply-To: <42C012D8.1070309@elvenkind.com>
References: <E1DmurU-0000UG-00@sarovar.org> <42C012D8.1070309@elvenkind.com>
Message-ID: <20050702181930.GB2247@lucien.kn-bremen.de>

On 2005-06-27 16:53:12 +0200, Taco Hoekwater wrote:
>   randoms.ch --
>   This is a WEB change file for pseudo-random numbers in
>   pdftex 1.30 and above.
> 
>   There are four new primitives:
> 
>   \uniformdeviate <count>
>    Generates a uniformly distributed random integer value
>    between 0 (inclusive) and <count> (exclusive).
>    This primitive expands to a list of tokens.
> 
>   \normaldeviate
>    Expands to a random integer value with a mean of 0 and a
>    unit of 65536.
>    This primitive expands to a list of tokens.
> 
>   \randomseed
>    You can use \the\randomseed to query the current seed value,
>    so you can e.g. the value to the log file.
> 
>    The initial value of the seed is derived from the system time,
>    and is not more than 1,000,999,999 (this ensures that the value
>    can be used with commands like \count).
> 
>   \setrandomseed <count>
>    This sets the random seed to a specific value, allowing you
>    to re-play sequences fo semi-randoms at a later moment.
> 
>   Most of the actual code is taken from metapost, and originally
>   written by Knuth, for Metafont. Glue to make it work in TeX is
>   by me. If you find an error, it is bound to be in my code,
>   not Knuth's :-)

Very nice. I've added a call of init_randoms(random_seed) to
"Implement \.{\\ptexsetrandomseed}"; this allows one to restart
the random generator.

And I've renamed the primitives to \ptexuniformdeviate,
\ptexnormaldeviate, \ptexrandomseed and \ptexsetrandomseed.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From reinhard.kotucha at web.de  Sat Jul  2 21:08:22 2005
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat Jul  2 21:08:28 2005
Subject: [NTG-pdftex] input
In-Reply-To: <42C6A0E7.3070206@wxs.nl>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C6A0E7.3070206@wxs.nl>
Message-ID: <17094.58918.624937.908650@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

  > Reinhard Kotucha wrote:

  >> Hi, if you provide new primitives, it would be nice to have a
  >> switch which forces \pdfopenout to create a file with the name
  >> <filename>.
  >> 
  >> It's quite annoying that `\openout\x=Makefile' creates a file
  >> `Makefile.tex'.

  > how about instead of a switch an extra:

  > \pdfopenoutfile {filename}

Hans, I meant `switch' in a more general way.  

1. A command-line switch would be possible but that would determine
   the behaviour of all occurrences of \pdfopenoutfile within the
   current job.

2. Another solution would be a prefix command like \immediate.  This
   can be useful if it can be applied to some other primitives.  But
   since we need it for opening a file only, it doesn't look like a
   good solution.

3. A primitive that acts like a switch, like \pdfcompresslevel would
   be possible. 

4. The best solution is certainly to add an optional argument to
   \pdfopenoutfile.  This would avoid the need for new primitives
   (which reduces the probability of name clashes).

I prefer 4., and if people need a switch (3.) then they can do that by
macro programming.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From taco at elvenkind.com  Sat Jul  2 21:25:49 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat Jul  2 21:28:28 2005
Subject: [NTG-pdftex] Re: Uniform and Normal Distribution Pseudo-random
	numbers patch
In-Reply-To: <20050702181930.GB2247@lucien.kn-bremen.de>
References: <E1DmurU-0000UG-00@sarovar.org> <42C012D8.1070309@elvenkind.com>
	<20050702181930.GB2247@lucien.kn-bremen.de>
Message-ID: <42C6EA3D.4070505@elvenkind.com>

Martin Schr?der wrote:
> On 2005-06-27 16:53:12 +0200, Taco Hoekwater wrote:
> 
> Very nice. I've added a call of init_randoms(random_seed) to
> "Implement \.{\\ptexsetrandomseed}"; this allows one to restart
> the random generator.

Cool. That was the intention all along, of course.

Taco
From noreply at sarovar.org  Sat Jul  2 21:43:55 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jul  2 21:50:09 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1Donu7-00039z-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From martin at oneiros.de  Sat Jul  2 21:39:48 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jul  2 22:23:14 2005
Subject: [NTG-pdftex] \ptexmatch (was: Patch EscapeAndOther)
In-Reply-To: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
Message-ID: <20050702193948.GE2247@lucien.kn-bremen.de>

On 2005-06-25 03:52:01 +0200, Heiko Oberdiek wrote:
> \pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>}
>   Implements pattern matching using the POSIX regex
>   (a standard library at least in my linux).
>   It returns the same values as \pdfstrcmp, but
>   with the following semantics:
>     -1: error case (invalid pattern, ...)
>      0: no match
>      1: match found
>   Options:
>   * icase: case insensitive matching
>   * subcount: it sets the table size for found subpatterns.
>     A number "-1" resets the table size to the start default.
> 
>   See the manual page regex.3 and regex.7.
> 
>   The implementation shows a possible interface to
>   pattern matching in TeX. Therefore only the basics
>   is implemented.
>   Flags:
>   * REG_EXTENDED is set in the implementation.
>   * REG_ICASE: can be set by user.
>   * other: not implemented.
> 
> \pdflastmatch <number>
>   The result of \pdfmatch is stored in an array.
>   The entry "0" contains the match, the following
>   entries submatches. The positions of the matches
>   are also available. They are encoded in the following
>   manner to avoid another primitive:
>     <position> "->" <match string>
>   "->" is used as separator in the tradition of \meaning.
>   There exists macros for parsing the output of \meaning
>   (e.g. in LaTeX: \strip@prefix).
>   The position "-1" with an empty string indicates that
>   this entry is not set.
>   Example:
>     \def\msg#{\immediate\write16 }
>     \msg{\pdfmatch{(l+)o (W(o))}{Hello World}}
>     \msg{\pdflastmatch0}
>     \msg{\pdflastmatch1}
>     \msg{\pdflastmatch2}
>     \msg{\pdflastmatch3}
>     \msg{\pdflastmatch4}
>   Result:
>     1
>     2->llo Wo
>     2->ll
>     6->Wo
>     7->o
>     -1->

How can one inquire the number of matches found, i.e. the size of
the array? This would be sub_match_count in utils.c .

Or does one have to parse increasing \ptexlastmatch'es till one
get's a -1?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Sat Jul  2 21:43:34 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jul  2 22:23:14 2005
Subject: [NTG-pdftex] \pdffiledump (was: Patch EscapeAndOther)
In-Reply-To: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
Message-ID: <20050702194334.GG2247@lucien.kn-bremen.de>

On 2005-06-25 03:52:01 +0200, Heiko Oberdiek wrote:
> New in patch EscapeAndOther:
>   * \pdfcreationdate
>   * \pdffilemoddate
>   * \pdffilesize
>   * \pdfmdfivesum
>   * \pdffiledump
>   * \pdfshellescape
>   * \pdfmatch and \pdflastmatch
>   * Start with bug fix: quotes are legal in other operating
>     systems than windows.

And \pdffiledump. What does it do?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Sat Jul  2 22:22:51 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jul  2 22:23:45 2005
Subject: [NTG-pdftex] 1.30.0-rc2
In-Reply-To: <20050616195720.GA4215@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
Message-ID: <20050702202251.GH2247@lucien.kn-bremen.de>

http://sarovar.org/download.php/655/pdftex-1.30.0-rc2.zip

NEWS:
-----------------------------------------------------
- pdfxtex (introduced with 1.20a) is gone; all extensions are now in pdf(e)tex.
- Some primitives have been renamed; the old names will still work, but are
  deprecated and give a warning that they are obsolete:
    \pdfoptionpdfminorversion         -> \pdfminorversion
    \pdfoptionalwaysusepdfpagebox     -> \pdfforcepagebox
    \pdfoptionpdfinclusionerrorlevel  -> \pdfinclusionerrorlevel
- pdftex knows two new units:
  - new Didot (1nd=0.375mm)
  - new Cicero (1nc=12nd)
- New primitives: 
  - The pdfTeX team now reserves the namespaces \pdf* and \ptex* for new
    primitives of pdfTeX; \pdf* will be used for pdf-specific primitives and
    \ptex* for general extensions.
  - Inclusion of pngs has been greatly improved: It now does
    - alpha channel and transparency (only if %!PDF >=1.4)
    - 16-bit colour (only if %!PDF >=1.5); this must be enabled by setting
      \pdfimagehicolor to 1.
    - gamma correction; this must be enabled by setting \pdfimageapplygamma to
      1. The device gamma is taken from \pdfgamma. If no embedded value can be
      found in the png image, then the value of \pdfimagegamma is used instead.
    - fast direct embedding of png streams, if their structure allows this; the
      automatic fall-back is to decompress and re-compress as before.
  - pdfTeX now has an interface to the precise system time (if available) as an
    aid in benchmarking TeX macro code. 
    - \ptexelapsedtime is a read-only integer that (initially) returns the
      amount of time passed since the start of this run. This amount is given
      in `scaled seconds': the value 65536 counts as one second. If more time
      has passed than 32767 seconds, (2^31)-1 will be returned.
    - \ptexresettimer updates the internal timer, such that subsequent calls to
      \ptexelapsedtime will restart from 0.
  - pdfTeX can now generate random numbers.
    - \ptexuniformdeviate <count> generates a uniformly distributed random
      integer value between 0 (inclusive) and <count> (exclusive).
    - \ptexnormaldeviate expands to a random integer value with a mean of 0 and
      a unit of 65536. 
    - \ptexrandomseed allows access to the current seed value.
    - \ptexsetrandomseed <count> sets the random seed to a specific value.
  - \ptexnoligatures\f disables ligatures for the loaded font \f.
  - \ptexstrcmp{<a>}{<b>} compares two strings and returns the strings "0" if
    <a> equals <b>, "-1" if <a> is less than <b>, "1" if <a> is greater than
    <b>
  - \ptexretval is an integer that is either <0, 0, or >0; currently it's used
    by \ptexstrcmp.
  - escaping strings:
    - \pdfescapestring{<a>} escapes the string <a> so that it can be used as
      PDF string.
    - \pdfescapename{<a>} escapes the string <a> so that it can be used as PDF
      name.
    - \pdfescapehex{<a>} converts the string <a> to uppercase hexadecimal
      representation.
    - \pdfunescapehex{<b>} reverses the effect of \pdfescapehex
  - \pdfcreationdate expands to the date string that pdfTeX uses in the info
    dict as default.
  - \ptexfilemoddate{<file>} expands to the modification date of <file> in the
    same format as \pdfcreationdate (PDF date format).
  - \ptexfilesize{<file>} expands to the size of <file> as string.
  - \ptexmdfivesum{<abc>} or \ptexmdfivesum file {<file>} calculates the md5
    sum (of a string or a file) and converts it to uppercase hexadecimal format
    (same as \pdfescapehex).
  - \ptexshellescape is a read-only integer that is 1 if \write18 is enabled, 0
    otherwise.
  - \pdfxformname <object number>, which expands to the number in the
    corresponding form XObject name.
  - \leftmarginkern <box number> and \rightmarginkern <box number> tell the
    margin kern at the left and right side of the horizontal list stored in box
    <box number>.
  - \pdfpkmode is a token register that sets the MF mode for pixel font
    generation. The contents of this register is dumped into the format, so one
    can (optionally) preset it e.g. in part of pdftexconfig.tex.
  - \pdftracingfonts: An integer variable controlling the tracing of font
    expansion. It is zero by default; then we get a log (with fontexpansion)
    like this
    ...\tenrm t
    ...\tenrm (+20) e
    Without font expansion, this default should be compatible with TeX's
    original log output.
    If \pdftracingfonts is set to 1 (or greater), we get a more verbose log:
    ...\xivtt (cmtt10@14.0pt) t
    ...\xivtt (cmtt10+20@14.0pt) e
    See also bug 304.
- New experimental primitives:
  - \ptexmatch [icase] [subcount <number>}] {<pattern>}{<string>}
    Implements pattern matching using the POSIX regex.
    It returns the same values as \ptexstrcmp, but with the following semantics: 
      -1: error case (invalid pattern, ...)
       0: no match
       1: match found
    Options:
    * icase: case insensitive matching
    * subcount: it sets the table size for found subpatterns.
      A number "-1" resets the table size to the start default.
  - \ptexlastmatch <number>
    The result of \ptexmatch is stored in an array. The entry "0" contains the
    match, the following entries submatches. The positions of the matches are
    also available. They are encoded:
      <position> "->" <match string>
    The position "-1" with an empty string indicates that this entry is not
    set.
- The primitive \pdfmovechar has been removed (bug 294)
- Bugfixes:
  - empty strings are not supressed anymore (bug 335)
  - \unhboxing and character protusion didn't work well together (bug 292)
  - --jobname didn't work if there was no filename at all (bug 302)
  - Some problem with fonts on solaris (bug 315)
  - Dangling font objects with non-replacable fonts (bug 311).
  - \pdfxform didn't work with box>255 (bug 310)
  - cmap: unicode ???? is mapped to multiple glyphs (bug 306).
-----------------------------------------------------

TODO:
- TEST
- documentation: 
  - manual
  - release notes
  - check NEWS
- update change-files.txt

I'm aiming for a release next week.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Sat Jul  2 23:19:03 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun Jul  3 00:27:41 2005
Subject: [NTG-pdftex] Re: [ pdftex-Bugs-377 ] unqoute image filenames not
	only on windows
In-Reply-To: <E1Donu7-00039z-00@sarovar.org>
References: <E1Donu7-00039z-00@sarovar.org>
Message-ID: <20050702211903.GJ2247@lucien.kn-bremen.de>

On 2005-07-03 01:13:55 +0530, noreply@sarovar.org wrote:
> pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
> 
> contains in the function readfile() a code block to 

It's in readimage :->

> unqoute file names which is inside #ifdef WIN32 ... 
> 
> #endif.
> 
> This code should be enabled on all platforms (or at
> 
> least on linux), since quoted filenames (which are
> 
> necessary if the name contains spaces) do not only work
> 
> well on linux.

Done (rc3).

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From jackos1 at poczta.onet.pl  Sun Jul  3 12:18:54 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sun Jul  3 12:19:00 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <20050703024418.GA2784@monty.localnet>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
Message-ID: <42C7BB8E.6070800@poczta.onet.pl>

Hi there,

what do you think about adding \pdfpagesresources primitive toks list?

> Thanh:
> the answer is simple: nobody ever asked for it, and I don't
> need it for myself :). If considered it can be added without
> problems.

I agree we can live without \pdfpagesresources, as well as we could
without \pdfpagesattr. Hovever, collecting named resources per document
is much easier than per page. In many cases we don't need different
/Resources dict for each page and globally assigned (identical)
\pdfpageresources toks list is unnecessarily written into PDF output
each time the page is shipped out. It makes a difference for big documents.

Of course one can save some time and space by writing resources as
objects and storing object rerefences in \pdfpageresources. But to make
things cool I'd opt to add primitive \pdfpagesresources toks list.

?
--
Pawe/l Jackowski
P.Jackowski@gust.org.pl

From te at dbs.uni-hannover.de  Sun Jul  3 19:36:23 2005
From: te at dbs.uni-hannover.de (Thomas Esser)
Date: Sun Jul  3 19:36:31 2005
Subject: [NTG-pdftex] 1.30.0-rc2
In-Reply-To: <20050702202251.GH2247@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
Message-ID: <20050703173623.GA8819@dbs.uni-hannover.de>

> http://sarovar.org/download.php/655/pdftex-1.30.0-rc2.zip

sarovar.org is down now. Can someone please put this somewhere else
for download?

Thomas
From jackos1 at poczta.onet.pl  Sun Jul  3 20:56:22 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sun Jul  3 20:57:13 2005
Subject: [NTG-pdftex] 1.30.0-rc2
In-Reply-To: <20050703173623.GA8819@dbs.uni-hannover.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>	<20050616195720.GA4215@lucien.kn-bremen.de>	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050703173623.GA8819@dbs.uni-hannover.de>
Message-ID: <42C834D6.8080701@poczta.onet.pl>

Thomas Esser napisa?(a):
>>http://sarovar.org/download.php/655/pdftex-1.30.0-rc2.zip
> 
> sarovar.org is down now. Can someone please put this somewhere else
> for download?

http://pawel.acchsh.com/pdftex-1.30.0-rc2.zip

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Sun Jul  3 22:51:47 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jul  3 22:51:27 2005
Subject: [NTG-pdftex] input
In-Reply-To: <17094.58918.624937.908650@zarniwoop.ms25.local>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C6A0E7.3070206@wxs.nl>
	<17094.58918.624937.908650@zarniwoop.ms25.local>
Message-ID: <42C84FE3.6040508@wxs.nl>

Reinhard Kotucha wrote:
>>>>>>"Hans" == Hans Hagen <pragma@wxs.nl> writes:
> 
> 
>   > Reinhard Kotucha wrote:
> 
>   >> Hi, if you provide new primitives, it would be nice to have a
>   >> switch which forces \pdfopenout to create a file with the name
>   >> <filename>.
>   >> 
>   >> It's quite annoying that `\openout\x=Makefile' creates a file
>   >> `Makefile.tex'.
> 
>   > how about instead of a switch an extra:
> 
>   > \pdfopenoutfile {filename}
> 
> Hans, I meant `switch' in a more general way.  
> 
> 1. A command-line switch would be possible but that would determine
>    the behaviour of all occurrences of \pdfopenoutfile within the
>    current job.
> 
> 2. Another solution would be a prefix command like \immediate.  This
>    can be useful if it can be applied to some other primitives.  But
>    since we need it for opening a file only, it doesn't look like a
>    good solution.
> 
> 3. A primitive that acts like a switch, like \pdfcompresslevel would
>    be possible. 
> 
> 4. The best solution is certainly to add an optional argument to
>    \pdfopenoutfile.  This would avoid the need for new primitives
>    (which reduces the probability of name clashes).
> 
> I prefer 4., and if people need a switch (3.) then they can do that by
> macro programming.

yet another alternative is

   5. \pdfdefaultoutsuffix{toks}

so that we can say \pdfdefaultoutsuffix{} to get rid of the funny default

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sun Jul  3 22:57:31 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jul  3 22:57:10 2005
Subject: [NTG-pdftex] Re: Uniform and Normal Distribution Pseudo-random
	numbers patch
In-Reply-To: <20050702181930.GB2247@lucien.kn-bremen.de>
References: <E1DmurU-0000UG-00@sarovar.org> <42C012D8.1070309@elvenkind.com>
	<20050702181930.GB2247@lucien.kn-bremen.de>
Message-ID: <42C8513B.9010307@wxs.nl>

Martin Schr?der wrote:

> And I've renamed the primitives to \ptexuniformdeviate,
> \ptexnormaldeviate, \ptexrandomseed and \ptexsetrandomseed.

i'm still not that satisfied with the p in there, since those are more generic 
extensions that pdftex only and we want them to end up in aleph and xetex as 
well (unless the p stands for 'primitive')

(in which case \prim or \primitive would probably be a better prefix)

[the

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sun Jul  3 23:20:50 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jul  3 23:20:37 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <42C7BB8E.6070800@poczta.onet.pl>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
	<42C7BB8E.6070800@poczta.onet.pl>
Message-ID: <42C856B2.8070308@wxs.nl>

Pawel Jackowski wrote:
> Hi there,
> 
> what do you think about adding \pdfpagesresources primitive toks list?
> 
>> Thanh:
>> the answer is simple: nobody ever asked for it, and I don't
>> need it for myself :). If considered it can be added without
>> problems.
>  
> I agree we can live without \pdfpagesresources, as well as we could
> without \pdfpagesattr. Hovever, collecting named resources per document
> is much easier than per page. In many cases we don't need different
> /Resources dict for each page and globally assigned (identical)
> \pdfpageresources toks list is unnecessarily written into PDF output
> each time the page is shipped out. It makes a difference for big documents.
> 
> Of course one can save some time and space by writing resources as
> objects and storing object rerefences in \pdfpageresources. But to make
> things cool I'd opt to add primitive \pdfpagesresources toks list.

i'm not sure if i understand the problem, but as long as adding a top level page 
resource does not break individual page resources it's fine with me;

i need to check the pdf ref, but do resources in the /Page object overload those 
on the /Pages one?; anyhow, the resources entry in a /Page object is required 
(with an empty dict refering to the top level one; so, whataver functionality is 
added, it may not change the current behaviour

(needs some testing i guess)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jackos1 at poczta.onet.pl  Mon Jul  4 00:18:48 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Mon Jul  4 00:19:40 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <42C856B2.8070308@wxs.nl>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
	<42C7BB8E.6070800@poczta.onet.pl> <42C856B2.8070308@wxs.nl>
Message-ID: <42C86448.3050504@poczta.onet.pl>

Hi Hans,

> i'm not sure if i understand the problem, but as long as adding a top 
> level page resource does not break individual page resources it's fine 
> with me;

The only problem is that if \pdfpageresources toks list is used as 
global (that is probably quite common) in the PDF output we get the same 
code repeated as many times as number of pages in the document.

> i need to check the pdf ref, but do resources in the /Page object 
> overload those on the /Pages one?; 

Resources dictionary is inheritable, but now I see that this inheritance 
is different than for page attributes like page boxes. I thought that if 
some resource can't be found in local dictionary (in /Page) it is 
searched in parent node (/Pages). It seems I was wrong; the following 
produce a corrupted PDF:

\immediate\pdfobj{<</Type /ExtGState /CA 0.3 /ca 0.3>>}
\edef\A{/GS1 \the\pdflastobj\space0 R}
\immediate\pdfobj{<</Type /ExtGState /CA 0.7 /ca 0.7>>}
\edef\B{/GS2 \the\pdflastobj\space0 R}

\edef\next{\pdfpagesattr{/Resources << /ExtGState <<\A>> >>}}\next
\edef\next{\pdfpageresources{/ExtGState <<\B>>}}\next

\pdfliteral{/GS1 gs}blah
\pdfliteral{/GS2 gs}blah

\end

It seems that /Resources dict is inherited from /Pages ONLY if there is 
NO local /Resources dict in /Page object. If resource dict is empty, it 
means that the page requires no resources.

Since pdfTeX always produce /Resources dictionary for each page, the 
\pdfpagesresources makes no sense. Sorry for noise.

Best regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From reinhard.kotucha at web.de  Mon Jul  4 01:56:59 2005
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Mon Jul  4 01:57:16 2005
Subject: [NTG-pdftex] input
In-Reply-To: <42C84FE3.6040508@wxs.nl>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C6A0E7.3070206@wxs.nl>
	<17094.58918.624937.908650@zarniwoop.ms25.local>
	<42C84FE3.6040508@wxs.nl>
Message-ID: <17096.31563.926063.84945@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

  > yet another alternative is

  >    5. \pdfdefaultoutsuffix{toks}

  > so that we can say \pdfdefaultoutsuffix{} to get rid of the funny
  > default

Indeed.  But this one invites people to invent new funny defaults.

Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From martin at oneiros.de  Mon Jul  4 01:21:12 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul  4 07:50:22 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <42C86448.3050504@poczta.onet.pl>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
	<42C7BB8E.6070800@poczta.onet.pl> <42C856B2.8070308@wxs.nl>
	<42C86448.3050504@poczta.onet.pl>
Message-ID: <20050703232112.GA15384@lucien.kn-bremen.de>

On 2005-07-04 00:18:48 +0200, Pawel Jackowski wrote:
> It seems that /Resources dict is inherited from /Pages ONLY if there is 
> NO local /Resources dict in /Page object. If resource dict is empty, it 
> means that the page requires no resources.

Yes. The entry for /Resources is inherited, not individual keys
in the dictionary.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jul  4 11:06:03 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 11:06:01 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <42C86448.3050504@poczta.onet.pl>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
	<42C7BB8E.6070800@poczta.onet.pl> <42C856B2.8070308@wxs.nl>
	<42C86448.3050504@poczta.onet.pl>
Message-ID: <42C8FBFB.7020408@wxs.nl>

Pawel Jackowski wrote:
> Hi Hans,
> 
>> i'm not sure if i understand the problem, but as long as adding a top 
>> level page resource does not break individual page resources it's fine 
>> with me;
> 
> 
> The only problem is that if \pdfpageresources toks list is used as 
> global (that is probably quite common) in the PDF output we get the same 
> code repeated as many times as number of pages in the document.

that's no problem since you can empty the toks after a shipout

>> i need to check the pdf ref, but do resources in the /Page object 
>> overload those on the /Pages one?; 
>  
> Resources dictionary is inheritable, but now I see that this inheritance 
> is different than for page attributes like page boxes. I thought that if 
> some resource can't be found in local dictionary (in /Page) it is 
> searched in parent node (/Pages). It seems I was wrong; the following 
> produce a corrupted PDF:
> 
> \immediate\pdfobj{<</Type /ExtGState /CA 0.3 /ca 0.3>>}
> \edef\A{/GS1 \the\pdflastobj\space0 R}
> \immediate\pdfobj{<</Type /ExtGState /CA 0.7 /ca 0.7>>}
> \edef\B{/GS2 \the\pdflastobj\space0 R}
> 
> \edef\next{\pdfpagesattr{/Resources << /ExtGState <<\A>> >>}}\next
> \edef\next{\pdfpageresources{/ExtGState <<\B>>}}\next
> 
> \pdfliteral{/GS1 gs}blah
> \pdfliteral{/GS2 gs}blah
> 
> \end
> 
> It seems that /Resources dict is inherited from /Pages ONLY if there is 
> NO local /Resources dict in /Page object. If resource dict is empty, it 
> means that the page requires no resources.
> 
> Since pdfTeX always produce /Resources dictionary for each page, the 
> \pdfpagesresources makes no sense. Sorry for noise.

i guessed as much -)

it's made even more fuzzy by the fact that the specs say that some resources are 
optional but omitting them makes acrobat crash; another thing to keep in mind is 
that they keep changing the specs (take multiple entries: currently i think that 
the first one takes precedence, but in the past it has been the last; this means 
for instance that careless use of \pdfinfo leads to different behaviour, in 
itself not harmfull, but it may be worse when we deal with resources and such); 
best leave that part of pdftex untouched.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jackos1 at poczta.onet.pl  Mon Jul  4 12:15:42 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Mon Jul  4 12:15:52 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <42C8FBFB.7020408@wxs.nl>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
	<42C7BB8E.6070800@poczta.onet.pl> <42C856B2.8070308@wxs.nl>
	<42C86448.3050504@poczta.onet.pl> <42C8FBFB.7020408@wxs.nl>
Message-ID: <42C90C4E.8070301@poczta.onet.pl>

 > Hans:
> it's made even more fuzzy by the fact that the specs say that some 
> resources are optional but omitting them makes acrobat crash; another 
> thing to keep in mind is that they keep changing the specs (take 
> multiple entries: currently i think that the first one takes precedence, 
> but in the past it has been the last; this means for instance that 
> careless use of \pdfinfo leads to different behaviour, in itself not 
> harmfull, but it may be worse when we deal with resources and such); 
> best leave that part of pdftex untouched.

Lets forget about that.

BR
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From taco at elvenkind.com  Mon Jul  4 12:30:47 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul  4 12:30:52 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C5C880.5010101@elvenkind.com>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>	<42C419F7.8000302@wxs.nl>
	<42C46C5D.2040804@poczta.onet.pl>	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C4EC91.5060902@poczta.onet.pl>	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>	<42C54FA7.6010002@wxs.nl>	<20050701180427.GB24398@lucien.kn-bremen.de>	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>	<42C5A333.9040904@elvenkind.com>	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com>
Message-ID: <42C90FD7.2050809@elvenkind.com>


Hi there,

As promised, some proposals for the symbol table. No code yet,
because careful thinking is needed first, to avoid unexplainable
side-effects.

Let me propose two rather straightforward new primitives first
(please imagine the \ptex prefix yourself):

   \ifprimitive <csname>

     True if the <csname> has the same meaning as it would in initex,
     (but gives an error if <csname> is currently undefined).

   \executeprimitive <csname>

     Executes the primitive that would be known as <csname> in initex,
     even if the <csname> is currently undefined or defined to mean
     something else. Raises an error if there is no matching internal
     command (of course).

These are quite straightforward, and I do not assume this needs
much discussion. But the next ones are related to "if feature ...",
and those are bit harder to define.

I propose to make it possible to 'predefine' primitives in the
executable. All program code is completely ready, except that the
hash table entry is never created, making it impossible to use
that primitive in initex without extra work.

   \ifinternal <csname>

     True if there is code in the pdtex executable to implement the
     internal command <csname>, regardless of whether or not it is
     currently reachable from macros.

   \executeinternal <csname>

     Executes the internal that is registered as <csname>, even
     if that internal is currently obscured (disable) or the <csname>
     is defined to mean something else. Raises an error if there is
     no matching internal command.

   \exposeinternal <csname>

     This does the final step of the primitive() function: it creates
     a hash entry for <csname> that maps it to its primitive meaning.
     An error is raised if the <csname> is currently defined.
     (perhaps this primitive should accept the \global prefix?)

   \obscureinternal <csname>

     The inverse of \exposeinternal, this 'undefines' the primitive
     related to <csname>. If <csname> is currently a macro, nothing
     needs to be done. Control sequences that are \let to the meaning
     of this csname are left as is.
     (perhaps this primitive should accept the \global prefix?)


I chose \expose... and \obscure... instead of \disable... \enable
because this is closer to the truth: in this proposal it is not
possible to unconditionally disable a primitive (because that
would require much more work than this).

Side note: The pascal implementation can be rather straightforward:
a pair of shadow_hash and shadow_eqtb has to be created that contains
only the equivalents of the internal control sequences, nothing else.

WDYT?

Greetings, Taco

From martin at oneiros.de  Mon Jul  4 12:53:39 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul  4 12:58:18 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C90FD7.2050809@elvenkind.com>
References: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com> <42C90FD7.2050809@elvenkind.com>
Message-ID: <20050704105339.GB20462@lucien.kn-bremen.de>

On 2005-07-04 12:30:47 +0200, Taco Hoekwater wrote:
> As promised, some proposals for the symbol table. No code yet,
> because careful thinking is needed first, to avoid unexplainable
> side-effects.

Hrm. The problem I see is that Karl is breathing down my neck
because he wants a code freeze for TL2005 this week. :-{

But deadlines in TL are always flexible, so I think we have at
least another month...

> Let me propose two rather straightforward new primitives first
> (please imagine the \ptex prefix yourself):
> 
>   \ifprimitive <csname>
> 
>     True if the <csname> has the same meaning as it would in initex,
>     (but gives an error if <csname> is currently undefined).
> 
>   \executeprimitive <csname>
> 
>     Executes the primitive that would be known as <csname> in initex,
>     even if the <csname> is currently undefined or defined to mean
>     something else. Raises an error if there is no matching internal
>     command (of course).
> 
> These are quite straightforward, and I do not assume this needs
> much discussion. But the next ones are related to "if feature ...",
> and those are bit harder to define.
> 
> I propose to make it possible to 'predefine' primitives in the
> executable. All program code is completely ready, except that the
> hash table entry is never created, making it impossible to use
> that primitive in initex without extra work.
> 
>   \ifinternal <csname>
> 
>     True if there is code in the pdtex executable to implement the
>     internal command <csname>, regardless of whether or not it is
>     currently reachable from macros.
> 
>   \executeinternal <csname>
> 
>     Executes the internal that is registered as <csname>, even
>     if that internal is currently obscured (disable) or the <csname>
>     is defined to mean something else. Raises an error if there is
>     no matching internal command.
> 
>   \exposeinternal <csname>
> 
>     This does the final step of the primitive() function: it creates
>     a hash entry for <csname> that maps it to its primitive meaning.
>     An error is raised if the <csname> is currently defined.
>     (perhaps this primitive should accept the \global prefix?)
> 
>   \obscureinternal <csname>
> 
>     The inverse of \exposeinternal, this 'undefines' the primitive
>     related to <csname>. If <csname> is currently a macro, nothing
>     needs to be done. Control sequences that are \let to the meaning
>     of this csname are left as is.
>     (perhaps this primitive should accept the \global prefix?)

I suggest \hideinternal instead; we don't want to be obscure. :-)

> WDYT?

Great!

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From taco at elvenkind.com  Mon Jul  4 13:01:14 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul  4 13:03:59 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <20050704105339.GB20462@lucien.kn-bremen.de>
References: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C4EC91.5060902@poczta.onet.pl>	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>	<42C54FA7.6010002@wxs.nl>	<20050701180427.GB24398@lucien.kn-bremen.de>	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>	<42C5A333.9040904@elvenkind.com>	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>	<42C5C880.5010101@elvenkind.com>
	<42C90FD7.2050809@elvenkind.com>
	<20050704105339.GB20462@lucien.kn-bremen.de>
Message-ID: <42C916FA.3020407@elvenkind.com>

Martin Schr?der wrote:
> On 2005-07-04 12:30:47 +0200, Taco Hoekwater wrote:
> 
>>As promised, some proposals for the symbol table. No code yet,
>>because careful thinking is needed first, to avoid unexplainable
>>side-effects.
> 
> Hrm. The problem I see is that Karl is breathing down my neck
> because he wants a code freeze for TL2005 this week. :-{

I was not really aiming for 1.30. Messing with TeX's internals
is better not done with a deadline looming over your head, so
let's go slow on this one.

Taco
From oberdiek at uni-freiburg.de  Mon Jul  4 13:14:39 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jul  4 13:14:03 2005
Subject: [NTG-pdftex] \pdffiledump (was: Patch EscapeAndOther)
In-Reply-To: <20050702194334.GG2247@lucien.kn-bremen.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050702194334.GG2247@lucien.kn-bremen.de>
Message-ID: <20050704111438.GA3007@m0A0232D2.vpn.uni-freiburg.de>

On Sat, Jul 02, 2005 at 09:43:34PM +0200, Martin Schr?der wrote:

> On 2005-06-25 03:52:01 +0200, Heiko Oberdiek wrote:
> > New in patch EscapeAndOther:
> >   * \pdfcreationdate
> >   * \pdffilemoddate
> >   * \pdffilesize
> >   * \pdfmdfivesum
> >   * \pdffiledump
> >   * \pdfshellescape
> >   * \pdfmatch and \pdflastmatch
> >   * Start with bug fix: quotes are legal in other operating
> >     systems than windows.
> 
> And \pdffiledump. What does it do?

Sorry, I have forgotten the description:

\pdffiledump [offset <int>] [length <int>] <general text>

It returns a hex dump of file, given in <general text>,
starting at given offset or 0 with given length.

\pdffiledump length 20 {abc.bmp}

Reads the first twenty bytes of abc.bmp in binary mode and
returns them as hex string.

Uses: a lot, eg. inspecting the file header to get
size information of bitmap files (eg. for latex/dvips).
Or it could be used to read ucs2/4 files, recode them
and reading (\scantokens, \pdfunescapehex) them as utf-8.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Mon Jul  4 13:18:49 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 13:18:29 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C90FD7.2050809@elvenkind.com>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com> <42C90FD7.2050809@elvenkind.com>
Message-ID: <42C91B19.7030005@wxs.nl>

Taco Hoekwater wrote:

> As promised, some proposals for the symbol table. No code yet,
> because careful thinking is needed first, to avoid unexplainable
> side-effects.

interesting -)

> Let me propose two rather straightforward new primitives first
> (please imagine the \ptex prefix yourself):
> 
>   \ifprimitive <csname>
> 
>     True if the <csname> has the same meaning as it would in initex,
>     (but gives an error if <csname> is currently undefined).

why not false instead of an error?

>   \executeprimitive <csname>
> 
>     Executes the primitive that would be known as <csname> in initex,
>     even if the <csname> is currently undefined or defined to mean
>     something else. Raises an error if there is no matching internal
>     command (of course).
> 
> These are quite straightforward, and I do not assume this needs
> much discussion. But the next ones are related to "if feature ...",
> and those are bit harder to define.
> 
> I propose to make it possible to 'predefine' primitives in the
> executable. All program code is completely ready, except that the
> hash table entry is never created, making it impossible to use
> that primitive in initex without extra work.
> 
>   \ifinternal <csname>
> 
>     True if there is code in the pdtex executable to implement the
>     internal command <csname>, regardless of whether or not it is
>     currently reachable from macros.
> 
>   \executeinternal <csname>
> 
>     Executes the internal that is registered as <csname>, even
>     if that internal is currently obscured (disable) or the <csname>
>     is defined to mean something else. Raises an error if there is
>     no matching internal command.
> 
>   \exposeinternal <csname>
> 
>     This does the final step of the primitive() function: it creates
>     a hash entry for <csname> that maps it to its primitive meaning.
>     An error is raised if the <csname> is currently defined.
>     (perhaps this primitive should accept the \global prefix?)
> 
>   \obscureinternal <csname>
> 
>     The inverse of \exposeinternal, this 'undefines' the primitive
>     related to <csname>. If <csname> is currently a macro, nothing
>     needs to be done. Control sequences that are \let to the meaning
>     of this csname are left as is.
>     (perhaps this primitive should accept the \global prefix?)
> 
> 
> I chose \expose... and \obscure... instead of \disable... \enable
> because this is closer to the truth: in this proposal it is not
> possible to unconditionally disable a primitive (because that
> would require much more work than this).

sounds ok to me; concerning the global, i think this is indeed a needed feature 
   (unless it messes up the code too much)

> Side note: The pascal implementation can be rather straightforward:
> a pair of shadow_hash and shadow_eqtb has to be created that contains
> only the equivalents of the internal control sequences, nothing else.

in the same area, how about a primitive that marks such a primitive (or maybe 
any macro but that may be harder to do) as being an 'if'

\def\ifMyTest#1#2%
   {..... \iftrue}

\exposeif\ifMyTest

\ifnum\a>\b
   \ifMyTest\c\d
      ...
   \fi
\fi

(no missing fi messages and such)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Mon Jul  4 13:20:12 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 13:19:51 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <20050704105339.GB20462@lucien.kn-bremen.de>
References: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com> <42C90FD7.2050809@elvenkind.com>
	<20050704105339.GB20462@lucien.kn-bremen.de>
Message-ID: <42C91B6C.8000403@wxs.nl>

Martin Schr?der wrote:

> Hrm. The problem I see is that Karl is breathing down my neck
> because he wants a code freeze for TL2005 this week. :-{

-)

> But deadlines in TL are always flexible, so I think we have at
> least another month...

indeed, also, we put it under the category 'beta features'

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From noreply at sarovar.org  Mon Jul  4 13:13:24 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul  4 13:20:17 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1DpOtA-00083x-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 13:13

Message:
Logged In: YES 
user_id=1276

Hello,

it is a very bad idea, quotes are perfectly legal
in linux and other operating systems. Also image
inclusion is done by \pdfximage that uses
<general text>, by <general text>, text surrounded
by curly braces (catcode 1 and 2) *all* possible
file names can be given including quotes and spaces.

We need rather new primitives for
\input, \openin, and \openout to provide the file
names as <general text>. The all file names can
be given without the need of quoting at all.
See also the discussion about \pdfinput in
the ntg-pdftex mailing list.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From pragma at wxs.nl  Mon Jul  4 13:24:40 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 13:24:25 2005
Subject: [NTG-pdftex] \pdfpagesresources?
In-Reply-To: <42C90C4E.8070301@poczta.onet.pl>
References: <20050630012419.GB2552@monty.localnet>
	<42C3C09B.9010605@poczta.onet.pl>
	<20050703024418.GA2784@monty.localnet>
	<42C7BB8E.6070800@poczta.onet.pl> <42C856B2.8070308@wxs.nl>
	<42C86448.3050504@poczta.onet.pl> <42C8FBFB.7020408@wxs.nl>
	<42C90C4E.8070301@poczta.onet.pl>
Message-ID: <42C91C78.5050107@wxs.nl>

Pawel Jackowski wrote:
>  > Hans:
> 
>> it's made even more fuzzy by the fact that the specs say that some 
>> resources are optional but omitting them makes acrobat crash; another 
>> thing to keep in mind is that they keep changing the specs (take 
>> multiple entries: currently i think that the first one takes 
>> precedence, but in the past it has been the last; this means for 
>> instance that careless use of \pdfinfo leads to different behaviour, 
>> in itself not harmfull, but it may be worse when we deal with 
>> resources and such); best leave that part of pdftex untouched.
> 
> 
> Lets forget about that.

maybe we should have a section in the manual "considered but not implemented 
because ..."

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Mon Jul  4 13:25:47 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jul  4 13:24:47 2005
Subject: [NTG-pdftex] input
In-Reply-To: <17096.31563.926063.84945@zarniwoop.ms25.local>
References: <42C3E109.1050804@wxs.nl>
	<17092.29074.36978.387312@zarniwoop.ms25.local>
	<42C6A0E7.3070206@wxs.nl>
	<17094.58918.624937.908650@zarniwoop.ms25.local>
	<42C84FE3.6040508@wxs.nl>
	<17096.31563.926063.84945@zarniwoop.ms25.local>
Message-ID: <20050704112547.GB3007@m0A0232D2.vpn.uni-freiburg.de>

On Mon, Jul 04, 2005 at 01:56:59AM +0200, Reinhard Kotucha wrote:

> >>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:
> 
>   > yet another alternative is
> 
>   >    5. \pdfdefaultoutsuffix{toks}
> 
>   > so that we can say \pdfdefaultoutsuffix{} to get rid of the funny
>   > default
> 
> Indeed.  But this one invites people to invent new funny defaults.

I would use \pdfinput, \pdfopenin, \pdfopenout with
<general text> as file name and without default extensions.
That is part of the application (macros). E.g. if the macro want to
use image files, than image extensions can be tried.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From taco at elvenkind.com  Mon Jul  4 13:32:37 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul  4 13:35:23 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C91B19.7030005@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>	<42C419F7.8000302@wxs.nl>
	<42C46C5D.2040804@poczta.onet.pl>	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C4EC91.5060902@poczta.onet.pl>	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>	<42C54FA7.6010002@wxs.nl>	<20050701180427.GB24398@lucien.kn-bremen.de>	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>	<42C5A333.9040904@elvenkind.com>	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>	<42C5C880.5010101@elvenkind.com>
	<42C90FD7.2050809@elvenkind.com> <42C91B19.7030005@wxs.nl>
Message-ID: <42C91E55.20704@elvenkind.com>

Hans Hagen wrote:
>> Let me propose two rather straightforward new primitives first
>> (please imagine the \ptex prefix yourself):
>>
>>   \ifprimitive <csname>
>>
>>     True if the <csname> has the same meaning as it would in initex,
>>     (but gives an error if <csname> is currently undefined).
> 
> 
> why not false instead of an error?

I proposed that because it would be slightly easier to implement,
but you need to know what you are testing anyway, so it would only
apply after e.g. \let\par\undefined. And does it really make sense to
do that to a primitive?

> in the same area, how about a primitive that marks such a primitive (or 
> maybe any macro but that may be harder to do) as being an 'if'

That is not the same problem. I will think about something like this,
but it is much harder than it appears to be at first sight.

Taco
From noreply at sarovar.org  Mon Jul  4 13:46:54 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul  4 13:53:33 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1DpPPa-00012T-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

>Comment By: Georg Baum (baum)
Date: 2005-07-04 13:46

Message:
Logged In: YES 
user_id=2590

I agree that the quote stripping is a hack and should
eventually be replaced by something better.
I do think however that the behaviour on all platforms
should be the same if it is at all possible. Right now,
filenames with quotes work on linux and not on windows, and
quoted filenames with spaces work on windows but not on linux.
Thanks for the hint to pdfximage, I did not know about that
(coming from standard LaTeX and always using \includegraphics}

Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 13:13

Message:
Logged In: YES 
user_id=1276

Hello,

it is a very bad idea, quotes are perfectly legal
in linux and other operating systems. Also image
inclusion is done by \pdfximage that uses
<general text>, by <general text>, text surrounded
by curly braces (catcode 1 and 2) *all* possible
file names can be given including quotes and spaces.

We need rather new primitives for
\input, \openin, and \openout to provide the file
names as <general text>. The all file names can
be given without the need of quoting at all.
See also the discussion about \pdfinput in
the ntg-pdftex mailing list.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From oberdiek at uni-freiburg.de  Mon Jul  4 15:44:51 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jul  4 15:43:57 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C90FD7.2050809@elvenkind.com>
References: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com> <42C90FD7.2050809@elvenkind.com>
Message-ID: <20050704134451.GA3964@m0A0232D2.vpn.uni-freiburg.de>

On Mon, Jul 04, 2005 at 12:30:47PM +0200, Taco Hoekwater wrote:

> As promised, some proposals for the symbol table. No code yet,
> because careful thinking is needed first, to avoid unexplainable
> side-effects.
> 
> Let me propose two rather straightforward new primitives first
> (please imagine the \ptex prefix yourself):
> 
>   \ifprimitive <csname>
> 
>     True if the <csname> has the same meaning as it would in initex,
>     (but gives an error if <csname> is currently undefined).

What is the result of \ifprimitive, it is \iftrue/\iffalse or
an expansion text "true"/"some error message"?

>   \executeprimitive <csname>

What about \executeprimitive itself?

  \def\executeprimitive{Hello World}
  \executeprimitive\executeprimitive\relax

Is the result two "Hello World" or "\relax"?

>     Executes the primitive that would be known as <csname> in initex,
>     even if the <csname> is currently undefined or defined to mean
>     something else. Raises an error if there is no matching internal
>     command (of course).
> 
> These are quite straightforward, and I do not assume this needs
> much discussion.

I need some clarification only.

> But the next ones are related to "if feature ...",
> and those are bit harder to define.
> 
>   \ifinternal <csname>
>   \executeinternal <csname>
>   \exposeinternal <csname>
>   \obscureinternal <csname>

> WDYT?

It needs some thinking.
First thoughts:
* It looks like a first step to a real namespace implementation,
  a (perhaps read-only) internal namespace, namespaces for extensions,
  and user/package macros. Why not going further then?
* Perhaps PostScript ideas of dictionary stacks can help here:
  systemdict for internal iniTeX primitives, userdict, ...

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Mon Jul  4 15:45:01 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 15:44:42 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C91E55.20704@elvenkind.com>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com>
	<42C90FD7.2050809@elvenkind.com> <42C91B19.7030005@wxs.nl>
	<42C91E55.20704@elvenkind.com>
Message-ID: <42C93D5D.1060108@wxs.nl>

Taco Hoekwater wrote:
> Hans Hagen wrote:
> 
>>> Let me propose two rather straightforward new primitives first
>>> (please imagine the \ptex prefix yourself):
>>>
>>>   \ifprimitive <csname>
>>>
>>>     True if the <csname> has the same meaning as it would in initex,
>>>     (but gives an error if <csname> is currently undefined).
>>
>>
>>
>> why not false instead of an error?
> 
> 
> I proposed that because it would be slightly easier to implement,
> but you need to know what you are testing anyway, so it would only
> apply after e.g. \let\par\undefined. And does it really make sense to
> do that to a primitive?

ok, we'll see, one problem that i have with errors is that oen always has to 
mess around woth the moded in order to catch it

>> in the same area, how about a primitive that marks such a primitive 
>> (or maybe any macro but that may be harder to do) as being an 'if'
>  
> That is not the same problem. I will think about something like this,
> but it is much harder than it appears to be at first sight.

Understood (we've discussed such a feature before, so i already guessed that it 
was complex -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Mon Jul  4 15:48:47 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 15:48:28 2005
Subject: [NTG-pdftex] \pdffiledump
In-Reply-To: <20050704111438.GA3007@m0A0232D2.vpn.uni-freiburg.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050702194334.GG2247@lucien.kn-bremen.de>
	<20050704111438.GA3007@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42C93E3F.6070901@wxs.nl>

Heiko Oberdiek wrote:

> \pdffiledump length 20 {abc.bmp}
> 
> Reads the first twenty bytes of abc.bmp in binary mode and
> returns them as hex string.
> 
> Uses: a lot, eg. inspecting the file header to get
> size information of bitmap files (eg. for latex/dvips).
> Or it could be used to read ucs2/4 files, recode them
> and reading (\scantokens, \pdfunescapehex) them as utf-8.

often one needs more trickery to get a size due to the fact that many bitmap 
formats are linked lists of tagged records; i suppose that reading in a 400K 
file has some mem penalty -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Mon Jul  4 16:01:09 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jul  4 16:00:16 2005
Subject: [NTG-pdftex] \pdffiledump
In-Reply-To: <42C93E3F.6070901@wxs.nl>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050702194334.GG2247@lucien.kn-bremen.de>
	<20050704111438.GA3007@m0A0232D2.vpn.uni-freiburg.de>
	<42C93E3F.6070901@wxs.nl>
Message-ID: <20050704140109.GA4065@m0A0232D2.vpn.uni-freiburg.de>

On Mon, Jul 04, 2005 at 03:48:47PM +0200, Hans Hagen wrote:

> Heiko Oberdiek wrote:
> 
> >\pdffiledump length 20 {abc.bmp}
> >
> >Reads the first twenty bytes of abc.bmp in binary mode and
> >returns them as hex string.
> >
> >Uses: a lot, eg. inspecting the file header to get
> >size information of bitmap files (eg. for latex/dvips).
> >Or it could be used to read ucs2/4 files, recode them
> >and reading (\scantokens, \pdfunescapehex) them as utf-8.
> 
> often one needs more trickery to get a size due to the fact that many 
> bitmap formats are linked lists of tagged records; i suppose that reading 
> in a 400K file has some mem penalty -)

BMP formats are supported by dvips and you need some header
bytes only.

400K files don't need to be read as a whole. An intelligent
implementation would parse the necessary parts. With the
information of \pdffilesize files can also read from behind
and parse pdf or dvi files, for example. But it is easy to
add another option for the read direction for parameter "whence"
of fseek (SEEK_SET, SEEK_CUR, SEEK_END).

Currently the file is not remembered, thus "current" has no meaning.
Keyword "offset" can be given an option "end":

\pdffiledump [offset [end] <int>] [length <int>] <general text>

"offset 10 length 2" means byte 10 and 11,
"offset end 10 length 2" means byte 10 and 11 before end of file.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
From taco at elvenkind.com  Mon Jul  4 16:06:42 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul  4 16:06:45 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <20050704134451.GA3964@m0A0232D2.vpn.uni-freiburg.de>
References: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C4EC91.5060902@poczta.onet.pl>	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>	<42C54FA7.6010002@wxs.nl>	<20050701180427.GB24398@lucien.kn-bremen.de>	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>	<42C5A333.9040904@elvenkind.com>	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>	<42C5C880.5010101@elvenkind.com>
	<42C90FD7.2050809@elvenkind.com>
	<20050704134451.GA3964@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42C94272.7010806@elvenkind.com>


Hi Heiko,

Heiko Oberdiek wrote:
> 
> What is the result of \ifprimitive, it is \iftrue/\iffalse or
> an expansion text "true"/"some error message"?

as in \iftrue/\iffalse: it is a 'real' \if test .

>>  \executeprimitive <csname>
> 
> What about \executeprimitive itself?
> 
>   \def\executeprimitive{Hello World}
>   \executeprimitive\executeprimitive\relax
> 
> Is the result two "Hello World" or "\relax"?

This result is

   Hello WorldHello World\relax

Without the \def line, you would get only:

   \relax

(the first \executeprimitive executes the second which executes
the internal version of \relax)

>>  \ifinternal <csname>
>>  \executeinternal <csname>
>>  \exposeinternal <csname>
>>  \obscureinternal <csname>
> 
> It needs some thinking.
> First thoughts:
> * It looks like a first step to a real namespace implementation,
>   a (perhaps read-only) internal namespace, namespaces for extensions,
>   and user/package macros. Why not going further then?

TeX's current internal structure does not allow a clean solution,
so if we want true namespaces in TeX, we probably have to start
thinking about a successor to pdftex. Otherwise, we would need
to redesign the whole symbol table / token handling while trying
to remain 100% compatible. That sounds like a nightmare to me.

These last 4 primitives I proposed are an attempt to come up with
something that works next month (as opposed to next year), but
you are right that it probably needs more thinking, anyway.

Taco
From noreply at sarovar.org  Mon Jul  4 16:07:22 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul  4 16:14:05 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1DpRbW-0007Tt-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 16:07

Message:
Logged In: YES 
user_id=1276

Hello,

I must disagree, "the same behaviour on all platforms"
can not mean to add the limitations of all platforms.
Now you want the limitation of windows that quotes
cannot be used apply on the other systems?
There are operating systems that deal with 8+3 file
names only. Do you want to forbid long file names,
for example?

Thus we are loosing both quotes and spaces. Spaces still
cannot be used in general. Other TeX engines
does not know about quoting. There is no secure way
to know, whether quoting is working. Thus code that
is intended for different systems must avoid spaces.
  And the current quoting scheme does not solve the
problem at all, it moves the problem from spaces to
quotes, spaces can still not be used and quotes are
now made unavailable. Also the quoting scheme does
not allow quoting of the quotes themselves.

A solution would allow *all* characters.
The solution should be able to deal with utf-8 or
even ucs-2/4 encoded file names.
  That is already given by the syntax of \pdfximage.
Thus new primitives \pdfinput, \pdfopenin, \pdfopenout
with <general text> would allow any file name and a
macro code can test, whether this feature is available
by testing the command names.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Georg Baum (baum)
Date: 2005-07-04 13:46

Message:
Logged In: YES 
user_id=2590

I agree that the quote stripping is a hack and should
eventually be replaced by something better.
I do think however that the behaviour on all platforms
should be the same if it is at all possible. Right now,
filenames with quotes work on linux and not on windows, and
quoted filenames with spaces work on windows but not on linux.
Thanks for the hint to pdfximage, I did not know about that
(coming from standard LaTeX and always using \includegraphics}

Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 13:13

Message:
Logged In: YES 
user_id=1276

Hello,

it is a very bad idea, quotes are perfectly legal
in linux and other operating systems. Also image
inclusion is done by \pdfximage that uses
<general text>, by <general text>, text surrounded
by curly braces (catcode 1 and 2) *all* possible
file names can be given including quotes and spaces.

We need rather new primitives for
\input, \openin, and \openout to provide the file
names as <general text>. The all file names can
be given without the need of quoting at all.
See also the discussion about \pdfinput in
the ntg-pdftex mailing list.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From oberdiek at uni-freiburg.de  Mon Jul  4 16:19:18 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jul  4 16:18:20 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <42C94272.7010806@elvenkind.com>
References: <20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com> <42C90FD7.2050809@elvenkind.com>
	<20050704134451.GA3964@m0A0232D2.vpn.uni-freiburg.de>
	<42C94272.7010806@elvenkind.com>
Message-ID: <20050704141918.GA4201@m0A0232D2.vpn.uni-freiburg.de>

Hello Taco,

On Mon, Jul 04, 2005 at 04:06:42PM +0200, Taco Hoekwater wrote:

> Heiko Oberdiek wrote:
> >
> >What is the result of \ifprimitive, it is \iftrue/\iffalse or
> >an expansion text "true"/"some error message"?
> 
> as in \iftrue/\iffalse: it is a 'real' \if test .
> 
> >> \executeprimitive <csname>
> >
> >What about \executeprimitive itself?
> >
> >  \def\executeprimitive{Hello World}
> >  \executeprimitive\executeprimitive\relax
> >
> >Is the result two "Hello World" or "\relax"?
> 
> This result is
> 
>   Hello WorldHello World\relax
> 
> Without the \def line, you would get only:
> 
>   \relax
> 
> (the first \executeprimitive executes the second which executes
> the internal version of \relax)

Thanks for clarification, this is what I would expect.

> >> \ifinternal <csname>
> >> \executeinternal <csname>
> >> \exposeinternal <csname>
> >> \obscureinternal <csname>
> >
> >It needs some thinking.
> >First thoughts:
> >* It looks like a first step to a real namespace implementation,
> >  a (perhaps read-only) internal namespace, namespaces for extensions,
> >  and user/package macros. Why not going further then?
> 
> TeX's current internal structure does not allow a clean solution,
> so if we want true namespaces in TeX, we probably have to start
> thinking about a successor to pdftex. Otherwise, we would need
> to redesign the whole symbol table / token handling while trying
> to remain 100% compatible. That sounds like a nightmare to me.
> 
> These last 4 primitives I proposed are an attempt to come up with
> something that works next month (as opposed to next year), but
> you are right that it probably needs more thinking, anyway.

I know, the web-pascal code is a nightmare and that we depend
stronger on what can be done than what would be a nice solution.
:-((

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
From pragma at wxs.nl  Mon Jul  4 16:47:54 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 16:47:35 2005
Subject: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <20050704134451.GA3964@m0A0232D2.vpn.uni-freiburg.de>
References: <20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C4EC91.5060902@poczta.onet.pl>
	<20050701131601.GA2730@m0A0232D2.vpn.uni-freiburg.de>
	<42C54FA7.6010002@wxs.nl>
	<20050701180427.GB24398@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0507012039020.4706@hahepc1.hahe>
	<42C5A333.9040904@elvenkind.com>
	<Pine.LNX.4.61.0507012339200.5213@hahepc1.hahe>
	<42C5C880.5010101@elvenkind.com> <42C90FD7.2050809@elvenkind.com>
	<20050704134451.GA3964@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42C94C1A.80807@wxs.nl>

Heiko Oberdiek wrote:

> It needs some thinking.
> First thoughts:
> * It looks like a first step to a real namespace implementation,
>   a (perhaps read-only) internal namespace, namespaces for extensions,
>   and user/package macros. Why not going further then?
> * Perhaps PostScript ideas of dictionary stacks can help here:
>   systemdict for internal iniTeX primitives, userdict, ...

this is probably more complex (and will take longer to get stable) due to the 
way tex is coded

we can consider adding additional hashes/stacks after this is done

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Mon Jul  4 16:51:03 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul  4 16:50:44 2005
Subject: [NTG-pdftex] \pdffiledump
In-Reply-To: <20050704140109.GA4065@m0A0232D2.vpn.uni-freiburg.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050702194334.GG2247@lucien.kn-bremen.de>
	<20050704111438.GA3007@m0A0232D2.vpn.uni-freiburg.de>
	<42C93E3F.6070901@wxs.nl>
	<20050704140109.GA4065@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42C94CD7.8070208@wxs.nl>

Heiko Oberdiek wrote:

> 400K files don't need to be read as a whole. An intelligent
> implementation would parse the necessary parts. With the
> information of \pdffilesize files can also read from behind
> and parse pdf or dvi files, for example. But it is easy to
> add another option for the read direction for parameter "whence"
> of fseek (SEEK_SET, SEEK_CUR, SEEK_END).

that's indeed the point i wanted to make: that kind of parsing only makes sense 
if one can also seek; better make a full implementation now then wait for new 
features later.

> Currently the file is not remembered, thus "current" has no meaning.
> Keyword "offset" can be given an option "end":
> 
> \pdffiledump [offset [end] <int>] [length <int>] <general text>
> 
> "offset 10 length 2" means byte 10 and 11,
> "offset end 10 length 2" means byte 10 and 11 before end of file.

ah, i see, interesting

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From noreply at sarovar.org  Mon Jul  4 18:55:41 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul  4 19:02:16 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1DpUEP-0006y3-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

>Comment By: Georg Baum (baum)
Date: 2005-07-04 18:55

Message:
Logged In: YES 
user_id=2590

Hello, 
 
I manually copied and cited your message because I could 
not find out how to do that correctly with the tracker 
system :-( 
 
> I must disagree, "the same behaviour on all platforms" 
> can not mean to add the limitations of all platforms. 
 
No, that is not my intention. 
 
> Now you want the limitation of windows that quotes 
> cannot be used apply on the other systems? 
 
I want to trade in the use of quotes for the use of spaces. 
Since you can only have one (not really, see below) it is 
from a user's point of view better to support spaces on all 
platforms and not spaces on windows and quotes on other 
platforms. 
 
> There are operating systems that deal with 8+3 file 
> names only. Do you want to forbid long file names, 
> for example? 
 
Of course not. 
 
> Thus we are loosing both quotes and spaces. Spaces still 
> cannot be used in general. Other TeX engines 
> does not know about quoting. There is no secure way 
> to know, whether quoting is working. Thus code that 
> is intended for different systems must avoid spaces. 
 
And quotes (in the filename itself, not for quoting), so 
this is not really an argument to support them. 
Concerning other implementations: \includegraphics{foo.png} 
does not work with plain latex, but with pdflatex. The same 
would apply to spaces in filenames, so I see no big problem 
there. 
 
> And the current quoting scheme does not solve the 
> problem at all, it moves the problem from spaces to 
> quotes, spaces can still not be used and quotes are 
> now made unavailable. Also the quoting scheme does 
> not allow quoting of the quotes themselves. 
 
It does (although I am not sure whether that is intended): 
Only the first quote is stripped from two consecutive 
quotes, e.g. the string '"a""bc"' is transformed into 
'a"bc'. 
 
> A solution would allow *all* characters. 
> The solution should be able to deal with utf-8 or 
> even ucs-2/4 encoded file names. 
 
Agreed. If you think that the quoting is so bad then why 
not remove it altogether and tell users to use \pdfximage? 
 
My problem with the current implementation is the 
inconsistency: If filenames with spaces work on windows if 
quoted, I expect that they work on linux, too, since the OS 
supports them. Of course I can't expect the same from 
filenames with quotes: They are not supported by windows, 
so they can't be supported by pdftex on windows. 
 
I hope I have made my point clear. I can live with it if 
you still don't agree, so I'll stop arguing now. 
 
 
Georg 

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 16:07

Message:
Logged In: YES 
user_id=1276

Hello,

I must disagree, "the same behaviour on all platforms"
can not mean to add the limitations of all platforms.
Now you want the limitation of windows that quotes
cannot be used apply on the other systems?
There are operating systems that deal with 8+3 file
names only. Do you want to forbid long file names,
for example?

Thus we are loosing both quotes and spaces. Spaces still
cannot be used in general. Other TeX engines
does not know about quoting. There is no secure way
to know, whether quoting is working. Thus code that
is intended for different systems must avoid spaces.
  And the current quoting scheme does not solve the
problem at all, it moves the problem from spaces to
quotes, spaces can still not be used and quotes are
now made unavailable. Also the quoting scheme does
not allow quoting of the quotes themselves.

A solution would allow *all* characters.
The solution should be able to deal with utf-8 or
even ucs-2/4 encoded file names.
  That is already given by the syntax of \pdfximage.
Thus new primitives \pdfinput, \pdfopenin, \pdfopenout
with <general text> would allow any file name and a
macro code can test, whether this feature is available
by testing the command names.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Georg Baum (baum)
Date: 2005-07-04 13:46

Message:
Logged In: YES 
user_id=2590

I agree that the quote stripping is a hack and should
eventually be replaced by something better.
I do think however that the behaviour on all platforms
should be the same if it is at all possible. Right now,
filenames with quotes work on linux and not on windows, and
quoted filenames with spaces work on windows but not on linux.
Thanks for the hint to pdfximage, I did not know about that
(coming from standard LaTeX and always using \includegraphics}

Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 13:13

Message:
Logged In: YES 
user_id=1276

Hello,

it is a very bad idea, quotes are perfectly legal
in linux and other operating systems. Also image
inclusion is done by \pdfximage that uses
<general text>, by <general text>, text surrounded
by curly braces (catcode 1 and 2) *all* possible
file names can be given including quotes and spaces.

We need rather new primitives for
\input, \openin, and \openout to provide the file
names as <general text>. The all file names can
be given without the need of quoting at all.
See also the discussion about \pdfinput in
the ntg-pdftex mailing list.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From noreply at sarovar.org  Tue Jul  5 10:57:30 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jul  5 11:04:14 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1DpjFC-0001Om-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-05 10:57

Message:
Logged In: YES 
user_id=1276

Hello,

> I manually copied and cited your message because I could 
> not find out how to do that correctly with the tracker 
> system :-( 

Also the tiny typein area and the order of postings is
very annoying. Perhaps we should better continue the
discussion on the ntg-pdftex mailing list.

>> Now you want the limitation of windows that quotes 
>> cannot be used apply on the other systems? 
> 
> I want to trade in the use of quotes for the use of
> spaces. 
> Since you can only have one (not really, see below) it is 
> from a user's point of view better to support spaces on
> all 
> platforms and not spaces on windows and quotes on other 
> platforms. 

>From a user's point it is better to support all
characters instead of randomly choosen ones.
The quoting method makes things worse:
* There is no method to detect, whether quoting is
  supported:
  \includegraphics{"abc def.png"}
  The graphics package does not know, whether the
  TeX compiler will look for {abc def.png},
  {"abc def.png"}, or {"abc}.
  Now you cannot use *both* quotes *and* spaces.
* A very long time, spaces are considered "fancy"
  in file names, it is asking for trouble, because
  they are not supported on DOS file systems.
  But nowadays, spaces become "normal" despite the
  trouble (also on windows systems).
  The difference in our problem descriptions seems
  to be that you want to have *spaces* as usable
  characters in filenames, my conclusion is that
  we must allow *any* character as usable. Otherwise
  we will have bug reports about quotes.
* And if we have a solution with *all* characters,
  there will be no problems with different encodings
  including ucs-2 or ucs-4.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Georg Baum (baum)
Date: 2005-07-04 18:55

Message:
Logged In: YES 
user_id=2590

Hello, 
 
I manually copied and cited your message because I could 
not find out how to do that correctly with the tracker 
system :-( 
 
> I must disagree, "the same behaviour on all platforms" 
> can not mean to add the limitations of all platforms. 
 
No, that is not my intention. 
 
> Now you want the limitation of windows that quotes 
> cannot be used apply on the other systems? 
 
I want to trade in the use of quotes for the use of spaces. 
Since you can only have one (not really, see below) it is 
from a user's point of view better to support spaces on all 
platforms and not spaces on windows and quotes on other 
platforms. 
 
> There are operating systems that deal with 8+3 file 
> names only. Do you want to forbid long file names, 
> for example? 
 
Of course not. 
 
> Thus we are loosing both quotes and spaces. Spaces still 
> cannot be used in general. Other TeX engines 
> does not know about quoting. There is no secure way 
> to know, whether quoting is working. Thus code that 
> is intended for different systems must avoid spaces. 
 
And quotes (in the filename itself, not for quoting), so 
this is not really an argument to support them. 
Concerning other implementations: \includegraphics{foo.png} 
does not work with plain latex, but with pdflatex. The same 
would apply to spaces in filenames, so I see no big problem 
there. 
 
> And the current quoting scheme does not solve the 
> problem at all, it moves the problem from spaces to 
> quotes, spaces can still not be used and quotes are 
> now made unavailable. Also the quoting scheme does 
> not allow quoting of the quotes themselves. 
 
It does (although I am not sure whether that is intended): 
Only the first quote is stripped from two consecutive 
quotes, e.g. the string '"a""bc"' is transformed into 
'a"bc'. 
 
> A solution would allow *all* characters. 
> The solution should be able to deal with utf-8 or 
> even ucs-2/4 encoded file names. 
 
Agreed. If you think that the quoting is so bad then why 
not remove it altogether and tell users to use \pdfximage? 
 
My problem with the current implementation is the 
inconsistency: If filenames with spaces work on windows if 
quoted, I expect that they work on linux, too, since the OS 
supports them. Of course I can't expect the same from 
filenames with quotes: They are not supported by windows, 
so they can't be supported by pdftex on windows. 
 
I hope I have made my point clear. I can live with it if 
you still don't agree, so I'll stop arguing now. 
 
 
Georg 

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 16:07

Message:
Logged In: YES 
user_id=1276

Hello,

I must disagree, "the same behaviour on all platforms"
can not mean to add the limitations of all platforms.
Now you want the limitation of windows that quotes
cannot be used apply on the other systems?
There are operating systems that deal with 8+3 file
names only. Do you want to forbid long file names,
for example?

Thus we are loosing both quotes and spaces. Spaces still
cannot be used in general. Other TeX engines
does not know about quoting. There is no secure way
to know, whether quoting is working. Thus code that
is intended for different systems must avoid spaces.
  And the current quoting scheme does not solve the
problem at all, it moves the problem from spaces to
quotes, spaces can still not be used and quotes are
now made unavailable. Also the quoting scheme does
not allow quoting of the quotes themselves.

A solution would allow *all* characters.
The solution should be able to deal with utf-8 or
even ucs-2/4 encoded file names.
  That is already given by the syntax of \pdfximage.
Thus new primitives \pdfinput, \pdfopenin, \pdfopenout
with <general text> would allow any file name and a
macro code can test, whether this feature is available
by testing the command names.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Georg Baum (baum)
Date: 2005-07-04 13:46

Message:
Logged In: YES 
user_id=2590

I agree that the quote stripping is a hack and should
eventually be replaced by something better.
I do think however that the behaviour on all platforms
should be the same if it is at all possible. Right now,
filenames with quotes work on linux and not on windows, and
quoted filenames with spaces work on windows but not on linux.
Thanks for the hint to pdfximage, I did not know about that
(coming from standard LaTeX and always using \includegraphics}

Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 13:13

Message:
Logged In: YES 
user_id=1276

Hello,

it is a very bad idea, quotes are perfectly legal
in linux and other operating systems. Also image
inclusion is done by \pdfximage that uses
<general text>, by <general text>, text surrounded
by curly braces (catcode 1 and 2) *all* possible
file names can be given including quotes and spaces.

We need rather new primitives for
\input, \openin, and \openout to provide the file
names as <general text>. The all file names can
be given without the need of quoting at all.
See also the discussion about \pdfinput in
the ntg-pdftex mailing list.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From noreply at sarovar.org  Tue Jul  5 17:17:41 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jul  5 17:24:05 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] Math chars and cmbright fail with
	pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1DppB7-0002Uf-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Nobody (None)
Summary: Math chars and cmbright fail with pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From taco at elvenkind.com  Tue Jul  5 17:32:10 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue Jul  5 17:32:15 2005
Subject: Fwd: [NTG-pdftex] \ifprimitive and \ifinternal/\iffeature (design
	proposal)
In-Reply-To: <17098.37597.698861.972333@isostar.informatik.uni-stuttgart.de>
References: <OF1B73F5BF.374B4F66-ONC1257034.0040ADA2-42257034.0040BFAC@ptb.de>
	<17098.37597.698861.972333@isostar.informatik.uni-stuttgart.de>
Message-ID: <42CAA7FA.2040502@elvenkind.com>



Bernd Raichle wrote:
> Hi Taco,
> 
> I'm not on the NTG pdfTeX list (Rolf has forwarded your mail to the
> ExTeX Developers list), thus I am replying directly.  It is up to you
> to forward my mail to the list ...

Added the ntg-pdftex list in CC (but I am not on extex-devel so this
may get confusing).

>  >    \ifprimitive <csname>
>  > 
>  >      True if the <csname> has the same meaning as it would in initex,
>  >      (but gives an error if <csname> is currently undefined).
> 
> Ok.  What is the result for a non csname, incl. active characters?  I
> assume false.

I was thinking about issuing an error message, but Hans has convinced
me that returning false is more usable than an error. So it will be
false, even though it is clearly a user error to ask for the primitive-
ness of something that can not possibly be a primitive.

>  >    \executeprimitive <csname>
>  > 
>  >      Executes the primitive that would be known as <csname> in initex,
>  >      even if the <csname> is currently undefined or defined to mean
>  >      something else. Raises an error if there is no matching internal
>  >      command (of course).
> 
> Is \executeprimitive expandable or non expandable?  Or does it depend
> on the "expandability" of <csname>?

Either unexandable or dependant on the <csname>, but definately not
fully expandable (mainly because of the can of worms in your example).

>  > These are quite straightforward, and I do not assume this needs
>  > much discussion. But the next ones are related to "if feature ...",
>  > and those are bit harder to define.
>  > 
>  > I propose to make it possible to 'predefine' primitives in the
>  > executable. All program code is completely ready, except that the
>  > hash table entry is never created, making it impossible to use
>  > that primitive in initex without extra work.
> 
> A similar effect would be possible if (pdf)TeX has something like name
> spaces.  The predefined primitives can then reside in the namespace
> "internal" and can be made available by importing the symbols from the
> internal to the current namespace.

That is what Heiko hinted at as well, and here is how I responded:

Heiko said:
 > It needs some thinking.
 > First thoughts:
 > * It looks like a first step to a real namespace implementation,
 >   a (perhaps read-only) internal namespace, namespaces for extensions,
 >   and user/package macros. Why not going further then?

Taco replied:
 > TeX's current internal structure does not allow a clean solution,
 > so if we want true namespaces in TeX, we probably have to start
 > thinking about a successor to pdftex. Otherwise, we would need
 > to redesign the whole symbol table / token handling while trying
 > to remain 100% compatible. That sounds like a nightmare to me.
 >
 > These last 4 primitives I proposed are an attempt to come up with
 > something that works next month (as opposed to next year), but
 > you are right that it probably needs more thinking, anyway.

Back to Bernd's current e-mail:
> Mmmh, what is the result when existing csnames are "overwritten" by
> \expose... or when the meaning of an internal csname is assigned to
> another csname by \let and then obscured?

In general, if a macro progammer wants to be irresponsible, I'm not
going out of my way to stop them from doing so. However, some of the
more blatant user errors are easy to catch and I therefore propose
to make them illegal from the start:

\exposeinternal does not accept already defined <csname>s
and
\obscureinternal always makes the <csname> undefined

> Here are some test cases ...
> 
> \def\internalcommand{Hi!}
> \begingroup
>   \exposeinternal\internalcommand

A totally new error message is issued. Possibly

   ! Currently defined control sequence.
   \internalcommand ->Hi!

But in this case perhaps even a stronger restriction is needed:

   ! Not at top level.


> \obscureinternal\internalcommand
> \show\internalcommand

   *\show\internalcommand
   > \internalcommand=undefined.

> \begingroup
>   \exposeinternal\internalcommand
>   \global\let\x=\internalcommand
> \endgroup
 > \show\x

   *\show\x
   > \x=\internalcommand.

This is why the prefix is "obscure" instead of "undefine"

> \exposeinternal\internalcommand
> \let\x=\internalcommand
> \obscureinternal\internalcommand
> \show\x

   > \x=\internalcommand.


> \exposeinternal\internalcommand
> \def\x{\internalcommand}
> \obscureinternal\internalcommand
> \show\x

   > \x=macro:
->\internalcommand.

> \x

   ! Undefined control sequence.
   \x ->\internalcommand

> 
> Best wishes,
>   -bernd
From noreply at sarovar.org  Wed Jul  6 03:08:17 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Wed Jul  6 03:14:49 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] Math chars and cmbright fail with
	pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1DpyOf-0005bd-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Nobody (None)
Summary: Math chars and cmbright fail with pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-06 03:08

Message:
Logged In: YES 
user_id=421

Argl. The comment got lost. :-(

Your example is without eurofont, yet your log shows that
you use eurofont. Without eurofont the example works
perfectly for me with 1.21a and 1.30.0-rc2 ...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From noreply at sarovar.org  Wed Jul  6 03:08:59 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Wed Jul  6 03:15:25 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] Math chars and cmbright fail with
	pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1DpyPL-0005ed-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

>Category: Fonts
>Group: v1.21a
Status: Open
Resolution: None
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Nobody (None)
Summary: Math chars and cmbright fail with pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-06 03:08

Message:
Logged In: YES 
user_id=421

Argl. The comment got lost. :-(

Your example is without eurofont, yet your log shows that
you use eurofont. Without eurofont the example works
perfectly for me with 1.21a and 1.30.0-rc2 ...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From noreply at sarovar.org  Wed Jul  6 08:21:19 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Wed Jul  6 08:27:54 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] Math chars and cmbright fail with
	pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1Dq3Hb-0003TH-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

Category: Fonts
Group: v1.21a
Status: Open
Resolution: None
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Nobody (None)
Summary: Math chars and cmbright fail with pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2005-07-06 08:21

Message:
Logged In: YES 
user_id=929

I also can't reproduce the bug; have sent Pete an xputenv.c
with a few diagnostic printf's, which he has forwarded to
Gerben (who will soon be in holidays...).

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-06 03:08

Message:
Logged In: YES 
user_id=421

Argl. The comment got lost. :-(

Your example is without eurofont, yet your log shows that
you use eurofont. Without eurofont the example works
perfectly for me with 1.21a and 1.30.0-rc2 ...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From noreply at sarovar.org  Wed Jul  6 09:46:12 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Wed Jul  6 09:52:47 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] Math chars and cmbright fail with
	pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1Dq4bk-0007kh-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

Category: Fonts
Group: v1.21a
Status: Open
Resolution: None
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Nobody (None)
Summary: Math chars and cmbright fail with pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

>Comment By: Peter Dyballa (ballapete)
Date: 2005-07-06 09:46

Message:
Logged In: YES 
user_id=2303

Sorry, that's my fault with commented out %\usepackage{eurofont}!

The error becomes obvious with this file and the first two lines of math. The 
version below runs fine, but if you add any of the commented out math 
entities it breaks:

\documentclass[12pt]{article}
\usepackage{cmbright}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}


\begin{document}
    \section{Introcution}
    Let us do some math!

%     \[  x , 0 \mathbf{R} \]%\in x^2 \geq		% NOT ok
     \[  x , 0 \]% \forall \in \mathbf{R} x^2 \geq			% OK

    \begin{equation}
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0	
% OK!
    \end{equation}
\end{document}

I have too a case with archaic PK fonts and I've seen an answer to my ConTeXt 
question so that a third case might be coming ...

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-07-06 08:21

Message:
Logged In: YES 
user_id=929

I also can't reproduce the bug; have sent Pete an xputenv.c
with a few diagnostic printf's, which he has forwarded to
Gerben (who will soon be in holidays...).

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-06 03:08

Message:
Logged In: YES 
user_id=421

Argl. The comment got lost. :-(

Your example is without eurofont, yet your log shows that
you use eurofont. Without eurofont the example works
perfectly for me with 1.21a and 1.30.0-rc2 ...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From noreply at sarovar.org  Thu Jul  7 23:53:48 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Jul  8 00:00:33 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] Math chars and cmbright fail with
	pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1DqeJY-00084S-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

Category: Fonts
Group: v1.21a
>Status: Closed
>Resolution: Works For Me
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Nobody (None)
Summary: Math chars and cmbright fail with pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-07 23:53

Message:
Logged In: YES 
user_id=421

This seems to be an implementation problem on certain
versions of OSX.

----------------------------------------------------------------------

Comment By: Peter Dyballa (ballapete)
Date: 2005-07-06 09:46

Message:
Logged In: YES 
user_id=2303

Sorry, that's my fault with commented out %\usepackage{eurofont}!

The error becomes obvious with this file and the first two lines of math. The 
version below runs fine, but if you add any of the commented out math 
entities it breaks:

\documentclass[12pt]{article}
\usepackage{cmbright}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}


\begin{document}
    \section{Introcution}
    Let us do some math!

%     \[  x , 0 \mathbf{R} \]%\in x^2 \geq		% NOT ok
     \[  x , 0 \]% \forall \in \mathbf{R} x^2 \geq			% OK

    \begin{equation}
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0	
% OK!
    \end{equation}
\end{document}

I have too a case with archaic PK fonts and I've seen an answer to my ConTeXt 
question so that a third case might be coming ...

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-07-06 08:21

Message:
Logged In: YES 
user_id=929

I also can't reproduce the bug; have sent Pete an xputenv.c
with a few diagnostic printf's, which he has forwarded to
Gerben (who will soon be in holidays...).

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-06 03:08

Message:
Logged In: YES 
user_id=421

Argl. The comment got lost. :-(

Your example is without eurofont, yet your log shows that
you use eurofont. Without eurofont the example works
perfectly for me with 1.21a and 1.30.0-rc2 ...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From noreply at sarovar.org  Sun Jul 10 02:12:11 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 06:51:05 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-345 ] pdftex-syntax.txt: typo in \pdfobj
Message-ID: <E1DrPQZ-0001Y8-00@sarovar.org>

Bugs item #345, was opened at 2005-05-17 15:01
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=345&group_id=106

Category: Documentation
Group: None
>Status: Closed
Resolution: None
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Hartmut Henkel (hhenkel)
Summary: pdftex-syntax.txt: typo in \pdfobj

Initial Comment:
Hello,

the rules for \pdfobj in
  texk/web2c/pdftexdir/pdftex-syntax.txt
are wrong:

\pdfobj <object type spec>
<object type spec> --> reserveobjnum
                     | [useobjnum <number>]
                       [<attr spec>]
                       [stream [<attr spec>]]
                       <object contents>
<object contents> --> <file spec>
                    | <general text>

The first [<attr spec>] should be removed.
Result:
...
<object type spec> --> reserveobjnum
                     | [useobjnum <number>]
                       [stream [<attr spec>]]
                       <object contents>
Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

PS: A little surprised that the file has DOS line
    endings.

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2005-07-10 02:12

Message:
Logged In: YES 
user_id=929

it's in the manual CVS-1.611. Thanks, Heiko!

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-05-28 01:29

Message:
Logged In: YES 
user_id=1276

Hello,

the attached file also fixes other errors and typos
in syntax descriptions.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=345&group_id=106
From noreply at sarovar.org  Sun Jul 10 02:13:06 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 06:51:08 2005
Subject: [NTG-pdftex] [ pdftex-Patches-366 ] patch to grow pdf_mem
	dynamically
Message-ID: <E1DrPRS-0001Z6-00@sarovar.org>

Patches item #366, was opened at 2005-06-15 23:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106

Category: Memory allocation
Group: v1.30.0
>Status: Closed
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: patch to grow pdf_mem dynamically

Initial Comment:
experimental patch, pdf_mem_size from texmf.cnf would
be ignored then.

10000 < pdf_mem_size < 10000000 (arbitrary upper limit,
was 524288)

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2005-07-10 02:13

Message:
Logged In: YES 
user_id=929

it's in pdftex-1.30.0-rc2

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 15:10

Message:
Logged In: YES 
user_id=1608

I was not seriously suggesting to change the default value
to 100, I just had to do something to get the new code doing
stuff. It is not obvious to me what macros I should use to
fill up pdf_mem quickly :-)


----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2005-06-20 13:42

Message:
Logged In: NO 

100 is a bit low, hz etc need it, so maybe 2K makes more sense 

Hans 

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 11:00

Message:
Logged In: YES 
user_id=1608

This version looks smart. 
I applied it, but I do not have a lot of documents that need
more than a few words of pdf_mem, so I changed the
compile-time lower limit to 100. Works fine on my test
documents.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106
From taco at elvenkind.com  Sun Jul 10 10:54:29 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun Jul 10 10:57:30 2005
Subject: [NTG-pdftex] Re: PNG features
In-Reply-To: <42D0D10A.8080703@poczta.onet.pl>
References: <42D0D10A.8080703@poczta.onet.pl>
Message-ID: <42D0E245.3050808@elvenkind.com>


Hi Pawel,

The main problem was not in your input: during the merge of pngextra.ch,
the last change entry was not carried over to the main change file.

To be precise, this bit is missing:

@x
@p procedure check_and_set_pdfoptionpdfminorversion;
begin
@y
@p procedure check_and_set_pdfoptionpdfminorversion;
begin
  fixed_gamma             := fix_int(pdf_gamma, 0, 1000000);
  fixed_image_gamma       := fix_int(pdf_image_gamma, 0, 1000000);
  fixed_image_hicolor     := fix_int(pdf_option_pdf_image_hicolor, 0, 1);
  fixed_image_apply_gamma := fix_int(pdf_option_image_apply_gamma, 0, 1);
@z

Because of that, you always ended up with the compile-time defaults.
Martin, can you look into this please?

The minor problem is that the primitives behave like \pdfminorversion:
they are document-global and should be set before any typesetting is
done (the reason for that is that querying the image info and actually
reading the image data are disjunct processes in pdftex). This should
have been make clear in my documentation, I'm sorry.

Greetings, Taco


Pawel Jackowski wrote:
> Hi Taco,
> 
> i've a problem with advanced PNG handling in pdfTeX-1.30-rc2. The 
> attachement contains a sample with 16-bit PNG. As expected, 
> /BitsPerComponent is 16 or 8, if the version of PDF is 1.5 or less than 
> 1.5. Thats OK. But \pdfimagehicolor seems to be ignored. Regardless the 
> value of \pdfimagehicolor, if \pdfminorversion is greater than 4, images 
> are always loaded in 16-bit mode. Is it normal behaviour? If so, what is 
> the usage \pdfimagehicolor?
> 
> The second problem is that I can't see any effects of applying gamma 
> correction (also in the attachement). I always get (PNG copy) in log 
> file, regardless \pdfimageapplygamma valuse.
> 
> Any clue what I'm doing wrong?
> 
> Greetings,

From noreply at sarovar.org  Sun Jul 10 11:18:04 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 11:24:30 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
Message-ID: <E1DrXwq-0000vd-00@sarovar.org>

Bugs item #384, was opened at 2005-07-10 03:18
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Mike Sturt (pdfx)
Assigned to: Nobody (None)
Summary: Cannot mark text on pdfTeX-generated PDF files with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on Mac OS X

Initial Comment:
pdfTeX is not fully compatible with Adobe Acrobat Pro 7.02.

Here are the facts. More at <http://www.adobeforums.com>, that goes 
to <http://www.adobe.com/support/forums/main.html> and then 
click "Adobe Acrobat Mac" and then the message "Cannot mark text 
with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on 
Mac OS X".

In short:

pdfText generates PDF files that have the following bug:

I can select and mark text on such PDF files with the highlighter tool 
(sort of yellow fluorescent marker) the very first time that I open a 
document. Yet, the next time in a row, it is not possible (instead the 
text below is selected and yellow-marked in an erratic way. Tested with 
Acrobat Pro 7.02 on Mac OS X 10.3.9. 

Try with this file: 

http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

The culprit is pdfTeX, as explained in the Adobe Forum indicted above:

-----
I examined the file internally, and
it claims to have been made by pdfTeX version 3.14159-1.10b.

It also messes up other information. Creator (which should be the 
name
of the software designing the page) is a filename. Author, which
should have been BOE, is blank. 

To anyone who knows PDF, this sort of thing will ring alarm bells!
-----

Note: the workaround is to open the file with Adobe Acrobat Pro and 
then:

Advanced>Accessibilty>Add Tags to document.

If possible, please this annoying bug so that PDF files created 
withpdfTeX do not have such problem.

Thanks.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106
From noreply at sarovar.org  Sun Jul 10 11:41:30 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 11:51:33 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-378 ] xputenv.c:79: failed assertion
	`old_item' / pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)
Message-ID: <E1DrYJW-0002Om-00@sarovar.org>

Bugs item #378, was opened at 2005-07-05 17:17
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106

>Category: web2c
Group: v1.21a
>Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Peter Dyballa (ballapete)
>Assigned to: Olaf Weber (infovore)
>Summary: xputenv.c:79: failed assertion `old_item'  / pdfeTeX, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.5)

Initial Comment:
That's the document:

\documentclass[12pt]{article}
\usepackage{cmbright}
%\usepackage{eurofont}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}

\begin{document}
    This is a test document for testing purposes in cmbright. It's worth 
maybe 0,02\,\texteuro.
    \section{Introcution}
    Let us do some math!

%     \[ \forall x \in \mathbf{R}, x^2 \geq 0 \]		% NOT ok
     \[  x , 0 \]%\in \mathbf{R} x^2 \geq			% OK

%    \begin{equation}
%      \forall x \in \mathbf{R}, x^2 \geq 0			% NOT ok
%    \end{equation}

%    \begin{equation}
%      x = r^2 + \sum_{0}^{100} y^2				% NOT ok
%    \end{equation}

    \begin{equation}
%      {\partial\over\partial x} f(x,y) = {\partial\over\partial y} f(x,y) = 0
	% OK!
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0
	% OK!
    \end{equation}

\end{document}

Failure message:
.... (./cmbright.aux) (/usr/local/teTeX/share/texmf.tetex/tex/latex/
base/ts1cmr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/ts1cmbr.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omlcmbrm.fd)
(/usr/local/teTeX/share/texmf.tetex/tex/latex/cmbright/
omscmbrs.fd)

[1{/usr/local/teTeX/share/texmf.local/fonts/map/pdftex/updmap/
pdftex.map}]
(./cmbright.aux) ) </var/tmp/texfonts/pk/ljfour/public/cmbright/
cmbr10.720pk>xputenv.c:79: failed assertion `old_item'
Abort

No PS Type 1 fonts, only MF based.


----------------------------------------------------------------------

>Comment By: Olaf Weber (infovore)
Date: 2005-07-10 11:41

Message:
Logged In: YES 
user_id=1847

Reopening and assigning to myself, updating title and 
group to clarify problem. 
Likely this is a problem with the xputenv implementation 
in the web2c sources.  Attached is a new xputenv.c which 
should not suffer from the same problem.  It also doesn't 
require the SMART_PUTENV autoconf check (was originally 
written specifically to be able to get rid of this check). 
 

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-07 23:53

Message:
Logged In: YES 
user_id=421

This seems to be an implementation problem on certain
versions of OSX.

----------------------------------------------------------------------

Comment By: Peter Dyballa (ballapete)
Date: 2005-07-06 09:46

Message:
Logged In: YES 
user_id=2303

Sorry, that's my fault with commented out %\usepackage{eurofont}!

The error becomes obvious with this file and the first two lines of math. The 
version below runs fine, but if you add any of the commented out math 
entities it breaks:

\documentclass[12pt]{article}
\usepackage{cmbright}
\usepackage[T1]{fontenc}
%\usepackage{lmodern}
\usepackage[?]{amsmath}


\begin{document}
    \section{Introcution}
    Let us do some math!

%     \[  x , 0 \mathbf{R} \]%\in x^2 \geq		% NOT ok
     \[  x , 0 \]% \forall \in \mathbf{R} x^2 \geq			% OK

    \begin{equation}
      \frac{\partial}{\partial x} f(x,y) = \frac{\partial}{\partial y} f(x,y) = 0	
% OK!
    \end{equation}
\end{document}

I have too a case with archaic PK fonts and I've seen an answer to my ConTeXt 
question so that a third case might be coming ...

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-07-06 08:21

Message:
Logged In: YES 
user_id=929

I also can't reproduce the bug; have sent Pete an xputenv.c
with a few diagnostic printf's, which he has forwarded to
Gerben (who will soon be in holidays...).

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-06 03:08

Message:
Logged In: YES 
user_id=421

Argl. The comment got lost. :-(

Your example is without eurofont, yet your log shows that
you use eurofont. Without eurofont the example works
perfectly for me with 1.21a and 1.30.0-rc2 ...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=378&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:14:13 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:21:12 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
Message-ID: <E1DrcZR-0007m4-00@sarovar.org>

Bugs item #384, was opened at 2005-07-10 11:18
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106

Category: None
>Group: v1.10b
Status: Open
Resolution: None
Priority: 5
Submitted By: Mike Sturt (pdfx)
Assigned to: Nobody (None)
Summary: Cannot mark text on pdfTeX-generated PDF files with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on Mac OS X

Initial Comment:
pdfTeX is not fully compatible with Adobe Acrobat Pro 7.02.

Here are the facts. More at <http://www.adobeforums.com>, that goes 
to <http://www.adobe.com/support/forums/main.html> and then 
click "Adobe Acrobat Mac" and then the message "Cannot mark text 
with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on 
Mac OS X".

In short:

pdfText generates PDF files that have the following bug:

I can select and mark text on such PDF files with the highlighter tool 
(sort of yellow fluorescent marker) the very first time that I open a 
document. Yet, the next time in a row, it is not possible (instead the 
text below is selected and yellow-marked in an erratic way. Tested with 
Acrobat Pro 7.02 on Mac OS X 10.3.9. 

Try with this file: 

http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

The culprit is pdfTeX, as explained in the Adobe Forum indicted above:

-----
I examined the file internally, and
it claims to have been made by pdfTeX version 3.14159-1.10b.

It also messes up other information. Creator (which should be the 
name
of the software designing the page) is a filename. Author, which
should have been BOE, is blank. 

To anyone who knows PDF, this sort of thing will ring alarm bells!
-----

Note: the workaround is to open the file with Adobe Acrobat Pro and 
then:

Advanced>Accessibilty>Add Tags to document.

If possible, please this annoying bug so that PDF files created 
withpdfTeX do not have such problem.

Thanks.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:14

Message:
Logged In: YES 
user_id=421

pdfTeX allows the document to override any keys it will
insert into the document info (like Creator) and does not
automatically set the Author entry, so the culprit here is
BOE, not the software.

On the highlighting problem I have no clue, as I also have
no Acrobat Pro (Adobe does not provide a version for Linux).

Hans?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:15:56 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:22:32 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
Message-ID: <E1Drcb6-0007mP-00@sarovar.org>

Bugs item #384, was opened at 2005-07-10 11:18
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106

Category: None
Group: v1.10b
Status: Open
Resolution: None
Priority: 5
Submitted By: Mike Sturt (pdfx)
>Assigned to: Hans Hagen (hagen)
Summary: Cannot mark text on pdfTeX-generated PDF files with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on Mac OS X

Initial Comment:
pdfTeX is not fully compatible with Adobe Acrobat Pro 7.02.

Here are the facts. More at <http://www.adobeforums.com>, that goes 
to <http://www.adobe.com/support/forums/main.html> and then 
click "Adobe Acrobat Mac" and then the message "Cannot mark text 
with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on 
Mac OS X".

In short:

pdfText generates PDF files that have the following bug:

I can select and mark text on such PDF files with the highlighter tool 
(sort of yellow fluorescent marker) the very first time that I open a 
document. Yet, the next time in a row, it is not possible (instead the 
text below is selected and yellow-marked in an erratic way. Tested with 
Acrobat Pro 7.02 on Mac OS X 10.3.9. 

Try with this file: 

http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

The culprit is pdfTeX, as explained in the Adobe Forum indicted above:

-----
I examined the file internally, and
it claims to have been made by pdfTeX version 3.14159-1.10b.

It also messes up other information. Creator (which should be the 
name
of the software designing the page) is a filename. Author, which
should have been BOE, is blank. 

To anyone who knows PDF, this sort of thing will ring alarm bells!
-----

Note: the workaround is to open the file with Adobe Acrobat Pro and 
then:

Advanced>Accessibilty>Add Tags to document.

If possible, please this annoying bug so that PDF files created 
withpdfTeX do not have such problem.

Thanks.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:14

Message:
Logged In: YES 
user_id=421

pdfTeX allows the document to override any keys it will
insert into the document info (like Creator) and does not
automatically set the Author entry, so the culprit here is
BOE, not the software.

On the highlighting problem I have no clue, as I also have
no Acrobat Pro (Adobe does not provide a version for Linux).

Hans?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:17:15 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:23:49 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
Message-ID: <E1DrccN-0007mf-00@sarovar.org>

Bugs item #384, was opened at 2005-07-10 11:18
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106

Category: None
Group: v1.10b
Status: Open
Resolution: None
Priority: 5
Submitted By: Mike Sturt (pdfx)
Assigned to: Hans Hagen (hagen)
Summary: Cannot mark text on pdfTeX-generated PDF files with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on Mac OS X

Initial Comment:
pdfTeX is not fully compatible with Adobe Acrobat Pro 7.02.

Here are the facts. More at <http://www.adobeforums.com>, that goes 
to <http://www.adobe.com/support/forums/main.html> and then 
click "Adobe Acrobat Mac" and then the message "Cannot mark text 
with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on 
Mac OS X".

In short:

pdfText generates PDF files that have the following bug:

I can select and mark text on such PDF files with the highlighter tool 
(sort of yellow fluorescent marker) the very first time that I open a 
document. Yet, the next time in a row, it is not possible (instead the 
text below is selected and yellow-marked in an erratic way. Tested with 
Acrobat Pro 7.02 on Mac OS X 10.3.9. 

Try with this file: 

http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

The culprit is pdfTeX, as explained in the Adobe Forum indicted above:

-----
I examined the file internally, and
it claims to have been made by pdfTeX version 3.14159-1.10b.

It also messes up other information. Creator (which should be the 
name
of the software designing the page) is a filename. Author, which
should have been BOE, is blank. 

To anyone who knows PDF, this sort of thing will ring alarm bells!
-----

Note: the workaround is to open the file with Adobe Acrobat Pro and 
then:

Advanced>Accessibilty>Add Tags to document.

If possible, please this annoying bug so that PDF files created 
withpdfTeX do not have such problem.

Thanks.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:17

Message:
Logged In: YES 
user_id=421

Attaching
http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:14

Message:
Logged In: YES 
user_id=421

pdfTeX allows the document to override any keys it will
insert into the document info (like Creator) and does not
automatically set the Author entry, so the culprit here is
BOE, not the software.

On the highlighting problem I have no clue, as I also have
no Acrobat Pro (Adobe does not provide a version for Linux).

Hans?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106
From martin at oneiros.de  Sun Jul 10 16:11:42 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun Jul 10 16:24:47 2005
Subject: [NTG-pdftex] Re: PNG features
In-Reply-To: <42D0E245.3050808@elvenkind.com>
References: <42D0D10A.8080703@poczta.onet.pl> <42D0E245.3050808@elvenkind.com>
Message-ID: <20050710141141.GA22030@lucien.kn-bremen.de>

On 2005-07-10 10:54:29 +0200, Taco Hoekwater wrote:
> Because of that, you always ended up with the compile-time defaults.
> Martin, can you look into this please?

Done:

--- /home/ms/tex/pdftex/releases/pdftex-1.30.0-rc2/src/texk/web2c/pdftexdir/pdftex.ch	Sat Jul  2 21:49:42 2005
+++ pdftex.ch	Sun Jul 10 16:08:44 2005
@@ -70,7 +70,7 @@
 @y
 @d pdftex_version==130 { \.{\\pdftexversion} }
 @d pdftex_revision=="0" { \.{\\pdftexrevision} }
-@d pdftex_version_string=='-1.30.0-rc2' {current \pdfTeX\ version}
+@d pdftex_version_string=='-1.30.0-rc3' {current \pdfTeX\ version}
 @#
 @d pdfTeX_banner=='This is pdfTeX, Version 3.141592',pdftex_version_string
    {printed when \pdfTeX\ starts}
@@ -970,7 +970,7 @@
 
 @ This checks that |pdfminorversion| can only be set before any
 bytes have been written to the generated pdf file. It should be called
-directly every after |ensure_pdf_open|.
+directly after every |ensure_pdf_open|.
 
 @p procedure check_pdfminorversion;
 begin
@@ -990,6 +990,10 @@
         end;
         fixed_pdf_minor_version := pdf_minor_version;
         pdf_buf[7] := chr(ord("0") + fixed_pdf_minor_version);
+        fixed_gamma             := fix_int(pdf_gamma, 0, 1000000);
+        fixed_image_gamma       := fix_int(pdf_image_gamma, 0, 1000000);
+        fixed_image_hicolor     := fix_int(pdf_image_hicolor, 0, 1);
+        fixed_image_apply_gamma := fix_int(pdf_image_apply_gamma, 0, 1);
     end
     else begin
         if fixed_pdf_minor_version <> pdf_minor_version then

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Sun Jul 10 16:19:55 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:26:27 2005
Subject: [NTG-pdftex] [ pdftex-Feature Requests-320 ] add support for a
	colour stack
Message-ID: <E1Drcex-0007nX-00@sarovar.org>

Feature Requests item #320, was opened at 2005-03-28 05:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=320&group_id=106

Category: None
>Group: None
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Aleks Kleyn (aleks_kleyn)
Assigned to: Nobody (None)
>Summary: add support for a colour stack

Initial Comment:
I want to change color of text using comand \textcolor
{blue}. However when text flows from one page to 
another the color resets to standard on the next 
page. 
Initially I beleived that this problem of pdf. 
However I 
tried today latex.exe and then converted dvi to pdf. 
I got 
effect that I expected: text had on both pages the 
same 
color. However using of pdflatex is more better 
because 
it prepares bookmarks for pdf.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:19

Message:
Logged In: YES 
user_id=421

This is really a feature request.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-06-16 14:45

Message:
Logged In: YES 
user_id=421

The cause is a missing colour stack of pdfTeX; this is a
known problem (and more properly a feature request).

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=320&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:21:54 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:28:25 2005
Subject: [NTG-pdftex] [ pdftex-Patches-376 ] Uniform and Normal Distribution
	Pseudo-random numbers patch
Message-ID: <E1Drcgs-0007o8-00@sarovar.org>

Patches item #376, was opened at 2005-06-27 16:45
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=376&group_id=106

Category: Primitives
Group: v1.30.0
>Status: Closed
>Resolution: Accepted
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Nobody (None)
Summary: Uniform and Normal Distribution  Pseudo-random numbers patch

Initial Comment:

See the patch file itself or the mailing list for 
actual usage and comments. 

Requested by Pawel.

It is intented to be applied after tex.pch (as usual)


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:21

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=376&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:22:27 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:29:00 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
Message-ID: <E1DrchP-0007oK-00@sarovar.org>

Patches item #375, was opened at 2005-06-25 03:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=375&group_id=106

Category: None
>Group: v1.30.0
>Status: Closed
>Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Patch EscapeAndOther

Initial Comment:
Hello,

Subject: Patch EscapeAndOther
Date: 2005/06/25
Author: Heiko Oberdiek

The patch is based on pdftex-1.30.0-rc1.
It supersedes patch EscapeDivers.tar.bz2

Inherited from patch EscapeDivers:
  Expandable: \pdfstrcmp, \pdfescapestring, \pdfescapename
  Added: \pdfescapehex, \pdfunescapehex
  Fix: \pdfescapename: '%' is also a delimiter that
       needs escaping.

New in patch EscapeAndOther:
  * \pdfcreationdate
  * \pdffilemoddate
  * \pdffilesize
  * \pdfmdfivesum
  * \pdffiledump
  * \pdfshellescape
  * \pdfmatch and \pdflastmatch
  * Start with bug fix: quotes are legal in other
    operating systems than windows.

The description is in file README and
I also post it to the ntg-pdftex mailing
list.

Patched files:
  The main part is implemented in:
  * utils.c
  * pdfstrcmp.ch is added.

  The other files only contains small changes:
  * pdftoepdf.cc, epdf.h, ptexlib.h
      because of changed signature of
convertStringToPDFString()
  * pdftex.defines adds new/deletes old entries of utils.c
  * pdftex.mk, pdfetex.mk: addition of pdfstrcmp.ch

Patch is applied by
  patch -p0 <EscapeDivers.patch
in the base directory that contains "src".

Example, the current directory contains
pdftex-1.30.0-rc1.zip and EscapeAndOther.patch,
contained in EscapeAndOther.tar.bz2:
  unzip pdftex-1.30.0-rc1.zip
  cd pdftex-1.30.0-rc1
  patch -p0 <../EscapeAndOther.patch
  ./Build

Test files that test the conversion of all characters:
  test-escapename.tex
  test-escapestring.tex
  test-escapehex.tex
  test-unescapehex.tex

Have fun
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:22

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=375&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:23:45 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:30:25 2005
Subject: [NTG-pdftex] [ pdftex-Patches-371 ] Expandable \pdfstrcmp,
	\pdfescape*, added \pdf(de)escapehex
Message-ID: <E1Drcif-00087r-00@sarovar.org>

Patches item #371, was opened at 2005-06-20 17:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=371&group_id=106

Category: None
>Group: v1.30.0
>Status: Closed
>Resolution: Out of Date
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Expandable \pdfstrcmp, \pdfescape*, added \pdf(de)escapehex

Initial Comment:
Hello,

the result of last weekend is a patch that
makes \pdfstrcmp (based on Harmut's work)
and the \pdfescape* commands expandable.
Thus \pdflastescaped* are not needed
anymore.
 I could remove the dependency
on a limited buffer by copying the destination
strings directly in the string pool above the
source string.
  Also the patch adds the fixes of bug 369.

Fourth I add \pdfescapehex and \pdfunescapehex
that implements encoding and decoding for
hexadecimal strings:
* Strings can also be given as hex strings in
  angle brackets.
* Safe method to store and read string data to
  auxiliary files without worrying about catcodes,
  unmachted curly braces, ...
* Help in handling UTF-8/Unicode or other hex coding
  stuff.

Patch is applied by
  patch <EscapeDivers.patch
in directory
  src/texk/web2c/pdftexdir

The Makefile needs modifying. After the lines
  $(srcdir)/pdftexdir/tex.pch
the line
  $(srcdir)/pdftexdir/pdfstrcmp.ch
is inserted. This should be done two times for
pdftex and pdfetex.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:23

Message:
Logged In: YES 
user_id=421

Superseded by #375.

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-06-21 08:52

Message:
Logged In: YES 
user_id=1276

Hello,

the first patch missed the changes in pdftex.defines.
Now the patch is reorganized:

Patched files:
  * utils.c
      main part of the fix, especially function
      convertStringToPDFName().
  * pdftoepdf.cc, epdf.h, ptexlib.h
      because of changed signature of
      convertStringToPDFString()
  * pdftex.defines adds new/deletes old entries
    of utils.c
  * pdfstrcmp.ch is added.
  * pdftex.mk, ../pdfetexdir/pdfetex.mk:
    addition of pdfstrcmp.ch

Now the patch must be applied in scr/texk/web2c:
  patch -p0 <EscapeDivers.patch
With the following commands I could compile pdf(e)tex:
  unzip pdftex-1.30.0-rc1.zip
  cd pdftex-1.30.0-rc1/src/texk/web2c
  patch -p0 <../../../../EscapeDivers.patch
  cd -   
  ./Build

Sorry for the inconvenience
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=371&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:24:08 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:30:44 2005
Subject: [NTG-pdftex] [ pdftex-Patches-374 ] noligatures patch
Message-ID: <E1Drcj2-00088C-00@sarovar.org>

Patches item #374, was opened at 2005-06-23 10:54
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=374&group_id=106

Category: Primitives
Group: v1.30.0
>Status: Closed
>Resolution: Accepted
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: The Thanh Han (hanthethanh)
Summary: noligatures patch

Initial Comment:

Usage is quite straightforward: 
  \noligatures \f 
disables ligatures for the loaded font \f. 

The (unexpandable) value of \noligatures \f is either
1, when the font has no ligatures, or 0, when the font
*does* have ligatures.

This patch is to be applied after tex.pch, but see the
change file itself for a remark regarding MLTeX.

As requested by Hans.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:24

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=374&group_id=106
From noreply at sarovar.org  Sun Jul 10 16:25:03 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 16:31:34 2005
Subject: [NTG-pdftex] [ pdftex-Feature Requests-254 ] fontexpansion,
	dvi output
Message-ID: <E1Drcjv-00088V-00@sarovar.org>

Feature Requests item #254, was opened at 2004-12-22 22:06
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=254&group_id=106

Category: None
Group: None
>Status: Closed
>Resolution: Postponed
Priority: 5
Submitted By: Nobody (None)
>Assigned to: The Thanh Han (hanthethanh)
Summary: fontexpansion, dvi output

Initial Comment:
Hello developers,

I'd like to use the autoexpand feature with dvips. Are
there any plans to make pdftex write the autoexpanded
tfm files to the current directory, perhaps even
generating a map file? 

Cheers,
Michael

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2005-01-14 03:19

Message:
Logged In: YES 
user_id=710

It is likely that this will never be implemented. The better
way to do that is to change the script \<TEX> (\<PDFTEX>)
calls to create missing \<TFM> during run-time (on
\<WEB2C>-based systems this is called |mktextfm|) to create
all the required stuff on demand. 

Thanh

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=254&group_id=106
From noreply at sarovar.org  Sun Jul 10 17:38:41 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 17:45:13 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-385 ] \ptexnoligatures breaks \mathaccent
Message-ID: <E1DrdtB-0003Pm-00@sarovar.org>

Bugs item #385, was opened at 2005-07-10 15:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=385&group_id=106

Category: Fonts
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Hartmut Henkel (hhenkel)
Summary: \ptexnoligatures breaks \mathaccent

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=385&group_id=106
From noreply at sarovar.org  Sun Jul 10 18:04:08 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 18:10:41 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-385 ] \ptexnoligatures breaks \mathaccent
Message-ID: <E1DreHo-0004Ov-00@sarovar.org>

Bugs item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=385&group_id=106

Category: Fonts
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: Taco Hoekwater (taco)
Summary: \ptexnoligatures breaks \mathaccent

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=385&group_id=106
From jackos1 at poczta.onet.pl  Sun Jul 10 18:10:33 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sun Jul 10 18:11:08 2005
Subject: [NTG-pdftex] backslash in \pdfpagesattr
Message-ID: <42D14879.2010109@poczta.onet.pl>

Hi,

I've noticed by accident that if there is a backslash in \pdfpagesattr 
toks, /Pages object is not created at all.

	\catcode`\/=0
	\catcode`\\=12
	/pdfpagesattr={\}?/end

Doesn't hurt, since backslash is rather pointless in /Pages dict (?), 
but nothing like that happen in \pdfpageattr; backslash is written as 
is. Planned behaviour or side effect?

pdfTeX 1.2, 1.3.

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From noreply at sarovar.org  Sun Jul 10 18:50:57 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 18:57:31 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-385 ] \ptexnoligatures breaks \mathaccent
Message-ID: <E1Drf17-0006yJ-00@sarovar.org>

Bugs item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=385&group_id=106

Category: Fonts
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Taco Hoekwater (taco)
Summary: \ptexnoligatures breaks \mathaccent

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=385&group_id=106
From oberdiek at uni-freiburg.de  Sun Jul 10 19:13:44 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Sun Jul 10 19:15:59 2005
Subject: [NTG-pdftex] backslash in \pdfpagesattr
In-Reply-To: <42D14879.2010109@poczta.onet.pl>
References: <42D14879.2010109@poczta.onet.pl>
Message-ID: <20050710171344.GA4900@irwin.vpn.uni-freiburg.de>

On Sun, Jul 10, 2005 at 06:10:33PM +0200, Pawel Jackowski wrote:

> I've noticed by accident that if there is a backslash in \pdfpagesattr 
> toks, /Pages object is not created at all.
> 
> 	\catcode`\/=0
> 	\catcode`\\=12
> 	/pdfpagesattr={\}?/end
> 
> Doesn't hurt, since backslash is rather pointless in /Pages dict (?), 
> but nothing like that happen in \pdfpageattr; backslash is written as 
> is. Planned behaviour or side effect?

I cannot reproduce it (pdfTeX-1.30.0-rc1):

    7 0 obj <<
    /Type /Pages
    /Count 1
    /Kids [2 0 R]
    \
    >> endobj

The /Pages dict and the backslash are present. (Of course the
lonely backslash is invalid PDF syntax here.)

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From taco at elvenkind.com  Sun Jul 10 19:17:32 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun Jul 10 19:20:32 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-385 ] \ptexnoligatures breaks
	\mathaccent
In-Reply-To: <E1Drf17-0006yJ-00@sarovar.org>
References: <E1Drf17-0006yJ-00@sarovar.org>
Message-ID: <42D1582C.90402@elvenkind.com>

noreply@sarovar.org wrote:
> This is because it (\ptexnoligatures) also disables the
> kerning information for the font. You'll have to accept that
> as a "known limitation" for now.

Actually, while chasing this, I did find a bug.

Martin, can you please apply this one-liner for me?:

--- pdftex.ch.orig 2005-07-06 13:17:42.000000000 +0200
+++ pdftex.ch   2005-07-10 18:32:00.161840104 +0200
@@ -3681,11 +3681,11 @@
  procedure set_no_ligatures(f: internal_font_number);
  var c:integer;
  begin
   for c := font_bc[f] to font_ec[f] do
         if char_exists(orig_char_info(f)(c)) then
-      if odd(char_tag(orig_char_info(f)(c))) then
+      if char_tag(orig_char_info(f)(c))=lig_tag then
          op_byte(orig_char_info(f)(c)) := 
(op_byte(orig_char_info(f)(c))) - lig_tag;
  end;

  function init_font_base(v: integer): integer;
  @z

TIA, Taco
From taco at elvenkind.com  Sun Jul 10 19:16:34 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun Jul 10 19:43:03 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-385 ] \ptexnoligatures breaks
	\mathaccent
In-Reply-To: <E1Drf17-0006yJ-00@sarovar.org>
References: <E1Drf17-0006yJ-00@sarovar.org>
Message-ID: <42D157F2.3060802@elvenkind.com>

noreply@sarovar.org wrote:
> This is because it (\ptexnoligatures) also disables the
> kerning information for the font. You'll have to accept that
> as a "known limitation" for now.

Actually, while chasing this, I did find a bug.

Martin, can you please apply this one-liner for me?:

--- pdftex.ch.orig 2005-07-06 13:17:42.000000000 +0200
+++ pdftex.ch   2005-07-10 18:32:00.161840104 +0200
@@ -3681,11 +3681,11 @@
  procedure set_no_ligatures(f: internal_font_number);
  var c:integer;
  begin
   for c := font_bc[f] to font_ec[f] do
         if char_exists(orig_char_info(f)(c)) then
-      if odd(char_tag(orig_char_info(f)(c))) then
+      if char_tag(orig_char_info(f)(c))=lig_tag then
          op_byte(orig_char_info(f)(c)) := 
(op_byte(orig_char_info(f)(c))) - lig_tag;
  end;

  function init_font_base(v: integer): integer;
  @z

TIA, Taco
From noreply at sarovar.org  Sun Jul 10 20:29:41 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 20:36:08 2005
Subject: [NTG-pdftex] [ pdftex-Patches-386 ] grow obj_tab and dest_names
	arrays dynamically
Message-ID: <E1DrgYf-0003Z9-00@sarovar.org>

Patches item #386, was opened at 2005-07-10 20:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106

Category: Memory allocation
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: grow obj_tab and dest_names arrays dynamically

Initial Comment:
experimental patch to grow the obj_tab and dest_names
arrays dynamically; arrays initially have 1000 entries.
This required also update of file avlstuff.c.

Similar to patch-366, which did this already for the
pdf_mem array. Then all (?) pdftex-specific memory
configuration parameters, obj_tab_size,
dest_names_size, and pdf_mem_size in texmf.cnf would be
ignored.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106
From noreply at sarovar.org  Sun Jul 10 23:04:35 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 10 23:11:13 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
Message-ID: <E1DriyZ-00037Q-00@sarovar.org>

Bugs item #384, was opened at 2005-07-10 09:18
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106

Category: None
Group: v1.10b
Status: Open
Resolution: None
Priority: 5
Submitted By: Mike Sturt (pdfx)
Assigned to: Hans Hagen (hagen)
Summary: Cannot mark text on pdfTeX-generated PDF files with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on Mac OS X

Initial Comment:
pdfTeX is not fully compatible with Adobe Acrobat Pro 7.02.

Here are the facts. More at <http://www.adobeforums.com>, that goes 
to <http://www.adobe.com/support/forums/main.html> and then 
click "Adobe Acrobat Mac" and then the message "Cannot mark text 
with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on 
Mac OS X".

In short:

pdfText generates PDF files that have the following bug:

I can select and mark text on such PDF files with the highlighter tool 
(sort of yellow fluorescent marker) the very first time that I open a 
document. Yet, the next time in a row, it is not possible (instead the 
text below is selected and yellow-marked in an erratic way. Tested with 
Acrobat Pro 7.02 on Mac OS X 10.3.9. 

Try with this file: 

http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

The culprit is pdfTeX, as explained in the Adobe Forum indicted above:

-----
I examined the file internally, and
it claims to have been made by pdfTeX version 3.14159-1.10b.

It also messes up other information. Creator (which should be the 
name
of the software designing the page) is a filename. Author, which
should have been BOE, is blank. 

To anyone who knows PDF, this sort of thing will ring alarm bells!
-----

Note: the workaround is to open the file with Adobe Acrobat Pro and 
then:

Advanced>Accessibilty>Add Tags to document.

If possible, please this annoying bug so that PDF files created 
withpdfTeX do not have such problem.

Thanks.

----------------------------------------------------------------------

>Comment By: Hans Hagen (hagen)
Date: 2005-07-10 21:04

Message:
Logged In: YES 
user_id=927

i did s quick test

- it concerns pdf pages inserted into tex 
- the inserted text has a funny baseline distance (watch how
some lines touch 
- text selection goes ok, so the problem is not in pdftex
- my guess is that the comment tool is unable to determine
the proper line distance -- it skips lines -- also keep in
mind that the comment feature is an annotation and needs to
create some rectangle like specs which then end up on the
annotation layer

Hans 

- my impression is that 



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 14:17

Message:
Logged In: YES 
user_id=421

Attaching
http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 14:14

Message:
Logged In: YES 
user_id=421

pdfTeX allows the document to override any keys it will
insert into the document info (like Creator) and does not
automatically set the Author entry, so the culprit here is
BOE, not the software.

On the highlighting problem I have no clue, as I also have
no Acrobat Pro (Adobe does not provide a version for Linux).

Hans?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106
From jackos1 at poczta.onet.pl  Mon Jul 11 01:14:27 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Mon Jul 11 01:14:31 2005
Subject: [NTG-pdftex] backslash in \pdfpagesattr
In-Reply-To: <20050710171344.GA4900@irwin.vpn.uni-freiburg.de>
References: <42D14879.2010109@poczta.onet.pl>
	<20050710171344.GA4900@irwin.vpn.uni-freiburg.de>
Message-ID: <42D1ABD3.9030306@poczta.onet.pl>


> I cannot reproduce it (pdfTeX-1.30.0-rc1):
> The /Pages dict and the backslash are present. (Of course the
> lonely backslash is invalid PDF syntax here.)

Sure it is. Pdf code viewer I use silently discards syntax errors so the 
object simply disappear. Shame on me, I should check more carefully. Sorry.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From martin at oneiros.de  Mon Jul 11 01:32:17 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul 11 07:54:06 2005
Subject: [NTG-pdftex] Re: [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
In-Reply-To: <E1DriyZ-00037Q-00@sarovar.org>
References: <E1DriyZ-00037Q-00@sarovar.org>
Message-ID: <20050710233217.GA25423@lucien.kn-bremen.de>

On 2005-07-11 02:34:35 +0530, noreply@sarovar.org wrote:
> >Comment By: Hans Hagen (hagen)
> Date: 2005-07-10 21:04
> 
> Message:
> Logged In: YES 
> user_id=927
> 
> i did s quick test
> 
> 
> 
> - it concerns pdf pages inserted into tex 
> 
> - the inserted text has a funny baseline distance (watch how
> 
> some lines touch 

They don't here if I zoom in...

> - text selection goes ok, so the problem is not in pdftex
> 
> - my guess is that the comment tool is unable to determine
> 
> the proper line distance -- it skips lines -- also keep in
> 
> mind that the comment feature is an annotation and needs to
> 
> create some rectangle like specs which then end up on the
> 
> annotation layer
> 
> 
> 
> Hans 
> 
> 
> 
> - my impression is that 

Btw: This is the complete document infodict:
-----------------
/Title (BOE 156 de 01/07/2005 Sec 1 Pag 23458 a 23458) /Creator
(BOE) /Producer (BOE) /Author (BOLETIN OFICIAL DEL ESTADO)
/CreationDate (D:20050701) /ModDate (D:20050701) /Subject (BOE)
/Keywords (BOE) /Title (A23458-23458) /Subject () /Author ()
/Creator (ConTeXt/user/A23458-23458.tex) /ModDate (20050701) /ID
(A23458-23458.20050701) /Keywords ()/Trapped /False
-----------------

ConTeXt :-)

I'm tempted to postpone this until this BOE comes along. And then
you can sell them some consultance. :-)

Best
    Martin
From taco at elvenkind.com  Mon Jul 11 17:11:52 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul 11 17:12:12 2005
Subject: [NTG-pdftex] TeX trie processing (\pattern loading) details
	visualisation
In-Reply-To: <429F265B.3070402@elvenkind.com>
References: <429D6DD1.2040005@wxs.nl>
	<429D734F.7040203@elvenkind.com>	<429D7FB5.90406@wxs.nl>
	<429F265B.3070402@elvenkind.com>
Message-ID: <42D28C38.3000505@elvenkind.com>


Hi,

Vaguely connected to the font reader visualisation I posted last
month, I have created a visualisation of the trie (\pattern)
processing source code in initex.

There are files here:

    http://tex.aanhet.net/temp/patreader.zip (12.825 bytes)
    http://tex.aanhet.net/temp/patreader.pdf (> 36 Megabytes)

Please fetch the zip file and attempt to generate a local
version yourself before downloading the PDF document :)

The process itself is a bit harder to comprehend than the font
reader, so some background knowledge is needed. It also helps
if you have the TeX pascal sources handy.

I should probably write a descriptive text in prose to go along
with the images, but I'm bored with this stuff. It took me much
longer than I had anticipated, because I kept running into
limitations of MP ;-(


Roughly, the execution order <-> pages mapping is as follows:

   pages      function          action

    1  -   8  new_patterns()    % \patterns for language 0
    9  -  23  new_patterns()    % \patterns for language 2
   24  -  26  new_patterns()    % \patterns for language 1
   27  -  29  init_trie()       % initialization of arrays
   30  -  41  init_trie()       % reshuffling languages 2 and 1
   42  -  42  init_trie()       % prepare for compression
   43  - 241  compress_trie()   % trie compression
  242  - 244  init_trie()       % prepare for packing
  245  - 717  first_fit()       % trie packing
  718  - 965  init_trie()       % finalizations for run-time

The various blue items are used runtime (i.e. during hyphenation),
the other arrays are only used in initex or only for statistics
reporting.

trie_hash is physically the same array as trie_ref, but it is
cleaner to show them separately.

The supplied perl script can in fact demonstrate the hyphenation of
words using TeX's algorithm, but if you want meaningful results you
have to feed it hyphen.tex instead of the three demonstration languages,
and in that case, you have to increase the two limits ($trie_size and
$trie_op_size). Check the top (and bottom) of the perl script for that.

Have fun,

Taco

From noreply at sarovar.org  Mon Jul 11 22:52:24 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul 11 22:59:01 2005
Subject: [NTG-pdftex] [ pdftex-Patches-387 ] writeenc.c tidied up
Message-ID: <E1Ds5GK-0007d6-00@sarovar.org>

Patches item #387, was opened at 2005-07-11 22:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=387&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
Resolution: None
Priority: 3
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: writeenc.c tidied up

Initial Comment:
minor changes make writeenc.c:

Removed linked list from add_enc(), not needed anymore
since \pdfmovechars are obsolete. Rewrote enc_free()
correspondingly.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=387&group_id=106
From noreply at sarovar.org  Tue Jul 12 00:11:01 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jul 12 00:17:44 2005
Subject: [NTG-pdftex] [ pdftex-Patches-387 ] writeenc.c tidied up
Message-ID: <E1Ds6UP-0003Od-00@sarovar.org>

Patches item #387, was opened at 2005-07-11 22:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=387&group_id=106

Category: Fonts
Group: v1.30.0
>Status: Closed
>Resolution: Accepted
Priority: 3
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: writeenc.c tidied up

Initial Comment:
minor changes make writeenc.c:

Removed linked list from add_enc(), not needed anymore
since \pdfmovechars are obsolete. Rewrote enc_free()
correspondingly.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 00:11

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=387&group_id=106
From noreply at sarovar.org  Tue Jul 12 22:23:30 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jul 12 22:30:22 2005
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \ptexnoligatures
	should leave kerning intact
Message-ID: <E1DsRHu-0001BL-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

>Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: Nobody (None)
>Summary: \ptexnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106
From noreply at sarovar.org  Tue Jul 12 22:24:16 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jul 12 22:31:01 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-377 ] unqoute image filenames not only
	on windows
Message-ID: <E1DsRIe-0001BX-00@sarovar.org>

Bugs item #377, was opened at 2005-07-02 21:43
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106

Category: Image inclusion
>Group: v1.21a
>Status: Closed
>Resolution: Wont Fix
>Priority: 3
Submitted By: Georg Baum (baum)
Assigned to: Martin Schr?der (oneiros)
Summary: unqoute image filenames not only on windows

Initial Comment:
The file 
pdftex-1.30.0-rc1/src/texk/web2c/pdftexdir/writeimg.c 
contains in the function readfile() a code block to 
unqoute file names which is inside #ifdef WIN32 ... 
#endif.
This code should be enabled on all platforms (or at
least on linux), since quoted filenames (which are
necessary if the name contains spaces) do not only work
well on linux.

Thanks,


Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-05 10:57

Message:
Logged In: YES 
user_id=1276

Hello,

> I manually copied and cited your message because I could 
> not find out how to do that correctly with the tracker 
> system :-( 

Also the tiny typein area and the order of postings is
very annoying. Perhaps we should better continue the
discussion on the ntg-pdftex mailing list.

>> Now you want the limitation of windows that quotes 
>> cannot be used apply on the other systems? 
> 
> I want to trade in the use of quotes for the use of
> spaces. 
> Since you can only have one (not really, see below) it is 
> from a user's point of view better to support spaces on
> all 
> platforms and not spaces on windows and quotes on other 
> platforms. 

>From a user's point it is better to support all
characters instead of randomly choosen ones.
The quoting method makes things worse:
* There is no method to detect, whether quoting is
  supported:
  \includegraphics{"abc def.png"}
  The graphics package does not know, whether the
  TeX compiler will look for {abc def.png},
  {"abc def.png"}, or {"abc}.
  Now you cannot use *both* quotes *and* spaces.
* A very long time, spaces are considered "fancy"
  in file names, it is asking for trouble, because
  they are not supported on DOS file systems.
  But nowadays, spaces become "normal" despite the
  trouble (also on windows systems).
  The difference in our problem descriptions seems
  to be that you want to have *spaces* as usable
  characters in filenames, my conclusion is that
  we must allow *any* character as usable. Otherwise
  we will have bug reports about quotes.
* And if we have a solution with *all* characters,
  there will be no problems with different encodings
  including ucs-2 or ucs-4.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Georg Baum (baum)
Date: 2005-07-04 18:55

Message:
Logged In: YES 
user_id=2590

Hello, 
 
I manually copied and cited your message because I could 
not find out how to do that correctly with the tracker 
system :-( 
 
> I must disagree, "the same behaviour on all platforms" 
> can not mean to add the limitations of all platforms. 
 
No, that is not my intention. 
 
> Now you want the limitation of windows that quotes 
> cannot be used apply on the other systems? 
 
I want to trade in the use of quotes for the use of spaces. 
Since you can only have one (not really, see below) it is 
from a user's point of view better to support spaces on all 
platforms and not spaces on windows and quotes on other 
platforms. 
 
> There are operating systems that deal with 8+3 file 
> names only. Do you want to forbid long file names, 
> for example? 
 
Of course not. 
 
> Thus we are loosing both quotes and spaces. Spaces still 
> cannot be used in general. Other TeX engines 
> does not know about quoting. There is no secure way 
> to know, whether quoting is working. Thus code that 
> is intended for different systems must avoid spaces. 
 
And quotes (in the filename itself, not for quoting), so 
this is not really an argument to support them. 
Concerning other implementations: \includegraphics{foo.png} 
does not work with plain latex, but with pdflatex. The same 
would apply to spaces in filenames, so I see no big problem 
there. 
 
> And the current quoting scheme does not solve the 
> problem at all, it moves the problem from spaces to 
> quotes, spaces can still not be used and quotes are 
> now made unavailable. Also the quoting scheme does 
> not allow quoting of the quotes themselves. 
 
It does (although I am not sure whether that is intended): 
Only the first quote is stripped from two consecutive 
quotes, e.g. the string '"a""bc"' is transformed into 
'a"bc'. 
 
> A solution would allow *all* characters. 
> The solution should be able to deal with utf-8 or 
> even ucs-2/4 encoded file names. 
 
Agreed. If you think that the quoting is so bad then why 
not remove it altogether and tell users to use \pdfximage? 
 
My problem with the current implementation is the 
inconsistency: If filenames with spaces work on windows if 
quoted, I expect that they work on linux, too, since the OS 
supports them. Of course I can't expect the same from 
filenames with quotes: They are not supported by windows, 
so they can't be supported by pdftex on windows. 
 
I hope I have made my point clear. I can live with it if 
you still don't agree, so I'll stop arguing now. 
 
 
Georg 

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 16:07

Message:
Logged In: YES 
user_id=1276

Hello,

I must disagree, "the same behaviour on all platforms"
can not mean to add the limitations of all platforms.
Now you want the limitation of windows that quotes
cannot be used apply on the other systems?
There are operating systems that deal with 8+3 file
names only. Do you want to forbid long file names,
for example?

Thus we are loosing both quotes and spaces. Spaces still
cannot be used in general. Other TeX engines
does not know about quoting. There is no secure way
to know, whether quoting is working. Thus code that
is intended for different systems must avoid spaces.
  And the current quoting scheme does not solve the
problem at all, it moves the problem from spaces to
quotes, spaces can still not be used and quotes are
now made unavailable. Also the quoting scheme does
not allow quoting of the quotes themselves.

A solution would allow *all* characters.
The solution should be able to deal with utf-8 or
even ucs-2/4 encoded file names.
  That is already given by the syntax of \pdfximage.
Thus new primitives \pdfinput, \pdfopenin, \pdfopenout
with <general text> would allow any file name and a
macro code can test, whether this feature is available
by testing the command names.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Georg Baum (baum)
Date: 2005-07-04 13:46

Message:
Logged In: YES 
user_id=2590

I agree that the quote stripping is a hack and should
eventually be replaced by something better.
I do think however that the behaviour on all platforms
should be the same if it is at all possible. Right now,
filenames with quotes work on linux and not on windows, and
quoted filenames with spaces work on windows but not on linux.
Thanks for the hint to pdfximage, I did not know about that
(coming from standard LaTeX and always using \includegraphics}

Georg

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-07-04 13:13

Message:
Logged In: YES 
user_id=1276

Hello,

it is a very bad idea, quotes are perfectly legal
in linux and other operating systems. Also image
inclusion is done by \pdfximage that uses
<general text>, by <general text>, text surrounded
by curly braces (catcode 1 and 2) *all* possible
file names can be given including quotes and spaces.

We need rather new primitives for
\input, \openin, and \openout to provide the file
names as <general text>. The all file names can
be given without the need of quoting at all.
See also the discussion about \pdfinput in
the ntg-pdftex mailing list.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=377&group_id=106
From noreply at sarovar.org  Tue Jul 12 22:24:57 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jul 12 22:31:37 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-384 ] Cannot mark text on
	pdfTeX-generated PDF files with highlighter tool (yellow
	fluorescent marker) of Acrobat Pro 7.02 on Mac OS X
Message-ID: <E1DsRJJ-0001Bj-00@sarovar.org>

Bugs item #384, was opened at 2005-07-10 11:18
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106

Category: None
Group: v1.10b
>Status: Closed
>Resolution: Rejected
Priority: 5
Submitted By: Mike Sturt (pdfx)
Assigned to: Hans Hagen (hagen)
Summary: Cannot mark text on pdfTeX-generated PDF files with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on Mac OS X

Initial Comment:
pdfTeX is not fully compatible with Adobe Acrobat Pro 7.02.

Here are the facts. More at <http://www.adobeforums.com>, that goes 
to <http://www.adobe.com/support/forums/main.html> and then 
click "Adobe Acrobat Mac" and then the message "Cannot mark text 
with highlighter tool (yellow fluorescent marker) of Acrobat Pro 7.02 on 
Mac OS X".

In short:

pdfText generates PDF files that have the following bug:

I can select and mark text on such PDF files with the highlighter tool 
(sort of yellow fluorescent marker) the very first time that I open a 
document. Yet, the next time in a row, it is not possible (instead the 
text below is selected and yellow-marked in an erratic way. Tested with 
Acrobat Pro 7.02 on Mac OS X 10.3.9. 

Try with this file: 

http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

The culprit is pdfTeX, as explained in the Adobe Forum indicted above:

-----
I examined the file internally, and
it claims to have been made by pdfTeX version 3.14159-1.10b.

It also messes up other information. Creator (which should be the 
name
of the software designing the page) is a filename. Author, which
should have been BOE, is blank. 

To anyone who knows PDF, this sort of thing will ring alarm bells!
-----

Note: the workaround is to open the file with Adobe Acrobat Pro and 
then:

Advanced>Accessibilty>Add Tags to document.

If possible, please this annoying bug so that PDF files created 
withpdfTeX do not have such problem.

Thanks.

----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2005-07-10 23:04

Message:
Logged In: YES 
user_id=927

i did s quick test

- it concerns pdf pages inserted into tex 
- the inserted text has a funny baseline distance (watch how
some lines touch 
- text selection goes ok, so the problem is not in pdftex
- my guess is that the comment tool is unable to determine
the proper line distance -- it skips lines -- also keep in
mind that the comment feature is an annotation and needs to
create some rectangle like specs which then end up on the
annotation layer

Hans 

- my impression is that 



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:17

Message:
Logged In: YES 
user_id=421

Attaching
http://www.boe.es/boe/dias/2005-07-01/pdfs/A23458-23458.pdf

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-10 16:14

Message:
Logged In: YES 
user_id=421

pdfTeX allows the document to override any keys it will
insert into the document info (like Creator) and does not
automatically set the Author entry, so the culprit here is
BOE, not the software.

On the highlighting problem I have no clue, as I also have
no Acrobat Pro (Adobe does not provide a version for Linux).

Hans?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=384&group_id=106
From martin at oneiros.de  Tue Jul 12 22:44:27 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jul 12 22:45:32 2005
Subject: [NTG-pdftex] 1.30.0-rc3
In-Reply-To: <20050702202251.GH2247@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
Message-ID: <20050712204427.GD11274@lucien.kn-bremen.de>

http://sarovar.org/download.php/658/pdftex-1.30.0-rc3.zip

This is functionally equivalent to rc2, but
- I've merged with the current source.development from TL,
  updating us to web2c 7.5.5 (Olaf, I have changed some files
  throughout the tree to remove pdfxtex; please merge them into
  your sources). I don't think I broke anything...
- zlib 1.2.2
- updated manual (it still needs updating for all \ptex
  primitives)
- hopefully all patches sent to me since rc2

TODO:
- TEST
- documentation: 
  - manual
  - check NEWS
- update change-files.txt

I'm aiming for a release on Friday.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Thu Jul 14 08:34:41 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jul 14 08:41:19 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-389 ] Spacing Bug with \pdfliteral direct
Message-ID: <E1DsxIv-000375-00@sarovar.org>

Bugs item #389, was opened at 2005-07-14 08:34
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=389&group_id=106

Category: Literals
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: Spacing Bug with \pdfliteral direct

Initial Comment:
"\pdfliteral direct" screws up spacing. Hans found it.
Therefore one has to use the non-direct variant e. g.
for changing color in text, which results in tedious
transforms.

The trivial patch seems to solve this. Now it's
possible to define color "direct". See the test.pdf
file. Actually i don't understand at all what the patch
does, but it seemed to be the only place where the literal
interferes with position calculations.

It seems that the patch does not mangle the horizontal
positioning calculation; see the placement of the
\vrule after the ET, which is independent from whether
\pdfliteral direct is used or not.

Rough patch. Tests welcome.

Regards, Hartmut


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=389&group_id=106
From noreply at sarovar.org  Thu Jul 14 10:28:08 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jul 14 10:34:53 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-389 ] Spacing Bug with \pdfliteral direct
Message-ID: <E1Dsz4i-0000Ww-00@sarovar.org>

Bugs item #389, was opened at 2005-07-14 08:34
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=389&group_id=106

Category: Literals
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: Spacing Bug with \pdfliteral direct

Initial Comment:
"\pdfliteral direct" screws up spacing. Hans found it.
Therefore one has to use the non-direct variant e. g.
for changing color in text, which results in tedious
transforms.

The trivial patch seems to solve this. Now it's
possible to define color "direct". See the test.pdf
file. Actually i don't understand at all what the patch
does, but it seemed to be the only place where the literal
interferes with position calculations.

It seems that the patch does not mangle the horizontal
positioning calculation; see the placement of the
\vrule after the ET, which is independent from whether
\pdfliteral direct is used or not.

Rough patch. Tests welcome.

Regards, Hartmut


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2005-07-14 10:28

Message:
Logged In: YES 
user_id=1608

I did some extra tests with spaces around the grey text,
and it output turned out ok.

I don't understand this trickery with pdf_first_space_corr
at all, but since it seems to work i'm reluctant to spend
an indeterminate amount of time on discovering the intent
of it.

Patch looks good, afaict.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=389&group_id=106
From noreply at sarovar.org  Fri Jul 15 15:25:35 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Jul 15 15:32:28 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-389 ] Spacing Bug with \pdfliteral direct
Message-ID: <E1DtQC7-0004fv-00@sarovar.org>

Bugs item #389, was opened at 2005-07-14 08:34
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=389&group_id=106

Category: Literals
Group: v1.30.0
>Status: Closed
>Resolution: Fixed
>Priority: 3
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: Spacing Bug with \pdfliteral direct

Initial Comment:
"\pdfliteral direct" screws up spacing. Hans found it.
Therefore one has to use the non-direct variant e. g.
for changing color in text, which results in tedious
transforms.

The trivial patch seems to solve this. Now it's
possible to define color "direct". See the test.pdf
file. Actually i don't understand at all what the patch
does, but it seemed to be the only place where the literal
interferes with position calculations.

It seems that the patch does not mangle the horizontal
positioning calculation; see the placement of the
\vrule after the ET, which is independent from whether
\pdfliteral direct is used or not.

Rough patch. Tests welcome.

Regards, Hartmut


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-15 15:25

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.0

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-14 10:28

Message:
Logged In: YES 
user_id=1608

I did some extra tests with spaces around the grey text,
and it output turned out ok.

I don't understand this trickery with pdf_first_space_corr
at all, but since it seems to work i'm reluctant to spend
an indeterminate amount of time on discovering the intent
of it.

Patch looks good, afaict.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=389&group_id=106
From martin at oneiros.de  Fri Jul 15 19:39:54 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul 15 19:40:57 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-359 ] pdftex generates errors when it
	does not have to - eg \pdfinfo
In-Reply-To: <20050616130439.GD32396@lucien.kn-bremen.de>
References: <E1DcoeA-0001gK-00@sarovar.org>
	<20050531084300.GF2519@monty.localnet>
	<20050616130439.GD32396@lucien.kn-bremen.de>
Message-ID: <20050715173954.GB16401@lucien.kn-bremen.de>

On 2005-06-16 15:04:39 +0200, Martin Schr?der wrote:
> It isn't now. Can all \pdf primitives be ignored in dvi-mode?

I have changed check_pdfoutput to
----------------------
procedure check_pdfoutput(s: str_number; is_error : boolean);
begin
    if pdf_output <= 0 then
        if is_error then
            pdf_error(s, "used while \pdfoutput is not set")
        else 
            pdf_warning(s, "used while \pdfoutput is not set", true);
end;
----------------------

And changed the calls for \pdfinfo, \pdfcatalog and \pdftrailer
to is_error=false.

This gives
! pdfTeX warning (\pdfinfo): used while \pdfoutput is not set
and
! pdfTeX error (\pdfincludechars): used while \pdfoutput is not set.
l.120 \pdfincludechars
                      \font{ABCDEF}

Of course this can lead to confusing situations:
----------------------
\pdfoutput=0
\pdfinfo{/Foo (Bar)
\pdfoutput=1
foo
\bye
----------------------
will have /Foo (Bar) in the info dict. But we don't say that we
are _ignoring_ the data; and doing so would be more difficult.

Comments?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Fri Jul 15 20:02:44 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul 15 20:03:39 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-359 ] pdftex generates errors when it
	does not have to - eg \pdfinfo
In-Reply-To: <20050715173954.GB16401@lucien.kn-bremen.de>
References: <E1DcoeA-0001gK-00@sarovar.org>
	<20050531084300.GF2519@monty.localnet>
	<20050616130439.GD32396@lucien.kn-bremen.de>
	<20050715173954.GB16401@lucien.kn-bremen.de>
Message-ID: <20050715180244.GC16401@lucien.kn-bremen.de>

On 2005-07-15 19:39:54 +0200, Martin Schr?der wrote:
> will have /Foo (Bar) in the info dict. But we don't say that we
> are _ignoring_ the data; and doing so would be more difficult.

Turns out it isn't so difficult.
----------------
\pdfoutput=0
\pdfinfo{/Test (Foo)}
\pdfoutput=1
\pdfinfo{/Test1 (Bar)}
Test
\bye
----------------
Now gives
----------------
> etex 359.tex 
This is pdfeTeX, Version 3.141592-1.30.0-rc4-2.2 (Web2C 7.5.5)
entering extended mode
(./359.tex
! pdfTeX warning (\pdfinfo): used while \pdfoutput is not set; ignoring it
[1{/home/ms/.texmf-var/fonts/map/pdftex/updmap/pdftex.map}] )</opt/tex.test/sha
re/texmf-dist/fonts/type1/bluesky/cm/cmr10.pfb>
Output written on 359.pdf (1 page, 4829 bytes).
Transcript written on 359.log.
----------------
359.pdf has /Test1 (Bar) in the info dict.

I've done the same for \pdfcatalog and \pdftrailer.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From hartmut_henkel at gmx.de  Fri Jul 15 21:25:22 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jul 15 21:25:27 2005
Subject: [NTG-pdftex] Colored text,
 was [ pdftex-Bugs-389 ] Spacing Bug with \pdfliteral direct
In-Reply-To: <E1DtQC7-0004fv-00@sarovar.org>
References: <E1DtQC7-0004fv-00@sarovar.org>
Message-ID: <Pine.LNX.4.61.0507152105330.5023@hahepc1.hahe>

On Fri, 15 Jul 2005 noreply@sarovar.org wrote:

> Comment By: Martin Schr??der (oneiros)
> Date: 2005-07-15 15:25
>
> Message:
> Logged In: YES
> user_id=421
>
> This has been fixed in 1.30.0

Thanks a lot, Martin! Let's hope that it's ok. The change also can
affect the PDF file size where lots of \pdfliterals are used for color
change. E. g. if in pdfcolor.tex (used by pdfwebmac.tex) the \pdfliteral
is changed to its direct version, the pdfetex.pdf file made from the
pdfetex.web/.ch sources is smaller by about 8% iirc, while looking
similar.

Also the following font coloring seems to work more efficiently; the
recipe is an update from an E-Mail to texhax at 29 Feb 2004:

Start from cmr10.tfm, put this into some working directory. Then:

$ tftopl cmr10.tfm > cmr10.pl
$ cp cmr10.pl cmrcolor10.vpl

Now in the file cmrcolor10.vpl change

  (FAMILY CMR)
into
  (FAMILY CMRCOLOR)

and just before the 1st line

  (CHARACTER O 0

in cmrcolor10.vpl add a line

(MAPFONT D 0 (FONTNAME cmr10))

so that the cmrcolor10.vpl references cmr10.tfm as real font.

Then do

$ vptovf cmrcolor10.vpl

which creates
  cmrcolor10.tfm
  cmrcolor10.vf

Then do

$vftovp cmrcolor10.vf > cmrcolor10.vpl

which re-creates
   cmrcolor10.vpl

Now you have reached the first goal: A cmrcolor10.vpl file ready for
your tweaking. Then you can add funny pdfTeX specials e. g. by some awk
script:

$ export LANG="C" ; awk -f addspecial.awk cmrcolor10.vpl > temp
$ mv temp cmrcolor10.vpl

where the addspecial.awk looks like:

#begin of addspecial.awk
/SETCHAR/{
  r = 0.6 * rand();
  g = 0.6 * rand();
  b = 0.6 * rand();
  printf("      (SPECIAL pdf:direct: %.3f %.3f %.3f rg)\n", r, g, b);
  print $0;
  printf("      (SPECIAL pdf:direct: 0 0 0 rg)\n");
  next;
}

//{print}
#end of addspecial.awk

Then do a final

$ vptovf cmrcolor10.vpl

This creates the working versions
  cmrcolor10.tfm
  cmrcolor10.vf

Now you can call the colored font by pdftex e. g. from the following
tex file:

\pdfcompresslevel=0
\font\cmrcolor cmrcolor10 at 10pt
\cmrcolor
\input tufte
\bye

BTW, don't try to use \ptexuniformdeviate in the special. It's not
expanded at this late time; else one would get a completely randomly
colored font...

Have fun!

Regards, Hartmut
From hanthethanh at myrealbox.com  Sun Jul 17 15:57:29 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Sun Jul 17 15:57:31 2005
Subject: [NTG-pdftex] character attribute
Message-ID: <20050717135729.GG2664@monty.localnet>

Hi,

currently a character node in tex has the only attribute, ie
the associated font. I m wondering whether it makes  sense
to replace this attribute (font) by a pointer to some data
structure representing a set of attributes. This way we can
add further attributes of a character without messing up
around the sources. Such attributes can be: font, color,
location in tex sources, next bytes of a utf8 sequence etc.
How to you guys see it?

Thanh
From hanthethanh at myrealbox.com  Sun Jul 17 16:09:50 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Sun Jul 17 16:10:11 2005
Subject: [NTG-pdftex] pdftex maintenance
Message-ID: <20050717140950.GH2664@monty.localnet>

Hi all,

I no longer have access to the texlive perforce server (port
1666 blocked), hence I think this is the moment to make an
official request: that is from now only Martin will be
responsible for sources maintance and tracking
bugs/patches/feature requests. If I make any changes, I will
submit my changes in the same way like Hartmut, Taco and
Heiko have been doing. How do you see it?

Regards,
Thanh
From pragma at wxs.nl  Sun Jul 17 20:51:33 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jul 17 20:51:04 2005
Subject: [NTG-pdftex] character attribute
In-Reply-To: <20050717135729.GG2664@monty.localnet>
References: <20050717135729.GG2664@monty.localnet>
Message-ID: <42DAA8B5.2020207@wxs.nl>

The Thanh Han wrote:

>Hi,
>
>currently a character node in tex has the only attribute, ie
>the associated font. I m wondering whether it makes  sense
>to replace this attribute (font) by a pointer to some data
>structure representing a set of attributes. This way we can
>add further attributes of a character without messing up
>around the sources. Such attributes can be: font, color,
>location in tex sources, next bytes of a utf8 sequence etc.
>How to you guys see it?
>  
>
this is indeed a much wanted feature although i don't know what you mean 
with utf 8 here since at the char node that has already been reslvbed

of course it needs some thinking because it should be easy to combine 
existing functionality with user built stuff; also, additional features 
would be needed in order to handle resources at page boundaries and such 
(comparable to marks ) ; fonts probably are hard coded features then

how do you envision this? Say that

\newfeature \mycolor

defines an abstract feature. At a certain point tex  needs to let a 
macro package handle the features, i.e. pass all relevant features to a 
handler;

\handlefeature (gets called as many times as needed with \feature set)

this could be something direct or delayed (it depends on how it will 
influence par building and page breaking etc; for instance one may now 
want specials/literals to end up too soon in the process; i can even 
imagine that all features are  delayed till shipout time;

we need to distinguish between begin and end situations (maybe even at 
the level of lines, paragraphs, pages, splits ... it's not that easy to 
come up with a good generic approach

to some extend marks are ok to handle features, but they lack some 
functionality (like a proper way to reset the internal mark register); 
and they also can interfere

[taco and i had some discussion on this but i don't think we ever wrote 
down something ...]

Hans

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Sun Jul 17 19:21:46 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun Jul 17 23:03:32 2005
Subject: [NTG-pdftex] pdftex maintenance
In-Reply-To: <20050717140950.GH2664@monty.localnet>
References: <20050717140950.GH2664@monty.localnet>
Message-ID: <20050717172145.GB2006@lucien.kn-bremen.de>

On 2005-07-17 16:09:50 +0200, The Thanh Han wrote:
> I no longer have access to the texlive perforce server (port
> 1666 blocked), hence I think this is the moment to make an
> official request: that is from now only Martin will be
> responsible for sources maintance and tracking
> bugs/patches/feature requests. If I make any changes, I will
> submit my changes in the same way like Hartmut, Taco and
> Heiko have been doing. How do you see it?

No problem.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Sun Jul 17 23:48:37 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sun Jul 17 23:55:10 2005
Subject: [NTG-pdftex] [ pdftex-Patches-391 ] Extending \pdfliteral
Message-ID: <E1DuH01-0008BN-00@sarovar.org>

Patches item #391, was opened at 2005-07-17 23:48
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=391&group_id=106

Category: Literals
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: Extending \pdfliteral

Initial Comment:
see ntg-pdftex list 17 Jul 2005 and README inside
pdfliteral.tgz

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=391&group_id=106
From hartmut_henkel at gmx.de  Sun Jul 17 23:55:35 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sun Jul 17 23:55:39 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
Message-ID: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>

Currently the \pdfliteral can be used with "direct" option, or without.
In "direct" mode, the \pdfliteral text goes directly into the stream,
wherever, without any coordinate transform. Without "direct" there is
always an ET, and a transform.

It seems that Acrobat does not allow grouping q...Q inside BT...ET
sections (xpdf tolerates it). There is currently no way to guarantee
that a literal text does not end up in a BT...ET section without using
the plain \pdfliteral {} mode (without "direct"). But then one has
the matrix transform, which precludes grouping; well, here is a funny
counter-example:

\pdfcompresslevel=0
\newbox\marbox
\setbox\marbox\hbox{\qquad Hello}
A%
\pdfliteral {q}%
  \rlap{%
    \box\marbox
  }%
\pdfliteral {Q}%
B
\bye

This gives:

BT
/F1 9.9626 Tf 91.9253 759.9271 Td[(A)]TJ
ET
1 0 0 1 99.3973 759.9271 cm
q
1 0 0 1 -99.3973 -759.9271 cm
BT
/F1 9.9626 Tf 119.3226 759.9271 Td[(Hello)]TJ
ET
1 0 0 1 99.3973 759.9271 cm
Q
1 0 0 1 -99.3973 -759.9271 cm
BT
/F1 9.9626 Tf 99.3973 759.9271 Td[(B)]TJ 204.112 -654.7472 Td[(1)]TJ
ET

It even comes out right :-) But when one could guarantee that the grouping
does not end up in a BT...ET section, one could have such a simpler PDF
output instead:

BT
/F1 9.9626 Tf 91.9253 759.9271 Td[(A)]TJ
ET
q
BT
/F1 9.9626 Tf 119.3226 759.9271 Td[(Hello)]TJ
ET
Q
BT
/F1 9.9626 Tf 99.3973 759.9271 Td[(B)]TJ 204.112 -654.7472 Td[(1)]TJ
ET

That's what the new "et" option of the appended tiny experimental patch
does; it forces an ET if required, but without transform. In the patch
also the internal literal() function interface is slightly changed to
make a little more transparent what happens.

With this patch it seems to be roughly like the following:

1. any color change without q/Q grouping just put into \pdfliteral direct
{}. No transform will happen, resulting in minimum amount of PDF code.
And this should hopefully be safe after bug 389 has gone.

2. for grouping around TeX stuff use pairs of \pdfliteral et {}, or
\special{pdf:et:...}. Grouping will be done outside BT...ET, no transform
will happen.

3. for positioning of raw PDF graphics at the current point put it into
\pdfliteral {} as usual.

4. for positioning of raw PDF graphics with absolute positioning on the
page relative to its lower left corner from everywhere on the page put
it into \pdfliteral et {}.

This is low-level stuff, should not interfere with a color stack.

Would such an "et" option have its use?

Regards, Hartmut
From staw at gust.org.pl  Mon Jul 18 00:14:21 2005
From: staw at gust.org.pl (Staszek Wawrykiewicz)
Date: Mon Jul 18 00:14:20 2005
Subject: [NTG-pdftex] pdftex maintenance
In-Reply-To: <20050717140950.GH2664@monty.localnet>
Message-ID: <Pine.LNX.4.44.0507180010420.2120-100000@re86.internetdsl.tpnet.pl>

On Sun, 17 Jul 2005, The Thanh Han wrote:

> I no longer have access to the texlive perforce server (port
> 1666 blocked), hence I think this is the moment to make an

Uhh, it seems that you didn't received the message from Rainer

>From rainer.schoepf@proteosys.com Mon Jul 18 00:07:53 2005
Date: Wed, 6 Jul 2005 11:36:24 +0200 (CEST)
From: "[ISO-8859-1] Rainer Sch?pf" <rainer.schoepf@proteosys.com>
To: Karl Berry <karl@freefriends.org>
Cc: tex-live@tug.org,
     "[ISO-8859-1] Rainer Sch?pf" <rainer.schoepf@proteosys.com>
Subject: [tex-live] Re: p4 server move tomorrow -> texlive.dante.de

OK, the move is done. DNS is updated. The new perforce server is now:

 texlive.dante.de:1666

   a.k.a.

 comedy.dante.de:1666

Please use the texlive name.

Rainer

-- 
Staszek Wawrykiewicz
StaW@gust.org.pl

From hartmut_henkel at gmx.de  Mon Jul 18 00:48:24 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon Jul 18 00:48:28 2005
Subject: [NTG-pdftex] character attribute
In-Reply-To: <42DAA8B5.2020207@wxs.nl>
References: <20050717135729.GG2664@monty.localnet> <42DAA8B5.2020207@wxs.nl>
Message-ID: <Pine.LNX.4.61.0507180037550.5374@hahepc1.hahe>

On Sun, 17 Jul 2005, Hans Hagen wrote:

> The Thanh Han wrote:
>
> > currently a character node in tex has the only attribute, ie
> > the associated font. I m wondering whether it makes  sense
> > to replace this attribute (font) by a pointer to some data
> > structure representing a set of attributes. This way we can
> > add further attributes of a character without messing up
> > around the sources. Such attributes can be: font, color,
> > location in tex sources, next bytes of a utf8 sequence etc.
> > How to you guys see it?
> >
> this is indeed a much wanted feature although i don't know what you
> mean with utf 8 here since at the char node that has already been
> reslvbed

maybe one could keep character storage in (variable length) UTF format
throughout? Actually what would happen if the control sequence names
would be stored without input conversion in the pool with their original
UTF format? The hash would still work with UTF codes. Problems are e. g.
how to replace the eqtb area with the first 256 characters? Maybe also
use there a multi-byte sequence with a "single character" attribute?

<snip>

Regards, Hartmut
From pragma at wxs.nl  Mon Jul 18 00:51:34 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul 18 00:51:07 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
Message-ID: <42DAE0F6.1040105@wxs.nl>

Hartmut Henkel wrote:

>Currently the \pdfliteral can be used with "direct" option, or without.
>In "direct" mode, the \pdfliteral text goes directly into the stream,
>wherever, without any coordinate transform. Without "direct" there is
>always an ET, and a transform.
>  
>
whow, i'm impressed by your testing of patches -)

>It seems that Acrobat does not allow grouping q...Q inside BT...ET
>sections (xpdf tolerates it). There is currently no way to guarantee
>that a literal text does not end up in a BT...ET section without using
>the plain \pdfliteral {} mode (without "direct"). But then one has
>the matrix transform, which precludes grouping; well, here is a funny
>counter-example:
>  
>
q Q deals with the graphic state only (mostly characteristics of line 
drawing, not that this is an excuse for acrobat fo rnot handling them -)

>\pdfcompresslevel=0
>\newbox\marbox
>\setbox\marbox\hbox{\qquad Hello}
>A%
>\pdfliteral {q}%
>  \rlap{%
>    \box\marbox
>  }%
>\pdfliteral {Q}%
>B
>\bye
>
>This gives:
>
>BT
>/F1 9.9626 Tf 91.9253 759.9271 Td[(A)]TJ
>ET
>1 0 0 1 99.3973 759.9271 cm
>q
>1 0 0 1 -99.3973 -759.9271 cm
>BT
>/F1 9.9626 Tf 119.3226 759.9271 Td[(Hello)]TJ
>ET
>1 0 0 1 99.3973 759.9271 cm
>Q
>1 0 0 1 -99.3973 -759.9271 cm
>BT
>/F1 9.9626 Tf 99.3973 759.9271 Td[(B)]TJ 204.112 -654.7472 Td[(1)]TJ
>ET
>
>It even comes out right :-) But when one could guarantee that the grouping
>does not end up in a BT...ET section, one could have such a simpler PDF
>output instead:
>
>BT
>/F1 9.9626 Tf 91.9253 759.9271 Td[(A)]TJ
>ET
>q
>BT
>/F1 9.9626 Tf 119.3226 759.9271 Td[(Hello)]TJ
>ET
>Q
>BT
>/F1 9.9626 Tf 99.3973 759.9271 Td[(B)]TJ 204.112 -654.7472 Td[(1)]TJ
>ET
>
>That's what the new "et" option of the appended tiny experimental patch
>does; it forces an ET if required, but without transform. In the patch
>also the internal literal() function interface is slightly changed to
>make a little more transparent what happens.
>  
>
maybe use 'text' instead of 'et'

>With this patch it seems to be roughly like the following:
>
>1. any color change without q/Q grouping just put into \pdfliteral direct
>{}. No transform will happen, resulting in minimum amount of PDF code.
>And this should hopefully be safe after bug 389 has gone.
>  
>
ok; q Q grouping does not make sense with colors anyway

>2. for grouping around TeX stuff use pairs of \pdfliteral et {}, or
>\special{pdf:et:...}. Grouping will be done outside BT...ET, no transform
>will happen.
>
>  
>
ok, so \pdfliteral et {Q}  % or \pdfliteral text {Q} -)

>3. for positioning of raw PDF graphics at the current point put it into
>\pdfliteral {} as usual.
>
>4. for positioning of raw PDF graphics with absolute positioning on the
>page relative to its lower left corner from everywhere on the page put
>it into \pdfliteral et {}.
>  
>
eh ... doesn't that mark it as BT ET ?

maybe add \pdfliteral graphics {...} as explicit variant for positioning 
relative to the lower leftcorner (i.e. obscure what happens with et)

>This is low-level stuff, should not interfere with a color stack.
>
>Would such an "et" option have its use?
>  
>
sure; we really need full control over that part (we should also make sure that dvipdfmx supports a similar model) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Mon Jul 18 00:57:17 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul 18 00:56:49 2005
Subject: [NTG-pdftex] character attribute
In-Reply-To: <Pine.LNX.4.61.0507180037550.5374@hahepc1.hahe>
References: <20050717135729.GG2664@monty.localnet> <42DAA8B5.2020207@wxs.nl>
	<Pine.LNX.4.61.0507180037550.5374@hahepc1.hahe>
Message-ID: <42DAE24D.4050905@wxs.nl>

Hartmut Henkel wrote:

>On Sun, 17 Jul 2005, Hans Hagen wrote:
>
>  
>
>>The Thanh Han wrote:
>>
>>    
>>
>>>currently a character node in tex has the only attribute, ie
>>>the associated font. I m wondering whether it makes  sense
>>>to replace this attribute (font) by a pointer to some data
>>>structure representing a set of attributes. This way we can
>>>add further attributes of a character without messing up
>>>around the sources. Such attributes can be: font, color,
>>>location in tex sources, next bytes of a utf8 sequence etc.
>>>How to you guys see it?
>>>
>>>      
>>>
>>this is indeed a much wanted feature although i don't know what you
>>mean with utf 8 here since at the char node that has already been
>>reslvbed
>>    
>>
>
>maybe one could keep character storage in (variable length) UTF format
>throughout? Actually what would happen if the control sequence names
>would be stored without input conversion in the pool with their original
>UTF format? The hash would still work with UTF codes. Problems are e. g.
>how to replace the eqtb area with the first 256 characters? Maybe also
>use there a multi-byte sequence with a "single character" attribute?
>  
>
but in that case we should use unicode slots a la xetex or aleph ... 
somethign we need to do anyway when pdftex moves open type

Hans

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Mon Jul 18 01:41:08 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul 18 07:50:24 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <42DAE0F6.1040105@wxs.nl>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
Message-ID: <20050717234108.GA7004@lucien.kn-bremen.de>

On 2005-07-18 00:51:34 +0200, Hans Hagen wrote:
> Hartmut Henkel wrote:
> >It seems that Acrobat does not allow grouping q...Q inside BT...ET
> >sections (xpdf tolerates it). There is currently no way to guarantee
> >that a literal text does not end up in a BT...ET section without using
> >the plain \pdfliteral {} mode (without "direct"). But then one has
> >the matrix transform, which precludes grouping; well, here is a funny
> >counter-example:
> q Q deals with the graphic state only (mostly characteristics of line 
> drawing, not that this is an excuse for acrobat fo rnot handling them -)

I'm not sure I understand Hartmut correctly: "BT q Q ET" is not
allowed, but "q BT ET Q" is (see Figure 4.1 and Table 4.1 in the
PDF reference: special graphic state operators (q Q cm) are not
allowed in Text objects). Are we talking about "BT q Q ET" or "q
BT ET Q"? The first would be a pdfTeX bug.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jul 18 09:34:02 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul 18 09:33:32 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <20050717234108.GA7004@lucien.kn-bremen.de>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
	<20050717234108.GA7004@lucien.kn-bremen.de>
Message-ID: <42DB5B6A.2030003@wxs.nl>

Martin Schr?der wrote:

>On 2005-07-18 00:51:34 +0200, Hans Hagen wrote:
>  
>
>>Hartmut Henkel wrote:
>>    
>>
>>>It seems that Acrobat does not allow grouping q...Q inside BT...ET
>>>sections (xpdf tolerates it). There is currently no way to guarantee
>>>that a literal text does not end up in a BT...ET section without using
>>>the plain \pdfliteral {} mode (without "direct"). But then one has
>>>the matrix transform, which precludes grouping; well, here is a funny
>>>counter-example:
>>>      
>>>
>>q Q deals with the graphic state only (mostly characteristics of line 
>>drawing, not that this is an excuse for acrobat fo rnot handling them -)
>>    
>>
>
>I'm not sure I understand Hartmut correctly: "BT q Q ET" is not
>allowed, but "q BT ET Q" is (see Figure 4.1 and Table 4.1 in the
>PDF reference: special graphic state operators (q Q cm) are not
>allowed in Text objects). Are we talking about "BT q Q ET" or "q
>BT ET Q"? The first would be a pdfTeX bug.
>  
>
not so much a pdftex bug as well as that users can use literals in such ways that make q Q's end up in BT ET's 

Hans 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From hanthethanh at myrealbox.com  Mon Jul 18 14:44:10 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Mon Jul 18 15:09:59 2005
Subject: [NTG-pdftex] pdftex maintenance
In-Reply-To: <200507172204.j6HM43u0003143@jupiter.fsci.fuk.kindai.ac.jp>
References: <20050717140950.GH2664@monty.localnet>
	<200507172204.j6HM43u0003143@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <20050718124410.GB2971@monty.localnet>

ah indeed it was my fault not to update the server name.
Many thanks to Akira.

But I still feel that it is better to leave the maintenance
to Martin only. 

Regards,
Thanh


On Mon, Jul 18, 2005 at 07:04:02AM +0900, Akira Kakuto wrote:
> Hi Thanh,
> 
> > I no longer have access to the texlive perforce server (port
> > 1666 blocked), ...
> 
> Do you know p4 server machine has been changed?
> 
> old     sun.dante.de:1666
> new     texlive.dante.de:1666 ( alias of comedy.dante.de:1666 )
> 
> If port 1666 is blocked in your site, the above is useless, sorry.
> 
> -- 
> Akira Kakuto
> 
From taco at elvenkind.com  Mon Jul 18 15:08:29 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul 18 15:11:51 2005
Subject: [NTG-pdftex] character attribute
In-Reply-To: <42DAE24D.4050905@wxs.nl>
References: <20050717135729.GG2664@monty.localnet>
	<42DAA8B5.2020207@wxs.nl>	<Pine.LNX.4.61.0507180037550.5374@hahepc1.hahe>
	<42DAE24D.4050905@wxs.nl>
Message-ID: <42DBA9CD.6020109@elvenkind.com>


Hi guys,

I do not have enough time right now to write a long reply, but I
wanted to mention quickly that we should not confuse character
nodes and tokens|strings|csnames.

Character nodes signify stuff that will end up typeset, and the
actual encoding does not matter anymore, so it makes little sense
to use utf-8. (besides, you need to reserve 4bytes for utf-8
anyway if you want to stick with a one-character-per-node scheme).

Why not just extend the char_node? I would propose something
along these lines:

   @d char_node=25  {that's type(), guessing the number}
   @d char_node_size=4
   @d is_char_node(#) == (type(#)=char_node)
   @d character(#) == mem[#+1].rh {the glyph code in a |char_node|}
   @d font(#) == mem[#+1].lh {the font code in a |char_node|}
   @d language==subtype {the language for this |char_node|}
   @d unicode(#) == mem[#+2].int {a unicode code point }
   @d color(#) == mem[#+3].rh {mystery pointer}
   @d special(#) == mem[#+3].lh {another mystery pointer}

This is just a rough notion, not a definitive proposal!

Greetings, Taco
From hartmut_henkel at gmx.de  Tue Jul 19 00:34:23 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue Jul 19 00:34:28 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <42DAE0F6.1040105@wxs.nl>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
Message-ID: <Pine.LNX.4.61.0507190025070.4228@hahepc1.hahe>

On Mon, 18 Jul 2005, Hans Hagen wrote:

> Hartmut Henkel wrote:
> >
> > BT
> > /F1 9.9626 Tf 91.9253 759.9271 Td[(A)]TJ
> > ET
> > q
> > BT
> > /F1 9.9626 Tf 119.3226 759.9271 Td[(Hello)]TJ
> > ET
> > Q
> > BT
> > /F1 9.9626 Tf 99.3973 759.9271 Td[(B)]TJ 204.112 -654.7472 Td[(1)]TJ
> > ET
> >
> > That's what the new "et" option of the appended tiny experimental
> > patch does; it forces an ET if required, but without transform.

> maybe use 'text' instead of 'et'

why "text"? it should _not_ put anything into a text object, so it's
more a "notext". Would be "notext" better than "et"?

> sure; we really need full control over that part (we should also make
> sure that dvipdfmx supports a similar model)

this should be rather easy once it's settled and tested. The \special
stuff is there.

Regards, Hartmut
From hartmut_henkel at gmx.de  Tue Jul 19 00:38:54 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue Jul 19 00:38:58 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <20050717234108.GA7004@lucien.kn-bremen.de>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
	<20050717234108.GA7004@lucien.kn-bremen.de>
Message-ID: <Pine.LNX.4.61.0507190034570.4228@hahepc1.hahe>

On Mon, 18 Jul 2005, Martin Schr?der wrote:

> On 2005-07-18 00:51:34 +0200, Hans Hagen wrote:
> > Hartmut Henkel wrote:
> > >It seems that Acrobat does not allow grouping q...Q inside BT...ET
> > >sections (xpdf tolerates it). There is currently no way to guarantee
> > >that a literal text does not end up in a BT...ET section without using
> > >the plain \pdfliteral {} mode (without "direct"). But then one has
> > >the matrix transform, which precludes grouping; well, here is a funny
> > >counter-example:
> > q Q deals with the graphic state only (mostly characteristics of line
> > drawing, not that this is an excuse for acrobat fo rnot handling them -)
>
> I'm not sure I understand Hartmut correctly: "BT q Q ET" is not
> allowed,

this is what \pdfliteral et {} avoids

> but "q BT ET Q" is

this is the new stuff that can be done with \pdfliteral et {}

Regards, Hartmut
From hartmut_henkel at gmx.de  Tue Jul 19 01:13:45 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue Jul 19 01:13:50 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <42DAE0F6.1040105@wxs.nl>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
Message-ID: <Pine.LNX.4.61.0507190108300.4659@hahepc1.hahe>

On Mon, 18 Jul 2005, Hans Hagen wrote:

> > That's what the new "et" option of the appended tiny experimental patch
> > does; it forces an ET if required, but without transform.

> maybe use 'text' instead of 'et'

ah, after Martin's hint to Figure 4.1 in the PDf ref. it means that
\pdfliteral et {} puts stuff within the "page description level" so
maybe another name for it could be \pdfliteral page {}?

Regards, Hartmut
From pragma at wxs.nl  Tue Jul 19 10:08:46 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Tue Jul 19 10:08:19 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <Pine.LNX.4.61.0507190025070.4228@hahepc1.hahe>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
	<Pine.LNX.4.61.0507190025070.4228@hahepc1.hahe>
Message-ID: <42DCB50E.7050106@wxs.nl>

Hartmut Henkel wrote:

>>maybe use 'text' instead of 'et'
>>    
>>
>
>why "text"? it should _not_ put anything into a text object, so it's
>more a "notext". Would be "notext" better than "et"?
>  
>
probably, but it also takes more mem so maybe 'bet' from 'bt et' -)

Hans

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Jul 19 10:09:35 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Tue Jul 19 10:09:07 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <Pine.LNX.4.61.0507190108300.4659@hahepc1.hahe>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
	<Pine.LNX.4.61.0507190108300.4659@hahepc1.hahe>
Message-ID: <42DCB53F.5080404@wxs.nl>

Hartmut Henkel wrote:

>On Mon, 18 Jul 2005, Hans Hagen wrote:
>
>  
>
>>>That's what the new "et" option of the appended tiny experimental patch
>>>does; it forces an ET if required, but without transform.
>>>      
>>>
>
>  
>
>>maybe use 'text' instead of 'et'
>>    
>>
>
>ah, after Martin's hint to Figure 4.1 in the PDf ref. it means that
>\pdfliteral et {} puts stuff within the "page description level" so
>maybe another name for it could be \pdfliteral page {}?
>  
>
makes sense 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From hanthethanh at myrealbox.com  Tue Jul 19 10:29:50 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Tue Jul 19 11:17:41 2005
Subject: [NTG-pdftex] character attribute
In-Reply-To: <42DBA9CD.6020109@elvenkind.com>
References: <20050717135729.GG2664@monty.localnet> <42DAA8B5.2020207@wxs.nl>
	<Pine.LNX.4.61.0507180037550.5374@hahepc1.hahe>
	<42DAE24D.4050905@wxs.nl> <42DBA9CD.6020109@elvenkind.com>
Message-ID: <20050719082950.GA2570@monty.localnet>

Hi,

please forget what I said with utf8 -- it just came cross my
mind that it might be possible to support unicode using
'extended attributes' of a char node but I didn't give it
much consideration. My main intention is to support more
attributes for a char node than just font.

I proposed using the font field as a pointer to a set of
character attributes because I think it requires less change
-- the memory layout can stay unchanged, all tricks to deal
with character node can be left untouched. But I am not that
sure -- it may be better to redefined char node layout 
like Taco proposed.

Thanh

On Mon, Jul 18, 2005 at 03:08:29PM +0200, Taco Hoekwater wrote:
> 
> Hi guys,
> 
> I do not have enough time right now to write a long reply, but I
> wanted to mention quickly that we should not confuse character
> nodes and tokens|strings|csnames.
> 
> Character nodes signify stuff that will end up typeset, and the
> actual encoding does not matter anymore, so it makes little sense
> to use utf-8. (besides, you need to reserve 4bytes for utf-8
> anyway if you want to stick with a one-character-per-node scheme).
> 
> Why not just extend the char_node? I would propose something
> along these lines:
> 
>   @d char_node=25  {that's type(), guessing the number}
>   @d char_node_size=4
>   @d is_char_node(#) == (type(#)=char_node)
>   @d character(#) == mem[#+1].rh {the glyph code in a |char_node|}
>   @d font(#) == mem[#+1].lh {the font code in a |char_node|}
>   @d language==subtype {the language for this |char_node|}
>   @d unicode(#) == mem[#+2].int {a unicode code point }
>   @d color(#) == mem[#+3].rh {mystery pointer}
>   @d special(#) == mem[#+3].lh {another mystery pointer}
> 
> This is just a rough notion, not a definitive proposal!
> 
> Greetings, Taco
From martin at oneiros.de  Tue Jul 19 19:56:00 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jul 19 19:57:58 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050701130816.GA2673@m0A0232D2.vpn.uni-freiburg.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C5025D.6050905@wxs.nl>
	<20050701130816.GA2673@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <20050719175600.GC23403@lucien.kn-bremen.de>

On 2005-07-01 15:08:16 +0200, Heiko Oberdiek wrote:
> On Fri, Jul 01, 2005 at 10:44:13AM +0200, Hans Hagen wrote:
> > Heiko Oberdiek wrote:
> > 
> > >existing documents can break because of added new primitives.
> > 
> > a small chance; such a package does not know about the primitive; the only 
> > danger can be in:
> > 
> > - core latex uses a new primitive
> > - old package overloads overloads new primitive by macro
> > - core latex functionality fails
> 
> For example, package foo defines:
>   \newcommand{\match}...
> and fails with error message. Then we have frequent news
> groups postings:
>   "After pdfTeX update package foo is not working, ..."
> or
>   "Error message after pdfTeX update, ..."
> In the eyes of the readers, pdfTeX is guilty, not the
> best advertisment for pdfTeX.
> And in the worst(normal) case author of package foo doesn't
> have time for an update or cannot be found.
> 
> > but, for new primitives
> > 
> > >With prefixes and reserved namespaces, document and package
> > >writers have the chance to avoid name clashes with future
> > >versions of pdfTeX. Without is asking for unnecessary trouble.
> > 
> > partially true, what if users have \pdf or whatever as prefix for their own 
> > macros?
> 
> But users have the chance to know, that there are "reserved"
> prefixes and can avoid future name clashes, when new
> primitives are introduced.
> 
> > as said ... etex introduced primitives that clashed with context 
> > (and probably with other stuff around as well; \protected, \expanded, 
> > \interactionmode, those \if's etc are all candidates; and yet, we now 
> > default to etex as engine)
> 
> Perhaps we can ask the etex people, their experience and what
> they would do.
> 
> > so ... there is always the danger of a clash; the best we can do is to 
> > provide a list of new primitives in a separate file so that users can use 
> > that list to parse all their local stuff for clashes.
> 
> And they would have to do it again and again for each new version
> of pdfTeX that introduces new primitives.

This issue has come up again in internal discussions because of
the imminent release and it seems we have no consensus yet
(neither about the use of namespaces nor about the naming of the
namespace for non-pdf-extensions).

I suggest a compromise: For 1.30.0 all new primitives stay in the
\pdf namespace (without renaming recently introduced primitives
like \quitvomde), and we will implement real namespaces in 1.40.0
(Tacos proposal).

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From hartmut_henkel at gmx.de  Wed Jul 20 01:42:14 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Wed Jul 20 01:42:19 2005
Subject: [NTG-pdftex] Patch 391: Extending \pdfliteral
In-Reply-To: <42DCB53F.5080404@wxs.nl>
References: <Pine.LNX.4.61.0507172346410.4808@hahepc1.hahe>
	<42DAE0F6.1040105@wxs.nl>
	<Pine.LNX.4.61.0507190108300.4659@hahepc1.hahe>
	<42DCB53F.5080404@wxs.nl>
Message-ID: <Pine.LNX.4.61.0507200140540.4601@hahepc1.hahe>

On Tue, 19 Jul 2005, Hans Hagen wrote:

> > maybe another name for it could be \pdfliteral page {}?
>
> makes sense

ok, thanks, i have updated the patch.

Regards, Hartmut
From hanthethanh at myrealbox.com  Wed Jul 20 16:10:32 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Wed Jul 20 16:10:32 2005
Subject: [NTG-pdftex] merging pdftex sources into a single master file
Message-ID: <20050720141032.GD2674@monty.localnet>

Hi,

there were some disscusions on whether we shoule merge
pdftex sources into a single master file pdftex.web. There
are many pros and cons:

Pros: will make life of us pdftex developers easier, and
faster development of pdftex

Cons: someone has to do the job merging pdftex with other
extensions like etex, enctex or mltex.

>From my side I would be happier with a single master file
pdftex.web, but I would like to learn what impacts it can
has.

Thanh
From taco at elvenkind.com  Thu Jul 21 11:21:37 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jul 21 11:21:41 2005
Subject: [NTG-pdftex] merging pdftex sources into a single master file
In-Reply-To: <20050720141032.GD2674@monty.localnet>
References: <20050720141032.GD2674@monty.localnet>
Message-ID: <42DF6921.2060304@elvenkind.com>



The Thanh Han wrote:
> Cons: someone has to do the job merging pdftex with other
> extensions like etex, enctex or mltex.

Most of the change files I create provide non-pdf specific
functionality (it's more like some sort of e-pdftex).

I'm willing to maintain a single change file that has the
combined functionality of etex and the other non-pdf specific
extensions.

So, assuming there would be this:

    pdftex       epdftex        web2c (+enctex&mltex)

    pdftex.web                + pdftex.ch  == pdftex
    pdftex.web + etexpdf.ch   + pdfetex.ch == pdfetex

then I would be responsible for "etexpdf.ch".

That leaves the system change files. I guess Martin takes
care of that set of changes at the moment?

Greetings,
Taco

From pragma at wxs.nl  Thu Jul 21 14:14:33 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jul 21 14:14:04 2005
Subject: [NTG-pdftex] merging pdftex sources into a single master file
In-Reply-To: <42DF6921.2060304@elvenkind.com>
References: <20050720141032.GD2674@monty.localnet>
	<42DF6921.2060304@elvenkind.com>
Message-ID: <42DF91A9.9010509@wxs.nl>

Taco Hoekwater wrote:

>
>
> The Thanh Han wrote:
>
>> Cons: someone has to do the job merging pdftex with other
>> extensions like etex, enctex or mltex.
>
>
> Most of the change files I create provide non-pdf specific
> functionality (it's more like some sort of e-pdftex).
>
> I'm willing to maintain a single change file that has the
> combined functionality of etex and the other non-pdf specific
> extensions.
>
> So, assuming there would be this:
>
>    pdftex       epdftex        web2c (+enctex&mltex)
>
>    pdftex.web                + pdftex.ch  == pdftex
>    pdftex.web + etexpdf.ch   + pdfetex.ch == pdfetex
>
> then I would be responsible for "etexpdf.ch".
>
> That leaves the system change files. I guess Martin takes
> care of that set of changes at the moment?

sounds good to me

Hans

 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Thu Jul 21 13:21:44 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jul 21 14:25:52 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42DE8D3C.2080705@poczta.onet.pl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl> <42C46C5D.2040804@poczta.onet.pl>
	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>
	<42C5025D.6050905@wxs.nl>
	<20050701130816.GA2673@m0A0232D2.vpn.uni-freiburg.de>
	<20050719175600.GC23403@lucien.kn-bremen.de>
	<42DE8D3C.2080705@poczta.onet.pl>
Message-ID: <20050721112144.GA11534@lucien.kn-bremen.de>

On 2005-07-20 19:43:24 +0200, Pawel Jackowski wrote:
> Nothing better comes to my mind. To clarify, you mean in pdfTeX 1.40.0 
> (containing Taco's jewel), \pdf* prefix will be simply removed from 
> where its not suitable and future primitives will be prefixed with \pdf 
> or none, right?

Yes.

Best
    Martin

PS: Unless anybody complains loudly, I'll do rc4 with this
    tomorrow and a release early next week.
-- 
                    http://www.tm.oneiros.de
From jackos1 at poczta.onet.pl  Fri Jul 22 00:28:52 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul 22 00:29:04 2005
Subject: [NTG-pdftex] no etex while dump
Message-ID: <42E021A4.5070100@poczta.onet.pl>

On 1.30-rc2 I made the following z.tex file:

	\catcode`\{=1
	\catcode`\}=2
	\edef\z{\the\eTeXversion}
	\dump

Then I hit

	pdfetex -ini *z.tex

and got

This is pdfeTeXk, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.4) (INITEX) 
  22 JUL 2005 00:22
\write18 enabled.
  %&-line parsing enabled.
**z.tex
(./z.tex
! Undefined control sequence.
l.3 \edef\z{\the\eTeXversion
                             }
Clues? Sorry, for the moment I can't try on rc3.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From hartmut_henkel at gmx.de  Fri Jul 22 08:47:41 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jul 22 08:47:45 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E021A4.5070100@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>
Message-ID: <Pine.LNX.4.61.0507220844410.3988@hahepc1.hahe>

On Fri, 22 Jul 2005, Pawel Jackowski wrote:

> On 1.30-rc2 I made the following z.tex file:
>
> 	\catcode`\{=1
> 	\catcode`\}=2
> 	\edef\z{\the\eTeXversion}
> 	\dump

in fact also the other \lastnodetype, \eTeXrevision... don't work. It
seems to be related to the check

and(format_ident=" (INITEX)"

, as it works if you make a link to pdfeinitex and call

pdfeinitex *z

No time now to check more.

Regards, Hartmut
From hartmut_henkel at gmx.de  Fri Jul 22 08:58:23 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jul 22 08:58:27 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E021A4.5070100@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>
Message-ID: <Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>

On Fri, 22 Jul 2005, Pawel Jackowski wrote:

> On 1.30-rc2 I made the following z.tex file:
>
> 	\catcode`\{=1
> 	\catcode`\}=2
> 	\edef\z{\the\eTeXversion}
> 	\dump
>
> Then I hit
>
> 	pdfetex -ini *z.tex

It's the shell:

 pdfetex -ini \*z.tex

works :-)

Regards, Hartmut
From pragma at wxs.nl  Fri Jul 22 09:22:03 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jul 22 09:22:42 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
Message-ID: <42E09E9B.1090907@wxs.nl>

Hartmut Henkel wrote:

>On Fri, 22 Jul 2005, Pawel Jackowski wrote:
>
>  
>
>>On 1.30-rc2 I made the following z.tex file:
>>
>>	\catcode`\{=1
>>	\catcode`\}=2
>>	\edef\z{\the\eTeXversion}
>>	\dump
>>
>>Then I hit
>>
>>	pdfetex -ini *z.tex
>>    
>>
>
>It's the shell:
>
> pdfetex -ini \*z.tex
>
>works :-)
>  
>
ah .. clever .. typical an 'error' one can spend hours to uncover; looks like a design flaw to choose '*' for this. 

how about an --etex switch that acts as synonym for this * 

Hans 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From jackos1 at poczta.onet.pl  Fri Jul 22 10:33:43 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul 22 10:34:01 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
Message-ID: <42E0AF67.4000807@poczta.onet.pl>


> It's the shell:
> 
>  pdfetex -ini \*z.tex
> 
> works :-)

The same shell with the same command works fine WITHOUT espace on pdfTeX 
1.20a :(

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From jackos1 at poczta.onet.pl  Fri Jul 22 10:37:37 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul 22 10:38:35 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E09E9B.1090907@wxs.nl>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E09E9B.1090907@wxs.nl>
Message-ID: <42E0B051.90208@poczta.onet.pl>


> ah .. clever .. typical an 'error' one can spend hours to uncover; looks 
> like a design flaw to choose '*' for this.
> how about an --etex switch that acts as synonym for this *
> Hans

I got `unrecognized option etex'

-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Fri Jul 22 10:49:52 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jul 22 10:49:29 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E0B051.90208@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E09E9B.1090907@wxs.nl> <42E0B051.90208@poczta.onet.pl>
Message-ID: <42E0B330.3050302@wxs.nl>

Pawel Jackowski wrote:

>
>> ah .. clever .. typical an 'error' one can spend hours to uncover; 
>> looks like a design flaw to choose '*' for this.
>> how about an --etex switch that acts as synonym for this *
>> Hans
>
>
> I got `unrecognized option etex'

indeed; it's a feature request -) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Jul 22 10:53:49 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri Jul 22 10:53:53 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E0AF67.4000807@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E0AF67.4000807@poczta.onet.pl>
Message-ID: <42E0B41D.5060907@elvenkind.com>



Pawel Jackowski wrote:
> 
>> It's the shell:
>>
>>  pdfetex -ini \*z.tex
>>
>> works :-)
> 
> 
> The same shell with the same command works fine WITHOUT espace on pdfTeX 
> 1.20a :(

Are you sure? Under bash, the behaviour of the pathname expansion can be
somewhat controlled by a variable called nullglob:

   [taco@glenlivet context]$ shopt -p nullglob
   shopt -u nullglob
   [taco@glenlivet context]$ shopt -s nullglob
   [taco@glenlivet context]$ echo *pdftex

   [taco@glenlivet context]$ shopt -u nullglob
   [taco@glenlivet context]$ echo *pdftex
   *pdftex

So perhaps that (or something like that) is what is causing the
difference?

Taco
From noreply at sarovar.org  Fri Jul 22 11:09:30 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Jul 22 11:16:35 2005
Subject: [NTG-pdftex] [ pdftex-Patches-391 ] Extending \pdfliteral
Message-ID: <E1DvtX8-0001lS-00@sarovar.org>

Patches item #391, was opened at 2005-07-17 23:48
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=391&group_id=106

Category: Literals
Group: v1.30.0
>Status: Closed
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: Extending \pdfliteral

Initial Comment:
see ntg-pdftex list 17 Jul 2005 and README inside
pdfliteral.tgz

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-22 11:09

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=391&group_id=106
From noreply at sarovar.org  Fri Jul 22 11:10:23 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Jul 22 11:17:12 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-359 ] pdftex generates errors when it
	does not have to - eg \pdfinfo 
Message-ID: <E1DvtXz-0001vQ-00@sarovar.org>

Bugs item #359, was opened at 2005-05-30 19:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=359&group_id=106

Category: None
>Group: v1.21a
>Status: Closed
>Resolution: Fixed
Priority: 3
Submitted By: Taco Hoekwater (taco)
Assigned to: Nobody (None)
Summary: pdftex generates errors when it does not have to - eg \pdfinfo 

Initial Comment:

The following submitted on behalf of Jonathan Fine:


pdftex generates errors when it does not have to.

This fault prevents the build of Python docs on some
platforms.

The fix may be to remove the error-generating code?

For more details, see my posting to comp.text.tex.

Google link:
<http://groups-beta.google.com/group/comp.text.tex/msg/4b4842202ce88cda?hl=en>


Copy and paste
==============
There is, in my opinion, a problem with pdftex.

(This is not to say that the macros used could not be
improved.)

pdftex exits on \pdfinfo error.  TeX does not exit on
error.
==
$ pdftex
This is pdfTeX, Version 3.14159-1.10b (Web2C 7.4.5)
**\pdfoutput 0
{/usr/share/texmf/pdftex/config/pdftex.cfg}
*\pdfinfo
pdfTeX error (ext1): \pdfinfo used while \pdfoutput is
not set.
<*> \pdfinfo

No pages of output.
Transcript written on texput.log.
==


The present semantics of \pdfinfo are confused.
For example, I _can_ use \pdfinfo and generate dvi!

I just have to be a bit sneaky.
==
$ pdftex
This is pdfTeX, Version 3.14159-1.10b (Web2C 7.4.5)
**\pdfoutput 1
{/usr/share/texmf/pdftex/config/pdftex.cfg}
*\pdfinfo {}

*\pdfoutput 0

*\shipout\hbox{}
[1]
*\end
Output written on texput.dvi (1 page, 128 bytes).
==

Here, if pdf is not being generated, pdfinfo is ignored.

Suppose the semantics of \pdfinfo were something like:
  \pdfinfo{ ... }
  Stores information that is written to the PDF file,
  if pdftex generates a PDF file.  Otherwise ignored.

Then the error that prompted this thread would not have
occurred.

-- 

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-22 11:10

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.0

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-05-30 20:05

Message:
Logged In: YES 
user_id=1608

Relevant bit of code:

  procedure check_pdfoutput(s: str_number);
  begin
    if pdf_output <= 0 then begin
        print_nl("pdfTeX error (ext1): ");
        print(s);
        print(" used while \pdfoutput is not set");
        succumb;
    end;
  end

The fastest resolution, of course, is to change the test to 
"pdf_output < 0" so that the error is also generated in dvi
processing mode. 

But Jonathan's proposal is also valid, at least for
mode-independant commands like \pdfinfo. 

Or maybe generate a normal TeX error message?



----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=359&group_id=106
From jackos1 at poczta.onet.pl  Fri Jul 22 11:23:59 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul 22 11:24:08 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <Pine.LNX.4.58.0507221041440.20836@hahepc.vhs>
References: <Pine.LNX.4.58.0507221041440.20836@hahepc.vhs>
Message-ID: <42E0BB2F.7040108@poczta.onet.pl>

 > Hartmut
> it works also here without quote even in rc3! Same bash. I don't
> understand this. Needs checking...

I haven't noticed this behaviour on rc1. Give me some time, I will try 
to compile rc1 once again and check with the same conditions.

 > Taco:
> Are you sure? 

Yes I am sure that something differs depending on something :) I'm not 
sure if it is a bug. I'm sure that the same command (without quoted *) 
on the same shell works differently on pdfTeX 1.20a and pdfTeX 
1.30.0-rc2. Meybe it is a question of compiler? One was compiled under 
M$ Visual C, the second under gcc. Checking...

 > Hans:
> indeed; it's a feature request -)

I always assume I don't know something important :) Anyway, I strongly 
support this request.

-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From taco at elvenkind.com  Fri Jul 22 11:25:39 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri Jul 22 11:25:42 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E0BB2F.7040108@poczta.onet.pl>
References: <Pine.LNX.4.58.0507221041440.20836@hahepc.vhs>
	<42E0BB2F.7040108@poczta.onet.pl>
Message-ID: <42E0BB93.5020806@elvenkind.com>



Pawel Jackowski wrote:
> Yes I am sure that something differs depending on something :) I'm not 
> sure if it is a bug. I'm sure that the same command (without quoted *) 
> on the same shell works differently on pdfTeX 1.20a and pdfTeX 
> 1.30.0-rc2. Meybe it is a question of compiler? One was compiled under 
> M$ Visual C, the second under gcc. Checking...

issue solved ;-)

Taco
From jackos1 at poczta.onet.pl  Fri Jul 22 11:58:39 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul 22 11:59:09 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E0BB93.5020806@elvenkind.com>
References: <Pine.LNX.4.58.0507221041440.20836@hahepc.vhs>
	<42E0BB2F.7040108@poczta.onet.pl> <42E0BB93.5020806@elvenkind.com>
Message-ID: <42E0C34F.80004@poczta.onet.pl>

Taco Hoekwater napisa?(a):
> issue solved ;-)

Afterthought; quotation used with standard TL binaries (pdfTeX 1.20a on 
win) gives

! Undefined control sequence.
<*> \*
       test.tex


-etex command line option would be consistent.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From martin at oneiros.de  Fri Jul 22 11:36:30 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul 22 12:31:34 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E09E9B.1090907@wxs.nl>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E09E9B.1090907@wxs.nl>
Message-ID: <20050722093629.GA21498@lucien.kn-bremen.de>

On 2005-07-22 09:22:03 +0200, Hans Hagen wrote:
> ah .. clever .. typical an 'error' one can spend hours to uncover; looks 
> like a design flaw to choose '*' for this. 
> how about an --etex switch that acts as synonym for this * 

Seems useful. 

-> Olaf

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From kakuto at fsci.fuk.kindai.ac.jp  Fri Jul 22 14:50:15 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Fri Jul 22 14:50:30 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: Your message of "Fri, 22 Jul 2005 00:28:52 +0200"
References: <42E021A4.5070100@poczta.onet.pl>
Message-ID: <200507221250.j6MCoGjW029403@jupiter.fsci.fuk.kindai.ac.jp>

> This is pdfeTeXk, Version 3.141592-1.30.0-rc2-2.2 (Web2C 7.5.4) (INITEX) 
>   22 JUL 2005 00:22
> \write18 enabled.
>   %&-line parsing enabled.
> **z.tex
> (./z.tex
> ! Undefined control sequence.
> l.3 \edef\z{\the\eTeXversion
>                              }
> Clues? Sorry, for the moment I can't try on rc3.

It seemes that } is forbidden after \the in the
case of \edef:

pdfetex --ini '*z.tex'
This is pdfeTeX, Version 3.141592-1.30.0-rc3-2.2 (Web2C 7.5.5) (INITEX)
(./z.tex
! Undefined control sequence.
l.3 \edef\z{\the\eTeXversion
                            }
?
! You can't use `end-group character }' after \the.
l.3 \edef\z{\the\eTeXversion}

-- 
Akira Kakuto
From kakuto at fsci.fuk.kindai.ac.jp  Fri Jul 22 15:06:22 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Fri Jul 22 15:06:34 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: Your message of "Fri, 22 Jul 2005 21:50:15 +0900"
References: <200507221250.j6MCoGjW029403@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <200507221306.j6MD6Nxj029511@jupiter.fsci.fuk.kindai.ac.jp>

> It seemes that } is forbidden after \the in the
> case of \edef:
> 
> pdfetex --ini '*z.tex'
> This is pdfeTeX, Version 3.141592-1.30.0-rc3-2.2 (Web2C 7.5.5) (INITEX)
> (./z.tex
> ! Undefined control sequence.
> l.3 \edef\z{\the\eTeXversion
>                             }
> ?
> ! You can't use `end-group character }' after \the.
> l.3 \edef\z{\the\eTeXversion}

Sorry. I was wrong.
pdfeinitex \*z.tex worked.

-- 
Akira Kakuto
From kakuto at fsci.fuk.kindai.ac.jp  Fri Jul 22 15:23:10 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Fri Jul 22 15:23:20 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: Your message of "Fri, 22 Jul 2005 22:06:22 +0900"
References: <200507221306.j6MD6Nxj029511@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <200507221323.j6MDNAGq029607@jupiter.fsci.fuk.kindai.ac.jp>

> Sorry. I was wrong.
> pdfeinitex \*z.tex worked.

Correction:

pdfetex --ini '*z' works.
pdfetex --ini '*z.tex' fails.

I cannot understand the reason.

-- 
Akira Kakuto
From oberdiek at uni-freiburg.de  Fri Jul 22 16:16:12 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jul 22 16:16:16 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E0AF67.4000807@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E0AF67.4000807@poczta.onet.pl>
Message-ID: <20050722141612.GA3225@m0A023267.vpn.uni-freiburg.de>

On Fri, Jul 22, 2005 at 10:33:43AM +0200, Pawel Jackowski wrote:

> >It's the shell:
> >
> > pdfetex -ini \*z.tex
> >
> >works :-)
> 
> The same shell with the same command works fine WITHOUT espace on pdfTeX 
> 1.20a :(

Perhaps your file z.tex is not in the current directory, but in
the search path of TeX input files. Then the shell may not find
a file that ends in "z.tex". In this case the "*" remains and
the program "pdfetex" gets as argument the unexpanded "*z.tex".

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From kakuto at fsci.fuk.kindai.ac.jp  Fri Jul 22 16:27:10 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Fri Jul 22 16:27:24 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: Your message of "Fri, 22 Jul 2005 22:23:10 +0900"
References: <200507221323.j6MDNAGq029607@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <200507221427.j6MERBsf029927@jupiter.fsci.fuk.kindai.ac.jp>

> pdfetex --ini '*z' works.
> pdfetex --ini '*z.tex' fails.
> 
> I cannot understand the reason.

It was a funny shell effect. Many thanks to Hartmut.

-- 
Akira Kakuto
From jackos1 at poczta.onet.pl  Fri Jul 22 16:44:07 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jul 22 16:44:52 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <20050722141612.GA3225@m0A023267.vpn.uni-freiburg.de>
References: <42E021A4.5070100@poczta.onet.pl>	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>	<42E0AF67.4000807@poczta.onet.pl>
	<20050722141612.GA3225@m0A023267.vpn.uni-freiburg.de>
Message-ID: <42E10637.8060002@poczta.onet.pl>

Hi Heiko,

> Perhaps your file z.tex is not in the current directory, but in
> the search path of TeX input files. Then the shell may not find
> a file that ends in "z.tex". In this case the "*" remains and
> the program "pdfetex" gets as argument the unexpanded "*z.tex".

Nope, I tried on the current directory.

To summarize; under bash (linux or cygwin) environment and gcc as a 
builder, things are consistent, although seems to be mysterious. To be 
on safe side, a star should be quoted. Under windows the behaviour is 
environment/compiler dependent. Binaries made by M$ compiler behaves 
quite well; the star is not expanded anyhow by shell and is passed to 
TeX as is. Consequently, it CAN'T be quoted with backslash, since TeX 
reports `Undefined control sequence \*' then. Windows binaries made by 
gcc under cyg environment works like those under linux. That is the 
whole mystery. -etex commandline option will fix the inconsistency.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From oberdiek at uni-freiburg.de  Fri Jul 22 16:49:58 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jul 22 16:52:21 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E10637.8060002@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E0AF67.4000807@poczta.onet.pl>
	<20050722141612.GA3225@m0A023267.vpn.uni-freiburg.de>
	<42E10637.8060002@poczta.onet.pl>
Message-ID: <20050722144958.GA3492@m0A023267.vpn.uni-freiburg.de>

On Fri, Jul 22, 2005 at 04:44:07PM +0200, Pawel Jackowski wrote:

> To summarize; under bash (linux or cygwin) environment and gcc as a 
> builder, things are consistent, although seems to be mysterious. To be 
> on safe side, a star should be quoted. Under windows the behaviour is 
> environment/compiler dependent. Binaries made by M$ compiler behaves 
> quite well; the star is not expanded anyhow by shell and is passed to 
> TeX as is. Consequently, it CAN'T be quoted with backslash, since TeX 
> reports `Undefined control sequence \*' then. Windows binaries made by 
> gcc under cyg environment works like those under linux. That is the 
> whole mystery. -etex commandline option will fix the inconsistency.

What about quoting with double quotes?
  "*z.tex" instead of \*z.tex

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Fri Jul 22 17:17:01 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jul 22 17:16:39 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <42E10637.8060002@poczta.onet.pl>
References: <42E021A4.5070100@poczta.onet.pl>
	<Pine.LNX.4.61.0507220857470.4573@hahepc1.hahe>
	<42E0AF67.4000807@poczta.onet.pl>
	<20050722141612.GA3225@m0A023267.vpn.uni-freiburg.de>
	<42E10637.8060002@poczta.onet.pl>
Message-ID: <42E10DED.2020707@wxs.nl>

Pawel Jackowski wrote:

> Hi Heiko,
>
>> Perhaps your file z.tex is not in the current directory, but in
>> the search path of TeX input files. Then the shell may not find
>> a file that ends in "z.tex". In this case the "*" remains and
>> the program "pdfetex" gets as argument the unexpanded "*z.tex".
>
>
> Nope, I tried on the current directory.
>
> To summarize; under bash (linux or cygwin) environment and gcc as a 
> builder, things are consistent, although seems to be mysterious. To be 
> on safe side, a star should be quoted. Under windows the behaviour is 
> environment/compiler dependent. Binaries made by M$ compiler behaves 
> quite well; the star is not expanded anyhow by shell and is passed to 
> TeX as is. Consequently, it CAN'T be quoted with backslash, since TeX 
> reports `Undefined control sequence \*' then. Windows binaries made by 
> gcc under cyg environment works like those under linux. That is the 
> whole mystery. -etex commandline option will fix the inconsistency.

scripting languages suffer from this as well; by now i've learned never to trust command line globbing 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From kakuto at fsci.fuk.kindai.ac.jp  Fri Jul 22 18:01:55 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Fri Jul 22 18:02:08 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: Your message of "Fri, 22 Jul 2005 16:44:07 +0200"
References: <42E10637.8060002@poczta.onet.pl>
Message-ID: <200507221601.j6MG1u0d000308@jupiter.fsci.fuk.kindai.ac.jp>

> To summarize; under bash (linux or cygwin) environment and gcc as a 
> builder, things are consistent, although seems to be mysterious. To be 
> on safe side, a star should be quoted. Under windows the behaviour is 
> environment/compiler dependent. Binaries made by M$ compiler behaves 
> quite well; the star is not expanded anyhow by shell and is passed to 
> TeX as is. Consequently, it CAN'T be quoted with backslash, since TeX 
> reports `Undefined control sequence \*' then. Windows binaries made by 
> gcc under cyg environment works like those under linux. That is the 
> whole mystery. -etex commandline option will fix the inconsistency.

diff -Nur web2c-orig/etexdir/etex.ch web2c/etexdir/etex.ch
--- web2c-orig/etexdir/etex.ch	Wed Oct 13 06:29:47 2004
+++ web2c/etexdir/etex.ch	Sat Jul 23 00:36:24 2005
@@ -3051,10 +3051,11 @@
 is a run-time switch.
 
 @<Enable \eTeX, if requested@>=
-@!init if (buffer[loc]="*")and(format_ident=" (INITEX)") then
+@!init if ((buffer[loc]="*")or etex_extension_p)and(format_ident=" (INITEX)") then
   begin no_new_control_sequence:=false;
   @<Generate all \eTeX\ primitives@>@;
-  incr(loc); eTeX_mode:=1; {enter extended mode}
+  if (buffer[loc]="*") then incr(loc);
+  eTeX_mode:=1; {enter extended mode}
   @<Initialize variables for \eTeX\ extended mode@>@;
   end;
 tini@;@/
@@ -3094,6 +3095,7 @@
 
 @<Glob...@>=
 @!eTeX_mode: 0..1; {identifies compatibility and extended mode}
+@!etex_extension_p : boolean;
 
 @ @<Initialize table entries...@>=
 eTeX_mode:=0; {initially we are in compatibility mode}
diff -Nur web2c-orig/lib/texmfmp.c web2c/lib/texmfmp.c
--- web2c-orig/lib/texmfmp.c	Tue Jul 05 20:16:44 2005
+++ web2c/lib/texmfmp.c	Sat Jul 23 00:51:48 2005
@@ -778,6 +778,9 @@
       { "no-shell-escape",           0, &shellenabledp, -1 },
       { "debug-format",              0, &debugformatfile, 1 },
       { "src-specials",              2, 0, 0 },
+#if defined (eTeX) || defined (pdfeTeX) 
+      { "etex",     0, &etexextensionp, 1 },
+#endif
 #endif /* TeX */
 #if defined (TeX) || defined (MF) || defined (MP)
       { "file-line-error-style",     0, &filelineerrorstylep, 1 },
diff -Nur web2c-orig/texmfmp-help.h web2c/texmfmp-help.h
--- web2c-orig/texmfmp-help.h	Sun Aug 29 06:29:38 2004
+++ web2c/texmfmp-help.h	Sat Jul 23 00:41:45 2005
@@ -93,6 +93,7 @@
     "  If no arguments or options are specified, prompt for input.",
     "",
     "-enc                    enable encTeX extensions such as \\mubyte",
+    "-etex                   enable e-TeX extensions in INITEX",
     "[-no]-file-line-error   disable/enable file:line:error style messages",
     "-fmt=FMTNAME            use FMTNAME instead of program name or a %& line",
     "-halt-on-error          stop processing at the first error",
@@ -408,6 +409,7 @@
     "  If no arguments or options are specified, prompt for input.",
     "",
     "-enc                    enable encTeX extensions such as \\mubyte",
+    "-etex                   enable e-TeX extensions in INITEX",
     "[-no]-file-line-error   disable/enable file:line:error style messages",
     "-fmt=FMTNAME            use FMTNAME instead of program name or a %& line",
     "-halt-on-error          stop processing at the first error",
From martin at oneiros.de  Fri Jul 22 17:41:29 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul 22 18:21:13 2005
Subject: [NTG-pdftex] pdfoptionpdfminorversion -> pdfminorversion (was:
	changes in forthcomming release)
In-Reply-To: <20050518123731.GA5738@blau.artcom-gmbh.de>
References: <20050517082411.GF2558@monty.localnet>
	<Pine.LNX.4.61.0505181240180.3862@hahepc1.hahe>
	<20050518123731.GA5738@blau.artcom-gmbh.de>
Message-ID: <20050722154129.GB21498@lucien.kn-bremen.de>

On 2005-05-18 14:37:31 +0200, Martin Schr?der wrote:
> On 2005-05-18 12:53:12 +0200, Hartmut Henkel wrote:
> > On Tue, 17 May 2005, The Thanh Han wrote:
> > > There are still a few pending issues:
> > >
> > > 1) while we are renaming some promitives to be consistent,
> > > would it be better to change the following as well:
> 
> How about keeping the old names as well, but undocumenting them
> (and maybe giving a warning if they are used, i.e. deprecating
> them)? 
> 
> > > pdfoptionpdfminorversion -> pdfminorversion

I've removed the warning for \pdfoptionpdfminorversion and made
\pdfoptionpdfminorversion a simple alias of \pdfminorversion,
because they could not be used both in a document safely:
----------------
\pdfoptionpdfminorversion=4
\pdfminorversion=5
----------------

The code from \pdfoptionpdfminorversion always won (I noticed
this because the manual stayed at 1.5 although the source had a
\pdfminorversion=3). The reason is this code:
----------------
@p procedure check_pdfminorversion;
begin
    if not pdf_minor_version_written then begin
        if pdf_option_pdf_minor_version <> 0 then begin
            pdf_warning(0,"Primitive \pdfoptionpdfminorversion is obsolete; use \pdfminorversion instead.",true);
            pdf_minor_version := pdf_option_pdf_minor_version;
        end;
----------------

Fixing this properly seems too difficult (and not worth it) to
me. :-{

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Fri Jul 22 18:37:22 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul 22 18:50:33 2005
Subject: [NTG-pdftex] no etex while dump
In-Reply-To: <200507221601.j6MG1u0d000308@jupiter.fsci.fuk.kindai.ac.jp>
References: <42E10637.8060002@poczta.onet.pl>
	<200507221601.j6MG1u0d000308@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <20050722163722.GD21498@lucien.kn-bremen.de>

On 2005-07-23 01:01:55 +0900, Akira Kakuto wrote:
> > To summarize; under bash (linux or cygwin) environment and gcc as a 
> > builder, things are consistent, although seems to be mysterious. To be 
> > on safe side, a star should be quoted. Under windows the behaviour is 
> > environment/compiler dependent. Binaries made by M$ compiler behaves 
> > quite well; the star is not expanded anyhow by shell and is passed to 
> > TeX as is. Consequently, it CAN'T be quoted with backslash, since TeX 
> > reports `Undefined control sequence \*' then. Windows binaries made by 
> > gcc under cyg environment works like those under linux. That is the 
> > whole mystery. -etex commandline option will fix the inconsistency.
> 
> diff -Nur web2c-orig/etexdir/etex.ch web2c/etexdir/etex.ch
> --- web2c-orig/etexdir/etex.ch	Wed Oct 13 06:29:47 2004
> +++ web2c/etexdir/etex.ch	Sat Jul 23 00:36:24 2005
> @@ -3051,10 +3051,11 @@
>  is a run-time switch.
>  
>  @<Enable \eTeX, if requested@>=
> -@!init if (buffer[loc]="*")and(format_ident=" (INITEX)") then
> +@!init if ((buffer[loc]="*")or etex_extension_p)and(format_ident=" (INITEX)") then
>    begin no_new_control_sequence:=false;
>    @<Generate all \eTeX\ primitives@>@;
> -  incr(loc); eTeX_mode:=1; {enter extended mode}
> +  if (buffer[loc]="*") then incr(loc);
> +  eTeX_mode:=1; {enter extended mode}
>    @<Initialize variables for \eTeX\ extended mode@>@;
>    end;
>  tini@;@/
> @@ -3094,6 +3095,7 @@
>  
>  @<Glob...@>=
>  @!eTeX_mode: 0..1; {identifies compatibility and extended mode}
> +@!etex_extension_p : boolean;
>  
>  @ @<Initialize table entries...@>=
>  eTeX_mode:=0; {initially we are in compatibility mode}
> diff -Nur web2c-orig/lib/texmfmp.c web2c/lib/texmfmp.c
> --- web2c-orig/lib/texmfmp.c	Tue Jul 05 20:16:44 2005
> +++ web2c/lib/texmfmp.c	Sat Jul 23 00:51:48 2005
> @@ -778,6 +778,9 @@
>        { "no-shell-escape",           0, &shellenabledp, -1 },
>        { "debug-format",              0, &debugformatfile, 1 },
>        { "src-specials",              2, 0, 0 },
> +#if defined (eTeX) || defined (pdfeTeX) 
> +      { "etex",     0, &etexextensionp, 1 },
> +#endif
>  #endif /* TeX */
>  #if defined (TeX) || defined (MF) || defined (MP)
>        { "file-line-error-style",     0, &filelineerrorstylep, 1 },
> diff -Nur web2c-orig/texmfmp-help.h web2c/texmfmp-help.h
> --- web2c-orig/texmfmp-help.h	Sun Aug 29 06:29:38 2004
> +++ web2c/texmfmp-help.h	Sat Jul 23 00:41:45 2005
> @@ -93,6 +93,7 @@
>      "  If no arguments or options are specified, prompt for input.",
>      "",
>      "-enc                    enable encTeX extensions such as \\mubyte",
> +    "-etex                   enable e-TeX extensions in INITEX",
>      "[-no]-file-line-error   disable/enable file:line:error style messages",
>      "-fmt=FMTNAME            use FMTNAME instead of program name or a %& line",
>      "-halt-on-error          stop processing at the first error",
> @@ -408,6 +409,7 @@
>      "  If no arguments or options are specified, prompt for input.",
>      "",
>      "-enc                    enable encTeX extensions such as \\mubyte",
> +    "-etex                   enable e-TeX extensions in INITEX",
>      "[-no]-file-line-error   disable/enable file:line:error style messages",
>      "-fmt=FMTNAME            use FMTNAME instead of program name or a %& line",
>      "-halt-on-error          stop processing at the first error",

Looks good to me. Olaf?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Fri Jul 22 19:00:29 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jul 22 19:03:00 2005
Subject: [NTG-pdftex] 1.30.0-rc4
In-Reply-To: <20050712204427.GD11274@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050712204427.GD11274@lucien.kn-bremen.de>
Message-ID: <20050722170029.GF21498@lucien.kn-bremen.de>

http://sarovar.org/download.php/664/pdftex-1.30.0-rc4.zip

This is mostly the same as rc3, but
- \ptex -> \pdf
- patch 391
- bug 359
- zlib 1.2.3

I will not accept any more features (-etex would be the only
exception).

Best
    Martin 
-- 
                    http://www.tm.oneiros.de
From olaf at infovore.xs4all.nl  Fri Jul 22 22:57:10 2005
From: olaf at infovore.xs4all.nl (Olaf Weber)
Date: Fri Jul 22 22:57:18 2005
Subject: [NTG-pdftex] 1.30.0-rc4
In-Reply-To: <20050722170029.GF21498@lucien.kn-bremen.de> (
	=?iso-8859-1?q?Martin_Schr=F6der's_message_of?= "Fri,
	22 Jul 2005 19:00:29 +0200")
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050712204427.GD11274@lucien.kn-bremen.de>
	<20050722170029.GF21498@lucien.kn-bremen.de>
Message-ID: <87pstak195.fsf@infovore.xs4all.nl>

Martin Schr?der writes:

> http://sarovar.org/download.php/664/pdftex-1.30.0-rc4.zip
> This is mostly the same as rc3, but
> - \ptex -> \pdf
> - patch 391
> - bug 359
> - zlib 1.2.3

> I will not accept any more features (-etex would be the only
> exception).

Saturday I'm fully booked (family stuff), so the soonest I'll get to
work on this is Sunday.

Your -etex switch patch looks reasonable, though I might make some
changes (variable names &c) when I check in the code.

-- 
Olaf Weber

               (This space left blank for technical reasons.)

From kakuto at fsci.fuk.kindai.ac.jp  Sat Jul 23 12:51:20 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Sat Jul 23 12:53:07 2005
Subject: [NTG-pdftex] 1.30.0-rc4
In-Reply-To: Your message of "Fri, 22 Jul 2005 22:57:10 +0200"
References: <87pstak195.fsf@infovore.xs4all.nl>
Message-ID: <200507231051.j6NApL5d005204@jupiter.fsci.fuk.kindai.ac.jp>

> Your -etex switch patch looks reasonable, though I might make some
> changes (variable names &c) when I check in the code.

I forgot to consider aleph (eobase.ch and eoext.ch).
Please check in also those files.

Thanks,
-- 
Akira Kakuto
From pragma at wxs.nl  Sun Jul 24 23:52:18 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jul 24 23:51:44 2005
Subject: [NTG-pdftex] endstream
Message-ID: <42E40D92.9060409@wxs.nl>

Hi,

In former pdftex verions 'endstream' was on a line of its own, which is 
more handy when looking into a pdf file that the current 'end of line' 
method.

Is there a reason for this change?

Hans

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From hartmut_henkel at gmx.de  Mon Jul 25 01:08:25 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon Jul 25 01:08:30 2005
Subject: [NTG-pdftex] endstream
In-Reply-To: <42E40D92.9060409@wxs.nl>
References: <42E40D92.9060409@wxs.nl>
Message-ID: <Pine.LNX.4.61.0507250105150.23314@hahepc1.hahe>

On Sun, 24 Jul 2005, Hans Hagen wrote:

> In former pdftex verions 'endstream' was on a line of its own, which
> is more handy when looking into a pdf file that the current 'end of
> line' method.

AFAIK, when the patch was tried, sometimes spurious completely empty
lines appeared, so the patch was reverted. To be reconsidered...

Regards, Hartmut
From martin at oneiros.de  Mon Jul 25 02:04:16 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul 25 07:50:29 2005
Subject: [NTG-pdftex] endstream
In-Reply-To: <42E40D92.9060409@wxs.nl>
References: <42E40D92.9060409@wxs.nl>
Message-ID: <20050725000415.GA16155@lucien.kn-bremen.de>

On 2005-07-24 23:52:18 +0200, Hans Hagen wrote:
> In former pdftex verions 'endstream' was on a line of its own, which is 
> more handy when looking into a pdf file that the current 'end of line' 
> method.

The only places where endstream is written without explicit
newline before it are in pdftoepdf.cc and writejpg.c and haven't
changed since 1.11a ...

Actually the newline before endstream is recommended by the PDF
reference.

I'll look into it.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Mon Jul 25 03:09:16 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul 25 07:54:26 2005
Subject: [NTG-pdftex] endstream
In-Reply-To: <20050725000415.GA16155@lucien.kn-bremen.de>
References: <42E40D92.9060409@wxs.nl>
	<20050725000415.GA16155@lucien.kn-bremen.de>
Message-ID: <20050725010916.GC16155@lucien.kn-bremen.de>

On 2005-07-25 02:04:16 +0200, Martin Schr?der wrote:
> On 2005-07-24 23:52:18 +0200, Hans Hagen wrote:
> > In former pdftex verions 'endstream' was on a line of its own, which is 
> > more handy when looking into a pdf file that the current 'end of line' 
> > method.
> 
> The only places where endstream is written without explicit
> newline before it are in pdftoepdf.cc and writejpg.c and haven't
> changed since 1.11a ...

And these aren't responsible here.
----------------------------------------
procedure pdf_end_stream; {end a stream}
begin
    if pdf_compress_level > 0 then
        zip_write_state := zip_finish
    else
        pdf_stream_length := pdf_offset - pdf_save_offset;
    pdf_flush;
    write_stream_length(pdf_stream_length, pdf_stream_length_offset);
    pdf_print_nl;
    pdf_print_ln("endstream");
    pdf_end_obj;
end;

@ Basic printing procedures for PDF output are very similiar to \TeX\ basic
printing ones but the output is going to PDF buffer. Subroutines with
suffix |_ln| append a new-line character to the PDF output.

@d pdf_new_line_char == 10 {new-line character for UNIX platforms}

@d pdf_print_nl == {output a new-line character to PDF buffer}
if (pdf_ptr > 0) and (pdf_buf[pdf_ptr - 1] <> pdf_new_line_char) then
    pdf_out(pdf_new_line_char)
----------------------------------------
This would be fine, but pdf_flush sets pdf_ptr := 0, which makes
the call to pdf_print_nl a nop. :-( Which doesn't matter in
non-compressed state, as pdf_end_text puts a nl after an "ET".

Replaced with a direct call to pdf_out(pdf_new_line_char) if
pdf_compress_level > 0.

This is a mess -- just look at samplepdf.pdf:
\pdfobj stream {Hello} 
creates 
----------------------------------------
stream
Helloendstream
endobj
----------------------------------------
 
Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jul 25 10:42:33 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul 25 10:41:58 2005
Subject: [NTG-pdftex] endstream
In-Reply-To: <20050725000415.GA16155@lucien.kn-bremen.de>
References: <42E40D92.9060409@wxs.nl>
	<20050725000415.GA16155@lucien.kn-bremen.de>
Message-ID: <42E4A5F9.6010401@wxs.nl>

Martin Schr?der wrote:

>On 2005-07-24 23:52:18 +0200, Hans Hagen wrote:
>  
>
>>In former pdftex verions 'endstream' was on a line of its own, which is 
>>more handy when looking into a pdf file that the current 'end of line' 
>>method.
>>    
>>
>
>The only places where endstream is written without explicit
>newline before it are in pdftoepdf.cc and writejpg.c and haven't
>changed since 1.11a ...
>  
>
it was indeed an old file I diffed with (in the process of uncovering 
another bug [png inclusion vs colorspace access] that taco is now 
looking into )

>Actually the newline before endstream is recommended by the PDF
>reference.
>  
>
thanks, 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From noreply at sarovar.org  Mon Jul 25 10:52:57 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul 25 11:00:04 2005
Subject: [NTG-pdftex] [ pdftex-Patches-259 ] Expanded png inclusion support
Message-ID: <E1Dwyhl-0001EN-00@sarovar.org>

Patches item #259, was opened at 2005-01-11 16:44
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106

Category: Image inclusion
Group: None
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Hartmut Henkel (hhenkel)
Summary: Expanded png inclusion support

Initial Comment:
The attached zip file contains a change file for all
pdftex's (to be applied *after* hz.cg) and a completely
new writepng.c



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 16:57

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-14 12:03

Message:
Logged In: YES 
user_id=1608

changes as agreed at Pont-a-Mousson:
-\pdfoptionimageforcegray removed
-\pdfoptionimageapplygamma is now 0 or 1

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-03 17:00

Message:
Logged In: YES 
user_id=1608

Bugfixes in 16-bit color depth mode (needs an 8-bit alpha
channel) and corrected PNG transformation discovery for gray
conversion.

This is a final version for now, it should be added to a
pdftex beta to allow 'in the wild' testing.


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-01 13:38

Message:
Logged In: YES 
user_id=1608

This update fixes the \pdfoptionimageforcegray bugs
discovered by Hartmut.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 17:27

Message:
Logged In: YES 
user_id=1608

Sorry, I forgot the 16-bit color code in the previous version

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 16:38

Message:
Logged In: YES 
user_id=1608

This new version incorporates the code from Hartmut's speed 
patch.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106
From noreply at sarovar.org  Mon Jul 25 10:56:25 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul 25 11:03:22 2005
Subject: [NTG-pdftex] [ pdftex-Patches-259 ] Expanded png inclusion support
Message-ID: <E1Dwyl7-0001Y1-00@sarovar.org>

Patches item #259, was opened at 2005-01-11 16:44
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106

Category: Image inclusion
Group: None
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Hartmut Henkel (hhenkel)
Summary: Expanded png inclusion support

Initial Comment:
The attached zip file contains a change file for all
pdftex's (to be applied *after* hz.cg) and a completely
new writepng.c



----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2005-07-25 10:56

Message:
Logged In: YES 
user_id=1608

The attached writepng.c fixes a bug discovered by Hans:

In the new version, Colorspaces were always written direct
(img_colorspace_ref() was ignored). That broke the image color
processing that ConTeXt does.



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 16:57

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-14 12:03

Message:
Logged In: YES 
user_id=1608

changes as agreed at Pont-a-Mousson:
-\pdfoptionimageforcegray removed
-\pdfoptionimageapplygamma is now 0 or 1

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-03 17:00

Message:
Logged In: YES 
user_id=1608

Bugfixes in 16-bit color depth mode (needs an 8-bit alpha
channel) and corrected PNG transformation discovery for gray
conversion.

This is a final version for now, it should be added to a
pdftex beta to allow 'in the wild' testing.


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-01 13:38

Message:
Logged In: YES 
user_id=1608

This update fixes the \pdfoptionimageforcegray bugs
discovered by Hartmut.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 17:27

Message:
Logged In: YES 
user_id=1608

Sorry, I forgot the 16-bit color code in the previous version

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 16:38

Message:
Logged In: YES 
user_id=1608

This new version incorporates the code from Hartmut's speed 
patch.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106
From taco at elvenkind.com  Mon Jul 25 11:09:43 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jul 25 11:09:48 2005
Subject: [NTG-pdftex]  Expanded png inclusion support
In-Reply-To: <E1Dwyl7-0001Y1-00@sarovar.org>
References: <E1Dwyl7-0001Y1-00@sarovar.org>
Message-ID: <42E4AC57.7040100@elvenkind.com>



noreply@sarovar.org wrote:
> The attached writepng.c fixes a bug discovered by Hans:
> 
> In the new version, Colorspaces were always written direct
> (img_colorspace_ref() was ignored). That broke the image color
> processing that ConTeXt does.

The testfile Hans sent me now works ok, a simple matter of
re-instating the if (img_colorspace_ref()) test.

Warning: the combination of this kind of color postprocessing in
macros with transparency in the png image can produce unexpected
results (because the transparency values will remain uneffected).

Taco
From noreply at sarovar.org  Mon Jul 25 15:25:57 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul 25 15:32:50 2005
Subject: [NTG-pdftex] [ pdftex-Patches-259 ] Expanded png inclusion support
Message-ID: <E1Dx2xx-0007Cc-00@sarovar.org>

Patches item #259, was opened at 2005-01-11 16:44
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106

Category: Image inclusion
>Group: v1.30.0
>Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Taco Hoekwater (taco)
>Assigned to: Taco Hoekwater (taco)
Summary: Expanded png inclusion support

Initial Comment:
The attached zip file contains a change file for all
pdftex's (to be applied *after* hz.cg) and a completely
new writepng.c



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-25 10:56

Message:
Logged In: YES 
user_id=1608

The attached writepng.c fixes a bug discovered by Hans:

In the new version, Colorspaces were always written direct
(img_colorspace_ref() was ignored). That broke the image color
processing that ConTeXt does.



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 16:57

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-14 12:03

Message:
Logged In: YES 
user_id=1608

changes as agreed at Pont-a-Mousson:
-\pdfoptionimageforcegray removed
-\pdfoptionimageapplygamma is now 0 or 1

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-03 17:00

Message:
Logged In: YES 
user_id=1608

Bugfixes in 16-bit color depth mode (needs an 8-bit alpha
channel) and corrected PNG transformation discovery for gray
conversion.

This is a final version for now, it should be added to a
pdftex beta to allow 'in the wild' testing.


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-01 13:38

Message:
Logged In: YES 
user_id=1608

This update fixes the \pdfoptionimageforcegray bugs
discovered by Hartmut.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 17:27

Message:
Logged In: YES 
user_id=1608

Sorry, I forgot the 16-bit color code in the previous version

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 16:38

Message:
Logged In: YES 
user_id=1608

This new version incorporates the code from Hartmut's speed 
patch.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106
From noreply at sarovar.org  Mon Jul 25 16:03:34 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul 25 16:10:22 2005
Subject: [NTG-pdftex] [ pdftex-Patches-259 ] Expanded png inclusion support
Message-ID: <E1Dx3YM-0000S8-00@sarovar.org>

Patches item #259, was opened at 2005-01-11 16:44
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106

Category: Image inclusion
Group: v1.30.0
>Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Taco Hoekwater (taco)
Summary: Expanded png inclusion support

Initial Comment:
The attached zip file contains a change file for all
pdftex's (to be applied *after* hz.cg) and a completely
new writepng.c



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-25 10:56

Message:
Logged In: YES 
user_id=1608

The attached writepng.c fixes a bug discovered by Hans:

In the new version, Colorspaces were always written direct
(img_colorspace_ref() was ignored). That broke the image color
processing that ConTeXt does.



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 16:57

Message:
Logged In: YES 
user_id=421

This has been included in version 1.30.0

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-14 12:03

Message:
Logged In: YES 
user_id=1608

changes as agreed at Pont-a-Mousson:
-\pdfoptionimageforcegray removed
-\pdfoptionimageapplygamma is now 0 or 1

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-03 17:00

Message:
Logged In: YES 
user_id=1608

Bugfixes in 16-bit color depth mode (needs an 8-bit alpha
channel) and corrected PNG transformation discovery for gray
conversion.

This is a final version for now, it should be added to a
pdftex beta to allow 'in the wild' testing.


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-03-01 13:38

Message:
Logged In: YES 
user_id=1608

This update fixes the \pdfoptionimageforcegray bugs
discovered by Hartmut.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 17:27

Message:
Logged In: YES 
user_id=1608

Sorry, I forgot the 16-bit color code in the previous version

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-02-28 16:38

Message:
Logged In: YES 
user_id=1608

This new version incorporates the code from Hartmut's speed 
patch.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=259&group_id=106
From noreply at sarovar.org  Mon Jul 25 16:09:55 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jul 25 16:16:33 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-393 ] Ensure newline before endstream
Message-ID: <E1Dx3eV-0001Ik-00@sarovar.org>

Bugs item #393, was opened at 2005-07-25 16:09
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=393&group_id=106

Category: None
Group: v1.30.0
Status: Open
Resolution: None
Priority: 2
Submitted By: Martin Schr?der (oneiros)
Assigned to: Martin Schr?der (oneiros)
Summary: Ensure newline before endstream

Initial Comment:
As reported by Hans, there is not always a newline
before endstream, although the PDF reference recommends
it. 

Any change needs careful testing.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=393&group_id=106
From martin at oneiros.de  Mon Jul 25 16:24:04 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jul 25 16:24:56 2005
Subject: [NTG-pdftex] 1.30.0-rc5
In-Reply-To: <20050722170029.GF21498@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050712204427.GD11274@lucien.kn-bremen.de>
	<20050722170029.GF21498@lucien.kn-bremen.de>
Message-ID: <20050725142404.GC21840@lucien.kn-bremen.de>

http://sarovar.org/download.php/667/pdftex-1.30.0-rc5.zip

A last rc, which should be very final.

This is mostly the same as rc4, but
- I've integrated pdfmem.ch and pdfliteral.ch
- Tacos new png code
- small fix for newline before enstream (but see bug #393)
- samplepdf.tex adapted (\ptex -> \pdf)

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jul 25 17:32:53 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jul 25 17:33:23 2005
Subject: [NTG-pdftex] 1.30.0-rc5
In-Reply-To: <20050725142404.GC21840@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050712204427.GD11274@lucien.kn-bremen.de>
	<20050722170029.GF21498@lucien.kn-bremen.de>
	<20050725142404.GC21840@lucien.kn-bremen.de>
Message-ID: <42E50625.50509@wxs.nl>

Martin Schr?der wrote:

>http://sarovar.org/download.php/667/pdftex-1.30.0-rc5.zip
>
>A last rc, which should be very final.
>
>This is mostly the same as rc4, but
>- I've integrated pdfmem.ch and pdfliteral.ch
>- Tacos new png code
>- small fix for newline before enstream (but see bug #393)
>- samplepdf.tex adapted (\ptex -> \pdf)
>  
>
applause for the fast fixes ! 

some versions are more final than final -) 

Hans 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------

From kakuto at fsci.fuk.kindai.ac.jp  Tue Jul 26 16:02:33 2005
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Tue Jul 26 16:02:43 2005
Subject: [NTG-pdftex] 1.30.0-rc5
Message-ID: <200507261402.j6QE2YY8021726@jupiter.fsci.fuk.kindai.ac.jp>

>http://sarovar.org/download.php/667/pdftex-1.30.0-rc5.zip
>
>A last rc, which should be very final.

I think access violation occurs if one uses an primitive
which calls makecfilename() in utils.c.
If I use the following, it became ok.

char *makecfilename(strnumber s) {
    char *name = makecstring(s);
#ifdef WIN32
    /* unquote file name */
    if (*name == '"') {
        char *p = name;
        char *q = name;
        while (p && *p) {
            *q = (*p == '"' ? *(++p) : *p);
            p++, q++;
        }
        *q = '\0';
    }
    fprintf(stderr, " %s\n", name);
#endif
    return name;
}

-- 
Akira Kakuto
From martin at oneiros.de  Tue Jul 26 22:32:04 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jul 26 23:02:21 2005
Subject: [NTG-pdftex] makecfilename (was: 1.30.0-rc5)
In-Reply-To: <200507261402.j6QE2YY8021726@jupiter.fsci.fuk.kindai.ac.jp>
References: <200507261402.j6QE2YY8021726@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <20050726203204.GA3477@lucien.kn-bremen.de>

On 2005-07-26 23:02:33 +0900, Akira Kakuto wrote:
> I think access violation occurs if one uses an primitive
> which calls makecfilename() in utils.c.
> If I use the following, it became ok.
> 
> char *makecfilename(strnumber s) {
>     char *name = makecstring(s);
> #ifdef WIN32
>     /* unquote file name */
>     if (*name == '"') {
>         char *p = name;
>         char *q = name;
>         while (p && *p) {
>             *q = (*p == '"' ? *(++p) : *p);
>             p++, q++;
>         }
>         *q = '\0';
>     }
>     fprintf(stderr, " %s\n", name);
> #endif
>     return name;
> }

Thanks, that makes much more sense. The manual always compiled
o.k, although it uses e.g. the md5 functions. :-}

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From olaf at infovore.xs4all.nl  Wed Jul 27 10:49:42 2005
From: olaf at infovore.xs4all.nl (Olaf Weber)
Date: Wed Jul 27 10:50:14 2005
Subject: [NTG-pdftex] Re: 1.30.0-rc5
In-Reply-To: <20050725142404.GC21840@lucien.kn-bremen.de> (
	=?iso-8859-1?q?Martin_Schr=F6der's_message_of?= "Mon,
	25 Jul 2005 16:24:04 +0200")
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050712204427.GD11274@lucien.kn-bremen.de>
	<20050722170029.GF21498@lucien.kn-bremen.de>
	<20050725142404.GC21840@lucien.kn-bremen.de>
Message-ID: <87ll3sd461.fsf@infovore.xs4all.nl>

Martin Schr?der writes:

> http://sarovar.org/download.php/667/pdftex-1.30.0-rc5.zip
> A last rc, which should be very final.

> This is mostly the same as rc4, but
> - I've integrated pdfmem.ch and pdfliteral.ch
> - Tacos new png code
> - small fix for newline before enstream (but see bug #393)
> - samplepdf.tex adapted (\ptex -> \pdf)

It doesn't even build.

undefined reference to `escapedstrlen'
undefined reference to `getescapedstrchar'
undefined reference to `escapednamelen'
undefined reference to `getescapednamechar'
undefined reference to `escapestr'

> Best
>     Martin
> -- 
>                     http://www.tm.oneiros.de

-- 
Olaf Weber

               (This space left blank for technical reasons.)

From olaf at infovore.xs4all.nl  Wed Jul 27 11:00:52 2005
From: olaf at infovore.xs4all.nl (Olaf Weber)
Date: Wed Jul 27 11:01:18 2005
Subject: [NTG-pdftex] Re: 1.30.0-rc5
In-Reply-To: <87ll3sd461.fsf@infovore.xs4all.nl> (Olaf Weber's message of
	"Wed, 27 Jul 2005 10:49:42 +0200")
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<20050702202251.GH2247@lucien.kn-bremen.de>
	<20050712204427.GD11274@lucien.kn-bremen.de>
	<20050722170029.GF21498@lucien.kn-bremen.de>
	<20050725142404.GC21840@lucien.kn-bremen.de>
	<87ll3sd461.fsf@infovore.xs4all.nl>
Message-ID: <87hdegd3nf.fsf@infovore.xs4all.nl>

Olaf Weber writes:
> Martin Schr?der writes:
>> http://sarovar.org/download.php/667/pdftex-1.30.0-rc5.zip
>> A last rc, which should be very final.

>> This is mostly the same as rc4, but
>> - I've integrated pdfmem.ch and pdfliteral.ch
>> - Tacos new png code
>> - small fix for newline before enstream (but see bug #393)
>> - samplepdf.tex adapted (\ptex -> \pdf)

> It doesn't even build.

> undefined reference to `escapedstrlen'
> undefined reference to `getescapedstrchar'
> undefined reference to `escapednamelen'
> undefined reference to `getescapednamechar'
> undefined reference to `escapestr'

Urgh, scratch that, my error.

-- 
Olaf Weber

               (This space left blank for technical reasons.)

From taco at elvenkind.com  Thu Jul 28 10:31:03 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jul 28 10:31:06 2005
Subject: [NTG-pdftex] \tagcode primitive in pdfetex
Message-ID: <42E897C7.2030505@elvenkind.com>

Hi,

I discovered this morning that 'pdfetex' does not understand
the \tagcode primitive, but 'pdftex' does (rc5). It turns out
the primitive is in pdftexdir/pdftex2.ch, but that file is not
included while building pdfetex. Can this be fixed still?

Cheers,
Taco
From martin at oneiros.de  Thu Jul 28 12:51:30 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jul 28 15:30:40 2005
Subject: [NTG-pdftex] \tagcode primitive in pdfetex
In-Reply-To: <42E897C7.2030505@elvenkind.com>
References: <42E897C7.2030505@elvenkind.com>
Message-ID: <20050728105130.GA20390@lucien.kn-bremen.de>

On 2005-07-28 04:31:03 -0400, Taco Hoekwater wrote:
> I discovered this morning that 'pdfetex' does not understand
> the \tagcode primitive, but 'pdftex' does (rc5). It turns out
> the primitive is in pdftexdir/pdftex2.ch, but that file is not
> included while building pdfetex. Can this be fixed still?

Yes. Done.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From jackos1 at poczta.onet.pl  Wed Jul 20 19:43:24 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Tue Aug  2 09:43:43 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050719175600.GC23403@lucien.kn-bremen.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>	<42C419F7.8000302@wxs.nl>
	<42C46C5D.2040804@poczta.onet.pl>	<20050630233755.GA3893@irwin.vpn.uni-freiburg.de>	<42C5025D.6050905@wxs.nl>	<20050701130816.GA2673@m0A0232D2.vpn.uni-freiburg.de>
	<20050719175600.GC23403@lucien.kn-bremen.de>
Message-ID: <42DE8D3C.2080705@poczta.onet.pl>

 > Martin:
> This issue has come up again in internal discussions because of
> the imminent release and it seems we have no consensus yet
> (neither about the use of namespaces nor about the naming of the
> namespace for non-pdf-extensions).
> 
> I suggest a compromise: For 1.30.0 all new primitives stay in the
> \pdf namespace (without renaming recently introduced primitives
> like \quitvomde), and we will implement real namespaces in 1.40.0
> (Tacos proposal).

Nothing better comes to my mind. To clarify, you mean in pdfTeX 1.40.0 
(containing Taco's jewel), \pdf* prefix will be simply removed from 
where its not suitable and future primitives will be prefixed with \pdf 
or none, right?

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
