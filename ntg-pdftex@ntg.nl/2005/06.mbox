From pragma at wxs.nl  Wed Jun  1 10:12:01 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jun  1 10:11:25 2005
Subject: [NTG-pdftex] kerning 
Message-ID: <429D6DD1.2040005@wxs.nl>

Hi,

Given those future font capabilities of pdftex (thanh: what happened with your 
construct fonts on the fly feature?), i wonder if it is possible to add something

\kernfont\somefont <char code 1> <charcode 2> <dimen>

Take for instance:

   http:\\www.pdftex.org

here the \\ may come out pretty spaced, and space can be saved by something:

   \def\url#1{\begingroup\kernfont\font `\ `\ -.2em\relax#1\endgroup}

(i soppose that something like this woudl be possible with thanhs new runtime 
font feature anyway)


Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Wed Jun  1 10:35:27 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed Jun  1 10:35:31 2005
Subject: [NTG-pdftex] kerning
In-Reply-To: <429D6DD1.2040005@wxs.nl>
References: <429D6DD1.2040005@wxs.nl>
Message-ID: <429D734F.7040203@elvenkind.com>



Hans Hagen wrote:
> Hi,
> 
> Given those future font capabilities of pdftex (thanh: what happened 
> with your construct fonts on the fly feature?), i wonder if it is 
> possible to add something
> 
> \kernfont\somefont <char code 1> <charcode 2> <dimen>
> 
> Take for instance:
> 
>   http:\\www.pdftex.org

That's not an url ;-)

As it stands, kerning/ligaturing info is memorized by TeX as a
series of programs-per-font. Each of these contain only character
labels and pointers to kern amounts in another table. All of those
font-specific little programs are collated inside a single array
(indexed per-font by yet another array), and all of that indexing
makes it quite hard to manipulate the individual entries.

This stuff would be a lot easier if there was something like
a 'font object' in TeX, which there isn't (I'll start work on
that as soon as there is a semi-stable 1.30 candidate).

Greetings,

Taco

PS. I can create a series of slides that show internals of the
font reading process for the ntg meeting, if you are interested.
From pragma at wxs.nl  Wed Jun  1 11:28:21 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jun  1 11:27:58 2005
Subject: [NTG-pdftex] kerning
In-Reply-To: <429D734F.7040203@elvenkind.com>
References: <429D6DD1.2040005@wxs.nl> <429D734F.7040203@elvenkind.com>
Message-ID: <429D7FB5.90406@wxs.nl>

Taco Hoekwater wrote:

> PS. I can create a series of slides that show internals of the
> font reading process for the ntg meeting, if you are interested.

sounds like a good idea to me

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From vit.zyka at seznam.cz  Wed Jun  1 17:57:48 2005
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Wed Jun  1 17:56:33 2005
Subject: [NTG-pdftex] inclusion of PDF with hz-alg expandeded font
In-Reply-To: <20050601031448.GC2517@monty.localnet>
References: <vf56gx53.fsf@esemetz.metz.supelec.fr> <4295ECA6.90309@wxs.nl>
	<429613E4.2060602@seznam.cz> <429622E0.806@wxs.nl>
	<20050527082836.GA2516@monty.localnet> <42985D53.30409@seznam.cz>
	<20050529103342.GE3198@monty.localnet> <4299A935.7040508@seznam.cz>
	<20050530060842.GA2516@monty.localnet> <429C10D2.7080407@seznam.cz>
	<20050601031448.GC2517@monty.localnet>
Message-ID: <429DDAFC.30703@seznam.cz>

The Thanh Han wrote:
> remember when I fixed it. Anyway, can you please try it with
> the latest snapshot (djgpp is also available). If you need

Jupiii! Yes, ~1.30 really fixes the problem. That is very good news.
Thank you, Thanh, very much.

(Also good news for me is, that pdftex preserves form objects with 
geometrical transformations during PDF inclusion; If someday it 
preserves also annotations it would be really amazing!)

> help with getting the djgpp binary work, please feel free to

Thanks to Akira Kakuto who is maintaining the fresh food in the 
http://www.fsci.fuk.kindai.ac.jp/kakuto/win32-ptex/web2c75.html I do not 
need translating.

Vit
From jackos1 at poczta.onet.pl  Wed Jun  1 20:58:24 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Wed Jun  1 20:58:49 2005
Subject: [NTG-pdftex] manual update
Message-ID: <429E0550.1090309@poczta.onet.pl>

Hi there,

A couple of tiny corrections commited to pdfTeX manual.
I'm going to add samplepdf file with resources to CVS, somewhere near 
the manual sources. Objections?

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From martin at oneiros.de  Wed Jun  1 21:13:01 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jun  1 21:28:27 2005
Subject: [NTG-pdftex] manual update
In-Reply-To: <429E0550.1090309@poczta.onet.pl>
References: <429E0550.1090309@poczta.onet.pl>
Message-ID: <20050601191301.GA5257@lucien.kn-bremen.de>

On 2005-06-01 20:58:24 +0200, Pawel Jackowski wrote:
> A couple of tiny corrections commited to pdfTeX manual.
> I'm going to add samplepdf file with resources to CVS, somewhere near 
> the manual sources. Objections?

No, go ahead.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From vit.zyka at seznam.cz  Wed Jun  1 23:36:57 2005
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Wed Jun  1 23:36:00 2005
Subject: [NTG-pdftex] unwanted font replacement during inclussion
Message-ID: <429E2A79.1060200@seznam.cz>

Hi,

I noticed the next strange behaviour. Let us create very simple file 
test.tex:
------------------
\font\bf=cmbx12
Normal text. \bf Bold text.
\end
------------------
Now include this file by plain pdftex:
------------------
\pdfximage{test.pdf}
\pdfrefximage\pdflastximage
\end
------------------
Everything is correct. No let us try to insert the file by context:
------------------
\starttext
%\font\bf=cmbx12
%Normal text. \bf Bold text.
\pdfximage{test.pdf}
\pdfrefximage\pdflastximage
\stoptext
------------------
And that is!!! Text 'bold text' is typeset with totaly different font 
from cmbx12, so it is smashed by wrong metric! See the attached file.
If I uncomment two lines, so the font cmbx12 is not only present in the 
included file, the result is correct. Where is the problem? Something 
mixing cm and lm? I though that included file comes with all font resources.

Hmmmm, now I feel it is more pdftex-related then context-related question.

vit

(pdfetex v1.30)

-- 
V?t Z?ka --- http://typokvitek.com
     Automatic document typesetting
     Automaticka sazba dokumentu --
--


-------------- next part --------------
A non-text attachment was scrubbed...
Name: load-context.pdf
Type: application/pdf
Size: 28277 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20050601/4dcf4645/load-context-0001.pdf
From vit.zyka at seznam.cz  Wed Jun  1 23:35:24 2005
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Wed Jun  1 23:36:10 2005
Subject: [NTG-pdftex] unwanted font replacement during inclussion
Message-ID: <429E2A1C.5010907@seznam.cz>

Hi,

I noticed the next strange behaviour. Let us create very simple file 
test.tex:
------------------
\font\bf=cmbx12
Normal text. \bf Bold text.
\end
------------------
Now include this file by plain pdftex:
------------------
\pdfximage{test.pdf}
\pdfrefximage\pdflastximage
\end
------------------
Everything is correct. No let us try to insert the file by context:
------------------
\starttext
%\font\bf=cmbx12
%Normal text. \bf Bold text.
\pdfximage{test.pdf}
\pdfrefximage\pdflastximage
\stoptext
------------------
And that is!!! Text 'bold text' is typeset with totaly different font 
from cmbx12, so it is smashed by wrong metric! See the attached file.
If I uncomment two lines, so the font cmbx12 is not only present in the 
included file, the result is correct. Where is the problem? Something 
mixing cm and lm? I though that included file comes with all font resources.

Hmmmm, now I feel it is more pdftex-related then context-related question.

vit

(pdfetex v1.30)

-- 
V?t Z?ka --- http://typokvitek.com
     Automatic document typesetting
     Automaticka sazba dokumentu --
--


-------------- next part --------------
A non-text attachment was scrubbed...
Name: load-context.pdf
Type: application/pdf
Size: 28277 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20050601/105cdc0a/load-context-0001.pdf
From hartmut_henkel at gmx.de  Thu Jun  2 01:05:39 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu Jun  2 01:06:12 2005
Subject: [NTG-pdftex] unwanted font replacement during inclussion
In-Reply-To: <429E2A79.1060200@seznam.cz>
References: <429E2A79.1060200@seznam.cz>
Message-ID: <Pine.LNX.4.61.0506020044160.5672@hahepc1.hahe>

On Wed, 1 Jun 2005, Vit Zyka ">" wrote:

> I noticed the next strange behaviour. Let us create very simple file test.tex:
> ------------------
> \font\bf=cmbx12
> Normal text. \bf Bold text.
> \end
> ------------------
> Now include this file by plain pdftex:
> ------------------
> \pdfximage{test.pdf}
> \pdfrefximage\pdflastximage
> \end
> ------------------
> Everything is correct. No let us try to insert the file by context:
> ------------------
> \starttext
> %\font\bf=cmbx12
> %Normal text. \bf Bold text.
> \pdfximage{test.pdf}
> \pdfrefximage\pdflastximage
> \stoptext
> ------------------

< I noticed the result is smashed by plain pdftex.  And that is correct.
< And that is typeset with totaly different font is correct.  I
< uncomment two lines, so the attached file by plain pdftex.  I though
< that is the next strange behaviour: problem? I noticed the next
< strange behaviour; included file.  I uncomment two lines, so the
< included file, Now I though that is typeset with totaly different font
< is correct.  I though that is the file, by plain pdftex related then
< context: related then context related then context.  I noticed the
< result is the next strange behaviour.

> Hmmmm, now I feel it is more pdftex-related then context-related
> question.

i can't reproduce it here with your files, it looks ok, but the
mechanism is that the font comparison is made by the name in the 2nd
column of the map file, and only if this matches the fontname in the
embedded file, the font file given the end of the map line is taken. E.
g. one can force a probably similar problem by (devious)

\pdfmapline{cmbx12 CMBX12 <cmtt10.pfb}

Then the CMBX12 font coming with the embedded test.pdf would match
CMBX12 and this would be replaced by cmtt10.pfb. So it seems that
something must be wrong with the map file.

Regards, Hartmut

P.S. just found http://www.jwz.org/dadadodo/ (good for blindtext :-)
From taco at elvenkind.com  Thu Jun  2 10:08:01 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jun  2 10:08:05 2005
Subject: [NTG-pdftex] unwanted font replacement during inclussion
In-Reply-To: <Pine.LNX.4.61.0506020044160.5672@hahepc1.hahe>
References: <429E2A79.1060200@seznam.cz>
	<Pine.LNX.4.61.0506020044160.5672@hahepc1.hahe>
Message-ID: <429EBE61.9080108@elvenkind.com>



Hartmut Henkel wrote:
> Then the CMBX12 font coming with the embedded test.pdf would match
> CMBX12 and this would be replaced by cmtt10.pfb. So it seems that
> something must be wrong with the map file.

There is a (fairly serious) bug in two of the context-supplied Latin
Modern .map files:

   context-base.map:148:cmbx5     CMBX12    <cmrm.enc  <lmbx5.pfb
   original-public-lm.map:71:cmbx5     CMBX12    <cmrm.enc  <lmbx5.pfb

Of course, both lines should use CMBX5 instead of CMBX12. Fixing
that removes the problem.  It seems the bug was introduced in
ConTeXt 2005.05.25.

Greetings, Taco
From noreply at sarovar.org  Thu Jun  2 12:55:24 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun  2 13:01:09 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-362 ] pdfobj produces extra /Filter for
	object streams with own filter
Message-ID: <E1DdnMC-0003Gw-00@sarovar.org>

Bugs item #362, was opened at 2005-06-02 12:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=362&group_id=106

Category: None
Group: v1.21a
Status: Open
Resolution: None
Priority: 5
Submitted By: Jens Elstner (daguy)
Assigned to: Nobody (None)
Summary: pdfobj produces extra /Filter for object streams with own filter

Initial Comment:
When I use the following code with pdftex and 
activated compression

\pdfcompresslevel=9
\pdfobj stream%
attr{/Filter/ASCIIHexDecode/FunctionType 0/Encode[0 
255]/BitsPerSample 8/Domain[0 1]/Size[2]/Range[0 1 0 1 
0 1 0 1]/Decode[0 1 0 1 0 1 0 1]}%
{00000000FFFFFFFF}%  output tint function

The generated pdf file contains the object as shown 
below

3 0 obj <<
/Filter/ASCIIHexDecode/FunctionType 0/Encode[0 
255]/BitsPerSample 8/Domain[0 1]/Size[2]/Range[0 1 0 1 
0 1 0 1]/Decode[0 1 0 1 0 1 0 1]
/Length 17        
/Filter /FlateDecode
>>
stream
x?30?'7'c
endobj

The compression added an extra /Filter line and 
produces an error or does not work the way it was 
intended anymore.

Proposed fix for this would be to check the <attr-
spec> for /Filter and omit any compression if a user 
filter function is present already.

Yours sincerely,

Jens Elstner

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=362&group_id=106
From noreply at sarovar.org  Thu Jun  2 14:52:36 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun  2 14:58:58 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-362 ] pdfobj produces extra /Filter for
	object streams with own filter
Message-ID: <E1DdpBc-0007d4-00@sarovar.org>

Bugs item #362, was opened at 2005-06-02 12:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=362&group_id=106

Category: None
Group: v1.21a
Status: Open
Resolution: None
Priority: 5
Submitted By: Jens Elstner (daguy)
Assigned to: Nobody (None)
Summary: pdfobj produces extra /Filter for object streams with own filter

Initial Comment:
When I use the following code with pdftex and 
activated compression

\pdfcompresslevel=9
\pdfobj stream%
attr{/Filter/ASCIIHexDecode/FunctionType 0/Encode[0 
255]/BitsPerSample 8/Domain[0 1]/Size[2]/Range[0 1 0 1 
0 1 0 1]/Decode[0 1 0 1 0 1 0 1]}%
{00000000FFFFFFFF}%  output tint function

The generated pdf file contains the object as shown 
below

3 0 obj <<
/Filter/ASCIIHexDecode/FunctionType 0/Encode[0 
255]/BitsPerSample 8/Domain[0 1]/Size[2]/Range[0 1 0 1 
0 1 0 1]/Decode[0 1 0 1 0 1 0 1]
/Length 17        
/Filter /FlateDecode
>>
stream
x?30?'7'c
endobj

The compression added an extra /Filter line and 
produces an error or does not work the way it was 
intended anymore.

Proposed fix for this would be to check the <attr-
spec> for /Filter and omit any compression if a user 
filter function is present already.

Yours sincerely,

Jens Elstner

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-06-02 14:52

Message:
Logged In: YES 
user_id=1276

Hello,

not a fix, just a workaround:

\begingroup
  \pdfcompresslevel=0 % then pdfTeX does not
                      % add /Filter itself
  \immediate\pdfobj stream attr{/Filter/...}{...}\relax
\endgroup

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=362&group_id=106
From taco at elvenkind.com  Thu Jun  2 17:31:39 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jun  2 17:31:53 2005
Subject: [NTG-pdftex] kerning
In-Reply-To: <429D7FB5.90406@wxs.nl>
References: <429D6DD1.2040005@wxs.nl> <429D734F.7040203@elvenkind.com>
	<429D7FB5.90406@wxs.nl>
Message-ID: <429F265B.3070402@elvenkind.com>



Hans Hagen wrote:
> Taco Hoekwater wrote:
> 
>> PS. I can create a series of slides that show internals of the
>> font reading process for the ntg meeting, if you are interested.
> 
> 
> sounds like a good idea to me

For those of you who are interested in this sort of thing, I've posted
an 884-page PDF document that illustrates TeX's loading of a few font
metric files:

   nullfont (internal)
   cmr10
   cmsy10
   cmex10

De document, and sources, are available at:

   http://tex.aanhet.net/temp/fontreader.pdf
   http://tex.aanhet.net/temp/fontreader.zip

Beware, the PDF is pretty large (7.7Mb). MetaPost, Perl and Context
sources are quite small (12kb), but very much a hack.

Taco
From pragma at wxs.nl  Thu Jun  2 22:28:16 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun  2 22:28:47 2005
Subject: [NTG-pdftex] kerning
In-Reply-To: <429F265B.3070402@elvenkind.com>
References: <429D6DD1.2040005@wxs.nl> <429D734F.7040203@elvenkind.com>
	<429D7FB5.90406@wxs.nl> <429F265B.3070402@elvenkind.com>
Message-ID: <429F6BE0.40305@wxs.nl>

Taco Hoekwater wrote:

> De document, and sources, are available at:
> 
>   http://tex.aanhet.net/temp/fontreader.pdf
>   http://tex.aanhet.net/temp/fontreader.zip
> 
> Beware, the PDF is pretty large (7.7Mb). MetaPost, Perl and Context
> sources are quite small (12kb), but very much a hack.

brilliant, you made my day

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From hanthethanh at myrealbox.com  Thu Jun  2 06:56:39 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Fri Jun  3 06:25:52 2005
Subject: [NTG-pdftex] kerning
In-Reply-To: <429D6DD1.2040005@wxs.nl>
References: <429D6DD1.2040005@wxs.nl>
Message-ID: <20050602045639.GE2736@monty.localnet>

I want to keep pdftex unchanged for a while so Martin can
make the 1.30 release. The next step might be the subfont
scheme for better cjk support. Support for user-defined
fonts is more complicated, I don't know when I will do that.

Thanh


On Wed, Jun 01, 2005 at 10:12:01AM +0200, Hans Hagen wrote:
> Hi,
> 
> Given those future font capabilities of pdftex (thanh: what happened with 
> your construct fonts on the fly feature?), i wonder if it is possible to 
> add something
> 
> \kernfont\somefont <char code 1> <charcode 2> <dimen>
> 
> Take for instance:
> 
>   http:\\www.pdftex.org
> 
> here the \\ may come out pretty spaced, and space can be saved by something:
> 
>   \def\url#1{\begingroup\kernfont\font `\ `\ -.2em\relax#1\endgroup}
> 
> (i soppose that something like this woudl be possible with thanhs new 
> runtime font feature anyway)
> 
> 
> Hans
> 
> -----------------------------------------------------------------
>                                           Hans Hagen | PRAGMA ADE
>               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
>      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
>                                              | www.pragma-pod.nl
> -----------------------------------------------------------------
> 
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex@ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex
> 
From hanthethanh at myrealbox.com  Thu Jun  2 06:39:16 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Fri Jun  3 06:26:05 2005
Subject: [NTG-pdftex] inclusion of PDF with hz-alg expandeded font
In-Reply-To: <429DDAFC.30703@seznam.cz>
References: <429613E4.2060602@seznam.cz> <429622E0.806@wxs.nl>
	<20050527082836.GA2516@monty.localnet> <42985D53.30409@seznam.cz>
	<20050529103342.GE3198@monty.localnet> <4299A935.7040508@seznam.cz>
	<20050530060842.GA2516@monty.localnet> <429C10D2.7080407@seznam.cz>
	<20050601031448.GC2517@monty.localnet> <429DDAFC.30703@seznam.cz>
Message-ID: <20050602043916.GC2736@monty.localnet>

On Wed, Jun 01, 2005 at 05:57:48PM +0200, Vit Zyka wrote:
> The Thanh Han wrote:
> >remember when I fixed it. Anyway, can you please try it with
> >the latest snapshot (djgpp is also available). If you need
> 
> Jupiii! Yes, ~1.30 really fixes the problem. That is very good news.
> Thank you, Thanh, very much.
> 
> (Also good news for me is, that pdftex preserves form objects with 
> geometrical transformations during PDF inclusion; If someday it 
> preserves also annotations it would be really amazing!)

ah, already in the todo list, but I don't know when I start
working on it :)

> >help with getting the djgpp binary work, please feel free to
> 
> Thanks to Akira Kakuto who is maintaining the fresh food in the 
> http://www.fsci.fuk.kindai.ac.jp/kakuto/win32-ptex/web2c75.html I do not 
> need translating.

great. Many thanks to Akira.

Thanh
From hanthethanh at myrealbox.com  Thu Jun  2 06:52:55 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Fri Jun  3 06:26:12 2005
Subject: [NTG-pdftex] unwanted font replacement during inclussion
In-Reply-To: <429E2A79.1060200@seznam.cz>
References: <429E2A79.1060200@seznam.cz>
Message-ID: <20050602045255.GD2736@monty.localnet>

I cannot reproduce the problem here. Can you run a few unix
commands on your system? If so I will send you a script to
pack all files needed in a single run so I can test it.

Thanh

On Wed, Jun 01, 2005 at 11:36:57PM +0200, Vit Zyka wrote:
> Hi,
> 
> I noticed the next strange behaviour. Let us create very simple file 
> test.tex:
> ------------------
> \font\bf=cmbx12
> Normal text. \bf Bold text.
> \end
> ------------------
> Now include this file by plain pdftex:
> ------------------
> \pdfximage{test.pdf}
> \pdfrefximage\pdflastximage
> \end
> ------------------
> Everything is correct. No let us try to insert the file by context:
> ------------------
> \starttext
> %\font\bf=cmbx12
> %Normal text. \bf Bold text.
> \pdfximage{test.pdf}
> \pdfrefximage\pdflastximage
> \stoptext
> ------------------
> And that is!!! Text 'bold text' is typeset with totaly different font 
> from cmbx12, so it is smashed by wrong metric! See the attached file.
> If I uncomment two lines, so the font cmbx12 is not only present in the 
> included file, the result is correct. Where is the problem? Something 
> mixing cm and lm? I though that included file comes with all font resources.
> 
> Hmmmm, now I feel it is more pdftex-related then context-related question.
> 
> vit
> 
> (pdfetex v1.30)
> 
> -- 
> V?t Z?ka --- http://typokvitek.com
>     Automatic document typesetting
>     Automaticka sazba dokumentu --
> --
> 
> 


> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex@ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex

From vit.zyka at seznam.cz  Fri Jun  3 10:14:37 2005
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Fri Jun  3 10:13:24 2005
Subject: [NTG-pdftex] bug in XObject
Message-ID: <42A0116D.1000808@seznam.cz>

Hallo pdftexdevelopers,

there is a bug in \pdfxform. See the next example:
-----------------------
\pdfcompresslevel=0
\footline={\hfill}%
\setbox0\vbox{\hsize8.75cm\noindent Ahoj}
\pdfxform attr{/Matrix [1.2 0.25 0.3 1 0 0]} 0
\pdfrefxform\pdflastxform
\end
-------------------------
The result XObject looks like:
------------------------
1 0 obj <<
/Type /XObject
/Subtype /Form
/Matrix [1.2 0.25 0.3 1 0 0]
/BBox [0 0 248.031 8.856]
/FormType 1
/Matrix [1 0 0 1 0 0]
/Resources 6 0 R
/Length 69
 >>
stream
1 0 0 1 0 -833.034 cm
BT
/F1 9.963 Tf 0 834.971 Td[(Aho)-55(j)]TJ
ET
endstream
endobj
------------------------
See the double /Matrix entry. That results in ignoring transformation by 
Acrobat (R) v.6 and 7. (v.4 and v.5 is OK). I believe that it is 
(exceptionally) bug in pdftex not in Acrobat ;)

vit

From pragma at wxs.nl  Fri Jun  3 10:35:16 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jun  3 11:10:10 2005
Subject: [NTG-pdftex] bug in XObject
In-Reply-To: <42A0116D.1000808@seznam.cz>
References: <42A0116D.1000808@seznam.cz>
Message-ID: <42A01644.4080601@wxs.nl>

Vit Zyka wrote:
> Hallo pdftexdevelopers,
> 
> there is a bug in \pdfxform. See the next example:
> -----------------------
> \pdfcompresslevel=0
> \footline={\hfill}%
> \setbox0\vbox{\hsize8.75cm\noindent Ahoj}
> \pdfxform attr{/Matrix [1.2 0.25 0.3 1 0 0]} 0
> \pdfrefxform\pdflastxform
> \end
> -------------------------
> The result XObject looks like:
> ------------------------
> 1 0 obj <<
> /Type /XObject
> /Subtype /Form
> /Matrix [1.2 0.25 0.3 1 0 0]
> /BBox [0 0 248.031 8.856]
> /FormType 1
> /Matrix [1 0 0 1 0 0]
> /Resources 6 0 R
> /Length 69
>  >>
> stream
> 1 0 0 1 0 -833.034 cm
> BT
> /F1 9.963 Tf 0 834.971 Td[(Aho)-55(j)]TJ
> ET
> endstream
> endobj
> ------------------------
> See the double /Matrix entry. That results in ignoring transformation by 
> Acrobat (R) v.6 and 7. (v.4 and v.5 is OK). I believe that it is 
> (exceptionally) bug in pdftex not in Acrobat ;)

pdftex is (and will) not parsing the content of attr, so the duplicate entry si 
a feature; conforming the specs acrobat should look at the first entry and if 
they broke that ...

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jackos1 at poczta.onet.pl  Fri Jun  3 11:58:23 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jun  3 11:58:36 2005
Subject: [NTG-pdftex] bug in XObject
In-Reply-To: <42A01644.4080601@wxs.nl>
References: <42A0116D.1000808@seznam.cz> <42A01644.4080601@wxs.nl>
Message-ID: <42A029BF.90000@poczta.onet.pl>

Hi there,

>> there is a bug in \pdfxform. See the next example[...]

> pdftex is (and will) not parsing the content of attr, so the duplicate 
> entry si a feature; conforming the specs acrobat should look at the 
> first entry and if they broke that ...
> 
> Hans

In general, the precedence of doubled entries seems to be interpreter 
dependent, not only for XObjects. I've added such a comment to pdfTeX 
man, but it seems it should be bolded.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From oberdiek at uni-freiburg.de  Fri Jun  3 12:28:24 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jun  3 12:29:14 2005
Subject: [NTG-pdftex] bug in XObject
In-Reply-To: <42A01644.4080601@wxs.nl>
References: <42A0116D.1000808@seznam.cz> <42A01644.4080601@wxs.nl>
Message-ID: <20050603102824.GA9569@irwin.vpn.uni-freiburg.de>

On Fri, Jun 03, 2005 at 10:35:16AM +0200, Hans Hagen wrote:

> Vit Zyka wrote:

> >\pdfxform attr{/Matrix [1.2 0.25 0.3 1 0 0]} 0

> >/Matrix [1.2 0.25 0.3 1 0 0]
> >/Matrix [1 0 0 1 0 0]

> >See the double /Matrix entry. That results in ignoring transformation by 
> >Acrobat (R) v.6 and 7. (v.4 and v.5 is OK). I believe that it is 
> >(exceptionally) bug in pdftex not in Acrobat ;)
> 
> pdftex is (and will) not parsing the content of attr, so the duplicate 

Looking for the string "/Matrix" without full parsing could be done.

> entry si a feature; conforming the specs acrobat should look at the first 
> entry and if they broke that ...

Have I missed something? When did they change this?

PDF spec. 1.6 says in 3.2.6 "Dictionary Objects":

| Note: No two entries in the same dictionary should have the same key. If a
| key does appear more than once, its value is undefined.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Fri Jun  3 13:19:44 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jun  3 14:10:12 2005
Subject: [NTG-pdftex] bug in XObject
In-Reply-To: <20050603102824.GA9569@irwin.vpn.uni-freiburg.de>
References: <42A0116D.1000808@seznam.cz> <42A01644.4080601@wxs.nl>
	<20050603102824.GA9569@irwin.vpn.uni-freiburg.de>
Message-ID: <42A03CD0.40305@wxs.nl>

Heiko Oberdiek wrote:

> Have I missed something? When did they change this?
> 
> PDF spec. 1.6 says in 3.2.6 "Dictionary Objects":
> 
> | Note: No two entries in the same dictionary should have the same key. If a
> | key does appear more than once, its value is undefined.

in previous versions the first one was taken; that way one could overload the 
info entries; even if it was 'behaviour' and not 'specification' i more and more 
tend to think that adobe does not care much about downward compatibility  at all

'the first value is taken' would have been ok

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Fri Jun  3 14:22:38 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jun  3 14:41:51 2005
Subject: [NTG-pdftex] bug in XObject
In-Reply-To: <42A01644.4080601@wxs.nl>
References: <42A0116D.1000808@seznam.cz> <42A01644.4080601@wxs.nl>
Message-ID: <20050603122238.GA26562@lucien.kn-bremen.de>

On 2005-06-03 10:35:16 +0200, Hans Hagen wrote:
> pdftex is (and will) not parsing the content of attr, so the duplicate 
> entry si a feature; conforming the specs acrobat should look at the first 

The behaviour for duplicate dictionary entries is undefined; you
may get the first or the last.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From vit.zyka at seznam.cz  Wed Jun  1 09:04:54 2005
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Sat Jun  4 12:10:56 2005
Subject: [NTG-pdftex] inclusion of PDF with hz-alg expandeded font
Message-ID: <429D5E16.9070804@seznam.cz>

The Thanh Han wrote:
> ah, sorry, I misunderstood the problem. It seems to be a bug
> of pdftex with pdf inclusion (handling fonts in embedded
> pdf's). I am not sure when this was fixed, but when I run
> your test file, the output seems ok (see attachment). So I
> suggest to upgrade your pdftex binaries (sorry that I don't
> know any better
> solution).

Strange, I read in your PDF: PDF Producer: pdfetex 1.21b
That is (hopefully) my version of pdfetex. So let us return to the
minimal example. I send you .tex, .log, and .pdf files for comparision.

In addition I notice another strange behaviour with inclusion. Type 1
font cmb12 (embeded subset) was after inclusion replaced by Times New
Roman Bold(?). The rest cm* font are OK. It needs more investigation
from me, so, please, can you focus on the hz problem?

Thank you very much
Vit
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdfhz.zip
Type: application/zip
Size: 63464 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20050601/3c42aa89/pdfhz-0001.zip
From pragma at wxs.nl  Sun Jun  5 20:14:56 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jun  5 20:14:44 2005
Subject: [NTG-pdftex] [Fwd: Re: [NTG-context] Installing Truetype fonts in
	context.]
Message-ID: <42A34120.6000103@wxs.nl>

Hi,

ttf2afm ... who maintains that? it would be handy if this program provides a 
-version option

currently it's hard to see what one has on the machine

Hans


-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------
-------------- next part --------------
An embedded message was scrubbed...
From: "John R. Culleton" <john@wexfordpress.com>
Subject: Re: [NTG-context] Installing Truetype fonts in context.
Date: Sun, 05 Jun 2005 11:46:32 +0000
Size: 4784
Url: http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20050605/b26b1727/NTG-contextInstallingTruetypefontsincontext.mht
From hartmut_henkel at gmx.de  Sun Jun  5 21:01:19 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sun Jun  5 21:01:30 2005
Subject: [NTG-pdftex] [Fwd: Re: [NTG-context] Installing Truetype fonts
	in context.]
In-Reply-To: <42A34120.6000103@wxs.nl>
References: <42A34120.6000103@wxs.nl>
Message-ID: <Pine.LNX.4.61.0506052059360.14633@hahepc1.hahe>

On Sun, 5 Jun 2005, Hans Hagen wrote:

> ttf2afm ... who maintains that? it would be handy if this program
> provides a -version option

since a few months you can try:

$ ttf2afm -v
ttf2afm version 1.0
Copyright (C) 1997-2005 Han The Thanh.
There is NO warranty.  Redistribution of this software is
covered by the terms of both the pdfTeX copyright and
the GNU General Public License.
For more information about these matters, see the files
named COPYING and the pdfTeX source.
Primary author of ttf2afm: Han The Thanh.

Regards, Hartmut
From martin at oneiros.de  Tue Jun  7 21:58:14 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jun  7 23:02:32 2005
Subject: [NTG-pdftex] rc1
In-Reply-To: <20050531084424.GG2519@monty.localnet>
References: <20050531084424.GG2519@monty.localnet>
Message-ID: <20050607195814.GB4988@lucien.kn-bremen.de>

On 2005-05-31 15:44:24 +0700, The Thanh Han wrote:
> I don't plan to upload further snapshots, so can you please
> make a pretest release or some rc1?

I'm working on it.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Tue Jun  7 23:02:01 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jun  7 23:02:34 2005
Subject: [NTG-pdftex] Version numbering
Message-ID: <20050607210201.GC4988@lucien.kn-bremen.de>

One point discussed at EuroTeX2005 was that the current
versioning scheme is too confusing (when do we increase which
part) and also that a real _number_ is be preferred.

In the future I want to switch to a scheme much like
OpenBSD/OpenSSH:
- version numbers are like 1.30.0
                           A BB C
- C is only > 0 for bug fixing releases
- A.BB is increased with every new release by 0.1
- with 2.00 we switch to A.B.C, i.e. 2.0.0 (we can't do this now
  as it would confuse some people because 1.3.0 is "smaller" than
  1.21a)

Comments?

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From oberdiek at uni-freiburg.de  Wed Jun  8 09:05:41 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun  8 09:05:40 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050607210201.GC4988@lucien.kn-bremen.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
Message-ID: <20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>

On Tue, Jun 07, 2005 at 11:02:01PM +0200, Martin Schr?der wrote:

> One point discussed at EuroTeX2005 was that the current
> versioning scheme is too confusing (when do we increase which
> part) and also that a real _number_ is be preferred.
> 
> In the future I want to switch to a scheme much like
> OpenBSD/OpenSSH:
> - version numbers are like 1.30.0
>                            A BB C

It isn't a "real number".

> - C is only > 0 for bug fixing releases
> - A.BB is increased with every new release by 0.1
> - with 2.00 we switch to A.B.C, i.e. 2.0.0 (we can't do this now
>   as it would confuse some people because 1.3.0 is "smaller" than
>   1.21a)
> 
> Comments?

Version numbers are needed for
a) informational purposes (/Producer, ...)
b) feature tests

* In the past there was some funny formatting of the /Producer entry,
  thus it is done in hpdftex.def. Also the code shows that there are
  three numberings schemes at macro level:
  1. none (before \pdftexversion)
  2. \pdftexversion<100 (it contains B only)
  3. \pdftexversion>100 (it contains A and B)

  I would dislike the idea to have a complicate algorithm only
  to order pdfTeX versions.

* \pdftexversion and \pdftexrevision are accessed differently:
    \the\pdftexversion, but \pdftexrevision (expandable)
  And \pdfversion encodes two numbers.

  Thus having three numbers instead of the current mixup
  improves the usage interface.

* Compatibility:
  * \pdftexversion is used in (TL2004):
    * ConTeXt
    * hyperref
    * graphicx/pdftex.def
    * pdfcprot
    * texinfo
    * fontinst
    * attachfile
    * pdfpages
    * thumbpdf
    * ...
  * \pdftexrevision is used:
    * hyperref
    * fontinst
    * pdfcprot
    * graphicx/pdftex.def
    * thumbpdf
    * ...

  Thus I think, it is quite too late to change this interface.

* Suggestion for interface that respects compatibility
  and adds an interface for three numbers:

  A.B.C
  A \in [1..\infty]
  B \in [0..99]
  C \in [0..25]

  The whole version number is printed as: printf("%d.%d.%d", A, B, C)

  \pdftexmainversion:   readonly integer for A
  \pdftexsubversion:    readonly integer for B
  \pdftexbugfixversion: readonly integer for C

  \pdftexversion := \pdftexmainversion * 100 + \pdftexsubversion
  \pdftexrevision := to_lowerletter(\pdftexbugfixversion)
    to_lowerletter defines the following mapping:
       0 -> a
       1 -> b
      ...
      25 -> z

  The following conditions, expressed in TeX, hold:

    \the\pdftexversion =
      \the\numexpr \pdftexmainversion * 100 + \pdftexsubversion\relax

    \the\pdftexbugfixversion =
      \the\numexpr\expandafter`\pdftexrevision - `a\relax

* \pdftexmainversion, ... could be defined as macros,
  example with e-TeX, pdfTeX versions >= 1.0:
  
\edef\pdftexmainversion{% avoid division with rounding
  \number\dimexpr 0.01\dimexpr\the\pdftexversion sp\relax\relax
}
\edef\pdftexsubversion{%
  \number\numexpr \the\pdftexversion - 100*\pdftexmainversion\relax
}
\edef\pdftexbugfixversion{%
  \number\numexpr \expandafter`\pdftexrevision - `a\relax
}

Thus we have already A, B, and C. What we really need is rather
a specification:
* data type: A, B, C are numbers (/strings), range
* how does the version look like, formatting issues

and the definition of semantics:
* meaning of A, B, C
* when to increase A, B, or C

Next open issue of EuroTeX are feature tests. Some features cannot
be tested by presence of pdfTeX primitives, eg. \ifeof18
Thus currently only the version number can be used to test
these features.
Conclusion:
* The documentation must contain a section that contains
  a mapping between a feature and the first version, where
  the feature is available.
* Or new interface for feature checks independent of version
  numbers (and independent of a special TeX engine).

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Wed Jun  8 09:26:12 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jun  8 09:25:31 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
Message-ID: <42A69D94.40002@wxs.nl>

Heiko Oberdiek wrote:


>   I would dislike the idea to have a complicate algorithm only
>   to order pdfTeX versions.

indeed, all 'important' changes (primitives, features) should be reflected in on 
enumber;

> * \pdftexversion and \pdftexrevision are accessed differently:
>     \the\pdftexversion, but \pdftexrevision (expandable)
>   And \pdfversion encodes two numbers.

>   Thus having three numbers instead of the current mixup
>   improves the usage interface.
> 
> * Compatibility:
>   * \pdftexversion is used in (TL2004):
>     * ConTeXt
>     * hyperref
>     * graphicx/pdftex.def
>     * pdfcprot
>     * texinfo
>     * fontinst
>     * attachfile
>     * pdfpages
>     * thumbpdf
>     * ...
>   * \pdftexrevision is used:
>     * hyperref
>     * fontinst
>     * pdfcprot
>     * graphicx/pdftex.def
>     * thumbpdf
>     * ...
> 
>   Thus I think, it is quite too late to change this interface.

an option is to freeze the old numbers and introduce new ones

> * Suggestion for interface that respects compatibility
>   and adds an interface for three numbers:
> 
>   A.B.C
>   A \in [1..\infty]
>   B \in [0..99]
>   C \in [0..25]
> 
>   The whole version number is printed as: printf("%d.%d.%d", A, B, C)
> 
>   \pdftexmainversion:   readonly integer for A
>   \pdftexsubversion:    readonly integer for B
>   \pdftexbugfixversion: readonly integer for C
> 
>   \pdftexversion := \pdftexmainversion * 100 + \pdftexsubversion
>   \pdftexrevision := to_lowerletter(\pdftexbugfixversion)
>     to_lowerletter defines the following mapping:
>        0 -> a
>        1 -> b
>       ...
>       25 -> z
> 
>   The following conditions, expressed in TeX, hold:
> 
>     \the\pdftexversion =
>       \the\numexpr \pdftexmainversion * 100 + \pdftexsubversion\relax
> 
>     \the\pdftexbugfixversion =
>       \the\numexpr\expandafter`\pdftexrevision - `a\relax
> 
> * \pdftexmainversion, ... could be defined as macros,
>   example with e-TeX, pdfTeX versions >= 1.0:
>   
> \edef\pdftexmainversion{% avoid division with rounding
>   \number\dimexpr 0.01\dimexpr\the\pdftexversion sp\relax\relax
> }
> \edef\pdftexsubversion{%
>   \number\numexpr \the\pdftexversion - 100*\pdftexmainversion\relax
> }
> \edef\pdftexbugfixversion{%
>   \number\numexpr \expandafter`\pdftexrevision - `a\relax
> }
> 
> Thus we have already A, B, and C. What we really need is rather
> a specification:
> * data type: A, B, C are numbers (/strings), range
> * how does the version look like, formatting issues
> 
> and the definition of semantics:
> * meaning of A, B, C
> * when to increase A, B, or C

i dislike the formal version number to be calculated, so i'd opt for:

new primitives

\pdftexmainversion:   readonly integer for A
\pdftexsubversion:    readonly integer for B
\pdftexbugfixversion: readonly integer for C

backward compatibility primitives, not advertised

\pdftexversion  := \pdftexmainversion * 100 + \pdftexsubversion
\pdftexrevision := to_lowerletter(\pdftexbugfixversion)

> Next open issue of EuroTeX are feature tests. Some features cannot
> be tested by presence of pdfTeX primitives, eg. \ifeof18

actually, \ifeof18 is implemented now (at least it was the intention)

> Thus currently only the version number can be used to test
> these features.
> Conclusion:
> * The documentation must contain a section that contains
>   a mapping between a feature and the first version, where
>   the feature is available.
> * Or new interface for feature checks independent of version
>   numbers (and independent of a special TeX engine).

Thanks for the analysis -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Wed Jun  8 09:50:32 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun  8 09:50:28 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <42A69D94.40002@wxs.nl>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<42A69D94.40002@wxs.nl>
Message-ID: <20050608075032.GA13208@m0A02326C.vpn.uni-freiburg.de>

On Wed, Jun 08, 2005 at 09:26:12AM +0200, Hans Hagen wrote:

> Heiko Oberdiek wrote:
> 
> i dislike the formal version number to be calculated, so i'd opt for:
> 
> new primitives
> 
> \pdftexmainversion:   readonly integer for A
> \pdftexsubversion:    readonly integer for B
> \pdftexbugfixversion: readonly integer for C
> 
> backward compatibility primitives, not advertised
> 
> \pdftexversion  := \pdftexmainversion * 100 + \pdftexsubversion
> \pdftexrevision := to_lowerletter(\pdftexbugfixversion)

%%% test.tex %%%
% simulate \pdftexmainversion, ... that are not yet defined
\newcount\pdftexmainversion
\pdftexmainversion=1
\newcount\pdftexsubversion
\pdftexsubversion=21
\newcount\pdftexbugfixversion
\pdftexbugfixversion=1

% now the code for \pdftexversion and \pdftexrevision follows.
% It should probably go into pdftexconfig.tex
\begingroup
  % * definition of \pdftexversion
  \count0=\pdftexmainversion
  \multiply\count0 by 100\relax
  \advance\count0 by \pdftexsubversion
  % using \chardef to avoid count register
  % and \the\pdftexversion must work
  \global\chardef\pdftexversion=\count0\relax
  %
  % definition of \pdftexrevision
  \count0=\pdftexbugfixversion
  \advance\count0 by `a\relax
  % the revision letter must have catcode 12
  \lccode`0=\count0\relax
  \lowercase{\xdef\pdftexrevision{0}}%
\endgroup

% test
\message{* \the\pdftexversion\pdftexrevision}
\end
%%% test.tex %%%

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

PS:

> actually, \ifeof18 is implemented now (at least it was the intention)

Yes, it is present.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Wed Jun  8 10:23:21 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jun  8 10:22:41 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608075032.GA13208@m0A02326C.vpn.uni-freiburg.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<42A69D94.40002@wxs.nl>
	<20050608075032.GA13208@m0A02326C.vpn.uni-freiburg.de>
Message-ID: <42A6AAF9.9040600@wxs.nl>

Heiko Oberdiek wrote:
> On Wed, Jun 08, 2005 at 09:26:12AM +0200, Hans Hagen wrote:
> 
> 
>>Heiko Oberdiek wrote:
>>
>>i dislike the formal version number to be calculated, so i'd opt for:
>>
>>new primitives
>>
>>\pdftexmainversion:   readonly integer for A
>>\pdftexsubversion:    readonly integer for B
>>\pdftexbugfixversion: readonly integer for C
>>
>>backward compatibility primitives, not advertised
>>
>>\pdftexversion  := \pdftexmainversion * 100 + \pdftexsubversion
>>\pdftexrevision := to_lowerletter(\pdftexbugfixversion)
> 
> 
> %%% test.tex %%%
> % simulate \pdftexmainversion, ... that are not yet defined
> \newcount\pdftexmainversion
> \pdftexmainversion=1
> \newcount\pdftexsubversion
> \pdftexsubversion=21
> \newcount\pdftexbugfixversion
> \pdftexbugfixversion=1
> 
> % now the code for \pdftexversion and \pdftexrevision follows.
> % It should probably go into pdftexconfig.tex
> \begingroup
>   % * definition of \pdftexversion
>   \count0=\pdftexmainversion
>   \multiply\count0 by 100\relax
>   \advance\count0 by \pdftexsubversion
>   % using \chardef to avoid count register
>   % and \the\pdftexversion must work
>   \global\chardef\pdftexversion=\count0\relax
>   %
>   % definition of \pdftexrevision
>   \count0=\pdftexbugfixversion
>   \advance\count0 by `a\relax
>   % the revision letter must have catcode 12
>   \lccode`0=\count0\relax
>   \lowercase{\xdef\pdftexrevision{0}}%
> \endgroup
> 
> % test
> \message{* \the\pdftexversion\pdftexrevision}
> \end
> %%% test.tex %%%

sounds ok to me

(some \ifx\undefined\pdftexversion is needed as wrapper so that we don't get 
problems due to mixups with older versions)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Wed Jun  8 11:52:05 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jun  8 11:59:53 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
Message-ID: <20050608095205.GB12064@lucien.kn-bremen.de>

On 2005-06-08 09:05:41 +0200, Heiko Oberdiek wrote:
>   Thus I think, it is quite too late to change this interface.

No change is needed; currently \pdftexrevision is a char with
alphanums, in the future it will be a char with digits. This
shouldn't break anything. 

Do we really need the information of \pdftexrevision as a number?
It would be nice, but is it needed?

> * Suggestion for interface that respects compatibility
>   and adds an interface for three numbers:
> 
>   A.B.C
>   A \in [1..\infty]
>   B \in [0..99]
>   C \in [0..25]
> 
>   The whole version number is printed as: printf("%d.%d.%d", A, B, C)
> 
>   \pdftexmainversion:   readonly integer for A
>   \pdftexsubversion:    readonly integer for B
>   \pdftexbugfixversion: readonly integer for C
> 
>   \pdftexversion := \pdftexmainversion * 100 + \pdftexsubversion
>   \pdftexrevision := to_lowerletter(\pdftexbugfixversion)

Why?

[...]

> Thus we have already A, B, and C. What we really need is rather
> a specification:
> * data type: A, B, C are numbers (/strings), range

    A \in [1..\infty]
    B \in [0..99]
    C in "0".."9" (currently it's "a".."z"

B is only increased by 10.

> * how does the version look like, formatting issues

A.BB.C

> and the definition of semantics:
> * meaning of A, B, C

A and B have no meaning for themselves; together they are the
current version. C is the patchlevel.

> * when to increase A, B, or C

C is increased only for bug fixing releases.

A.B is increased by 0.1 by every release with new features.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From taco at elvenkind.com  Wed Jun  8 14:15:06 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed Jun  8 14:15:10 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608095205.GB12064@lucien.kn-bremen.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<20050608095205.GB12064@lucien.kn-bremen.de>
Message-ID: <42A6E14A.6010605@elvenkind.com>


I'm happy with Martin's original proposal, that, afaik, doesn't break
anything. \pdftexversion will move like this:

130 140 150 160 170 180 190 (all A.BB), then 200 210 (A.B.C)
and perhaps 211 if a bugfix release is needed. Right, Martin?

Taco


Martin Schr?der wrote:
> On 2005-06-08 09:05:41 +0200, Heiko Oberdiek wrote:
> 
>>  Thus I think, it is quite too late to change this interface.
> 
> 
> No change is needed; currently \pdftexrevision is a char with
> alphanums, in the future it will be a char with digits. This
> shouldn't break anything. 
> 
> Do we really need the information of \pdftexrevision as a number?
> It would be nice, but is it needed?
> 
> 
>>* Suggestion for interface that respects compatibility
>>  and adds an interface for three numbers:
>>
>>  A.B.C
>>  A \in [1..\infty]
>>  B \in [0..99]
>>  C \in [0..25]
>>
>>  The whole version number is printed as: printf("%d.%d.%d", A, B, C)
>>
>>  \pdftexmainversion:   readonly integer for A
>>  \pdftexsubversion:    readonly integer for B
>>  \pdftexbugfixversion: readonly integer for C
>>
>>  \pdftexversion := \pdftexmainversion * 100 + \pdftexsubversion
>>  \pdftexrevision := to_lowerletter(\pdftexbugfixversion)
> 
> 
> Why?
> 
> [...]
> 
> 
>>Thus we have already A, B, and C. What we really need is rather
>>a specification:
>>* data type: A, B, C are numbers (/strings), range
> 
> 
>     A \in [1..\infty]
>     B \in [0..99]
>     C in "0".."9" (currently it's "a".."z"
> 
> B is only increased by 10.
> 
> 
>>* how does the version look like, formatting issues
> 
> 
> A.BB.C
> 
> 
>>and the definition of semantics:
>>* meaning of A, B, C
> 
> 
> A and B have no meaning for themselves; together they are the
> current version. C is the patchlevel.
> 
> 
>>* when to increase A, B, or C
> 
> 
> C is increased only for bug fixing releases.
> 
> A.B is increased by 0.1 by every release with new features.
> 
> Best regards
>     Martin
From oberdiek at uni-freiburg.de  Wed Jun  8 18:06:12 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun  8 18:06:39 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608095205.GB12064@lucien.kn-bremen.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<20050608095205.GB12064@lucien.kn-bremen.de>
Message-ID: <20050608160612.GB15734@m0A02326C.vpn.uni-freiburg.de>

On Wed, Jun 08, 2005 at 11:52:05AM +0200, Martin Schr?der wrote:

> On 2005-06-08 09:05:41 +0200, Heiko Oberdiek wrote:
> >   Thus I think, it is quite too late to change this interface.
> 
> No change is needed; currently \pdftexrevision is a char with
> alphanums, in the future it will be a char with digits. This
> shouldn't break anything. 
> 
> Do we really need the information of \pdftexrevision as a number?
> It would be nice, but is it needed?

I do not mind if this is a character and thought there are some
requests to have numbers.

> > Thus we have already A, B, and C. What we really need is rather
> > a specification:
> > * data type: A, B, C are numbers (/strings), range
> 
>     A \in [1..\infty]
>     B \in [0..99]
>     C in "0".."9" (currently it's "a".."z"
> 
> B is only increased by 10.
> 
> > * how does the version look like, formatting issues
> 
> A.BB.C

There are some contradictions. Here the second B is always zero.
Taco takes the second B as patchlevel, but what is \pdftexrevision
then? Also already the tenth version forces the main version A to
be incremented.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From oberdiek at uni-freiburg.de  Wed Jun  8 17:55:32 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun  8 18:06:41 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <42A6AAF9.9040600@wxs.nl>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<42A69D94.40002@wxs.nl>
	<20050608075032.GA13208@m0A02326C.vpn.uni-freiburg.de>
	<42A6AAF9.9040600@wxs.nl>
Message-ID: <20050608155531.GA15734@m0A02326C.vpn.uni-freiburg.de>

On Wed, Jun 08, 2005 at 10:23:21AM +0200, Hans Hagen wrote:

> >% now the code for \pdftexversion and \pdftexrevision follows.
> >% It should probably go into pdftexconfig.tex
> >\begingroup
> >  % * definition of \pdftexversion
> >  \count0=\pdftexmainversion
> >  \multiply\count0 by 100\relax
> >  \advance\count0 by \pdftexsubversion
> >  % using \chardef to avoid count register
> >  % and \the\pdftexversion must work
> >  \global\chardef\pdftexversion=\count0\relax
> >  %
> >  % definition of \pdftexrevision
> >  \count0=\pdftexbugfixversion
> >  \advance\count0 by `a\relax
> >  % the revision letter must have catcode 12
> >  \lccode`0=\count0\relax
> >  \lowercase{\xdef\pdftexrevision{0}}%
> >\endgroup

> sounds ok to me
> 
> (some \ifx\undefined\pdftexversion is needed as wrapper so that we don't 
> get problems due to mixups with older versions)

You mean some security check in the final version:

\begingroup
  \expandafter\ifx\csname pdftexmainversion\endcsname\relax
    % do nothing because of older pdfTeX version
  \else
    % * definition of \pdftexversion
    \count0=\pdftexmainversion
    \multiply\count0 by 100\relax
    \advance\count0 by \pdftexsubversion
    % using \chardef to avoid count register
    % and \the\pdftexversion must work
    \global\chardef\pdftexversion=\count0\relax
    %
    % definition of \pdftexrevision
    \count0=\pdftexbugfixversion   
    \advance\count0 by `a\relax    
    % the revision letter must have catcode 12
    \lccode`0=\count0\relax
    \lowercase{\xdef\pdftexrevision{0}}%
  \fi
\endgroup

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From reinhard.kotucha at web.de  Thu Jun  9 02:57:52 2005
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Thu Jun  9 02:58:17 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
Message-ID: <17063.37904.422336.868524@zarniwoop.ms25.local>

Hi,
>>>>> "Heiko" == Heiko Oberdiek <oberdiek@uni-freiburg.de> writes:

  >   \pdftexmainversion: readonly integer for A 
  >   \pdftexsubversion:  readonly integer for B 
  >   \pdftexbugfixversion: readonly integer for C

if you really intend to introduce new primitives, it would be better
to call them \pdfmajorversion and \pdfminorversion instead of
\pdftexmainversion and \pdftexsubversion.  It's easier to remember
because we already have \pdfoptionpdfminorversion.


As far as compatibility is concerned, it's probably best to leave
things as they are and add a new primitive \pdftexrevisionnumber.

\pdftexversion is quite straightforward as it is now.  It can easily
be split into major/minor version.

\pdftexrevision can be kept for backward compatibility.  It returns a
character. 

\pdftexrevisionnumber returns an integer.

Internally (in pdftex, the program), it is most straightforward if the
revision number is an integer rather than a character (maybe it
already is).  It can be used easily by printf to type the banner, and
\pdftexrevisionnumber has nothing to do but return this integer.
\pdftexrevision has to translate the number to a character.  This is
straightforward and absolutely backward compatible.

I'd then vote for the following translation scheme:

0  => ''
1  => 'a'
2  => 'b'
  ...
26 => 'z'

That means that a release has not automatically to be a bugfix release.
We can have 1.30 instead of 1.30.0 if \pdftexrevisionnumber=0.

\pdftexrevision expands to an empty string in this case.


Cheers,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From pragma at wxs.nl  Thu Jun  9 09:38:04 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun  9 09:37:21 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <17063.37904.422336.868524@zarniwoop.ms25.local>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<17063.37904.422336.868524@zarniwoop.ms25.local>
Message-ID: <42A7F1DC.9040904@wxs.nl>

Reinhard Kotucha wrote:

> That means that a release has not automatically to be a bugfix release.
> We can have 1.30 instead of 1.30.0 if \pdftexrevisionnumber=0.

How many releases do we have per year, i.e. we may as well have enough 
resolution with those two numbers; currently we don't even use all of them; we 
can use the character number (c) as bug fix number, and use the current main 
version number as it is (a*100+b); we should be more generous in jumping numbers 
(so by now we should have had a.28 and not some 1.22w or so)


Hans

(downloading the 180 MB worldwind 1.3.1.1 installer now, and wondering what the 
difference is with my 1.3.1 version)

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Fri Jun 10 01:42:43 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jun 10 07:50:26 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <42A6E14A.6010605@elvenkind.com>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<20050608095205.GB12064@lucien.kn-bremen.de>
	<42A6E14A.6010605@elvenkind.com>
Message-ID: <20050609234243.GC28966@lucien.kn-bremen.de>

On 2005-06-08 14:15:06 +0200, Taco Hoekwater wrote:
> I'm happy with Martin's original proposal, that, afaik, doesn't break
> anything. \pdftexversion will move like this:
> 
> 130 140 150 160 170 180 190 (all A.BB), then 200 210 (A.B.C)
> and perhaps 211 if a bugfix release is needed. Right, Martin?

Yes.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Fri Jun 10 01:48:41 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jun 10 07:53:27 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050608160612.GB15734@m0A02326C.vpn.uni-freiburg.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<20050608095205.GB12064@lucien.kn-bremen.de>
	<20050608160612.GB15734@m0A02326C.vpn.uni-freiburg.de>
Message-ID: <20050609234841.GD28966@lucien.kn-bremen.de>

On 2005-06-08 18:06:12 +0200, Heiko Oberdiek wrote:
> I do not mind if this is a character and thought there are some
> requests to have numbers.

Why does a software care for _bugfix_ levels? Workarounds?

> > > Thus we have already A, B, and C. What we really need is rather
> > > a specification:
> > > * data type: A, B, C are numbers (/strings), range
> > 
> >     A \in [1..\infty]
> >     B \in [0..99]
> >     C in "0".."9" (currently it's "a".."z"
> > 
> > B is only increased by 10.
> > 
> > > * how does the version look like, formatting issues
> > 
> > A.BB.C
> 
> There are some contradictions. Here the second B is always zero.
> Taco takes the second B as patchlevel, but what is \pdftexrevision
> then?

Starting with 1.30, B will be \in [30,40,50,60,70,80,90],
starting with 2.0, B will be \in [0..9].
\pdftexrevision will always be in "0".."9".

>       Also already the tenth version forces the main version A to
> be incremented.

Yes. 1.90, 2.0, .. 2.9, 3.0 ..

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Fri Jun 10 01:56:30 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jun 10 07:55:11 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <42A7F1DC.9040904@wxs.nl>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<17063.37904.422336.868524@zarniwoop.ms25.local>
	<42A7F1DC.9040904@wxs.nl>
Message-ID: <20050609235630.GE28966@lucien.kn-bremen.de>

On 2005-06-09 09:38:04 +0200, Hans Hagen wrote:
> How many releases do we have per year, i.e. we may as well have enough 
> resolution with those two numbers; currently we don't even use all of them; 
> we can use the character number (c) as bug fix number, and use the current 
> main version number as it is (a*100+b); we should be more generous in 
> jumping numbers (so by now we should have had a.28 and not some 1.22w or so)

If I extrapolate for the last 12 months,
- 1.20a would have been 1.20.0 (2004-09-06)
- we would probably have a 1.20.1 (2004-10)
- 1.20b would have been 1.30.0 (2004-12-22)
- 1.21a would have been 1.40.0 (2005-02-04)
- we would have done a 1.40.1 and 1.40.2 (and maybe even 1.40.3)
- the next release would be 1.50.0

That gives us probably four "proper" releases a year and some bug
fixing releases inbetween.

I know that this doesn't look very stable, but we have some
developement and we should aim at fixing bugs faster.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Fri Jun 10 09:33:40 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jun 10 09:32:57 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050609234243.GC28966@lucien.kn-bremen.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<20050608095205.GB12064@lucien.kn-bremen.de>
	<42A6E14A.6010605@elvenkind.com>
	<20050609234243.GC28966@lucien.kn-bremen.de>
Message-ID: <42A94254.4060209@wxs.nl>

Martin Schr?der wrote:
> On 2005-06-08 14:15:06 +0200, Taco Hoekwater wrote:
> 
>>I'm happy with Martin's original proposal, that, afaik, doesn't break
>>anything. \pdftexversion will move like this:
>>
>>130 140 150 160 170 180 190 (all A.BB), then 200 210 (A.B.C)
>>and perhaps 211 if a bugfix release is needed. Right, Martin?
> 
> 
> Yes.

i see, so, 9 bug fixes max before we jump the B number; sounds fine to me;

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Fri Jun 10 09:40:45 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jun 10 09:40:02 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050609235630.GE28966@lucien.kn-bremen.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<17063.37904.422336.868524@zarniwoop.ms25.local>
	<42A7F1DC.9040904@wxs.nl>
	<20050609235630.GE28966@lucien.kn-bremen.de>
Message-ID: <42A943FD.7030905@wxs.nl>

Martin Schr?der wrote:
> On 2005-06-09 09:38:04 +0200, Hans Hagen wrote:
> 
>>How many releases do we have per year, i.e. we may as well have enough 
>>resolution with those two numbers; currently we don't even use all of them; 
>>we can use the character number (c) as bug fix number, and use the current 
>>main version number as it is (a*100+b); we should be more generous in 
>>jumping numbers (so by now we should have had a.28 and not some 1.22w or so)
> 
> 
> If I extrapolate for the last 12 months,
> - 1.20a would have been 1.20.0 (2004-09-06)
> - we would probably have a 1.20.1 (2004-10)
> - 1.20b would have been 1.30.0 (2004-12-22)
> - 1.21a would have been 1.40.0 (2005-02-04)
> - we would have done a 1.40.1 and 1.40.2 (and maybe even 1.40.3)
> - the next release would be 1.50.0
> 
> That gives us probably four "proper" releases a year and some bug
> fixing releases inbetween.
> 
> I know that this doesn't look very stable, but we have some
> developement and we should aim at fixing bugs faster.

well, it may look unstable but at least shows more progress that linux kernel 
numbers -)

When will we go 2.00 ? when open type is present?

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Jun 10 11:41:34 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jun 10 11:41:26 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <42A943FD.7030905@wxs.nl>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<17063.37904.422336.868524@zarniwoop.ms25.local>
	<42A7F1DC.9040904@wxs.nl>
	<20050609235630.GE28966@lucien.kn-bremen.de>
	<42A943FD.7030905@wxs.nl>
Message-ID: <20050610094134.GA2712@m0A02326C.vpn.uni-freiburg.de>

On Fri, Jun 10, 2005 at 09:40:45AM +0200, Hans Hagen wrote:

> Martin Schr?der wrote:
> >On 2005-06-09 09:38:04 +0200, Hans Hagen wrote:
> >
> >>How many releases do we have per year, i.e. we may as well have enough 
> >>resolution with those two numbers; currently we don't even use all of 
> >>them; we can use the character number (c) as bug fix number, and use the 
> >>current main version number as it is (a*100+b); we should be more 
> >>generous in jumping numbers (so by now we should have had a.28 and not 
> >>some 1.22w or so)
> >
> >
> >If I extrapolate for the last 12 months,
> >- 1.20a would have been 1.20.0 (2004-09-06)
> >- we would probably have a 1.20.1 (2004-10)
> >- 1.20b would have been 1.30.0 (2004-12-22)
> >- 1.21a would have been 1.40.0 (2005-02-04)
> >- we would have done a 1.40.1 and 1.40.2 (and maybe even 1.40.3)
> >- the next release would be 1.50.0
> >
> >That gives us probably four "proper" releases a year and some bug
> >fixing releases inbetween.
> >
> >I know that this doesn't look very stable, but we have some
> >developement and we should aim at fixing bugs faster.
> 
> well, it may look unstable but at least shows more progress that linux 
> kernel numbers -)
> 
> When will we go 2.00 ? when open type is present?

That's the problem with Martin's proposal, I think.
* Never. My understanding of Martin is that we would
  have "2.0" rather than "2.00".
  Thus the confusion about version numbers remains.
* We would go to 2.0 after 1.90 (or 1.90.x or 1.9x or 1.9x.y?)^1
  regardless of some "main features" or "compatibility changes".
  We lost a semantics of the "main version number".

^1
  Sorry Martin, probably I have got a brain damage after
  reading a lot of specifications (XPath, XSchema, XQuery, ...).
  I cannot think without a formal grammar specification. ;-(

On Fri, Jun 10, 2005 at 01:42:43AM +0200, Martin Schr?der wrote:

> > 130 140 150 160 170 180 190 (all A.BB), then 200 210 (A.B.C)
> > and perhaps 211 if a bugfix release is needed. Right, Martin?
>
> Yes.

On Fri, Jun 10, 2005 at 01:48:41AM +0200, Martin Schr?der wrote:

> Starting with 1.30, B will be \in [30,40,50,60,70,80,90],
> starting with 2.0, B will be \in [0..9].
> \pdftexrevision will always be in "0".."9".
>
> >       Also already the tenth version forces the main version A to
> > be incremented.
>
> Yes. 1.90, 2.0, .. 2.9, 3.0 ..

I. What is a version number?

What are the components of the complete version description?
  a) major version (A): major changes
     minor version (B): features added
     patchlevel (C):    bug fix releases
  b) version (A.B) only and patchlevel (C)

  case a): a range [0..9] for B is too small in my opinion, it prevents
    more often releases.
  case b): a special meaning of A is lost and the version number
    is unnecessary complicate, just an integer would be enough.

II. How the complete version number is encoded?

\pdfversion, \pdfrevision, ...?

211 is unclear.
  Is 211 the number, given by \pdfversion?
  Does \pdfversion also contains the patchlevel and
  \pdfrevision is obsolete?
  Act versions < 2 and versions >= 2 differently in this respect?

III. How the complete version number is displayed?

2.0 or 2.00 or 2.0.0 or 2.00.0 or 2.00a or 2.0a or ...?

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Fri Jun 10 12:51:01 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jun 10 12:50:23 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <20050610094134.GA2712@m0A02326C.vpn.uni-freiburg.de>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<17063.37904.422336.868524@zarniwoop.ms25.local>
	<42A7F1DC.9040904@wxs.nl>
	<20050609235630.GE28966@lucien.kn-bremen.de>
	<42A943FD.7030905@wxs.nl>
	<20050610094134.GA2712@m0A02326C.vpn.uni-freiburg.de>
Message-ID: <42A97095.1000704@wxs.nl>

Heiko Oberdiek wrote:

>>When will we go 2.00 ? when open type is present?
>  
> That's the problem with Martin's proposal, I think.
> * Never. My understanding of Martin is that we would
>   have "2.0" rather than "2.00".

that's a display question, since it's actually version 200, displayed in the 
banner as 2.0.0 and when first debugged 2.0.1

>   Thus the confusion about version numbers remains.
> * We would go to 2.0 after 1.90 (or 1.90.x or 1.9x or 1.9x.y?)^1
>   regardless of some "main features" or "compatibility changes".
>   We lost a semantics of the "main version number".

  2.0.0 ==  2.0    ==  2 ==  200
  2.0.1 ==                   201
  2.0.2 ==                   202
  2.1.0 ==  2.1              210

15.0.0 == 15.0    == 15 == 1500
15.0.1                  == 1501

>   Sorry Martin, probably I have got a brain damage after
>   reading a lot of specifications (XPath, XSchema, XQuery, ...).
>   I cannot think without a formal grammar specification. ;-(

Xquery is indeed good for brain damage (interesting that those who oppose tex's 
mix of typesetting and programming state may favor something xquery -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Jun 10 13:19:57 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri Jun 10 13:56:52 2005
Subject: [NTG-pdftex] Version numbering
In-Reply-To: <42A97095.1000704@wxs.nl>
References: <20050607210201.GC4988@lucien.kn-bremen.de>
	<20050608070541.GA2767@m0A02326C.vpn.uni-freiburg.de>
	<17063.37904.422336.868524@zarniwoop.ms25.local>
	<42A7F1DC.9040904@wxs.nl>
	<20050609235630.GE28966@lucien.kn-bremen.de>
	<42A943FD.7030905@wxs.nl>
	<20050610094134.GA2712@m0A02326C.vpn.uni-freiburg.de>
	<42A97095.1000704@wxs.nl>
Message-ID: <20050610111957.GA3377@m0A02326C.vpn.uni-freiburg.de>

On Fri, Jun 10, 2005 at 12:51:01PM +0200, Hans Hagen wrote:

> Heiko Oberdiek wrote:
> 
> >>When will we go 2.00 ? when open type is present?
> > 
> >That's the problem with Martin's proposal, I think.
> >* Never. My understanding of Martin is that we would
> >  have "2.0" rather than "2.00".
> 
> that's a display question, since it's actually version 200, displayed in 
> the banner as 2.0.0 and when first debugged 2.0.1
> 
> >  Thus the confusion about version numbers remains.
> >* We would go to 2.0 after 1.90 (or 1.90.x or 1.9x or 1.9x.y?)^1
> >  regardless of some "main features" or "compatibility changes".
> >  We lost a semantics of the "main version number".
> 
>  2.0.0 ==  2.0    ==  2 ==  200
>  2.0.1 ==                   201
>  2.0.2 ==                   202
>  2.1.0 ==  2.1              210
> 
> 15.0.0 == 15.0    == 15 == 1500
> 15.0.1                  == 1501

I try to define \thepdftexversion that generates the
formatted version number:

\begingroup
  \expandafter\ifx\csname pdftexversion\endcsname\relax
    \gdef\thepdftexversion{0.?}% UNCLEAR
  \else
    \ifnum\pdftexversion<100 %
      \xdef\thepdftexversion{0.\the\pdftexversion\pdftexrevision}%
    \else
      \ifnum\pdftexversion<130 %
        \def\gobble#1{}%
        \xdef\thepdftexversion{%
          1.\expandafter\gobble\the\pdftexversion\pdftexrevision
        }%
      \else
        \ifnum\pdftexversion<200 %
          \def\gobble#1{}%
          \xdef\thepdftexversion{%
            1.\expandafter\gobble\the\pdftexversion.\number\pdftexrevision
          }% UNCLEAR
        \else
          \count0=\pdftexversion
          \divide\count0 by 100 %
          \xdef\thepdftexversion{\the\count0}%
          \multiply\count0 by -100 %
          \advance\count0 by \pdftexversion
          \edef\x{\ifnum\count0 < 10 0\fi\the\count0}%
          \def\y#1#2{#1.#2}%
          \xdef\thepdftexversion{\thepdftexversion.\expandafter\y\x}%
        \fi
      \fi  
    \fi    
  \fi      
\endgroup

\message{ <<\thepdftexversion>> }
\end

> >  Sorry Martin, probably I have got a brain damage after
> >  reading a lot of specifications (XPath, XSchema, XQuery, ...).
> >  I cannot think without a formal grammar specification. ;-(
> 
> Xquery is indeed good for brain damage (interesting that those who oppose 
> tex's mix of typesetting and programming state may favor something xquery -)

It's lecture stuff that I have to learn. It was interesting to see,
how the query language evolved. Some time ago I had made a talk
about the predecessor Quilt.
  In two weeks we are dealing with XSLT.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From jackos1 at poczta.onet.pl  Sun Jun 12 21:31:21 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sun Jun 12 21:31:29 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
Message-ID: <42AC8D89.7090501@poczta.onet.pl>

Hi All,

there is \pdflastvbreakpenalty command mentioned in the manual.
I've checked the current and some previous versions of pdfTeX and this 
command is undefined. Removed looong time ago? Shall we remove commands 
like that from the documentation, or keep it with obsolate info?

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From hartmut_henkel at gmx.de  Sun Jun 12 21:45:53 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sun Jun 12 21:45:57 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
In-Reply-To: <42AC8D89.7090501@poczta.onet.pl>
References: <42AC8D89.7090501@poczta.onet.pl>
Message-ID: <Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>

Hi Pawe/l,

On Sun, 12 Jun 2005, Pawel Jackowski wrote:

> there is \pdflastvbreakpenalty command mentioned in the manual. I've
> checked the current and some previous versions of pdfTeX and this
> command is undefined. Removed looong time ago? Shall we remove
> commands like that from the documentation, or keep it with obsolate
> info?

seems it was still in 1.11b, but not anymore in 1.20b, and it also was
never properly documented, so i would purge all references to it.

Regards, Hartmut
From martin at oneiros.de  Mon Jun 13 00:52:19 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jun 13 01:03:37 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
In-Reply-To: <Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>
References: <42AC8D89.7090501@poczta.onet.pl>
	<Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>
Message-ID: <20050612225219.GA27130@lucien.kn-bremen.de>

On 2005-06-12 21:45:53 +0200, Hartmut Henkel wrote:
> seems it was still in 1.11b, but not anymore in 1.20b, and it also was
> never properly documented, so i would purge all references to it.

Yep. For new primitives We should also mention the version of
pdfTeX when they were introduced.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Tue Jun 14 05:08:43 2005
From: pragma at wxs.nl (h h extern)
Date: Tue Jun 14 05:08:00 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
In-Reply-To: <20050612225219.GA27130@lucien.kn-bremen.de>
References: <42AC8D89.7090501@poczta.onet.pl>
	<Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>
	<20050612225219.GA27130@lucien.kn-bremen.de>
Message-ID: <42AE4A3B.90807@wxs.nl>

Martin Schr?der wrote:
> On 2005-06-12 21:45:53 +0200, Hartmut Henkel wrote:
> 
>>seems it was still in 1.11b, but not anymore in 1.20b, and it also was
>>never properly documented, so i would purge all references to it.
> 
> 
> Yep. For new primitives We should also mention the version of
> pdfTeX when they were introduced.

this was a left over primitive for than's thesis work

Hans



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From hanthethanh at myrealbox.com  Wed Jun 15 01:56:44 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Wed Jun 15 11:53:21 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
In-Reply-To: <42AE4A3B.90807@wxs.nl>
References: <42AC8D89.7090501@poczta.onet.pl>
	<Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>
	<20050612225219.GA27130@lucien.kn-bremen.de>
	<42AE4A3B.90807@wxs.nl>
Message-ID: <20050614235644.GA2575@monty.localnet>

On Tue, Jun 14, 2005 at 05:08:43AM +0200, Hans Hagen wrote:
> Martin Schr?der wrote:
> >On 2005-06-12 21:45:53 +0200, Hartmut Henkel wrote:
> >
> >>seems it was still in 1.11b, but not anymore in 1.20b, and it also was
> >>never properly documented, so i would purge all references to it.
> >
> >
> >Yep. For new primitives We should also mention the version of
> >pdfTeX when they were introduced.
> 
> this was a left over primitive for than's thesis work

I introduced this primitive for a job where I need some
hacking with page breaking and couldn't do that using
macros. This can be safely removed.

Thanh
From martin at oneiros.de  Wed Jun 15 18:36:23 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jun 15 18:37:01 2005
Subject: [NTG-pdftex] Re: 1.30.0-beta-20050615
In-Reply-To: <20050615161920.GF21214@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
Message-ID: <20050615163623.GH21214@lucien.kn-bremen.de>

On 2005-06-15 18:19:20 +0200, Martin Schr?der wrote:
> src/pdftex-1.30.0-beta-20050615.zip should be on sarovar.

Spoke to soon (and rsync permissions are broken: I can't write to
src): beta/pdftex-1.30.0-beta-20050615.zip is on sarovar.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Wed Jun 15 18:19:20 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jun 15 18:37:02 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
Message-ID: <20050615161920.GF21214@lucien.kn-bremen.de>

src/pdftex-1.30.0-beta-20050615.zip should be on sarovar.

Here's the proposed NEWS:
----------------------------------------------------------------
-------------------------------------------------
pdfTeX 3.141592-1.30.0 was released on 2005-06-??
-------------------------------------------------

- Some primites have been renamed; the old names will still work, but are
  deprecated and give a warning that they are obsolete:
    \pdfoptionpdfminorversion         -> \pdfminorversion
    \pdfoptionalwaysusepdfpagebox     -> \pdfforcepagebox
    \pdfoptionpdfinclusionerrorlevel  -> \pdfinclusionerrorlevel

- pdfxtex (introduced with 1.20a) is gone; all extensions are now in pdftex.

- pdftex nows two new units:
  - new Didot (1nd=0.375mm)
  - new Cicero (1nc=12nd)

- New primitive \pdfpkmode, which is a token register that sets the MF mode for
  pixel font generation. The contents of this register is dumped into the
  format, so one can (optionally) preset it e.g. in part of pdftexconfig.tex.

- New primitives: pdfTeX now has an interface to the precise system time (if
  available) as an aid in benchmarking TeX macro code. 
  Two new primitives are provided:
  - \elapsedtime is a read-only integer that (initially) returns the amount of
    time passed since the start of this run. This amount is given in `scaled
    seconds': the value 65536 counts as one second. If more time has passed
    than 32767 seconds, (2^31)-1 will be returned.
  - \resettime updates the internal timer, such that subsequent calls to
    \elapsedtime will restart from 0.

- New primitive \pdfxformname <object number>, which expands to the number
  in the corresponding form XObject name.

- New primitives \leftmarginkern <box number> and \rightmarginkern <box number>
  for specifying the margin kern at the left and right side of the horizontal
  list stored in box <box number>.

- Inclusion of pngs has been greatly improved: It now does
  - alpha channel and transparency (only if %!PDF >=1.4)
  - 16-bit colour (only if %!PDF >=1.5); this must be enabled by setting
    \pdfimagehicolor to 1.
  - gamma correction; this must be enabled by setting \pdfimageapplygamma to 1.
    The device gamma is taken from \pdfgamma. If no embedded value can be found
    in the png image, then the value of \pdfimagegamma is used instead.

- The effects of font expansion can now be logged:
  There is now a new integer variable \pdftracingfonts. It is zero by default,
  then we get a log (with fontexpansion) like this
  ...\tenrm t
  ...\tenrm (+20) e
  Without font expansion, this default should be compatible with TeX's original
  log output.
  If \pdftracingfonts is set to 1 (or greater), we get a more verbose log:
  ...\xivtt (cmtt10@14.0pt) t
  ...\xivtt (cmtt10+20@14.0pt) e
  See also bug 304.

- The primitive \pdfmovechar has been removed (bug 294)

- Bugfix: empty strings are not supressed anymore (bug 335)

- Bugfix: \unhboxing and character protusion didn't work well together (bug
  292)

- Bugfix: --jobname didn't work if there was no filename at all (bug 302)

- Bugfix: Some problem with fonts on solaris (bug 315)

- Bugfix: \pdfxform didn't work with box>255 (bug 310)

- Bugfix: protruding can lead to "This can't happen(paragraph)." (bug 292)
----------------------------------------------------------------

Thanh: I changed only NEWS, README, pdftex.ch and pdftex.mk (you
forgot pdftex2.ch). I didn't include texk/dvipsk as it's not
needed for pdftex; we'll have to figure out a way to pass that
upstream.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From oberdiek at uni-freiburg.de  Wed Jun 15 19:51:26 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun 15 19:51:01 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
Message-ID: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>

Hello,

what is the purpose of \pdfescapestring?
It calls convertStringToPDFString of utils.c with a useless
semantics:

char *convertStringToPDFString (char *in)
{
    static char pstrbuf[MAX_PSTRING_LEN];
    char *out = pstrbuf;
    int lin = strlen (in);
    int i, j;
    char buf[4];
    j = 0;
    for (i = 0; i < lin; i++) {
        check_buf(j + sizeof(buf), MAX_PSTRING_LEN);
        if ((unsigned char)in[i] < ' ') {
            /* convert control characters into hex */
            sprintf (buf, "#%02x", (unsigned int)(unsigned char)in[i]);
            out[j++] = buf[0];
            out[j++] = buf[1];
            out[j++] = buf[2];
            }
        else if ((in[i] == '(') || (in[i] == ')')) {
            /* escape paranthesis */
            out[j++] = '\\';
            out[j++] = in[i];
            }
        else if (in[i] == '\\') {
            /* escape backslash */
            out[j++] = '\\';
            out[j++] = '\\';
            }
        else {
            /* copy char :-) */
            out[j++] = in[i];
            }
        }
    out[j] = '\0';
    return pstrbuf;
}

It mixes escaping for PDF *strings* with escaping for PDF *names*.
'(', ')', '\\' are escaped for PDF strings,
control characters are escaped for PDF names.

Thus I suggest to change the control character escaping from
hexadecimal #xx to octal \ooo:

            sprintf (buf, "\\%03o", (unsigned int)(unsigned char)in[i]);
            out[j++] = buf[0];
            out[j++] = buf[1];
            out[j++] = buf[2];
            out[j++] = buf[3];

Then \pdfescapestring could be used for conversions to pdf strings.

Also a \pdfescapename / convertStringToPDFName is useful. Here
especially the delimiter characters must be escaped in the
#xx manner.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From hartmut_henkel at gmx.de  Wed Jun 15 20:07:00 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Wed Jun 15 20:07:04 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
In-Reply-To: <20050615161920.GF21214@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
Message-ID: <Pine.LNX.4.61.0506151945570.4140@hahepc1.hahe>

On Wed, 15 Jun 2005, Martin Schr?der wrote:

> src/pdftex-1.30.0-beta-20050615.zip should be on sarovar.

> pdfTeX 3.141592-1.30.0 was released on 2005-06-??
> -------------------------------------------------

> - New primitives \leftmarginkern <box number> and \rightmarginkern <box number>
>   for specifying the margin kern at the left and right side of the horizontal

maybe: "that tell the margin kerns..." because it's read-only

>   list stored in box <box number>.
>
> - Inclusion of pngs has been greatly improved: It now does
>   - alpha channel and transparency (only if %!PDF >=1.4)
>   - 16-bit colour (only if %!PDF >=1.5); this must be enabled by setting
>     \pdfimagehicolor to 1.
>   - gamma correction; this must be enabled by setting \pdfimageapplygamma to 1.
>     The device gamma is taken from \pdfgamma. If no embedded value can be found
>     in the png image, then the value of \pdfimagegamma is used instead.

maybe we should add

    - fast direct embedding of png streams, if their structure allows this;
      the automatic fall-back is to decompress and re-compress as before.

> - The effects of font expansion can now be logged:
>   There is now a new integer variable \pdftracingfonts. It is zero by default,
>   then we get a log (with fontexpansion) like this
>   ...\tenrm t
>   ...\tenrm (+20) e
>   Without font expansion, this default should be compatible with TeX's original
>   log output.
>   If \pdftracingfonts is set to 1 (or greater), we get a more verbose log:
>   ...\xivtt (cmtt10@14.0pt) t
>   ...\xivtt (cmtt10+20@14.0pt) e
>   See also bug 304.
>
> - The primitive \pdfmovechar has been removed (bug 294)
>
> - Bugfix: empty strings are not supressed anymore (bug 335)
>
> - Bugfix: \unhboxing and character protusion didn't work well together (bug
>   292)
>
> - Bugfix: --jobname didn't work if there was no filename at all (bug 302)
>
> - Bugfix: Some problem with fonts on solaris (bug 315)
>
> - Bugfix: \pdfxform didn't work with box>255 (bug 310)

- Bugfix: Dangling font objects with non-replacable fonts (bug 311).

This also seems to be corrected; at least since then i didn't get such
dangling font objects. But i can't prove :-)

- Bugfix: cmap: unicode ???? is mapped to multiple glyphs (bug 306).

Here pdftex now reacts in a clear way (a warning?), Thanh can say what
that actually is :-) so one can consider this as closed...

> - Bugfix: protruding can lead to "This can't happen(paragraph)." (bug 292)
> ----------------------------------------------------------------

Bug 320: this is the colorstack stuff. Maybe one should shift it into
"feature requests", it's documented, so it's no bug.

Bug 345: typo corrected by Pawe/l?

Bug 359: ???

Bug 362: a feature, not a bug.

Regards, Hartmut
From oberdiek at uni-freiburg.de  Wed Jun 15 20:41:48 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun 15 20:41:14 2005
Subject: [NTG-pdftex] \pdfretval vs. expandable \pdfstrcmp
Message-ID: <20050615184147.GA15222@m0A0232EA.vpn.uni-freiburg.de>

Hello,

is there a reason why \pdfstrcmp is not expandable?
An expandable variant could be used in expandable contexts:
  \ifcase\numexpr\pdfstrcmp{StringA}{StringB}+1\relax
  ...\or ...\or ...\fi
Inserting into a sorted linear list could be done in O(n):
  \edef\mylist{\addtolist\mylist{foo}}%
Now it is O(n^2) :-(

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From oberdiek at uni-freiburg.de  Wed Jun 15 20:43:56 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed Jun 15 20:43:21 2005
Subject: [NTG-pdftex] Re: \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
Message-ID: <20050615184355.GA15254@m0A0232EA.vpn.uni-freiburg.de>

On Wed, Jun 15, 2005 at 07:51:25PM +0200, Heiko Oberdiek wrote:

> what is the purpose of \pdfescapestring?

Next question, can it be made expandable? Then it could be
directly used inside \pdfobj and ...

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From noreply at sarovar.org  Wed Jun 15 23:51:46 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Wed Jun 15 23:57:51 2005
Subject: [NTG-pdftex] [ pdftex-Patches-366 ] patch to grow pdf_mem
	dynamically
Message-ID: <E1DifnW-00078n-00@sarovar.org>

Patches item #366, was opened at 2005-06-15 23:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106

Category: Memory allocation
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: patch to grow pdf_mem dynamically

Initial Comment:
experimental patch, pdf_mem_size from texmf.cnf would
be ignored then.

10000 < pdf_mem_size < 10000000 (arbitrary upper limit,
was 524288)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106
From vit.zyka at seznam.cz  Thu Jun 16 01:18:21 2005
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Thu Jun 16 01:17:11 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
In-Reply-To: <Pine.LNX.4.61.0506151945570.4140@hahepc1.hahe>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0506151945570.4140@hahepc1.hahe>
Message-ID: <42B0B73D.2080202@seznam.cz>

Hartmut Henkel wrote:
> On Wed, 15 Jun 2005, Martin Schr?der wrote:
> 
>>src/pdftex-1.30.0-beta-20050615.zip should be on sarovar.
> 
>>pdfTeX 3.141592-1.30.0 was released on 2005-06-??
>>-------------------------------------------------

What about this one?

Vit Zyka wrote:
 >> I think it is pdftex drawback. It declasses xform transformations. 
In >> this case the solution should be easy: identical /Matrix should be
 >> (according to spec) default. So I would not write
 >> /Matrix [1 0 0 1 0 0] into XObject dict at all.

 > makes sense and sounds doable (inclusion is on martins plate, so ...)
 > Hans

vit

From martin at oneiros.de  Thu Jun 16 01:41:48 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 16 07:53:39 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
Message-ID: <20050615234147.GB26344@lucien.kn-bremen.de>

On 2005-06-15 19:51:26 +0200, Heiko Oberdiek wrote:
> It mixes escaping for PDF *strings* with escaping for PDF *names*.
> '(', ')', '\\' are escaped for PDF strings,
> control characters are escaped for PDF names.
> 
> Thus I suggest to change the control character escaping from
> hexadecimal #xx to octal \ooo:
> 
>             sprintf (buf, "\\%03o", (unsigned int)(unsigned char)in[i]);
>             out[j++] = buf[0];
>             out[j++] = buf[1];
>             out[j++] = buf[2];
>             out[j++] = buf[3];
> 
> Then \pdfescapestring could be used for conversions to pdf strings.
> 
> Also a \pdfescapename / convertStringToPDFName is useful. Here
> especially the delimiter characters must be escaped in the
> #xx manner.

Thanks, will do.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Thu Jun 16 14:43:02 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 16 14:49:17 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-306 ] cmap: unicode ???? is mapped to
	multiple glyphs
Message-ID: <E1Diti2-0002pP-00@sarovar.org>

Bugs item #306, was opened at 2005-03-05 17:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=306&group_id=106

Category: Fonts
Group: v1.21a
>Status: Closed
>Resolution: Fixed
Priority: 5
Submitted By: Peter Dyballa (ballapete)
Assigned to: Hartmut Henkel (hhenkel)
Summary: cmap: unicode ???? is mapped to multiple glyphs

Initial Comment:
I created symlinks from the Lucida fonts that come with Java runtime 
and I created from them TFM files with ttf2tfm version 1.5, and also a 
map file fragment and FD files. When I access LucidaSans-Oblique 
pdfeTeX, Version 3.141592-1.21a-2.2 (Web2C 7.5.4) reports this:

Error: pdflatex (file /usr/local/teTeX/share/texmf.local/fonts/truetype/
lucida/llsro8a.ttf): cmap: unicode 2010 is mapped to multiple glyphs
 ==> Fatal error occurred, the output PDF file is not finished!

U+2010 is HYPHEN


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-06-16 14:43

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.0

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-12 17:08

Message:
Logged In: YES 
user_id=421

What's the state of this?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=306&group_id=106
From noreply at sarovar.org  Thu Jun 16 14:43:19 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 16 14:49:25 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-311 ] Dangling font objects with
	non-replacable fonts
Message-ID: <E1DitiJ-0002pa-00@sarovar.org>

Bugs item #311, was opened at 2005-03-20 22:00
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=311&group_id=106

Category: PDF inclusion
Group: v1.21a
>Status: Closed
>Resolution: Fixed
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: Dangling font objects with non-replacable fonts

Initial Comment:
If a PDF file with a non-replacable font (e. g. a
non-embedded standard-14 font, or a TrueType font) is
included into another PDF file, there is an
unused/dangling fontfile stream object generated.

Details, rough patch, test files see attached patch.tgz.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-06-16 14:43

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.0

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-03-20 22:31

Message:
Logged In: YES 
user_id=929

Ooops, problem affects only Type-1 fonts, as the copyFont()
function else returns already before calling
lookup_fontmap(). Patch unchanged.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=311&group_id=106
From noreply at sarovar.org  Thu Jun 16 14:45:05 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 16 14:51:08 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-320 ] \textcolor
Message-ID: <E1Ditk1-0002pz-00@sarovar.org>

Bugs item #320, was opened at 2005-03-28 05:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=320&group_id=106

Category: None
Group: v1.21a
Status: Open
>Resolution: Postponed
Priority: 5
Submitted By: Aleks Kleyn (aleks_kleyn)
Assigned to: Nobody (None)
Summary: \textcolor

Initial Comment:
I want to change color of text using comand \textcolor
{blue}. However when text flows from one page to 
another the color resets to standard on the next 
page. 
Initially I beleived that this problem of pdf. 
However I 
tried today latex.exe and then converted dvi to pdf. 
I got 
effect that I expected: text had on both pages the 
same 
color. However using of pdflatex is more better 
because 
it prepares bookmarks for pdf.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-06-16 14:45

Message:
Logged In: YES 
user_id=421

The cause is a missing colour stack of pdfTeX; this is a
known problem (and more properly a feature request).

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=320&group_id=106
From noreply at sarovar.org  Thu Jun 16 14:47:36 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 16 14:53:58 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-362 ] pdfobj produces extra /Filter for
	object streams with own filter
Message-ID: <E1DitmS-0002qT-00@sarovar.org>

Bugs item #362, was opened at 2005-06-02 12:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=362&group_id=106

Category: None
Group: v1.21a
>Status: Closed
>Resolution: Rejected
Priority: 5
Submitted By: Jens Elstner (daguy)
Assigned to: Nobody (None)
Summary: pdfobj produces extra /Filter for object streams with own filter

Initial Comment:
When I use the following code with pdftex and 
activated compression

\pdfcompresslevel=9
\pdfobj stream%
attr{/Filter/ASCIIHexDecode/FunctionType 0/Encode[0 
255]/BitsPerSample 8/Domain[0 1]/Size[2]/Range[0 1 0 1 
0 1 0 1]/Decode[0 1 0 1 0 1 0 1]}%
{00000000FFFFFFFF}%  output tint function

The generated pdf file contains the object as shown 
below

3 0 obj <<
/Filter/ASCIIHexDecode/FunctionType 0/Encode[0 
255]/BitsPerSample 8/Domain[0 1]/Size[2]/Range[0 1 0 1 
0 1 0 1]/Decode[0 1 0 1 0 1 0 1]
/Length 17        
/Filter /FlateDecode
>>
stream
x?30?'7'c
endobj

The compression added an extra /Filter line and 
produces an error or does not work the way it was 
intended anymore.

Proposed fix for this would be to check the <attr-
spec> for /Filter and omit any compression if a user 
filter function is present already.

Yours sincerely,

Jens Elstner

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-06-16 14:47

Message:
Logged In: YES 
user_id=421

This is a (mis)feature of pdftex; pdftex does not scan the
<attr-spec>.

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-06-02 14:52

Message:
Logged In: YES 
user_id=1276

Hello,

not a fix, just a workaround:

\begingroup
  \pdfcompresslevel=0 % then pdfTeX does not
                      % add /Filter itself
  \immediate\pdfobj stream attr{/Filter/...}{...}\relax
\endgroup

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=362&group_id=106
From martin at oneiros.de  Thu Jun 16 14:42:36 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 16 15:06:44 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
In-Reply-To: <42B0B73D.2080202@seznam.cz>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0506151945570.4140@hahepc1.hahe>
	<42B0B73D.2080202@seznam.cz>
Message-ID: <20050616124235.GA32396@lucien.kn-bremen.de>

On 2005-06-16 01:18:21 +0200, Vit Zyka wrote:
> What about this one?
> 
> Vit Zyka wrote:
> >> I think it is pdftex drawback. It declasses xform transformations. 
> In >> this case the solution should be easy: identical /Matrix should be
> >> (according to spec) default. So I would not write
> >> /Matrix [1 0 0 1 0 0] into XObject dict at all.
> 
> > makes sense and sounds doable (inclusion is on martins plate, so ...)
> > Hans

Fixed; now the /Matrix entry is only written when the image is
rotated (i.e. when it's not the identity matrix).

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Thu Jun 16 14:44:16 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 16 15:06:45 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050615234147.GB26344@lucien.kn-bremen.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
	<20050615234147.GB26344@lucien.kn-bremen.de>
Message-ID: <20050616124416.GB32396@lucien.kn-bremen.de>

On 2005-06-16 01:41:48 +0200, Martin Schr?der wrote:
> On 2005-06-15 19:51:26 +0200, Heiko Oberdiek wrote:
> > Then \pdfescapestring could be used for conversions to pdf strings.
> > 
> > Also a \pdfescapename / convertStringToPDFName is useful. Here
> > especially the delimiter characters must be escaped in the
> > #xx manner.
> 
> Thanks, will do.

Fixed in the new beta; it also has \pdfescapename/\pdflastescapedname.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Thu Jun 16 15:04:39 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 16 15:09:24 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-359 ] pdftex generates errors when it
	does not have to - eg \pdfinfo
In-Reply-To: <20050531084300.GF2519@monty.localnet>
References: <E1DcoeA-0001gK-00@sarovar.org>
	<20050531084300.GF2519@monty.localnet>
Message-ID: <20050616130439.GD32396@lucien.kn-bremen.de>

On 2005-05-31 15:43:00 +0700, The Thanh Han wrote:
> On Mon, May 30, 2005 at 11:35:54PM +0530, noreply@sarovar.org wrote:
> > Suppose the semantics of \pdfinfo were something like:
> >   \pdfinfo{ ... }
> >   Stores information that is written to the PDF file,
> >   if pdftex generates a PDF file.  Otherwise ignored.
> > 
> > Then the error that prompted this thread would not have
> > occurred.
> 
> sounds like a good solution. It will fixed in next
> release.

It isn't now. Can all \pdf primitives be ignored in dvi-mode?

Currently we have
    check_pdfoutput("\pdfannot");
    check_pdfoutput("\pdfcatalog");
    check_pdfoutput("\pdfdest");
    check_pdfoutput("\pdfendlink");
    check_pdfoutput("\pdfendthread");
    check_pdfoutput("\pdffontattr");
    check_pdfoutput("\pdfincludechars");
    check_pdfoutput("\pdfliteral");
    check_pdfoutput("\pdfmapfile");
    check_pdfoutput("\pdfmapline");
    check_pdfoutput("\pdfnames");
    check_pdfoutput("\pdfobj");
    check_pdfoutput("\pdfoutline");
    check_pdfoutput("\pdfrefobj");
    check_pdfoutput("\pdfrefxform");
    check_pdfoutput("\pdfrefximage");
    check_pdfoutput("\pdfsavepos");
    check_pdfoutput("\pdfstartlink");
    check_pdfoutput("\pdfstartthread");
    check_pdfoutput("\pdfthread");
    check_pdfoutput("\pdftrailer");
    check_pdfoutput("\pdfxform");
    check_pdfoutput("\pdfximage");

\pdfinfo and  \pdfcatalog are the simple cases. :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Thu Jun 16 16:00:11 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 16 16:06:07 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-367 ] Using hypertex
Message-ID: <E1Diuuh-0005vV-00@sarovar.org>

Bugs item #367, was opened at 2005-06-16 14:00
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=367&group_id=106

Category: None
Group: v1.21a
Status: Open
Resolution: None
Priority: 5
Submitted By: Aleks Kleyn (aleks_kleyn)
Assigned to: Nobody (None)
Summary: Using hypertex

Initial Comment:
This bug appeared after May or April installation of 
MikTeX. I use AmsArt class together with hyperTeX 
package. However when I click bookmark or any \ref in 
document I do not go to appropriate place in text. 
When I use latex.exe and then convert dvi to pdf I 
get pdf file where \ref works as I expect, but I 
cannot create this way bookmarks.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=367&group_id=106
From martin at oneiros.de  Thu Jun 16 21:57:20 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 16 21:59:28 2005
Subject: [NTG-pdftex] 1.30.0-rc1
In-Reply-To: <20050615161920.GF21214@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
Message-ID: <20050616195720.GA4215@lucien.kn-bremen.de>

http://sarovar.org/download.php/637/pdftex-1.30.0-rc1.zip

Here's a beta of the release announcement:
--------------------------
The pdfTeX team is happy to announce the release of a new stable version:

===========================================================================
                           pdfTeX 1.30.0-rc1
===========================================================================

This is the announcement of pdfTeX 1.30.0-rc1, an extended version of TeX that
can create PDF directly from TeX source files and enhance the result of TeX
typesetting with the help of PDF.

===========================================================================
  Main changes of pdfTeX 1.30.0-rc1
===========================================================================

- pdfxtex (introduced with 1.20a) is gone; all extensions are now in
  pdf(e)tex.
- Some primitives have been renamed; the old names will still work, but are
  deprecated and give a warning that they are obsolete:
    \pdfoptionpdfminorversion         -> \pdfminorversion
    \pdfoptionalwaysusepdfpagebox     -> \pdfforcepagebox
    \pdfoptionpdfinclusionerrorlevel  -> \pdfinclusionerrorlevel
- pdftex knows two new units:
  - new Didot (1nd=0.375mm)
  - new Cicero (1nc=12nd)
- Inclusion of pngs has been greatly improved: It now does
  - alpha channel and transparency (only if %!PDF >=1.4)
  - 16-bit colour (only if %!PDF >=1.5); this must be enabled by setting
    \pdfimagehicolor to 1.
  - gamma correction; this must be enabled by setting \pdfimageapplygamma
    to 1.  The device gamma is taken from \pdfgamma. If no embedded value
    can be found in the png image, then the value of \pdfimagegamma is used
    instead.
  - fast direct embedding of png streams, if their structure allows this;
    the automatic fall-back is to decompress and re-compress as before.
- New primitives: pdfTeX now has an interface to the precise system time
  (if available) as an aid in benchmarking TeX macro code. 
  - \elapsedtime is a read-only integer that (initially) returns the amount
    of time passed since the start of this run. This amount is given in
    `scaled seconds': the value 65536 counts as one second. If more time
    has passed than 32767 seconds, (2^31)-1 will be returned.
  - \resettime updates the internal timer, such that subsequent calls to
    \elapsedtime will restart from 0.
- New primitive \pdfxformname <object number>, which expands to the number
  in the corresponding form XObject name.
- New primitives \leftmarginkern <box number> and \rightmarginkern <box
  number> that tell the margin kern at the left and right side of the
  horizontal list stored in box <box number>.
- New primitive \pdfpkmode, which is a token register that sets the MF mode for
  pixel font generation. The contents of this register is dumped into the
  format, so one can (optionally) preset it e.g. in part of
  pdftexconfig.tex.
- The effects of font expansion can now be logged:
  There is now a new integer variable \pdftracingfonts. It is zero by
  default, then we get a log (with fontexpansion) like this
  ...\tenrm t
  ...\tenrm (+20) e
  Without font expansion, this default should be compatible with TeX's
  original log output.
  If \pdftracingfonts is set to 1 (or greater), we get a more verbose log:
  ...\xivtt (cmtt10@14.0pt) t
  ...\xivtt (cmtt10+20@14.0pt) e
  See also bug 304.
- Numerous bugfixes

For complete release notes see http://www.pdftex.org/NEWS

===========================================================================
  Legal notice / license
===========================================================================

pdfTeX is copyright (c) 1996-2005 Han The Thanh, <thanh@pdftex.org>

pdfTeX is free software; you can redistribute it and/or modify it under the
terms of the GNU General Public License as published by the Free Software
Foundation; either version 2 of the License, or (at your option) any later
version.

For a complete README (with a full discussion of the license)
please look at http://www.pdftex.org/README

===========================================================================
  The files / installation
===========================================================================

You should first try to get a new version of pdfTeX through your
distribution.

If you want to compile it yourself, have a look at http://www.pdftex.org --
there you can find links to the pdfTeX sources on CTAN and precompiled
binaries for most operating systems. And some useful documentation. 

===========================================================================
  Mailing lists / web pages:
===========================================================================

  Mailing list:
    http://tug.org/mailman/listinfo/pdftex

  Related web pages:
    http://www.pdftex.org
    http://sarovar.org/projects/pdftex/
    http://www.tug.org/tex-live/
    http://www.tug.org/tetex/
    http://www.tex.ac.uk/cgi-bin/texfaq2html?introduction=yes
    http://www.dante.de/
    http://tug.org/
    http://www.pragma-ade.com/

Have fun!
--------------------------

Now we have to update the manual...

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From hanthethanh at myrealbox.com  Thu Jun 16 13:50:46 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Fri Jun 17 10:10:03 2005
Subject: [NTG-pdftex] \pdfretval vs. expandable \pdfstrcmp
In-Reply-To: <20050615184147.GA15222@m0A0232EA.vpn.uni-freiburg.de>
References: <20050615184147.GA15222@m0A0232EA.vpn.uni-freiburg.de>
Message-ID: <20050616115046.GA2554@monty.localnet>

the reason is the same like in case of \pdfescapestr: I
don't know tex the program well enough to make them
expandable, so just made a quick hack to get it work. Anyone
willing to improve them is welcome very much.

Regards,
Thanh

On Wed, Jun 15, 2005 at 08:41:48PM +0200, Heiko Oberdiek wrote:
> Hello,
> 
> is there a reason why \pdfstrcmp is not expandable?
> An expandable variant could be used in expandable contexts:
>   \ifcase\numexpr\pdfstrcmp{StringA}{StringB}+1\relax
>   ...\or ...\or ...\fi
> Inserting into a sorted linear list could be done in O(n):
>   \edef\mylist{\addtolist\mylist{foo}}%
> Now it is O(n^2) :-(
> 
> Yours sincerely
>   Heiko <oberdiek@uni-freiburg.de>
> -- 
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex@ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex
> 
From taco at elvenkind.com  Fri Jun 17 11:36:37 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri Jun 17 11:36:45 2005
Subject: [NTG-pdftex] 1.30.0-rc1
In-Reply-To: <20050616195720.GA4215@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
Message-ID: <42B299A5.2030305@elvenkind.com>


Mart,

It seems that pdfetex is broken (it is not etex) in this beta?


   [taco@hal tmp]$ pdfetex -ini *plain
   This is pdfeTeX, Version 3.141592-1.21b-2.2 (Web2C 7.5.4) (INITEX)
    \write18 enabled.
   entering extended mode

   [taco@glenlivet context]$ pdftex -ini *plain
   This is pdfTeXk, Version 3.141592-1.30.0-beta-rc1 (Web2C 7.5.4) (INITEX)
    %&-line parsing enabled.
   ! I can't find file `*plain'.
   <*> *plain

PANIC!

Taco


Martin Schr?der wrote:
> http://sarovar.org/download.php/637/pdftex-1.30.0-rc1.zip
> 
> Here's a beta of the release announcement:
> --------------------------
> The pdfTeX team is happy to announce the release of a new stable version:
> 
> ===========================================================================
>                            pdfTeX 1.30.0-rc1
> ===========================================================================
> 
> This is the announcement of pdfTeX 1.30.0-rc1, an extended version of TeX that
> can create PDF directly from TeX source files and enhance the result of TeX
> typesetting with the help of PDF.
> 
> ===========================================================================
>   Main changes of pdfTeX 1.30.0-rc1
> ===========================================================================
> 
> - pdfxtex (introduced with 1.20a) is gone; all extensions are now in
>   pdf(e)tex.
> - Some primitives have been renamed; the old names will still work, but are
>   deprecated and give a warning that they are obsolete:
>     \pdfoptionpdfminorversion         -> \pdfminorversion
>     \pdfoptionalwaysusepdfpagebox     -> \pdfforcepagebox
>     \pdfoptionpdfinclusionerrorlevel  -> \pdfinclusionerrorlevel
> - pdftex knows two new units:
>   - new Didot (1nd=0.375mm)
>   - new Cicero (1nc=12nd)
> - Inclusion of pngs has been greatly improved: It now does
>   - alpha channel and transparency (only if %!PDF >=1.4)
>   - 16-bit colour (only if %!PDF >=1.5); this must be enabled by setting
>     \pdfimagehicolor to 1.
>   - gamma correction; this must be enabled by setting \pdfimageapplygamma
>     to 1.  The device gamma is taken from \pdfgamma. If no embedded value
>     can be found in the png image, then the value of \pdfimagegamma is used
>     instead.
>   - fast direct embedding of png streams, if their structure allows this;
>     the automatic fall-back is to decompress and re-compress as before.
> - New primitives: pdfTeX now has an interface to the precise system time
>   (if available) as an aid in benchmarking TeX macro code. 
>   - \elapsedtime is a read-only integer that (initially) returns the amount
>     of time passed since the start of this run. This amount is given in
>     `scaled seconds': the value 65536 counts as one second. If more time
>     has passed than 32767 seconds, (2^31)-1 will be returned.
>   - \resettime updates the internal timer, such that subsequent calls to
>     \elapsedtime will restart from 0.
> - New primitive \pdfxformname <object number>, which expands to the number
>   in the corresponding form XObject name.
> - New primitives \leftmarginkern <box number> and \rightmarginkern <box
>   number> that tell the margin kern at the left and right side of the
>   horizontal list stored in box <box number>.
> - New primitive \pdfpkmode, which is a token register that sets the MF mode for
>   pixel font generation. The contents of this register is dumped into the
>   format, so one can (optionally) preset it e.g. in part of
>   pdftexconfig.tex.
> - The effects of font expansion can now be logged:
>   There is now a new integer variable \pdftracingfonts. It is zero by
>   default, then we get a log (with fontexpansion) like this
>   ...\tenrm t
>   ...\tenrm (+20) e
>   Without font expansion, this default should be compatible with TeX's
>   original log output.
>   If \pdftracingfonts is set to 1 (or greater), we get a more verbose log:
>   ...\xivtt (cmtt10@14.0pt) t
>   ...\xivtt (cmtt10+20@14.0pt) e
>   See also bug 304.
> - Numerous bugfixes
> 
> For complete release notes see http://www.pdftex.org/NEWS
> 
> ===========================================================================
>   Legal notice / license
> ===========================================================================
> 
> pdfTeX is copyright (c) 1996-2005 Han The Thanh, <thanh@pdftex.org>
> 
> pdfTeX is free software; you can redistribute it and/or modify it under the
> terms of the GNU General Public License as published by the Free Software
> Foundation; either version 2 of the License, or (at your option) any later
> version.
> 
> For a complete README (with a full discussion of the license)
> please look at http://www.pdftex.org/README
> 
> ===========================================================================
>   The files / installation
> ===========================================================================
> 
> You should first try to get a new version of pdfTeX through your
> distribution.
> 
> If you want to compile it yourself, have a look at http://www.pdftex.org --
> there you can find links to the pdfTeX sources on CTAN and precompiled
> binaries for most operating systems. And some useful documentation. 
> 
> ===========================================================================
>   Mailing lists / web pages:
> ===========================================================================
> 
>   Mailing list:
>     http://tug.org/mailman/listinfo/pdftex
> 
>   Related web pages:
>     http://www.pdftex.org
>     http://sarovar.org/projects/pdftex/
>     http://www.tug.org/tex-live/
>     http://www.tug.org/tetex/
>     http://www.tex.ac.uk/cgi-bin/texfaq2html?introduction=yes
>     http://www.dante.de/
>     http://tug.org/
>     http://www.pragma-ade.com/
> 
> Have fun!
> --------------------------
> 
> Now we have to update the manual...
> 
> Best
>     Martin
From jackos1 at poczta.onet.pl  Fri Jun 17 14:04:32 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jun 17 14:05:19 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
In-Reply-To: <20050614235644.GA2575@monty.localnet>
References: <42AC8D89.7090501@poczta.onet.pl>	<Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>	<20050612225219.GA27130@lucien.kn-bremen.de>	<42AE4A3B.90807@wxs.nl>
	<20050614235644.GA2575@monty.localnet>
Message-ID: <42B2BC50.5000507@poczta.onet.pl>

Hi,

Hartmut:
>>>>seems it was still in 1.11b, but not anymore in 1.20b, and it also was
>>>>never properly documented, so i would purge all references to it.

Done.

Martin:
>>>Yep. For new primitives We should also mention the version of
>>>pdfTeX when they were introduced.

Yep, will keep new things in this way. Version info should be also added 
to all the primitives not available in version 1.0. What is the easiest 
way to get the entire list of primitive changes? Collecting release notes?

Thanh:
> I introduced this primitive for a job where I need some
> hacking with page breaking and couldn't do that using
> macros. This can be safely removed.

Just a question, in the context of page break, doesn't \outputpenalty do 
this?

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From jackos1 at poczta.onet.pl  Fri Jun 17 14:55:54 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jun 17 14:56:11 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050616124416.GB32396@lucien.kn-bremen.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>	<20050615234147.GB26344@lucien.kn-bremen.de>
	<20050616124416.GB32396@lucien.kn-bremen.de>
Message-ID: <42B2C85A.8010109@poczta.onet.pl>

Hi,

Heiko:
>>Then \pdfescapestring could be used for conversions to pdf strings.
>>Also a \pdfescapename / convertStringToPDFName is useful. Here
>>especially the delimiter characters must be escaped in the
>>#xx manner.

Martin:
> Fixed in the new beta; it also has \pdfescapename/\pdflastescapedname.

I've given a try to describe them in manual (Literals and specials 
chapter). Please look if the description is relevant. What is 
\pdflastescapedname for?

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From taco at elvenkind.com  Fri Jun 17 15:20:51 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri Jun 17 15:20:55 2005
Subject: [NTG-pdftex] 1.30.0-rc1
In-Reply-To: <42B299A5.2030305@elvenkind.com>
References: <20050615161920.GF21214@lucien.kn-bremen.de>	<20050616195720.GA4215@lucien.kn-bremen.de>
	<42B299A5.2030305@elvenkind.com>
Message-ID: <42B2CE33.8020303@elvenkind.com>


Taco Hoekwater wrote:
> 
> Mart,
> 
> It seems that pdfetex is broken (it is not etex) in this beta?

Never mind that, I had a bug in my install script (it had installed
the pdftex executable as 'pdfetex'). :-/

Taco
From martin at oneiros.de  Fri Jun 17 15:31:18 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jun 17 15:32:50 2005
Subject: [NTG-pdftex] 1.30.0-rc1
In-Reply-To: <42B299A5.2030305@elvenkind.com>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<20050616195720.GA4215@lucien.kn-bremen.de>
	<42B299A5.2030305@elvenkind.com>
Message-ID: <20050617133118.GA11983@lucien.kn-bremen.de>

On 2005-06-17 11:36:37 +0200, Taco Hoekwater wrote:
> It seems that pdfetex is broken (it is not etex) in this beta?
> 
> 
>   [taco@hal tmp]$ pdfetex -ini *plain
>   This is pdfeTeX, Version 3.141592-1.21b-2.2 (Web2C 7.5.4) (INITEX)
>    \write18 enabled.
>   entering extended mode
> 
>   [taco@glenlivet context]$ pdftex -ini *plain
>   This is pdfTeXk, Version 3.141592-1.30.0-beta-rc1 (Web2C 7.5.4) (INITEX)
>    %&-line parsing enabled.
>   ! I can't find file `*plain'.
>   <*> *plain

etex(1):

An extended mode format is generated by prefixing the name of the
source file for the format with an asterisk (*).

pdftex is _not_ pdfetex. :-)

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From jackos1 at poczta.onet.pl  Fri Jun 17 16:12:07 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jun 17 16:16:50 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
In-Reply-To: <20050615161920.GF21214@lucien.kn-bremen.de>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
Message-ID: <42B2DA37.4050104@poczta.onet.pl>

Hi again,

> src/pdftex-1.30.0-beta-20050615.zip should be on sarovar.
> Here's the proposed NEWS[...]

On the base of news I've commited revision 602 of the manual, that 
should be more or less up-to-date with 1.3. Please, check it out.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From taco at elvenkind.com  Fri Jun 17 16:35:40 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri Jun 17 16:35:45 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
In-Reply-To: <42B2DA37.4050104@poczta.onet.pl>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<42B2DA37.4050104@poczta.onet.pl>
Message-ID: <42B2DFBC.5070304@elvenkind.com>


Hi,

Not sure if these remarks are for Pawel or (more likely) for
Martin and I assume most are known already, but:

The files http://www.pdftex.org/NEWS and []/README that are
referenced in Annoucement-1.30.0-rc1 are still the ones from
1.21a.

Annoucement is generally spelled as Announcement ;-)

The included INSTALL and README's from the zip are not
up-to-date yet, e.g. they still mention the pdfxtex executable.

Pawel Jackowski wrote:
> 
> On the base of news I've commited revision 602 of the manual, that 
> should be more or less up-to-date with 1.3. Please, check it out.

I'd like to check it out, but I forgot where I can get it from. :-/

Taco

From martin at oneiros.de  Fri Jun 17 15:42:17 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jun 17 18:28:38 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <42B2C85A.8010109@poczta.onet.pl>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
	<20050615234147.GB26344@lucien.kn-bremen.de>
	<20050616124416.GB32396@lucien.kn-bremen.de>
	<42B2C85A.8010109@poczta.onet.pl>
Message-ID: <20050617134217.GB11983@lucien.kn-bremen.de>

On 2005-06-17 14:55:54 +0200, Pawel Jackowski wrote:
> I've given a try to describe them in manual (Literals and specials 
> chapter). Please look if the description is relevant. What is 
> \pdflastescapedname for?

It's like \pdflastescapedstring. Don't know if anybody needs it. :-)
--------------------------------
\pdfcompresslevel=0
\tt
\pdfescapestring {a ( a?)?b}
\pdflastescapedstring

\pdfescapename {a ( a?)?b}
\pdflastescapedname
\bye
--------------------------------

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From hartmut_henkel at gmx.de  Fri Jun 17 20:47:21 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jun 17 20:47:28 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050617134217.GB11983@lucien.kn-bremen.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
	<20050615234147.GB26344@lucien.kn-bremen.de>
	<20050616124416.GB32396@lucien.kn-bremen.de>
	<42B2C85A.8010109@poczta.onet.pl>
	<20050617134217.GB11983@lucien.kn-bremen.de>
Message-ID: <Pine.LNX.4.61.0506172046050.4082@hahepc1.hahe>

On Fri, 17 Jun 2005, Martin Schr?der wrote:

> It's like \pdflastescapedstring. Don't know if anybody needs it. :-)
> --------------------------------
> \pdfcompresslevel=0
> \tt
> \pdfescapestring {a ( a?)?b}
> \pdflastescapedstring

here i get

(a\134040\134\050\134040a\134344\134\051\134337b)

is this right? aren't there a few backslashes missing?

> \pdfescapename {a ( a?)?b}
> \pdflastescapedname
> \bye

Regards, Hartmut
From jackos1 at poczta.onet.pl  Fri Jun 17 20:47:59 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jun 17 20:49:05 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050617134217.GB11983@lucien.kn-bremen.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>	<20050615234147.GB26344@lucien.kn-bremen.de>	<20050616124416.GB32396@lucien.kn-bremen.de>	<42B2C85A.8010109@poczta.onet.pl>
	<20050617134217.GB11983@lucien.kn-bremen.de>
Message-ID: <42B31ADF.70604@poczta.onet.pl>

Hi,

>>I've given a try to describe them in manual (Literals and specials 
>>chapter). Please look if the description is relevant. What is 
>>\pdflastescapedname for?
> 
> It's like \pdflastescapedstring. Don't know if anybody needs it. :-)

Aghh, it seems I've missundestood the usage of the command. Sorry, at
the moment I can't try it out. So, \pdfescape... commands do NOT expand
things on fly (that would be to nice :), just stores the expansion in
\pdflastescaped... right? If so, I'd insist on using `lastescape'
instead of `lastescaped', to keep naming convention consistent. How do
you think?

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl

From hartmut_henkel at gmx.de  Fri Jun 17 21:05:30 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jun 17 21:05:34 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <Pine.LNX.4.61.0506172046050.4082@hahepc1.hahe>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
	<20050615234147.GB26344@lucien.kn-bremen.de>
	<20050616124416.GB32396@lucien.kn-bremen.de>
	<42B2C85A.8010109@poczta.onet.pl>
	<20050617134217.GB11983@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0506172046050.4082@hahepc1.hahe>
Message-ID: <Pine.LNX.4.61.0506172103280.4157@hahepc1.hahe>

On Fri, 17 Jun 2005, Hartmut Henkel wrote:

> On Fri, 17 Jun 2005, Martin Schr?der wrote:
>
> > It's like \pdflastescapedstring. Don't know if anybody needs it. :-)
> > --------------------------------
> > \pdfcompresslevel=0
> > \tt
> > \pdfescapestring {a ( a?)?b}
> > \pdflastescapedstring
>
> here i get
>
> (a\134040\134\050\134040a\134344\134\051\134337b)

in utils.c, convertStringToPDFString (), maybe line

        check_buf(j + sizeof(buf), MAX_PSTRING_LEN);

should be

        check_buf(j + sizeof(out), MAX_PSTRING_LEN);

Regards, Hartmut
From hartmut_henkel at gmx.de  Fri Jun 17 21:07:57 2005
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Fri Jun 17 21:08:01 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <Pine.LNX.4.61.0506172103280.4157@hahepc1.hahe>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
	<20050615234147.GB26344@lucien.kn-bremen.de>
	<20050616124416.GB32396@lucien.kn-bremen.de>
	<42B2C85A.8010109@poczta.onet.pl>
	<20050617134217.GB11983@lucien.kn-bremen.de>
	<Pine.LNX.4.61.0506172046050.4082@hahepc1.hahe>
	<Pine.LNX.4.61.0506172103280.4157@hahepc1.hahe>
Message-ID: <Pine.LNX.4.61.0506172107300.4268@hahepc1.hahe>

On Fri, 17 Jun 2005, Hartmut Henkel wrote:

> in utils.c, convertStringToPDFString (), maybe line
>
>         check_buf(j + sizeof(buf), MAX_PSTRING_LEN);
>
> should be
>
>         check_buf(j + sizeof(out), MAX_PSTRING_LEN);

nonsense. sorry for noise.

Regards, Hartmut
From jackos1 at poczta.onet.pl  Fri Jun 17 23:25:01 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Fri Jun 17 23:26:00 2005
Subject: [NTG-pdftex] 1.30.0-beta-20050615
In-Reply-To: <42B2DFBC.5070304@elvenkind.com>
References: <20050615161920.GF21214@lucien.kn-bremen.de>
	<42B2DA37.4050104@poczta.onet.pl> <42B2DFBC.5070304@elvenkind.com>
Message-ID: <42B33FAD.4080108@poczta.onet.pl>

Hi Taco,

>> On the base of news I've commited revision 602 of the manual, that 
>> should be more or less up-to-date with 1.3. Please, check it out.
> 
> I'd like to check it out, but I forgot where I can get it from. :-/

I just use pawel@cvs.pdftex.sarovar.org:/cvsroot/pdftex checkout path to 
get the manual sources and don't know where they are exactly. Anyway, 
there is nothing to check at the moment since its damaged rather than 
updated %( Sorry, I will correct this mess just after \pdfescape... 
things are clear.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From noreply at sarovar.org  Sat Jun 18 00:29:25 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jun 18 00:35:25 2005
Subject: [NTG-pdftex] [ pdftex-Patches-368 ] make \pdfstrcmp expandable
	(experimental patch)
Message-ID: <E1DjPL3-00075d-00@sarovar.org>

Patches item #368, was opened at 2005-06-18 00:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106

Category: Primitives
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: make \pdfstrcmp expandable (experimental patch)

Initial Comment:
just moved \pdfstrcmp over to procedure conv_toks, so
that the result -1/0/1 is inserted into the input token
list. Does this make sense?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106
From oberdiek at uni-freiburg.de  Sat Jun 18 16:17:58 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Sat Jun 18 16:17:49 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050617134217.GB11983@lucien.kn-bremen.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>
	<20050615234147.GB26344@lucien.kn-bremen.de>
	<20050616124416.GB32396@lucien.kn-bremen.de>
	<42B2C85A.8010109@poczta.onet.pl>
	<20050617134217.GB11983@lucien.kn-bremen.de>
Message-ID: <20050618141758.GA2678@m0A0232EA.vpn.uni-freiburg.de>

On Fri, Jun 17, 2005 at 03:42:17PM +0200, Martin Schr?der wrote:

> On 2005-06-17 14:55:54 +0200, Pawel Jackowski wrote:
> > I've given a try to describe them in manual (Literals and specials 
> > chapter). Please look if the description is relevant. What is 
> > \pdflastescapedname for?
> 
> It's like \pdflastescapedstring. Don't know if anybody needs it. :-)

I do.
Example mimetype of embedded file streams:
  /Type /EmbeddedFile
  /Subtype /... % mimetype encoded as name object.

"..." is arbitrary user data, especially slashes and spaces
can occur inside. Unencoded such characters break the
validity of the dictionary object.

Also names have an implementation limit of 127 bytes,
thus \pdfescapename can be used here, of course after
fixing the bug of unescaped delimiter characters, I
am working on it.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From jackos1 at poczta.onet.pl  Sat Jun 18 18:54:53 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sat Jun 18 18:55:05 2005
Subject: [NTG-pdftex] \pdfescapestring/convertStringToPDFString
In-Reply-To: <20050618141758.GA2678@m0A0232EA.vpn.uni-freiburg.de>
References: <20050615175125.GA14638@m0A0232EA.vpn.uni-freiburg.de>	<20050615234147.GB26344@lucien.kn-bremen.de>	<20050616124416.GB32396@lucien.kn-bremen.de>	<42B2C85A.8010109@poczta.onet.pl>	<20050617134217.GB11983@lucien.kn-bremen.de>
	<20050618141758.GA2678@m0A0232EA.vpn.uni-freiburg.de>
Message-ID: <42B451DD.3010409@poczta.onet.pl>

Hi,

Martin:
>>It's like \pdflastescapedstring. Don't know if anybody needs it. :-)

Heiko:
> I do.
> Example mimetype of embedded file streams[...]

I like the idea of \pdfescape very much either. I use such commands in 
many other cases, such as special color spaces (i.e. 
/PANTONE#20231#20CV) or optional content (i.e << /Type /OCG /Name 
(Layer\(1\)) >>). A `hand-made' implementation of those command is not a 
horror, but primitives provides it in more general way and obviously 
much faster.

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From noreply at sarovar.org  Sat Jun 18 19:00:51 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jun 18 19:06:49 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-369 ] Bug fix for \pdfescapename and
	\pdfescapestring
Message-ID: <E1Djggd-0003mv-00@sarovar.org>

Bugs item #369, was opened at 2005-06-18 19:00
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=369&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Bug fix for \pdfescapename and \pdfescapestring

Initial Comment:
Hello,

the attached patch is based on pdftex-1.30.0-rc1.

It fixes the following problems with
\pdfescapename and \pdfescapestring:

* In both cases zero data bytes result in truncated
strings,
  because the length is measured by "strlen".
  This is fixed by adding a length parameter to the
  string conversion functions, see utils.c: escapestr()
  and escapename().

* \pdfescapename:
  * delimiter character must be escaped, too.
  * zero byte is ignored, see specification.
  * documentation: specification added for
    convertStringToPDFName() in utils.c

Patched files:
  * utils.c
      main part of the fix, especially function
      convertStringToPDFName().
  * pdftoepdf.cc, epdf.h, ptexlib.h
      because of changed signature of
convertStringToPDFString()

Patch is applied by
  patch <EscapeNameString.patch
in directory
  src/texk/web2c/pdftexdir

Test files that test the conversion of all characters:
  test-escapename.tex
  test-escapestring.tex

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=369&group_id=106
From noreply at sarovar.org  Mon Jun 20 11:00:26 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 11:06:39 2005
Subject: [NTG-pdftex] [ pdftex-Patches-366 ] patch to grow pdf_mem
	dynamically
Message-ID: <E1DkI8o-0007U7-00@sarovar.org>

Patches item #366, was opened at 2005-06-15 23:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106

Category: Memory allocation
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: patch to grow pdf_mem dynamically

Initial Comment:
experimental patch, pdf_mem_size from texmf.cnf would
be ignored then.

10000 < pdf_mem_size < 10000000 (arbitrary upper limit,
was 524288)

----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 11:00

Message:
Logged In: YES 
user_id=1608

This version looks smart. 
I applied it, but I do not have a lot of documents that need
more than a few words of pdf_mem, so I changed the
compile-time lower limit to 100. Works fine on my test
documents.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106
From noreply at sarovar.org  Mon Jun 20 13:42:32 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 13:48:42 2005
Subject: [NTG-pdftex] [ pdftex-Patches-366 ] patch to grow pdf_mem
	dynamically
Message-ID: <E1DkKfg-0006Bn-00@sarovar.org>

Patches item #366, was opened at 2005-06-16 03:21
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106

Category: Memory allocation
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: patch to grow pdf_mem dynamically

Initial Comment:
experimental patch, pdf_mem_size from texmf.cnf would
be ignored then.

10000 < pdf_mem_size < 10000000 (arbitrary upper limit,
was 524288)

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2005-06-20 17:12

Message:
Logged In: NO 

100 is a bit low, hz etc need it, so maybe 2K makes more sense 

Hans 

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 14:30

Message:
Logged In: YES 
user_id=1608

This version looks smart. 
I applied it, but I do not have a lot of documents that need
more than a few words of pdf_mem, so I changed the
compile-time lower limit to 100. Works fine on my test
documents.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106
From noreply at sarovar.org  Mon Jun 20 15:10:35 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 15:16:49 2005
Subject: [NTG-pdftex] [ pdftex-Patches-366 ] patch to grow pdf_mem
	dynamically
Message-ID: <E1DkM2t-0001Uc-00@sarovar.org>

Patches item #366, was opened at 2005-06-15 23:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106

Category: Memory allocation
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: patch to grow pdf_mem dynamically

Initial Comment:
experimental patch, pdf_mem_size from texmf.cnf would
be ignored then.

10000 < pdf_mem_size < 10000000 (arbitrary upper limit,
was 524288)

----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 15:10

Message:
Logged In: YES 
user_id=1608

I was not seriously suggesting to change the default value
to 100, I just had to do something to get the new code doing
stuff. It is not obvious to me what macros I should use to
fill up pdf_mem quickly :-)


----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2005-06-20 13:42

Message:
Logged In: NO 

100 is a bit low, hz etc need it, so maybe 2K makes more sense 

Hans 

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 11:00

Message:
Logged In: YES 
user_id=1608

This version looks smart. 
I applied it, but I do not have a lot of documents that need
more than a few words of pdf_mem, so I changed the
compile-time lower limit to 100. Works fine on my test
documents.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=366&group_id=106
From noreply at sarovar.org  Mon Jun 20 16:33:05 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 16:39:13 2005
Subject: [NTG-pdftex] [ pdftex-Patches-368 ] make \pdfstrcmp expandable
	(experimental patch)
Message-ID: <E1DkNKj-0004sj-00@sarovar.org>

Patches item #368, was opened at 2005-06-18 00:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106

Category: Primitives
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: make \pdfstrcmp expandable (experimental patch)

Initial Comment:
just moved \pdfstrcmp over to procedure conv_toks, so
that the result -1/0/1 is inserted into the input token
list. Does this make sense?

----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 16:33

Message:
Logged In: YES 
user_id=1608

It makes sense, but it is not 100% safe as-is. In an
expanding context, lots of stuff can go one at the same
time. Esp., scan_toks touches some global variables, so
compare_strings should save the globals def_ref,
scanner_status and warning _index to prevent stack
corruption later on.

For instance, this crashes:

% process by initex
\input plain
\edef\alpha{\pdfstrcmp{alpha}{alph}}
\message{\meaning\alpha}
\end
%

I am attaching a change file that modifies compare_strings()
, cf. scan_general_text() in eTeX.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106
From noreply at sarovar.org  Mon Jun 20 17:02:48 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 17:09:03 2005
Subject: [NTG-pdftex] [ pdftex-Patches-368 ] make \pdfstrcmp expandable
	(experimental patch)
Message-ID: <E1DkNnU-0006Ad-00@sarovar.org>

Patches item #368, was opened at 2005-06-18 00:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106

Category: Primitives
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: make \pdfstrcmp expandable (experimental patch)

Initial Comment:
just moved \pdfstrcmp over to procedure conv_toks, so
that the result -1/0/1 is inserted into the input token
list. Does this make sense?

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-06-20 17:02

Message:
Logged In: YES 
user_id=1276

Hello,

Taco I agree with your analysis, last weekend
I found the same variables that need saving, too.

Also I have a patch that also make \pdfescape*
expandable. Thus \pdflastescaped* are not needed
anymore.
 And I could remove the dependency
on a limited buffer by copying the destination
strings directly in the string pool above the
source string.

Third I added \pdfescapehex and \pdfunescapehex
that adds encoding/decoding for hexadecimal strings:
* Strings can also be given as hex strings in
  angle brackets.
* Safe method to store and read string data to
  auxiliary files without worrying about catcodes,
  unmachted curly braces, ...
* Help in handling UTF-8/Unicode or other hex coding
  stuff.

I hope, I can attach the patch here in this thread
(upload part is missing?. Otherwise I will make an
new patch.

Patch is applied by
  patch <EscapeDivers.patch
in directory
  src/texk/web2c/pdftexdir

The Makefile must be modified. After the lines
  $(srcdir)/pdftexdir/tex.pch
the line
  $(srcdir)/pdftexdir/pdfstrcmp.ch
is inserted. This is done two times for pdftex
and pdfetex.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 16:33

Message:
Logged In: YES 
user_id=1608

It makes sense, but it is not 100% safe as-is. In an
expanding context, lots of stuff can go one at the same
time. Esp., scan_toks touches some global variables, so
compare_strings should save the globals def_ref,
scanner_status and warning _index to prevent stack
corruption later on.

For instance, this crashes:

% process by initex
\input plain
\edef\alpha{\pdfstrcmp{alpha}{alph}}
\message{\meaning\alpha}
\end
%

I am attaching a change file that modifies compare_strings()
, cf. scan_general_text() in eTeX.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106
From noreply at sarovar.org  Mon Jun 20 17:11:35 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 17:17:35 2005
Subject: [NTG-pdftex] [ pdftex-Patches-371 ] Expandable \pdfstrcmp,
	\pdfescape*, added \pdf(de)escapehex
Message-ID: <E1DkNvz-0006pt-00@sarovar.org>

Patches item #371, was opened at 2005-06-20 17:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=371&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Expandable \pdfstrcmp, \pdfescape*, added \pdf(de)escapehex

Initial Comment:
Hello,

the result of last weekend is a patch that
makes \pdfstrcmp (based on Harmut's work)
and the \pdfescape* commands expandable.
Thus \pdflastescaped* are not needed
anymore.
 I could remove the dependency
on a limited buffer by copying the destination
strings directly in the string pool above the
source string.
  Also the patch adds the fixes of bug 369.

Fourth I add \pdfescapehex and \pdfunescapehex
that implements encoding and decoding for
hexadecimal strings:
* Strings can also be given as hex strings in
  angle brackets.
* Safe method to store and read string data to
  auxiliary files without worrying about catcodes,
  unmachted curly braces, ...
* Help in handling UTF-8/Unicode or other hex coding
  stuff.

Patch is applied by
  patch <EscapeDivers.patch
in directory
  src/texk/web2c/pdftexdir

The Makefile needs modifying. After the lines
  $(srcdir)/pdftexdir/tex.pch
the line
  $(srcdir)/pdftexdir/pdfstrcmp.ch
is inserted. This should be done two times for
pdftex and pdfetex.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=371&group_id=106
From noreply at sarovar.org  Mon Jun 20 22:09:30 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 20 22:15:53 2005
Subject: [NTG-pdftex] [ pdftex-Patches-368 ] make \pdfstrcmp expandable
	(experimental patch)
Message-ID: <E1DkSaI-00030H-00@sarovar.org>

Patches item #368, was opened at 2005-06-18 00:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106

Category: Primitives
Group: v1.30.0
>Status: Closed
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: make \pdfstrcmp expandable (experimental patch)

Initial Comment:
just moved \pdfstrcmp over to procedure conv_toks, so
that the result -1/0/1 is inserted into the input token
list. Does this make sense?

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2005-06-20 22:09

Message:
Logged In: YES 
user_id=929

Patch 368 can be closed as an improved version is now
included in patch 371 by Heiko. Many thanks to him and Taco
for debugging!

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-06-20 17:02

Message:
Logged In: YES 
user_id=1276

Hello,

Taco I agree with your analysis, last weekend
I found the same variables that need saving, too.

Also I have a patch that also make \pdfescape*
expandable. Thus \pdflastescaped* are not needed
anymore.
 And I could remove the dependency
on a limited buffer by copying the destination
strings directly in the string pool above the
source string.

Third I added \pdfescapehex and \pdfunescapehex
that adds encoding/decoding for hexadecimal strings:
* Strings can also be given as hex strings in
  angle brackets.
* Safe method to store and read string data to
  auxiliary files without worrying about catcodes,
  unmachted curly braces, ...
* Help in handling UTF-8/Unicode or other hex coding
  stuff.

I hope, I can attach the patch here in this thread
(upload part is missing?. Otherwise I will make an
new patch.

Patch is applied by
  patch <EscapeDivers.patch
in directory
  src/texk/web2c/pdftexdir

The Makefile must be modified. After the lines
  $(srcdir)/pdftexdir/tex.pch
the line
  $(srcdir)/pdftexdir/pdfstrcmp.ch
is inserted. This is done two times for pdftex
and pdfetex.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-06-20 16:33

Message:
Logged In: YES 
user_id=1608

It makes sense, but it is not 100% safe as-is. In an
expanding context, lots of stuff can go one at the same
time. Esp., scan_toks touches some global variables, so
compare_strings should save the globals def_ref,
scanner_status and warning _index to prevent stack
corruption later on.

For instance, this crashes:

% process by initex
\input plain
\edef\alpha{\pdfstrcmp{alpha}{alph}}
\message{\meaning\alpha}
\end
%

I am attaching a change file that modifies compare_strings()
, cf. scan_general_text() in eTeX.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=368&group_id=106
From noreply at sarovar.org  Tue Jun 21 00:02:43 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jun 21 00:08:55 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-367 ] Using hypertex
Message-ID: <E1DkULr-0007ks-00@sarovar.org>

Bugs item #367, was opened at 2005-06-16 16:00
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=367&group_id=106

Category: None
Group: v1.21a
>Status: Closed
>Resolution: Rejected
Priority: 5
Submitted By: Aleks Kleyn (aleks_kleyn)
Assigned to: Nobody (None)
Summary: Using hypertex

Initial Comment:
This bug appeared after May or April installation of 
MikTeX. I use AmsArt class together with hyperTeX 
package. However when I click bookmark or any \ref in 
document I do not go to appropriate place in text. 
When I use latex.exe and then convert dvi to pdf I 
get pdf file where \ref works as I expect, but I 
cannot create this way bookmarks.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-06-21 00:02

Message:
Logged In: YES 
user_id=421

I'm closing this, as it's most likely a hyperref bug.
Anyway please file this with MikTeX if you are sure it's a
bug; but please read 
http://www.chiark.greenend.org.uk/~sgtatham/bugs.html
before bothering anybody again.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=367&group_id=106
From noreply at sarovar.org  Tue Jun 21 00:17:55 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jun 21 00:24:02 2005
Subject: [NTG-pdftex] [ pdftex-Bugs-369 ] Bug fix for \pdfescapename and
	\pdfescapestring
Message-ID: <E1DkUaZ-0008V8-00@sarovar.org>

Bugs item #369, was opened at 2005-06-18 19:00
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=369&group_id=106

Category: None
Group: None
>Status: Closed
>Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Bug fix for \pdfescapename and \pdfescapestring

Initial Comment:
Hello,

the attached patch is based on pdftex-1.30.0-rc1.

It fixes the following problems with
\pdfescapename and \pdfescapestring:

* In both cases zero data bytes result in truncated
strings,
  because the length is measured by "strlen".
  This is fixed by adding a length parameter to the
  string conversion functions, see utils.c: escapestr()
  and escapename().

* \pdfescapename:
  * delimiter character must be escaped, too.
  * zero byte is ignored, see specification.
  * documentation: specification added for
    convertStringToPDFName() in utils.c

Patched files:
  * utils.c
      main part of the fix, especially function
      convertStringToPDFName().
  * pdftoepdf.cc, epdf.h, ptexlib.h
      because of changed signature of
convertStringToPDFString()

Patch is applied by
  patch <EscapeNameString.patch
in directory
  src/texk/web2c/pdftexdir

Test files that test the conversion of all characters:
  test-escapename.tex
  test-escapestring.tex

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2005-06-21 00:17

Message:
Logged In: YES 
user_id=421

Included in #371

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=369&group_id=106
From noreply at sarovar.org  Tue Jun 21 08:52:34 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jun 21 08:58:41 2005
Subject: [NTG-pdftex] [ pdftex-Patches-371 ] Expandable \pdfstrcmp,
	\pdfescape*, added \pdf(de)escapehex
Message-ID: <E1Dkccc-0005Tk-00@sarovar.org>

Patches item #371, was opened at 2005-06-20 17:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=371&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Expandable \pdfstrcmp, \pdfescape*, added \pdf(de)escapehex

Initial Comment:
Hello,

the result of last weekend is a patch that
makes \pdfstrcmp (based on Harmut's work)
and the \pdfescape* commands expandable.
Thus \pdflastescaped* are not needed
anymore.
 I could remove the dependency
on a limited buffer by copying the destination
strings directly in the string pool above the
source string.
  Also the patch adds the fixes of bug 369.

Fourth I add \pdfescapehex and \pdfunescapehex
that implements encoding and decoding for
hexadecimal strings:
* Strings can also be given as hex strings in
  angle brackets.
* Safe method to store and read string data to
  auxiliary files without worrying about catcodes,
  unmachted curly braces, ...
* Help in handling UTF-8/Unicode or other hex coding
  stuff.

Patch is applied by
  patch <EscapeDivers.patch
in directory
  src/texk/web2c/pdftexdir

The Makefile needs modifying. After the lines
  $(srcdir)/pdftexdir/tex.pch
the line
  $(srcdir)/pdftexdir/pdfstrcmp.ch
is inserted. This should be done two times for
pdftex and pdfetex.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

>Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-06-21 08:52

Message:
Logged In: YES 
user_id=1276

Hello,

the first patch missed the changes in pdftex.defines.
Now the patch is reorganized:

Patched files:
  * utils.c
      main part of the fix, especially function
      convertStringToPDFName().
  * pdftoepdf.cc, epdf.h, ptexlib.h
      because of changed signature of
      convertStringToPDFString()
  * pdftex.defines adds new/deletes old entries
    of utils.c
  * pdfstrcmp.ch is added.
  * pdftex.mk, ../pdfetexdir/pdfetex.mk:
    addition of pdfstrcmp.ch

Now the patch must be applied in scr/texk/web2c:
  patch -p0 <EscapeDivers.patch
With the following commands I could compile pdf(e)tex:
  unzip pdftex-1.30.0-rc1.zip
  cd pdftex-1.30.0-rc1/src/texk/web2c
  patch -p0 <../../../../EscapeDivers.patch
  cd -   
  ./Build

Sorry for the inconvenience
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=371&group_id=106
From jackos1 at poczta.onet.pl  Thu Jun 23 00:25:04 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 23 00:25:16 2005
Subject: [NTG-pdftex] \random?
Message-ID: <42B9E540.5010406@poczta.onet.pl>

Hi All,

a couple of months ago I was asked to implement a simple random number 
generator in TeX. It is not very hard for uniform distributions, but I 
couldn't find satisfactory way to make it reliable and expandable. The 
problem is that all generators I know (I'm not expirienced in that 
stuff) use recently generated random number to make another one. For TeX 
it means we need to make an assignment.

OK, there is no many practical reasons for that (: I've found two however.
* if \pdfuniquresname is in use, one may want to make his own named 
resources unique as well
* when playing i.e. with page backgrounds or other TeX-based pictures, 
it might be nice to have a possibility to use random text 
size/color/position.

How do you think? Taco?
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Thu Jun 23 00:37:19 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 23 00:37:59 2005
Subject: [NTG-pdftex] \random?
In-Reply-To: <42B9E540.5010406@poczta.onet.pl>
References: <42B9E540.5010406@poczta.onet.pl>
Message-ID: <42B9E81F.5070202@wxs.nl>

Pawel Jackowski wrote:
> Hi All,
> 
> a couple of months ago I was asked to implement a simple random number 
> generator in TeX. It is not very hard for uniform distributions, but I 
> couldn't find satisfactory way to make it reliable and expandable. The 
> problem is that all generators I know (I'm not expirienced in that 
> stuff) use recently generated random number to make another one. For TeX 
> it means we need to make an assignment.

In ConTeXt I use Donald Arseneau's plain tex random.tex. It's normally ok (esp 
if we'd have a milliseconds counter)

> OK, there is no many practical reasons for that (: I've found two however.
> * if \pdfuniquresname is in use, one may want to make his own named 
> resources unique as well
> * when playing i.e. with page backgrounds or other TeX-based pictures, 
> it might be nice to have a possibility to use random text 
> size/color/position.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jackos1 at poczta.onet.pl  Thu Jun 23 00:39:07 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 23 00:39:28 2005
Subject: [NTG-pdftex] \random?
In-Reply-To: <42B9E540.5010406@poczta.onet.pl>
References: <42B9E540.5010406@poczta.onet.pl>
Message-ID: <42B9E88B.5020005@poczta.onet.pl>


> How do you think? Taco?

Sorry, I haven't asked the question precisely. What do you think about 
random numbers available as a pdfTeX primitive?

-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From jackos1 at poczta.onet.pl  Thu Jun 23 00:50:54 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 23 00:51:08 2005
Subject: [NTG-pdftex] \random?
In-Reply-To: <42B9E81F.5070202@wxs.nl>
References: <42B9E540.5010406@poczta.onet.pl> <42B9E81F.5070202@wxs.nl>
Message-ID: <42B9EB4E.6050009@poczta.onet.pl>

Hi Hans,

> In ConTeXt I use Donald Arseneau's plain tex random.tex. It's normally 
> ok (esp if we'd have a milliseconds counter)

Indeed, I've also excerpted some things from random.tex. It works fine 
but primitives makes TeX world so smooth -)

Thanks,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From taco at elvenkind.com  Thu Jun 23 08:51:08 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jun 23 08:53:36 2005
Subject: [NTG-pdftex] \random?
In-Reply-To: <42B9E88B.5020005@poczta.onet.pl>
References: <42B9E540.5010406@poczta.onet.pl> <42B9E88B.5020005@poczta.onet.pl>
Message-ID: <42BA5BDC.6090803@elvenkind.com>

Pawel Jackowski wrote:
> 
>> How do you think? Taco?
> 
> 
> Sorry, I haven't asked the question precisely. What do you think about 
> random numbers available as a pdfTeX primitive?
> 

It would be easy to port metafont's random code, but I'm not sure if
that is random enough for your (it was state of the art, but that was
a quarter of a century ago).  I'll create a change file to show
you (hopefully today)

Taco


From pragma at wxs.nl  Thu Jun 23 10:11:10 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 23 10:11:07 2005
Subject: [NTG-pdftex] \random?
In-Reply-To: <42BA5BDC.6090803@elvenkind.com>
References: <42B9E540.5010406@poczta.onet.pl> <42B9E88B.5020005@poczta.onet.pl>
	<42BA5BDC.6090803@elvenkind.com>
Message-ID: <42BA6E9E.2070107@wxs.nl>

Taco Hoekwater wrote:
> Pawel Jackowski wrote:
> 
>>
>>> How do you think? Taco?
>>
>>
>>
>> Sorry, I haven't asked the question precisely. What do you think about 
>> random numbers available as a pdfTeX primitive?
>>
> 
> It would be easy to port metafont's random code, but I'm not sure if
> that is random enough for your (it was state of the art, but that was
> a quarter of a century ago).  I'll create a change file to show
> you (hopefully today)

not random enough indeed (for fast runs); this is why i let an external app 
generate the random number if it really needs to be random

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Thu Jun 23 10:19:17 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jun 23 10:19:20 2005
Subject: [NTG-pdftex] \random?
In-Reply-To: <42BA6E9E.2070107@wxs.nl>
References: <42B9E540.5010406@poczta.onet.pl>
	<42B9E88B.5020005@poczta.onet.pl>	<42BA5BDC.6090803@elvenkind.com>
	<42BA6E9E.2070107@wxs.nl>
Message-ID: <42BA7085.6030703@elvenkind.com>



Hans Hagen wrote:
>> It would be easy to port metafont's random code, but I'm not sure if
>> that is random enough for your (it was state of the art, but that was
>> a quarter of a century ago).  I'll create a change file to show
>> you (hopefully today)
> 
> 
> not random enough indeed (for fast runs); 

In pdftex we have microseconds available these days :-)

Taco
From noreply at sarovar.org  Thu Jun 23 10:54:16 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 23 11:00:21 2005
Subject: [NTG-pdftex] [ pdftex-Patches-374 ] noligatures patch
Message-ID: <E1DlNTU-0004e5-00@sarovar.org>

Patches item #374, was opened at 2005-06-23 10:54
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=374&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Nobody (None)
Summary: noligatures patch

Initial Comment:

Usage is quite straightforward: 
  \noligatures \f 
disables ligatures for the loaded font \f. 

The (unexpandable) value of \noligatures \f is either
1, when the font has no ligatures, or 0, when the font
*does* have ligatures.

This patch is to be applied after tex.pch, but see the
change file itself for a remark regarding MLTeX.

As requested by Hans.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=374&group_id=106
From noreply at sarovar.org  Thu Jun 23 10:55:51 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jun 23 11:02:00 2005
Subject: [NTG-pdftex] [ pdftex-Patches-374 ] noligatures patch
Message-ID: <E1DlNV1-0004es-00@sarovar.org>

Patches item #374, was opened at 2005-06-23 10:54
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=374&group_id=106

>Category: Primitives
>Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Taco Hoekwater (taco)
>Assigned to: The Thanh Han (hanthethanh)
Summary: noligatures patch

Initial Comment:

Usage is quite straightforward: 
  \noligatures \f 
disables ligatures for the loaded font \f. 

The (unexpandable) value of \noligatures \f is either
1, when the font has no ligatures, or 0, when the font
*does* have ligatures.

This patch is to be applied after tex.pch, but see the
change file itself for a remark regarding MLTeX.

As requested by Hans.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=374&group_id=106
From jackos1 at poczta.onet.pl  Thu Jun 23 11:21:55 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 23 11:22:23 2005
Subject: [NTG-pdftex] escaped spaces in \pdfescapestring
Message-ID: <42BA7F33.9070907@poczta.onet.pl>

Hi Heiko,

what is the reason to escape spaces and newlines in \pdfescapestring?

\def\mystr{A B^^JC}
\tt
%\pdfescapename{\mystr} % this is obsious
\pdfescapestring{\mystr} % ?
\end

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From oberdiek at uni-freiburg.de  Thu Jun 23 13:41:28 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu Jun 23 13:41:35 2005
Subject: [NTG-pdftex] escaped spaces in \pdfescapestring
In-Reply-To: <42BA7F33.9070907@poczta.onet.pl>
References: <42BA7F33.9070907@poczta.onet.pl>
Message-ID: <20050623114128.GA5016@m0A0232D2.vpn.uni-freiburg.de>

On Thu, Jun 23, 2005 at 11:21:55AM +0200, Pawel Jackowski wrote:

> Hi Heiko,
> 
> what is the reason to escape spaces and newlines in \pdfescapestring?
> 
> \def\mystr{A B^^JC}
> \tt
> %\pdfescapename{\mystr} % this is obsious
> \pdfescapestring{\mystr} % ?
> \end

Following the specification there is no reason, it says,
"any 8-bit value may appear in a string".
However: '\', '(', and ')' _must_ be escaped.
Thus we can save space by only escaping the "must" characters.
But I am not feeling too well with this extreme.
\pdfescapename and \pdfescapestring are useful for PostScript, too.
Here the strings are passed through \special, dvips and the
PostScript-Interpreter. Are you sure, that nothing happens with
control characters, eg. newlines <LF> recoded as <CR><LF>, ...?
Perhaps the 8-bit characters can be output directly, here
I am not sure, if the 7-bit-safety here is just paranoia.

In case of names:
* Some characters such as delimiters and '#' _must_ be
  escaped.
* Others, such as control and 8-bit characters are
  recommended for escaping.
Thus \pdfescapename follows the recommendation.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From jackos1 at poczta.onet.pl  Thu Jun 23 14:39:00 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 23 14:39:09 2005
Subject: [NTG-pdftex] escaped spaces in \pdfescapestring
In-Reply-To: <20050623114128.GA5016@m0A0232D2.vpn.uni-freiburg.de>
References: <42BA7F33.9070907@poczta.onet.pl>
	<20050623114128.GA5016@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42BAAD64.2040706@poczta.onet.pl>

Pawel:
>>what is the reason to escape spaces and newlines in \pdfescapestring?

Heiko:
> Following the specification there is no reason[...]
> Are you sure, that nothing happens with
> control characters, eg. newlines <LF> recoded as <CR><LF>, ...?

Yes, you're absolutely right.

> In case of names:
> * Some characters such as delimiters and '#' _must_ be
>   escaped.
> * Others, such as control and 8-bit characters are
>   recommended for escaping.
> Thus \pdfescapename follows the recommendation.

I've just encountered a problem. Shouldn't \pdfescapename also escape 
`%' character?

\escapechar=-1
\setbox0\hbox{Aqq}
\immediate\pdfxform
    attr {/\pdfescapename{M\string\%Y} /Val}0
\pdfrefxform\pdflastxform
\end

This produce corrupted output

BR,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From oberdiek at uni-freiburg.de  Thu Jun 23 15:57:05 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu Jun 23 15:57:03 2005
Subject: [NTG-pdftex] escaped spaces in \pdfescapestring
In-Reply-To: <42BAAD64.2040706@poczta.onet.pl>
References: <42BA7F33.9070907@poczta.onet.pl>
	<20050623114128.GA5016@m0A0232D2.vpn.uni-freiburg.de>
	<42BAAD64.2040706@poczta.onet.pl>
Message-ID: <20050623135705.GA6593@m0A0232D2.vpn.uni-freiburg.de>

Hello,

On Thu, Jun 23, 2005 at 02:39:00PM +0200, Pawel Jackowski wrote:

> I've just encountered a problem. Shouldn't \pdfescapename also escape 
> `%' character?

Yes, you are right, many thanks, it belongs to the delimiter characters
that need escaping. I fix it in the next patch, I want to upload soon.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From jackos1 at poczta.onet.pl  Thu Jun 23 16:06:02 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 23 16:13:09 2005
Subject: [NTG-pdftex] escaped spaces in \pdfescapestring
In-Reply-To: <20050623135705.GA6593@m0A0232D2.vpn.uni-freiburg.de>
References: <42BA7F33.9070907@poczta.onet.pl>	<20050623114128.GA5016@m0A0232D2.vpn.uni-freiburg.de>	<42BAAD64.2040706@poczta.onet.pl>
	<20050623135705.GA6593@m0A0232D2.vpn.uni-freiburg.de>
Message-ID: <42BAC1CA.5080207@poczta.onet.pl>

Heiko,

>>I've just encountered a problem. Shouldn't \pdfescapename also escape 
>>`%' character?
> 
> Yes, you are right, many thanks, it belongs to the delimiter characters
> that need escaping. I fix it in the next patch, I want to upload soon.

OK! I've made a lot of tests on all \pdfescape*'s but I couldn't find 
anything more complain :) I like it very much. Already described in 
manual and samplepdf file.

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From noreply at sarovar.org  Sat Jun 25 03:42:30 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jun 25 03:48:35 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
Message-ID: <E1Dlzgk-0004lW-00@sarovar.org>

Patches item #375, was opened at 2005-06-25 03:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=375&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Patch EscapeAndOther

Initial Comment:
Hello,

Subject: Patch EscapeAndOther
Date: 2005/06/25
Author: Heiko Oberdiek

The patch is based on pdftex-1.30.0-rc1.
It supersedes patch EscapeDivers.tar.bz2

Inherited from patch EscapeDivers:
  Expandable: \pdfstrcmp, \pdfescapestring, \pdfescapename
  Added: \pdfescapehex, \pdfunescapehex
  Fix: \pdfescapename: '%' is also a delimiter that
       needs escaping.

New in patch EscapeAndOther:
  * \pdfcreationdate
  * \pdffilemoddate
  * \pdffilesize
  * \pdfmdfivesum
  * \pdffiledump
  * \pdfshellescape
  * \pdfmatch and \pdflastmatch
  * Start with bug fix: quotes are legal in other
    operating systems than windows.

The description is in file README and
I also post it to the ntg-pdftex mailing
list.

Patched files:
  The main part is implemented in:
  * utils.c
  * pdfstrcmp.ch is added.

  The other files only contains small changes:
  * pdftoepdf.cc, epdf.h, ptexlib.h
      because of changed signature of
convertStringToPDFString()
  * pdftex.defines adds new/deletes old entries of utils.c
  * pdftex.mk, pdfetex.mk: addition of pdfstrcmp.ch

Patch is applied by
  patch -p0 <EscapeDivers.patch
in the base directory that contains "src".

Example, the current directory contains
pdftex-1.30.0-rc1.zip and EscapeAndOther.patch,
contained in EscapeAndOther.tar.bz2:
  unzip pdftex-1.30.0-rc1.zip
  cd pdftex-1.30.0-rc1
  patch -p0 <../EscapeAndOther.patch
  ./Build

Test files that test the conversion of all characters:
  test-escapename.tex
  test-escapestring.tex
  test-escapehex.tex
  test-unescapehex.tex

Have fun
  Heiko <oberdiek@uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=375&group_id=106
From oberdiek at uni-freiburg.de  Sat Jun 25 03:52:01 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Sat Jun 25 19:12:02 2005
Subject: [NTG-pdftex] Patch EscapeAndOther
Message-ID: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>

Hello,

I have uploaded the patch EscapeAndOther, #375.
The patch is based on pdftex-1.30.0-rc1.
It supersedes patch EscapeDivers.tar.bz2, #371.

Inherited from patch EscapeDivers:
  Expandable: \pdfstrcmp, \pdfescapestring, \pdfescapename
  Added: \pdfescapehex, \pdfunescapehex
  Fix: \pdfescapename: '%' is also a delimiter that
       needs escaping.

New in patch EscapeAndOther:
  * \pdfcreationdate
  * \pdffilemoddate
  * \pdffilesize
  * \pdfmdfivesum
  * \pdffiledump
  * \pdfshellescape
  * \pdfmatch and \pdflastmatch
  * Start with bug fix: quotes are legal in other operating
    systems than windows.

Syntax:

  %% expandable commands:
  \pdfstrcmp <general text> <general text>
  \pdfescapestring <general text>
  \pdfescapename <general text>
  \pdfescapehex <general text>
  \pdfunescapehex <general text>
  \pdfcreationdate
  \pdffilemoddate <general text>
  \pdffilesize <general text>
  \pdfmdfivesum <file spec> | <general text>
  \pdfmatch <match options> <general text> <general text>
  <match options> := [icase] [subcount <number>]
  \pdflastmatch <number>

  %% read-only integers
  \pdfshellescape

Common for the following primitives:
* The result string is given by characters with
  catcode "other" (12), only the space has
  catcode "space" (10). The commands follow
  the tradition of \meaning, \string, ...
* The argument <general text> is expanded before use.
  It follows the tradition of \special, \message,
  \pdfobj, ...

Description:

\pdfstrcmp{<a>}{<b>}
  Compares two strings and returns the strings
    "0" if <a> equals <b>
    "-1" if <a> is less than <b>
    "1" if <a> is greater than <b>
  Use example:
    \ifcase\pdfstrcmp{abc}{def}\relax
      \message{abc = def}
    \or
      \message{abc > def}
    \else
      \message{abc < def}
    \fi
  Alternative:
   Implementing as read-only integer, then
   the use in \ifcase, \ifnum, ... is more save:
       \ifcase\pdfstrcmp{xyz}{abc}1\or 2\else 3\fi
   expands to 3, as read-only integer it expands
   to the expected 2.

\pdfescapestring{<a>}
  Escapes the string <a> that it can be used as PDF string.
  '(', ')', '\' are escaped along with the
  control and 8-bit characters.
  Use example:
    \pdfinfo{/Title (\pdfescapestring{...})}
    \special{ps: [ /Title (\pdfescapestring{...}) /DOCINFO pdfmark}
  Alternative:
    Perhaps 8-bit characters don't need escaping.
    Whitespace, especially newlines should be escaped, because
    of the use for latex/dvips to avoid recoding problems
    (<LF> -> <CR><LF>).

\pdfescapename{<a>}
  Escapes the string <a> that it can be used as PDF string.
  Whitespace, delimiters, '#' are escaped along with
  the control and 8-bit characters, recommended by the spec.
  Use example:
    \pdfobj stream attr{/Type/EmbeddedFile%
      /Subtype/\pdfescapename{text/plain; charset=iso-8859-1}%
      ...
    } file {...}

\pdfescapehex{<a>}, \pdfunescapehex{<b>}
  String <a> is converted to uppercase hexadecimal
  representation, <b> is converted back.
  Use example:
    \pdfescapehex{Hello} is converted to 48656C6C6F
    \pdfinfo{/Title <\pdfescapehex{Hello}>}
  Also it can be used to write strings in auxiliary
  files and later reread without worrying about
  catcodes, unmached curly braces.

\pdfcreationdate
  It expands to the date string that pdfTeX uses in
  the info dict as default.
  Rationale:
  * It provides seconds and especially the time zone.
  * Setting of /M date for annotations.
  * Because of the complicate change file structure
    of the sources it is not easy to synchronize
    the creation date with \year, \month, \day
    and \time. Thus \pdfcreationdate can be
    used to set these registers to the same
    values.
  Example:
    \pdfcreationdate expands to D:20050625015605+02'00'
    \pdfannot ...{/Subtype /FileAttachment
      \M (\pdfcreationdate) ...}

\pdffilemoddate{<file>}
  It expands to the modification date of <file> in the
  same format as \pdfcreationdate (PDF date format).
  On error it returns the empty string.
  Rationale:
  * File embedding: the date is shown in the attachment tab.
  * "Make feature": files can be compared, it can be checked,
    which file is newer.
    Example: pdfTeX does not support EPS files, epstopdf.sty
    converts them to PDF either always or, if the PDF variants
    do not exists. Both ways are not satifactory, either the
    time penalty is large or pdf files are embedded that
    are out of date. \pdffilemoddate solves this problem.
  Error handling, see \pdffilesize

I don't have implemented a \pdfcreationdate because of
portability issue: The "ctime" field of struct "stat" is
interpreted differently among operating systems:
* creation date, e.g. win
* inode change time, e.g. unix

\pdffilesize{<file>}
  It expands to the size of <file> as string. On error it
  returns the empty string.
  Rationale:
  * File embedding: the size is shown in the attachment tab.
  * Sometimes it is useful to know if a file has size "0"
    (failed conversions, ...).
  Error handling:
    Currently the empty string is silently returned.
  Alternatives:
  * Stop with error message. But what can the user do?
    Error recovery is easy: no information available,
    thus return nothing.
  * Warning message. But the primitives could be used
    for checks on file existence.
  * Return status in \pdfretval. I doubt a little whether
    this is really necessary. It is very easy to implement.
    But the documentation grows by a large list of
    error codes with its problems: Much to explain to the
    users. How they are assigned?
    
\pdfmdfivesum{<abc>} or \pdfmdfivesum file {<file>}
  It calculates the md5 sum and converts it to
  uppercase hexadecimal format (same as \pdfescapehex).
  The syntax is a simplified \pdfobj: Either the
  data is given directly or in a file.
  Rationale:
  * File embedding: providing /CheckSum.
  * Also the md5 sums of auxiliary files could be stored
    and compared in order to display a rerun warning.
    (Of course, it can be possible that different files
    have the same checksum, but the same file does not
    have different checksums.)

\pdfshellescape
  It is a read-only integer that is 1 if \write18 is
  enabled, 0 otherwise.
  Rationale:
  * It thought that \ifeof18 with \pdftexversion
    to implement a safe test for the \write18 feature.
    But I had to learn that I was wrong, see thread
    in comp.text.tex: "Confused about pstricks and
    pdftricks":
    mikTeX's pdfTeX does not implement \ifeof18.
    For implementing the test, only a obscure way
    via \pdftexbanner remains, but this way is not
    very reliable, the contents of \pdftexbanner
    is not well defined, it could be anything.

Quotes in file names:
* File name handling is quite chaotic. Quotes are removed
  by the scanner for \input, \open*. This behaviour is
  schizophrene: to solve a problem with spaces, quotes
  are now forbidden.
* Inconsistencies:
  The syntax of \pdfobj and \pdfximage would allow
  any file name, but \pdfobj removes quotes, only
  \pdfximage uses the more intelligent way, it removes
  quotes for windows only.
Thus the patch fixes:
* append_to_name (used in pack_file_name): quotes are removed
  for windows only. This fixes \pdfobj.
* utils.c: new function "makecfilename",
  used by \pdfximage (readimage), \pdffilesize, ...

\pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>}
  Implements pattern matching using the POSIX regex
  (a standard library at least in my linux).
  It returns the same values as \pdfstrcmp, but
  with the following semantics:
    -1: error case (invalid pattern, ...)
     0: no match
     1: match found
  Options:
  * icase: case insensitive matching
  * subcount: it sets the table size for found subpatterns.
    A number "-1" resets the table size to the start default.

  See the manual page regex.3 and regex.7.

  The implementation shows a possible interface to
  pattern matching in TeX. Therefore only the basics
  is implemented.
  Flags:
  * REG_EXTENDED is set in the implementation.
  * REG_ICASE: can be set by user.
  * other: not implemented.

\pdflastmatch <number>
  The result of \pdfmatch is stored in an array.
  The entry "0" contains the match, the following
  entries submatches. The positions of the matches
  are also available. They are encoded in the following
  manner to avoid another primitive:
    <position> "->" <match string>
  "->" is used as separator in the tradition of \meaning.
  There exists macros for parsing the output of \meaning
  (e.g. in LaTeX: \strip@prefix).
  The position "-1" with an empty string indicates that
  this entry is not set.
  Example:
    \def\msg#{\immediate\write16 }
    \msg{\pdfmatch{(l+)o (W(o))}{Hello World}}
    \msg{\pdflastmatch0}
    \msg{\pdflastmatch1}
    \msg{\pdflastmatch2}
    \msg{\pdflastmatch3}
    \msg{\pdflastmatch4}
  Result:
    1
    2->llo Wo
    2->ll
    6->Wo
    7->o
    -1->

Alternative:
  PCRE (Perl-compatible regular expressions) is far more
  powerful. More options, named subpattern, ...
  License for 0.4 was GPL compatible, since 0.5 it is BSD,
  current version is 0.6.

  The TeX interface could be changed in the following way:
  * Addition: \pdflastmatchbyname <general text>
    It extracts matches for named subpattern.
  * Options can be given by the same name as in the
    PCRE description:
    \pdfmatch anchored caseless ... {}{}
    For easier/faster scanning the options could be
    restricted to be given in sorted order.
  * Or options can be given by letters in any order
    in an additional argument:
      \pdfmatch{<pattern>}{<options>}{<string>}
      \pdfmatch{l+}{ai}{Hello World}
    The implementation could then use strchr to check,
    whether an option is set.

Patch instructions for testing are given in the
patch description at sarovar.

Have fun
  Heiko <oberdiek@uni-freiburg.de>
-- 
From jackos1 at poczta.onet.pl  Sat Jun 25 22:25:34 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Sat Jun 25 22:26:41 2005
Subject: [NTG-pdftex] Patch EscapeAndOther
In-Reply-To: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
Message-ID: <42BDBDBE.7060704@poczta.onet.pl>

Heiko,

i'm playing with new features provided by your last patch. Impressive!

> \pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>}

Impressive indeed!!

>   Implements pattern matching using the POSIX regex
>   (a standard library at least in my linux).

Didn't test deeply yet, but works on windows as well

Regards,
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Mon Jun 27 11:14:42 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jun 27 11:14:31 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
In-Reply-To: <E1Dlzgk-0004lW-00@sarovar.org>
References: <E1Dlzgk-0004lW-00@sarovar.org>
Message-ID: <42BFC382.5060705@wxs.nl>

noreply@sarovar.org wrote:
> Patches item #375, was opened at 2005-06-25 03:42
> You can respond by visiting: 
> http://sarovar.org/tracker/?func=detail&atid=495&aid=375&group_id=106

why not take this opportunity to add a few more converters:

how about

\pdflchex  <number> => [0-f][0-f]...  (even number of chars)
\pdfuchex  <number> => [0-F][0-F]...
\pdflcchar <number 1-26> => a-z
\pdfucchar <number 1-26> => A-Z

as well as an expandable upper/lowercase (taco and i have this on the agenda 
anyway)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Mon Jun 27 11:49:38 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jun 27 11:50:11 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
In-Reply-To: <42BFC382.5060705@wxs.nl>
References: <E1Dlzgk-0004lW-00@sarovar.org> <42BFC382.5060705@wxs.nl>
Message-ID: <20050627094938.GA31894@irwin.vpn.uni-freiburg.de>

Hello,

On Mon, Jun 27, 2005 at 11:14:42AM +0200, Hans Hagen wrote:

> noreply@sarovar.org wrote:
> >Patches item #375, was opened at 2005-06-25 03:42
> >You can respond by visiting: 
> >http://sarovar.org/tracker/?func=detail&atid=495&aid=375&group_id=106
> 
> why not take this opportunity to add a few more converters:
> 
> how about

Regarding uppercase/lowercase:
the primitives of the patch converts to uppercase hex (uchex).
Do you prefer having pairs of commands for generating
hex output:

  \pdfescapeuchex, \pdfescapelchex
  \pdffiledumpuchex, \pdffiledumplchex

Another possibility are keyword options:
  \pdfescapehex lc {...}
  \pdfescapehex uc {...}
Variants:
* short or long keywords: "lc" vs. "lowercase"
* both "lc" and "uc" or one is the default, e.g. uppercase,
  then just one option is needed for lowercase output.

> \pdflchex  <number> => [0-f][0-f]...  (even number of chars)
> \pdfuchex  <number> => [0-F][0-F]...

* What happens with negative numbers?
  * same behaviour as \romannumeral
  * error message, invalid number
* What happens with zero?
  * nothing, same as \romannumeral
  * 0
  * 00
* The perhaps often used case 0-15 is converted to 00-0f with two
  digits?

> \pdflcchar <number 1-26> => a-z
> \pdfucchar <number 1-26> => A-Z

That means "\pdflcchar 1" expands to "a" and "\pdfucchar 26" to "Z"?
The limitation to numbers from 1 to 26 is not clear to me.
A \pdflcchar <number 0-255>, using the \lccode conversion table,
would be more general. Or even a \pdflowercase, see below.

> as well as an expandable upper/lowercase (taco and i have this on the 
> agenda anyway)

a) Do you mean an \uppercase and \lowercase that take a
   token list and convert the characters in there?
b) Easier to implement should be an uppercase/lowercase command
   that takes a <general text>, expands it, makes a string and
   applies uppercase/lowercase conversion.
*) Conversion according to \uccode/\lccode?
   Or C-locale or something else?

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Mon Jun 27 12:45:20 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jun 27 12:45:10 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
In-Reply-To: <20050627094938.GA31894@irwin.vpn.uni-freiburg.de>
References: <E1Dlzgk-0004lW-00@sarovar.org> <42BFC382.5060705@wxs.nl>
	<20050627094938.GA31894@irwin.vpn.uni-freiburg.de>
Message-ID: <42BFD8C0.9040802@wxs.nl>

Heiko Oberdiek wrote:

> Another possibility are keyword options:
>   \pdfescapehex lc {...}
>   \pdfescapehex uc {...}

using keywords sounds ok to me

> Variants:
> * short or long keywords: "lc" vs. "lowercase"
> * both "lc" and "uc" or one is the default, e.g. uppercase,
>   then just one option is needed for lowercase output.

indeed

>>\pdflchex  <number> => [0-f][0-f]...  (even number of chars)
>>\pdfuchex  <number> => [0-F][0-F]...
> 
> 
> * What happens with negative numbers?
>   * same behaviour as \romannumeral
>   * error message, invalid number

same as romannummeral

> * What happens with zero?
>   * nothing, same as \romannumeral
>   * 0
>   * 00

this one is probably best

> * The perhaps often used case 0-15 is converted to 00-0f with two
>   digits?

indeed, an even number of digits

> 
>>\pdflcchar <number 1-26> => a-z
>>\pdfucchar <number 1-26> => A-Z
> 
> 
> That means "\pdflcchar 1" expands to "a" and "\pdfucchar 26" to "Z"?

indeed

> The limitation to numbers from 1 to 26 is not clear to me.

i have no problem with A .. Z AA..ZZ etc

\pdflcchar 27 -> AA

> A \pdflcchar <number 0-255>, using the \lccode conversion table,
> would be more general. Or even a \pdflowercase, see below.
> 
> 
>>as well as an expandable upper/lowercase (taco and i have this on the 
>>agenda anyway)
> 
> 
> a) Do you mean an \uppercase and \lowercase that take a
>    token list and convert the characters in there?
> b) Easier to implement should be an uppercase/lowercase command
>    that takes a <general text>, expands it, makes a string and
>    applies uppercase/lowercase conversion.

indeed

> *) Conversion according to \uccode/\lccode?
>    Or C-locale or something else?

no locales, just uccode/lccode

(when pdftex goes unicode/opentype we can use the info in unicode tables cq. fonts)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Mon Jun 27 13:04:20 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jun 27 13:04:36 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
In-Reply-To: <42BFD8C0.9040802@wxs.nl>
References: <E1Dlzgk-0004lW-00@sarovar.org> <42BFC382.5060705@wxs.nl>
	<20050627094938.GA31894@irwin.vpn.uni-freiburg.de>
	<42BFD8C0.9040802@wxs.nl>
Message-ID: <20050627110420.GA32641@irwin.vpn.uni-freiburg.de>

On Mon, Jun 27, 2005 at 12:45:20PM +0200, Hans Hagen wrote:

> Heiko Oberdiek wrote:
> 
> >>\pdflcchar <number 1-26> => a-z
> >>\pdfucchar <number 1-26> => A-Z
> >
> >
> >That means "\pdflcchar 1" expands to "a" and "\pdfucchar 26" to "Z"?
> 
> indeed
> 
> >The limitation to numbers from 1 to 26 is not clear to me.
> 
> i have no problem with A .. Z AA..ZZ etc

You mean something that can be used to generate
command names similar to \romannumeral, but using
lowercase/uppercase letters? Something that the
LaTeX package alphalph provides?

> \pdflcchar 27 -> AA

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
From pragma at wxs.nl  Mon Jun 27 13:58:16 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jun 27 13:58:08 2005
Subject: [NTG-pdftex] [ pdftex-Patches-375 ] Patch EscapeAndOther
In-Reply-To: <20050627110420.GA32641@irwin.vpn.uni-freiburg.de>
References: <E1Dlzgk-0004lW-00@sarovar.org> <42BFC382.5060705@wxs.nl>
	<20050627094938.GA31894@irwin.vpn.uni-freiburg.de>
	<42BFD8C0.9040802@wxs.nl>
	<20050627110420.GA32641@irwin.vpn.uni-freiburg.de>
Message-ID: <42BFE9D8.7000509@wxs.nl>

Heiko Oberdiek wrote:

> You mean something that can be used to generate
> command names similar to \romannumeral, but using
> lowercase/uppercase letters? Something that the

indeed

> LaTeX package alphalph provides?

i dunno that one, but context has such mapping macros as well and having a 
primitive simplifies live -)

(the simple A-Z one is ok since one can construct the others easily, so maybe 
just stick to A-Z and empty for being outside the range)

>>\pdflcchar 27 -> AA

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From noreply at sarovar.org  Mon Jun 27 16:45:24 2005
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jun 27 16:51:35 2005
Subject: [NTG-pdftex] [ pdftex-Patches-376 ] Uniform and Normal Distribution
	Pseudo-random numbers patch
Message-ID: <E1DmurU-0000UG-00@sarovar.org>

Patches item #376, was opened at 2005-06-27 16:45
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=376&group_id=106

Category: Primitives
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Nobody (None)
Summary: Uniform and Normal Distribution  Pseudo-random numbers patch

Initial Comment:

See the patch file itself or the mailing list for 
actual usage and comments. 

Requested by Pawel.

It is intented to be applied after tex.pch (as usual)


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=376&group_id=106
From taco at elvenkind.com  Mon Jun 27 16:53:12 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jun 27 16:55:38 2005
Subject: [NTG-pdftex] Re: Uniform and Normal Distribution Pseudo-random
	numbers patch
In-Reply-To: <E1DmurU-0000UG-00@sarovar.org>
References: <E1DmurU-0000UG-00@sarovar.org>
Message-ID: <42C012D8.1070309@elvenkind.com>

noreply@sarovar.org wrote:
> 
> See the patch file itself or the mailing list for 
> actual usage and comments. 

Here is the blurb from the top of the change file:

   randoms.ch --
   This is a WEB change file for pseudo-random numbers in
   pdftex 1.30 and above.

   There are four new primitives:

   \uniformdeviate <count>
    Generates a uniformly distributed random integer value
    between 0 (inclusive) and <count> (exclusive).
    This primitive expands to a list of tokens.

   \normaldeviate
    Expands to a random integer value with a mean of 0 and a
    unit of 65536.
    This primitive expands to a list of tokens.

   \randomseed
    You can use \the\randomseed to query the current seed value,
    so you can e.g. the value to the log file.

    The initial value of the seed is derived from the system time,
    and is not more than 1,000,999,999 (this ensures that the value
    can be used with commands like \count).

   \setrandomseed <count>
    This sets the random seed to a specific value, allowing you
    to re-play sequences fo semi-randoms at a later moment.

   Most of the actual code is taken from metapost, and originally
   written by Knuth, for Metafont. Glue to make it work in TeX is
   by me. If you find an error, it is bound to be in my code,
   not Knuth's :-)

Pawel, I hope this is what you had in mind.

Taco
From hanthethanh at myrealbox.com  Thu Jun 30 03:24:19 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Thu Jun 30 11:23:20 2005
Subject: [NTG-pdftex] pdftex patches
Message-ID: <20050630012419.GB2552@monty.localnet>

Hi,

I was away for a few days and was very impressed by the
patches you guys made during that period. This *is* cool,
I am quite glad that pdftex is not depending on 1 ror 2
people but there is a rather stable group of developers.

Martin, what is the schedule for a next release where all
the pending patches should be in?

Thanh
From pragma at wxs.nl  Thu Jun 30 11:40:15 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 30 11:40:02 2005
Subject: [NTG-pdftex] pdftex patches
In-Reply-To: <20050630012419.GB2552@monty.localnet>
References: <20050630012419.GB2552@monty.localnet>
Message-ID: <42C3BDFF.7020002@wxs.nl>

The Thanh Han wrote:

> I was away for a few days and was very impressed by the
> patches you guys made during that period. This *is* cool,
> I am quite glad that pdftex is not depending on 1 ror 2
> people but there is a rather stable group of developers.

this is just the start -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From hanthethanh at myrealbox.com  Thu Jun 30 02:58:14 2005
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Thu Jun 30 11:54:10 2005
Subject: [NTG-pdftex] \pdflastvbreakpenalty
In-Reply-To: <42B2BC50.5000507@poczta.onet.pl>
References: <42AC8D89.7090501@poczta.onet.pl>
	<Pine.LNX.4.61.0506122139070.5395@hahepc1.hahe>
	<20050612225219.GA27130@lucien.kn-bremen.de>
	<42AE4A3B.90807@wxs.nl> <20050614235644.GA2575@monty.localnet>
	<42B2BC50.5000507@poczta.onet.pl>
Message-ID: <20050630005814.GA2552@monty.localnet>

On Fri, Jun 17, 2005 at 02:04:32PM +0200, Pawel Jackowski wrote:
> Thanh:
> >I introduced this primitive for a job where I need some
> >hacking with page breaking and couldn't do that using
> >macros. This can be safely removed.
> 
> Just a question, in the context of page break, doesn't \outputpenalty do 
> this?

I wanted to have more control on page breaking using vsplit
inside the output routine, so it's handy to know penalty of
each break by vsplit.


Thanh
From martin at oneiros.de  Thu Jun 30 12:06:32 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 30 12:30:25 2005
Subject: [NTG-pdftex] \pdfmatch (was: Patch EscapeAndOther)
In-Reply-To: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
Message-ID: <20050630100631.GG10633@lucien.kn-bremen.de>

On 2005-06-25 03:52:01 +0200, Heiko Oberdiek wrote:
> \pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>}
>   Implements pattern matching using the POSIX regex
>   (a standard library at least in my linux).
>   It returns the same values as \pdfstrcmp, but
>   with the following semantics:
>     -1: error case (invalid pattern, ...)
>      0: no match
>      1: match found
>   Options:
>   * icase: case insensitive matching
>   * subcount: it sets the table size for found subpatterns.
>     A number "-1" resets the table size to the start default.
> 
>   See the manual page regex.3 and regex.7.
> 
>   The implementation shows a possible interface to
>   pattern matching in TeX. Therefore only the basics
>   is implemented.
>   Flags:
>   * REG_EXTENDED is set in the implementation.
>   * REG_ICASE: can be set by user.
>   * other: not implemented.
> 
> \pdflastmatch <number>
>   The result of \pdfmatch is stored in an array.
>   The entry "0" contains the match, the following
>   entries submatches. The positions of the matches
>   are also available. They are encoded in the following
>   manner to avoid another primitive:
>     <position> "->" <match string>
>   "->" is used as separator in the tradition of \meaning.
>   There exists macros for parsing the output of \meaning
>   (e.g. in LaTeX: \strip@prefix).
>   The position "-1" with an empty string indicates that
>   this entry is not set.
>   Example:
>     \def\msg#{\immediate\write16 }
>     \msg{\pdfmatch{(l+)o (W(o))}{Hello World}}
>     \msg{\pdflastmatch0}
>     \msg{\pdflastmatch1}
>     \msg{\pdflastmatch2}
>     \msg{\pdflastmatch3}
>     \msg{\pdflastmatch4}
>   Result:
>     1
>     2->llo Wo
>     2->ll
>     6->Wo
>     7->o
>     -1->
> 
> Alternative:
>   PCRE (Perl-compatible regular expressions) is far more
>   powerful. More options, named subpattern, ...
>   License for 0.4 was GPL compatible, since 0.5 it is BSD,
>   current version is 0.6.
> 
>   The TeX interface could be changed in the following way:
>   * Addition: \pdflastmatchbyname <general text>
>     It extracts matches for named subpattern.
>   * Options can be given by the same name as in the
>     PCRE description:
>     \pdfmatch anchored caseless ... {}{}
>     For easier/faster scanning the options could be
>     restricted to be given in sorted order.
>   * Or options can be given by letters in any order
>     in an additional argument:
>       \pdfmatch{<pattern>}{<options>}{<string>}
>       \pdfmatch{l+}{ai}{Hello World}
>     The implementation could then use strchr to check,
>     whether an option is set.
> 
> Patch instructions for testing are given in the
> patch description at sarovar.

While this is a VERY nice feature, I'm reluctant to include this
into 1.30.0 because
- we are (in theory at least) in feature-freeze, and this is
  definitely a new feature :-)
- it may need more testing
- I doubt that regex.h is portable; we should keep Windows in
  mind.

Comments?

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Thu Jun 30 11:56:17 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 30 12:30:27 2005
Subject: [NTG-pdftex] pdftex patches
In-Reply-To: <20050630012419.GB2552@monty.localnet>
References: <20050630012419.GB2552@monty.localnet>
Message-ID: <20050630095617.GF10633@lucien.kn-bremen.de>

On 2005-06-30 08:24:19 +0700, The Thanh Han wrote:
> I was away for a few days and was very impressed by the
> patches you guys made during that period. This *is* cool,
> I am quite glad that pdftex is not depending on 1 ror 2
> people but there is a rather stable group of developers.

Yeah, it's cool. :-)

> Martin, what is the schedule for a next release where all
> the pending patches should be in?

rc2 today or tomorrow with most patches in; release real soon.

Best regards
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Thu Jun 30 12:30:08 2005
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu Jun 30 12:30:49 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
Message-ID: <20050630103008.GH10633@lucien.kn-bremen.de>

Hi,
at LinuxTag in Karlsruhe I met with Heiko and Hartmut and we
talked about pdfTeX. One point discussed was namespace: Till
lately most new primitives of pdfTeX startet with \pdf (\efcode,
\lpcode and \rpcode are the only exceptions), but now we have
some patches that add primitives that don't start with \pdf
(\leftmarginkern, \rightmarginkern, \elapsedtime, \resettime,
\random). I'm reluctant to use the non-\pdf-namespace and think
it better to stay in \pdf.

Comments?

Best regards
    Martin

PS: One can always \let \pdf$foo to \$foo in *.ini
-- 
                    http://www.tm.oneiros.de
From jackos1 at poczta.onet.pl  Thu Jun 30 12:48:34 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 30 12:49:19 2005
Subject: [NTG-pdftex] \pdfmatch
In-Reply-To: <20050630100631.GG10633@lucien.kn-bremen.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050630100631.GG10633@lucien.kn-bremen.de>
Message-ID: <42C3CE02.7050803@poczta.onet.pl>

Hi Martin,

>>\pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>} [...]

> While this is a VERY nice feature, I'm reluctant to include this
> into 1.30.0 because
> - we are (in theory at least) in feature-freeze, and this is
>   definitely a new feature :-)
> - it may need more testing
> - I doubt that regex.h is portable; we should keep Windows in
>   mind.

I've tried a couple of examples on Windows with \pdfmatch. Works fine 
but didn't test deeply. Will try to do that ASAP.

Best regards
-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Thu Jun 30 13:01:38 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 30 13:01:24 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050630103008.GH10633@lucien.kn-bremen.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
Message-ID: <42C3D112.1050700@wxs.nl>

Martin Schr?der wrote:
> Hi,
> at LinuxTag in Karlsruhe I met with Heiko and Hartmut and we
> talked about pdfTeX. One point discussed was namespace: Till
> lately most new primitives of pdfTeX startet with \pdf (\efcode,
> \lpcode and \rpcode are the only exceptions), but now we have
> some patches that add primitives that don't start with \pdf
> (\leftmarginkern, \rightmarginkern, \elapsedtime, \resettime,
> \random). I'm reluctant to use the non-\pdf-namespace and think
> it better to stay in \pdf.
> 
> Comments?

this is why i wrote a while ago that we need a different prefix, something

\etxelapsedtime

on the other hand thereis hardly any chance for a clash, e.g. if a macro package 
defines \elapsedtime it will still work ok; of course when one in such a macro 
package wants access to the original primitive, one can save its meaning; this 
is what i normally do.

   \let\normalelapsedtime\elapsedtime
   \def\elapsedtime{.... \normalelapsedtime ...}

what we actually need is some access to the original meaning, like 
\primitive\elapsedtime; i dunno how hard it is to implement

   \def\elapsedtime{.... \primitive\elapsedtime ...}

personally i think that we should move forward and not clobber extensions with 
funny prefixes as in \pdfleftmarginkern and such; as said, if a macro package 
wants to use that features, it has to be pdftex aware and as such can take 
measures to save the original meaning

(so we could also argue for removing all \pdf prefixes)

(when etex came available, it introduced primitives that clashed with low level 
context ones; it never was a real problem; one simply cannot extend tex and take 
all packages into account)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Thu Jun 30 13:03:51 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 30 13:03:44 2005
Subject: [NTG-pdftex] \pdfmatch
In-Reply-To: <42C3CE02.7050803@poczta.onet.pl>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050630100631.GG10633@lucien.kn-bremen.de>
	<42C3CE02.7050803@poczta.onet.pl>
Message-ID: <42C3D197.9080900@wxs.nl>

Pawel Jackowski wrote:
> Hi Martin,
> 
>>> \pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>} [...]
> 
> 
>> While this is a VERY nice feature, I'm reluctant to include this
>> into 1.30.0 because
>> - we are (in theory at least) in feature-freeze, and this is
>>   definitely a new feature :-)
>> - it may need more testing
>> - I doubt that regex.h is portable; we should keep Windows in
>>   mind.

Is there any reason why some non-os dependent feature would not compile on 
windows? I expect more problems with old unix architectures -)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Thu Jun 30 13:06:52 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 30 13:06:39 2005
Subject: [NTG-pdftex] \pdfmatch
In-Reply-To: <20050630100631.GG10633@lucien.kn-bremen.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050630100631.GG10633@lucien.kn-bremen.de>
Message-ID: <42C3D24C.1000709@wxs.nl>

Martin Schr?der wrote:

> While this is a VERY nice feature, I'm reluctant to include this
> into 1.30.0 because
> - we are (in theory at least) in feature-freeze, and this is
>   definitely a new feature :-)

we can qualify all these new string handling features as experimental; the 
advantage of having it in 1.30 is that we can experiment; we can wait with 
adding them to the manual till 1.40

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jackos1 at poczta.onet.pl  Thu Jun 30 13:25:11 2005
From: jackos1 at poczta.onet.pl (Pawel Jackowski)
Date: Thu Jun 30 13:25:26 2005
Subject: [NTG-pdftex] \pdfmatch
In-Reply-To: <42C3D24C.1000709@wxs.nl>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>	<20050630100631.GG10633@lucien.kn-bremen.de>
	<42C3D24C.1000709@wxs.nl>
Message-ID: <42C3D697.5000406@poczta.onet.pl>

Hans:
> we can qualify all these new string handling features as experimental; 
> the advantage of having it in 1.30 is that we can experiment; we can 
> wait with adding them to the manual till 1.40

I've already added some notes (except \pdfmatch), but before release we 
can comment them.

-- 
Pawe/l Jackowski
P.Jackowski@gust.org.pl
From pragma at wxs.nl  Thu Jun 30 14:09:45 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 30 14:09:31 2005
Subject: [NTG-pdftex] input 
Message-ID: <42C3E109.1050804@wxs.nl>

Hi,

how about

\pdfinput   {filename}
\pdfopenin  {filename}
\pdfopenout {filename}

and maybe even one that accepts a hex encoded string

\pdfinput   hex {filename}
\pdfopenin  hex {filename}
\pdfopenout hex {filename}

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Thu Jun 30 17:06:13 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu Jun 30 17:47:17 2005
Subject: [NTG-pdftex] \pdfmatch (was: Patch EscapeAndOther)
In-Reply-To: <20050630100631.GG10633@lucien.kn-bremen.de>
References: <20050625015201.GA4063@irwin.vpn.uni-freiburg.de>
	<20050630100631.GG10633@lucien.kn-bremen.de>
Message-ID: <20050630150612.GA2695@irwin.vpn.uni-freiburg.de>

On Thu, Jun 30, 2005 at 12:06:32PM +0200, Martin Schr?der wrote:

> On 2005-06-25 03:52:01 +0200, Heiko Oberdiek wrote:
> > \pdfmatch [icase] [subcount <number>}] {<pattern>}{<string>}

> > \pdflastmatch <number>

> While this is a VERY nice feature, I'm reluctant to include this

This is experimental yet. Currently I am experimenting with
"pcre" that is more powerful. Result so far:
* changed syntax for \pdflastmatch:
    \pdflastmatch <general text>
    Thus keywords can also be used, saving new primitives:
    * \pdflastmatch{<number>} same semantics as before
    * \pdflastmatch{match} = \pdflastmatch{0} (perl: $&)
    * \pdflastmatch{subject} => whole string
    * \pdflastmatch{prematch} => part before "match" (perl: $`)
    * \pdflastmatch{postmatch} => part after "match" (perl: $')
    * \pdflastmatch{last_paren_match} => last substring (perl: $+)
* Unclear: options, how they are specified:
  * \pdfmatch anchored caseless ... {}{}
    * any order?
    * alphabetical order for easier/faster scanner?
  * Or options in separate argument, similar keyval?
    \pdflastmatch{anchored,caseless,...}{<pattern>}{<subject>}
    or \pdflastmatch options{...} {<pattern>}{<subject>}
* Eventually replace feature.

> - I doubt that regex.h is portable; we should keep Windows in
>   mind.

regex: at least it is POSIX. Thus there is a chance that this is
implemented in Windows compileres.

pcre: they say it is possible to compile it under Windows.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From oberdiek at uni-freiburg.de  Thu Jun 30 17:34:24 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu Jun 30 17:47:23 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C3D112.1050700@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
Message-ID: <20050630153424.GB2695@irwin.vpn.uni-freiburg.de>

On Thu, Jun 30, 2005 at 01:01:38PM +0200, Hans Hagen wrote:

> Martin Schr?der wrote:
> >Hi,
> >at LinuxTag in Karlsruhe I met with Heiko and Hartmut and we
> >talked about pdfTeX. One point discussed was namespace: Till
> >lately most new primitives of pdfTeX startet with \pdf (\efcode,
> >\lpcode and \rpcode are the only exceptions), but now we have
> >some patches that add primitives that don't start with \pdf
> >(\leftmarginkern, \rightmarginkern, \elapsedtime, \resettime,
> >\random). I'm reluctant to use the non-\pdf-namespace and think
> >it better to stay in \pdf.
> >
> >Comments?
> 
> this is why i wrote a while ago that we need a different prefix, something
> 
> \etxelapsedtime
> 
> on the other hand thereis hardly any chance for a clash, e.g. if a macro 
> package defines \elapsedtime it will still work ok; of course when one in 
> such a macro package wants access to the original primitive, one can save 
> its meaning; this is what i normally do.
> 
>   \let\normalelapsedtime\elapsedtime
>   \def\elapsedtime{.... \normalelapsedtime ...}

The problem is that one package may want to use the primitive
\elapsedtime, but another package has defined \elapsedtime for
other purpose, not knowing that this is a primitive.

A "namespace" prefix helps to avoid random name clashes.
However, it does not cure this problem entirely.
But a "namespace" allows us to say:
  Hey, package or macro author, command names that start
  with \pdf are reserved, if you are using pdfTeX.
And we can then add new primitives in this namespace
without worrying about name clashes.

> personally i think that we should move forward and not clobber extensions 
> with funny prefixes as in \pdfleftmarginkern and such; as said, if a macro 
> package wants to use that features, it has to be pdftex aware and as such 
> can take measures to save the original meaning

It doesn't work in practice. :-((
Some TeX distributions are now using pdfTeX instead of TeX as
compiler for "latex". Despite the availability of ifpdf.sty since 2001,
there are many, many problems in the newsgroups (de.)comp.text.tex
about using the wrong code:
  \ifx\pdfoutput\undefined
    ... latex setup
  \else
    ... pdflatex setup, assuming pdfTeX in pdf mode
  \fi
\pdfoutput is available since the beginnning of pdfTeX?
But many people haven't understood yet that pdfTeX can be used
for DVI mode.

> (so we could also argue for removing all \pdf prefixes)

One argument against "\pdf" is that this might confuse users
that they think, it is available for/in pdf mode only.
This could be cured at the cost of a different namespace:
  \pdf for pdf mode stuff
  \ptex for mode independent stuff

> (when etex came available, it introduced primitives that clashed with low 
> level context ones; it never was a real problem; one simply cannot extend 
> tex and take all packages into account)

As active author of conTeXt you can react fast on changes in the
underlying TeX compilers. But there are many packages where the
authors get lost and are unmaintained. And many authors react
slowly (like me sometimes).
  I do want to solve faqs, but I don't want to generate new
ones. For example, a quick search in TeXLive 2003 shows
collisions for \\match:
  chess.sty
  chessmg.sty
  eclbip.sty
sverb.sty defines \matcher and texshade.sty defines \match@case.
Thus if we add \match, then the newsgroups are full of \match
isn't working if I use chess and pdflatex ... And the people
would remember, pdfTeX causes problems.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From oberdiek at uni-freiburg.de  Thu Jun 30 17:44:17 2005
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu Jun 30 17:47:30 2005
Subject: [NTG-pdftex] input
In-Reply-To: <42C3E109.1050804@wxs.nl>
References: <42C3E109.1050804@wxs.nl>
Message-ID: <20050630154416.GC2695@irwin.vpn.uni-freiburg.de>

On Thu, Jun 30, 2005 at 02:09:45PM +0200, Hans Hagen wrote:

> how about
> 
> \pdfinput   {filename}
> \pdfopenin  {filename}
> \pdfopenout {filename}

Nice idea, I had the same :-))
I have already started to implement them:
* \pdfopenin easy to implement, working (as far I have tested it).
* \pdfinput more difficult, not working yet.
* \pdfoutput more difficult because of output node, unfinished.
Therefore I haven't released a patch yet.

> and maybe even one that accepts a hex encoded string
> 
> \pdfinput   hex {filename}
> \pdfopenin  hex {filename}
> \pdfopenout hex {filename}

\pdfunescapehex provides this feature:
  \pdfinput{\pdfunescapehex{filename}}

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From pragma at wxs.nl  Thu Jun 30 18:12:39 2005
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jun 30 18:12:26 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
References: <20050630103008.GH10633@lucien.kn-bremen.de>
	<42C3D112.1050700@wxs.nl>
	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
Message-ID: <42C419F7.8000302@wxs.nl>

Heiko Oberdiek wrote:

> Thus if we add \match, then the newsgroups are full of \match
> isn't working if I use chess and pdflatex ... And the people
> would remember, pdfTeX causes problems.

eh .. i can imagine that they are surprised that the primitive \match does not 
work, but any package that defines its own will since it overloads the primitive

btw, i suppose that the switch to etex also caused problems for latex then?

anyhow, i have no problem with a prefix, how about:

\ext (extensions) -> \extmatch


they are not pdftex specific (hence no p prefix) and they can as well end up in 
jonathan's xetex (i'll discuss it with him when the patches are ready)

Hans



Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Thu Jun 30 18:27:51 2005
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu Jun 30 18:30:27 2005
Subject: [NTG-pdftex] Extensions: \pdf$foo or \$foo?
In-Reply-To: <42C419F7.8000302@wxs.nl>
References: <20050630103008.GH10633@lucien.kn-bremen.de>	<42C3D112.1050700@wxs.nl>	<20050630153424.GB2695@irwin.vpn.uni-freiburg.de>
	<42C419F7.8000302@wxs.nl>
Message-ID: <42C41D87.1040201@elvenkind.com>

Hans Hagen wrote:
> Heiko Oberdiek wrote:
> 
>> Thus if we add \match, then the newsgroups are full of \match
>> isn't working if I use chess and pdflatex ... And the people
>> would remember, pdfTeX causes problems.
> 
> 
> eh .. i can imagine that they are surprised that the primitive \match 
> does not work, but any package that defines its own will since it 
> overloads the primitive
> 
> btw, i suppose that the switch to etex also caused problems for latex then?
> 
> anyhow, i have no problem with a prefix, how about:
> 
> \ext (extensions) -> \extmatch

I believe this addition of a prefix is for most extensions an
unneeded complication. If something it isn't used in any of the
macro packages in
   tex/latex/*/*
nor in
   tex/context/*/*
in a recent (full) texlive installation, then i consider any
such usage to be so esoteric that it can be overruled.

If it *is* used, then a solution like Hans' sounds fine, and claiming
an extension namespace definately sounds like a good idea (but \epdf
is probably better than \ext because of xetex and aleph).

Greetings,

Taco
