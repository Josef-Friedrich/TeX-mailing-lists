From noreply at sarovar.org  Fri Oct  1 16:23:23 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Oct  1 16:24:39 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-115 ] character protrusion: some
	characters will not be protruded
Message-ID: <E1CDOJf-0007ZF-00@sarovar.org>

Bugs item #115, was opened at 2004-09-10 21:57
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=115&group_id=106

Category: hz
Group: v1.20a
Status: Open
Resolution: None
Priority: 5
Submitted By: Nobody (None)
Assigned to: The Thanh Han (hanthethanh)
Summary: character protrusion: some characters will not be protruded

Initial Comment:
Some characters will not be protruded into the right
margin, namely: `-', `--', and `---', if entered like
that. When they occur as \hyphenchar, or as a single
character (e.g. \char123), everything's fine. With the
EC fonts, the same happens for some quote characters.

Here's a plain TeX file showing the problem:

----------------------------------------------------
\tracingoutput 1
\showboxbreadth \maxdimen
\showboxdepth \maxdimen
\pdfprotrudechars=2
\hsize10em

\def\testprotrusion#1{#1\dotfill #1\penalty-10000}

\font\testfont=cmr10\testfont

\newcount\charcount
\charcount=0
\loop
   \rpcode\font\charcount=1000
   \advance\charcount 1
   \ifnum\charcount < 256 \repeat

\noindent
\testprotrusion{A}% OK
\testprotrusion{-}%
\testprotrusion{--}%
\testprotrusion{---}%
\testprotrusion{itworks\-likethis}%
\testprotrusion{\char123}%
\testprotrusion{\char124}%

\font\testfont=ecrm10\testfont
\charcount=0
\loop
   \rpcode\font\charcount=1000
   \advance\charcount 1
   \ifnum\charcount < 256 \repeat

\noindent
\testprotrusion{``}%
\testprotrusion{''}%
\testprotrusion{\char13}% \quotedblbase
\testprotrusion{\char18}% \quotesinglbase
\testprotrusion{Z}% OK

\bye 
----------------------------------------------------

I don't know whether that might be related, but in all
cases, something is being inserted between the
character itself and the right margin by TeX (a
discretionary for the dashes, a \kern for the quote
characters). 

(This is the same bug as reported in the dctt thread
`Randausgleich von Binde- und Trennstrich', 29.8.04)

Regards,
Robert.

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2004-10-01 14:23

Message:
Logged In: YES 
user_id=929

Hi Robert and Thanh,

response on Robert's mail. Please check the test files.

Thanh, please comment, help. Thanks a lot!

Best Regards

Hartmut

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-28 22:09

Message:
Logged In: NO 

In the README to the patch, you say:

> To scroll back over unwanted things I now have extended 
> the discardable() macro. There was an error in the 
> original macro anyway, as
>
> ((type(#) = kern_node) and (subtype(#) <> explicit))
>
> is to be discarded, but
>
> ((type(#) = kern_node) and (subtype(#) = explicit))
>
> is not.

Does that mean that `\kern1pt A\kern1pt' will not get
protruded? 
And, what about `\kern1pt\unkern A\kern1pt\unkern'?

Unfortunately, I'm not able to to test your patch. Could you
(or somebody) run this file, and comment on the output,
please, or upload the PDF?

% -----------------------------------------------------
\pdfprotrudechars=2
\hsize5em
\def\testprotrusion#1{#1 \hfill #1\penalty-10000}
\font\testfont=cmr10\testfont

\lpcode\font`\A=1000
\rpcode\font`\A=1000

\noindent
\testprotrusion{A}
\testprotrusion{\hskip0ptA\hskip0pt}
\testprotrusion{\kern1exA\kern1ex}
\testprotrusion{\kern1ex\unkern A\kern1ex\unkern}
\testprotrusion{\kern1ex\unkern\kern1ex\unkern
A\kern1ex\unkern\kern1ex\unkern}
\testprotrusion{\kern1ex\kern1ex\unkern\unkern
A\kern1ex\kern1ex\unkern\unkern}
\testprotrusion{Z}

\bye
% -----------------------------------------------------

My concern is about LaTeX packages which might insert kerns
as markers. For example, the csquotes package, or the
footmisc package.

I suppose that protrusion should take place at every point
where TeX allows a line break -- is that correct?


Regards,
Robert

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2004-09-19 23:39

Message:
Logged In: YES 
user_id=929

This patch should solve now the problems with character
protrusion, particularily also in combination with font
expansion, see the attached PDF files and the README file.

Have fun! :-)

Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2004-09-19 17:09

Message:
Logged In: YES 
user_id=929

still problems with expanded fonts, see PDF

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2004-09-19 13:49

Message:
Logged In: YES 
user_id=929

This patch should work now, see PDF files in the tarball.

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2004-09-19 12:42

Message:
Logged In: YES 
user_id=929

Patch tries to solve the bug. Seems to run with Robert's
example.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=115&group_id=106
From noreply at sarovar.org  Fri Oct  1 17:17:39 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Oct  1 17:18:49 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-199 ] font expansion: characters may
	vanish
Message-ID: <E1CDPAB-00006k-00@sarovar.org>

Bugs item #199, was opened at 2004-09-22 23:13
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=199&group_id=106

>Category: hz
>Group: v1.20a
>Status: Open
Resolution: Rejected
Priority: 5
Submitted By: Nobody (None)
>Assigned to: The Thanh Han (hanthethanh)
Summary: font expansion: characters may vanish

Initial Comment:

For extremely large shrink values, characters may not
be visible in the pdf output (although the fonts seem
to be embedded), e.g. in the following file:

%----------------------------------------------
\hsize220pt
\pdfadjustspacing=2
\font\testfont=cmr17 at 90pt\testfont
\pdffontexpand\font 0 1000 100 autoexpand
\efcode\font`\s=500
\efcode\font`\e=500
\efcode\font`\y=500

see what you get\penalty-10000

\bye
%----------------------------------------------

or even worse:

%----------------------------------------------
\hsize180pt
\pdfadjustspacing=2
\font\testfont=cmr17 at 90pt\testfont
\pdffontexpand\font 0 1000 100 autoexpand

see what you get\penalty-10000

\bye
%----------------------------------------------

The font `cmr17-Extend_100' will not be visible.

I only managed to achieve this effect with extremely
large font sizes, which may or may not be related (it
could also be that I didn't find the `magic' \hsize).

If you force the characters to shrink even more, for
example by setting \hsize to 120pt in the latter test
file, the unexpanded font will be used, thus printing
the characters over each other.


Regards,
Robert  <w.m.l@gmx.net>

PS. I didn't bother to create expanded fonts, so I
cannot tell whether it depends on the autoexpand feature.


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2004-10-01 17:17

Message:
Logged In: YES 
user_id=421

I you mean the effect in the attached pdf: This is either a
bug in Jaws (png attached) or a bug in pdftex. gs 8.30,
harlequin 5.3.4a and AR 5 all display the file distorted. :-(

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-29 00:06

Message:
Logged In: NO 

But the problem I mentioned above in the last paragraph
isn't related to Acrobat Reader, is it?
% ------------------------------------------
\hsize35pt
\pdfadjustspacing=2
\font\testfont=cmr12\testfont
\pdffontexpand\font 0 1000 100 autoexpand

text text text text\penalty-10000

\bye
% ------------------------------------------

Seems like a sanity check is missing somewhere. If my guess
is right, pdftex tries to use the font `cmr17-Extend_0',
which (incorrectly) translates into the base font. What it
should probably do is use the smallest available expanded
font, i.e. in this case Extend_100, and make the line overfull.

Regards,
Robert.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2004-09-27 17:27

Message:
Logged In: YES 
user_id=421

An Acrobat Reader bug. :-)

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-23 00:02

Message:
Logged In: NO 

Obviously, I filed this report too early. Sorry about that.

It is not a pdftex bug, but appears to be a bug in Acrobat
Reader 6. (Just to tell you what I saw:) At zoom level 200%
or larger, the font most shrunk (Extend_100) is not visible
on screen. That is, in the first example, I only see "See y
e", in the second, nothing at all. However, if I zoom out,
the characters re-appear. 

Sorry for not zooming out earlier. 

Regards,
Robert.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=199&group_id=106
From noreply at sarovar.org  Fri Oct  1 17:20:29 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Oct  1 17:21:57 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-199 ] font expansion: characters may
	vanish
Message-ID: <E1CDPCv-00007P-00@sarovar.org>

Bugs item #199, was opened at 2004-09-22 23:13
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=199&group_id=106

Category: hz
Group: v1.20a
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Nobody (None)
Assigned to: The Thanh Han (hanthethanh)
Summary: font expansion: characters may vanish

Initial Comment:

For extremely large shrink values, characters may not
be visible in the pdf output (although the fonts seem
to be embedded), e.g. in the following file:

%----------------------------------------------
\hsize220pt
\pdfadjustspacing=2
\font\testfont=cmr17 at 90pt\testfont
\pdffontexpand\font 0 1000 100 autoexpand
\efcode\font`\s=500
\efcode\font`\e=500
\efcode\font`\y=500

see what you get\penalty-10000

\bye
%----------------------------------------------

or even worse:

%----------------------------------------------
\hsize180pt
\pdfadjustspacing=2
\font\testfont=cmr17 at 90pt\testfont
\pdffontexpand\font 0 1000 100 autoexpand

see what you get\penalty-10000

\bye
%----------------------------------------------

The font `cmr17-Extend_100' will not be visible.

I only managed to achieve this effect with extremely
large font sizes, which may or may not be related (it
could also be that I didn't find the `magic' \hsize).

If you force the characters to shrink even more, for
example by setting \hsize to 120pt in the latter test
file, the unexpanded font will be used, thus printing
the characters over each other.


Regards,
Robert  <w.m.l@gmx.net>

PS. I didn't bother to create expanded fonts, so I
cannot tell whether it depends on the autoexpand feature.


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2004-10-01 17:17

Message:
Logged In: YES 
user_id=421

I you mean the effect in the attached pdf: This is either a
bug in Jaws (png attached) or a bug in pdftex. gs 8.30,
harlequin 5.3.4a and AR 5 all display the file distorted. :-(

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-29 00:06

Message:
Logged In: NO 

But the problem I mentioned above in the last paragraph
isn't related to Acrobat Reader, is it?
% ------------------------------------------
\hsize35pt
\pdfadjustspacing=2
\font\testfont=cmr12\testfont
\pdffontexpand\font 0 1000 100 autoexpand

text text text text\penalty-10000

\bye
% ------------------------------------------

Seems like a sanity check is missing somewhere. If my guess
is right, pdftex tries to use the font `cmr17-Extend_0',
which (incorrectly) translates into the base font. What it
should probably do is use the smallest available expanded
font, i.e. in this case Extend_100, and make the line overfull.

Regards,
Robert.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2004-09-27 17:27

Message:
Logged In: YES 
user_id=421

An Acrobat Reader bug. :-)

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-23 00:02

Message:
Logged In: NO 

Obviously, I filed this report too early. Sorry about that.

It is not a pdftex bug, but appears to be a bug in Acrobat
Reader 6. (Just to tell you what I saw:) At zoom level 200%
or larger, the font most shrunk (Extend_100) is not visible
on screen. That is, in the first example, I only see "See y
e", in the second, nothing at all. However, if I zoom out,
the characters re-appear. 

Sorry for not zooming out earlier. 

Regards,
Robert.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=199&group_id=106
From noreply at sarovar.org  Fri Oct  1 20:41:21 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Oct  1 20:42:40 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-199 ] font expansion: characters may
	vanish
Message-ID: <E1CDSLJ-0003m7-00@sarovar.org>

Bugs item #199, was opened at 2004-09-22 21:13
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=199&group_id=106

Category: hz
Group: v1.20a
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Nobody (None)
Assigned to: The Thanh Han (hanthethanh)
Summary: font expansion: characters may vanish

Initial Comment:

For extremely large shrink values, characters may not
be visible in the pdf output (although the fonts seem
to be embedded), e.g. in the following file:

%----------------------------------------------
\hsize220pt
\pdfadjustspacing=2
\font\testfont=cmr17 at 90pt\testfont
\pdffontexpand\font 0 1000 100 autoexpand
\efcode\font`\s=500
\efcode\font`\e=500
\efcode\font`\y=500

see what you get\penalty-10000

\bye
%----------------------------------------------

or even worse:

%----------------------------------------------
\hsize180pt
\pdfadjustspacing=2
\font\testfont=cmr17 at 90pt\testfont
\pdffontexpand\font 0 1000 100 autoexpand

see what you get\penalty-10000

\bye
%----------------------------------------------

The font `cmr17-Extend_100' will not be visible.

I only managed to achieve this effect with extremely
large font sizes, which may or may not be related (it
could also be that I didn't find the `magic' \hsize).

If you force the characters to shrink even more, for
example by setting \hsize to 120pt in the latter test
file, the unexpanded font will be used, thus printing
the characters over each other.


Regards,
Robert  <w.m.l@gmx.net>

PS. I didn't bother to create expanded fonts, so I
cannot tell whether it depends on the autoexpand feature.


----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2004-10-01 18:41

Message:
Logged In: YES 
user_id=929

tiny patch tries to solve this bug. See README and PDF test
file included.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2004-10-01 15:17

Message:
Logged In: YES 
user_id=421

I you mean the effect in the attached pdf: This is either a
bug in Jaws (png attached) or a bug in pdftex. gs 8.30,
harlequin 5.3.4a and AR 5 all display the file distorted. :-(

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-28 22:06

Message:
Logged In: NO 

But the problem I mentioned above in the last paragraph
isn't related to Acrobat Reader, is it?
% ------------------------------------------
\hsize35pt
\pdfadjustspacing=2
\font\testfont=cmr12\testfont
\pdffontexpand\font 0 1000 100 autoexpand

text text text text\penalty-10000

\bye
% ------------------------------------------

Seems like a sanity check is missing somewhere. If my guess
is right, pdftex tries to use the font `cmr17-Extend_0',
which (incorrectly) translates into the base font. What it
should probably do is use the smallest available expanded
font, i.e. in this case Extend_100, and make the line overfull.

Regards,
Robert.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2004-09-27 15:27

Message:
Logged In: YES 
user_id=421

An Acrobat Reader bug. :-)

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-09-22 22:02

Message:
Logged In: NO 

Obviously, I filed this report too early. Sorry about that.

It is not a pdftex bug, but appears to be a bug in Acrobat
Reader 6. (Just to tell you what I saw:) At zoom level 200%
or larger, the font most shrunk (Extend_100) is not visible
on screen. That is, in the first example, I only see "See y
e", in the second, nothing at all. However, if I zoom out,
the characters re-appear. 

Sorry for not zooming out earlier. 

Regards,
Robert.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=199&group_id=106
From hartmut_henkel at gmx.de  Sat Oct  2 16:44:57 2004
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sat Oct  2 16:45:01 2004
Subject: [NTG-pdftex] writepng-copy in pdfxtex 
Message-ID: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>

just thought that we maybe could safely test the fast (copy) PNG
inclusion by pdfxtex, e. g. making some global flag in texmfmp.c,

#if defined(pdfTeX) || defined(pdfeTeX) || defined(pdfxTeX)
string ptexbanner = BANNER;
enum ptexengine_ {PDFTEX, PDFETEX, PDFXTEX};
#if defined(pdfTeX)
int ptexengine = PDFTEX;
#endif
#if defined(pdfeTeX)
int ptexengine = PDFETEX;
#endif
#if defined(pdfxTeX)
int ptexengine = PDFXTEX;
#endif
#endif

so that ptexengine is available everywhere and then also add the
xwrite_png() with the COPY feature in addition to the standard
write_png() into writepng.c and have

if(ptexengine == PDFXTEX) xwrite_png(img); else write_png(img);

or so in writeimg.c. Is it still worthwile or is pdftex frozen by now
for texlive?

Regards, Hartmut
From pragma at wxs.nl  Sat Oct  2 20:23:08 2004
From: pragma at wxs.nl (h h extern)
Date: Sat Oct  2 20:23:13 2004
Subject: [NTG-pdftex] writepng-copy in pdfxtex
In-Reply-To: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
References: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
Message-ID: <415EF20C.9050909@wxs.nl>

Hartmut Henkel wrote:

> just thought that we maybe could safely test the fast (copy) PNG
> inclusion by pdfxtex, e. g. making some global flag in texmfmp.c,
> 
> #if defined(pdfTeX) || defined(pdfeTeX) || defined(pdfxTeX)
> string ptexbanner = BANNER;
> enum ptexengine_ {PDFTEX, PDFETEX, PDFXTEX};
> #if defined(pdfTeX)
> int ptexengine = PDFTEX;
> #endif
> #if defined(pdfeTeX)
> int ptexengine = PDFETEX;
> #endif
> #if defined(pdfxTeX)
> int ptexengine = PDFXTEX;
> #endif
> #endif
> 
> so that ptexengine is available everywhere and then also add the
> xwrite_png() with the COPY feature in addition to the standard
> write_png() into writepng.c and have
> 
> if(ptexengine == PDFXTEX) xwrite_png(img); else write_png(img);
> 
> or so in writeimg.c. Is it still worthwile or is pdftex frozen by now
> for texlive?

next week things will become frozen; i think we can smuggle a newer 
pdfxtex in the lin/win parts ... the more this is tested the better

martin?

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From ms at artcom-gmbh.de  Sat Oct  2 23:28:31 2004
From: ms at artcom-gmbh.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun Oct  3 01:02:28 2004
Subject: [NTG-pdftex] writepng-copy in pdfxtex
In-Reply-To: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
References: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
Message-ID: <20041002212830.GA29220@lucien.kn-bremen.de>

On 2004-10-02 16:44:57 +0200, Hartmut Henkel wrote:
> if(ptexengine == PDFXTEX) xwrite_png(img); else write_png(img);

Sounds good.

> or so in writeimg.c. Is it still worthwile or is pdftex frozen by now
> for texlive?

This needs testing and we have some open bugs. And I think TL is
very much frozen now. Let's aim for teTeX 3.0 :-)

Best regards
    Martin
-- 
               Martin Schr?der, ms@artcom-gmbh.de
     ArtCom GmbH, Lise-Meitner-Str 5, 28359 Bremen, Germany
          Voice +49 421 20419-44 / Fax +49 421 20419-10
                    http://www.artcom-gmbh.de
From pragma at wxs.nl  Sun Oct  3 22:48:52 2004
From: pragma at wxs.nl (h h extern)
Date: Sun Oct  3 22:48:59 2004
Subject: [NTG-pdftex] writepng-copy in pdfxtex
In-Reply-To: <20041002212830.GA29220@lucien.kn-bremen.de>
References: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
	<20041002212830.GA29220@lucien.kn-bremen.de>
Message-ID: <416065B4.309@wxs.nl>

Martin Schr?der wrote:

> On 2004-10-02 16:44:57 +0200, Hartmut Henkel wrote:
> 
>>if(ptexengine == PDFXTEX) xwrite_png(img); else write_png(img);
> 
> 
> Sounds good.
> 
> 
>>or so in writeimg.c. Is it still worthwile or is pdftex frozen by now
>>for texlive?
> 
> 
> This needs testing and we have some open bugs. And I think TL is
> very much frozen now. Let's aim for teTeX 3.0 :-)

eh ... better pdftex 1.22 which is probably sooner -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From noreply at sarovar.org  Thu Oct 14 02:28:06 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Oct 14 02:29:11 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-210 ] Map files with many (>255)
	different encodings make pdftex segfault. Bug fix by AVL tree.
Message-ID: <E1CHtTS-0006HE-00@sarovar.org>

Bugs item #210, was opened at 2004-10-14 00:28
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=210&group_id=106

Category: None
Group: v1.20a
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: Map files with many (>255) different encodings make pdftex segfault. Bug fix by AVL tree.

Initial Comment:
See E-Mail describing problem with typesetting chinese
texts:

Date: Wed, 13 Oct 2004 07:25:41 +0200
From: Lutz Haseloff <Lutz.Haseloff@lbapdm.brandenburg.de>
Reply-To: mailing list for ConTeXt users
<ntg-context@ntg.nl>
To: mailing list for ConTeXt users <ntg-context@ntg.nl>
Subject: Re: [NTG-context] Update to Pdfetex 1.20a

Hans Hagen schrieb:

> Lutz Haseloff wrote:
> 
> > Hi Hans, Hi all,
> > 
> > \loadmapfile[gbk]> > 
> > 
> > Is this a bug in pdfetex?
> 
> 
> welcome to the non downward compatible changes in tex
and friends

> > \usemodule[chinese]
> > \usemodule[chi-simplified]
> > \starttext
> > \section{test}
> > \stoptext

Patch seems to be solved by the patch in the attached file.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=210&group_id=106
From noreply at sarovar.org  Thu Oct 14 15:11:15 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Oct 14 15:12:39 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-116 ] character protrusion: pdftex may
	hang
Message-ID: <E1CI5Nz-0003z8-00@sarovar.org>

Bugs item #116, was opened at 2004-09-11 03:28
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=116&group_id=106

Category: hz
Group: v1.20a
Status: Open
Resolution: None
Priority: 7
Submitted By: Nobody (None)
Assigned to: The Thanh Han (hanthethanh)
Summary: character protrusion: pdftex may hang

Initial Comment:
pdfTeX will fail on the following LaTeX file:

----------------------------------------------------
\pdfprotrudechars 2
\documentclass{minimal}
\begin{document}
\fontsize{7}{8}\selectfont

This paragraph consists of more than two lines.
This paragraph consists of more than two lines.
This paragraph consists of more than two lines.

%% same for this paragraph:
% This is \hfill an empty line

\end{document}
----------------------------------------------------

pdfTeX will hang while building the paragraph, so it
seems. 

This does not happen with other font sizes. Also, it
somehow seems to depend on the fonts preloaded in the
format file. If I change this line in preload.ltx:

 \DeclarePreloadSizes{OT1}{cmr}{m}{n}{5,7,10}

so that the font for size 10 will be loaded first, and
recreate the format, all is well. 

I am using:

This is pdfeTeX, Version 3.141592-1.20a-2.2 (MiKTeX 2.4))


Regards,
Robert.


----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2004-10-14 18:41

Message:
Logged In: NO 

I have also had this problem with v1.10a and v1.20a.  The problem only 
occurs with \pdfprotrudechars=2 (not when it is 1). Changing the font-size 
sometimes fixes it, as does changing the font encoding (presumably this 
alters the line breaking sufficiently not to bring about the specific conditions 
that cause the hang).

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2004-09-17 03:48

Message:
Logged In: YES 
user_id=929

seems it's a loop in hz.ch, function total_pw(), always
returning to the reswitch: label. I don't know what's going
on, but supposing that the current line loop or whatever
should end when the post_break(l) is reached, just shifting
the goto reswitch; to this place:

                decr(n);
            end;
            goto reswitch;
        end;
    end;
    total_pw := left_pw(l) + right_pw(r);
end;

seems to make it work. No idea how to test it...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=116&group_id=106
From noreply at sarovar.org  Thu Oct 14 22:07:21 2004
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Oct 14 22:08:51 2004
Subject: [NTG-pdftex] [ pdftex-Bugs-210 ] Map files with many (>255)
	different encodings make pdftex segfault. Bug fix by AVL tree.
Message-ID: <E1CIBsf-0003AF-00@sarovar.org>

Bugs item #210, was opened at 2004-10-14 00:28
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=210&group_id=106

Category: None
Group: v1.20a
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: Map files with many (>255) different encodings make pdftex segfault. Bug fix by AVL tree.

Initial Comment:
See E-Mail describing problem with typesetting chinese
texts:

Date: Wed, 13 Oct 2004 07:25:41 +0200
From: Lutz Haseloff <Lutz.Haseloff@lbapdm.brandenburg.de>
Reply-To: mailing list for ConTeXt users
<ntg-context@ntg.nl>
To: mailing list for ConTeXt users <ntg-context@ntg.nl>
Subject: Re: [NTG-context] Update to Pdfetex 1.20a

Hans Hagen schrieb:

> Lutz Haseloff wrote:
> 
> > Hi Hans, Hi all,
> > 
> > \loadmapfile[gbk]> > 
> > 
> > Is this a bug in pdfetex?
> 
> 
> welcome to the non downward compatible changes in tex
and friends

> > \usemodule[chinese]
> > \usemodule[chi-simplified]
> > \starttext
> > \section{test}
> > \stoptext

Patch seems to be solved by the patch in the attached file.


----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2004-10-14 20:07

Message:
Logged In: YES 
user_id=929

Fixed patch for built-in encodings.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=210&group_id=106
From pragma at wxs.nl  Sun Oct 24 22:12:43 2004
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Oct 24 22:12:44 2004
Subject: [NTG-pdftex] writepng-copy in pdfxtex
In-Reply-To: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
References: <Pine.LNX.4.61.0410021634090.8810@hahepc1.hahe>
Message-ID: <417C0CBB.8090505@wxs.nl>

When i export a pdf as eps from acrobat, i get the followign error in gs:

  <rdf:Description rdf:about='uuid:96e94a33-f938-406d-8ffa-dd19c631fb97' 
xmlns:pdfx='http://ns.adobe.com/pdfx/1.3/' 
pdfx:ID='mpy-blind-mpgraph.20041024' 
pdfx:ConTeXt.Version='2004.10.22'><pdfx:PTEX.Fullbanner>This is pdfeTeX, 
Version 3.141592--1.20a--2.2  (

i reported this bug to the gs folks, since i fear that we cannot do 
anything about it (adding crlf or so)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sun Oct 24 23:11:48 2004
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Oct 24 23:11:50 2004
Subject: [NTG-pdftex] gs problem
Message-ID: <417C1A94.9060503@wxs.nl>

(I cc to volker, maybe he can mention this to Hermann Zapf who is
redoing the fonts). Interestingly Hermann is not mentioned in the
copyright notice of his own fonts.)

Hi,

The optima nova fonts have pretty long copyright notices and these give
problems in ghostscript

/Copyright (The digitally encoded machine readable software for
producing the Typefaces licensed to you is copyrighted (c) 1981, 1999,
2002 Linotype Library GmbH or its affiliated companies. All rights
reserved. This software is now the property of Heidelberger
Druckmaschinen AG and its licensors, and may not be reproduced, used,
displayed, modified, disclosed or transferred without the express
written approval of Heidelberger Druckmaschinen AG. Part of the digital
encoded machine readable software for producing the Typefaces licensed
to you is copyrighted (c) 1981, 1999 Adobe Systems. All rights reserved.
Part of this software is the property of Adobe Systems Incorporated and
its licensors, and may not be reproduced, used, displayed, modified,
disclosed or transferred without the express written approval of Adobe.)
readonly def
/Notice (Optima is a trademark of Heidelberger Druckmaschinen AG, which
may be registered in certain jurisdictions, exclusively licensed through
Linotype Library GmbH, a wholly owned subsidiary of Heidelberger
Druckmaschinen AG.) readonly def

maybe pdftex can split too long lines into multiple /Copyright () lines


Hans

-----------------------------------------------------------------
                                            Hans Hagen | PRAGMA ADE
                Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                               | www.pragma-pod.nl
-----------------------------------------------------------------


From reinhard.kotucha at web.de  Mon Oct 25 02:21:30 2004
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Mon Oct 25 02:21:38 2004
Subject: [NTG-pdftex] gs problem
In-Reply-To: <417C1A94.9060503@wxs.nl>
References: <417C1A94.9060503@wxs.nl>
Message-ID: <16764.18186.208707.275275@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

    > (I cc to volker, maybe he can mention this to Hermann Zapf who
    > is redoing the fonts). Interestingly Hermann is not mentioned in
    > the copyright notice of his own fonts.)

    > Hi,

    > The optima nova fonts have pretty long copyright notices and
    > these give problems in ghostscript


Hi, did you try the font with other programs?  It seems to be most
probably a bug in ghostscript.

A copyright notice in a Type 1 font is just a string.  I didn't find
anything about limitations in the Type 1 Reference Manual or TN 5015.

The PostScript Language Reference Manual (Appendix B) describes PS
interpreter requirements.  According to this, any PS interpreter
should be able to handle strings of least 65535 bytes.

There are some restrictions for ATM compatibility but obviously they
do not affect string lengths.

So I think that ghostscript is the culprit and the bug should be fixed
there.  Can you send me a small file which shows this problem?  At the
moment I have 30 different versions of gs installed on my system and
it shouldn't bee too difficult to find out which versions are affected
(or when this bug had been introduced).

    > [...]
    > maybe pdftex can split too long lines into multiple /Copyright
    > () lines

I think that pdftex should remove anything from a font which is not
needed, but as far as the copyright notice is concerned, it's
certainly best to leave it as it is.

Technically, it is wrong to split it into multiple lines.  For example:

/Copyright (copyright by me.) def
/Copyright (you are not allowed to) def
/Copyright (give this font away!) def

The content of /Copyright is now the string "give this font away!".

Even worse, /Copyright is defined as "readonly def".  A PS interpreter
should complain if someone tries to overwrite the initial definition.

I agree with you that the copyright notice is much too long.  Nobody
spends much time to read so boring stuff, anyway.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From pragma at wxs.nl  Mon Oct 25 09:55:37 2004
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Oct 25 09:55:42 2004
Subject: [NTG-pdftex] gs problem
In-Reply-To: <16764.18186.208707.275275@zarniwoop.ms25.local>
References: <417C1A94.9060503@wxs.nl>
	<16764.18186.208707.275275@zarniwoop.ms25.local>
Message-ID: <417CB179.9000900@wxs.nl>

Reinhard Kotucha wrote:

> Hi, did you try the font with other programs?  It seems to be most
> probably a bug in ghostscript.

> A copyright notice in a Type 1 font is just a string.  I didn't find
> anything about limitations in the Type 1 Reference Manual or TN 5015.

hm, i found out that when for instance afm files have lines longer than 
256, some programs break on it so either we have to do with fuzzy specs, 
or rumoured lengths, or lousy programming

> The PostScript Language Reference Manual (Appendix B) describes PS
> interpreter requirements.  According to this, any PS interpreter
> should be able to handle strings of least 65535 bytes.

Interesting, i wonder why gs has limitations then; what does the spec 
say about unknown %%comments? GS breaks on them each time adobe adds a 
new undocumented one.

> So I think that ghostscript is the culprit and the bug should be fixed
> there.  Can you send me a small file which shows this problem?  At the
> moment I have 30 different versions of gs installed on my system and
> it shouldn't bee too difficult to find out which versions are affected
> (or when this bug had been introduced).

i filled in a bug report for gs; i also downloaded the 8.31 beta version 
which seems to work ok; this means that the official version has problems

> /Copyright (copyright by me.) def
> /Copyright (you are not allowed to) def
> /Copyright (give this font away!) def
> 
> The content of /Copyright is now the string "give this font away!".

i hadn't thought of that one -)

> Even worse, /Copyright is defined as "readonly def".  A PS interpreter
> should complain if someone tries to overwrite the initial definition.

we could zip it:

if length> 255 then /Copyright(zipped: ,zipped string>} -)


Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From reinhard.kotucha at web.de  Mon Oct 25 23:53:14 2004
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Mon Oct 25 23:53:47 2004
Subject: [NTG-pdftex] gs problem
In-Reply-To: <417CB179.9000900@wxs.nl>
References: <417C1A94.9060503@wxs.nl>
	<16764.18186.208707.275275@zarniwoop.ms25.local>
	<417CB179.9000900@wxs.nl>
Message-ID: <16765.30154.431777.850241@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

    > hm, i found out that when for instance afm files have lines
    > longer than 256, some programs break on it so either we have to
    > do with fuzzy specs, or rumoured lengths, or lousy programming

This is described in
 http://partners.adobe.com/asn/developer/pdfs/tn/5004.AFM_Spec.pdf 
on page 10:

   | Comments can be present in an AFM file. They are introduced
   | by the keyword Comment and are terminated by the end of
   | line. Lines are no longer than 255 characters long.


    >> The PostScript Language Reference Manual (Appendix B) describes
    >> PS interpreter requirements.  According to this, any PS
    >> interpreter should be able to handle strings of least 65535
    >> bytes.

    > Interesting, i wonder why gs has limitations then; what does the
    > spec say about unknown %%comments? GS breaks on them each time
    > adobe adds a new undocumented one.

From
 http://partners.adobe.com/asn/developer/PDFS/TN/5001.DSC_Spec.pdf
page 21:

   | A non-conforming document is recognized by the %! header
   | comment. Under no circumstances should a non-conforming
   | document use the %!PS-Adobe-3.0 header comment.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From hanthethanh at myrealbox.com  Tue Oct 26 18:15:10 2004
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Wed Oct 27 04:01:01 2004
Subject: [NTG-pdftex] vadjust.ch -- change file entry didn't match
Message-ID: <20041026161510.GA14118@monty>

Hi,

after a sync from p4 TL server I tried to build pdftex but failed with
the error "change file entry didn't match" on file vadjust.ch, line 183.
Has anyone experienced the same problem?

Thanh
From hanthethanh at myrealbox.com  Fri Oct 29 16:41:51 2004
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Sat Oct 30 03:25:07 2004
Subject: [NTG-pdftex] changes in search paths
Message-ID: <20041029144151.GG315@monty>

Hi,

does anyone have a summary of changed search paths in newer web2c? What
I would like to have is a list of things that need to be changed if I
have an `old' texmf tree (for example from texlive7) and want to run `new'
tex/pdftex with it. I changed a few things to get pdftex run on my
machine of course, but I don't remember all those steps. If such a list
is already available it would be much useful and not only to me :)

Thanh
From hanthethanh at myrealbox.com  Fri Oct 29 16:30:46 2004
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Sat Oct 30 03:26:50 2004
Subject: [NTG-pdftex] pdftex-1.20b-beta
Message-ID: <20041029143046.GD315@monty>

Hi,

I uploaded a beta version for pdftex-1.20b to pdftex.sarovar.org/src

djgpp binaries are also available at pdftex.sarovar.org/djgpp

This version tries to fix pending problems with hz in pdftex-1.20a.
Various patches from Hartmut have been integrated.

Comments/bug reports are very welcome.

Thanh
From pragma at wxs.nl  Sat Oct 30 10:23:32 2004
From: pragma at wxs.nl (h h extern)
Date: Sat Oct 30 10:23:35 2004
Subject: [NTG-pdftex] changes in search paths
In-Reply-To: <20041029144151.GG315@monty>
References: <20041029144151.GG315@monty>
Message-ID: <41834F84.6060907@wxs.nl>

The Thanh Han wrote:

> Hi,
> 
> does anyone have a summary of changed search paths in newer web2c? What
> I would like to have is a list of things that need to be changed if I
> have an `old' texmf tree (for example from texlive7) and want to run `new'
> tex/pdftex with it. I changed a few things to get pdftex run on my
> machine of course, but I don't remember all those steps. If such a list
> is already available it would be much useful and not only to me :)

- add the old enc & map paths to the new ones
- add old pdftex/etex specific to the new ones

I attached my (minimal) texmf.cnf file

Karl Berry will make a web page (at the tug site) with all changes.

In the context distribution there is textools.rb which has the option 
--fixtexmftrees (which will move files to the new place)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------
-------------- next part --------------
% This file is mostly the same as the one that ships with
% texlive, but adapted for multiple trees as well as
% development in a non tds tree (i.e. hh's machine). This
% file is meant for context users.
%
% This file loads before texmf/web2c/texmf.cnf; beware :
% the selfish auto parent can get in the way especially when
% the binaries are located elsewhere. In case of multiple
% trees, one can best set the following ones manually.

TEXMFMAIN     = $SELFAUTOPARENT/texmf
TEXMFLOCAL    = $SELFAUTOPARENT/texmf-local
TEXMFFONTS    = $SELFAUTOPARENT/texmf-fonts
TEXMFEXTRA    = $SELFAUTOPARENT/texmf-extra
TEXMFPROJECTS = $SELFAUTOPARENT/texmf-projects
VARTEXMF      = $SELFAUTOPARENT/texmf-var
HOMETEXMF     = /nonexist
TEXMF         = {$TEXMFPROJECT,$TEXMFFONTS,$TEXMFLOCAL,$TEXMFEXTRA,!!$TEXMFMAIN}
SYSTEXMF      = $TEXMF

TEXMFCNF      = .;$TEXMF/texmf{-local,}/web2c
TEXMFDBS      = $TEXMF;$VARTEXFONTS

VARTEXFONTS   = $TEMPFONTPATH/varfonts

% In the case of an multi-os setup, this one can be set
% by the environment.

TEXFORMATS    = .;$TEXMF/web2c
MFBASES       = .;$TEXFORMATS
MPMEMS        = .;$TEXFORMATS
TEXPOOL       = .;$TEXFORMATS
MFPOOL        = .;$TEXFORMATS
MPPOOL        = .;$TEXFORMATS

WEB2C         = $TEXMF/web2c

% fonts, for the moment we also support the old enc/map locations

TEXPSHEADERS  = .;$TEXMF/{fonts/{enc,map,type1,truetype},dvips,pdftex,tex}//;$TEXMF/{etex,tex,pdftex,dvips,fonts/type1}//
TEXFONTMAPS   = .;$TEXMF/{fonts/map//,fontname};$TEXMF/{pdftex,dvips}/config;$TEXMF/{pdftex,dvips}//

VFFONTS       =	.;$TEXMF/fonts/vf//
TFMFONTS      =	.;{$TEXMF/fonts,$VARTEXFONTS}/tfm//

T1FONTS       =	.;$TEXMF/fonts/{type1,pfb}//;$TEXMF/fonts/misc/hbf//
AFMFONTS      =	.;$TEXMF/fonts/afm//
LIGFILES      =	.;$TEXMF/fonts/lig//
TTFONTS       =	.;$TEXMF/fonts/{truetype,ttf}//
TTF2TFMINPUTS =	.;$TEXMF/ttf2pk//
T42FONTS      =	.;$TEXMF/fonts/type42//
MISCFONTS     =	.;$TEXMF/fonts/misc//
ENCFONTS      = .;$TEXMF/{fonts/enc,dvips}//
CMAPFONTS     = .;$TEXMF/fonts/cmap//
SFDFONTS      = .;$TEXMF/fonts/sfd//
OPENTYPEFONTS = .;$TEXMF/fonts/opentype//

OFMFONTS      =	.;{$TEXMF/fonts,$VARTEXFONTS}/{ofm,tfm}//;$TFMFONTS
OPLFONTS      =	.;{$TEXMF/fonts,$VARTEXFONTS}/opl//
OVFFONTS      =	.;{$TEXMF/fonts,$VARTEXFONTS}/ovf//
OVPFONTS      =	.;{$TEXMF/fonts,$VARTEXFONTS}/ovp//
OTPINPUTS     =	.;$TEXMF/omega/otp//
OCPINPUTS     =	.;$TEXMF/omega/ocp//

% configurations

$CTXDEVTXPATH=rubish
$CTXDEVMPPATH=rubish
$CTXDEVMFPATH=rubish

TEXINPUTS.context = .;$CTXDEVTXPATH//;$TEXMF/{pdftex,pdfetex,etex,omega,tex}/{context,plain,generic,}//
MPINPUTS          = .;$CTXDEVMPPATH//;$TEXMF/metapost//
MFINPUTS          = .;$CTXDEVMFPATH//;$TEXMF/metafont//;{$TEXMF/fonts,$VARTEXFONTS}/source//

TEXCONFIG     =	.;$TEXMF/{fonts/map,dvips,pdftex}//
PDFTEXCONFIG  = .;$TEXMF/pdftex/{$progname,}//
DVIPDFMINPUTS =	.;$TEXMF/{dvipdfm,{dvips,fonts/{map,enc}/{dvips,}}}//

% this way we can hook in development paths

$CTXDEVPLPATH=rubish
$CTXDEVPYPATH=rubish
$CTXDEVRBPATH=rubish
$CTXDEVJVPATH=rubish

% some old paths; we restrict the search to context paths; new ones as well as old ones

PERLINPUTS   = .;$CTXDEVPLPATH//;$TEXMF/scripts/context/perl//;$TEXMF/{context/perl,context/perltk,perl,perltk}//
PYTHONINPUTS = .;$CTXDEVPYPATH//;$TEXMF/scripts/context/python//;$TEXMF/{context/python,python}//
RUBYINPUTS   = .;$CTXDEVRBPATH//;$TEXMF/scripts/context/ruby//;$TEXMF/{context/ruby,ruby}//
JAVAINPUTS   = .;$CTXDEVJVPATH//;$TEXMF/scripts/context/java//;$TEXMF/{context/java,java}//

TEXMFSCRIPTS = .;$CTXDEVRBPATH//;$CTXDEVPLPATH//;$TEXMF/scripts/context//;$TEXMF/scripts//

% features

shell_escape            = t
%openout_any            = a
openout_any             = p
openin_any              = a
parse_first_line        = f
allow_multiple_suffixes = f

% auto generation

MKTEXTEX = 0
MKTEXPK  = 0
MKTEXMF  = 0
MKTEXTFM = 0
MKOCP    = 0
MKOFM    = 0

% metapost

MPXCOMMAND = texexec --batch --once --nomp --mptex
TEX        = texexec --batch --once --nomp

% These values are about the same as in the main
% configuration file (dest_names_size added).

buf_size.context         =  200000 % needed for omega bug
extra_mem_bot.context    = 2000000
extra_mem_top.context    = 2000000
font_max.context         =    2000
font_mem_size.context    = 1000000
hash_extra.context       =   50000
main_memory.context      = 1500000
max_strings.context      =  200000
nest_size.context        =     500
obj_tab_size.context     =  300000
dest_names_size.context  =  300000
param_size.context       =    5000
pool_free.context        =   47500
pool_size.context        = 1250000
save_size.context        =   50000
stack_size.context       =    5000
string_vacancies.context =   90000
trie_size.context        =	250000

main_memory.mpost        = 3000000
pool_size.mpost          = 3000000
path_size.mpost          =	 10000

main_memory.metafun      = 3000000
pool_size.metafun        = 3000000
path_size.metafun        =	 10000

buf_size                 =  100000

mp_buf_size              =   30000
mf_buf_size              =   30000
mpost_buf_size           =   30000

max_print_line.mpost     =     250
max_print_line.metafun   =     250

extra_mem_top.mptopdf    = 1000000
extra_mem_bot.mptopdf    = 1000000

ocp_buf_size             =  500000
ocp_stack_size           =   10000
ocp_list_size            =	  1000
From hartmut_henkel at gmx.de  Sat Oct 30 12:23:25 2004
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sat Oct 30 12:23:34 2004
Subject: [NTG-pdftex] pdftex-1.20b-beta
In-Reply-To: <20041029143046.GD315@monty>
References: <20041029143046.GD315@monty>
Message-ID: <Pine.LNX.4.61.0410301206350.3672@hahepc1.hahe>

Hi Thanh,

On Fri, 29 Oct 2004, The Thanh Han wrote:

> I uploaded a beta version for pdftex-1.20b to pdftex.sarovar.org/src

i had some path finding difficulties, then just dropped the contents
from pdfetexdir, pdfxtexdir, and pdftexdir into teTeX-2.99.1-beta. It
compiled ok and a first quick check shows that it runs fine on all test
files from bug 115 and 116 :-)

What about bug 210? The writeenc.c would just be a drop-in replacement,
"mostly harmless". Do you have any objections? If so, one should
increase SMALL_ARRAY_SIZE, to make chinese folks happy.

Also bugs 112 and 113 are yet unpatched (just for the record).

Regards, Hartmut
From hanthethanh at myrealbox.com  Sun Oct 31 02:53:20 2004
From: hanthethanh at myrealbox.com (The Thanh Han)
Date: Sun Oct 31 02:53:21 2004
Subject: [NTG-pdftex] pdftex-1.20b-beta
In-Reply-To: <Pine.LNX.4.61.0410301206350.3672@hahepc1.hahe>
References: <20041029143046.GD315@monty>
	<Pine.LNX.4.61.0410301206350.3672@hahepc1.hahe>
Message-ID: <20041031015319.GA1001@monty>

Hi Hartmut,

thanks for testing and reporting.

My changes were mostly in hz.ch only -- the rest were some hacks around
to get it compiled :(

Sorry about the pending bugs 112, 113 & 210. Will upload a new tarball
with the patches integrated on Monday.

Regards,
Thanh


On Sat, Oct 30, 2004 at 12:23:25PM +0200, Hartmut Henkel wrote:
> Hi Thanh,
> 
> On Fri, 29 Oct 2004, The Thanh Han wrote:
> 
> > I uploaded a beta version for pdftex-1.20b to pdftex.sarovar.org/src
> 
> i had some path finding difficulties, then just dropped the contents
> from pdfetexdir, pdfxtexdir, and pdftexdir into teTeX-2.99.1-beta. It
> compiled ok and a first quick check shows that it runs fine on all test
> files from bug 115 and 116 :-)
> 
> What about bug 210? The writeenc.c would just be a drop-in replacement,
> "mostly harmless". Do you have any objections? If so, one should
> increase SMALL_ARRAY_SIZE, to make chinese folks happy.
> 
> Also bugs 112 and 113 are yet unpatched (just for the record).
> 
> Regards, Hartmut
From kakuto at fsci.fuk.kindai.ac.jp  Sun Oct 31 03:29:13 2004
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Sun Oct 31 03:29:21 2004
Subject: [NTG-pdftex] pdftex-1.20b-beta
In-Reply-To: Your message of "Sun, 31 Oct 2004 08:53:20 +0700"
References: <20041031015319.GA1001@monty>
Message-ID: <200410310229.i9V2TEKp016129@jupiter.fsci.fuk.kindai.ac.jp>

The Thanh Han wrote:

> thanks for testing and reporting.
> 
> My changes were mostly in hz.ch only -- the rest were some hacks around
> to get it compiled :(
> 
> Sorry about the pending bugs 112, 113 & 210. Will upload a new tarball
> with the patches integrated on Monday.

In the next chance, please change the content of
pdftexdir/pdftex.version
from
3.141592-1.20b-beta
to
1.20b-beta.

Then it will match Olaf's setting and
pdftexextra.h, pdfetexextra.h and pdfxtexextra.h
can be erased because they will be made from
pdftexextra.in, pdfetexextra.in and pdfxtexextra.in.

Thanks,
-- 
Akira Kakuto
From hartmut_henkel at gmx.de  Sun Oct 31 11:35:26 2004
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sun Oct 31 11:35:30 2004
Subject: [NTG-pdftex] writepng problem?
Message-ID: <Pine.LNX.4.61.0410311129400.6861@hahepc1.hahe>

here it seems that pdftex currently crashes on Willem van Schaik PNG
test files

basn4a08.png 8 bit grayscale + 8 bit alpha-channel
basn4a16.png 16 bit grayscale + 16 bit alpha-channel
basn6a08.png 3x8 bits rgb color + 8 bit alpha-channel
basn6a16.png 3x16 bits rgb color + 16 bit alpha-channel
bgan6a08.png 3x8 bits rgb color, alpha, no background chunk
bgan6a16.png 3x16 bits rgb color, alpha, no background chunk
bgbn4a08.png 8 bit grayscale, alpha, black background chunk
bggn4a16.png 16 bit grayscale, alpha, gray background chunk
bgwn6a08.png 3x8 bits rgb color, alpha, white background chunk
bgyn6a16.png 3x16 bits rgb color, alpha, yellow background chunk

and this seems to be due to something in the new libpng 1.2.7. Looks
like the allocated row buffer is overrun by 32 bytes. Happens only with
alpha channel, the png-implement list 10/04 has something about
png_set_strip_alpha...

Regards, Hartmut
