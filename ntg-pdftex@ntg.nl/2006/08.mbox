From noreply at sarovar.org  Tue Aug  8 13:08:55 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 08 Aug 2006 16:38:55 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GAPSB-00012W-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 13:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Michael (takrl)
Assigned to: Hartmut Henkel (hhenkel)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From noreply at sarovar.org  Tue Aug  8 13:09:36 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 08 Aug 2006 16:39:36 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GAPSq-0002Ms-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 13:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Michael (takrl)
>Assigned to: Nobody (None)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From noreply at sarovar.org  Tue Aug  8 13:17:07 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 08 Aug 2006 16:47:07 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GAPa7-0005ze-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 11:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Michael (takrl)
Assigned to: Nobody (None)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

>Comment By: The Thanh Han (hanthethanh)
Date: 2006-08-08 11:17

Message:
Logged In: YES 
user_id=710

>From an email from  Eddie Kohler:

=================================================
(2) Otftotfm generates map lines that tell pdftex to embed
the TTF directly
(cool!).  Unfortunately, pdftex does not like the Version
3.0 OS/2 table
included in OpenType TTFs (boo!), so I hacked the font to
change the OS/2
version number to 2.0.  Alternately, one could recompile
pdftex, after
changing line 1026 of writettf.c to:

    if (version != 0x0000 && version != 0x0001 && version !=
0x0002 &&
version != 0x0003)
=================================================

Martin, can you please include this patch into the next
release? Thanks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From noreply at sarovar.org  Tue Aug  8 13:50:55 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 08 Aug 2006 17:20:55 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GAQ6p-0002K0-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 13:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
>Resolution: Fixed
Priority: 5
Submitted By: Michael (takrl)
Assigned to: Nobody (None)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-08-08 13:50

Message:
Logged In: YES 
user_id=421

I've changed that line to

if (version > 3)

Michael, can you please attach a complete test case (all
needed inputs) to this bug report for future testing?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-08-08 13:17

Message:
Logged In: YES 
user_id=710

>From an email from  Eddie Kohler:

=================================================
(2) Otftotfm generates map lines that tell pdftex to embed
the TTF directly
(cool!).  Unfortunately, pdftex does not like the Version
3.0 OS/2 table
included in OpenType TTFs (boo!), so I hacked the font to
change the OS/2
version number to 2.0.  Alternately, one could recompile
pdftex, after
changing line 1026 of writettf.c to:

    if (version != 0x0000 && version != 0x0001 && version !=
0x0002 &&
version != 0x0003)
=================================================

Martin, can you please include this patch into the next
release? Thanks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From noreply at sarovar.org  Wed Aug  9 11:03:15 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 09 Aug 2006 14:33:15 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GAjy7-0005OJ-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 13:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
Resolution: Fixed
Priority: 5
Submitted By: Michael (takrl)
Assigned to: Nobody (None)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

>Comment By: Michael (takrl)
Date: 2006-08-09 11:03

Message:
Logged In: YES 
user_id=3803

Ok, I just made up a zip file containing test data and
attached it here...



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-08-08 13:50

Message:
Logged In: YES 
user_id=421

I've changed that line to

if (version > 3)

Michael, can you please attach a complete test case (all
needed inputs) to this bug report for future testing?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-08-08 13:17

Message:
Logged In: YES 
user_id=710

>From an email from  Eddie Kohler:

=================================================
(2) Otftotfm generates map lines that tell pdftex to embed
the TTF directly
(cool!).  Unfortunately, pdftex does not like the Version
3.0 OS/2 table
included in OpenType TTFs (boo!), so I hacked the font to
change the OS/2
version number to 2.0.  Alternately, one could recompile
pdftex, after
changing line 1026 of writettf.c to:

    if (version != 0x0000 && version != 0x0001 && version !=
0x0002 &&
version != 0x0003)
=================================================

Martin, can you please include this patch into the next
release? Thanks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From noreply at sarovar.org  Wed Aug  9 11:11:43 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 09 Aug 2006 14:41:43 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-594 ] PDF picture with Type3 fonts
	causes unkown XObject "R8"
Message-ID: <E1GAk6J-0006KF-00@sarovar.org>

Bugs item #594, was opened at 2006-08-09 11:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=594&group_id=106

Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Torsten Bronger (bronger)
Assigned to: Martin Schr?der (oneiros)
Summary: PDF picture with Type3 fonts causes unkown XObject "R8"

Initial Comment:
Please have a look at the attached minimal file.  It
just includes a PDF with LaTeX's \includegraphics.  The
result is an illegal PDF accoursing to acroread and
Ghostscript.  acroread speaks on an unknown XObject
called "R8" (I also saw R10 in another case).

The reason is probably the Type3 fonts used in the PDF
graphics.  If I use Type1, everything is fine.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=594&group_id=106

From noreply at sarovar.org  Wed Aug  9 11:11:58 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 09 Aug 2006 14:41:58 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-595 ] PDF picture with Type3 fonts
	causes unkown XObject "R8"
Message-ID: <E1GAk6Y-0006on-00@sarovar.org>

Bugs item #595, was opened at 2006-08-09 11:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=595&group_id=106

Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Torsten Bronger (bronger)
Assigned to: Martin Schr?der (oneiros)
Summary: PDF picture with Type3 fonts causes unkown XObject "R8"

Initial Comment:
Please have a look at the attached minimal file.  It
just includes a PDF with LaTeX's \includegraphics.  The
result is an illegal PDF accoursing to acroread and
Ghostscript.  acroread speaks on an unknown XObject
called "R8" (I also saw R10 in another case).

The reason is probably the Type3 fonts used in the PDF
graphics.  If I use Type1, everything is fine.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=595&group_id=106

From noreply at sarovar.org  Wed Aug  9 18:58:07 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 09 Aug 2006 22:28:07 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-594 ] PDF picture with Type3 fonts
	causes unkown XObject "R8"
Message-ID: <E1GArNf-0006f3-00@sarovar.org>

Bugs item #594, was opened at 2006-08-09 11:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=594&group_id=106

Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Torsten Bronger (bronger)
Assigned to: Martin Schr?der (oneiros)
>Summary: PDF picture with Type3 fonts causes unkown XObject "R8"

Initial Comment:
Please have a look at the attached minimal file.  It
just includes a PDF with LaTeX's \includegraphics.  The
result is an illegal PDF accoursing to acroread and
Ghostscript.  acroread speaks on an unknown XObject
called "R8" (I also saw R10 in another case).

The reason is probably the Type3 fonts used in the PDF
graphics.  If I use Type1, everything is fine.

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2006-08-09 18:58

Message:
Logged In: YES 
user_id=929

that's a flaw in Adobe Reader 7.0, which doesn't follow the
PDF specification strictly enough. Ghostscript people
changed gs to adapt to this, see Ghostscript Bug #688357:
http://bugs.ghostscript.com/show_bug.cgi?id=688357

pdftex can't do anything about this.

When you generate the graphics by epstopdf using gs 8.54,
everything should be ok.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=594&group_id=106

From noreply at sarovar.org  Wed Aug  9 18:59:07 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 09 Aug 2006 22:29:07 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-595 ] PDF picture with Type3 fonts
	causes unkown XObject "R8"
Message-ID: <E1GArOd-0006fP-00@sarovar.org>

Bugs item #595, was opened at 2006-08-09 11:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=595&group_id=106

Category: PDF inclusion
Group: v1.30.0
>Status: Deleted
Resolution: None
Priority: 5
Submitted By: Torsten Bronger (bronger)
Assigned to: Martin Schr?der (oneiros)
>Summary: PDF picture with Type3 fonts causes unkown XObject "R8"

Initial Comment:
Please have a look at the attached minimal file.  It
just includes a PDF with LaTeX's \includegraphics.  The
result is an illegal PDF accoursing to acroread and
Ghostscript.  acroread speaks on an unknown XObject
called "R8" (I also saw R10 in another case).

The reason is probably the Type3 fonts used in the PDF
graphics.  If I use Type1, everything is fine.

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2006-08-09 18:59

Message:
Logged In: YES 
user_id=929

duplicate of bug report #594, see there

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=595&group_id=106

From noreply at sarovar.org  Wed Aug  9 19:30:41 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 09 Aug 2006 23:00:41 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-594 ] PDF picture with Type3 fonts
	causes unkown XObject "R8"
Message-ID: <E1GArtB-0003Oa-00@sarovar.org>

Bugs item #594, was opened at 2006-08-09 11:11
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=594&group_id=106

Category: PDF inclusion
Group: v1.30.0
>Status: Closed
>Resolution: Rejected
Priority: 5
Submitted By: Torsten Bronger (bronger)
Assigned to: Martin Schr?der (oneiros)
>Summary: PDF picture with Type3 fonts causes unkown XObject "R8"

Initial Comment:
Please have a look at the attached minimal file.  It
just includes a PDF with LaTeX's \includegraphics.  The
result is an illegal PDF accoursing to acroread and
Ghostscript.  acroread speaks on an unknown XObject
called "R8" (I also saw R10 in another case).

The reason is probably the Type3 fonts used in the PDF
graphics.  If I use Type1, everything is fine.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-08-09 19:30

Message:
Logged In: YES 
user_id=421

It's not a pdfTeX problem.

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2006-08-09 18:58

Message:
Logged In: YES 
user_id=929

that's a flaw in Adobe Reader 7.0, which doesn't follow the
PDF specification strictly enough. Ghostscript people
changed gs to adapt to this, see Ghostscript Bug #688357:
http://bugs.ghostscript.com/show_bug.cgi?id=688357

pdftex can't do anything about this.

When you generate the graphics by epstopdf using gs 8.54,
everything should be ok.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=594&group_id=106

From pragma at wxs.nl  Thu Aug 10 18:31:50 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 10 Aug 2006 18:31:50 +0200
Subject: [NTG-pdftex] [XeTeX] OT?: Interesting? post about LuaTeX
	on	usenet:comp.text.tex
In-Reply-To: <9579C7FD-30DE-4780-AA14-1B6F6EFC26DF@frycomm.com>
References: <E1195DEA-C7D1-477E-9B29-A05A2000D34E@frycomm.com>
	<3951CDC6-1A02-44EA-BC45-7361EBDD1591@runbox.com>
	<9579C7FD-30DE-4780-AA14-1B6F6EFC26DF@frycomm.com>
Message-ID: <44DB5F76.7090400@wxs.nl>

William Adams wrote:
> On Aug 10, 2006, at 11:36 AM, Musa Furber wrote:
>
>   
>> Does LuaTeX today run on more than XeTeX's three platforms well
>> enough to be used for production work?
>>     
>
> Given that, ``This Project Hs Not Released Any Files'', no.   
> Presumably it will run on all platforms which pdftex is available for.
>   
i have no time for much discussion now: (and i don't read or wanna read 
usenet tex lists)

- luatex started as an experiment en was presented/discussed at a couple 
of tex conferences;
- it's done by a subset of the pdftex dev team and so it's 's an 
experimental branch of pdftex
- the first major release will be called metatex which will then be the 
dev version
- next year (or so) the first releases show up
- in the end, the stabel releas will become pdftex 2.0 with pdftex < 2 
being frozen in terms of extensions (not in terms of fixes)
- it runs on all platforms (since there is a major overhaul being done 
now, it does not run anywhere -)
- new functionality as well as compatibility issues will be tested in 
the oriental tex project (will be presented at tug 2006)

> I thought the commenting on XeTeX was kind of strange and off-key,  
> hence my mention of it here.
>   
i dunno about that; the luatex people know about xetex and jonathan knows about luatex; metatex will merge pdftex, implement pending ideas in the pdftex team, parts of aleph, lua scripting, open type, unicode, more math stuff, and probably runtime metapost support + a bit more); while xetex uses libraries, metatex will use methods built into tex (more complex from the perspective of most user but probably also more suiting demands of others)

the development is mostly done by taco hoekwater as part of the oriental tex project; since pdftex is the de facto tex engine on tex live, the team deliberately keeps a low profile - no false promisses (on the schedule), priority on pdftex bug fixes, etc etc.  

when, how and if those projects will ever merge into one tex ... we'll see (neither of us sees a reason to cripple the xetex and/or pdftex dev by yet another development and it's fun to have two fresh tex's around - both following a slightly different approach andmaybe a different audience but both usable) 

side note: there is no competition with any other branch of tex (xetex, omega 2, ...) involved, just evolution of pdftex 

also, some parts of this spin off can be retrofitted into xetex (and vise versa) which is good for shared macro development 

Hans 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Fri Aug 11 13:26:09 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Fri, 11 Aug 2006 13:26:09 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
Message-ID: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>

http://sarovar.org/download.php/1064/pdftex-1.40.0-beta-20060811.tar.bz2
http://sarovar.org/download.php/1065/pdftex-1.40.0-beta-20060725-20060811.diff.gz

---------------------------------------------------------------
pdfTeX 3.141592-1.40.0-beta-20060811 was released on 2006-08-11
---------------------------------------------------------------
- renamed primitives:
    \primitive -> \pdfprimitive
    \ifprimitive -> \ifpdfprimitive
    \ifabsdim -> \ifpdfabsdim
    \ifabsnum -> \ifpdfabsnum
- new version of \primitive/\ifprimitive (but see above)
- new dimen: \pdfpxdimen
- support for jbig2 files
- new library: obsdcompat, which has improved string functions and allows the
  use of __attribute__
- update libpng to 1.2.12
- added JFIF detection patch to writejpg.c (was bug 548)
- bugfix: truetype OS/2 v3 fonts (594)
- bugfix: file with only \immediate\pdfobj stream results in garbage (505)
- bugfix: invalid pdf created if font name contains space (509)

Please have a look at libs/obsdcompat; it has a bunch of very nice
(and safe) string functions. And it allows the safe use of the
__attribute__-feature of gcc.

Best
   Martin

From taco at elvenkind.com  Fri Aug 11 14:19:57 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 11 Aug 2006 14:19:57 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
Message-ID: <44DC75ED.1000408@elvenkind.com>



Martin Schr?der wrote:
> http://sarovar.org/download.php/1064/pdftex-1.40.0-beta-20060811.tar.bz2
> http://sarovar.org/download.php/1065/pdftex-1.40.0-beta-20060725-20060811.diff.gz
> 
> ---------------------------------------------------------------
> pdfTeX 3.141592-1.40.0-beta-20060811 was released on 2006-08-11
> ---------------------------------------------------------------
> - renamed primitives:
>     \primitive -> \pdfprimitive
>     \ifprimitive -> \ifpdfprimitive
>     \ifabsdim -> \ifpdfabsdim
>     \ifabsnum -> \ifpdfabsnum

I am still not happy with that renaming. At the moment, I am
merging Aleph into luatex. Surely you do not expect me to have
\pdfpardir , \pdfocplist etc., so why would there be a pdf
prefix for non-pdf related new primitives? (I know we have
discussed this before, but ...)

Other then that:  thanks for the new beta. I will have a look
at the obsdcompat library asap.

Taco

From pragma at wxs.nl  Fri Aug 11 14:52:31 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 11 Aug 2006 14:52:31 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <44DC75ED.1000408@elvenkind.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
	<44DC75ED.1000408@elvenkind.com>
Message-ID: <44DC7D8F.4020807@wxs.nl>

Taco Hoekwater wrote:
> Martin Schr?der wrote:
>   
>> http://sarovar.org/download.php/1064/pdftex-1.40.0-beta-20060811.tar.bz2
>> http://sarovar.org/download.php/1065/pdftex-1.40.0-beta-20060725-20060811..diff.gz
>>
>> ---------------------------------------------------------------
>> pdfTeX 3.141592-1.40.0-beta-20060811 was released on 2006-08-11
>> ---------------------------------------------------------------
>> - renamed primitives:
>>     \primitive -> \pdfprimitive
>>     \ifprimitive -> \ifpdfprimitive
>>     \ifabsdim -> \ifpdfabsdim
>>     \ifabsnum -> \ifpdfabsnum
>>     
>
> I am still not happy with that renaming. At the moment, I am
> merging Aleph into luatex. Surely you do not expect me to have
> \pdfpardir , \pdfocplist etc., so why would there be a pdf
> prefix for non-pdf related new primitives? (I know we have
> discussed this before, but ...)
>   
indeed
> Other then that:  thanks for the new beta. I will have a look
> at the obsdcompat library asap.
>   
well, we can use the \pdf prefix in pdftex and no prefix in metatex 
(luatex); that way those who stick to pdftex < 2 can decide themselves 
if they want to alias them

Hans

-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From noreply at sarovar.org  Sun Aug 13 22:02:26 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 14 Aug 2006 01:32:26 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-474 ] Use dynamically linked poppler
	library instead of xpdf code
Message-ID: <E1GCMAE-0000CI-00@sarovar.org>

Patches item #474, was opened at 2006-01-30 17:53
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Frank K?ster (frank)
Assigned to: Martin Schr?der (oneiros)
Summary: Use dynamically linked poppler library instead of xpdf code

Initial Comment:
This has already been applied and tested in Debian and
Ubuntu, but we suggest to apply it upstream.  There are
a few things to do, however, as Martin already pointed
out to me in a private mail.  I paraphrase the main points:

- the pdftex distribution should not ship libpoppler.
Instead it should be possible to switch from xpdf to
libpoppler using autoconf magic, if libpoppler headers
are installed.  This needs some coding work

- We need a common API for xpdf and poppler.  This is
the tricky part, because the very reason for poppler's
existence is that the xpdf developer, Derek Noonburg,
refuses any patches that would lead to a shared
library. As Martin said, "for the beginning, a header
file with a couple of #ifdef'ed definitions should be
enough".

I'm going to subscribe to the pdftex devel list soon,
but am not yet subscribed currently.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-08-13 22:02

Message:
Logged In: YES 
user_id=421

Frank,
have you done any further work on this?

I just had a first look at integrating poppler and see a
very different use of configure... :-{
Also your diff only patches the sources, but not the
autofoo-stuff.

What I want is:
- a distribution of poppler in src/libs, which can be used
instead of xpdf
- a way to switch bewteen xpdf and poppler via configure
- for poppler to be able to switch between static and
dynamic via configure
- and finally, a header file abstracting poppler/xpdf would
be nice, but is not really needed, as poppler/xpdf are only
used by two source files.

Best
   Martin

----------------------------------------------------------------------

Comment By: Frank K?ster (frank)
Date: 2006-02-13 08:58

Message:
Logged In: YES 
user_id=3360

I agree that this is something to think over and check very
well, so better not push it into 1.40.

But I'd appreciate if someone could answer my mail to
ntg-pdftex regarding the autoconf setup in pdftex, or if you
could tell me whom to ask specifically if nobody among the
active developers knows about it.

See you in Berlin,
Frank

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:50

Message:
Logged In: YES 
user_id=421

I've attached the patch by Frank from
http://www.ntg.nl/pipermail/ntg-pdftex/2006-February/001993.html

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:46

Message:
Logged In: YES 
user_id=421

This is too late for 1.40, so I'll postpone it.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

From taco at elvenkind.com  Mon Aug 14 18:11:16 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 14 Aug 2006 18:11:16 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
Message-ID: <44E0A0A4.8040302@elvenkind.com>

Hi,

I've found a problem in the latest beta. Previous versions of
pdftex would crash (segfault) on this input:

   {\pdfoutput=1 \immediate \pdfobj stream {}}Hello\bye

The latest beta gives a nice "you can't change \pdfoutput"
error, but it keeps on repeating that error message until
the harddisk is full :-(

Taco




From martin at oneiros.de  Mon Aug 14 19:14:12 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 14 Aug 2006 19:14:12 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <44E0A0A4.8040302@elvenkind.com>
References: <44E0A0A4.8040302@elvenkind.com>
Message-ID: <68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>

2006/8/14, Taco Hoekwater <taco at elvenkind.com>:
> I've found a problem in the latest beta. Previous versions of
> pdftex would crash (segfault) on this input:
>
>    {\pdfoutput=1 \immediate \pdfobj stream {}}Hello\bye
>
> The latest beta gives a nice "you can't change \pdfoutput"
> error, but it keeps on repeating that error message until
> the harddisk is full :-(

I can't reproduce this:
--------------------------
This is pdfTeX, Version 3.141592-1.40.0-beta-20060811 (Web2C 7.5.5)
entering extended mode
(./loop.tex [1{/home/ms/.texmf-var/fonts/map/pdftex/updmap/pdftex.map}] )</opt/
tex/share/texmf-dist/fonts/type1/bluesky/cm/cmr10.pfb>
Output written on loop.pdf (1 page, 3992 bytes).
Transcript written on loop.log.
--------------------------

Best
   Martin

From taco at elvenkind.com  Mon Aug 14 19:18:10 2006
From: taco at elvenkind.com (taco hoekwater)
Date: Mon, 14 Aug 2006 19:18:10 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
Message-ID: <44E0B052.4090504@elvenkind.com>

Martin Schr?der wrote:
> 2006/8/14, Taco Hoekwater <taco at elvenkind.com>:
>> I've found a problem in the latest beta. Previous versions of
>> pdftex would crash (segfault) on this input:
>>
>>    {\pdfoutput=1 \immediate \pdfobj stream {}}Hello\bye
>>
>> The latest beta gives a nice "you can't change \pdfoutput"
>> error, but it keeps on repeating that error message until
>> the harddisk is full :-(
> 
> I can't reproduce this:

What if you start with an explicit \pdfoutput=0 ?

From hartmut_henkel at gmx.de  Mon Aug 14 19:22:43 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon, 14 Aug 2006 19:22:43 +0200 (CEST)
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <44E0A0A4.8040302@elvenkind.com>
References: <44E0A0A4.8040302@elvenkind.com>
Message-ID: <Pine.LNX.4.64.0608141921240.3320@hahepc1.hahe>

On Mon, 14 Aug 2006, Taco Hoekwater wrote:

> I've found a problem in the latest beta. Previous versions of pdftex
> would crash (segfault) on this input:
>
>    {\pdfoutput=1 \immediate \pdfobj stream {}}Hello\bye
>
> The latest beta gives a nice "you can't change \pdfoutput" error, but
> it keeps on repeating that error message until the harddisk is full
> :-(

Not here. Weird.

This is pdfTeXk, Version 3.141592-1.40.0-beta-20060811 (Web2C 7.5.5)
(format=pdftex 2006.8.14)  14 AUG 2006 19:21
 %&-line parsing enabled.
**xx
(./xx.tex
[1{/usr/local/texlive/2005/texmf-var/fonts/map/pdftex/updmap/pdftex.m
ap}] )<./cmr10.pfb>
Output written on xx.pdf (1 page, 3991 bytes).
PDF statistics:
 11 PDF objects out of 1000 (max. 8388607)
 0 named destinations out of 1000 (max. 131072)
 5 words of extra memory for PDF output out of 10000 (max. 10000000)

Regards, Hartmut

From martin at oneiros.de  Mon Aug 14 19:23:05 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 14 Aug 2006 19:23:05 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <44E0B052.4090504@elvenkind.com>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
Message-ID: <68c491a60608141023g28bce397sacbe2f50d2a497aa@mail.gmail.com>

2006/8/14, taco hoekwater <taco at elvenkind.com>:
> Martin Schr?der wrote:
> > I can't reproduce this:
>
> What if you start with an explicit \pdfoutput=0 ?

Then it loops. :-(

Best
   Martin

From hartmut_henkel at gmx.de  Mon Aug 14 19:27:23 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon, 14 Aug 2006 19:27:23 +0200 (CEST)
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <44E0B052.4090504@elvenkind.com>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
Message-ID: <Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>

On Mon, 14 Aug 2006, taco hoekwater wrote:

> Martin Schr?der wrote:
> > I can't reproduce this:
>
> What if you start with an explicit \pdfoutput=0 ?

yes, there it is.

Regards, Hartmut

From martin at oneiros.de  Mon Aug 14 19:47:13 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 14 Aug 2006 19:47:13 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
Message-ID: <68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>

2006/8/14, Hartmut Henkel <hartmut_henkel at gmx.de>:
> On Mon, 14 Aug 2006, taco hoekwater wrote:
> > Martin Schr?der wrote:
> > > I can't reproduce this:
> >
> > What if you start with an explicit \pdfoutput=0 ?
>
> yes, there it is.

I suppose the change in behaviour is a followup of the fix to bug 505...

Best
   Martin

From martin at oneiros.de  Mon Aug 14 19:57:45 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 14 Aug 2006 19:57:45 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>
Message-ID: <68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>

Here's a backtrace of the crash in 0725:

Program received signal SIGSEGV, Segmentation fault.
0x00002ba69bf3ada4 in fwrite () from /lib64/libc.so.6
(gdb) bt
#0  0x00002ba69bf3ada4 in fwrite () from /lib64/libc.so.6
#1  0x0000000000452075 in closefilesandterminate () at pdftex3.c:6395
#2  0x0000000000410d59 in mainbody () at pdftexini.c:5649
#3  0x000000000045dc1e in main (ac=<value optimized out>, av=<value
optimized out>) at pdftexextra.c:340
(gdb) list
6390            decr ( k ) ;
6391          }
6392          if ( dvilimit == halfbuf )
6393          writedvi ( halfbuf , dvibufsize - 1 ) ;
6394          if ( dviptr > 0 )
6395          writedvi ( 0 , dviptr - 1 ) ;
6396          printnl ( 971 ) ;
6397          printfilename ( 0 , outputfilename , 0 ) ;
6398          print ( 285 ) ;
6399          printint ( totalpages ) ;

Obviously the change of \pdfoutput confuses pdfTeX.

Best
   Martin

From hartmut_henkel at gmx.de  Mon Aug 14 20:24:49 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon, 14 Aug 2006 20:24:49 +0200 (CEST)
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>
	<68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>

On Mon, 14 Aug 2006, Martin Schr?der wrote:
> Obviously the change of \pdfoutput confuses pdfTeX.

it's a silly loop through fix_pdfoutput, pdf_error, succumb,
close_files_and_terminate to fix_pdfoutput again.

No clear idea yet what the right way is to break the loop.

Regards, Hartmut

From taco at elvenkind.com  Mon Aug 14 20:28:41 2006
From: taco at elvenkind.com (taco hoekwater)
Date: Mon, 14 Aug 2006 20:28:41 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>
References: <44E0A0A4.8040302@elvenkind.com>	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>	<44E0B052.4090504@elvenkind.com>	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>	<68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>
	<Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>
Message-ID: <44E0C0D9.5020609@elvenkind.com>

Hartmut Henkel wrote:
> On Mon, 14 Aug 2006, Martin Schr?der wrote:
>> Obviously the change of \pdfoutput confuses pdfTeX.
> 
> it's a silly loop through fix_pdfoutput, pdf_error, succumb,
> close_files_and_terminate to fix_pdfoutput again.
> 
> No clear idea yet what the right way is to break the loop.

Perhaps a succumb() is called for. If someone fiddles with
\pdfoutput after something has already been written, chances
are that the output will be junk anyway.

Taco

From hartmut_henkel at gmx.de  Mon Aug 14 20:56:37 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon, 14 Aug 2006 20:56:37 +0200 (CEST)
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <44E0C0D9.5020609@elvenkind.com>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>
	<68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>
	<Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>
	<44E0C0D9.5020609@elvenkind.com>
Message-ID: <Pine.LNX.4.64.0608142054060.18672@hahepc1.hahe>

On Mon, 14 Aug 2006, taco hoekwater wrote:

> Perhaps a succumb() is called for. If someone fiddles with \pdfoutput
> after something has already been written, chances are that the output
> will be junk anyway.

currently the easiest seems to make a new boolean variable remembering
that there was this error message by fix_pdfoutput, so that the message
is given only once. Then it stops nicely with "Fatal error occurred..."
Is this too ugly?

Regards, Hartmut

From noreply at sarovar.org  Mon Aug 14 21:20:13 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 15 Aug 2006 00:50:13 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-474 ] Use dynamically linked poppler
	library instead of xpdf code
Message-ID: <E1GChyv-0005EO-00@sarovar.org>

Patches item #474, was opened at 2006-01-30 17:53
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Frank K?ster (frank)
Assigned to: Martin Schr?der (oneiros)
Summary: Use dynamically linked poppler library instead of xpdf code

Initial Comment:
This has already been applied and tested in Debian and
Ubuntu, but we suggest to apply it upstream.  There are
a few things to do, however, as Martin already pointed
out to me in a private mail.  I paraphrase the main points:

- the pdftex distribution should not ship libpoppler.
Instead it should be possible to switch from xpdf to
libpoppler using autoconf magic, if libpoppler headers
are installed.  This needs some coding work

- We need a common API for xpdf and poppler.  This is
the tricky part, because the very reason for poppler's
existence is that the xpdf developer, Derek Noonburg,
refuses any patches that would lead to a shared
library. As Martin said, "for the beginning, a header
file with a couple of #ifdef'ed definitions should be
enough".

I'm going to subscribe to the pdftex devel list soon,
but am not yet subscribed currently.

----------------------------------------------------------------------

>Comment By: Frank K?ster (frank)
Date: 2006-08-14 21:20

Message:
Logged In: YES 
user_id=3360

Hi Martin,

this is clearly post-1.40, I agree.  I have not worked on
any autofoo stuff, and I won't be able to do that soon
(instead, I try to integrate pdftex-1.40 into teTeX 3.0
which proved to be non-trivial).

Regards, Frank

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-08-13 22:02

Message:
Logged In: YES 
user_id=421

Frank,
have you done any further work on this?

I just had a first look at integrating poppler and see a
very different use of configure... :-{
Also your diff only patches the sources, but not the
autofoo-stuff.

What I want is:
- a distribution of poppler in src/libs, which can be used
instead of xpdf
- a way to switch bewteen xpdf and poppler via configure
- for poppler to be able to switch between static and
dynamic via configure
- and finally, a header file abstracting poppler/xpdf would
be nice, but is not really needed, as poppler/xpdf are only
used by two source files.

Best
   Martin

----------------------------------------------------------------------

Comment By: Frank K?ster (frank)
Date: 2006-02-13 08:58

Message:
Logged In: YES 
user_id=3360

I agree that this is something to think over and check very
well, so better not push it into 1.40.

But I'd appreciate if someone could answer my mail to
ntg-pdftex regarding the autoconf setup in pdftex, or if you
could tell me whom to ask specifically if nobody among the
active developers knows about it.

See you in Berlin,
Frank

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:50

Message:
Logged In: YES 
user_id=421

I've attached the patch by Frank from
http://www.ntg.nl/pipermail/ntg-pdftex/2006-February/001993.html

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:46

Message:
Logged In: YES 
user_id=421

This is too late for 1.40, so I'll postpone it.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

From pragma at wxs.nl  Mon Aug 14 22:16:04 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 14 Aug 2006 22:16:04 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <Pine.LNX.4.64.0608142054060.18672@hahepc1.hahe>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>
	<68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>
	<Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>
	<44E0C0D9.5020609@elvenkind.com>
	<Pine.LNX.4.64.0608142054060.18672@hahepc1.hahe>
Message-ID: <44E0DA04.8010204@wxs.nl>

Hartmut Henkel wrote:
> On Mon, 14 Aug 2006, taco hoekwater wrote:
>
>   
>> Perhaps a succumb() is called for. If someone fiddles with \pdfoutput
>> after something has already been written, chances are that the output
>> will be junk anyway.
>>     
>
> currently the easiest seems to make a new boolean variable remembering
> that there was this error message by fix_pdfoutput, so that the message
> is given only once. Then it stops nicely with "Fatal error occurred..."
> Is this too ugly?
>   
sounds ok to me, also, delete the dvi / pdf fiel then 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Mon Aug 14 22:18:34 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 14 Aug 2006 22:18:34 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <Pine.LNX.4.64.0608142054060.18672@hahepc1.hahe>
References: <44E0A0A4.8040302@elvenkind.com>
	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>
	<44E0B052.4090504@elvenkind.com>
	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>
	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>
	<68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>
	<Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>
	<44E0C0D9.5020609@elvenkind.com>
	<Pine.LNX.4.64.0608142054060.18672@hahepc1.hahe>
Message-ID: <68c491a60608141318m2d90bc3au1a051a9be9e94d5d@mail.gmail.com>

2006/8/14, Hartmut Henkel <hartmut_henkel at gmx.de>:
> currently the easiest seems to make a new boolean variable remembering
> that there was this error message by fix_pdfoutput, so that the message
> is given only once. Then it stops nicely with "Fatal error occurred..."
> Is this too ugly?

We already have the variable.
The enclosed patch does what we want.

Best
   Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdftex.web.patch
Type: text/x-patch
Size: 1218 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20060814/c004c981/attachment.bin 

From taco at elvenkind.com  Tue Aug 15 10:44:17 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 15 Aug 2006 10:44:17 +0200
Subject: [NTG-pdftex] latest beta goes into an eternal error loop
In-Reply-To: <68c491a60608141318m2d90bc3au1a051a9be9e94d5d@mail.gmail.com>
References: <44E0A0A4.8040302@elvenkind.com>	<68c491a60608141014r69027fd2jb603a40a294a843@mail.gmail.com>	<44E0B052.4090504@elvenkind.com>	<Pine.LNX.4.64.0608141926560.3320@hahepc1.hahe>	<68c491a60608141047o76d431d7p16f7e90c75dfbd69@mail.gmail.com>	<68c491a60608141057q80ab148u2f426a1b20a01b6b@mail.gmail.com>	<Pine.LNX.4.64.0608142023050.16882@hahepc1.hahe>	<44E0C0D9.5020609@elvenkind.com>	<Pine.LNX.4.64.0608142054060.18672@hahepc1.hahe>
	<68c491a60608141318m2d90bc3au1a051a9be9e94d5d@mail.gmail.com>
Message-ID: <44E18961.8070103@elvenkind.com>



Martin Schr?der wrote:
> 2006/8/14, Hartmut Henkel <hartmut_henkel at gmx.de>:
> 
>> currently the easiest seems to make a new boolean variable remembering
>> that there was this error message by fix_pdfoutput, so that the message
>> is given only once. Then it stops nicely with "Fatal error occurred..."
>> Is this too ugly?
> 
> 
> We already have the variable.
> The enclosed patch does what we want.

Thanks, great.

Taco

From taco at elvenkind.com  Tue Aug 15 17:23:14 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 15 Aug 2006 17:23:14 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
Message-ID: <44E1E6E2.9030202@elvenkind.com>



Martin Schr?der wrote:
> http://sarovar.org/download.php/1064/pdftex-1.40.0-beta-20060811.tar.bz2
> http://sarovar.org/download.php/1065/pdftex-1.40.0-beta-20060725-20060811.diff.gz
> 
> ---------------------------------------------------------------
> pdfTeX 3.141592-1.40.0-beta-20060811 was released on 2006-08-11
> ---------------------------------------------------------------
> - renamed primitives:
>     \primitive -> \pdfprimitive

But it was still as printed \primitive. The attached patch fixes that


Taco
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdfprimitive.diff
Type: text/x-patch
Size: 1254 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20060815/ea872755/attachment.bin 

From taco at elvenkind.com  Wed Aug 16 10:50:12 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 16 Aug 2006 10:50:12 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
Message-ID: <44E2DC44.80603@elvenkind.com>


Hi Martin,

Martin Schr?der wrote:
> 
> Please have a look at libs/obsdcompat; it has a bunch of very nice
> (and safe) string functions. And it allows the safe use of the
> __attribute__-feature of gcc.

Since you did some butchering already, would you be willing to
do some more? (i had trouble cross-compiling to windows)

* includes.h
   This loads <pwd.h> and <unistd.h>, but I think they are not
   needed and both give me trouble (pwd.h doesnt exist, and
   the mingw version of unistd.h does not compile under c++)

* strmode.c
   If you do not intend to use strmode(), please remove the
   C file (this is not a string function).

   Otherwise, I have a version that behaves more or less
   predictable for win32 (group and others settings are
   identical to user). I can send you that if desired.

Cheers, Taco

From martin at oneiros.de  Wed Aug 16 11:11:58 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 16 Aug 2006 11:11:58 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <44E2DC44.80603@elvenkind.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
	<44E2DC44.80603@elvenkind.com>
Message-ID: <68c491a60608160211v4c13e16elc56b43447f49d2a9@mail.gmail.com>

2006/8/16, Taco Hoekwater <taco at elvenkind.com>:
> Since you did some butchering already, would you be willing to
> do some more? (i had trouble cross-compiling to windows)

Taco,
of course.

> * includes.h
>    This loads <pwd.h> and <unistd.h>, but I think they are not
>    needed and both give me trouble (pwd.h doesnt exist, and
>    the mingw version of unistd.h does not compile under c++)

time.h seems also to be unneeded.

> * strmode.c
>    If you do not intend to use strmode(), please remove the
>    C file (this is not a string function).

Done.

A patch is attached.

>    Otherwise, I have a version that behaves more or less
>    predictable for win32 (group and others settings are
>    identical to user). I can send you that if desired.

I don't have a win32 system to test, so thank you, no. But any source
code patches needed for that are welcome.

Best
   Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: obsdcompat.patch
Type: text/x-patch
Size: 3622 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20060816/9b1e9014/attachment.bin 

From taco at elvenkind.com  Wed Aug 16 12:31:00 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 16 Aug 2006 12:31:00 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <68c491a60608160211v4c13e16elc56b43447f49d2a9@mail.gmail.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>	<44E2DC44.80603@elvenkind.com>
	<68c491a60608160211v4c13e16elc56b43447f49d2a9@mail.gmail.com>
Message-ID: <44E2F3E4.2000508@elvenkind.com>



Martin Schr?der wrote:
> 2006/8/16, Taco Hoekwater <taco at elvenkind.com>:
> 
>> Since you did some butchering already, would you be willing to
>> do some more? (i had trouble cross-compiling to windows)
> 
> 
> Done.
> 
> A patch is attached.

Thank you, runs like a charm.

>>    Otherwise, I have a version that behaves more or less
>>    predictable for win32 (group and others settings are
>>    identical to user). I can send you that if desired.
> 
> I don't have a win32 system to test, so thank you, no. But any source
> code patches needed for that are welcome.

If we don't need it, let it be. I know that the 'write' permission
on Windows is not as naive as my quick hack was (user=group=world),
but I don't know enough of the Win32 permissions model to fix it
properly for inclusion in the official library.

Best, Taco

From gnwiii at gmail.com  Fri Aug 18 17:53:43 2006
From: gnwiii at gmail.com (gnwiii at gmail.com)
Date: Fri, 18 Aug 2006 12:53:43 -0300
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
Message-ID: <22af238a0608180853j5fa65d4es2db89882235d74be@mail.gmail.com>

On 8/11/06, Martin Schr?der <martin at oneiros.de> wrote:
> http://sarovar.org/download.php/1064/pdftex-1.40.0-beta-20060811.tar.bz2
> http://sarovar.org/download.php/1065/pdftex-1.40.0-beta-20060725-20060811.diff.gz
>
> ---------------------------------------------------------------
> pdfTeX 3.141592-1.40.0-beta-20060811 was released on 2006-08-11
> [...]
>
> Please have a look at libs/obsdcompat; it has a bunch of very nice
> (and safe) string functions. And it allows the safe use of the
> __attribute__-feature of gcc.

Until now, pdftex could be built using a c99 compiler.   There seems
to be a bug in
gcc 4.1's strsep under "std-c99".

I was able to build this (using the two patches posted to this thread)
on Fedora Core 5 and also SGI Irix 6.5 (using the SGI MIPSPro "c99"
compiler), but both builds had problems in libs/obsdcompat when using
c99.

For FC5, configure failed to detect strsep when using "gcc -std=c99":
$ gcc --version
gcc (GCC) 4.1.1 20060525 (Red Hat 4.1.1-1)

$ ./my-build
[...]
gcc -std=c99 -g -O2 -march=i686 -Wall -Wpointer-arith -Wuninitialized
-Wsign-compare -Wno-pointer-sign  -I. -I.. -I -I/..  -DHAVE_CONFIG_H
-c ../../../src/libs/obsdcompat/strsep.c
../../../src/libs/obsdcompat/strsep.c:53: error: expected identifier
or '(' before '__extension__'
../../../src/libs/obsdcompat/strsep.c:53: error: expected identifier
or '(' before ')' token
make[1]: *** [strsep.o] Error 1
make[1]: Leaving directory
`/nfs/amigo/diomedea/disk2/TeX/src/pdftex-1.40.0-beta-20060811/i686-linux/libs/obsdcompat'

Note the "-I<null>" and "-I<null>/..", which didn't seem to bother
gcc, but did bother SGI's
compiler.

Other people have reported this error with gcc 4.1 and the workaround
is to add -DHAVE_STRSEP to the compiler flags. I got past this by
editing config.h to "#define HAVE_STRSEP 1" and running the last make
step in the build script.  The entry in config.log was:

configure:5077: checking whether strsep is declared
configure:5106: gcc -c -std=c99 -g -O2 -march=i686 -Wall
-Wpointer-arith -Wuninitialized -Wsign-compare -Wno-pointer-sign
conftest.c >&5
conftest.c: In function 'main':
conftest.c:50: error: 'strsep' undeclared (first use in this function)
conftest.c:50: error: (Each undeclared identifier is reported only once
conftest.c:50: error: for each function it appears in.)
conftest.c:50: warning: unused variable 'p'
configure:5112: $? = 1
configure: failed program was:
| /* confdefs.h.  */
|
| #define PACKAGE_NAME "OpenBSD-Compat"
[...]
| #define HAVE_STRING_H 1
[...]
| /* end confdefs.h.  */
|
| #ifdef HAVE_STRING_H
| # include <string.h>
| #endif
|
|
| int
| main ()
| {
| #ifndef strsep
|   char *p = (char *) strsep;
| #endif
|
|   ;
|   return 0;
| }
configure:5136: result: no

For IRIX the build failed at the same point, but for a different
reason -- the "-I<null>" removes /usr/include from the search path, so
the system headers aren't found.  I edited the Makefile to add
srcdir=$(VPATH) and again ran the final make step manually to finish
the build.

-- 
George N. White III <aa056 at chebucto.ns.ca>
Head of St. Margarets Bay, Nova Scotia

From martin at oneiros.de  Fri Aug 18 18:17:14 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Fri, 18 Aug 2006 18:17:14 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060811
In-Reply-To: <22af238a0608180853j5fa65d4es2db89882235d74be@mail.gmail.com>
References: <68c491a60608110426p7184cd5eh7249651fc9a285d1@mail.gmail.com>
	<22af238a0608180853j5fa65d4es2db89882235d74be@mail.gmail.com>
Message-ID: <68c491a60608180917j752d646ei75e36f90975d9099@mail.gmail.com>

2006/8/18, gnwiii at gmail.com <gnwiii at gmail.com>:
> Until now, pdftex could be built using a c99 compiler.   There seems
> to be a bug in
> gcc 4.1's strsep under "std-c99".

Curious. I can easily build this with gcc 4.1.0 from SuSE 10.1

> Other people have reported this error with gcc 4.1 and the workaround
> is to add -DHAVE_STRSEP to the compiler flags. I got past this by
> editing config.h to "#define HAVE_STRSEP 1" and running the last make
> step in the build script.  The entry in config.log was:

This defeats the purpose of the configure, which should check for strsep. :-(

Best
   Martin

From noreply at sarovar.org  Sun Aug 20 16:38:00 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Sun, 20 Aug 2006 20:08:00 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-597 ] Patch for more structured font
	writing
Message-ID: <E1GEoR6-0004tb-00@sarovar.org>

Patches item #597, was opened at 2006-08-20 16:37
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=597&group_id=106

Category: Fonts
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: Patch for more structured font writing

Initial Comment:
Now there are individual structures for font
dictionaries and font descriptors. Several font objects
can share the same descriptor structure. All structures
are registered in AVL trees and flushed at the end. The
fm_entry structure is cleaned up, now contains mostly
map related stuff. Font descriptors can be shared also
by embedded PDF files. tfm_of_fm() is gone. New
makesubsettag() based on md5sum() with collision
detection. Written encoding vectors are minimized in
size (try it out on pdftex-t.tex :-) Replacement of
Type1 fonts from embedded files seems to work.

TrueType writing not yet done, currently broken. Help
appreciated!

More see readme.pdf included in patch .tar file.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=597&group_id=106

From karl at freefriends.org  Mon Aug 21 15:28:06 2006
From: karl at freefriends.org (Karl Berry)
Date: Mon, 21 Aug 2006 08:28:06 -0500
Subject: [NTG-pdftex] pdftex release?
Message-ID: <200608211328.k7LDS6p17554@f7.net>

Hi folks,

I was wondering if there was any (even vague) ETA for the next release
of pdftex.  Not trying to push for one, I'm happy for TL06 to go out
with the current release (and I have no clue yet when TL06 will be
anywhere near ready).  But if a new release is in the works anyway,
that'd be good to know.

Thanks,
Karl

From martin at oneiros.de  Mon Aug 21 18:23:06 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 21 Aug 2006 18:23:06 +0200
Subject: [NTG-pdftex] pdftex release?
In-Reply-To: <200608211328.k7LDS6p17554@f7.net>
References: <200608211328.k7LDS6p17554@f7.net>
Message-ID: <68c491a60608210923p7ad11fd3w4fec3a3005ccf761@mail.gmail.com>

2006/8/21, Karl Berry <karl at freefriends.org>:
> I was wondering if there was any (even vague) ETA for the next release
> of pdftex.  Not trying to push for one, I'm happy for TL06 to

Karl,
this summer. :-)

Best
   Martin

From noreply at sarovar.org  Tue Aug 22 08:19:56 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 22 Aug 2006 11:49:56 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-597 ] Patch for more structured font
	writing
Message-ID: <E1GFPcC-0000ne-00@sarovar.org>

Patches item #597, was opened at 2006-08-20 16:37
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=597&group_id=106

Category: Fonts
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: Patch for more structured font writing

Initial Comment:
Now there are individual structures for font
dictionaries and font descriptors. Several font objects
can share the same descriptor structure. All structures
are registered in AVL trees and flushed at the end. The
fm_entry structure is cleaned up, now contains mostly
map related stuff. Font descriptors can be shared also
by embedded PDF files. tfm_of_fm() is gone. New
makesubsettag() based on md5sum() with collision
detection. Written encoding vectors are minimized in
size (try it out on pdftex-t.tex :-) Replacement of
Type1 fonts from embedded files seems to work.

TrueType writing not yet done, currently broken. Help
appreciated!

More see readme.pdf included in patch .tar file.

Regards, Hartmut

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2006-08-22 08:19

Message:
Logged In: YES 
user_id=929

the patch doesn't fit to the TrueType model, needs more
consideration...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=597&group_id=106

From noreply at sarovar.org  Tue Aug 22 18:22:51 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 22 Aug 2006 21:52:51 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GFZ1f-0008Jj-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 13:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
>Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Michael (takrl)
>Assigned to: Martin Schr?der (oneiros)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-08-22 18:22

Message:
Logged In: YES 
user_id=421

Thanks, the testcase helped.

It can be simplified: Put all input files in one directory
and instead of a separate mapfile use \pdfmapline. Then you
don't need to fiddle with paths and mapfiles.

----------------------------------------------------------------------

Comment By: Michael (takrl)
Date: 2006-08-09 11:03

Message:
Logged In: YES 
user_id=3803

Ok, I just made up a zip file containing test data and
attached it here...



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-08-08 13:50

Message:
Logged In: YES 
user_id=421

I've changed that line to

if (version > 3)

Michael, can you please attach a complete test case (all
needed inputs) to this bug report for future testing?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-08-08 13:17

Message:
Logged In: YES 
user_id=710

>From an email from  Eddie Kohler:

=================================================
(2) Otftotfm generates map lines that tell pdftex to embed
the TTF directly
(cool!).  Unfortunately, pdftex does not like the Version
3.0 OS/2 table
included in OpenType TTFs (boo!), so I hacked the font to
change the OS/2
version number to 2.0.  Alternately, one could recompile
pdftex, after
changing line 1026 of writettf.c to:

    if (version != 0x0000 && version != 0x0001 && version !=
0x0002 &&
version != 0x0003)
=================================================

Martin, can you please include this patch into the next
release? Thanks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From martin at oneiros.de  Tue Aug 22 19:41:03 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Tue, 22 Aug 2006 19:41:03 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060822
Message-ID: <68c491a60608221041r6561f727v62a98524de6ecd8f@mail.gmail.com>

http://sarovar.org/download.php/1066/pdftex-1.40.0-beta-20060822.tar.bz2
http://sarovar.org/download.php/1067/pdftex-1.40.0-beta-20060811-20060822.diff.gz

---------------------------------------------------------------
pdfTeX 3.141592-1.40.0-beta-20060822 was released on 2006-08-22
---------------------------------------------------------------
- new feature: with \pdfdraftmode=1 (or -draftmode) pdfTeX doesn't write an
  output pdf file and doesn't read the content of any image file, thus speeding
  up the run. This is usefull when you know you need another run of pdfTeX e.g.
  just to get all the references right, but don't care for the output of this
  run
- changed the format of pdfTeX warnings and unified the four(!) functions
  pdfTeX uses for writing out errors and warnings
- expanded the output of -version to include information about the libraries
  used
- fixed a bug where -20060811 would loop forever
- fixed some compilation problems with obsdcompat

Have fun
   Martin

From noreply at sarovar.org  Tue Aug 22 20:15:24 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 22 Aug 2006 23:45:24 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-592 ] TrueType Font can't be embedded
Message-ID: <E1GFama-0003xi-00@sarovar.org>

Bugs item #592, was opened at 2006-08-08 13:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

Category: Fonts
Group: v1.30.0
Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Michael (takrl)
Assigned to: Martin Schr?der (oneiros)
Summary: TrueType Font can't be embedded

Initial Comment:
I tried to embed a TTF in my PDF document (have done so
before 100s of times, so I know the general proceedings).
However, this is a new MS font (constantia), and
pdf(e)tex doesn't seem to support it.

Excerpt of the log file:

This is pdfeTeX, Version 3.141592-1.30.6-2.2 (MiKTeX 2.5)
entering extended mode
<snip>
[1{psfonts.map}] (ttftest.aux) )
(see the transcript file for additional
information){T1-WGL4.enc}<constani.ttf
Error:  (file constani.ttf): unknown verssion of OS/2
table (0003)
 ==> Fatal error occurred, the output PDF file is not
finished!


>From what I saw so far on the net (for example, at
http://partners.adobe.com/public/developer/opentype/index_os2.html
) this is the newest version of the font specification,
and pdf(e)tex does only seem to support fonts using
OS/2-table-versions lower than 3.


----------------------------------------------------------------------

>Comment By: Michael (takrl)
Date: 2006-08-22 20:15

Message:
Logged In: YES 
user_id=3803

Thanks for the hints. These may prove useful in 'real
life'... ;-)

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-08-22 18:22

Message:
Logged In: YES 
user_id=421

Thanks, the testcase helped.

It can be simplified: Put all input files in one directory
and instead of a separate mapfile use \pdfmapline. Then you
don't need to fiddle with paths and mapfiles.

----------------------------------------------------------------------

Comment By: Michael (takrl)
Date: 2006-08-09 11:03

Message:
Logged In: YES 
user_id=3803

Ok, I just made up a zip file containing test data and
attached it here...



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-08-08 13:50

Message:
Logged In: YES 
user_id=421

I've changed that line to

if (version > 3)

Michael, can you please attach a complete test case (all
needed inputs) to this bug report for future testing?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-08-08 13:17

Message:
Logged In: YES 
user_id=710

>From an email from  Eddie Kohler:

=================================================
(2) Otftotfm generates map lines that tell pdftex to embed
the TTF directly
(cool!).  Unfortunately, pdftex does not like the Version
3.0 OS/2 table
included in OpenType TTFs (boo!), so I hacked the font to
change the OS/2
version number to 2.0.  Alternately, one could recompile
pdftex, after
changing line 1026 of writettf.c to:

    if (version != 0x0000 && version != 0x0001 && version !=
0x0002 &&
version != 0x0003)
=================================================

Martin, can you please include this patch into the next
release? Thanks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=592&group_id=106

From frank at debian.org  Tue Aug 22 20:39:09 2006
From: frank at debian.org (Frank =?iso-8859-1?Q?K=FCster?=)
Date: Tue, 22 Aug 2006 20:39:09 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060822
In-Reply-To: <68c491a60608221041r6561f727v62a98524de6ecd8f@mail.gmail.com>
	(Martin =?iso-8859-1?Q?Schr=F6der's?= message of "Tue,
	22 Aug 2006 19:41:03 +0200")
References: <68c491a60608221041r6561f727v62a98524de6ecd8f@mail.gmail.com>
Message-ID: <86mz9w1upe.fsf@alhambra.kuesterei.ch>

"Martin Schr?der" <martin at oneiros.de> wrote:

> - changed the format of pdfTeX warnings and unified the four(!) functions
>   pdfTeX uses for writing out errors and warnings

Does that require changes in applications that parse the output or log
for errors, like AUCTeX?

TIA, Frank
-- 
Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX/TeXLive)

From martin at oneiros.de  Tue Aug 22 20:58:54 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Tue, 22 Aug 2006 20:58:54 +0200
Subject: [NTG-pdftex] 1.40.0-beta-20060822
In-Reply-To: <86mz9w1upe.fsf@alhambra.kuesterei.ch>
References: <68c491a60608221041r6561f727v62a98524de6ecd8f@mail.gmail.com>
	<86mz9w1upe.fsf@alhambra.kuesterei.ch>
Message-ID: <68c491a60608221158i14038b87s1e56fdbac538fa65@mail.gmail.com>

2006/8/22, Frank K?ster <frank at debian.org>:
> Does that require changes in applications that parse the output or log
> for errors, like AUCTeX?

Hopefully not; instead it should fix a bug in conjunction with AucTeX:
Previously errors _and_ warning started with an "!", making it
hard/impossible for AucTeX do distinguish between them. Now that's
easy, as warnings don't start with an "!" anymore.

Best
   Martin

From noreply at sarovar.org  Wed Aug 23 23:51:45 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 24 Aug 2006 03:21:45 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-600 ] \pdfdraftmode: results in segfault
	+ can be tricked
Message-ID: <E1GG0dV-0001At-00@sarovar.org>

Bugs item #600, was opened at 2006-08-23 21:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=600&group_id=106

Category: None
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \pdfdraftmode: results in segfault + can be tricked

Initial Comment:
The following gives a segfault here (under cygwin):

\pdfdraftmode=1
\immediate\pdfobj{x}
%\pdfoutline goto name{x}{y} % with this, too
\pdfcompresslevel=9
A
\bye

>From the terminal:

This is pdfTeXk, Version 3.141592-1.40.0-beta-20060822
(Web2C 7.5.5)
 %&-line parsing enabled.
entering extended mode
(./bugs.tex
[1{/cygdrive/c/Programme/TeXLive/texmf-var/fonts/map/pdftex/updmap/
pdftex.map}    133 [main] pdftex 1780
_cygtls::handle_exceptions: Error while dumping state
(probably corrupted stack)
Segmentation fault (core dumped)


Also, the following will create a pdf file, although it
shouldn't (or at least issue a warning about
\pdfdraftmode being issued too late):

\immediate\pdfobj{x}
\pdfdraftmode=1
A
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=600&group_id=106

From pragma at wxs.nl  Mon Aug 28 22:07:16 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 28 Aug 2006 22:07:16 +0200
Subject: [NTG-pdftex] pdfximage
Message-ID: <44F34CF4.4020505@wxs.nl>

Hi,

It's kind of annoying that pdftex has hard coded suffixes.

how about something

\pdfjpgsuffixes{jpg,jpeg,myjpg}
\pdfpngsuffixes{png,somepng}
\pdfpdfsuffixes{pdf,epdf,fdf}


Hans 







-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From hartmut_henkel at gmx.de  Mon Aug 28 22:18:46 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon, 28 Aug 2006 22:18:46 +0200 (CEST)
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <44F34CF4.4020505@wxs.nl>
References: <44F34CF4.4020505@wxs.nl>
Message-ID: <Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>

On Mon, 28 Aug 2006, Hans Hagen wrote:

> It's kind of annoying that pdftex has hard coded suffixes.
>
> how about something
>
> \pdfjpgsuffixes{jpg,jpeg,myjpg}
> \pdfpngsuffixes{png,somepng}
> \pdfpdfsuffixes{pdf,epdf,fdf}

but you know that the suffixes are used only as a last resort, as first
the file headers are checked for the file type (thanks to Heiko!). So e.
g. foo.somejpg is a legal name and would still be recognized as .png if
it's a png file :-)

Regards, Hartmut

From pragma at wxs.nl  Mon Aug 28 22:41:24 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 28 Aug 2006 22:41:24 +0200
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
References: <44F34CF4.4020505@wxs.nl>
	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
Message-ID: <44F354F4.7050208@wxs.nl>

Hartmut Henkel wrote:
> On Mon, 28 Aug 2006, Hans Hagen wrote:
>
>   
>> It's kind of annoying that pdftex has hard coded suffixes.
>>
>> how about something
>>
>> \pdfjpgsuffixes{jpg,jpeg,myjpg}
>> \pdfpngsuffixes{png,somepng}
>> \pdfpdfsuffixes{pdf,epdf,fdf}
>>     
>
> but you know that the suffixes are used only as a last resort, as first
> the file headers are checked for the file type (thanks to Heiko!). So e.
> g. foo.somejpg is a legal name and would still be recognized as .png if
> it's a png file :-)
>   
ah, i thought so but got an error; i see now that i was testing a faulty graphic

sorry for the noice 

(btw, is there already a better jb2 commandline tool?) 

Hans 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From pragma at wxs.nl  Mon Aug 28 22:53:09 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 28 Aug 2006 22:53:09 +0200
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
References: <44F34CF4.4020505@wxs.nl>
	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
Message-ID: <44F357B5.7020207@wxs.nl>

Hartmut Henkel wrote:
> On Mon, 28 Aug 2006, Hans Hagen wrote:
>
>   
>> It's kind of annoying that pdftex has hard coded suffixes.
>>
>> how about something
>>
>> \pdfjpgsuffixes{jpg,jpeg,myjpg}
>> \pdfpngsuffixes{png,somepng}
>> \pdfpdfsuffixes{pdf,epdf,fdf}
>>     
>
> but you know that the suffixes are used only as a last resort, as first
> the file headers are checked for the file type (thanks to Heiko!). So e.
> g. foo.somejpg is a legal name and would still be recognized as .png if
> it's a png file :-)
>   
when i test with a unknown format, i get an abort and:

Error: pdftex.exe (file ./hakker1b.tif): unknown type of image

so, in order to know if a funny suffix is a valid one for pdftex, we need something 

\pdfcheckimage{somefile.somesiffix} 

which sets a flag, say \pdfimagecheck 0/1 

otherwise there is no way to intercept errors 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From hartmut_henkel at gmx.de  Mon Aug 28 23:01:16 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Mon, 28 Aug 2006 23:01:16 +0200 (CEST)
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <44F357B5.7020207@wxs.nl>
References: <44F34CF4.4020505@wxs.nl>
	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
	<44F357B5.7020207@wxs.nl>
Message-ID: <Pine.LNX.4.64.0608282258060.15496@hahepc1.hahe>

On Mon, 28 Aug 2006, Hans Hagen wrote:
> Hartmut Henkel wrote:
> > On Mon, 28 Aug 2006, Hans Hagen wrote:
> >
> >> It's kind of annoying that pdftex has hard coded suffixes.
> >>
> >> how about something
> >>
> >> \pdfjpgsuffixes{jpg,jpeg,myjpg}
> >> \pdfpngsuffixes{png,somepng}
> >> \pdfpdfsuffixes{pdf,epdf,fdf}
> >
> > but you know that the suffixes are used only as a last resort, as
> > first the file headers are checked for the file type (thanks to
> > Heiko!). So e. g. foo.somejpg is a legal name and would still be
> > recognized as .png if it's a png file :-)
>
> when i test with a unknown format, i get an abort and:
>
> Error: pdftex.exe (file ./hakker1b.tif): unknown type of image
>
> so, in order to know if a funny suffix is a valid one for pdftex, we
> need something
>
> \pdfcheckimage{somefile.somesiffix}
>
> which sets a flag, say \pdfimagecheck 0/1

like

\pdfretval=-1 not recognized
\pdfretval=0 PDF
\pdfretval=1 PNG
\pdfretval=2 JPG
\pdfretval=3 JBIG2

or better 0,1,2,3,4?

Regards, Hartmut

From pragma at wxs.nl  Mon Aug 28 23:09:07 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 28 Aug 2006 23:09:07 +0200
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <Pine.LNX.4.64.0608282258060.15496@hahepc1.hahe>
References: <44F34CF4.4020505@wxs.nl>
	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
	<44F357B5.7020207@wxs.nl>
	<Pine.LNX.4.64.0608282258060.15496@hahepc1.hahe>
Message-ID: <44F35B73.5050101@wxs.nl>

Hartmut Henkel wrote:
> On Mon, 28 Aug 2006, Hans Hagen wrote:
>   
>> Hartmut Henkel wrote:
>>     
>>> On Mon, 28 Aug 2006, Hans Hagen wrote:
>>>
>>>       
>>>> It's kind of annoying that pdftex has hard coded suffixes.
>>>>
>>>> how about something
>>>>
>>>> \pdfjpgsuffixes{jpg,jpeg,myjpg}
>>>> \pdfpngsuffixes{png,somepng}
>>>> \pdfpdfsuffixes{pdf,epdf,fdf}
>>>>         
>>> but you know that the suffixes are used only as a last resort, as
>>> first the file headers are checked for the file type (thanks to
>>> Heiko!). So e. g. foo.somejpg is a legal name and would still be
>>> recognized as .png if it's a png file :-)
>>>       
>> when i test with a unknown format, i get an abort and:
>>
>> Error: pdftex.exe (file ./hakker1b.tif): unknown type of image
>>
>> so, in order to know if a funny suffix is a valid one for pdftex, we
>> need something
>>
>> \pdfcheckimage{somefile.somesiffix}
>>
>> which sets a flag, say \pdfimagecheck 0/1
>>     
>
> like
>
> \pdfretval=-1 not recognized
> \pdfretval=0 PDF
> \pdfretval=1 PNG
> \pdfretval=2 JPG
> \pdfretval=3 JBIG2
>
> or better 0,1,2,3,4?
>   

right, that would be nice! (0,1,2,...)

we should aborted runs as much as possible

Hans

-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From oberdiek at uni-freiburg.de  Tue Aug 29 01:11:23 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Tue, 29 Aug 2006 01:11:23 +0200
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <44F357B5.7020207@wxs.nl>
References: <44F34CF4.4020505@wxs.nl>
	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
	<44F357B5.7020207@wxs.nl>
Message-ID: <20060828231122.GA2793@m0A023293.vpn.uni-freiburg.de>

On Mon, Aug 28, 2006 at 10:53:09PM +0200, Hans Hagen wrote:

> so, in order to know if a funny suffix is a valid one for pdftex, we need something 
> 
> \pdfcheckimage{somefile.somesiffix} 
> 
> which sets a flag, say \pdfimagecheck 0/1 
> 
> otherwise there is no way to intercept errors 

Look at CTAN:macros/latex/contrib/oberdiek/bmpsize.pdf.
Here I have implemented some parsing of binary image file types.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From P.Jackowski at gust.org.pl  Tue Aug 29 07:42:15 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Tue, 29 Aug 2006 07:42:15 +0200
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <20060828231122.GA2793@m0A023293.vpn.uni-freiburg.de>
References: <44F34CF4.4020505@wxs.nl>	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>	<44F357B5.7020207@wxs.nl>
	<20060828231122.GA2793@m0A023293.vpn.uni-freiburg.de>
Message-ID: <44F3D3B7.7000507@gust.org.pl>

Hi Heiko,

> Look at CTAN:macros/latex/contrib/oberdiek/bmpsize.pdf.
> Here I have implemented some parsing of binary image file types.

Ah, now I see what was the exact reason for \pdffiledump -) My 
understanding is that those macros are supposed to be used exclusively 
with pdf(la)TeX working in DVI mode, right? If not, what is the profit 
in PDF mode?

Regards,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From oberdiek at uni-freiburg.de  Tue Aug 29 09:37:28 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Tue, 29 Aug 2006 09:37:28 +0200
Subject: [NTG-pdftex] pdfximage
In-Reply-To: <44F3D3B7.7000507@gust.org.pl>
References: <44F34CF4.4020505@wxs.nl>
	<Pine.LNX.4.64.0608282215070.15147@hahepc1.hahe>
	<44F357B5.7020207@wxs.nl>
	<20060828231122.GA2793@m0A023293.vpn.uni-freiburg.de>
	<44F3D3B7.7000507@gust.org.pl>
Message-ID: <20060829073728.GA3563@irwin.vpn.uni-freiburg.de>

On Tue, Aug 29, 2006 at 07:42:15AM +0200, Pawe?? Jackowski wrote:

> > Look at CTAN:macros/latex/contrib/oberdiek/bmpsize.pdf.
> > Here I have implemented some parsing of binary image file types.
> 
> Ah, now I see what was the exact reason for \pdffiledump -) My 

Yes, that was my intention.

> understanding is that those macros are supposed to be used exclusively 
> with pdf(la)TeX working in DVI mode, right? If not, what is the profit 
> in PDF mode?

Hans wanted to have a possibility to check images before
using \pdfximage to avoid errors on unsupported image types.
The method used in bmpsize provides a method to do so.

The other method discussed so far is \pdfcheckimage.

What about \pdfximage that doesn't abort, but print a warning
and \pdfxlastimage returns zero for an invalid image?

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From noreply at sarovar.org  Tue Aug 29 22:43:04 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 30 Aug 2006 02:13:04 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-600 ] \pdfdraftmode: results in segfault
	+ can be tricked
Message-ID: <E1GIAQK-0007Oo-00@sarovar.org>

Bugs item #600, was opened at 2006-08-23 23:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=600&group_id=106

Category: None
Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: Martin Schr?der (oneiros)
Summary: \pdfdraftmode: results in segfault + can be tricked

Initial Comment:
The following gives a segfault here (under cygwin):

\pdfdraftmode=1
\immediate\pdfobj{x}
%\pdfoutline goto name{x}{y} % with this, too
\pdfcompresslevel=9
A
\bye

>From the terminal:

This is pdfTeXk, Version 3.141592-1.40.0-beta-20060822
(Web2C 7.5.5)
 %&-line parsing enabled.
entering extended mode
(./bugs.tex
[1{/cygdrive/c/Programme/TeXLive/texmf-var/fonts/map/pdftex/updmap/
pdftex.map}    133 [main] pdftex 1780
_cygtls::handle_exceptions: Error while dumping state
(probably corrupted stack)
Segmentation fault (core dumped)


Also, the following will create a pdf file, although it
shouldn't (or at least issue a warning about
\pdfdraftmode being issued too late):

\immediate\pdfobj{x}
\pdfdraftmode=1
A
\bye


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-08-29 22:43

Message:
Logged In: YES 
user_id=421

Thanks. The attached patch fixes at least the crash. 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=600&group_id=106

From noreply at sarovar.org  Tue Aug 29 23:02:37 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 30 Aug 2006 02:32:37 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-600 ] \pdfdraftmode: results in segfault
	+ can be tricked
Message-ID: <E1GIAjF-0003Dq-00@sarovar.org>

Bugs item #600, was opened at 2006-08-23 23:51
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=600&group_id=106

Category: None
Group: v1.40.0
Status: Open
>Resolution: Fixed
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Martin Schr?der (oneiros)
Summary: \pdfdraftmode: results in segfault + can be tricked

Initial Comment:
The following gives a segfault here (under cygwin):

\pdfdraftmode=1
\immediate\pdfobj{x}
%\pdfoutline goto name{x}{y} % with this, too
\pdfcompresslevel=9
A
\bye

>From the terminal:

This is pdfTeXk, Version 3.141592-1.40.0-beta-20060822
(Web2C 7.5.5)
 %&-line parsing enabled.
entering extended mode
(./bugs.tex
[1{/cygdrive/c/Programme/TeXLive/texmf-var/fonts/map/pdftex/updmap/
pdftex.map}    133 [main] pdftex 1780
_cygtls::handle_exceptions: Error while dumping state
(probably corrupted stack)
Segmentation fault (core dumped)


Also, the following will create a pdf file, although it
shouldn't (or at least issue a warning about
\pdfdraftmode being issued too late):

\immediate\pdfobj{x}
\pdfdraftmode=1
A
\bye


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-08-29 23:02

Message:
Logged In: YES 
user_id=421

Updated patch that also gives an error in the case of a late
\pdfdraftmode=1

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-08-29 22:43

Message:
Logged In: YES 
user_id=421

Thanks. The attached patch fixes at least the crash. 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=600&group_id=106

