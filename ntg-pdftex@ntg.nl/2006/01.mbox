From noreply at sarovar.org  Tue Jan  3 20:03:51 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan  3 20:13:10 2006
Subject: [NTG-pdftex] [ pdftex-Bugs-444 ] buffer overflow with \pdfmatch
Message-ID: <E1EtrRn-0005kc-00@sarovar.org>

Bugs item #444, was opened at 2005-10-29 17:24
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=444&group_id=106

Category: None
Group: v1.30.0
Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Martin Schr?der (oneiros)
Summary: buffer overflow with \pdfmatch

Initial Comment:
% The new \pdfmatch primitive will run into a buffer
overflow with strings
% longer than 1023 characters:
%
% (I am using 1.30.3 with Thanh's patches from
pdftex.sarovar.org/src,
% compiled under cygwin.)


\def\x{1,2,3,4,5,6,7,8,9,0,}
\def\testlist{%
  ,\x\x\x\x\x \x\x\x\x\x \x\x\x\x\x \x\x\x\x\x
   \x\x\x\x\x \x\x\x\x\x \x\x\x\x\x \x\x\x\x\x
   \x\x\x\x\x \x\x\x\x\x \x00,}% 1024

\ifcase\pdfmatch{,1,}{\testlist}\relax \fi

% Also, if the pattern is too long:
%\ifcase\pdfmatch{\testlist}{1}\relax \fi

\bye,
Robert.

PS: Is there a simple way to escape all regex special
characters in a string?



----------------------------------------------------------------------

>Comment By: Robert (schlcht)
Date: 2006-01-03 19:03

Message:
Logged In: YES 
user_id=2217

Hm, not really... The test case above still fails with both
1.30.5 and 1.40.0-alpha.

Regards,
Robert.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-12-04 14:12

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.5

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-29 19:08

Message:
Logged In: YES 
user_id=929

see patch to utils.c. This makes makecstring() memory grow
on demand. Also increase MAX_CSTRING_LEN in ptexmac.h to e.
g. 10000000.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=444&group_id=106
From noreply at sarovar.org  Tue Jan  3 20:05:18 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan  3 20:14:22 2006
Subject: [NTG-pdftex] [ pdftex-Bugs-465 ] font expansion & \lastlinefit
Message-ID: <E1EtrTC-0005mv-00@sarovar.org>

Bugs item #465, was opened at 2006-01-03 19:05
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=465&group_id=106

Category: hz
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: font expansion & \lastlinefit

Initial Comment:
With \lastlinefit > 0, the last line will always be 
expanded to the maximum (except if it doesn't contain a 
glue).

Furthermore, I wonder whether \lastlinefit should ideally
also effect the expansion amount (ie., the last line of 
the first paragraph should be set in cmr10-25, since the 
preceding one is set in cmr10-50)?

\tracingoutput1
\showboxbreadth\maxdimen
\pdftracingfonts1
\pdfadjustspacing2
\pdffontexpand\font 50 50 10 autoexpand
\lastlinefit500
\hsize=16cm
\input tufte\par
\bye,

Robert


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=465&group_id=106
From martin at oneiros.de  Tue Jan  3 22:09:24 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jan  3 23:03:25 2006
Subject: [NTG-pdftex] Re: [ pdftex-Bugs-444 ] buffer overflow with \pdfmatch
In-Reply-To: <E1EtrRn-0005kc-00@sarovar.org>
References: <E1EtrRn-0005kc-00@sarovar.org>
Message-ID: <20060103210923.GH1797@lucien.oneiros.kn-bremen.de>

On 2006-01-04 00:33:51 +0530, noreply@sarovar.org wrote:
> Hm, not really... The test case above still fails with both
> 
> 1.30.5 and 1.40.0-alpha.

Yes, as we forgot this:

> on demand. Also increase MAX_CSTRING_LEN in ptexmac.h to e.

Change MAX_CSTRING_LEN to 1024 * 1024 in ptexmac.h

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From reinhard.kotucha at web.de  Tue Jan  3 23:55:54 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Tue Jan  3 23:56:00 2006
Subject: [NTG-pdftex] cmd line arguments
Message-ID: <17339.250.748350.201976@zarniwoop.ms25.local>

Hi,
I got the latest issue of TUGboat today and read Hans' article about
LuaTeX with great interest.

Obviously Hans had the enhancement of [pdf]TeX in mind.  But I think
that much more can be done with it.

Given that LuaTeX allows shell-escapes, I think that it makes a lot of
sense to replace some Perl scripts by LuaTeX.  For instance, Heiko
fixed two bugs in epstopdf I reported but I did not get any response
from the author of the C-version which still resides on CTAN.

     http://ctan.org/tex-archive/support/epstopdf

This version is still broken.  TeXLive does not provide Perl for
Windows users and I suppose that MikTeX doesn't as well.  Instead,
binaries are provided.  If someone detects a bug, a fixed Perl script
can be provided for UNIX users immediately but Windows users still
depend on someone who provides new binaries.

Though I like Perl very much I think that LuaTeX is quite great.  It
can be make things much more portable.  Suppose that someone ports
epstopdf to LuaTeX, then Windows users can update easily.

There is one problem concerning how [pdf]TeX reads the command line.
[pdf]TeX expects a filename and considers all arguments which come
before the filename as options.  It complains if an option is not
known.  However, options after the filename are accessible by TeX.

Try the following file:

getargs.tex
__________________________________________________________________
\def\OptionPrefix{-}

\newlinechar=`\^^J \def\echo#1{\message{^^J#1}}

\def\car#1#2\\{#1}\def\cdr#1#2\\{#2}

\def\DefineOption#1#2{\expandafter\def\csname:opt:#1\endcsname{#2}}

\def\ProcessOption#1{\csname:opt:#1\endcsname}

\def\ProcessFile#1{\echo{File: "#1"}}

\def\TestOption#1{%
  \expandafter\ifx\csname:opt:#1\endcsname\relax
    \echo{Unknown Option "#1", ignored}
  \else
    \ProcessOption{#1}
  \fi
}

\def\GetArg#1 {\setbox0=\lastbox\endgraf
  \if\OptionPrefix\car#1\\
    \edef\Arg{\cdr#1\\}
    \TestOption\Arg
  \else
    \ProcessFile{#1}\expandafter\end
  \fi
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DefineOption{abc}{\echo{Known Option "abc"}}
\DefineOption{def}{\echo{Known Option "def"}}

\everypar{\GetArg}
__________________________________________________________________

When I say

   tex -abc getargs -def -uvw xyz

I get:

   $ tex -abc getargs -def -uvw xyz
   tex: unrecognized option `-abc'
   This is TeX, Version 3.141592 (Web2C 7.5.4)
   (./getargs.tex) 
   Known Option "def" 
   Unknown Option "uvw", ignored 
   File: "xyz"
   No pages of output.
   Transcript written on getargs.log.

Though it is good that TeX makes all arguments available to TeX which
come after the filename, there is a problem if getargs is a format
file.

In this case the command line looks like

    getargs -abc -def -uvw xyz

and everything before "xyz" is lost.

In other words, if you say

    epstopdf -hires myfile.eps 

TeX will complain

    epstopdf: unrecognized option `-hires.'

How can this problem be fixed?

The current behaviour of web2c is absolutely correct but I assume that
LuaTeX users need a bit more.

Is it possible to convince [pdf]TeX to ignore unknown options for
particular format files by adding some lines to texmf.cnf similar to

  TEXINPUTS.latex = ...

which disable commandline option checking and pass everything to TeX?

Another point:
It would be nice if LuaTeX allows shell-escapes.  This might be
regarded as beeing unsecure.  What about having a list of trusted
programs in texmf.cnf?   

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From pragma at wxs.nl  Wed Jan  4 10:43:57 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jan  4 10:44:09 2006
Subject: [NTG-pdftex] cmd line arguments
In-Reply-To: <17339.250.748350.201976@zarniwoop.ms25.local>
References: <17339.250.748350.201976@zarniwoop.ms25.local>
Message-ID: <43BB98DD.10908@wxs.nl>

Reinhard Kotucha wrote:

>Given that LuaTeX allows shell-escapes, I think that it makes a lot of
>sense to replace some Perl scripts by LuaTeX.  For instance, Heiko
>fixed two bugs in epstopdf I reported but I did not get any response
>from the author of the C-version which still resides on CTAN.
>
>     http://ctan.org/tex-archive/support/epstopdf
>
>This version is still broken.  TeXLive does not provide Perl for
>Windows users and I suppose that MikTeX doesn't as well.  Instead,
>binaries are provided.  If someone detects a bug, a fixed Perl script
>can be provided for UNIX users immediately but Windows users still
>depend on someone who provides new binaries.
>  
>
i've never used epstopdf so maybe i talk non-sense, but running perl on 
windows is rather trivial: there is a good installer, and it comes with 
many libs included (more than on a standard linux install)

if the win tex distributions ship with 'binaries' they are not c 
binaries, but probably zipped 'perl binary + script ' archives; there is 
actually no reason for this so if a windows user wants to use the raw 
scritp with his system perl, aal he/she has to do is

- install perl
- copy stub files [runperl.exe -> whatever.exe]
- put perl scripts in tesmf scripts path

and things should run ok

(for context users i recommend using "texmfstart whatever.pl" in stub 
files)

>Though I like Perl very much I think that LuaTeX is quite great.  It
>can be make things much more portable.  Suppose that someone ports
>epstopdf to LuaTeX, then Windows users can update easily.
>  
>
so, although your proposal is ok from the prespective of portability, 
it's not needed from the perspective of windows

concerning portability ... in principle all those shell scripts that now 
need to be provided as c program of perl script on windows qualify for 
some kind of luafying (we can even consider putting lua itself in the 
bin distributions; it's small)

(context ships with a ruby ps->pdf script and converting that would take 
quite some lua code -)

>There is one problem concerning how [pdf]TeX reads the command line.
>[pdf]TeX expects a filename and considers all arguments which come
>before the filename as options.  It complains if an option is not
>known.  However, options after the filename are accessible by TeX.
>
>Try the following file:
>
>getargs.tex
>__________________________________________________________________
>\def\OptionPrefix{-}
>
>\newlinechar=`\^^J \def\echo#1{\message{^^J#1}}
>
>\def\car#1#2\\{#1}\def\cdr#1#2\\{#2}
>
>\def\DefineOption#1#2{\expandafter\def\csname:opt:#1\endcsname{#2}}
>
>\def\ProcessOption#1{\csname:opt:#1\endcsname}
>
>\def\ProcessFile#1{\echo{File: "#1"}}
>
>\def\TestOption#1{%
>  \expandafter\ifx\csname:opt:#1\endcsname\relax
>    \echo{Unknown Option "#1", ignored}
>  \else
>    \ProcessOption{#1}
>  \fi
>}
>
>\def\GetArg#1 {\setbox0=\lastbox\endgraf
>  \if\OptionPrefix\car#1\\
>    \edef\Arg{\cdr#1\\}
>    \TestOption\Arg
>  \else
>    \ProcessFile{#1}\expandafter\end
>  \fi
>}
>
>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
>
>\DefineOption{abc}{\echo{Known Option "abc"}}
>\DefineOption{def}{\echo{Known Option "def"}}
>
>\everypar{\GetArg}
>__________________________________________________________________
>
>When I say
>
>   tex -abc getargs -def -uvw xyz
>
>I get:
>
>   $ tex -abc getargs -def -uvw xyz
>   tex: unrecognized option `-abc'
>   This is TeX, Version 3.141592 (Web2C 7.5.4)
>   (./getargs.tex) 
>   Known Option "def" 
>   Unknown Option "uvw", ignored 
>   File: "xyz"
>   No pages of output.
>   Transcript written on getargs.log.
>
>Though it is good that TeX makes all arguments available to TeX which
>come after the filename, there is a problem if getargs is a format
>file.
>
>In this case the command line looks like
>
>    getargs -abc -def -uvw xyz
>
>and everything before "xyz" is lost.
>
>In other words, if you say
>
>    epstopdf -hires myfile.eps 
>
>TeX will complain
>
>    epstopdf: unrecognized option `-hires.'
>
>How can this problem be fixed?
>
>The current behaviour of web2c is absolutely correct but I assume that
>LuaTeX users need a bit more.
>
>  
>
i can imagine that we provide access to the raw commandline (i assume 
that this info is availabl esomewhere)

>Is it possible to convince [pdf]TeX to ignore unknown options for
>particular format files by adding some lines to texmf.cnf similar to
>
>  TEXINPUTS.latex = ...
>
>which disable commandline option checking and pass everything to TeX?
>
>Another point:
>It would be nice if LuaTeX allows shell-escapes.  This might be
>regarded as beeing unsecure.  What about having a list of trusted
>programs in texmf.cnf?   
>  
>
this is always a tricky thing and i've pondered a lot about it; there 
are several cases that make sense:

1 - permit nothing
2 - permit everything
3 - permit only programs in same path as calling binary (e.g. pdftex) 
resides
4 - permits only programs in texmftree
5 - permits only programs in given list

(and maybe combinations)

so we need a setup like:

progname.systemlist=...;...;...;
progname.systemstate=<number>

for context it would be enough to have

context.systemlist=texmfstart
context.systemstate=5

since texmfstart will handle the rest

Hans
From reinhard.kotucha at web.de  Thu Jan  5 07:42:46 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Thu Jan  5 07:42:52 2006
Subject: [NTG-pdftex] cmd line arguments
In-Reply-To: <43BB98DD.10908@wxs.nl>
References: <17339.250.748350.201976@zarniwoop.ms25.local>
	<43BB98DD.10908@wxs.nl>
Message-ID: <17340.49126.157773.542359@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

  > so, although your proposal is ok from the prespective of
  > portability, it's not needed from the perspective of windows

Yes, but it is a bit annoying that you have to download and install
all the software under windows which is part of any Linux
distribution.

At work I installed cygwin for this reason.  I'm really tired from
downloading/installing all the tools I need.  It would be ok if Perl
gets installed by the TeXLive installer.

  > concerning portability ... in principle all those shell scripts
  > that now need to be provided as c program of perl script on
  > windows qualify for some kind of luafying (we can even consider
  > putting lua itself in the bin distributions; it's small)

Maybe.  But I think that as a replacement for shell scripts, Perl/Tk
is a better choice (with emphasis on Tk).

But then we need a Perl which is aware of kpathsea so that the module
path can be set in texnf.cnf.  I doubt that anyone wants to maintain
it. 

  > (context ships with a ruby ps->pdf script and converting that
  > would take quite some lua code -)

Will look into your ruby file when I have more time.  It seems that
not everybody is satisfied with epstopdf...

  > i can imagine that we provide access to the raw commandline (i
  > assume that this info is available somewhere)

Yes, but it would be good if we could convince tex (the program)
not to complain so loudly if there is an option it doesn't know.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From pragma at wxs.nl  Thu Jan  5 09:28:19 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Thu Jan  5 09:28:24 2006
Subject: [NTG-pdftex] cmd line arguments
In-Reply-To: <17340.49126.157773.542359@zarniwoop.ms25.local>
References: <17339.250.748350.201976@zarniwoop.ms25.local>
	<43BB98DD.10908@wxs.nl>
	<17340.49126.157773.542359@zarniwoop.ms25.local>
Message-ID: <43BCD8A3.2010407@wxs.nl>

Reinhard Kotucha wrote:

>>>>>>"Hans" == Hans Hagen <pragma@wxs.nl> writes:
>>>>>>            
>>>>>>
>
>  > so, although your proposal is ok from the prespective of
>  > portability, it's not needed from the perspective of windows
>
>Yes, but it is a bit annoying that you have to download and install
>all the software under windows which is part of any Linux
>distribution.
>  
>
sure but installation of perl (ruby. puthon) is trivial under windows

(btw, i alway send up installing programs like unzip and wget etc which 
are not part of standard suse linux installations, so there's always 
something left to install  -)

>At work I installed cygwin for this reason.  I'm really tired from
>downloading/installing all the tools I need.  It would be ok if Perl
>gets installed by the TeXLive installer.
>  
>
ah, cygwin ... i never use that (i only copied the ssh -related- things 
to a special path); nowadays most tools are available as native windows 
binaries

>  > concerning portability ... in principle all those shell scripts
>  > that now need to be provided as c program of perl script on
>  > windows qualify for some kind of luafying (we can even consider
>  > putting lua itself in the bin distributions; it's small)
>
>Maybe.  But I think that as a replacement for shell scripts, Perl/Tk
>is a better choice (with emphasis on Tk).
>  
>
sure, but in that case shipping the lua interpreter as part of the tex 
binaries makes sense (it's small);

>But then we need a Perl which is aware of kpathsea so that the module
>path can be set in texnf.cnf.  I doubt that anyone wants to maintain
>it. 
>  
>
i wrote a kpse class in ruby so doing it in lua is probably a matter of 
translation ... we'll see

>  > (context ships with a ruby ps->pdf script and converting that
>  > would take quite some lua code -)
>
>Will look into your ruby file when I have more time.  It seems that
>not everybody is satisfied with epstopdf...
>
>  > i can imagine that we provide access to the raw commandline (i
>  > assume that this info is available somewhere)
>
>Yes, but it would be good if we could convince tex (the program)
>not to complain so loudly if there is an option it doesn't know.
>  
>
sure; the problem is -as always- in compatibility but i think that we 
should not be too afraid to change those interface aspects and i always 
wondered why tex complained about that - it does not hurt to ignore 
unknown options

(well, we can always make complaining an option itself, configurable in 
the cnf file, off by default)

Hans
From reinhard.kotucha at web.de  Fri Jan  6 03:02:29 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Fri Jan  6 03:02:35 2006
Subject: [NTG-pdftex] cmd line arguments
In-Reply-To: <43BCD8A3.2010407@wxs.nl>
References: <17339.250.748350.201976@zarniwoop.ms25.local>
	<43BB98DD.10908@wxs.nl>
	<17340.49126.157773.542359@zarniwoop.ms25.local>
	<43BCD8A3.2010407@wxs.nl>
Message-ID: <17341.53173.228953.829159@zarniwoop.ms25.local>

>>>>> "Hans" == Hans Hagen <pragma@wxs.nl> writes:

  > sure but installation of perl (ruby. puthon) is trivial under
  > windows

Some hours ago Staszek said that TL provides Perl.  So my assumption
was wrong.

  > ah, cygwin ... i never use that (i only copied the ssh -related-
  > things to a special path); nowadays most tools are available as
  > native windows binaries

Cygwin also provides an X11 server, hence programs like xpdf work.
It's really cool.  When you start cygwin, a shell window appears.
Simply type `startx' and you get an XTerm.  You can run any X11
application then.

Before I installed cygwin I had not been aware that I can use teTeX
under Windows.  And I compiled GNU octave under cygwin without any
problems while this is impossible under SuSE because they do not
provide a Fortran compiler any more.

Is't worth a try, disk space has never been so cheap as today.

However, maybe you prefer the Windows GUI, but I'm very unhappy if I
don't have emacs and bash and have to use programs which are compiled
without libreadline.

  >> Yes, but it would be good if we could convince tex (the program)
  >> not to complain so loudly if there is an option it doesn't know.

  > sure; the problem is -as always- in compatibility but i think that
  > we should not be too afraid to change those interface aspects and
  > i always wondered why tex complained about that - it does not hurt
  > to ignore unknown options

  > (well, we can always make complaining an option itself,
  > configurable in the cnf file, off by default)

Sounds good.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha@web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------


From hanthethanh at gmail.com  Fri Jan  6 15:04:20 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Fri Jan  6 15:04:25 2006
Subject: [NTG-pdftex] pdftex-1.40.0-alpha-20051226
Message-ID: <74f506dc0601060604y74beefcdv7e5c7443d1ab8e5c@mail.gmail.com>

On Tue, Dec 27, 2005 at 09:39:39AM +0100, Hartmut Henkel wrote:
> do we really want GNUish indentation? like
>
>   if (strcmp (fp->tfm_name, nontfm) != 0)
>     {
>       p = (fm_entry *) avl_find (tfm_tree, fp);
>       if (p != NULL)
>         {
>           if (mode == FM_DUPIGNORE)
>
> i would prefer K%26R (--k-and-r-style):
>
>     if (strcmp(fp->tfm_name, nontfm) != 0) {
>         p = (fm_entry *) avl_find(tfm_tree, fp);
>         if (p != NULL) {
>             if (mode == FM_DUPIGNORE) {

so do I.

Regards,
Thanh
From hanthethanh at gmail.com  Fri Jan  6 14:53:35 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Fri Jan  6 15:39:03 2006
Subject: [NTG-pdftex] various features
Message-ID: <74f506dc0601060553r2be672ebxca2f4133bd3b214e@mail.gmail.com>

Hi,

the patch I uploaded still has some problems with
auto prepending/appending kerns, so it is better to leave
them out for the moment. I will try to split the patch into
smaller patches so Martin can decide which one(s) should go
into official releases.

Thanh


On Tue, Dec 20, 2005 at 10:17:50AM +0900, Akira Kakuto wrote:
> > On 2005-12-19 14:16:49 +0100, Hans Hagen wrote:
> > > Are all Than's recent patches included? Like the \pdfprependkern and
> > > alike stuff?
> >
> > No. But I included all I got.
> >
> > Thanh?
>
> http://pdftex.sarovar.org/src/pdftex-20050924.patch.gz
>
> Please include the above patch by Thanh
> which defines \pdfprependkern etc.
> I'm personally using the subfont mechanism
> in the patch to typeset Japanese.
> The patch is for 1.30.3. So some hand work will be needed.
>
> Thanks,
> Akira
From martin at oneiros.de  Fri Jan  6 18:25:54 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jan  6 19:02:59 2006
Subject: [NTG-pdftex] various features
In-Reply-To: <74f506dc0601060553r2be672ebxca2f4133bd3b214e@mail.gmail.com>
References: <74f506dc0601060553r2be672ebxca2f4133bd3b214e@mail.gmail.com>
Message-ID: <20060106172554.GB7048@lucien.oneiros.kn-bremen.de>

On 2006-01-06 05:53:35 -0800, The Thanh Han wrote:
> the patch I uploaded still has some problems with
> auto prepending/appending kerns, so it is better to leave
> them out for the moment. I will try to split the patch into
> smaller patches so Martin can decide which one(s) should go
> into official releases.

I'm tempted to leave it in, as getting it in was quite some work
-- and getting it out will probably be even more. Does it break
any old features? If not, it can stay. We can always declare
these features as experimental.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Fri Jan  6 19:14:16 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Fri Jan  6 19:14:20 2006
Subject: [NTG-pdftex] various features
In-Reply-To: <20060106172554.GB7048@lucien.oneiros.kn-bremen.de>
References: <74f506dc0601060553r2be672ebxca2f4133bd3b214e@mail.gmail.com>
	<20060106172554.GB7048@lucien.oneiros.kn-bremen.de>
Message-ID: <43BEB378.6010409@wxs.nl>

Martin ? wrote:

>On 2006-01-06 05:53:35 -0800, The Thanh Han wrote:
>  
>
>>the patch I uploaded still has some problems with
>>auto prepending/appending kerns, so it is better to leave
>>them out for the moment. I will try to split the patch into
>>smaller patches so Martin can decide which one(s) should go
>>into official releases.
>>    
>>
>
>I'm tempted to leave it in, as getting it in was quite some work
>-- and getting it out will probably be even more. Does it break
>any old features? If not, it can stay. We can always declare
>these features as experimental.
>  
>
i agree with this

Hans
From martin at oneiros.de  Fri Jan  6 22:08:01 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri Jan  6 22:16:28 2006
Subject: [NTG-pdftex] pdftex-1.40.0-alpha-20060106
Message-ID: <20060106210801.GF7048@lucien.oneiros.kn-bremen.de>

http://sarovar.org/download.php/890/pdftex-1.40.0-alpha-20051226-20060106.diff.gz
http://sarovar.org/download.php/891/pdftex-1.40.0-alpha-20060106.tar.bz2

- many small fixes to remove warnings from -Wall
- removed some unused variables
- really fix bug 444
- add some GCC extensions and use *nprintf instead of *printf
  where possible
- fixed a unicode bug in ttf2afm

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Fri Jan  6 23:45:15 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Jan  6 23:54:31 2006
Subject: [NTG-pdftex] [ pdftex-Bugs-393 ] Ensure newline before endstream
Message-ID: <E1Ev0Kh-0005Sn-00@sarovar.org>

Bugs item #393, was opened at 2005-07-25 16:09
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=393&group_id=106

Category: None
Group: v1.30.0
Status: Open
Resolution: None
Priority: 2
Submitted By: Martin Schr?der (oneiros)
Assigned to: Martin Schr?der (oneiros)
Summary: Ensure newline before endstream

Initial Comment:
As reported by Hans, there is not always a newline
before endstream, although the PDF reference recommends
it. 

Any change needs careful testing.

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2006-01-06 23:45

Message:
Logged In: YES 
user_id=929

Implementation of pdf_end_stream() changed: Last byte within
any stream written to the PDF file is now remembered in
pdf_last_byte, so that one can check if a separate
pdf_new_line_char "\n" is needed before "endstream". No need
to look back in maybe already flushed pdfbuf.

Patch to 1.40.0-alpha-20060106. Plus a few tiny patches.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=393&group_id=106
From noreply at sarovar.org  Sat Jan  7 01:06:41 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jan  7 01:15:53 2006
Subject: [NTG-pdftex] [ pdftex-Patches-453 ] Object Streams for PDF-1.5
Message-ID: <E1Ev1bV-0004S2-00@sarovar.org>

Patches item #453, was opened at 2005-11-26 18:05
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=453&group_id=106

Category: Object Streams
Group: v1.30.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Nobody (None)
Summary: Object Streams for PDF-1.5

Initial Comment:
Rough early patch, work in progress, produces PDF-1.5
object streams and cross reference streams. With the
patch, and enabled by \pdfminorversion=5, and with
luck, pdfetex produces e. g. from its WEB source a PDF
file with size 5.97 MByte instead of 11.2 MByte without
object streams.

Regards, Hartmut

----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2006-01-07 01:06

Message:
Logged In: YES 
user_id=929

objstream.ch updated: 1. object stream statistics added. 2.
maximum allocation values are added in brackets. Example:

PDF statistics:
 630 PDF objects out of 1000 (max. 8388607)
 577 compressed objects within 6 object streams
 113 named destinations out of 1000 (max. 131072)
 8353 words of extra memory for PDF output out of 10000
(max. 10000000)

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-12-26 20:21

Message:
Logged In: YES 
user_id=929

Patch update. Object stream writing is now controlled by
primitive \pdfobjcompresslevel = 0...3 (/pdfobjectstreams
primitive removed). 0 = no object streams at all, 1 =
compress objects excluding the ones from embedded PDF files
(for handling of problematic PDF files) and /Info dictionary
(for legibility), 2 = also compress objects from embedded
PDF files, but leave /Info uncompressed, 3 = compress
everything.

Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=453&group_id=106
From kakuto at fsci.fuk.kindai.ac.jp  Sat Jan  7 01:40:16 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Sat Jan  7 01:40:29 2006
Subject: [NTG-pdftex] pdftex-1.40.0-alpha-20060106
In-Reply-To: Your message of "Fri, 6 Jan 2006 22:08:01 +0100"
References: <20060106210801.GF7048@lucien.oneiros.kn-bremen.de>
Message-ID: <200601070040.k070eHGM016002@jupiter.fsci.fuk.kindai.ac.jp>

Hi Martin,

> http://sarovar.org/download.php/890/pdftex-1.40.0-alpha-20051226-20060106.diff.gz
> http://sarovar.org/download.php/891/pdftex-1.40.0-alpha-20060106.tar.bz2
> 
> - many small fixes to remove warnings from -Wall
> ...

Please change tex-make.c as follows, though the corrected lines
are rarely used in real life.

Thanks
Akira

--- tex-make.c.orig	Wed Dec 28 01:15:25 2005
+++ tex-make.c	Sat Jan 07 08:27:10 2006
@@ -30,8 +30,9 @@
 #include <kpathsea/readable.h>
 #include <kpathsea/tex-make.h>
 #include <kpathsea/variable.h>
-#include <sys/wait.h>
-
+#ifndef  WIN32
+#  include <sys/wait.h>
+#endif
 
 /* We never throw away stdout, since that is supposed to be the filename
    found, if all is successful.  This variable controls whether stderr
@@ -67,13 +68,13 @@
 
           if (f > 1) {
               if (r > 0) {
-                  sprintf(q, "%u+%u/(%u*%u + %u)",
+                  sprintf(q, "%u+%u/(%u*%u+%u)",
                           dpi/bdpi, dpi%bdpi, f, (bdpi - r)/f, r);
               } else {
                   sprintf(q, "%u+%u/(%u*%u)", dpi/bdpi, dpi%bdpi, f, bdpi/f);
               }
           } else {
-              sprintf(q, "%u+%u/(4000 + %u)", dpi/bdpi, dpi%bdpi, bdpi);
+              sprintf(q, "%u+%u/(4000+%u)", dpi/bdpi, dpi%bdpi, r);
           }
       }
   } else {
From hanthethanh at gmail.com  Sat Jan  7 12:48:44 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Sat Jan  7 13:37:28 2006
Subject: [NTG-pdftex] various features
Message-ID: <74f506dc0601070348g3d467c6ch3f1a560a790924a1@mail.gmail.com>

On Fri, Jan 06, 2006 at 07:14:16PM +0100, Hans Hagen wrote:
> Martin ??? wrote:
>
> >On 2006-01-06 05:53:35 -0800, The Thanh Han wrote:
> >
> >
> >>the patch I uploaded still has some problems with
> >>auto prepending/appending kerns, so it is better to leave
> >>them out for the moment. I will try to split the patch into
> >>smaller patches so Martin can decide which one(s) should go
> >>into official releases.
> >>
> >>
> >
> >I'm tempted to leave it in, as getting it in was quite some work
> >-- and getting it out will probably be even more. Does it break
> >any old features? If not, it can stay. We can always declare
> >these features as experimental.
> >
> >
> i agree with this

those new features don't break things unless they are used
(like hz or margin kerning). But they are not documented
yet, probably only Hans and Robert are aware of them.
So if we can live with that, it can stay. Makes our life
simpler.

Thanh
From martin at oneiros.de  Sat Jan  7 14:35:15 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jan  7 15:31:57 2006
Subject: [NTG-pdftex] pdftex-1.40.0-alpha-20060106
In-Reply-To: <200601070040.k070eHGM016002@jupiter.fsci.fuk.kindai.ac.jp>
References: <20060106210801.GF7048@lucien.oneiros.kn-bremen.de>
	<200601070040.k070eHGM016002@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <20060107133515.GA18553@lucien.oneiros.kn-bremen.de>

On 2006-01-07 09:40:16 +0900, Akira Kakuto wrote:
> Please change tex-make.c as follows, though the corrected lines
> are rarely used in real life.

Done.

Thanks
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Sat Jan  7 17:22:42 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jan  7 17:31:54 2006
Subject: [NTG-pdftex] [ pdftex-Patches-466 ] \primitive and \ifprimitive
Message-ID: <E1EvGq2-0002oX-00@sarovar.org>

Patches item #466, was opened at 2006-01-07 17:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

Category: Primitives
Group: v1.40.0
Status: Open
Resolution: None
Priority: 4
Submitted By: Taco Hoekwater (taco)
Assigned to: Martin Schr?der (oneiros)
Summary: \primitive and \ifprimitive

Initial Comment:
This patch implements two new primitives:

  \primitive \par

This will run the 'primitive' command \par, even if it 
has been re- or undefined in the meantime. \primitive
is not expandable, because it may be asked to execute
unexpandable primitives as well as expandable ones.

If you supply a nonexistant primitive, it will be 
ignored (no error is raised).

The second primitive is a new type of \if:

  \ifprimitive \par ... \else .. \fi

returns true if the current meaning of \par is the
'primitive' command \par.


The patch is against alpha-20051226, i hope that is not 
too old (?). I expect to do at least one minor update 
during the beta cycle, after the pdftex code is 
flattened. It was quite a struggle to make this 
change file work ok, and as a result, there are 
a few ugly web hacks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106
From noreply at sarovar.org  Sat Jan  7 22:49:33 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Sat Jan  7 22:58:47 2006
Subject: [NTG-pdftex] [ pdftex-Bugs-465 ] font expansion & \lastlinefit
Message-ID: <E1EvLwL-0008VR-00@sarovar.org>

Bugs item #465, was opened at 2006-01-03 20:05
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=465&group_id=106

Category: hz
>Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: font expansion & \lastlinefit

Initial Comment:
With \lastlinefit > 0, the last line will always be 
expanded to the maximum (except if it doesn't contain a 
glue).

Furthermore, I wonder whether \lastlinefit should ideally
also effect the expansion amount (ie., the last line of 
the first paragraph should be set in cmr10-25, since the 
preceding one is set in cmr10-50)?

\tracingoutput1
\showboxbreadth\maxdimen
\pdftracingfonts1
\pdfadjustspacing2
\pdffontexpand\font 50 50 10 autoexpand
\lastlinefit500
\hsize=16cm
\input tufte\par
\bye,

Robert


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=465&group_id=106
From martin at oneiros.de  Sat Jan  7 23:25:47 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun Jan  8 00:40:00 2006
Subject: [NTG-pdftex] Re: [ pdftex-Patches-466 ] \primitive and \ifprimitive
In-Reply-To: <E1EvGq2-0002oX-00@sarovar.org>
References: <E1EvGq2-0002oX-00@sarovar.org>
Message-ID: <20060107222547.GA22726@lucien.oneiros.kn-bremen.de>

On 2006-01-07 21:52:42 +0530, noreply@sarovar.org wrote:
> The patch is against alpha-20051226, i hope that is not 
> too old (?). I expect to do at least one minor update 
> during the beta cycle, after the pdftex code is 
> flattened. It was quite a struggle to make this 
> change file work ok, and as a result, there are 
> a few ugly web hacks.

Thanks for the patch; it applies very fine to the latest alpha
and compiles o.k.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Sat Jan  7 23:27:12 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun Jan  8 00:40:01 2006
Subject: [NTG-pdftex] Re: [ pdftex-Bugs-393 ] Ensure newline before endstream
In-Reply-To: <E1Ev0Kh-0005Sn-00@sarovar.org>
References: <E1Ev0Kh-0005Sn-00@sarovar.org>
Message-ID: <20060107222712.GB22726@lucien.oneiros.kn-bremen.de>

On 2006-01-07 04:15:15 +0530, noreply@sarovar.org wrote:
> Implementation of pdf_end_stream() changed: Last byte within
> any stream written to the PDF file is now remembered in
> pdf_last_byte, so that one can check if a separate
> pdf_new_line_char "\n" is needed before "endstream". No need
> to look back in maybe already flushed pdfbuf.

Thanks; now the pdf on the title is one line longer. :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Mon Jan  9 13:30:23 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jan  9 13:46:39 2006
Subject: [NTG-pdftex] /ModDate and /Trapped (was: [pdftex] PDFX3 Standard)
In-Reply-To: <20031027113206.GK25242@artcom8.artcom-gmbh.de>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
Message-ID: <20060109123023.GE6701@lucien.oneiros.kn-bremen.de>

On 2003-10-27 12:32:06 +0100, Martin Schr?der wrote:
> On 2003-10-27 12:38:19 +0100, Siep Kroonenberg wrote:
> >   /ModDate (D:\pdfdate)
> 
> Will set this in the next version
> 
> >   /Trapped (False)
> 
> Another primitive... :-{

Hi,
we forgot about /ModDate and /Trapped. Any objections against
setting /ModDate to the same value as /CreationDate per default?
And should we also default /Trapped to /False?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jan  9 14:51:35 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jan  9 14:51:41 2006
Subject: [NTG-pdftex] /ModDate and /Trapped
In-Reply-To: <20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
	<20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
Message-ID: <43C26A67.3020607@wxs.nl>

Martin ? wrote:

>On 2003-10-27 12:32:06 +0100, Martin Schr?der wrote:
>  
>
>>On 2003-10-27 12:38:19 +0100, Siep Kroonenberg wrote:
>>    
>>
>>>  /ModDate (D:\pdfdate)
>>>      
>>>
>>Will set this in the next version
>>
>>    
>>
>>>  /Trapped (False)
>>>      
>>>
>>Another primitive... :-{
>>    
>>
>
>Hi,
>we forgot about /ModDate and /Trapped. Any objections against
>setting /ModDate to the same value as /CreationDate per default?
>And should we also default /Trapped to /False?
>  
>

leave that to the macro package, else we end up with way to many key 
related primitives

Hans
From martin at oneiros.de  Mon Jan  9 15:01:46 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jan  9 15:30:34 2006
Subject: [NTG-pdftex] /ModDate and /Trapped
In-Reply-To: <43C26A67.3020607@wxs.nl>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
	<20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
	<43C26A67.3020607@wxs.nl>
Message-ID: <20060109140146.GA8686@lucien.oneiros.kn-bremen.de>

On 2006-01-09 14:51:35 +0100, Hans Hagen wrote:
> Martin ??? wrote:
> >we forgot about /ModDate and /Trapped. Any objections against
> >setting /ModDate to the same value as /CreationDate per default?
> >And should we also default /Trapped to /False?
> 
> leave that to the macro package, else we end up with way to many key 
> related primitives

It wouldn't introduce any new primitive, just keys for \pdfinfo.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jan  9 16:12:10 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jan  9 16:12:13 2006
Subject: [NTG-pdftex] /ModDate and /Trapped
In-Reply-To: <20060109140146.GA8686@lucien.oneiros.kn-bremen.de>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
	<20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
	<43C26A67.3020607@wxs.nl>
	<20060109140146.GA8686@lucien.oneiros.kn-bremen.de>
Message-ID: <43C27D4A.2080209@wxs.nl>

Martin ? wrote:

>On 2006-01-09 14:51:35 +0100, Hans Hagen wrote:
>  
>
>>Martin ??? wrote:
>>    
>>
>>>we forgot about /ModDate and /Trapped. Any objections against
>>>setting /ModDate to the same value as /CreationDate per default?
>>>And should we also default /Trapped to /False?
>>>      
>>>
>>leave that to the macro package, else we end up with way to many key 
>>related primitives
>>    
>>
>
>It wouldn't introduce any new primitive, just keys for \pdfinfo.
>  
>
hm, but keep in mind that macro packages or users already may set 
/ModDate and /Trapped (context does set them) so if you support keys, 
then you also need ot make sure that user settings are not replaced

Hans
From oberdiek at uni-freiburg.de  Mon Jan  9 17:13:44 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon Jan  9 17:14:07 2006
Subject: [NTG-pdftex] /ModDate and /Trapped
In-Reply-To: <43C27D4A.2080209@wxs.nl>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
	<20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
	<43C26A67.3020607@wxs.nl>
	<20060109140146.GA8686@lucien.oneiros.kn-bremen.de>
	<43C27D4A.2080209@wxs.nl>
Message-ID: <20060109161344.GA3575@irwin.vpn.uni-freiburg.de>

On Mon, Jan 09, 2006 at 04:12:10PM +0100, Hans Hagen wrote:

> Martin ??? wrote:
> 
> >On 2006-01-09 14:51:35 +0100, Hans Hagen wrote:
> > 
> >
> >>Martin ??? wrote:
> >>   
> >>
> >>>we forgot about /ModDate and /Trapped. Any objections against
> >>>setting /ModDate to the same value as /CreationDate per default?
> >>>And should we also default /Trapped to /False?
> >>>     
> >>>
> >>leave that to the macro package, else we end up with way to many key 
> >>related primitives
> >>   
> >>
> >
> >It wouldn't introduce any new primitive, just keys for \pdfinfo.
> > 
> >
> hm, but keep in mind that macro packages or users already may set 
> /ModDate and /Trapped (context does set them) so if you support keys, 
> then you also need ot make sure that user settings are not replaced

This shouldn't be a problem, if the same code is used as for
/CreationDate, /Producer, and /Creator, see pdf_print_info
in file "pdftexdir/pdftex.ch".

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From martin at oneiros.de  Mon Jan  9 18:01:43 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jan  9 18:08:31 2006
Subject: [NTG-pdftex] /ModDate and /Trapped
In-Reply-To: <20060109161344.GA3575@irwin.vpn.uni-freiburg.de>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
	<20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
	<43C26A67.3020607@wxs.nl>
	<20060109140146.GA8686@lucien.oneiros.kn-bremen.de>
	<43C27D4A.2080209@wxs.nl>
	<20060109161344.GA3575@irwin.vpn.uni-freiburg.de>
Message-ID: <20060109170142.GA9810@lucien.oneiros.kn-bremen.de>

On 2006-01-09 17:13:44 +0100, Heiko Oberdiek wrote:
> On Mon, Jan 09, 2006 at 04:12:10PM +0100, Hans Hagen wrote:
> > >>Martin ??? wrote:
> > >>>we forgot about /ModDate and /Trapped. Any objections against
> > >>>setting /ModDate to the same value as /CreationDate per default?
> > >>>And should we also default /Trapped to /False?
> > >
> > hm, but keep in mind that macro packages or users already may set 
> > /ModDate and /Trapped (context does set them) so if you support keys, 
> > then you also need ot make sure that user settings are not replaced
> 
> This shouldn't be a problem, if the same code is used as for
> /CreationDate, /Producer, and /Creator, see pdf_print_info
> in file "pdftexdir/pdftex.ch".

Exactly. So, the next version will default /ModDate. 
Should it also default /Trapped to /False?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jan  9 18:21:24 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jan  9 18:21:30 2006
Subject: [NTG-pdftex] /ModDate and /Trapped
In-Reply-To: <20060109170142.GA9810@lucien.oneiros.kn-bremen.de>
References: <Pine.LNX.4.05.10310261716070.6684-100000@INET.anae.kla.de>
	<20031027113819.GB797@bitmuis.thuis.nl>
	<20031027113206.GK25242@artcom8.artcom-gmbh.de>
	<20060109123023.GE6701@lucien.oneiros.kn-bremen.de>
	<43C26A67.3020607@wxs.nl>
	<20060109140146.GA8686@lucien.oneiros.kn-bremen.de>
	<43C27D4A.2080209@wxs.nl>
	<20060109161344.GA3575@irwin.vpn.uni-freiburg.de>
	<20060109170142.GA9810@lucien.oneiros.kn-bremen.de>
Message-ID: <43C29B94.5030209@wxs.nl>

Martin ? wrote:

>Should it also default /Trapped to /False?
>  
>
ok

Hans
From noreply at sarovar.org  Tue Jan 10 05:32:32 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 10 05:41:41 2006
Subject: [NTG-pdftex] [ pdftex-Patches-467 ] new primitive \ifinedef
Message-ID: <E1EwBBQ-0002Nj-00@sarovar.org>

Patches item #467, was opened at 2006-01-10 04:32
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=467&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Nobody (None)
Summary: new primitive \ifinedef

Initial Comment:
This patch (by Morten H?gholm) contains improvement for
the \ifincsname primitive and implements a new similar
primitive \ifinedef. Made against
pdftex-1.40.0-alpha-20060106

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=467&group_id=106
From taco at elvenkind.com  Tue Jan 10 12:28:50 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue Jan 10 12:28:57 2006
Subject: [NTG-pdftex] pdftex-1.40.0-alpha-20060106
In-Reply-To: <20060106210801.GF7048@lucien.oneiros.kn-bremen.de>
References: <20060106210801.GF7048@lucien.oneiros.kn-bremen.de>
Message-ID: <43C39A72.7000509@elvenkind.com>



Martin Schr?der wrote:
> http://sarovar.org/download.php/890/pdftex-1.40.0-alpha-20051226-20060106.diff.gz
> http://sarovar.org/download.php/891/pdftex-1.40.0-alpha-20060106.tar.bz2
> 
> - many small fixes to remove warnings from -Wall

Probably harmless, but I get a few new warnings from GCC
(that's the engine comparison code):

pdfetexini.c: In function 'storefmtfile':
pdfetexini.c:3349: warning: pointer targets in passing argument 1 of 
'strcpy' differ in signedness
pdfetexini.c: In function 'loadfmtfile':
pdfetexini.c:3660: warning: pointer targets in passing argument 1 of 
'strlen' differ in signedness
pdfetexini.c:3660: warning: pointer targets in passing argument 2 of 
'__builtin_strcmp' differ in signedness
pdfetexini.c:3660: warning: pointer targets in passing argument 2 of 
'__builtin_strcmp' differ in signedness
pdfetexini.c:3660: warning: pointer targets in passing argument 1 of 
'strlen' differ in signedness
pdfetexini.c:3660: warning: pointer targets in passing argument 2 of 
'__builtin_strcmp' differ in signedness
pdfetexini.c:3660: warning: pointer targets in passing argument 2 of 
'__builtin_strcmp' differ in signedness
pdfetexini.c:4250: warning: comparison is always false due to limited 
range of data type


Cheers, Taco
From martin at oneiros.de  Tue Jan 10 18:37:31 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jan 10 19:02:59 2006
Subject: [NTG-pdftex] -Wall (was: pdftex-1.40.0-alpha-20060106)
In-Reply-To: <43C39A72.7000509@elvenkind.com>
References: <20060106210801.GF7048@lucien.oneiros.kn-bremen.de>
	<43C39A72.7000509@elvenkind.com>
Message-ID: <20060110173731.GA22475@lucien.oneiros.kn-bremen.de>

On 2006-01-10 12:28:50 +0100, Taco Hoekwater wrote:
> Martin Schr?der wrote:
> >- many small fixes to remove warnings from -Wall
> 
> Probably harmless, but I get a few new warnings from GCC
> (that's the engine comparison code):

There are still some warnings left, but these are caused by the
web2c conversion (at least with gcc 2.95). I eleminated
everything about unsused variables or implicit declarations. :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Wed Jan 11 19:25:19 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jan 11 19:31:36 2006
Subject: [NTG-pdftex] pdftex-1.40.0-alpha-20060111
Message-ID: <20060111182518.GC1690@lucien.oneiros.kn-bremen.de>

http://sarovar.org/download.php/895/pdftex-1.40.0-alpha-20060106-20060111.diff.gz
http://sarovar.org/download.php/896/pdftex-1.40.0-alpha-20060111.tar.bz2

- new patches:
  - 466 \primitive and \ifprimitive
  - 467 \ifinedef
- improved patches:
  - 393 Ensure newline before endstream
- pdfTeX now sets /ModDate and /Trapped by default (the values can be
  overridden with /pdfinfo)
- more fixes to remove warnings from -Wall

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Thu Jan 12 02:39:51 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jan 12 02:49:01 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1EwrRP-0000L0-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: Nobody (None)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From noreply at sarovar.org  Thu Jan 12 09:08:44 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jan 12 09:18:22 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1EwxVk-0005FR-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 01:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: Nobody (None)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

>Comment By: Hans Hagen (hagen)
Date: 2006-01-12 08:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From noreply at sarovar.org  Thu Jan 12 10:14:05 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jan 12 10:23:34 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1EwyWz-0003Eq-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 07:09
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: Nobody (None)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 14:44

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 13:38

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From noreply at sarovar.org  Thu Jan 12 11:22:33 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Thu Jan 12 11:32:07 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1EwzbF-0001Yk-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: Nobody (None)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 11:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 10:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 09:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From noreply at sarovar.org  Fri Jan 13 05:50:04 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Fri Jan 13 05:59:45 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1ExGt2-0005AH-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: Nobody (None)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

>Comment By: Morten H?gholm (morten)
Date: 2006-01-13 05:50

Message:
Logged In: YES 
user_id=3333

Yes, just ideas here, which is why I asked for comments. We can discuss 
this on the list (once my subscription is accepted).

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 11:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 10:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 09:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From pragma at wxs.nl  Sun Jan 15 20:11:02 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Sun Jan 15 20:11:01 2006
Subject: [NTG-pdftex] Re: [pdftex] Math Pdftex extensions ?
In-Reply-To: <19710729417.20060115191350@alcandre.net>
References: <19710729417.20060115191350@alcandre.net>
Message-ID: <43CA9E46.80109@wxs.nl>

Paul Pichaureau wrote:

>  Dear all,
>
>  As I'm a fanatic a beautiful typography, I'm following your work on
>pdftex with great attention, especially enjoying the pdftex extensions
>already implemented (microtype and all the hz stuff).
>
>  Anyway, I'm wondering if you plan to extend pdftex in order to
>improve the mathematical typography of TeX. I'm developping a big set
>of mathematical fonts (called mathdesign) and I'm quite aware of the
>problems of TeX in this domain.
>
>I've precise points in mind: mathematical accents, radical with left
>and right delimiters, and, of course, the insufficiencies of the tfm
>format. But you already know that better than me.
>
>So, this is my question: is it planned to improve some of these points
>in the future ?
>  
>
if you can point out the specific things that you want to be supported, 
the pdftex dev team can look into it

after all, pdftex is also a playground for new tex functionality (within 
reasonable bounds)

Hans
From paul.pichaureau at alcandre.net  Sun Jan 15 22:58:27 2006
From: paul.pichaureau at alcandre.net (Paul Pichaureau)
Date: Sun Jan 15 23:33:51 2006
Subject: [NTG-pdftex] Re: [pdftex] Math Pdftex extensions ?
In-Reply-To: <43CA9E46.80109@wxs.nl>
References: <19710729417.20060115191350@alcandre.net> <43CA9E46.80109@wxs.nl>
Message-ID: <549706134.20060115225827@alcandre.net>

Le dimanche 15 janvier 2006 ? 20:11:02, vous ?criviez :

HH> Paul Pichaureau wrote:

HH> if you can point out the specific things that you want to be supported,
HH> the pdftex dev team can look into it

HH> after all, pdftex is also a playground for new tex functionality (within
HH> reasonable bounds)

Well, that's a good question... I do know that some terrific ideas, at
first glance, could be a nightmare to implement. But this is some
point I find interesting:


1) Of the following document, I shall retain some ideas

http://ftp.ktug.or.kr/tex-archive/systems/tex-extensions/clasen/examples/example3/example3.ps

The extended semantics of \mathaccent is a good idea. It could
extend the possibilities of TeX significatively. I think you could
create a new kind of accent (let's say \exmathaccent) for that.

The possibility to switch in cramped styles could be nice for testing
purpose, although useless for most users. The generalized radical is
nice also... but of limited interest, isn'it ?)

2) Under accents are waited by many users for a long time. The problem
remain the lack of a new \skewchar character to tweak the placement of
the underaccent.

Moreover, extensible underaccent could be a nice improvement in term
of typesetting quality. With that, it should be able to design
beautiful \under and \overbrace (the actual horizontal braces of TeX are
ugly, IMHO).

I'm an neophyt in these matters, but I think, if an equivalent to the
existing \skewchar is defined, the rest will not be so difficult to
implement.

I'm aware the existing math fonts will need to be tweaked, but I think
this feature deserves many efforts!

3) A point cited by Knuth is a deficiency in the fraction typesetting
algorithm: the minimal distance between the numerator and the
denominator of a fraction is related to the rulethickness of the
mathematical fonts. That could lead to ugly results if the font is
very bold (for example Utopia Bold).

The perfect solution consists in the introduction of a new fontdimen
(let's say fontdimen23). But there is a risk of incompatibility, if
someone has already used these fontdimen. A new TeX dimension
parameter should be introduced here.

4) The last point I want to cite now is the spacing of formula in
script and scriptscript style. For a unclear reason, in script style
TeX doesn't introduce any spaces between symbols as it does in text
and display style.

This is good for computer modern, which is legible at all size. But
today, we use scalable fonts which are less legible than CM in small
sizes. I think the possibility to switch on the formula spacing in
script and scriptscript style should lead to a significant improvement
of legibility for some fonts.



Well, I have many others ideas. But I present here the most useful/the
easiest to implement... I hope ! :-)





HH> Hans




-- 
  Paul Pichaureau                            www.alcandre.net


From martin at oneiros.de  Mon Jan 16 02:43:58 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jan 16 07:53:03 2006
Subject: [NTG-pdftex] Flattening the web files (was: 1.40 Schedule)
In-Reply-To: <20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
Message-ID: <20060116014358.GC15364@lucien.oneiros.kn-bremen.de>

On 2005-12-14 13:40:42 +0100, Martin Schr?der wrote:
> On 2005-12-14 10:05:21 +0100, Taco Hoekwater wrote:
> > At what point do you intend to flatten the web files?
> 
> Starting with beta, i.e. after 2006-01-15.

I've started this by merging the change files and want to end
up with pdftex1.ch (applied to tex.web) and pdftex2.ch (merged
with all the web2c-changes). extra.ch will have to stay, but will
be renamed to pdfetex.ch4.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jan 16 12:15:40 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jan 16 12:15:37 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
Message-ID: <43CB805C.2070607@wxs.nl>

Martin ? wrote:

>On 2005-12-14 13:40:42 +0100, Martin Schr?der wrote:
>  
>
>>On 2005-12-14 10:05:21 +0100, Taco Hoekwater wrote:
>>    
>>
>>>At what point do you intend to flatten the web files?
>>>      
>>>
>>Starting with beta, i.e. after 2006-01-15.
>>    
>>
>
>I've started this by merging the change files and want to end
>up with pdftex1.ch (applied to tex.web) and pdftex2.ch (merged
>with all the web2c-changes). extra.ch will have to stay, but will
>be renamed to pdfetex.ch4.
>  
>
why no go for a pdftex.web (no tex.web any longer); seems better to me 
if we go 32 bit

Hans

From taco at elvenkind.com  Mon Jan 16 12:34:59 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jan 16 12:33:47 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CB805C.2070607@wxs.nl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>	<439FE051.7000102@elvenkind.com>	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl>
Message-ID: <43CB84E3.9040006@elvenkind.com>

Hans Hagen wrote:
> why no go for a pdftex.web (no tex.web any longer); seems better to me 
> if we go 32 bit

I agree, that would be easier. The number of fixes to tex.web is 
near-zero anyway.

Taco
From martin at oneiros.de  Mon Jan 16 17:30:14 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jan 16 17:34:25 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CB84E3.9040006@elvenkind.com>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
Message-ID: <20060116163014.GA25752@lucien.oneiros.kn-bremen.de>

On 2006-01-16 12:34:59 +0100, Taco Hoekwater wrote:
> Hans Hagen wrote:
> >why no go for a pdftex.web (no tex.web any longer); seems better to me 
> >if we go 32 bit
> 
> I agree, that would be easier. The number of fixes to tex.web is 
> near-zero anyway.

What about eTeX? Currently I have

pdfetex_web_srcs = $(srcdir)/tex.web \
  $(srcdir)/etexdir/etex.ch \
  $(srcdir)/etexdir/etex.fix \
  $(srcdir)/pdfetexdir/pdfetex.ch1 \
  $(srcdir)/pdftexdir/pdftex.ch \
  $(srcdir)/pdfetexdir/pdfetex.ch2

and

pdftex_web_srcs = $(srcdir)/tex.web \
  $(srcdir)/pdftexdir/pdftex.ch

So pdftex.web _or_ pdfetex.web would be easy, but having one file
for both would be difficult. Shall we simply drop pdftex.web and
go for an integrated pdfetex.web? Both TeX and eTeX are very
stable.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Mon Jan 16 17:56:26 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon Jan 16 17:56:30 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
Message-ID: <43CBD03A.9010106@wxs.nl>

Martin ? wrote:

>On 2006-01-16 12:34:59 +0100, Taco Hoekwater wrote:
>  
>
>>Hans Hagen wrote:
>>    
>>
>>>why no go for a pdftex.web (no tex.web any longer); seems better to me 
>>>if we go 32 bit
>>>      
>>>
>>I agree, that would be easier. The number of fixes to tex.web is 
>>near-zero anyway.
>>    
>>
>
>What about eTeX? Currently I have
>
>pdfetex_web_srcs = $(srcdir)/tex.web \
>  $(srcdir)/etexdir/etex.ch \
>  $(srcdir)/etexdir/etex.fix \
>  $(srcdir)/pdfetexdir/pdfetex.ch1 \
>  $(srcdir)/pdftexdir/pdftex.ch \
>  $(srcdir)/pdfetexdir/pdfetex.ch2
>
>and
>
>pdftex_web_srcs = $(srcdir)/tex.web \
>  $(srcdir)/pdftexdir/pdftex.ch
>
>So pdftex.web _or_ pdfetex.web would be easy, but having one file
>for both would be difficult. Shall we simply drop pdftex.web and
>go for an integrated pdfetex.web? Both TeX and eTeX are very
>stable.
>  
>
drop

also, let's define pdfetex as an abbreviation for pdfe(xtended)tex

i suppose that you merge the etex code into the flattened file?

Hans
From taco at elvenkind.com  Mon Jan 16 18:03:35 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon Jan 16 18:03:39 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CBD03A.9010106@wxs.nl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>	<439FE051.7000102@elvenkind.com>	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>	<43CB805C.2070607@wxs.nl>
	<43CB84E3.9040006@elvenkind.com>	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl>
Message-ID: <43CBD1E7.8030304@elvenkind.com>



Hans Hagen wrote:
>>
>> So pdftex.web _or_ pdfetex.web would be easy, but having one file
>> for both would be difficult. Shall we simply drop pdftex.web and
>> go for an integrated pdfetex.web? Both TeX and eTeX are very
>> stable.
>>  
> drop

drop

> i suppose that you merge the etex code into the flattened file?

yes, please. We probably want/have to modify the etex stuff for
opentype/wide characters support.

Cheers,
Taco
From martin at oneiros.de  Mon Jan 16 19:13:57 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon Jan 16 19:23:32 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CBD1E7.8030304@elvenkind.com>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl> <43CBD1E7.8030304@elvenkind.com>
Message-ID: <20060116181357.GC25752@lucien.oneiros.kn-bremen.de>

On 2006-01-16 18:03:35 +0100, Taco Hoekwater wrote:
> Hans Hagen wrote:
> >drop
> 
> drop

O.K.

> >i suppose that you merge the etex code into the flattened file?
> 
> yes, please. We probably want/have to modify the etex stuff for
> opentype/wide characters support.

I will use tie, i.e. the pdfetex.web generated by the Makefile,
and copy the comments manually.

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Mon Jan 16 21:23:32 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Mon Jan 16 21:33:12 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1Eyat2-0000hg-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: Nobody (None)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

>Comment By: Morten H?gholm (morten)
Date: 2006-01-16 21:23

Message:
Logged In: YES 
user_id=3333

@None: An \ifalignscanning primitive can also help macros like LaTeX's 
\multicolumn and other code that relies on seeing \noalign or \omit to 
recover gracefully with a comprehensible error message.

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-13 05:50

Message:
Logged In: YES 
user_id=3333

Yes, just ideas here, which is why I asked for comments. We can discuss 
this on the list (once my subscription is accepted).

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 11:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 10:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 09:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From martin at oneiros.de  Tue Jan 17 16:38:29 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jan 17 17:05:41 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060116181357.GC25752@lucien.oneiros.kn-bremen.de>
References: <20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl> <43CBD1E7.8030304@elvenkind.com>
	<20060116181357.GC25752@lucien.oneiros.kn-bremen.de>
Message-ID: <20060117153829.GB5658@lucien.oneiros.kn-bremen.de>

On 2006-01-16 19:13:57 +0100, Martin Schr?der wrote:
> > yes, please. We probably want/have to modify the etex stuff for
> > opentype/wide characters support.
> 
> I will use tie, i.e. the pdfetex.web generated by the Makefile,
> and copy the comments manually.

pdftex and pdftexdir are gone. :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Tue Jan 17 17:27:39 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue Jan 17 17:27:42 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060117153829.GB5658@lucien.oneiros.kn-bremen.de>
References: <20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<439FE051.7000102@elvenkind.com>
	<20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl> <43CBD1E7.8030304@elvenkind.com>
	<20060116181357.GC25752@lucien.oneiros.kn-bremen.de>
	<20060117153829.GB5658@lucien.oneiros.kn-bremen.de>
Message-ID: <43CD1AFB.1010702@wxs.nl>

Martin ? wrote:

>On 2006-01-16 19:13:57 +0100, Martin Schr?der wrote:
>  
>
>>>yes, please. We probably want/have to modify the etex stuff for
>>>opentype/wide characters support.
>>>      
>>>
>>I will use tie, i.e. the pdfetex.web generated by the Makefile,
>>and copy the comments manually.
>>    
>>
>
>pdftex and pdftexdir are gone. :-)
>  
>
congratulations

Hans
From martin at oneiros.de  Tue Jan 17 17:38:48 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jan 17 17:53:24 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CD1AFB.1010702@wxs.nl>
References: <20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl> <43CBD1E7.8030304@elvenkind.com>
	<20060116181357.GC25752@lucien.oneiros.kn-bremen.de>
	<20060117153829.GB5658@lucien.oneiros.kn-bremen.de>
	<43CD1AFB.1010702@wxs.nl>
Message-ID: <20060117163848.GC5658@lucien.oneiros.kn-bremen.de>

On 2006-01-17 17:27:39 +0100, Hans Hagen wrote:
> Martin ??? wrote:
> >pdftex and pdftexdir are gone. :-)
> >
> congratulations

But the name of the project will still be pdfTeX (not pdfeTeX), right?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From oberdiek at uni-freiburg.de  Tue Jan 17 19:08:04 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Tue Jan 17 19:31:03 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060117163848.GC5658@lucien.oneiros.kn-bremen.de>
References: <20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl> <43CBD1E7.8030304@elvenkind.com>
	<20060116181357.GC25752@lucien.oneiros.kn-bremen.de>
	<20060117153829.GB5658@lucien.oneiros.kn-bremen.de>
	<43CD1AFB.1010702@wxs.nl>
	<20060117163848.GC5658@lucien.oneiros.kn-bremen.de>
Message-ID: <20060117180803.GA3228@irwin.vpn.uni-freiburg.de>

On Tue, Jan 17, 2006 at 05:38:48PM +0100, Martin Schr?der wrote:

> On 2006-01-17 17:27:39 +0100, Hans Hagen wrote:
> > Martin ??? wrote:
> > >pdftex and pdftexdir are gone. :-)
> > >
> > congratulations
> 
> But the name of the project will still be pdfTeX (not pdfeTeX), right?

Thus the directory "pdftexdir" would be shorter than pdfetexdir ;-)
Or will we have a directory "pdfluaetexdir"?

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>
-- 
From noreply at sarovar.org  Tue Jan 17 22:52:23 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:01:56 2006
Subject: [NTG-pdftex] [ pdftex-Patches-467 ] new primitive \ifinedef
Message-ID: <E1EyykZ-0004DE-00@sarovar.org>

Patches item #467, was opened at 2006-01-10 05:32
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=467&group_id=106

>Category: Primitives
>Group: v1.40.0
>Status: Closed
>Resolution: Rejected
>Priority: 3
Submitted By: The Thanh Han (hanthethanh)
>Assigned to: The Thanh Han (hanthethanh)
Summary: new primitive \ifinedef

Initial Comment:
This patch (by Morten H?gholm) contains improvement for
the \ifincsname primitive and implements a new similar
primitive \ifinedef. Made against
pdftex-1.40.0-alpha-20060106

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-01-17 22:52

Message:
Logged In: YES 
user_id=421

Needs further discussion.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=467&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:53:30 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:02:51 2006
Subject: [NTG-pdftex] [ pdftex-Patches-386 ] grow obj_tab and dest_names
	arrays dynamically
Message-ID: <E1Eyyle-0004wN-00@sarovar.org>

Patches item #386, was opened at 2005-07-10 20:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106

Category: Memory allocation
Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Hartmut Henkel (hhenkel)
Summary: grow obj_tab and dest_names arrays dynamically

Initial Comment:
experimental patch to grow the obj_tab and dest_names
arrays dynamically; arrays initially have 1000 entries.
This required also update of file avlstuff.c.

Similar to patch-366, which did this already for the
pdf_mem array. Then all (?) pdftex-specific memory
configuration parameters, obj_tab_size,
dest_names_size, and pdf_mem_size in texmf.cnf would be
ignored.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:54:13 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:03:34 2006
Subject: [NTG-pdftex] [ pdftex-Patches-415 ] various extensions and fixes
Message-ID: <E1EyymL-0004wc-00@sarovar.org>

Patches item #415, was opened at 2005-08-19 09:09
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=415&group_id=106

Category: Primitives
Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Martin Schr?der (oneiros)
Summary: various extensions and fixes

Initial Comment:
This is a patch for various experimental extensions:

- \pdfinsertht: return the height of an insert
(requested by Hans); this has
  similar syntax to \pdftexrevision. 

- do not fail when \pdfobj is used with an invalid
object number (requested by Hans)

- snapping: support for grid typesetting -- see
snap.txt for details

- kern before space: allow changing interword glues in
a flexible way and inserting
    a kern before certain characters --  see
kern-before-interword-glue.txt for
    details

The notes in snap.txt and
kern-before-interword-glue.txt are from email
correspondence with people interested in; hence these
notes are somewhat
informal, inaccurate or out-of-date.

How to apply:
~~~~~~~~~~~~~
cd /path/to/pdftex-1.30.0-srcdir/src/texk
patch -p1 < /path/to/pdftex-20050818.patch
cd web2c
make pdfetex


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-09-04 18:22

Message:
Logged In: YES 
user_id=421

The patch for invalid object numbers is included in 1.30.1++

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=415&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:54:51 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:04:29 2006
Subject: [NTG-pdftex] [ pdftex-Patches-416 ] new primitive pdflastlink
Message-ID: <E1Eyymx-0004wz-00@sarovar.org>

Patches item #416, was opened at 2005-08-19 09:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=416&group_id=106

Category: Primitives
Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Ralf Utermann (ralfu)
>Assigned to: Hartmut Henkel (hhenkel)
Summary: new primitive pdflastlink

Initial Comment:
This patch implements a new primitive \pdflastlink
(analogous to \pdflastannot) which returns the object
number of the last object created with \pdfstartlink.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=416&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:55:13 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:04:33 2006
Subject: [NTG-pdftex] [ pdftex-Patches-427 ] Character positioning patch
Message-ID: <E1EyynJ-0004xL-00@sarovar.org>

Patches item #427, was opened at 2005-09-11 12:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=427&group_id=106

Category: Positioning
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Hans Hagen (hagen)
Summary: Character positioning patch

Initial Comment:
Experimental patch increases resolution of /Widths
array by 1 fractional digit, makes corrections of type
")-1(" and ")1(" in the TJ array happen much less
often, particularily for CM fonts. Gives e. g. 1 % PDF
file size shrink for pdfetex web sources compiled into PDF.

Rough patch only, not for production. Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:06

Message:
Logged In: YES 
user_id=929

Patch extended: Now pdf_set_origin has (h, v) parameters,
simplifies pdf_begin_text procedure.

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 00:25

Message:
Logged In: YES 
user_id=929

Removed pdf_first_space_corr variable, as it seems that it
was defunct anyway: There was no pdf_end_string procedure
call (only place where something is done with
pdf_first_space_corr), where afterwards the pdf_h variable
(then modified by pdf_first_space_corr) would actually be
used. E. g. pdf_moveto uses pdf_last_h instead, and after
pdf_end_text there is anyway a pdf_set_origin call.

And pdf_begin_string gets simpler.

Testing welcome!

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-03 01:16

Message:
Logged In: YES 
user_id=929

patch updated: now the TJ array building in procedure
pdf_begin_string is simplified/tidied up.

Testing welcome!

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=427&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:56:44 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:06:04 2006
Subject: [NTG-pdftex] [ pdftex-Patches-432 ] Rules in a PDF qQ group
Message-ID: <E1Eyyom-0004y2-00@sarovar.org>

Patches item #432, was opened at 2005-10-06 21:01
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

Category: Positioning
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Hans Hagen (hagen)
Summary: Rules in a PDF qQ group

Initial Comment:
Put rules with their positioning on the page inside a
qQ group. Should make \pdfliteral page {...} behave
consistently after text or rules or images, as then any
positioning starts from the PDF origin; no
delta-positioning anymore. It's already being tested in
pdfluatex. Just to have it at sarovar...

Testing welcome, particularily with text and graphics
transforms by graphicx package, to spot backward
incompatibilities, if any...

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:07

Message:
Logged In: YES 
user_id=929

Update pdf_set_origin_temp: Now has (h, v) parameters.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:57:07 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:06:27 2006
Subject: [NTG-pdftex] [ pdftex-Patches-434 ] Remove queued map item handling
Message-ID: <E1Eyyp9-0004yI-00@sarovar.org>

Patches item #434, was opened at 2005-10-13 01:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=434&group_id=106

Category: Fonts
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Taco Hoekwater (taco)
Summary: Remove queued map item handling

Initial Comment:
Remove queued map item handling from mapfile.c
==============================================

Formerly all items from \pdfmapfile{+-=mapfile} or
\pdfmapline{+-=mapline} were queued up in a list until
the next font was selected; then the whole list was
processed, e. g. all queued mapfiles or maplines read in.

When one gave \pdfmapfile{mapfile} or
\pdfmapline{mapline} without +-=, the pending list was
cleared. The only practical use for this was to prevent
reading in the default mapfile. But this can be done
simpler, without queuing.

With this patch all \pdfmapfile{+-=mapfile} or
\pdfmapline{+-=mapline} requests are processed
completely and immediately without queuing, which means
that if e. g. a \pdfmapfile{+-=mapfile} primitive is
scanned, the mapfile will be read in right away. This
happens independently from selecting a font.

When \pdfmapfile{+-=mapfile} or \pdfmapline{+-=mapline}
is scanned, and there is a default mapfile, it is read
first and then the mapfile. Reading of the default
mapfile can be disabled by \pdfmapfile{} or
\pdfmapline{} or \pdfmapfile{mapfile} or
\pdfmapline{mapline} without +-= as long as the default
mapfile hasn't already been read in.

Latest when the first font is requested, the default
mapfile will be read, if this hasn't already been
disabled by the mentioned primitives. Apart from
possibly reading the default mapfile, there is no other
action when a font is requested, since the
\pdfmapfile{+-=mapfile} or \pdfmapline{+-=mapline}
primitives have already acted right away when they were
called.

The effects of this patch are the following:

* Initial mapfile reading still can be blocked in the
usual way.

* The difficult to describe queuing mechanism has gone,
code gets simpler.

* Mapfile reading happens directly by the primitives.

* Therefore it's possible to use \pdfretval with the
primitives, to check success of the mapfile/line
reading (not yet implemented).

* As the return value is connected to the \pdfmapfile
or \pdfmapline call, one can easier implement other map
setting primitives and give them return values. This
was not possible before, as the queuing was inbetween.

* For any standard use, the patch should be compatible
to the former queuing method.

The mapfile.c is a patched version of the mapfile.c
from Thanh's subfont patch pdftex-20050924.patch.gz for
pdftex-1.30.3.

Hope it doesn't sound too messy :-) For discussion.

Regards, Hartmut



----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=434&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:57:45 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:07:06 2006
Subject: [NTG-pdftex] [ pdftex-Patches-443 ] 512 zeros in Type1 fonts not
	copied anymore
Message-ID: <E1Eyypl-0004yn-00@sarovar.org>

Patches item #443, was opened at 2005-10-24 22:41
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=443&group_id=106

Category: Fonts
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Martin Schr?der (oneiros)
Summary: 512 zeros in Type1 fonts not copied anymore

Initial Comment:
When embedding Type1 fonts in PDF files, it is not
needed to copy the trailing 512 zeros; they are
redundant. This has been suggested in the paper "Two
Diet Plans for Fat PDF" by Thomas A. Phelps and Robert
Wilensky. Reduces file size a little. Then /Length3 =
0, see Table 5.24 in the PDF Ref. v. 1.6. The tiny
patch to writet1.c does this for pdfTeX. No change in
the dvips portion.

In the patch also the font matrix transform is
streamlined by use of generic transform macros.

Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=443&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:58:01 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:07:27 2006
Subject: [NTG-pdftex] [ pdftex-Patches-447 ] Don't write /Encoding for
	non-reencoded fonts
Message-ID: <E1Eyyq1-0004yu-00@sarovar.org>

Patches item #447, was opened at 2005-11-06 12:26
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=447&group_id=106

Category: Fonts
Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Taco Hoekwater (taco)
Summary: Don't write /Encoding for non-reencoded fonts

Initial Comment:
The /Encoding entry in the /Font dictionary is only
needed when the font is actually reencoded, see the PDF
Ref. v. 1.6, section 5.5.5.

Currently also for non-reencoded Type1 fonts the
/Encoding entry and its /Encoding object with the
/Differences array are generated from the /Encoding in
the font, duplicating it unnecessarily. This happens
particularily with the many CM fonts.

By the tiny patch to writefont.c this /Encoding entry
and the array object will not be generated and written
any more for non-reencoded Type1 fonts. The PDF reader
application will then take the /Encoding from the
embedded font file.

Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=447&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:58:15 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:07:31 2006
Subject: [NTG-pdftex] [ pdftex-Patches-453 ] Object Streams for PDF-1.5
Message-ID: <E1EyyqF-0004z1-00@sarovar.org>

Patches item #453, was opened at 2005-11-26 18:05
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=453&group_id=106

Category: Object Streams
Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: Martin Schr?der (oneiros)
Summary: Object Streams for PDF-1.5

Initial Comment:
Rough early patch, work in progress, produces PDF-1.5
object streams and cross reference streams. With the
patch, and enabled by \pdfminorversion=5, and with
luck, pdfetex produces e. g. from its WEB source a PDF
file with size 5.97 MByte instead of 11.2 MByte without
object streams.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2006-01-07 01:06

Message:
Logged In: YES 
user_id=929

objstream.ch updated: 1. object stream statistics added. 2.
maximum allocation values are added in brackets. Example:

PDF statistics:
 630 PDF objects out of 1000 (max. 8388607)
 577 compressed objects within 6 object streams
 113 named destinations out of 1000 (max. 131072)
 8353 words of extra memory for PDF output out of 10000
(max. 10000000)

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-12-26 20:21

Message:
Logged In: YES 
user_id=929

Patch update. Object stream writing is now controlled by
primitive \pdfobjcompresslevel = 0...3 (/pdfobjectstreams
primitive removed). 0 = no object streams at all, 1 =
compress objects excluding the ones from embedded PDF files
(for handling of problematic PDF files) and /Info dictionary
(for legibility), 2 = also compress objects from embedded
PDF files, but leave /Info uncompressed, 3 = compress
everything.

Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=453&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:58:32 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:07:48 2006
Subject: [NTG-pdftex] [ pdftex-Patches-462 ] HZ font expansion by text
	matrix manipulation
Message-ID: <E1EyyqW-0004zE-00@sarovar.org>

Patches item #462, was opened at 2005-12-23 23:35
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

Category: Positioning
Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
>Assigned to: The Thanh Han (hanthethanh)
Summary: HZ font expansion by text matrix manipulation

Initial Comment:
Use textmatrix Tm instead of /FontMatrix for font
expansion. Then a font file will be embedded only once
for all expansion factors. Gives smaller PDF files.
Works then also for non-embedded fonts. TrueType not
tried yet. Rough patch only, incomplete, work in
progress, no warranty, not for production.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:58:46 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:08:01 2006
Subject: [NTG-pdftex] [ pdftex-Patches-466 ] \primitive and \ifprimitive
Message-ID: <E1Eyyqk-0004zP-00@sarovar.org>

Patches item #466, was opened at 2006-01-07 17:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

Category: Primitives
Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 4
Submitted By: Taco Hoekwater (taco)
Assigned to: Martin Schr?der (oneiros)
Summary: \primitive and \ifprimitive

Initial Comment:
This patch implements two new primitives:

  \primitive \par

This will run the 'primitive' command \par, even if it 
has been re- or undefined in the meantime. \primitive
is not expandable, because it may be asked to execute
unexpandable primitives as well as expandable ones.

If you supply a nonexistant primitive, it will be 
ignored (no error is raised).

The second primitive is a new type of \if:

  \ifprimitive \par ... \else .. \fi

returns true if the current meaning of \par is the
'primitive' command \par.


The patch is against alpha-20051226, i hope that is not 
too old (?). I expect to do at least one minor update 
during the beta cycle, after the pdftex code is 
flattened. It was quite a struggle to make this 
change file work ok, and as a result, there are 
a few ugly web hacks.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106
From noreply at sarovar.org  Tue Jan 17 22:59:20 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:08:56 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1EyyrI-0004zZ-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

>Category: Primitives
Group: None
Status: Open
>Resolution: Postponed
Priority: 5
Submitted By: Morten H?gholm (morten)
>Assigned to: The Thanh Han (hanthethanh)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-16 21:23

Message:
Logged In: YES 
user_id=3333

@None: An \ifalignscanning primitive can also help macros like LaTeX's 
\multicolumn and other code that relies on seeing \noalign or \omit to 
recover gracefully with a comprehensible error message.

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-13 05:50

Message:
Logged In: YES 
user_id=3333

Yes, just ideas here, which is why I asked for comments. We can discuss 
this on the list (once my subscription is accepted).

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 11:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 10:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 09:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From martin at oneiros.de  Tue Jan 17 23:05:25 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue Jan 17 23:09:45 2006
Subject: [NTG-pdftex] 1.40.0-beta-20060117
Message-ID: <20060117220525.GA10713@lucien.oneiros.kn-bremen.de>

http://sarovar.org/download.php/898/pdftex-1.40.0-beta-20060117.tar.bz2

- pdfTeX is now pdfeTeX, i.e. there is no way to make a binary without eTeX
  support. Also the sources of TeX, eTeX and pdfTeX have been merged into one
  file pdfetex.web
- strip trailing zeros in fractions of reals written
- removed patch 467 \ifindef
- improved logging of objstreams

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de
From noreply at sarovar.org  Tue Jan 17 23:22:53 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Tue Jan 17 23:32:25 2006
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1EyzE5-0006kD-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 01:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: Primitives
Group: None
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: The Thanh Han (hanthethanh)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

>Comment By: Hans Hagen (hagen)
Date: 2006-01-17 22:22

Message:
Logged In: YES 
user_id=927

concerning alignments: 

- how about adding \everyaligncell (in addition to \everycr) 

- how about the other iftests? 

- (and \nospan -) 

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-16 20:23

Message:
Logged In: YES 
user_id=3333

@None: An \ifalignscanning primitive can also help macros like LaTeX's 
\multicolumn and other code that relies on seeing \noalign or \omit to 
recover gracefully with a comprehensible error message.

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-13 04:50

Message:
Logged In: YES 
user_id=3333

Yes, just ideas here, which is why I asked for comments. We can discuss 
this on the list (once my subscription is accepted).

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 10:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 09:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 08:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106
From pragma at wxs.nl  Tue Jan 17 23:52:14 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue Jan 17 23:52:16 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060117163848.GC5658@lucien.oneiros.kn-bremen.de>
References: <20051214124042.GC1480@lucien.oneiros.kn-bremen.de>
	<20060116014358.GC15364@lucien.oneiros.kn-bremen.de>
	<43CB805C.2070607@wxs.nl> <43CB84E3.9040006@elvenkind.com>
	<20060116163014.GA25752@lucien.oneiros.kn-bremen.de>
	<43CBD03A.9010106@wxs.nl> <43CBD1E7.8030304@elvenkind.com>
	<20060116181357.GC25752@lucien.oneiros.kn-bremen.de>
	<20060117153829.GB5658@lucien.oneiros.kn-bremen.de>
	<43CD1AFB.1010702@wxs.nl>
	<20060117163848.GC5658@lucien.oneiros.kn-bremen.de>
Message-ID: <43CD751E.5090805@wxs.nl>

Martin ? wrote:

>On 2006-01-17 17:27:39 +0100, Hans Hagen wrote:
>  
>
>>Martin ??? wrote:
>>    
>>
>>>pdftex and pdftexdir are gone. :-)
>>>
>>>      
>>>
>>congratulations
>>    
>>
>
>But the name of the project will still be pdfTeX (not pdfeTeX), right?
>  
>
indeed, let's stay with the historic name (of course it's up to thanh to 
make the final decission on that);

for a while i wondered if calling the binary pdftex would make sense, 
but then we need to adapt  too many manuals, tools, etc;

Hans
From noreply at sarovar.org  Tue Jan 17 22:57:27 2006
From: noreply at sarovar.org (noreply@sarovar.org)
Date: Wed Jan 18 00:08:22 2006
Subject: [NTG-pdftex] [ pdftex-Patches-438 ] \pdfsavepos in DVI mode
Message-ID: <E1EyypT-0004ye-00@sarovar.org>

Patches item #438, was opened at 2005-10-16 23:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

Category: Positioning
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
>Assigned to: Hartmut Henkel (hhenkel)
Summary: \pdfsavepos in DVI mode

Initial Comment:
\pdfsavepos in DVI mode

Hello,

using \pdfsavepos in a package of mine (tabularht)
I was wondering, why \pdfsavepos is not allowed to
work in DVI mode. \pdfsavepos in PDF mode is based
on cur_h and cur_v, both coming from the DVI frontend.

The only difference I found is that the PDF format
and pdfTeX's PDF mode know about page dimensions.
Thus the directions of the axes are the same for
the PDF format and the values of \pdfsavepos
(\pdflastxpos, \pdflastypos).
  Origin:          lower left corner
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

The DVI case doesn't know about page dimensions, thus
I suggest using cur_h=0 and cur_v=0 as origin. It is
the left upper corner of the box that is being shipped
out.
  Origin:          left upper corner of the box
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

Thus the absolute values differ in both modes and I
don't see that this can be avoided. However, if the
application uses a reference point then the relative
values are exactly the same.

The attachted patch enables and implements \pdfsavepos
for the DVI mode. It also contains the patch for
bug 437 (Two \immediate cancel themselves).

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>


----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-10-17 13:39

Message:
Logged In: YES 
user_id=1276

Hello,

I have now extended the patch: \pdfpagewidth/height
are now used for the page dimensions. Also the
funny DVI origin offset of 1in is taken into
account. Thus the values in DVI and PDF mode are
the same. The exception is \pdf{h,v}origin. If
the value is not 1in, then the values differ in
DVI and PDF mode. However, also the DVI and PDF
output will differ in this case. Thus the different
values are then ok, I think.
  If someone wants to have the same values, he just
sets \pdfpage{width,height} and let \pdf{h,v}origin
untouched.

Hartmut Henkel wrote:
> to give page dimension info for pdftex also in
> DVI mode, one could implement the standard
> \special{papersize=x,y} also in pdftex (parallel
> to \pdfpagewidth/height), so that it would be
> scanned, and also go into the DVI file. Would
> this help?

I think, not really:
* Scanning of \specials are done in PDF mode already,
  but here it is not really necessary, the current
  drivers know about \pdfpage{width,height}.
* In DVI mode, the scanning of \special's contents
  must then be added to set \pdfpage{width,height}.
  But who needs this actually?
  * Relative positioning with \pdfsavepos works
    with or without the correct page size
    information.
  * Absolute positioning is more difficult in use
    (If you are somewhere in a box, how do you
    want to apply absolute positions?)
  * If someone insist on absolute positioning,
    he will probably not rely on an accidentally
    issued \special{papersize=...}. He will probably
    make sure, that the papersize information
    is set and then he can also set
    \pdfpage{width,height}.

Yours sincerely
  Heiko <oberdiek@uni-freiburg.de>

PS: The name of the patch file is now
    "v2-pdftex.ch.diff". And I have removed
    the patch of fixed bug 437.


----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-17 00:16

Message:
Logged In: YES 
user_id=929

to give page dimension info for pdftex also in DVI mode, one
could implement the standard \special{papersize=x,y} also in
pdftex (parallel to \pdfpagewidth/height), so that it would
be scanned, and also go into the DVI file. Would this help?

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106
From morten.hoegholm at latex-project.org  Wed Jan 18 02:20:39 2006
From: morten.hoegholm at latex-project.org (=?iso-8859-1?Q?Morten_H=F8gholm?=)
Date: Wed Jan 18 02:20:41 2006
Subject: [NTG-pdftex] 1.40.0-beta-20060117
In-Reply-To: <20060117220525.GA10713@lucien.oneiros.kn-bremen.de>
References: <20060117220525.GA10713@lucien.oneiros.kn-bremen.de>
Message-ID: <op.s3jvcpkpss64je@mortens-ibook.local>

On Tue, 17 Jan 2006 23:05:25 +0100, Martin Schr?der <martin@oneiros.de>  
wrote:

> http://sarovar.org/download.php/898/pdftex-1.40.0-beta-20060117.tar.bz2
>
> - pdfTeX is now pdfeTeX, i.e. there is no way to make a binary without  
> eTeX
>   support. Also the sources of TeX, eTeX and pdfTeX have been merged  
> into one
>   file pdfetex.web
> - strip trailing zeros in fractions of reals written
> - removed patch 467 \ifindef
> - improved logging of objstreams

I get a few warnings when compiling on OS X 10.4.4 (gcc v4.0.0). Don't  
know if they matter but here they are:

Mortens-Ibook:~/Desktop/tests/pdftex-1.40.0-beta-20060117  
mortenhoegholm$ sudo sh build.sh > /dev/null
Password:
cat: ../../../src/texk/web2c/window/Makefile.in: No such file or directory
conflicts:  1 shift/reduce
pdfetexini.c: In function 'storefmtfile':
pdfetexini.c:3371: warning: pointer targets in passing argument 1 of  
'strcpy' differ in signedness
pdfetexini.c: In function 'loadfmtfile':
pdfetexini.c:3688: warning: pointer targets in passing argument 2 of  
'strcmp' differ in signedness
pdfetexini.c:4279: warning: comparison is always false due to limited  
range of data type
pdfetexextra.c: In function 'ipcpage':
pdfetexextra.c:560: warning: pointer targets in passing argument 2 of  
'strncpy' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c: In function 'escapestring':
../../../../src/texk/web2c/pdfetexdir/utils.c:526: warning: pointer  
targets in passing argument 1 of 'sprintf' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c: In function 'escapename':
../../../../src/texk/web2c/pdfetexdir/utils.c:602: warning: pointer  
targets in passing argument 1 of 'sprintf' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c:627: warning: pointer  
targets in passing argument 1 of 'sprintf' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c: In function 'escapehex':
../../../../src/texk/web2c/pdfetexdir/utils.c:663: warning: pointer  
targets in passing argument 1 of 'sprintf' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c: In function 'getfiledump':
../../../../src/texk/web2c/pdfetexdir/utils.c:1114: warning: pointer  
targets in passing argument 1 of 'sprintf' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c: In function 'getmatch':
../../../../src/texk/web2c/pdfetexdir/utils.c:1195: warning: pointer  
targets in passing argument 1 of 'sprintf' differ in signedness
../../../../src/texk/web2c/pdfetexdir/utils.c:1196: warning: pointer  
targets in passing argument 1 of 'strlen' differ in signedness


-- 
Morten
From staw at gust.org.pl  Wed Jan 18 00:48:26 2006
From: staw at gust.org.pl (Staszek Wawrykiewicz)
Date: Wed Jan 18 02:52:21 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CD751E.5090805@wxs.nl>
Message-ID: <Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>

On Tue, 17 Jan 2006, Hans Hagen wrote:

> >But the name of the project will still be pdfTeX (not pdfeTeX), right?

Good decission.

> indeed, let's stay with the historic name (of course it's up to thanh to 
> make the final decission on that);

Sure. Thanh, would you please say the final agreement that pdftex means
from now "pdftex with all etex extensions"? (no more pdfetex)

> for a while i wondered if calling the binary pdftex would make sense, 
> but then we need to adapt  too many manuals, tools, etc;

Hans, thanks for pointing that. It just means that we have to change
at least fmtutil.cnf and make some cosmetic changes is some 
documentation. I vote for doing that. It is much more easy
to explain (especially for the newbees) that pdftex is just an extension
which incorporates also all etex things.

-- 
Staszek Wawrykiewicz
StaW@gust.org.pl


From martin at oneiros.de  Wed Jan 18 03:28:40 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jan 18 09:33:58 2006
Subject: [NTG-pdftex] 1.40.0-beta-20060117
In-Reply-To: <op.s3jvcpkpss64je@mortens-ibook.local>
References: <20060117220525.GA10713@lucien.oneiros.kn-bremen.de>
	<op.s3jvcpkpss64je@mortens-ibook.local>
Message-ID: <20060118022840.GC10713@lucien.oneiros.kn-bremen.de>

On 2006-01-18 02:20:39 +0100, Morten H?gholm wrote:
> I get a few warnings when compiling on OS X 10.4.4 (gcc v4.0.0). Don't  

[...]

> ../../../../src/texk/web2c/pdfetexdir/utils.c:526: warning: pointer  
> targets in passing argument 1 of 'sprintf' differ in signedness

Why isn't it using snprintf? Surely gcc 4.0 is C99 conformant?

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Wed Jan 18 12:22:44 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jan 18 12:22:47 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>
References: <Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>
Message-ID: <43CE2504.3030607@wxs.nl>

Staszek Wawrykiewicz wrote:

>Hans, thanks for pointing that. It just means that we have to change
>at least fmtutil.cnf and make some cosmetic changes is some 
>documentation. I vote for doing that. It is much more easy
>to explain (especially for the newbees) that pdftex is just an extension
>which incorporates also all etex things.
>  
>
indeed, as well as other extensions (not part of etex)

Hans

From martin at oneiros.de  Wed Jan 18 12:41:40 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed Jan 18 15:32:43 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>
References: <43CD751E.5090805@wxs.nl>
	<Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>
Message-ID: <20060118114140.GB17154@lucien.oneiros.kn-bremen.de>

On 2006-01-18 00:48:26 +0100, Staszek Wawrykiewicz wrote:
> On Tue, 17 Jan 2006, Hans Hagen wrote:
> > for a while i wondered if calling the binary pdftex would make sense, 
> > but then we need to adapt  too many manuals, tools, etc;
> 
> Hans, thanks for pointing that. It just means that we have to change
> at least fmtutil.cnf and make some cosmetic changes is some 
> documentation. I vote for doing that. It is much more easy
> to explain (especially for the newbees) that pdftex is just an extension
> which incorporates also all etex things.

So the project is pdfTeX.

And the binary is pdftex (current beta has pdfetex)? Changing the
name of the binary back to pdftex will cause confusion, as now
(teTeX 3/TL2005) the binary used is pdfetex (pdfTeX is just a
symlink to pdfetex, changing the binary back to pdfTeX would need
the reversed link).

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From pragma at wxs.nl  Wed Jan 18 17:06:30 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed Jan 18 17:06:33 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <20060118114140.GB17154@lucien.oneiros.kn-bremen.de>
References: <43CD751E.5090805@wxs.nl>
	<Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>
	<20060118114140.GB17154@lucien.oneiros.kn-bremen.de>
Message-ID: <43CE6786.6070409@wxs.nl>

Martin ? wrote:

>On 2006-01-18 00:48:26 +0100, Staszek Wawrykiewicz wrote:
>  
>
>>On Tue, 17 Jan 2006, Hans Hagen wrote:
>>    
>>
>>>for a while i wondered if calling the binary pdftex would make sense, 
>>>but then we need to adapt  too many manuals, tools, etc;
>>>      
>>>
>>Hans, thanks for pointing that. It just means that we have to change
>>at least fmtutil.cnf and make some cosmetic changes is some 
>>documentation. I vote for doing that. It is much more easy
>>to explain (especially for the newbees) that pdftex is just an extension
>>which incorporates also all etex things.
>>    
>>
>
>So the project is pdfTeX.
>
>And the binary is pdftex (current beta has pdfetex)? Changing the
>name of the binary back to pdftex will cause confusion, as now
>(teTeX 3/TL2005) the binary used is pdfetex (pdfTeX is just a
>symlink to pdfetex, changing the binary back to pdfTeX would need
>the reversed link).
>  
>
for one or two years we can ship two binaries, pdftex and pdfetex which 
are just copies, otherwise we get problems on platforms without 
symlinks, so

- compile pdftex
- copy it to pdfetex

Hans
From morten.hoegholm at latex-project.org  Wed Jan 18 22:22:56 2006
From: morten.hoegholm at latex-project.org (=?iso-8859-1?Q?Morten_H=F8gholm?=)
Date: Wed Jan 18 22:22:57 2006
Subject: [NTG-pdftex] 1.40.0-beta-20060117
In-Reply-To: <20060118022840.GC10713@lucien.oneiros.kn-bremen.de>
References: <20060117220525.GA10713@lucien.oneiros.kn-bremen.de>
	<op.s3jvcpkpss64je@mortens-ibook.local>
	<20060118022840.GC10713@lucien.oneiros.kn-bremen.de>
Message-ID: <op.s3le0iehss64je@mortens-ibook.local>

On Wed, 18 Jan 2006 03:28:40 +0100, Martin Schr?der <martin@oneiros.de>  
wrote:

> Why isn't it using snprintf? Surely gcc 4.0 is C99 conformant?

It should be and at least snprintf is defined in stdio.h.

Anyway, I asked Gerben Weirda since he has compiled pdftex on OS X quite a  
few times. He said:


But they do not look dangerous to me except the
pdfetexini.c:4279: warning: comparison is always false due to limited  
range of data type
but I recall that I may have looked at that earlier and that it was  
harmless as well.


-- 
Morten
From taco at elvenkind.com  Wed Jan 18 22:32:20 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed Jan 18 22:31:17 2006
Subject: [NTG-pdftex] 1.40.0-beta-20060117
In-Reply-To: <op.s3le0iehss64je@mortens-ibook.local>
References: <20060117220525.GA10713@lucien.oneiros.kn-bremen.de>	<op.s3jvcpkpss64je@mortens-ibook.local>	<20060118022840.GC10713@lucien.oneiros.kn-bremen.de>
	<op.s3le0iehss64je@mortens-ibook.local>
Message-ID: <43CEB3E4.3020405@elvenkind.com>

Morten H?gholm wrote:
> But they do not look dangerous to me except the
> pdfetexini.c:4279: warning: comparison is always false due to limited  

It is a comparison where a hyf_next[] array item is compared against
max_trie_op, but max_trie_op is maxed out, so the actual value can never
be larger.

The warning is harmless, it is this line in web2c's tex.ch:

   undump_upper_check_things(max_trie_op, hyf_next[1], j);

and that could be replaced by

   undump_things(hyf_next[1], j);



Cheers, taco
From hanthethanh at gmail.com  Sat Jan 21 04:48:01 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Sat Jan 21 04:48:06 2006
Subject: [NTG-pdftex] Flattening the web files
Message-ID: <74f506dc0601201948k26757149of234b3721da59284@mail.gmail.com>

On Wed, Jan 18, 2006 at 12:48:26AM +0100, Staszek Wawrykiewicz wrote:
> On Tue, 17 Jan 2006, Hans Hagen wrote:
>
> > >But the name of the project will still be pdfTeX (not pdfeTeX), right?
>
> Good decission.
>
> > indeed, let's stay with the historic name (of course it's up to thanh to
> > make the final decission on that);
>
> Sure. Thanh, would you please say the final agreement that pdftex means
> from now "pdftex with all etex extensions"? (no more pdfetex)

yes I agree (sorry for the delay :). So pdftex now is
"pdftex + etex + further extensions made or accepted by
pdftex team".

Regards,
Thanh
From martin at oneiros.de  Sat Jan 21 03:06:19 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sat Jan 21 09:30:17 2006
Subject: [NTG-pdftex] Flattening the web files
In-Reply-To: <43CE6786.6070409@wxs.nl>
References: <43CD751E.5090805@wxs.nl>
	<Pine.LNX.4.44.0601172356130.1416-100000@re86.internetdsl.tpnet.pl>
	<20060118114140.GB17154@lucien.oneiros.kn-bremen.de>
	<43CE6786.6070409@wxs.nl>
Message-ID: <20060121020619.GD17027@lucien.oneiros.kn-bremen.de>

On 2006-01-18 17:06:30 +0100, Hans Hagen wrote:
> Martin ??? wrote:
> >So the project is pdfTeX.
> >
> >And the binary is pdftex (current beta has pdfetex)? Changing the
> >name of the binary back to pdftex will cause confusion, as now
> >(teTeX 3/TL2005) the binary used is pdfetex (pdfTeX is just a
> >symlink to pdfetex, changing the binary back to pdfTeX would need
> >the reversed link).
> > 
> for one or two years we can ship two binaries, pdftex and pdfetex which 
> are just copies, otherwise we get problems on platforms without 
> symlinks, so
> 
> - compile pdftex
> - copy it to pdfetex

Yes. And I want to keep pdftexdir and drop pdfetexdir. pdftex is
what we say it is (even when it will really be pdfealephluatex).

Best
    Martin
-- 
                    http://www.tm.oneiros.de
From martin at oneiros.de  Tue Jan 24 23:08:59 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue, 24 Jan 2006 23:08:59 +0100
Subject: [NTG-pdftex] pdftex and xpdf
In-Reply-To: <87mzskmgdo.fsf@alhambra.kuesterei.ch>
References: <87k6npuyvt.fsf@alhambra.kuesterei.ch>
	<20050330125059.GS5823@blau.artcom-gmbh.de>
	<87mzskmgdo.fsf@alhambra.kuesterei.ch>
Message-ID: <20060124220859.GA30994@lucien.oneiros.kn-bremen.de>

On 2005-03-31 09:19:47 +0200, Frank K?ster wrote:
> I have not yet looked at poppler (there's a Debian package in NEW, have
> asked the uploader whether he can give me the packages), so I do not
> know if they excluded the parsing part or just don't care much about
> it. 

In the meantime they have; see 
    http://bugs.debian.org/252104
    http://people.debian.org/~frank/patch-poppler
    http://lists.freedesktop.org/archives/poppler/2006-January/001519.html

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From martin at oneiros.de  Wed Jan 25 00:11:16 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 25 Jan 2006 00:11:16 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
Message-ID: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>

http://sarovar.org/download.php/902/pdftex-1.40.0-beta-20060124.tar.bz2

- pdfTeX now includes pdfeTeX, i.e. there is no way to make a binary without
  eTeX support. Also the sources of TeX, eTeX and pdfTeX have been merged into
  one file pdftex.web
- most pdfTeX change files are gone; only one file (pdftex.ch) remains.
- improved patches:
  - 393 Ensure newline before endstream

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de

From taco at elvenkind.com  Wed Jan 25 10:22:14 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 25 Jan 2006 10:22:14 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
In-Reply-To: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
References: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
Message-ID: <43D74346.2000200@elvenkind.com>


Hi,

Perhaps I am being an idiot again and have copied something wrongly,
but I cannot get this one to run. pdf{e,}tex tries to read tex.pool
instead of pdfetex.pool (and then balks).

Martin Schr?der wrote:
> http://sarovar.org/download.php/902/pdftex-1.40.0-beta-20060124.tar.bz2
> 
> - pdfTeX now includes pdfeTeX, i.e. there is no way to make a binary without
>   eTeX support. Also the sources of TeX, eTeX and pdfTeX have been merged into
>   one file pdftex.web
> - most pdfTeX change files are gone; only one file (pdftex.ch) remains.
> - improved patches:
>   - 393 Ensure newline before endstream
> 
> Have fun
>     Martin

From martin at oneiros.de  Wed Jan 25 13:02:21 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 25 Jan 2006 13:02:21 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
In-Reply-To: <43D74346.2000200@elvenkind.com>
References: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
	<43D74346.2000200@elvenkind.com>
Message-ID: <20060125120221.GC5280@lucien.oneiros.kn-bremen.de>

On 2006-01-25 10:22:14 +0100, Taco Hoekwater wrote:
> Perhaps I am being an idiot again and have copied something wrongly,
> but I cannot get this one to run. pdf{e,}tex tries to read tex.pool
> instead of pdfetex.pool (and then balks).

Taco,
of course you are not an idiot -- I am. I didn't test it. :-(

Here's the patch:
diff -dur /home/ms/tex/pdftex/releases/pdftex-1.40.0-beta-20060124/src/texk/web2c/texmfmp.h ./texmfmp.h
--- /home/ms/tex/pdftex/releases/pdftex-1.40.0-beta-20060124/src/texk/web2c/texmfmp.h   Tue Jan 17 16:30:23 2006
+++ ./texmfmp.h Wed Jan 25 12:57:11 2006
@@ -28,9 +28,9 @@
 
 /* Some things are the same except for the name.  */
 #ifdef TeX
-#if defined (pdfeTeX)
-#define TEXMFPOOLNAME "pdfetex.pool"
-#define TEXMFENGINENAME "pdfetex"
+#if defined (pdfTeX)
+#define TEXMFPOOLNAME "pdftex.pool"
+#define TEXMFENGINENAME "pdftex"
 #elif defined (eTeX)
 #define TEXMFPOOLNAME "etex.pool"
 #define TEXMFENGINENAME "etex"

I'll upload a new beta.

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From oberdiek at uni-freiburg.de  Wed Jan 25 13:44:48 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed, 25 Jan 2006 13:44:48 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
In-Reply-To: <43D74346.2000200@elvenkind.com>
References: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
	<43D74346.2000200@elvenkind.com>
Message-ID: <20060125124447.GA11743@irwin.vpn.uni-freiburg.de>

On Wed, Jan 25, 2006 at 10:22:14AM +0100, Taco Hoekwater wrote:

> Perhaps I am being an idiot again and have copied something wrongly,
> but I cannot get this one to run. pdf{e,}tex tries to read tex.pool
> instead of pdfetex.pool (and then balks).

src/texk/web2c/texmfmp.h looks suspicious:

| #if defined (pdfeTeX)
| #define TEXMFPOOLNAME "pdfetex.pool"
| #define TEXMFENGINENAME "pdfetex"
| #elif defined (eTeX)
| #define TEXMFPOOLNAME "etex.pool"
| #define TEXMFENGINENAME "etex"
| #elif defined (Omega)
| #define TEXMFPOOLNAME "omega.pool"
| #define TEXMFENGINENAME "omega"
| #elif defined (eOmega)
| #define TEXMFPOOLNAME "eomega.pool"
| #define TEXMFENGINENAME "eomega"
| #elif defined (Aleph)
| #define TEXMFPOOLNAME "aleph.pool"
| #define TEXMFENGINENAME "aleph"
| #else
| #define TEXMFPOOLNAME "tex.pool"
| #define TEXMFENGINENAME "tex"
| #endif

Perhaps "pdfeTeX" is not defined and tex.pool is choosen then.
Also the name of the pool file should be "pdftex.pool" and
"pdftex" for the engine?

> Martin Schr?der wrote:
> > http://sarovar.org/download.php/902/pdftex-1.40.0-beta-20060124.tar.bz2
> > 
> > - pdfTeX now includes pdfeTeX, i.e. there is no way to make a binary without
> >   eTeX support. Also the sources of TeX, eTeX and pdfTeX have been merged into
> >   one file pdftex.web
> [...]

Also Makefile.in contains both engines pdftex and pdfetex and
references to pdfetexdir, ...

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From taco at elvenkind.com  Wed Jan 25 14:06:50 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 25 Jan 2006 14:06:50 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
In-Reply-To: <20060125120221.GC5280@lucien.oneiros.kn-bremen.de>
References: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>	<43D74346.2000200@elvenkind.com>
	<20060125120221.GC5280@lucien.oneiros.kn-bremen.de>
Message-ID: <43D777EA.6030009@elvenkind.com>



Martin Schr?der wrote:
> 
> 
> Taco,
> of course you are not an idiot -- I am. I didn't test it. :-(

I've cried wolf before ;-)

Patch works fine (of course). I like the new 'lean and mean' change
file setup a lot, thanks.

Cheers, taco

From martin at oneiros.de  Wed Jan 25 13:28:24 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 25 Jan 2006 13:28:24 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060125
Message-ID: <20060125122824.GD5280@lucien.oneiros.kn-bremen.de>

http://sarovar.org/download.php/903/pdftex-1.40.0-beta-20060125.tar.bz2

[this is the same as 1.40.0-beta-20060124, but it works]

- pdfTeX now includes pdfeTeX, i.e. there is no way to make a binary without
  eTeX support. Also the sources of TeX, eTeX and pdfTeX have been merged into
  one file pdftex.web
- most pdfTeX change files are gone; only one file (pdftex.ch) remains.
- improved patches:
  - 393 Ensure newline before endstream

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de

From martin at oneiros.de  Wed Jan 25 14:53:12 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 25 Jan 2006 14:53:12 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
In-Reply-To: <20060125124447.GA11743@irwin.vpn.uni-freiburg.de>
References: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
	<43D74346.2000200@elvenkind.com>
	<20060125124447.GA11743@irwin.vpn.uni-freiburg.de>
Message-ID: <20060125135312.GF5280@lucien.oneiros.kn-bremen.de>

On 2006-01-25 13:44:48 +0100, Heiko Oberdiek wrote:
> Also Makefile.in contains both engines pdftex and pdfetex and
> references to pdfetexdir, ...

pdfetexdir is only in @MAINT at . I dare not touch it.

And yes, you can still build pdfetex. It's a copy of pdftex. :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From w.m.l at gmx.net  Thu Jan 26 13:07:11 2006
From: w.m.l at gmx.net (w.m.l at gmx.net)
Date: Thu, 26 Jan 2006 13:07:11 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060124
In-Reply-To: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
References: <20060124231116.GC30994@lucien.oneiros.kn-bremen.de>
Message-ID: <43D8BB6F.202@gmx.net>

On 25.01.2006 00:11, Martin Schr?der wrote:
> http://sarovar.org/download.php/902/pdftex-1.40.0-beta-20060124.tar.bz2

Could you remove these lines in auto_append_kern:

     breadth_max := 10;
     depth_threshold := 2;
     show_node_list(p);
     print_ln;

Looks like debugging remainders.

Regards,
Robert.


From noreply at sarovar.org  Fri Jan 27 15:20:18 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 27 Jan 2006 19:50:18 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-473 ] \ifabsnum and \ifabsdim
Message-ID: <E1F2USY-0000oT-00@sarovar.org>

Patches item #473, was opened at 2006-01-27 15:20
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=473&group_id=106

Category: Primitives
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Nobody (None)
Summary: \ifabsnum and \ifabsdim

Initial Comment:
Here is a small change file that implements two new
etex primitives :
  \ifabsnum 
  \ifabsdim 
Usage is the same as \ifnum and \ifdim. The only 
difference is that they negate the values if they are
negative before comparing.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=473&group_id=106

From noreply at sarovar.org  Fri Jan 27 15:31:25 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 27 Jan 2006 20:01:25 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-473 ] \ifabsnum and \ifabsdim
Message-ID: <E1F2UdJ-0001cd-00@sarovar.org>

Patches item #473, was opened at 2006-01-27 14:20
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=473&group_id=106

Category: Primitives
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Taco Hoekwater (taco)
Assigned to: Nobody (None)
Summary: \ifabsnum and \ifabsdim

Initial Comment:
Here is a small change file that implements two new
etex primitives :
  \ifabsnum 
  \ifabsdim 
Usage is the same as \ifnum and \ifdim. The only 
difference is that they negate the values if they are
negative before comparing.

----------------------------------------------------------------------

>Comment By: Hans Hagen (hagen)
Date: 2006-01-27 14:31

Message:
Logged In: YES 
user_id=927

intended usage: 

\ifabsdim \dimexpr \maxheight - \currentheight \relax < .5pt 
  assume that we're done 
\fi 

it can also be used to handle rounding errors when doing
roundtrip calculations 


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=473&group_id=106

From oberdiek at uni-freiburg.de  Fri Jan 27 20:09:34 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri, 27 Jan 2006 20:09:34 +0100
Subject: [NTG-pdftex] Possible bug in pdfetexk (re \hoffset)?
In-Reply-To: <43DA63AC.1020706@Rhul.Ac.Uk>
References: <87wtke20up.fsf@vvv.vsu.ru>
	<20051015220724.GA3649@irwin.vpn.uni-freiburg.de>
	<43DA63AC.1020706@Rhul.Ac.Uk>
Message-ID: <20060127190934.GA2980@irwin.vpn.uni-freiburg.de>

On Fri, Jan 27, 2006 at 06:17:16PM +0000, Philip TAYLOR wrote:

> Dear all -- The following preamble produces a correctly
> centered letter using TeX, but PdfTeX appears to offset
> everything by about 1,5 em (see commented-out \advance
> at-end).  A sample document follows.
> 
> Philip Taylor
> --------
> % letter-macros
> 
> \def \from {\leftskip = 0 pt plus 1 fill \parskip = 0 ex \obeylines}
> \def \to {\rightskip = 0 pt plus 1 fill \parskip = 0 ex \obeylines}
> \def \body {}
> \def \blockquote {\vskip \parskip \leftskip = 3 em \rightskip = 0 ex 
> plus 1 fill \parskip = 0 ex \obeylines}
> \def \signature {\vskip 3\parskip}
> 

% pdfTeX also knows \pdfhorigin and \pdfvorigin
% In my teTeX installation the values are set during generating
% the format files in pdftexconfig.tex:
% \pdfhorigin=1 true in
% \pdfvorigin=1 true in
% \showthe\pdfhorigin = 72.26999pt

> \magnification \magstep 1

% Now the values of \pdfhorigin, pdfvorigin need to be
% reassigned, see below

> \parindent = 0 em
> \parskip = 3 ex
> 
> \hsize = 210 true mm
> \vsize = 297 true mm
> 

\input ifpdf.sty
% it sets \ifpdf for detecting pdfTeX in pdf mode

> \begingroup
> \hoffset= 1 true in
> \voffset = 1 true in
> \globaldefs = 1

\ifpdf

\pdfhorigin = 1 true in
\pdfvorigin = 1 true in
% now the value is 60.22462pt (same as \hoffset = 1 true in).

> \pdfpagewidth = \hsize
> \pdfpageheight = \vsize

\fi

> \advance \hsize by -2\hoffset
> \advance \vsize by -2\voffset
> \endgroup

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From martin at oneiros.de  Fri Jan 27 21:47:50 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri, 27 Jan 2006 21:47:50 +0100
Subject: [NTG-pdftex] [tex-k] Re: Possible bug in pdfetexk (re \hoffset)?
In-Reply-To: <20060127190934.GA2980@irwin.vpn.uni-freiburg.de>
References: <87wtke20up.fsf@vvv.vsu.ru>
	<20051015220724.GA3649@irwin.vpn.uni-freiburg.de>
	<43DA63AC.1020706@Rhul.Ac.Uk>
	<20060127190934.GA2980@irwin.vpn.uni-freiburg.de>
Message-ID: <20060127204750.GD3252@lucien.oneiros.kn-bremen.de>

Phil,
please READ http://www.pdftex.org/README

<quote>
WHAT TO DO IF YOU BELIEVE YOU HAVE FOUND A BUG IN pdfTeX
========================================================

Please read http://www.chiark.greenend.org.uk/~sgtatham/bugs.html and
follow the guidelines there. Then go to the sarovar site of pdfTeX
(http://sarovar.org/projects/pdftex/) and submit your bug report there.
Here you can also report feature requests or patches.
</quote>

To report possible bugs in pdfTeX you DON'T cry wolf everywhere.

On 2006-01-27 20:09:34 +0100, Heiko Oberdiek wrote:
> On Fri, Jan 27, 2006 at 06:17:16PM +0000, Philip TAYLOR wrote:
> 
> > Dear all -- The following preamble produces a correctly
> > centered letter using TeX, but PdfTeX appears to offset
> > everything by about 1,5 em (see commented-out \advance
> > at-end).  A sample document follows.
> > 
> 
> % pdfTeX also knows \pdfhorigin and \pdfvorigin
> % In my teTeX installation the values are set during generating
> % the format files in pdftexconfig.tex:

From the pdftex manual (also available from http://www.pdftex.org)
<quote>
- \pdfhorigin (dimension) 
This parameter can be used to set the horizontal offset the
output box from the top left corner of the page. A value of 1
inch corresponds to the normal TeX offset.  This parameter is
read when pdfTeX starts shipping out a page to the pdf output. 

For standard purposes, this parameter should always be kept at 1
true inch. If you want to shift text on the page, use TeX's own
\hoffset primitive. To avoid surprises, after global
magnification has been changed by the \mag primitive, the
\pdfhorigin parameter should still be 1 true inch, e. g. by
typing \pdfhorigin=1 true in after issuing the \mag command. Or,
you can preadjust the \pdfhorigin value before typing \mag, so
that its value after the \mag command ends up at 1 true inch
again. 

- \pdfvorigin (dimension) 
This parameter is the vertical companion of \pdfhorigin, and the
notes above regarding \mag and true dimensions apply. Also keep
in mind that the TeX coordinate system starts in the top left
corner (downward), while pdf coordinates start at the bottom left
corner (upward).
</quote>

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From martin at oneiros.de  Fri Jan 27 23:42:52 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Fri, 27 Jan 2006 23:42:52 +0100
Subject: [NTG-pdftex] [tex-live] Re: Possible bug in pdfetexk (re
	\hoffset)?
In-Reply-To: <Pine.LNX.4.61.0601272135210.16660@gloin.imf.au.dk>
References: <87wtke20up.fsf@vvv.vsu.ru>
	<20051015220724.GA3649@irwin.vpn.uni-freiburg.de>
	<43DA63AC.1020706@Rhul.Ac.Uk>
	<20060127190934.GA2980@irwin.vpn.uni-freiburg.de>
	<Pine.LNX.4.61.0601272135210.16660@gloin.imf.au.dk>
Message-ID: <20060127224252.GE3252@lucien.oneiros.kn-bremen.de>

On 2006-01-27 21:38:02 +0100, Lars Madsen wrote:
> This is actually rather interesting, I had a user who came and complained 
> about this very thing, pdftex producing different margins than TeX.
> 
> When has this changed? I don't use plain TeX or pdfTeX myself so I haven't 
> noticed. The user in question claims that his document worked fine under 
> both systems in TL 2004.

1.20a corrected this. See the thread at
http://www.ntg.nl/pipermail/ntg-pdftex/2004-April/000485.html

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From oberdiek at uni-freiburg.de  Sat Jan 28 22:40:41 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Sat, 28 Jan 2006 22:40:41 +0100
Subject: [NTG-pdftex] Possible bug in pdfetexk (re \hoffset)?
In-Reply-To: <20060127190934.GA2980@irwin.vpn.uni-freiburg.de>
References: <87wtke20up.fsf@vvv.vsu.ru>
	<20051015220724.GA3649@irwin.vpn.uni-freiburg.de>
	<43DA63AC.1020706@Rhul.Ac.Uk>
	<20060127190934.GA2980@irwin.vpn.uni-freiburg.de>
Message-ID: <20060128214040.GA3165@irwin.vpn.uni-freiburg.de>

On Fri, Jan 27, 2006 at 08:09:34PM +0100, Heiko Oberdiek wrote:

> On Fri, Jan 27, 2006 at 06:17:16PM +0000, Philip TAYLOR wrote:
> 
> > Dear all -- The following preamble produces a correctly
> > centered letter using TeX, but PdfTeX appears to offset
> > everything by about 1,5 em (see commented-out \advance
> > at-end).  A sample document follows.

> % pdfTeX also knows \pdfhorigin and \pdfvorigin
> % In my teTeX installation the values are set during generating
> % the format files in pdftexconfig.tex:
> % \pdfhorigin=1 true in
> % \pdfvorigin=1 true in
> % \showthe\pdfhorigin = 72.26999pt
> 
> > \magnification \magstep 1
> 
> % Now the values of \pdfhorigin, pdfvorigin need to be
> % reassigned, see below

> \pdfhorigin = 1 true in
> \pdfvorigin = 1 true in

See also the discussion in the newsgroup comp.text.tex
(pdftex broken in tetex-3: offsets incorrect).

Here I posted some code that can be put into the plain format
for pdfTeX in PDF mode that adds the \pdf{h,v}origin fixing
into the macros of \magnification:

  \expandafter\def\expandafter\m at g\expandafter{%
    \m at g
    \pdfhorigin 1 true in%
    \pdfvorigin 1 true in%
    % Also correction of \pdfpagewidth and \pdfpageheight
    % is a good idea.
  }%

With converting of \pdfpage{width,height} to truept:

  \expandafter\def\expandafter\m at g\expandafter{%
    \m at g
    \pdfhorigin 1truein%
    \pdfvorigin 1truein%
    \mag at fix\pdfpagewidth
    \mag at fix\pdfpageheight
  }
  \def\mag at fix#1{%
    #1=\expandafter\convert at truept\the#1\relax
  }
  \begingroup
    \catcode`P=12
    \catcode`T=12
  \lowercase{%
    \endgroup
    \def\convert at truept#1PT{%
      #1truept%
    }%
  }

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From oberdiek at uni-freiburg.de  Sun Jan 29 11:48:54 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Sun, 29 Jan 2006 11:48:54 +0100
Subject: [NTG-pdftex] [tex-k] Re: Possible bug in pdfetexk (re \hoffset)?
In-Reply-To: <yfik6cjsvy7.fsf_-_@triumf.ca>
References: <87wtke20up.fsf@vvv.vsu.ru>
	<20051015220724.GA3649@irwin.vpn.uni-freiburg.de>
	<43DA63AC.1020706@Rhul.Ac.Uk>
	<20060127190934.GA2980@irwin.vpn.uni-freiburg.de>
	<20060128214040.GA3165@irwin.vpn.uni-freiburg.de>
	<yfik6cjsvy7.fsf_-_@triumf.ca>
Message-ID: <20060129104854.GA8708@irwin.vpn.uni-freiburg.de>

On Sat, Jan 28, 2006 at 04:45:52PM -0800, Donald Arseneau wrote:

> Heiko Oberdiek <oberdiek at uni-freiburg.de> writes:
> 
> > With converting of \pdfpage{width,height} to truept:
> 
> These should all be handled like \hsize and \vsize, where they are set 
> to ordinary scalable units in the format or config files, but set to 
> "true" units in \m at g.  I don't see why you need \mag at fix\pdfpagewidth

My format contains (teTeX) is generated on pdftex.ini:

    \input pdftexconfig\pdfoutput=1
    \input plain
    \dump
    \endinput

pdftexconfig.tex contains:

    \pdfoutput=1
    \pdfcompresslevel=9
    \pdfdecimaldigits=3
    \pdfpagewidth=210 true mm
    \pdfpageheight=297 true mm
    \pdfhorigin=1 true in
    \pdfvorigin=1 true in
    \pdfpkresolution=600
    \pdfminorversion=4
    \endinput

The test file

    \showthe\pdfpagewidth
    \mag\magstep5
    \showthe\pdfpagewidth
    \null
    \end

The result is two times 597.50787pt and the page size of the
media box in the generated pdf file is:
  1481.05 bp x 2094.62 bp
--> much too large.

Regarding \hsize, \vsize: any setting before \magnification
is overwritten by the code of \magnification in plain.tex.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From noreply at sarovar.org  Mon Jan 30 17:53:16 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 30 Jan 2006 22:23:16 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-474 ] Use dynamically linked poppler
	library instead of xpdf code
Message-ID: <E1F3cHE-0000Jn-00@sarovar.org>

Patches item #474, was opened at 2006-01-30 17:53
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Frank K?ster (frank)
Assigned to: Nobody (None)
Summary: Use dynamically linked poppler library instead of xpdf code

Initial Comment:
This has already been applied and tested in Debian and
Ubuntu, but we suggest to apply it upstream.  There are
a few things to do, however, as Martin already pointed
out to me in a private mail.  I paraphrase the main points:

- the pdftex distribution should not ship libpoppler.
Instead it should be possible to switch from xpdf to
libpoppler using autoconf magic, if libpoppler headers
are installed.  This needs some coding work

- We need a common API for xpdf and poppler.  This is
the tricky part, because the very reason for poppler's
existence is that the xpdf developer, Derek Noonburg,
refuses any patches that would lead to a shared
library. As Martin said, "for the beginning, a header
file with a couple of #ifdef'ed definitions should be
enough".

I'm going to subscribe to the pdftex devel list soon,
but am not yet subscribed currently.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

