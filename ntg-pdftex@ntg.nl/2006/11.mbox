From noreply at sarovar.org  Wed Nov  1 18:37:26 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 01 Nov 2006 23:07:26 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GfK1m-0008PL-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 14:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 18:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 18:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 23:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 15:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From noreply at sarovar.org  Wed Nov  1 18:38:20 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 01 Nov 2006 23:08:20 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-484 ] extra kerning inhibits hyphenation
Message-ID: <E1GfK2e-0000Gl-00@sarovar.org>

Bugs item #484, was opened at 2006-02-13 19:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=484&group_id=106

Category: hz
Group: v1.40.0
>Status: Closed
>Resolution: Fixed
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: extra kerning inhibits hyphenation

Initial Comment:
Hyphenation will be inhibited by appended or prepended
kerns: 

\showhyphens{pdftex}
{
 \pdfprependkern=1
 \knbccode\font`e=100
 \showhyphens{pdftex}
}
{
 \pdfappendkern=1
 \knaccode\font`e=100
 \showhyphens{pdftex}
}
\bye


(In a milder mood, I would have filed this as a feature
request, not as a bug report. But I do think that it's
a major drawback, which renders this new extension
useless for a lot of applications.)

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 18:38

Message:
Logged In: YES 
user_id=421

A patch for this will be included in the next version (1.40).

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=484&group_id=106

From noreply at sarovar.org  Wed Nov  1 18:38:47 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 01 Nov 2006 23:08:47 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-606 ] Forbidden ... while scanning ???
Message-ID: <E1GfK35-0000Kn-00@sarovar.org>

Bugs item #606, was opened at 2006-09-16 22:28
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=606&group_id=106

Category: Primitives
Group: v1.40.0
Status: Open
>Resolution: Postponed
Priority: 3
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hartmut Henkel (hhenkel)
Summary: Forbidden ... while scanning ???

Initial Comment:
\pdftrailer {abc
\bye

gives

! Forbidden control sequence found while scanning text
of \pdftrailer.

but

\pdfximage {abc
\bye

or

\pdfliteral {abc
\bye

give

! Forbidden control sequence found while scanning text
of ???.

Instead of these three question marks there should be
the name of the primitive.




----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-09-21 14:22

Message:
Logged In: YES 
user_id=421

I've backed out the change; this is low priority and
probably needs more changes.

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2006-09-17 21:10

Message:
Logged In: YES 
user_id=929

yes, the patch works, thanks a lot! But there are in fact
many more \pdf... primitives that suffer from this problem,
actually any with a scan_keyword call before the
scan_pdf_ext_toks. After the way how it's done in
@<Implement \.{\write}@>=, it seems that a new variable
save_cur_cs is not needed if one uses k for this purpose.
Needs change of a few k uses to j. But problematic is
\pdfoutline as it has another scan_pdf_ext_toks for the attr
keyword.

Wouldn't these many changes be too risky for 1.40.0?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-09-17 18:34

Message:
Logged In: YES 
user_id=421

The patch was missing. Fixed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-09-17 16:30

Message:
Logged In: YES 
user_id=421

The cause seems to be that some scan_functions loose the
meaning of cur_cs, which leads to the ??? when reaching
<Tell the user what has run away...@>.

The attached (IMHO crude) patch fixes this for the cases you
mentioned, but there are probably other cases not found...

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=606&group_id=106

From noreply at sarovar.org  Wed Nov  1 18:39:09 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 01 Nov 2006 23:09:09 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-565 ] ttf2afm fails to include
	characters specified with uniXXXX
Message-ID: <E1GfK3R-0000LI-00@sarovar.org>

Bugs item #565, was opened at 2006-05-29 16:37
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=565&group_id=106

Category: ttf2afm
Group: v1.30.0
>Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Mike Spivey (spivey)
Assigned to: The Thanh Han (hanthethanh)
Summary: ttf2afm fails to include characters specified with uniXXXX

Initial Comment:
If characters are specified in an encoding vector as
uniXXXX (with XXXX a hexadecimal unicode value), then
these characters are not included in the AFM output,
unlike characters that are specified by name.  The same
goes for characters specifed by position.

A suggested patch is attached.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-23 12:51

Message:
Logged In: YES 
user_id=421

A patch for this will be included in the next version (1.40).

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-23 11:00

Message:
Logged In: YES 
user_id=710

the patch looks good to me. Martin, call you include this in
next release?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-07-25 19:46

Message:
Logged In: YES 
user_id=421

Thanh, ttf2afm is your baby. :-) 
Pleae check.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=565&group_id=106

From noreply at sarovar.org  Wed Nov  1 18:39:33 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 01 Nov 2006 23:09:33 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-304 ] Names of expanded fonts not in log
	output
Message-ID: <E1GfK3p-0000LY-00@sarovar.org>

Bugs item #304, was opened at 2005-03-02 18:25
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=304&group_id=106

Category: Fonts
Group: v1.21a
Status: Open
Resolution: Accepted
>Priority: 3
Submitted By: Robert (schlcht)
Assigned to: Hartmut Henkel (hhenkel)
Summary: Names of expanded fonts not in log output

Initial Comment:
When using font expansion, the log output will not
contain the names of the expanded fonts but the null
character instead (resp. ^^@).

%-------------------------------------
\pdfadjustspacing=2
\pdffontexpand\font 20 20 5 autoexpand
\tracingoutput=1
test

\parfillskip 0pt
test
\bye
%-------------------------------------

Regards,
Robert.


----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-23 12:23

Message:
Logged In: YES 
user_id=710

Here is an attempt to fix this problem (reversed patch
attached).

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-09-03 19:30

Message:
Logged In: YES 
user_id=2217

I've attached an example using Kepler MM (tfm+pfb included,
please delete after testing).

MM fonts are probably the only case where one would not want
to use the autoexpand feature.

At first sight, saying "autoexpand" or not doesn't seem to
make a difference, since pdftex will always prefer existing
expanded fonts (pfb) over autoexpanding them, anyway.
However, there are some slight differences in the pdf. This
is probably because the provided tfm file is different from
the metrics that pdf calculates itself in the case of
autoexpand. That is, autoexpand may result in a mismatch
between the provided pfb and the calculated tfm, is that
correct?


----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2006-09-01 21:02

Message:
Logged In: YES 
user_id=929

currently i even can't get a test file do expansion at all
without "autoexpand". E. g. Robert's example above, without
"autoexpand", doesn't use expanded fonts. Maybe that's the
reason for the missing expand parameter in the log? Can
anybody provide a test file for this case?

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-09-01 12:47

Message:
Logged In: YES 
user_id=421

Is this really a problem, i.e. is there a reason _not_ to
use the autoexpand feature in new documents?

Hartmut, did you look into this bug?

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2005-10-16 00:24

Message:
Logged In: YES 
user_id=2217

If the font is not autoexpand'ed, its name will still not be
written to the log file.

(pdftex 1.30.3; same test file, without "autoexpand")

Regards,
Robert.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-12 17:05

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.0

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-03-30 22:16

Message:
Logged In: YES 
user_id=929

This patch is based of Thanh's change file showfont.ch,
which he gave me during EuroTeX2005 (it's also included,
renamed here to showfont-thanh.ch). Use showfont.ch for the
patch.

There is now a new integer variable \pdftracingfonts. It is
zero by default, then we get a log like this (see
robert050302.log):

...\tenrm t

...\tenrm (+20) e

Without font expansion, this default should be compatible
with TeX's original log output.

If \pdftracingfonts is set to 1 (or greater), we get a more
verbose log (see tst-304.log):

...\xivtt (cmtt10 at 14.0pt) t

.\xivtt (cmtt10+20 at 14.0pt) e

Seems to work with change file showfont.ch coming directly
after after hz.ch.

Patch only roughly tested with pdfetex, likely to give
problems with pdfxtex, as the variable numbering might
differ. Log format to be agreed upon...

Regards, Hartmut


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=304&group_id=106

From noreply at sarovar.org  Thu Nov  2 09:44:21 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 02 Nov 2006 14:14:21 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GfYBR-0004HO-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 12:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

>Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-02 08:44

Message:
Logged In: YES 
user_id=710

Thank you Martin for looking at the patch and blessing it. I
was struggling with TeX The Program more than a week before
I came up with this patch and still I am not sure it doesn't
break anything (I didn't claim it fixes bugs #481-484 but
said this is an attempt to fix that).

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 17:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 16:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 21:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 13:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From noreply at sarovar.org  Mon Nov  6 22:36:05 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 07 Nov 2006 03:06:05 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GhC8T-0007lO-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 12:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 21:36

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 21:34

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-02 08:44

Message:
Logged In: YES 
user_id=710

Thank you Martin for looking at the patch and blessing it. I
was struggling with TeX The Program more than a week before
I came up with this patch and still I am not sure it doesn't
break anything (I didn't claim it fixes bugs #481-484 but
said this is an attempt to fix that).

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 17:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 16:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 21:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 13:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From noreply at sarovar.org  Mon Nov  6 22:34:31 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 07 Nov 2006 03:04:31 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GhC6x-0007l5-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 12:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 21:34

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-02 08:44

Message:
Logged In: YES 
user_id=710

Thank you Martin for looking at the patch and blessing it. I
was struggling with TeX The Program more than a week before
I came up with this patch and still I am not sure it doesn't
break anything (I didn't claim it fixes bugs #481-484 but
said this is an attempt to fix that).

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 17:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 16:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 21:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 13:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From noreply at sarovar.org  Mon Nov  6 23:57:56 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 07 Nov 2006 04:27:56 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GhDPg-0006ty-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 14:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
>Status: Open
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-11-06 23:57

Message:
Logged In: YES 
user_id=421

I can't reproduce the crash with the latest version of the
patch.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 22:36

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 22:34

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-02 09:44

Message:
Logged In: YES 
user_id=710

Thank you Martin for looking at the patch and blessing it. I
was struggling with TeX The Program more than a week before
I came up with this patch and still I am not sure it doesn't
break anything (I didn't claim it fixes bugs #481-484 but
said this is an attempt to fix that).

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 18:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 18:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 23:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 15:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From noreply at sarovar.org  Mon Nov  6 23:59:11 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 07 Nov 2006 04:29:11 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GhDQt-0007cd-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 14:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-11-06 23:59

Message:
Logged In: YES 
user_id=421

A more general note: If possible please split continue the
discussion at the affected bugs.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-06 23:57

Message:
Logged In: YES 
user_id=421

I can't reproduce the crash with the latest version of the
patch.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 22:36

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 22:34

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-02 09:44

Message:
Logged In: YES 
user_id=710

Thank you Martin for looking at the patch and blessing it. I
was struggling with TeX The Program more than a week before
I came up with this patch and still I am not sure it doesn't
break anything (I didn't claim it fixes bugs #481-484 but
said this is an attempt to fix that).

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 18:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 18:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 23:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 15:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From kakuto at fsci.fuk.kindai.ac.jp  Tue Nov  7 03:45:32 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Tue, 07 Nov 2006 11:45:32 +0900
Subject: [NTG-pdftex] fix for bugs #481--483
Message-ID: <200611070245.kA72jXle023510@jupiter.fsci.fuk.kindai.ac.jp>

Hi,

> I can't reproduce the crash with the latest version of the
> patch.

On windows 2k, the crash was reproduced for

% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}

Best,
Akira

From kakuto at fsci.fuk.kindai.ac.jp  Wed Nov  8 13:42:31 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Wed, 08 Nov 2006 21:42:31 +0900
Subject: [NTG-pdftex] fix for bugs #481--483
In-Reply-To: Your message of "Tue, 07 Nov 2006 11:45:32 +0900"
References: <200611070245.kA72jXle023510@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <200611081242.kA8CgW0T002825@jupiter.fsci.fuk.kindai.ac.jp>

Hi,

> > I can't reproduce the crash with the latest version of the
> > patch.
> 
> On windows 2k, the crash was reproduced for
> 
> % (5) finally, this document gives a segfault 
> % (ok without the patches):
> \documentclass[10pt,a4paper]{ltxdoc}
> \def\rmdefault{bch}
> \begin{document}
> \begin{multicols}{2}
>  A (\textit{Bcdrea}
> \end{multicols}
> \end{document}

In the case of the second latest patch
(i.e., pdftex-20061021.patch in fix-autokern.zip),
The crash does not occur for the above example.
But it does occur in the case of pdftex-20061022.patch
in fix-autokern2.zip.

Best regards,
Akira

From martin at oneiros.de  Wed Nov  8 19:50:02 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 8 Nov 2006 19:50:02 +0100
Subject: [NTG-pdftex] fix for bugs #481--483
In-Reply-To: <200611081242.kA8CgW0T002825@jupiter.fsci.fuk.kindai.ac.jp>
References: <200611070245.kA72jXle023510@jupiter.fsci.fuk.kindai.ac.jp>
	<200611081242.kA8CgW0T002825@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <68c491a60611081050j4e82f7cdr63f081dfa9f16e0e@mail.gmail.com>

2006/11/8, Akira Kakuto <kakuto at fsci.fuk.kindai.ac.jp>:
> But it does occur in the case of pdftex-20061022.patch
> in fix-autokern2.zip.

Not on Linux (2.6.16.21-0.25), but on OpenBSD 3.9 :-{

I suppose you mean this:
-------------------------
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/lib/libm.so.2.1...done.
Loaded symbols for /usr/lib/libm.so.2.1
Reading symbols from /usr/lib/libc.so.39.0...done.
Loaded symbols for /usr/lib/libc.so.39.0
Reading symbols from /usr/libexec/ld.so...done.
Loaded symbols for /usr/libexec/ld.so
#0  0x1c056ca9 in hyphenate () at pdftex2.c:8902
8902          while ( mem [s ].hh .v.RH > -268435455L ) s = mem [s ].hh .v.RH ;
(gdb) bt
#0  0x1c056ca9 in hyphenate () at pdftex2.c:8902
#1  0x1c006a56 in zlinebreak (d=0) at pdftexini.c:1822
#2  0x1c05b639 in endgraf () at pdftex2.c:11211
#3  0x1c066a63 in maincontrol () at pdftex3.c:5206
#4  0x1c013215 in mainbody () at pdftexini.c:5660
#5  0x1c06bc96 in main (ac=2, av=0xcfbcf398) at pdftexextra.c:341
-------------------------

Best
   Martin

From martin at oneiros.de  Wed Nov  8 20:28:44 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 8 Nov 2006 20:28:44 +0100
Subject: [NTG-pdftex] fix for bugs #481--483
In-Reply-To: <68c491a60611081050j4e82f7cdr63f081dfa9f16e0e@mail.gmail.com>
References: <200611070245.kA72jXle023510@jupiter.fsci.fuk.kindai.ac.jp>
	<200611081242.kA8CgW0T002825@jupiter.fsci.fuk.kindai.ac.jp>
	<68c491a60611081050j4e82f7cdr63f081dfa9f16e0e@mail.gmail.com>
Message-ID: <68c491a60611081128v367be17ax495523ffce37bfd4@mail.gmail.com>

2006/11/8, Martin Schr?der <martin at oneiros.de>:
> Not on Linux (2.6.16.21-0.25), but on OpenBSD 3.9 :-{

And as usual: On Linux it crashes only sometimes. :-(

valgrind helps a bit.

Best
   Martin

From martin at oneiros.de  Wed Nov  8 20:26:11 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 8 Nov 2006 20:26:11 +0100
Subject: [NTG-pdftex] pdftex-1.40.0-beta-20061108
Message-ID: <68c491a60611081126s414eaff6g7bd9b26c15c7acd3@mail.gmail.com>

http://sarovar.org/download.php/1108/pdftex-1.40.0-beta-20061017-20061108.diff.gz

This is just an interim release to help with bug fixing.

---------------------------------------------------------------
pdfTeX 3.141592-1.40.0-beta-20061108 was released on 2006-11-08
---------------------------------------------------------------
- bugfix: extra kerning+expansion+ligatures (481)
- bugfix: extra kerning does not work with ligatures (482)
- bugfix: extra kerning inhibits extra spacing (483)
- bugfix: extra kerning inhibits hyphenation (484)
- bugfix: ttf2afm fails to include characters specified with uniXXXX (565)

Best
   Martin

From kakuto at fsci.fuk.kindai.ac.jp  Thu Nov  9 08:48:03 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Thu, 09 Nov 2006 16:48:03 +0900
Subject: [NTG-pdftex] fix for bugs #481--483
In-Reply-To: Your message of "Wed, 8 Nov 2006 19:50:02 +0100"
References: <68c491a60611081050j4e82f7cdr63f081dfa9f16e0e@mail.gmail.com>
Message-ID: <200611090748.kA97m43g006730@jupiter.fsci.fuk.kindai.ac.jp>

Hi Martin,

> 2006/11/8, Akira Kakuto <kakuto at fsci.fuk.kindai.ac.jp>:
> > But it does occur in the case of pdftex-20061022.patch
> > in fix-autokern2.zip.
> 
> Not on Linux (2.6.16.21-0.25), but on OpenBSD 3.9 :-{

The crash on Windows has disappeared if I initialize tmp_k1 in beta-20061108.

Best regards,
Akira


--- pdftex.web.20061108	Thu Nov 09 16:29:31 2006
+++ pdftex.web	Thu Nov 09 16:33:20 2006
@@ -25491,7 +25491,7 @@
 
 @<If there's a ligature or kern at the cursor position, update...@>=
 if cur_l=non_char then
-  begin k:=bchar_label[hf];
+  begin tmp_k1:=null; k:=bchar_label[hf];
   if k=non_address then goto done at +else q:=font_info[k].qqqq;
   end
 else begin


From martin at oneiros.de  Thu Nov  9 12:38:54 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Thu, 9 Nov 2006 12:38:54 +0100
Subject: [NTG-pdftex] fix for bugs #481--483
In-Reply-To: <200611090748.kA97m43g006730@jupiter.fsci.fuk.kindai.ac.jp>
References: <68c491a60611081050j4e82f7cdr63f081dfa9f16e0e@mail.gmail.com>
	<200611090748.kA97m43g006730@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <68c491a60611090338h6765fca7qc0cda9bd58c2782a@mail.gmail.com>

2006/11/9, Akira Kakuto <kakuto at fsci.fuk.kindai.ac.jp>:
> The crash on Windows has disappeared if I initialize tmp_k1 in beta-20061108.

Also on Linux and OpenBSD. And valgrind is happy. :-)

Thanks!

Best
   Martin

From frank at kuesterei.ch  Fri Nov 10 08:03:11 2006
From: frank at kuesterei.ch (Frank =?iso-8859-1?Q?K=FCster?=)
Date: Fri, 10 Nov 2006 08:03:11 +0100
Subject: [NTG-pdftex] [Hubert Chan] Re: C-only poppler API
Message-ID: <86y7qjlr68.fsf@alhambra.kuesterei.ch>

An embedded message was scrubbed...
From: Hubert Chan <uhoreg at debian.org>
Subject: Re: C-only poppler API
Date: Thu, 09 Nov 2006 17:02:57 -0500
Size: 3551
Url: http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20061110/64a7511a/attachment.mht 
-------------- next part --------------


-- 
Dr. Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX/TeXLive)

From noreply at sarovar.org  Fri Nov 10 17:24:23 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 10 Nov 2006 21:54:23 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-663 ] fix for bugs #481--483
Message-ID: <E1GiZB1-00027L-00@sarovar.org>

Patches item #663, was opened at 2006-10-21 14:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

Category: hz
Group: v1.40.0
>Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: fix for bugs #481--483

Initial Comment:
This is an attempt to fix bug #481--483

- This patch applies to the pristine
pdftex-1.40.0-beta-20061017 sources
  only; if you have applied another patch(es) to the
sources, please
  discard them and start from the fresh ones.

- How to apply:

,--------
| cd /path/to/pdftex-1.40.0-beta-20061017/src
| cat /path/to/the/patch | patch -p1
| ./configure
| cd texk/web2c
| make pdftex
`--------


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-11-10 17:24

Message:
Logged In: YES 
user_id=421

The crash from (5) has been fixed. Please resubmit the other
problems as bug reports; this patch has become confusing
enough. :-}

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-06 23:59

Message:
Logged In: YES 
user_id=421

A more general note: If possible please split continue the
discussion at the affected bugs.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-06 23:57

Message:
Logged In: YES 
user_id=421

I can't reproduce the crash with the latest version of the
patch.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 22:36

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-06 22:34

Message:
Logged In: YES 
user_id=2217

Hi,

I've tested this patch and found some problems with it:
(I haven't had a look at the first patch.)

% ----------------------------------------------------
(1) The kerning amount is wrong/has changed.
%...\kern2.32
%    instead of (with previous versions)
%...\kern 10.00002
% ----------------------------------------------------
(2) There's no kerning before a character if it starts a word.
\hsize 9cm
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\knaccode\font`x=1000
\knbccode\font`x=1000
\pdfappendkern1 \pdfprependkern1

xyxyx xyxyx

% ----------------------------------------------------
(3) Kerning doesn't work in lines composed with expanded fonts.
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyyy:

yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy: yyyy:

% ----------------------------------------------------
(4) Kerning now has this unreliable kind of paragraph scope,
so that whether or not it will be applied depends on whether
tex needs to hyphenate the paragraph, and whether a word
contains a discretionary.
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

tasty testing tasty testing tasty testing tasty testing
tasty testing
\pdfappendkern0 \pdfprependkern0
tasty testing tasty testing tasty testing tasty testing
tasty testing

\bye

% ----------------------------------------------------
% (5) finally, this document gives a segfault 
% (ok without the patches):
\documentclass[10pt,a4paper]{ltxdoc}
\def\rmdefault{bch}
\begin{document}
\begin{multicols}{2}
 A (\textit{Bcdrea}
\end{multicols}
\end{document}


----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-02 09:44

Message:
Logged In: YES 
user_id=710

Thank you Martin for looking at the patch and blessing it. I
was struggling with TeX The Program more than a week before
I came up with this patch and still I am not sure it doesn't
break anything (I didn't claim it fixes bugs #481-484 but
said this is an attempt to fix that).

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-01 18:37

Message:
Logged In: YES 
user_id=421

Thanh, I looked at it, and as it does what you claim (fix
#481-484) and doesn't seem to brake anything, it's in. :-)

Although I'd like Hartmut to also have a look at it. hz
isn't exactly my specialty.

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-28 18:01

Message:
Logged In: YES 
user_id=710

Martin, have you looked at this patch? What do you think of it?

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-22 23:38

Message:
Logged In: YES 
user_id=710

This is an update of the previous patch, which attemps to
solve problem #484 as well (I would not call #484 a bug but
a limitation -- a bug would mean that the behaviour is
inconsistent with the specification).

This patch is *very different* from the previous one, since
now kerns inserted by the new primitives are treated as
implicit kerns (they were treated as explicit kerns before
this patch). This can lead to a very different behaviour, so
be prepared :)



----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-10-21 15:54

Message:
Logged In: YES 
user_id=421

Thanks! Any idea for 484? :-)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=663&group_id=106

From noreply at sarovar.org  Tue Nov 14 15:42:20 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Nov 2006 20:12:20 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-432 ] Rules in a PDF qQ group
Message-ID: <E1GjzUS-0003R9-00@sarovar.org>

Patches item #432, was opened at 2005-10-06 21:01
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

Category: Positioning
>Group: v1.40.0
Status: Closed
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hans Hagen (hagen)
Summary: Rules in a PDF qQ group

Initial Comment:
Put rules with their positioning on the page inside a
qQ group. Should make \pdfliteral page {...} behave
consistently after text or rules or images, as then any
positioning starts from the PDF origin; no
delta-positioning anymore. It's already being tested in
pdfluatex. Just to have it at sarovar...

Testing welcome, particularily with text and graphics
transforms by graphicx package, to spot backward
incompatibilities, if any...

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-07-26 12:29

Message:
Logged In: YES 
user_id=421

This has been included in version 1.40

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:07

Message:
Logged In: YES 
user_id=929

Update pdf_set_origin_temp: Now has (h, v) parameters.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

From noreply at sarovar.org  Tue Nov 14 17:05:39 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Nov 2006 21:35:39 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-462 ] HZ font expansion by text
	matrix manipulation
Message-ID: <E1Gk0n5-0005hT-00@sarovar.org>

Patches item #462, was opened at 2005-12-23 23:35
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

Category: Positioning
Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: HZ font expansion by text matrix manipulation

Initial Comment:
Use textmatrix Tm instead of /FontMatrix for font
expansion. Then a font file will be embedded only once
for all expansion factors. Gives smaller PDF files.
Works then also for non-embedded fonts. TrueType not
tried yet. Rough patch only, incomplete, work in
progress, no warranty, not for production.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-09-30 16:22

Message:
Logged In: YES 
user_id=2217

It's great to have this included!

However, pdftex is now a bit too keen on autoexpanding -- it
does so, even if `autoexpand' is not specified. Although the
pre-created metrics are read, the physical font (pfb resp.
pk) is ignored. As has been discussed re: bug 304, *not*
using autoexpansion gives better results for MM (and MF)
fonts, since the fonts are not stretched blindly but stroke
widths are adjusted etc.

Compare the output of the test file from bugs/304 compiled
with an old pdftex and with 20060928. With the latter, the
strokes are slightly heavier. Same here (with an existing
file cmr10+100.mf):

\pdfadjustspacing2
\pdfmapline{ cmr10}
\pdfmapline{+cmr10+100}
\font\cmr =cmr10 \cmr
\pdffontexpand\cmr 100 0 100 %autoexpand
Hamburgefonts\par
\parfillskip 0pt
Hamburgefonts
\bye


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 19:41

Message:
Logged In: YES 
user_id=421

The last word from Hartmut was that it's not ready yet and
he'd be working on an improved version.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-13 19:05

Message:
Logged In: YES 
user_id=2217

Will this make it into 1.40? I would love to see it included.

I've tested it a bit and did not find any problems (I'm also
using it for the pre-built microtype documentation on CTAN). 

Regards,
Robert

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

From hartmut_henkel at gmx.de  Tue Nov 14 23:31:03 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue, 14 Nov 2006 23:31:03 +0100 (CET)
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <20061113.092843.98559609.wl@gnu.org>
References: <20061111.144923.1989813104.danai@danai.kalimero>
	<20061113.092843.98559609.wl@gnu.org>
Message-ID: <Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>

On Mon, 13 Nov 2006, Werner LEMBERG wrote:

> > Problem now is that latex and dvipdfmx work, but pdflatex doesn't.
> > And the PDF documents in all other languages are made with pdflatex.
> > Strange thing as well is that it worked before with CJK v4.5.2.
>
> Apparently, you've found a fatal bug in pdftex.  I was able to reduce
> it to the attached document.  Using the TeXLive SVN from today (which
> contains pdfeTeX 3.141592-1.30.4-2.2), the first run of
>
>   pdflatex zzzz.tex
>
> works fine, but a second run crashes with
>
>   ! pdfTeX error (arithmetic): divided by zero.
>
> This is on a GNU/Linux box, BTW.

problem appears when font bsmiu59 is called, which happens to be font
no. 256 in the 2nd run. Font size for this font is set to 717619. But
then in pdf_begin_string() the value pdf_font_size[f] is zero, so the

s := divide_scaled(cur_delta_h - pdf_delta_h, pdf_font_size[f], 3);

crashes. It has nothing to do with this particular font, but it seems
that pdftex can't handle more than 255 fonts, so that some wraparound
seems to happen and there is no catch for this condition.

Obvious questions are: Does pdftex have this 255 limitation? Can this be
extended? Or should pdftex quit with the remark that it can't handle
this? Is this really the first time that somebody requests more than 255
fonts?

Regards, Hartmut

From taco at elvenkind.com  Wed Nov 15 00:03:20 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Nov 2006 00:03:20 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>
References: <20061111.144923.1989813104.danai@danai.kalimero>	<20061113.092843.98559609.wl@gnu.org>
	<Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>
Message-ID: <455A4B38.6070309@elvenkind.com>

Hartmut Henkel wrote:
> On Mon, 13 Nov 2006, Werner LEMBERG wrote:
> 
> 
>>>Problem now is that latex and dvipdfmx work, but pdflatex doesn't.
>>>And the PDF documents in all other languages are made with pdflatex.
>>>Strange thing as well is that it worked before with CJK v4.5.2.
>>
>>Apparently, you've found a fatal bug in pdftex.  I was able to reduce
>>it to the attached document.  Using the TeXLive SVN from today (which
>>contains pdfeTeX 3.141592-1.30.4-2.2), the first run of
>>
>>  pdflatex zzzz.tex
>>
>>works fine, but a second run crashes with
>>
>>  ! pdfTeX error (arithmetic): divided by zero.
>>
>>This is on a GNU/Linux box, BTW.
> 
> 
> problem appears when font bsmiu59 is called, which happens to be font
> no. 256 in the 2nd run. Font size for this font is set to 717619. But
> then in pdf_begin_string() the value pdf_font_size[f] is zero, so the
> 
> s := divide_scaled(cur_delta_h - pdf_delta_h, pdf_font_size[f], 3);
> 
> crashes. It has nothing to do with this particular font, but it seems
> that pdftex can't handle more than 255 fonts, so that some wraparound
> seems to happen and there is no catch for this condition.
> 
> Obvious questions are: Does pdftex have this 255 limitation? Can this be
> extended? Or should pdftex quit with the remark that it can't handle
> this? Is this really the first time that somebody requests more than 255
> fonts?

It is an oversight, the problem is that the global |f| is of the wrong
type. In pdftex.web,

@@ -13795,7 +13795,8 @@
  @!dead_cycles:integer; {recent outputs that didn't ship anything out}
  @!doing_leaders:boolean; {are we inside a leader box?}
  @#
-@!c,@!f:quarterword; {character and font in current |char_node|}
+@!c:quarterword; {character in current |char_node|}
+@!f:internal_font_number; {font in current |char_node|}
  @!rule_ht,@!rule_dp,@!rule_wd:scaled; {size of current rule being output}
  @!g:pointer; {current glue specification}
  @!lq,@!lr:integer; {quantities used in calculations for leaders}

Should fix this problem as well as any potentially still lurking similar
problems.

Taco

From danai.sae-han at edpnet.be  Wed Nov 15 00:14:40 2006
From: danai.sae-han at edpnet.be (Danai SAE-HAN (=?utf-8?B?6Z+T6YGU6ICQ?=))
Date: Wed, 15 Nov 2006 00:14:40 +0100 (CET)
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <455A4B38.6070309@elvenkind.com>
References: <20061113.092843.98559609.wl@gnu.org>
	<Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>
	<455A4B38.6070309@elvenkind.com>
Message-ID: <20061115.001440.1980911359.danai@danai.kalimero>

From: Taco Hoekwater <taco at elvenkind.com>

> Hartmut Henkel wrote:
> > problem appears when font bsmiu59 is called, which happens to be font
> > no. 256 in the 2nd run. Font size for this font is set to 717619. But
> > then in pdf_begin_string() the value pdf_font_size[f] is zero, so the
> > 
> > s := divide_scaled(cur_delta_h - pdf_delta_h, pdf_font_size[f], 3);
> > 
> > crashes. It has nothing to do with this particular font, but it seems
> > that pdftex can't handle more than 255 fonts, so that some wraparound
> > seems to happen and there is no catch for this condition.
> > 
> > Obvious questions are: Does pdftex have this 255 limitation? Can this be
> > extended? Or should pdftex quit with the remark that it can't handle
> > this? Is this really the first time that somebody requests more than 255
> > fonts?

CJK languages need a lot of font planes.  That's how I got to the 255+
limit.

> It is an oversight, the problem is that the global |f| is of the wrong
> type. In pdftex.web,
> 
> @@ -13795,7 +13795,8 @@
>   @!dead_cycles:integer; {recent outputs that didn't ship anything out}
>   @!doing_leaders:boolean; {are we inside a leader box?}
>   @#
> -@!c,@!f:quarterword; {character and font in current |char_node|}
> +@!c:quarterword; {character in current |char_node|}
> +@!f:internal_font_number; {font in current |char_node|}
>   @!rule_ht,@!rule_dp,@!rule_wd:scaled; {size of current rule being output}
>   @!g:pointer; {current glue specification}
>   @!lq,@!lr:integer; {quantities used in calculations for leaders}
> 
> Should fix this problem as well as any potentially still lurking similar
> problems.

Hartelijk bedankt, Taco!  A great many thanks also to Hartmut!
I'll contact the Debian TeX distributors immediately and answer you as
soon as I can confirm this fix.


Cheers!



Danai SAE-HAN
???

-- 
??:??????
??:?????????????

????????????????
????????????????
????????????????
????????????????

From noreply at sarovar.org  Wed Nov 15 02:14:20 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 06:44:20 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-692 ] Amount of extra kerning is
	wrong/has changed
Message-ID: <E1Gk9M4-00085s-00@sarovar.org>

Bugs item #692, was opened at 2006-11-15 01:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: Amount of extra kerning is wrong/has changed

Initial Comment:
With \kn[ab]ccode=1000 a kern of 1em should be inserted.
(Here, it's 2.32pt:)

\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\pdfappendkern1 \pdfprependkern1
\knaccode\font`y=1000
\knbccode\font`y=1000

xyx
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

From noreply at sarovar.org  Wed Nov 15 02:14:43 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 06:44:43 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-693 ] No extra kerning before a
	character if it starts a word
Message-ID: <E1Gk9MR-0008H0-00@sarovar.org>

Bugs item #693, was opened at 2006-11-15 01:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=693&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: No extra kerning before a character if it starts a word

Initial Comment:
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\pdfprependkern1
\knbccode\font`x=1000

xyx xyx
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=693&group_id=106

From noreply at sarovar.org  Wed Nov 15 02:14:58 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 06:44:58 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-694 ] Extra kerning doesn't work in
	lines composed with expanded fonts
Message-ID: <E1Gk9Mg-0008QU-00@sarovar.org>

Bugs item #694, was opened at 2006-11-15 01:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=694&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: Extra kerning doesn't work in lines composed with expanded fonts

Initial Comment:
\pdftracingfonts2
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\hsize 4cm
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyy:

yyy: yyy: yyy: yyy: yyy:
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=694&group_id=106

From noreply at sarovar.org  Wed Nov 15 02:16:26 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 06:46:26 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing kerning
	settings within a paragraph
Message-ID: <E1Gk9O6-0000W9-00@sarovar.org>

Bugs item #695, was opened at 2006-11-15 01:16
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=695&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: Confusion when changing kerning settings within a paragraph

Initial Comment:
Extra kerning now has this nasty, unreliable kind of
paragraph scope, so that whether or not extra kerning
will be applied depends on whether tex needs to
hyphenate the paragraph, and whether a word contains a
discretionary.
(Same as for \pdfnoligatures [see discussion in feature
req 385], for which this may be an acceptable
limitation, since it has global scope, anyway. However,
I don't consider it acceptable for the kerning feature.
Think of language-dependant settings, for example.)

\hsize 7cm
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

nasty testing nasty testing nasty testing nasty testing
nasty testing

nasty testing nasty testing nasty testing nasty testing
nasty testing
\pdfappendkern0 \pdfprependkern0
nasty testing nasty testing nasty testing nasty testing
nasty testing

\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=695&group_id=106

From noreply at sarovar.org  Wed Nov 15 02:23:24 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 06:53:24 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-304 ] Names of expanded fonts not in log
	output
Message-ID: <E1Gk9Uq-0001lT-00@sarovar.org>

Bugs item #304, was opened at 2005-03-02 17:25
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=304&group_id=106

Category: Fonts
Group: v1.21a
Status: Open
Resolution: Accepted
Priority: 3
Submitted By: Robert (schlcht)
Assigned to: Hartmut Henkel (hhenkel)
Summary: Names of expanded fonts not in log output

Initial Comment:
When using font expansion, the log output will not
contain the names of the expanded fonts but the null
character instead (resp. ^^@).

%-------------------------------------
\pdfadjustspacing=2
\pdffontexpand\font 20 20 5 autoexpand
\tracingoutput=1
test

\parfillskip 0pt
test
\bye
%-------------------------------------

Regards,
Robert.


----------------------------------------------------------------------

>Comment By: Robert (schlcht)
Date: 2006-11-15 01:23

Message:
Logged In: YES 
user_id=2217

problem with autoexpanding now at bugs/696

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-10-23 10:23

Message:
Logged In: YES 
user_id=710

Here is an attempt to fix this problem (reversed patch
attached).

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-09-03 17:30

Message:
Logged In: YES 
user_id=2217

I've attached an example using Kepler MM (tfm+pfb included,
please delete after testing).

MM fonts are probably the only case where one would not want
to use the autoexpand feature.

At first sight, saying "autoexpand" or not doesn't seem to
make a difference, since pdftex will always prefer existing
expanded fonts (pfb) over autoexpanding them, anyway.
However, there are some slight differences in the pdf. This
is probably because the provided tfm file is different from
the metrics that pdf calculates itself in the case of
autoexpand. That is, autoexpand may result in a mismatch
between the provided pfb and the calculated tfm, is that
correct?


----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2006-09-01 19:02

Message:
Logged In: YES 
user_id=929

currently i even can't get a test file do expansion at all
without "autoexpand". E. g. Robert's example above, without
"autoexpand", doesn't use expanded fonts. Maybe that's the
reason for the missing expand parameter in the log? Can
anybody provide a test file for this case?

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-09-01 10:47

Message:
Logged In: YES 
user_id=421

Is this really a problem, i.e. is there a reason _not_ to
use the autoexpand feature in new documents?

Hartmut, did you look into this bug?

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2005-10-15 22:24

Message:
Logged In: YES 
user_id=2217

If the font is not autoexpand'ed, its name will still not be
written to the log file.

(pdftex 1.30.3; same test file, without "autoexpand")

Regards,
Robert.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-12 15:05

Message:
Logged In: YES 
user_id=421

This has been fixed in 1.30.0

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-03-30 20:16

Message:
Logged In: YES 
user_id=929

This patch is based of Thanh's change file showfont.ch,
which he gave me during EuroTeX2005 (it's also included,
renamed here to showfont-thanh.ch). Use showfont.ch for the
patch.

There is now a new integer variable \pdftracingfonts. It is
zero by default, then we get a log like this (see
robert050302.log):

...\tenrm t

...\tenrm (+20) e

Without font expansion, this default should be compatible
with TeX's original log output.

If \pdftracingfonts is set to 1 (or greater), we get a more
verbose log (see tst-304.log):

...\xivtt (cmtt10 at 14.0pt) t

.\xivtt (cmtt10+20 at 14.0pt) e

Seems to work with change file showfont.ch coming directly
after after hz.ch.

Patch only roughly tested with pdfetex, likely to give
problems with pdfxtex, as the variable numbering might
differ. Log format to be agreed upon...

Regards, Hartmut


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=304&group_id=106

From noreply at sarovar.org  Wed Nov 15 02:22:35 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 06:52:35 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-696 ] pdftex always autoexpands -- even
	if it shouldn't
Message-ID: <E1Gk9U3-0001Us-00@sarovar.org>

Bugs item #696, was opened at 2006-11-15 01:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=696&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: pdftex always autoexpands -- even if it shouldn't

Initial Comment:
pdftex is now a bit too keen on autoexpanding -- it
does so, even if `autoexpand' is not specified.
Although the pre-created metrics are read, the physical
font (pfb resp. pk) is ignored. As has been discussed
re: bugs/304, *not* using autoexpansion gives better
results for MM (and MF) fonts, since the fonts are not
stretched blindly but stroke widths are adjusted etc.

I've moved the test file from bugs/304 here. Another
example is (with an existing file cmr10+100.mf):

\pdfadjustspacing2
\pdfmapline{ cmr10}
\pdfmapline{+cmr10+100}
\font\cmr =cmr10 \cmr
\pdffontexpand\cmr 100 0 100 %autoexpand
Hamburgefonts\par
\parfillskip 0pt
Hamburgefonts
\bye

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=696&group_id=106

From taco at elvenkind.com  Wed Nov 15 10:24:13 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Nov 2006 10:24:13 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <86r6w59itl.fsf@alhambra.kuesterei.ch>
References: <20061111.144923.1989813104.danai@danai.kalimero>	<20061113.092843.98559609.wl@gnu.org>	<Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>	<455A4B38.6070309@elvenkind.com>
	<86r6w59itl.fsf@alhambra.kuesterei.ch>
Message-ID: <455ADCBD.9080005@elvenkind.com>



Frank K?ster wrote:

> But that looks as if it already patches this?  But then why do we
> encounter the bug in Debian?

"Yes" and "I do not know"

Taco



From pragma at wxs.nl  Wed Nov 15 10:31:28 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 15 Nov 2006 09:31:28 +0000
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>
References: <20061111.144923.1989813104.danai@danai.kalimero>
	<20061113.092843.98559609.wl@gnu.org>
	<Pine.LNX.4.64.0611142320410.17651@hahepc1.hahe>
Message-ID: <455ADE70.3010109@wxs.nl>

Hartmut Henkel wrote:
> On Mon, 13 Nov 2006, Werner LEMBERG wrote:
>
>   
>>> Problem now is that latex and dvipdfmx work, but pdflatex doesn't.
>>> And the PDF documents in all other languages are made with pdflatex.
>>> Strange thing as well is that it worked before with CJK v4.5.2.
>>>       
>> Apparently, you've found a fatal bug in pdftex.  I was able to reduce
>> it to the attached document.  Using the TeXLive SVN from today (which
>> contains pdfeTeX 3.141592-1.30.4-2.2), the first run of
>>
>>   pdflatex zzzz.tex
>>
>> works fine, but a second run crashes with
>>
>>   ! pdfTeX error (arithmetic): divided by zero.
>>
>> This is on a GNU/Linux box, BTW.
>>     
>
> problem appears when font bsmiu59 is called, which happens to be font
> no. 256 in the 2nd run. Font size for this font is set to 717619. But
> then in pdf_begin_string() the value pdf_font_size[f] is zero, so the
>
> s := divide_scaled(cur_delta_h - pdf_delta_h, pdf_font_size[f], 3);
>
> crashes. It has nothing to do with this particular font, but it seems
> that pdftex can't handle more than 255 fonts, so that some wraparound
> seems to happen and there is no catch for this condition.
>
> Obvious questions are: Does pdftex have this 255 limitation? Can this be
> extended? Or should pdftex quit with the remark that it can't handle
> this? Is this really the first time that somebody requests more than 255
> fonts?
>   
this limitation sounds strange to me and i consider it to be a bug; just jump the max to 4K or so 

Hans 



-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From noreply at sarovar.org  Wed Nov 15 10:27:49 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 14:57:49 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-692 ] Amount of extra kerning is
	wrong/has changed
Message-ID: <E1GkH3d-0007lI-00@sarovar.org>

Bugs item #692, was opened at 2006-11-15 02:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

>Category: hz
>Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: The Thanh Han (hanthethanh)
Summary: Amount of extra kerning is wrong/has changed

Initial Comment:
With \kn[ab]ccode=1000 a kern of 1em should be inserted.
(Here, it's 2.32pt:)

\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\pdfappendkern1 \pdfprependkern1
\knaccode\font`y=1000
\knbccode\font`y=1000

xyx
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

From noreply at sarovar.org  Wed Nov 15 10:28:05 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 14:58:05 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-693 ] No extra kerning before a
	character if it starts a word
Message-ID: <E1GkH3t-0007lX-00@sarovar.org>

Bugs item #693, was opened at 2006-11-15 02:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=693&group_id=106

>Category: hz
>Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: The Thanh Han (hanthethanh)
Summary: No extra kerning before a character if it starts a word

Initial Comment:
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\pdfprependkern1
\knbccode\font`x=1000

xyx xyx
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=693&group_id=106

From noreply at sarovar.org  Wed Nov 15 10:28:22 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 14:58:22 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-694 ] Extra kerning doesn't work in
	lines composed with expanded fonts
Message-ID: <E1GkH4A-0007lj-00@sarovar.org>

Bugs item #694, was opened at 2006-11-15 02:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=694&group_id=106

>Category: hz
>Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: The Thanh Han (hanthethanh)
Summary: Extra kerning doesn't work in lines composed with expanded fonts

Initial Comment:
\pdftracingfonts2
\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\hsize 4cm
\pdfprependkern1
\knbccode\font`:=500
\pdfadjustspacing2
\pdffontexpand\font 20 20 5 autoexpand

yyy:

yyy: yyy: yyy: yyy: yyy:
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=694&group_id=106

From noreply at sarovar.org  Wed Nov 15 10:28:51 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 14:58:51 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing kerning
	settings within a paragraph
Message-ID: <E1GkH4d-00082Z-00@sarovar.org>

Bugs item #695, was opened at 2006-11-15 02:16
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=695&group_id=106

>Category: hz
>Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: The Thanh Han (hanthethanh)
Summary: Confusion when changing kerning settings within a paragraph

Initial Comment:
Extra kerning now has this nasty, unreliable kind of
paragraph scope, so that whether or not extra kerning
will be applied depends on whether tex needs to
hyphenate the paragraph, and whether a word contains a
discretionary.
(Same as for \pdfnoligatures [see discussion in feature
req 385], for which this may be an acceptable
limitation, since it has global scope, anyway. However,
I don't consider it acceptable for the kerning feature.
Think of language-dependant settings, for example.)

\hsize 7cm
\pdfadjustspacing0
\knaccode\font`s=500
\knbccode\font`s=500
\pdfappendkern1 \pdfprependkern1

nasty testing nasty testing nasty testing nasty testing
nasty testing

nasty testing nasty testing nasty testing nasty testing
nasty testing
\pdfappendkern0 \pdfprependkern0
nasty testing nasty testing nasty testing nasty testing
nasty testing

\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=695&group_id=106

From noreply at sarovar.org  Wed Nov 15 10:28:54 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Nov 2006 14:58:54 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-696 ] pdftex always autoexpands -- even
	if it shouldn't
Message-ID: <E1GkH4g-00082g-00@sarovar.org>

Bugs item #696, was opened at 2006-11-15 02:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=696&group_id=106

>Category: hz
>Group: v1.40.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
>Assigned to: The Thanh Han (hanthethanh)
Summary: pdftex always autoexpands -- even if it shouldn't

Initial Comment:
pdftex is now a bit too keen on autoexpanding -- it
does so, even if `autoexpand' is not specified.
Although the pre-created metrics are read, the physical
font (pfb resp. pk) is ignored. As has been discussed
re: bugs/304, *not* using autoexpansion gives better
results for MM (and MF) fonts, since the fonts are not
stretched blindly but stroke widths are adjusted etc.

I've moved the test file from bugs/304 here. Another
example is (with an existing file cmr10+100.mf):

\pdfadjustspacing2
\pdfmapline{ cmr10}
\pdfmapline{+cmr10+100}
\font\cmr =cmr10 \cmr
\pdffontexpand\cmr 100 0 100 %autoexpand
Hamburgefonts\par
\parfillskip 0pt
Hamburgefonts
\bye

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=696&group_id=106

From kakuto at fsci.fuk.kindai.ac.jp  Wed Nov 15 11:35:14 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Wed, 15 Nov 2006 19:35:14 +0900
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: Your message of "Wed, 15 Nov 2006 00:14:40 +0100 (CET)"
References: <20061115.001440.1980911359.danai@danai.kalimero>
Message-ID: <200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>

> > It is an oversight, the problem is that the global |f| is of the wrong
> > type. In pdftex.web,
> > 
> > @@ -13795,7 +13795,8 @@
> >   @!dead_cycles:integer; {recent outputs that didn't ship anything out}
> >   @!doing_leaders:boolean; {are we inside a leader box?}
> >   @#
> > -@!c,@!f:quarterword; {character and font in current |char_node|}
> > +@!c:quarterword; {character in current |char_node|}
> > +@!f:internal_font_number; {font in current |char_node|}
> >   @!rule_ht,@!rule_dp,@!rule_wd:scaled; {size of current rule being output}
> >   @!g:pointer; {current glue specification}
> >   @!lq,@!lr:integer; {quantities used in calculations for leaders}
> > 
> > Should fix this problem as well as any potentially still lurking similar
> > problems.

Is it special to Debian?  In 1.40.0 beta, I think it does not remain
in the final pdftex.p since in tex.ch, and thus in pdftex.ch,
there are lines
@x
@!c,@!f:quarterword; {character and font in current |char_node|}
@y
 {character and font in current |char_node|}
@!c:quarterword;
@!f:internal_font_number;
@z

Best regards,
Akira

From martin at oneiros.de  Wed Nov 15 11:45:37 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 15 Nov 2006 11:45:37 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>
References: <20061115.001440.1980911359.danai@danai.kalimero>
	<200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <68c491a60611150245m308ccecbhd0e138b683fa1f1b@mail.gmail.com>

2006/11/15, Akira Kakuto <kakuto at fsci.fuk.kindai.ac.jp>:
> Is it special to Debian?  In 1.40.0 beta, I think it does not

Seems to be, as 1.30.6 and 1.40.0-beta have f:internal_font_number; in
pdftex-all.web (cd texk/web2c; make pdftex-all.web).

Best
   Martin

From taco at elvenkind.com  Wed Nov 15 11:47:12 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Nov 2006 11:47:12 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>
References: <20061115.001440.1980911359.danai@danai.kalimero>
	<200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <455AF030.40102@elvenkind.com>


Akira Kakuto wrote:
> 
> Is it special to Debian?  In 1.40.0 beta, I think it does not remain
> in the final pdftex.p since in tex.ch, and thus in pdftex.ch,
> there are lines
> @x
> @!c,@!f:quarterword; {character and font in current |char_node|}
> @y
>  {character and font in current |char_node|}
> @!c:quarterword;
> @!f:internal_font_number;
> @z

Oops, I missed that. Let me check that again (that'll teach me to
attempt to debug stuff without running the test file :-/)

Taco

From taco at elvenkind.com  Wed Nov 15 14:56:42 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Nov 2006 14:56:42 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <455AF030.40102@elvenkind.com>
References: <20061115.001440.1980911359.danai@danai.kalimero>	<200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>
	<455AF030.40102@elvenkind.com>
Message-ID: <455B1C9A.6090600@elvenkind.com>


Hi,

This turned out to be something completely different from what
I thought initially, and does not seem related to a font number
limit at all ?

My current analysis is that the internal base font defined in the
vf file is not initialized yet (so pdf_font_size[f] is still
zero) at the moment output_one_char() is called on it.

I am surprised because if that really is the problem, should
it not have happened earlier and more often?

The attached patch makes the test document run without error
on my machine. However, I am not sure whether this fixes the
problem or just makes the message disappear while still generating
wrong output.

The important line is the 'if font_used[f]' test, the other change
is just to avoid confusion (do_vf_packet used to assign to its 'f'
argument).

Best,
Taco

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: patch
Url: http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20061115/4735c6ec/attachment.asc 

From hartmut_henkel at gmx.de  Thu Nov 16 01:23:09 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu, 16 Nov 2006 01:23:09 +0100 (CET)
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <455B1C9A.6090600@elvenkind.com>
References: <20061115.001440.1980911359.danai@danai.kalimero>
	<200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>
	<455AF030.40102@elvenkind.com> <455B1C9A.6090600@elvenkind.com>
Message-ID: <Pine.LNX.4.64.0611160115530.9759@hahepc1.hahe>

On Wed, 15 Nov 2006, Taco Hoekwater wrote:

> This turned out to be something completely different from what I
> thought initially, and does not seem related to a font number limit at
> all ?

now it seems to be some kind of memory leak: Something spills over into
the font_used[f] array, setting it successively true from the beginning.
When font no. 90 is loaded, it's just full enough so that this font is
never initialized. Then it crashes. Guarding the font_used[f] array in
front by some additional dummy boolean foo_used[f] array helps, then it
runs fine. One also sees that then array foo_used[] is filled with true.
No idea yet what this leak is.

Regards, Hartmut

From kakuto at fsci.fuk.kindai.ac.jp  Thu Nov 16 01:41:10 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Thu, 16 Nov 2006 09:41:10 +0900
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: Your message of "Wed, 15 Nov 2006 14:56:42 +0100"
References: <455B1C9A.6090600@elvenkind.com>
Message-ID: <200611160041.kAG0fCC2014116@jupiter.fsci.fuk.kindai.ac.jp>

>      vf_replace_z;
>      save_vf := f;
>      f := vf_i_fnts[vf_default_font[save_vf]];
> +	if not font_used[f] then
> +       pdf_init_font(f);
>      save_v := cur_v;
>      save_h := cur_h;
>      w := 0; x := 0; y := 0; z := 0;

Is that a typo of font_used(f) ?
I didn't yet try in pdfTeX, but tried and failed
in luaTeX ( succeeded by changing font_used[f] ---> font_used(f) ).

Thanks,
Akira

From kakuto at fsci.fuk.kindai.ac.jp  Thu Nov 16 01:49:32 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Thu, 16 Nov 2006 09:49:32 +0900
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: Your message of "Thu, 16 Nov 2006 09:41:10 +0900"
References: <200611160041.kAG0fCC2014116@jupiter.fsci.fuk.kindai.ac.jp>
Message-ID: <200611160049.kAG0nWpf014156@jupiter.fsci.fuk.kindai.ac.jp>

> >      vf_replace_z;
> >      save_vf := f;
> >      f := vf_i_fnts[vf_default_font[save_vf]];
> > +	if not font_used[f] then
> > +       pdf_init_font(f);
> >      save_v := cur_v;
> >      save_h := cur_h;
> >      w := 0; x := 0; y := 0; z := 0;
> 
> Is that a typo of font_used(f) ?
> I didn't yet try in pdfTeX, but tried and failed
> in luaTeX ( succeeded by changing font_used[f] ---> font_used(f) ).

Sorry, I've noticed that luaTeX and pdfTeX is different!

Thanks,
Akira

From taco at elvenkind.com  Thu Nov 16 10:38:13 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 16 Nov 2006 10:38:13 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <Pine.LNX.4.64.0611160115530.9759@hahepc1.hahe>
References: <20061115.001440.1980911359.danai@danai.kalimero>	<200611151035.kAFAZFD1011309@jupiter.fsci.fuk.kindai.ac.jp>	<455AF030.40102@elvenkind.com>
	<455B1C9A.6090600@elvenkind.com>
	<Pine.LNX.4.64.0611160115530.9759@hahepc1.hahe>
Message-ID: <455C3185.3080503@elvenkind.com>


Hi,

Hartmut Henkel wrote:
> On Wed, 15 Nov 2006, Taco Hoekwater wrote:
> 
> 
>>This turned out to be something completely different from what I
>>thought initially, and does not seem related to a font number limit at
>>all ?
> 
> 
> now it seems to be some kind of memory leak: Something spills over into
> the font_used[f] array, setting it successively true from the beginning.
> When font no. 90 is loaded, it's just full enough so that this font is
> never initialized. Then it crashes. Guarding the font_used[f] array in
> front by some additional dummy boolean foo_used[f] array helps, then it
> runs fine. One also sees that then array foo_used[] is filled with true.
> No idea yet what this leak is.

I think I have found it from checking up your hint about font_used[]
in the debugger:

   The arrays vf_i_fnts[] and vf_e_fnts[] are alloc as size font_max, but
   their indexes can easily overflow that because a vf font can contain
   more than one base font.

I've added two cases of
	
    if vf_nf>font_max then
        overflow("virtual fonts",font_max);

right after the two occurrences of increments of vf_nf in pdftex.web,
and now I get:

   ! TeX capacity exceeded, sorry [virtual fonts=2000].

Cheers,
Taco




From hanthethanh at gmail.com  Thu Nov 16 14:21:33 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Thu, 16 Nov 2006 14:21:33 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
Message-ID: <74f506dc0611160521y633c8877w8ea82cf68689a2a@mail.gmail.com>

Hi,

yes this seems to be the right cause of the bug. I was
silent because I cannot reproduce the bug with the test
file sent by Werner. The previous case seems irrelevant, as
font_used[f] is already checked inside pdf_begin_string, ie
whenever non-virtual char is written out.

Regards,
Thanh


On Thu, Nov 16, 2006 at 10:38:13AM +0100, Taco Hoekwater wrote:
> I think I have found it from checking up your hint about font_used[]
> in the debugger:
>
>    The arrays vf_i_fnts[] and vf_e_fnts[] are alloc as size font_max, but
>    their indexes can easily overflow that because a vf font can contain
>    more than one base font.
>
> I've added two cases of
> 	
>     if vf_nf>font_max then
>         overflow("virtual fonts",font_max);
>
> right after the two occurrences of increments of vf_nf in pdftex.web,
> and now I get:
>
>    ! TeX capacity exceeded, sorry [virtual fonts=2000].
>
> Cheers,
> Taco
>
>
>
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex at ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex

From taco at elvenkind.com  Thu Nov 16 14:39:36 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 16 Nov 2006 14:39:36 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <74f506dc0611160521y633c8877w8ea82cf68689a2a@mail.gmail.com>
References: <74f506dc0611160521y633c8877w8ea82cf68689a2a@mail.gmail.com>
Message-ID: <455C6A18.2020404@elvenkind.com>



Thanh Han The wrote:
> Hi,
> 
> yes this seems to be the right cause of the bug. I was
> silent because I cannot reproduce the bug with the test
> file sent by Werner. The previous case seems irrelevant, as
> font_used[f] is already checked inside pdf_begin_string, ie
> whenever non-virtual char is written out.

Then it looks like font_max must be raised again in the
change file, yes?

Cheers,
Taco

From hanthethanh at gmail.com  Thu Nov 16 14:44:41 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Thu, 16 Nov 2006 14:44:41 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
Message-ID: <74f506dc0611160544o4cb28215q584d85b2178ef367@mail.gmail.com>

On Thu, Nov 16, 2006 at 02:39:36PM +0100, Taco Hoekwater wrote:
>
>
> Thanh Han The wrote:
> >Hi,
> >
> >yes this seems to be the right cause of the bug. I was
> >silent because I cannot reproduce the bug with the test
> >file sent by Werner. The previous case seems irrelevant, as
> >font_used[f] is already checked inside pdf_begin_string, ie
> >whenever non-virtual char is written out.
>
> Then it looks like font_max must be raised again in the
> change file, yes?

no need to do so, it's configurable in texmf.cnf

Regards,
Thanh

From hanthethanh at gmail.com  Thu Nov 16 14:45:50 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Thu, 16 Nov 2006 14:45:50 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
Message-ID: <74f506dc0611160545t6f12f4es942eed6d32c961d0@mail.gmail.com>

ah sorry, I overlooked. Yes it must be changed in the change
file.

Thanh

On Thu, Nov 16, 2006 at 02:44:03PM +0100, The Thanh Han wrote:
> On Thu, Nov 16, 2006 at 02:39:36PM +0100, Taco Hoekwater wrote:
> >
> >
> > Thanh Han The wrote:
> > >Hi,
> > >
> > >yes this seems to be the right cause of the bug. I was
> > >silent because I cannot reproduce the bug with the test
> > >file sent by Werner. The previous case seems irrelevant, as
> > >font_used[f] is already checked inside pdf_begin_string, ie
> > >whenever non-virtual char is written out.
> >
> > Then it looks like font_max must be raised again in the
> > change file, yes?
>
> no need to do so, it's configurable in texmf.cnf
>
> Regards,
> Thanh

From reinhard.kotucha at web.de  Thu Nov 16 17:43:15 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Thu, 16 Nov 2006 17:43:15 +0100
Subject: [NTG-pdftex] [pdftex] SGML output fails with pdflatex
In-Reply-To: <74f506dc0611160544o4cb28215q584d85b2178ef367@mail.gmail.com>
References: <74f506dc0611160544o4cb28215q584d85b2178ef367@mail.gmail.com>
Message-ID: <17756.38179.739066.705452@zarniwoop.ms25.local>

>>>>> "Thanh" == Thanh Han The <hanthethanh at gmail.com> writes:

  >> Then it looks like font_max must be raised again in the change
  >> file, yes?

  > no need to do so, it's configurable in texmf.cnf

AFAIK you can configure variables in texmf.cnf up to a limit which is
set in the change file.

All the variables in the change files had been quite small and had
been increased from time to time whenever someone needed more memory.
Maybe it's best to increase the variables in the change files to the
highest possible value so that this part of the changefile has not to
be touched again and everything can be controlled by the config file.

Anyway, priority is quite low (until someone asks...).

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------



From vit.zyka at seznam.cz  Fri Nov 17 15:21:12 2006
From: vit.zyka at seznam.cz (Vit Zyka)
Date: Fri, 17 Nov 2006 15:21:12 +0100
Subject: [NTG-pdftex] looking for Jochen Skupin
Message-ID: <455DC558.9020005@seznam.cz>

Sorry for a bit off-topic.

We are looking for: Jochen Skupin (jochen.skupin at uni-bremen.de), the 
author of pdfanim.sty package. Rober Marik significantly improved 
Jochen's package and he would like to CTANize/maintain this upgrade. The 
problem is that the e-mail above is deaf.

Can somebody help to contact him, please?

Thanks
Vit Zyka


From noreply at sarovar.org  Fri Nov 17 16:12:36 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 17 Nov 2006 20:42:36 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-692 ] Amount of extra kerning is
	wrong/has changed
Message-ID: <E1Gl5OO-0004ik-00@sarovar.org>

Bugs item #692, was opened at 2006-11-15 01:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: Amount of extra kerning is wrong/has changed

Initial Comment:
With \kn[ab]ccode=1000 a kern of 1em should be inserted.
(Here, it's 2.32pt:)

\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\pdfappendkern1 \pdfprependkern1
\knaccode\font`y=1000
\knbccode\font`y=1000

xyx
\bye


----------------------------------------------------------------------

>Comment By: Robert (schlcht)
Date: 2006-11-17 15:12

Message:
Logged In: YES 
user_id=2217

In fact, the kerning amount wraps at a kerning code of 256:

\tracingoutput1
\showboxbreadth\maxdimen
\pdfappendkern1
\knaccode\font`y=255 y % 2.55pt
\knaccode\font`y=257 y % 0.01pt
\knaccode\font`y=513 y % 0.01pt
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

From martin at oneiros.de  Fri Nov 17 17:04:20 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Fri, 17 Nov 2006 17:04:20 +0100
Subject: [NTG-pdftex] looking for Jochen Skupin
In-Reply-To: <455DC558.9020005@seznam.cz>
References: <455DC558.9020005@seznam.cz>
Message-ID: <68c491a60611170804v5a2ac6a3nafc474c81e763154@mail.gmail.com>

2006/11/17, Vit Zyka <vit.zyka at seznam.cz>:
> We are looking for: Jochen Skupin (jochen.skupin at uni-bremen.de), the
> author of pdfanim.sty package. Rober Marik significantly improved
> Jochen's package and he would like to CTANize/maintain this upgrade. The
> problem is that the e-mail above is deaf.

Huh? Normally it works.

> Can somebody help to contact him, please?

Consider it done.

Best
   Martin

From noreply at sarovar.org  Sun Nov 19 11:10:46 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Sun, 19 Nov 2006 15:40:46 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-692 ] Amount of extra kerning is
	wrong/has changed
Message-ID: <E1GljdO-0008Bt-00@sarovar.org>

Bugs item #692, was opened at 2006-11-15 01:14
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: Amount of extra kerning is wrong/has changed

Initial Comment:
With \kn[ab]ccode=1000 a kern of 1em should be inserted.
(Here, it's 2.32pt:)

\tracingoutput1
\showboxdepth\maxdimen
\showboxbreadth\maxdimen
\pdfappendkern1 \pdfprependkern1
\knaccode\font`y=1000
\knbccode\font`y=1000

xyx
\bye


----------------------------------------------------------------------

>Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-19 10:10

Message:
Logged In: YES 
user_id=710

This bug is caused by missing of declaration of k inside the
function get_auto_kern, hence the global variable k is taken
with wrong type (eight_bits).

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-11-17 15:12

Message:
Logged In: YES 
user_id=2217

In fact, the kerning amount wraps at a kerning code of 256:

\tracingoutput1
\showboxbreadth\maxdimen
\pdfappendkern1
\knaccode\font`y=255 y % 2.55pt
\knaccode\font`y=257 y % 0.01pt
\knaccode\font`y=513 y % 0.01pt
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=692&group_id=106

From hanthethanh at gmail.com  Sun Nov 19 12:19:07 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Sun, 19 Nov 2006 12:19:07 +0100
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing
	kerning settings within a paragraph
Message-ID: <74f506dc0611190319u62eb7cf8s5b5022679353005c@mail.gmail.com>

I think it was not a good decision to introduce those new
features, as they touch a very sensitive area of tex and
it's hard to get them right. I wonder whether it is better
to discard them all.

Thanh


On Wed, Nov 15, 2006 at 06:46:26AM +0530, noreply at sarovar.org wrote:
> Bugs item #695, was opened at 2006-11-15 01:16
> You can respond by visiting:
> http://sarovar.org/tracker/?func=detail%26atid=493%26aid=695%26group_id=106
>
> Category: None
> Group: None
> Status: Open
> Resolution: None
> Priority: 5
> Submitted By: Robert (schlcht)
> Assigned to: Nobody (None)
> Summary: Confusion when changing kerning settings within a paragraph
>
> Initial Comment:
> Extra kerning now has this nasty, unreliable kind of
> paragraph scope, so that whether or not extra kerning
> will be applied depends on whether tex needs to
> hyphenate the paragraph, and whether a word contains a
> discretionary.
> (Same as for \pdfnoligatures [see discussion in feature
> req 385], for which this may be an acceptable
> limitation, since it has global scope, anyway. However,
> I don't consider it acceptable for the kerning feature.
> Think of language-dependant settings, for example.)
>
> \hsize 7cm
> \pdfadjustspacing0
> \knaccode\font`s=500
> \knbccode\font`s=500
> \pdfappendkern1 \pdfprependkern1
>
> nasty testing nasty testing nasty testing nasty testing
> nasty testing
>
> nasty testing nasty testing nasty testing nasty testing
> nasty testing
> \pdfappendkern0 \pdfprependkern0
> nasty testing nasty testing nasty testing nasty testing
> nasty testing
>
> \bye
>
>
> ----------------------------------------------------------------------
>
> You can respond by visiting:
> http://sarovar.org/tracker/?func=detail%26atid=493%26aid=695%26group_id=106
> _______________________________________________
> ntg-pdftex mailing list
> ntg-pdftex at ntg.nl
> http://www.ntg.nl/mailman/listinfo/ntg-pdftex

From pragma at wxs.nl  Sun Nov 19 23:07:38 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 19 Nov 2006 23:07:38 +0100
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when
 changing	kerning settings within a paragraph
In-Reply-To: <74f506dc0611190319u62eb7cf8s5b5022679353005c@mail.gmail.com>
References: <74f506dc0611190319u62eb7cf8s5b5022679353005c@mail.gmail.com>
Message-ID: <4560D5AA.5040908@wxs.nl>

Hi Thanh,
> I think it was not a good decision to introduce those new
> features, as they touch a very sensitive area of tex and
> it's hard to get them right. I wonder whether it is better
> to discard them all.
>   
removing them is tricky since they may be in use already but don't spend to much time on fixing things that are hard to fix in current tex; once luatex is in a state where fontdata has no longer the global properties  and where we can have more control over font related featurss, you can probably rewrite most of the code in a cleaner way 

Hans   


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Sun Nov 19 23:31:37 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Sun, 19 Nov 2006 23:31:37 +0100
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing
	kerning settings within a paragraph
In-Reply-To: <74f506dc0611190319u62eb7cf8s5b5022679353005c@mail.gmail.com>
References: <74f506dc0611190319u62eb7cf8s5b5022679353005c@mail.gmail.com>
Message-ID: <68c491a60611191431s932f916t6a6d4e49754665ac@mail.gmail.com>

2006/11/19, Thanh Han The <hanthethanh at gmail.com>:
> I think it was not a good decision to introduce those new
> features, as they touch a very sensitive area of tex and
> it's hard to get them right. I wonder whether it is better
> to discard them all.

Removing them all is probably too hard. And AFAIK all these new
features are still undocumented, so we can treat them as experimental.
Just try to not break existing features too much. :-)

Best
   Martin

From hanthethanh at gmail.com  Tue Nov 21 11:23:36 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Tue, 21 Nov 2006 11:23:36 +0100
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing
	kerning settings within a paragraph
Message-ID: <74f506dc0611210223r389f6461s6c0259e18a71b4e3@mail.gmail.com>

Hi Hans,

removing those features is trivial. The question is:

- is it worthwhile to have them, at least with some
  limitations?

- are they already used and hence removing them can cause
  trouble?

AFAIK only Robert Schlicht and Ulrich Dirr have been playing
with them a little bit, but nobody has made any use of those
in serious work. Please correct me if I am wrong.

Of course I am happy to play with those features when luatex
is ready for that.

Thanh

On Sun, Nov 19, 2006 at 11:07:38PM +0100, Hans Hagen wrote:
> Hi Thanh,
> >I think it was not a good decision to introduce those new
> >features, as they touch a very sensitive area of tex and
> >it's hard to get them right. I wonder whether it is better
> >to discard them all.
> >
> removing them is tricky since they may be in use already but don't spend to
> much time on fixing things that are hard to fix in current tex; once luatex
> is in a state where fontdata has no longer the global properties  and where
> we can have more control over font related featurss, you can probably
> rewrite most of the code in a cleaner way
> Hans
>
>
> -----------------------------------------------------------------
>                                          Hans Hagen | PRAGMA ADE
>              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
>     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
>                                             | www.pragma-pod.nl
> -----------------------------------------------------------------
>

From pragma at wxs.nl  Tue Nov 21 11:35:36 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 21 Nov 2006 11:35:36 +0100
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing
 kerning settings within a paragraph
In-Reply-To: <74f506dc0611210223r389f6461s6c0259e18a71b4e3@mail.gmail.com>
References: <74f506dc0611210223r389f6461s6c0259e18a71b4e3@mail.gmail.com>
Message-ID: <4562D678.70803@wxs.nl>

Hi Thanh
>
> removing those features is trivial. The question is:
>
> - is it worthwhile to have them, at least with some
>  limitations?
i think that, since they're in there, they are used; that has always 
been the problem with pdftex being a front runner ... eager users start 
using things; however, we can make a remark that in pdftex 2 these 
features may become obsolete and be replaced by more controllable 
generic mechanisms ; and also a remark that side effects will not be 
dealt with; this permits usage in controlled situations

after all, hz and protruding also have side effects (due to global font 
data) ; users cannot expect wonders from you within the current tex
>
> - are they already used and hence removing them can cause
>  trouble?
>
> AFAIK only Robert Schlicht and Ulrich Dirr have been playing
> with them a little bit, but nobody has made any use of those
> in serious work. Please correct me if I am wrong.
i do support them but i dunno if users use them
>
> Of course I am happy to play with those features when luatex
> is ready for that.
that will be the case in a couple of months (taco is now going to open 
up the font mechanisms)

by that time all font extensions that you made need to be revised anyway 
(hz and protruding and such) , so you'll have a busy future ahead -)

Hans


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From vvv at vsu.ru  Tue Nov 21 14:50:54 2006
From: vvv at vsu.ru (Vladimir Volovich)
Date: Tue, 21 Nov 2006 16:50:54 +0300
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when changing
	kerning settings within a paragraph
In-Reply-To: <4562D678.70803@wxs.nl> (Hans Hagen's message of "Tue\, 21 Nov
	2006 11\:35\:36 +0100")
References: <74f506dc0611210223r389f6461s6c0259e18a71b4e3@mail.gmail.com>
	<4562D678.70803@wxs.nl>
Message-ID: <87vel8c3i9.fsf@vsu.ru>

"HH" == Hans Hagen writes:

 HH> by that time all font extensions that you made need to be revised
 HH> anyway (hz and protruding and such) , so you'll have a busy
 HH> future ahead -)

BTW, i'd like to have a way to set or unset some specific (not
globally for the whole font) ligatures on the fly (without the need to
modify TFM files). is this already possible or planned?

Best,
v.


From taco at elvenkind.com  Tue Nov 21 15:00:24 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 21 Nov 2006 15:00:24 +0100
Subject: [NTG-pdftex] [ pdftex-Bugs-695 ] Confusion when
 changing	kerning settings within a paragraph
In-Reply-To: <87vel8c3i9.fsf@vsu.ru>
References: <74f506dc0611210223r389f6461s6c0259e18a71b4e3@mail.gmail.com>	<4562D678.70803@wxs.nl>
	<87vel8c3i9.fsf@vsu.ru>
Message-ID: <45630678.1040209@elvenkind.com>



Vladimir Volovich wrote:
> "HH" == Hans Hagen writes:
> 
>  HH> by that time all font extensions that you made need to be revised
>  HH> anyway (hz and protruding and such) , so you'll have a busy
>  HH> future ahead -)
> 
> BTW, i'd like to have a way to set or unset some specific (not
> globally for the whole font) ligatures on the fly (without the need to
> modify TFM files). is this already possible or planned?

Possible: not really. Planned: yes, definately.

Taco

From hanthethanh at gmail.com  Wed Nov 22 11:24:02 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Wed, 22 Nov 2006 11:24:02 +0100
Subject: [NTG-pdftex] removal of some extensions -- yes or no?
Message-ID: <74f506dc0611220224u18097b22la316f177abce788d@mail.gmail.com>

Dear list,

I am considering to remove some extensions I added to pdftex
recently, as it's hard to make them work reliably, and they
also seem little useful. In short they are:

,--------
| \pdfadjustinterwordglue, \knbscode, \stbscode, \shbscode:
| adjust the interglue space according to the charater before
| the glue
|
| \pdfprependkern, \knbccode: auto-insertion of a kern before a char
|
| \pdfappendkern, \knaccode: auto-insertion of a kern after a char
`--------

Before I make a decision, I would like to listen to other
opinions. So please let me know what you think of this.

Thanks,
Thanh

From hanthethanh at gmail.com  Wed Nov 22 18:55:05 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Wed, 22 Nov 2006 18:55:05 +0100
Subject: [NTG-pdftex] About the font_max limitation for vf_nf
Message-ID: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>

Hi,

I took a closer look at the problem. vf_nf grows very fast
because vf_nf = <number of vf fonts> * <number of tfm in each vf>
We cannot reduce this, because the number of tfm inside a vf
(let's call it the local tfm) is used to render the
characters inside a vf. Hence pdftex must remember all
local for all vf, which is the above number.

However it seems reasonable to allow the limit to be much
higher than font_max. I will submit a patch soon.

Thanh

On Wed, Nov 22, 2006 at 09:44:10PM +0800, Jie Luo wrote:
> Hi,
>
> There is a GB.tex in the test.tar.bz2 which is a modification of GB.tex
> in CJK package. This file can be compiled with TeXLive. When processing
> this file with pdflatex, the vf_nf value reaches 1978 which is close to
> the present font_max ( = 2000 ). I also attach the log files of another
> two tex documents, hope to be helpful.
>
> Thanks,
>
> Jie
>
> Thanh Han The wrote:
> >Hi,
> >
> >can you please send me a minimal test file so I can
> >reproduce the problem? It is best to use fonts that are
> >available in TeXLive so I can compile it.
> >
> >Thanks,
> >Thanh
> >
> >On Wed, Nov 22, 2006 at 05:38:35PM +0800, Jie Luo wrote:
> >>Hi Thanh,
> >>
> >>Thanh Han The wrote:
> >>>Hi,
> >>>
> >>>I don't know whether this is a bug or not, unless I can
> >>>reproduce the behaviour. You can verify by checking how many
> >>>tfm fonts are opened by pdftex. If the total number of tfm
> >>>fonts is much less than vf_nf, then it's likely a bug.
> >>>However there are a few things to consider:
> >>>
> >>>- tex (and hence pdftex) loads the same tfm for different
> >>> sizes, ef \font\f=cmr10 and  \font\f=cmr10 at 12pt will
> >>> load the tfm twice.
> >>>
> >>>- the same applies for vf. In the above example, if cmr10 is
> >>> a virtual font containing 2 tfm, the number of loaded
> >>> fonts will be 4. So you get the idea how quick it grows.
> >>>
> >>>
> >>>You can use the script I attached to see which fonts have
> >>>been opened during a tex run. Usage:
> >>>
> >>>,--------
> >>>| list-tex-files pdftex foo.tex
> >>>`--------
> >>>
> >>>It will run pdftex and saves the list of opened files into a
> >>>temporary file.
> >>>
> >>>HTH,
> >>>Thanh
> >>
> >>I did some tests using this script.
> >>
> >>GB.tex
> >>vf_nf = 3114
> >>opened tfm files with pdflatex = 408
> >>opened tfm files with latex = 59
> >>
> >>book.tex
> >>vf_nf = 11834
> >>opened tfm files with pdflatex = 1075
> >>opened tfm files with latex = 364
> >>
> >>So it seems that the vf_nf is about 10 times of the opened tfm files,
> >>this maybe a bug. By the way, I do not have the list-tex-files.vim file,
> >>is this a problem?
> >>
> >>Thanks,
> >>
> >>Jie
> >>
> >>>
> >>>On Wed, Nov 22, 2006 at 01:12:56PM +0800, Jie Luo wrote:
> >>>>Hi Thanh,
> >>>>
> >>>>When using pdflatex to processing tex documents contain more than two
> >>>>Chinese GBK virtual fonts, pdflatex always failed with a divide by zero
> >>>>error. I read the mail archive of pdftex list and find it said to be
> >>>>related to the font_max limitation. I add some statement to debug this,
> >>>>and find that the vf_nf value is about 2300 when using two Chinese GBK
> >>>>virtual fonts. But when I use pdflatex to compile a book with about 250
> >>>>pages, the value of vf_nf is about 12000 with less than 100 type1 fonts
> >>>>embedded in the pdf file. Is there any problem with the vf_nf? Or it is
> >>>>the expected value.
> >>>>
> >>>>
> >>>>Jie
> >>>
> >>>------------------------------------------------------------------------
> >>>
> >>>#!/bin/sh
> >>>
> >>>if test "x$1" = x; then
> >>>    echo Usage: "$0 <tex command>"
> >>>    echo Example: "$0 latex myfile"
> >>>    exit 1
> >>>fi
> >>>export KPATHSEA_DEBUG=4
> >>>f=/tmp/kpof.$$.1
> >>>
> >>>$* 2>$f
> >>>vim -S ~/vim/list-tex-files.vim $f
> >>>echo "List of opened files saved to $f"
> >>>
> >>
> >
>

From noreply at sarovar.org  Wed Nov 22 20:52:46 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 23 Nov 2006 01:22:46 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-705 ] Patch to allow vf_nf grow
	dynamically
Message-ID: <E1Gmy9G-0005sP-00@sarovar.org>

Patches item #705, was opened at 2006-11-22 19:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Nobody (None)
Summary: Patch to allow vf_nf grow dynamically

Initial Comment:
This patch allows the array vf_e_fnts and vf_i_fnts
grow dynamically, instead of having fixed size font_max
as currently.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

From noreply at sarovar.org  Thu Nov 23 02:26:33 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 23 Nov 2006 06:56:33 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-705 ] Patch to allow vf_nf grow
	dynamically
Message-ID: <E1Gn3MH-0001gx-00@sarovar.org>

Patches item #705, was opened at 2006-11-23 01:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Nobody (None)
Summary: Patch to allow vf_nf grow dynamically

Initial Comment:
This patch allows the array vf_e_fnts and vf_i_fnts
grow dynamically, instead of having fixed size font_max
as currently.


----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-23 06:56

Message:
Logged In: NO 

Hi!

Does this mean that the bug "SGML output fails with
pdflatex" will also be solved?

Cheers


Danai SAE-HAN

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

From luojie at nlsde.buaa.edu.cn  Thu Nov 23 04:58:22 2006
From: luojie at nlsde.buaa.edu.cn (Jie Luo)
Date: Thu, 23 Nov 2006 11:58:22 +0800
Subject: [NTG-pdftex] About the font_max limitation for vf_nf
In-Reply-To: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>
References: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>
Message-ID: <45651C5E.4010103@nlsde.buaa.edu.cn>

Hi,

I modified you patch to get it apply to tetex-3.0_p1, and change 
font_max back to 2000 in texmf.cnf. Everything is fine now. Thank you 
very much for patch.


Jie

Thanh Han The wrote:
> Hi,
> 
> I took a closer look at the problem. vf_nf grows very fast
> because vf_nf = <number of vf fonts> * <number of tfm in each vf>
> We cannot reduce this, because the number of tfm inside a vf
> (let's call it the local tfm) is used to render the
> characters inside a vf. Hence pdftex must remember all
> local for all vf, which is the above number.
> 
> However it seems reasonable to allow the limit to be much
> higher than font_max. I will submit a patch soon.
> 
> Thanh
> 
> On Wed, Nov 22, 2006 at 09:44:10PM +0800, Jie Luo wrote:
>> Hi,
>>
>> There is a GB.tex in the test.tar.bz2 which is a modification of GB.tex
>> in CJK package. This file can be compiled with TeXLive. When processing
>> this file with pdflatex, the vf_nf value reaches 1978 which is close to
>> the present font_max ( = 2000 ). I also attach the log files of another
>> two tex documents, hope to be helpful.
>>
>> Thanks,
>>
>> Jie
>>
>> Thanh Han The wrote:
>> >Hi,
>> >
>> >can you please send me a minimal test file so I can
>> >reproduce the problem? It is best to use fonts that are
>> >available in TeXLive so I can compile it.
>> >
>> >Thanks,
>> >Thanh
>> >
>> >On Wed, Nov 22, 2006 at 05:38:35PM +0800, Jie Luo wrote:
>> >>Hi Thanh,
>> >>
>> >>Thanh Han The wrote:
>> >>>Hi,
>> >>>
>> >>>I don't know whether this is a bug or not, unless I can
>> >>>reproduce the behaviour. You can verify by checking how many
>> >>>tfm fonts are opened by pdftex. If the total number of tfm
>> >>>fonts is much less than vf_nf, then it's likely a bug.
>> >>>However there are a few things to consider:
>> >>>
>> >>>- tex (and hence pdftex) loads the same tfm for different
>> >>> sizes, ef \font\f=cmr10 and  \font\f=cmr10 at 12pt will
>> >>> load the tfm twice.
>> >>>
>> >>>- the same applies for vf. In the above example, if cmr10 is
>> >>> a virtual font containing 2 tfm, the number of loaded
>> >>> fonts will be 4. So you get the idea how quick it grows.
>> >>>
>> >>>
>> >>>You can use the script I attached to see which fonts have
>> >>>been opened during a tex run. Usage:
>> >>>
>> >>>,--------
>> >>>| list-tex-files pdftex foo.tex
>> >>>`--------
>> >>>
>> >>>It will run pdftex and saves the list of opened files into a
>> >>>temporary file.
>> >>>
>> >>>HTH,
>> >>>Thanh
>> >>
>> >>I did some tests using this script.
>> >>
>> >>GB.tex
>> >>vf_nf = 3114
>> >>opened tfm files with pdflatex = 408
>> >>opened tfm files with latex = 59
>> >>
>> >>book.tex
>> >>vf_nf = 11834
>> >>opened tfm files with pdflatex = 1075
>> >>opened tfm files with latex = 364
>> >>
>> >>So it seems that the vf_nf is about 10 times of the opened tfm files,
>> >>this maybe a bug. By the way, I do not have the list-tex-files.vim 
>> file,
>> >>is this a problem?
>> >>
>> >>Thanks,
>> >>
>> >>Jie
>> >>
>> >>>
>> >>>On Wed, Nov 22, 2006 at 01:12:56PM +0800, Jie Luo wrote:
>> >>>>Hi Thanh,
>> >>>>
>> >>>>When using pdflatex to processing tex documents contain more than two
>> >>>>Chinese GBK virtual fonts, pdflatex always failed with a divide by 
>> zero
>> >>>>error. I read the mail archive of pdftex list and find it said to be
>> >>>>related to the font_max limitation. I add some statement to debug 
>> this,
>> >>>>and find that the vf_nf value is about 2300 when using two Chinese 
>> GBK
>> >>>>virtual fonts. But when I use pdflatex to compile a book with 
>> about 250
>> >>>>pages, the value of vf_nf is about 12000 with less than 100 type1 
>> fonts
>> >>>>embedded in the pdf file. Is there any problem with the vf_nf? Or 
>> it is
>> >>>>the expected value.
>> >>>>
>> >>>>
>> >>>>Jie
>> >>>
>> >>>------------------------------------------------------------------------ 
>>
>> >>>
>> >>>#!/bin/sh
>> >>>
>> >>>if test "x$1" = x; then
>> >>>    echo Usage: "$0 <tex command>"
>> >>>    echo Example: "$0 latex myfile"
>> >>>    exit 1
>> >>>fi
>> >>>export KPATHSEA_DEBUG=4
>> >>>f=/tmp/kpof.$$.1
>> >>>
>> >>>$* 2>$f
>> >>>vim -S ~/vim/list-tex-files.vim $f
>> >>>echo "List of opened files saved to $f"
>> >>>
>> >>
>> >
>>
> 



From frank at debian.org  Thu Nov 23 07:49:36 2006
From: frank at debian.org (Frank =?iso-8859-1?Q?K=FCster?=)
Date: Thu, 23 Nov 2006 07:49:36 +0100
Subject: [NTG-pdftex] About the font_max limitation for vf_nf
In-Reply-To: <45651C5E.4010103@nlsde.buaa.edu.cn> (Jie Luo's message of "Thu\,
	23 Nov 2006 11\:58\:22 +0800")
References: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>
	<45651C5E.4010103@nlsde.buaa.edu.cn>
Message-ID: <8664d6odxb.fsf@alhambra.kuesterei.ch>

Jie Luo <luojie at nlsde.buaa.edu.cn> wrote:

> Hi,
>
> I modified you patch to get it apply to tetex-3.0_p1, and change 
> font_max back to 2000 in texmf.cnf. Everything is fine now. Thank you 
> very much for patch.

Ah, great - can you publish this modified patch?

Thanks in advance, Frank
-- 
Dr. Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX/TeXLive)

From noreply at sarovar.org  Thu Nov 23 08:18:53 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 23 Nov 2006 12:48:53 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-705 ] Patch to allow vf_nf grow
	dynamically
Message-ID: <E1Gn8rF-00022G-00@sarovar.org>

Patches item #705, was opened at 2006-11-22 19:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Nobody (None)
Summary: Patch to allow vf_nf grow dynamically

Initial Comment:
This patch allows the array vf_e_fnts and vf_i_fnts
grow dynamically, instead of having fixed size font_max
as currently.


----------------------------------------------------------------------

>Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-23 07:18

Message:
Logged In: YES 
user_id=710

yes. this patch also contains a fix by Akira the segfault
bug (one line added) and a fix for bug #692 (another line).
It's not hard to fix bug #694 and #696 too. However I didn't
mention them, as I am considering to remove the relevant code.

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-23 01:26

Message:
Logged In: NO 

Hi!

Does this mean that the bug "SGML output fails with
pdflatex" will also be solved?

Cheers


Danai SAE-HAN

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

From luojie at nlsde.buaa.edu.cn  Thu Nov 23 09:27:57 2006
From: luojie at nlsde.buaa.edu.cn (Jie Luo)
Date: Thu, 23 Nov 2006 16:27:57 +0800
Subject: [NTG-pdftex] About the font_max limitation for vf_nf
In-Reply-To: <8664d6odxb.fsf@alhambra.kuesterei.ch>
References: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>	<45651C5E.4010103@nlsde.buaa.edu.cn>
	<8664d6odxb.fsf@alhambra.kuesterei.ch>
Message-ID: <45655B8D.3030806@nlsde.buaa.edu.cn>

Frank K?ster wrote:
> Jie Luo <luojie at nlsde.buaa.edu.cn> wrote:
> 
>> Hi,
>>
>> I modified you patch to get it apply to tetex-3.0_p1, and change 
>> font_max back to 2000 in texmf.cnf. Everything is fine now. Thank you 
>> very much for patch.
> 
> Ah, great - can you publish this modified patch?
> 
> Thanks in advance, Frank

Attached.


Jie
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: tetex-3.0_p1-pdftex.patch
Url: http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20061123/9af8414f/attachment.asc 

From frank at debian.org  Fri Nov 24 09:06:15 2006
From: frank at debian.org (Frank =?iso-8859-1?Q?K=FCster?=)
Date: Fri, 24 Nov 2006 09:06:15 +0100
Subject: [NTG-pdftex] About the font_max limitation for vf_nf
In-Reply-To: <45655B8D.3030806@nlsde.buaa.edu.cn> (Jie Luo's message of "Thu\,
	23 Nov 2006 16\:27\:57 +0800")
References: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>
	<45651C5E.4010103@nlsde.buaa.edu.cn>
	<8664d6odxb.fsf@alhambra.kuesterei.ch>
	<45655B8D.3030806@nlsde.buaa.edu.cn>
Message-ID: <864pspz2tk.fsf@alhambra.kuesterei.ch>

Jie Luo <luojie at nlsde.buaa.edu.cn> wrote:

> Frank K?ster wrote:
>> Jie Luo <luojie at nlsde.buaa.edu.cn> wrote:
>>
>>> Hi,
>>>
>>> I modified you patch to get it apply to tetex-3.0_p1, and change
>>> font_max back to 2000 in texmf.cnf. Everything is fine now. Thank
>>> you very much for patch.
>>
>> Ah, great - can you publish this modified patch?
>>
>> Thanks in advance, Frank
>
> Attached.

Thank you!  

Hm, I get a compilation error:

./tangle pdftex.web pdftex.ch
This is TANGLE, Version 4.5 (Web2C 7.5.4)
*1*17*25*38*54*72*99*110*115*133*162*173*199*203*207*211*220*256*268*289*297*300*321*332*366*402*464*487*511*539*583*592*644*652*664*666*673*696*779*819*838*858*907*952*1001*1030*1039*1058*1081*1106*1119*1168*1194*1275*1347*1438*1469*1477*1479*1577*1586*1588*1600*1609*1612
Writing the output file.....500.....1000.....1500.....2000.....2500.....3000.....3500.....4000.....4500.....5000.....5500.....6000.....6500.....7000.....7500.....8000.....8500.....9000.....9500...
Done.
1468 strings written to string pool file.
(No errors were found.)
srcdir=. /bin/sh ./web2c/convert pdftex
syntax error: Last token = 292 ($), error buffer = `allocvffnts',
	last id = `allocvffnts' (parameterless procedure).
./web2c/splitup: fatal: No #include pdftexcoerce.h line.
./web2c/convert: conversion of pdftex.p failed, moving dregs:
./web2c/convert:   mv pdftex[0-9].c pdftexini.c pdftexd.h pdftexcoerce.h /tmp
mv: cannot stat `pdftex[0-9].c': No such file or directory
mv: cannot stat `pdftexini.c': No such file or directory



This is the Debian package of
tetex-src_3.0.tar.gz, with some patches applied.  These patches are
available at

svn//svn.debian.org/svn/debian-tex/tetex-bin/trunk/debian/patches

unfortunately the web interface at
http://svn.debian.org/wsvn/debian-tex/tetex-bin/trunk/debian/patches/
seems to be down at the moment.  The only patch that I think is
interesting is patch-poppler, hm.

Any ideas what's going on?

Regards, Frank
-- 
Dr. Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX/TeXLive)

From hanthethanh at gmail.com  Fri Nov 24 10:55:42 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Fri, 24 Nov 2006 10:55:42 +0100
Subject: [NTG-pdftex] status of pending bugs
Message-ID: <74f506dc0611240155r496b9fe0x812aa8d058634b14@mail.gmail.com>

Hi,

it seems that it's too late now to remove some extensions.
Though it's trivial to do so regards coding, the impact
might be undesired so it is better to do that after TL has
been released.

So at the meantime I will try to fix some of the pending
bugs. Here is the current status:

692, 694: fixed
693: still trying
695: unlikely to be fixed, even in the future.
696: Harmut and I are working on this, we hope to fix it
during the wekend.

Thanh

From frank at debian.org  Fri Nov 24 15:24:15 2006
From: frank at debian.org (Frank =?iso-8859-1?Q?K=FCster?=)
Date: Fri, 24 Nov 2006 15:24:15 +0100
Subject: [NTG-pdftex] About the font_max limitation for vf_nf
In-Reply-To: <45655B8D.3030806@nlsde.buaa.edu.cn> (Jie Luo's message of "Thu\,
	23 Nov 2006 16\:27\:57 +0800")
References: <74f506dc0611220955y64ede1a3m74ad86af569b44ac@mail.gmail.com>
	<45651C5E.4010103@nlsde.buaa.edu.cn>
	<8664d6odxb.fsf@alhambra.kuesterei.ch>
	<45655B8D.3030806@nlsde.buaa.edu.cn>
Message-ID: <86y7q0c48g.fsf@alhambra.kuesterei.ch>

Jie Luo <luojie at nlsde.buaa.edu.cn> wrote:

> Frank K?ster wrote:
>> Jie Luo <luojie at nlsde.buaa.edu.cn> wrote:
>>
>>> Hi,
>>>
>>> I modified you patch to get it apply to tetex-3.0_p1, and change
>>> font_max back to 2000 in texmf.cnf. Everything is fine now. Thank
>>> you very much for patch.
>>
>> Ah, great - can you publish this modified patch?
>>
>> Thanks in advance, Frank
>
> Attached.

And of course this patch does work.  I had leftovers from previous tries
still there.  Sorry for the noise, and thanks again,

Frank

-- 
Dr. Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX/TeXLive)

From noreply at sarovar.org  Sat Nov 25 10:58:43 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Sat, 25 Nov 2006 15:28:43 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-705 ] Patch to allow vf_nf grow
	dynamically
Message-ID: <E1GnuJ1-0005a1-00@sarovar.org>

Patches item #705, was opened at 2006-11-23 01:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Nobody (None)
Summary: Patch to allow vf_nf grow dynamically

Initial Comment:
This patch allows the array vf_e_fnts and vf_i_fnts
grow dynamically, instead of having fixed size font_max
as currently.


----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-25 15:28

Message:
Logged In: NO 

Hi!

It's been applied on Debian/unstable, and it works!
Top notch!

Thanks


Danai SAE-HAN

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-23 12:48

Message:
Logged In: YES 
user_id=710

yes. this patch also contains a fix by Akira the segfault
bug (one line added) and a fix for bug #692 (another line).
It's not hard to fix bug #694 and #696 too. However I didn't
mention them, as I am considering to remove the relevant code.

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-23 06:56

Message:
Logged In: NO 

Hi!

Does this mean that the bug "SGML output fails with
pdflatex" will also be solved?

Cheers


Danai SAE-HAN

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

From noreply at sarovar.org  Sun Nov 26 21:01:07 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 27 Nov 2006 01:31:07 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-705 ] Patch to allow vf_nf grow
	dynamically
Message-ID: <E1GoQBX-0000fZ-00@sarovar.org>

Patches item #705, was opened at 2006-11-22 20:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

>Category: Fonts
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
>Assigned to: Hartmut Henkel (hhenkel)
Summary: Patch to allow vf_nf grow dynamically

Initial Comment:
This patch allows the array vf_e_fnts and vf_i_fnts
grow dynamically, instead of having fixed size font_max
as currently.


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-26 21:01

Message:
Logged In: YES 
user_id=421

This has been included in version 1.40

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-25 10:58

Message:
Logged In: NO 

Hi!

It's been applied on Debian/unstable, and it works!
Top notch!

Thanks


Danai SAE-HAN

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-23 08:18

Message:
Logged In: YES 
user_id=710

yes. this patch also contains a fix by Akira the segfault
bug (one line added) and a fix for bug #692 (another line).
It's not hard to fix bug #694 and #696 too. However I didn't
mention them, as I am considering to remove the relevant code.

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-23 02:26

Message:
Logged In: NO 

Hi!

Does this mean that the bug "SGML output fails with
pdflatex" will also be solved?

Cheers


Danai SAE-HAN

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

From noreply at sarovar.org  Sun Nov 26 21:02:05 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 27 Nov 2006 01:32:05 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-705 ] Patch to allow vf_nf grow
	dynamically
Message-ID: <E1GoQCT-0000j8-00@sarovar.org>

Patches item #705, was opened at 2006-11-22 20:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

Category: Fonts
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Hartmut Henkel (hhenkel)
Summary: Patch to allow vf_nf grow dynamically

Initial Comment:
This patch allows the array vf_e_fnts and vf_i_fnts
grow dynamically, instead of having fixed size font_max
as currently.


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-11-26 21:01

Message:
Logged In: YES 
user_id=421

This has been included in version 1.40

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-25 10:58

Message:
Logged In: NO 

Hi!

It's been applied on Debian/unstable, and it works!
Top notch!

Thanks


Danai SAE-HAN

----------------------------------------------------------------------

Comment By: The Thanh Han (hanthethanh)
Date: 2006-11-23 08:18

Message:
Logged In: YES 
user_id=710

yes. this patch also contains a fix by Akira the segfault
bug (one line added) and a fix for bug #692 (another line).
It's not hard to fix bug #694 and #696 too. However I didn't
mention them, as I am considering to remove the relevant code.

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-11-23 02:26

Message:
Logged In: NO 

Hi!

Does this mean that the bug "SGML output fails with
pdflatex" will also be solved?

Cheers


Danai SAE-HAN

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=705&group_id=106

