From frank at debian.org  Thu Feb  2 17:53:03 2006
From: frank at debian.org (=?iso-8859-1?q?Frank_K=FCster?=)
Date: Thu, 02 Feb 2006 17:53:03 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
Message-ID: <86psm5og7k.fsf@alhambra.kuesterei.ch>

Hi,

I've worked on the patch originally proposed at

http://sarovar.org/tracker/index.php?func=detail&aid=474&group_id=106&atid=495

I have rewritten the changes to the source files, so that they continue
to use the xpdf code copy in the source tree and only use libpoppler if
the compiler (or rather preprocessor) is called with -DPOPPLER.  This
version is attached.

The harder part is the autoconf magic required for the switching, and
not even writing autoconf (at least not yet), but rather incorporating
the changes:

On my system, "./reautoconf" does not work, instead complains:

autoconf: invalid option -m


I have

$ autoconf --version
autoconf (GNU Autoconf) 2.59
Written by David J. MacKenzie and Akim Demaille.

Copyright (C) 2003 Free Software Foundation, Inc.

Or is there a different way to regenerate configure after changes to its
source files?

TIA, Frank
-- 
Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: poppler_src.patch
Type: text/x-patch
Size: 4427 bytes
Desc: not available
Url : http://www.ntg.nl/pipermail/ntg-pdftex/attachments/20060202/6e952a91/attachment.bin 

From noreply at sarovar.org  Thu Feb  9 18:08:11 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 09 Feb 2006 22:38:11 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-479 ] Nested annotations
Message-ID: <E1F7FH9-0003VN-00@sarovar.org>

Bugs item #479, was opened at 2006-02-09 18:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=479&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Nobody (None)
Summary: Nested annotations

Initial Comment:
Hello,

Dario Teixeira reported a problem on the pdfTeX
mailing list:

> I have come across an interesting issue with hyperref
> and pdftex.  Whenever one hyperlink is nested inside 
> another, the entire remainder of the line is shown
> as an hyperlink.
> 
> If you are wondering why on earth would someone want
> to have nested hyperlinks, please take a look at this
> sample document I created; it also displays the
"feature":
> http://www.dse.nl/~dario/misc/nestedlinks.pdf  [50KB]

I consider this as bug in pdfTeX and have
generated a small test file (plain format):

\showboxbreadth=\maxdimen
\showboxdepth=\maxdimen
[part before]
\pdfstartlink goto name{Hello}
[hello start
  \pdfstartlink attr{/C[1 0 0]} goto name{World}
  [inside world]%
  \pdfendlink\space
stop]%
\pdfendlink\space
[part after]\par
\showlists  

\vfill\eject
\pdfdest name{Hello}XYZ\relax
Hello
\vfill\eject
\pdfdest name{World}XYZ\relax
World
\end

Three annotations are generated by pdfTeX 1.30.4:

7 0 obj <<
/Type /Annot
/Rect [148.989 757.436 540 767.399]
/Subtype /Link
/A << /S /GoTo /D (Hello) >>
>> endobj
8 0 obj <<
/Type /Annot
/C[1 0 0] 
/Rect [199.439 757.436 257.361 767.399]
/Subtype /Link
/A << /S /GoTo /D (World) >>
>> endobj
9 0 obj <<
/Type /Annot
/Rect [257.361 757.436 281.769 767.399]
/Subtype /Link
/A << /S /GoTo /D (Hello) >>
>> endobj

Either there should be two overlapping
annotations or three distinct ones.
At any case "540" in the first rect is too large.

As workaround, the outer/enclosing annotation
can put into a box (\hbox in plain TeX, \mbox
in LaTeX). But it does not solve the problem,
because now the link cannot be broken across
lines.

Therefore the algorithm for annotations needs
to be reviewed and corrected.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=479&group_id=106

From hartmut_henkel at gmx.de  Thu Feb  9 20:13:26 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu, 9 Feb 2006 20:13:26 +0100 (CET)
Subject: [NTG-pdftex] Fly high, pay low.
Message-ID: <Pine.LNX.4.61.0602092010520.3805@hahepc2.hahe>

Title:          Buchungsbest?tigung / Rechnung - Germanwings
Subject:        Buchungscode / Rechnungsnummer: ******
Keywords:       Germanwings Buchungscode Buchungsbest?tigung Rechnungsnummer Rechnung
Author:         Germanwings GmbH
Creator:        pdfTeX-1.10b, LaTeX with hyperref
Producer:       alogis booking notification system 1.01, Holger Kipp
CreationDate:   Thu Feb  9 10:24:00 2006
Tagged:         no
Pages:          3
Encrypted:      no
Page size:      595.276 x 839.055 pts
File size:      37096 bytes
Optimized:      no
PDF version:    1.4

From P.Jackowski at gust.org.pl  Thu Feb  9 22:20:23 2006
From: P.Jackowski at gust.org.pl (=?ISO-8859-2?Q?Pawe=B3_Jackowski?=)
Date: Thu, 09 Feb 2006 22:20:23 +0100
Subject: [NTG-pdftex] \type{...} problem with manual
Message-ID: <43EBB217.9060603@gust.org.pl>

Hi Hans,

I'm trying to compile pdfTeX manual with ConTeXt ver 2005.10.27, 
pdfeTeXk 1.30.3 taken from from tl. I get


! Missing number, treated as zero.
<to be read again>
                    }
\tabulatecontent ...NR \HL \NC \type {\pdfoutput }
                                                    \NC integer \NC 0 
\NC \DV...

\fulltabulatecontent ...dcontent \tabulatecontent
                                                   \tabulatetailcontent 
\remo...

\processtabulate ...sa \crcr \fulltabulatecontent
                                                   \crcr }}\ifnum 
\nofautotab...
l.27 \stoptabulate


while reading pdftex-t-pdftex-t.tmp buffer. It looks like \type returns 
its parameter without decatcoding. The same while trying to compile just 
this table wrappend with \starttext ...\stoptext. Following 'cvs log -- 
pdftex-t.tex' I was suspecting  myself for spoiling the manual sources 
but have not clue how and where. Have you?

-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From pragma at wxs.nl  Fri Feb 10 00:25:39 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 10 Feb 2006 00:25:39 +0100
Subject: [NTG-pdftex] \type{...} problem with manual
In-Reply-To: <43EBB217.9060603@gust.org.pl>
References: <43EBB217.9060603@gust.org.pl>
Message-ID: <43EBCF73.8090908@wxs.nl>

? wrote:
> Hi Hans,
>
> I'm trying to compile pdfTeX manual with ConTeXt ver 2005.10.27, 
> pdfeTeXk 1.30.3 taken from from tl. I get
>
>
> ! Missing number, treated as zero.
> <to be read again>
>                     }
> \tabulatecontent ...NR \HL \NC \type {\pdfoutput }
>                                                     \NC integer \NC 0 
> \NC \DV...
>
> \fulltabulatecontent ...dcontent \tabulatecontent
>                                                    \tabulatetailcontent 
> \remo...
>
> \processtabulate ...sa \crcr \fulltabulatecontent
>                                                    \crcr }}\ifnum 
> \nofautotab...
> l.27 \stoptabulate
>
>
> while reading pdftex-t-pdftex-t.tmp buffer. It looks like \type returns 
> its parameter without decatcoding. The same while trying to compile just 
> this table wrappend with \starttext ...\stoptext. Following 'cvs log -- 
> pdftex-t.tex' I was suspecting  myself for spoiling the manual sources 
> but have not clue how and where. Have you?
>   
normnally type handles this, but in tables args are passed, use \tex{pdfoutput} instead 

Hans 


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From reinhard.kotucha at web.de  Fri Feb 10 02:40:25 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Fri, 10 Feb 2006 02:40:25 +0100
Subject: [NTG-pdftex] Fly high, pay low.
In-Reply-To: <Pine.LNX.4.61.0602092010520.3805@hahepc2.hahe>
References: <Pine.LNX.4.61.0602092010520.3805@hahepc2.hahe>
Message-ID: <17387.61193.197456.882812@zarniwoop.ms25.local>

>>>>> "Hartmut" == Hartmut Henkel <hartmut_henkel at gmx.de> writes:

  > Title: Buchungsbest?tigung / Rechnung - Germanwings

"Deutsche Telekom", Germany's biggest telephone company uses pdfTeX
as well to create invoices on-the-fly.

This is quite old, I changed the provider some time ago:

Title:          Deutsche Telekom Rechnung Online
Subject:        
Keywords:       
Author:         Deutsche Telekom. EK5 REO J.Lee
Creator:        TeX
Producer:       pdfTeX-0.13d
CreationDate:   Tue Aug 12 21:27:00 2003
Tagged:         no
Pages:          3
Encrypted:      yes (print:yes copy:no change:no addNotes:no)
Page size:      595.273 x 841.887 pts (A4)
File size:      76638 bytes
Optimized:      yes
PDF version:    1.2


I'm wondering about "Optimized: yes".  Is there a program which
optimizes PDF and leaves the Creator/Producer fields untouched?


A few years ago someone reported that "Deutsche Bahn AG", German's
biggest railway company creates customized time tables using pdfTeX.

Creator:        TeX
Producer:       pdfTeX-0.14h
CreationDate:   Fri Feb 10 01:57:00 2006
Tagged:         no
Pages:          2
Encrypted:      no
Page size:      595.276 x 841.89 pts (A4)
File size:      99101 bytes
Optimized:      no
PDF version:    1.3


The program had been written by HaCon, a company here in Hannover.  It
seems that their product is a big success.  Today, there are many
companies in Europe using this program.  See

  http://www.hacon.de/hafas/www.shtml

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------



From taco at elvenkind.com  Fri Feb 10 08:48:54 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 10 Feb 2006 08:48:54 +0100
Subject: [NTG-pdftex] \type{...} problem with manual
In-Reply-To: <43EBB217.9060603@gust.org.pl>
References: <43EBB217.9060603@gust.org.pl>
Message-ID: <43EC4566.4090302@elvenkind.com>

Pawe? Jackowski wrote:
> Hi Hans,
> 
> I'm trying to compile pdfTeX manual with ConTeXt ver 2005.10.27, 

IIRC, this problem goes away if you update your ConTeXt.

Cheers, Taco

From P.Jackowski at gust.org.pl  Fri Feb 10 09:19:47 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Fri, 10 Feb 2006 09:19:47 +0100
Subject: [NTG-pdftex] \type{...} problem with manual
In-Reply-To: <43EC4566.4090302@elvenkind.com>
References: <43EBB217.9060603@gust.org.pl> <43EC4566.4090302@elvenkind.com>
Message-ID: <43EC4CA3.9000605@gust.org.pl>

> IIRC, this problem goes away if you update your ConTeXt.

works fine after update. thanks.
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From hutch at psfc.mit.edu  Sat Feb 11 05:16:13 2006
From: hutch at psfc.mit.edu (hutch at psfc.mit.edu)
Date: Fri, 10 Feb 2006 23:16:13 -0500 (EST)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
Message-ID: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>

---------- Forwarded message ----------
Date: Fri, 10 Feb 2006 23:07:36 -0500 (EST)
From: hutch at psfc.mit.edu
To: tetex at dbs.uni-hannover.de
Subject: Bug in pdftex. Fixed by attached pdftex.ini

In tetex-3... pdftex has a serious bug. Any plain tex file that uses
\magnification gives incorrect text placement in pdf. This bug is present
in the latest pdftex version 1.21a. It apparently was caused by the
introduction of the new variables \pdfvoffset and \pdfhoffset. This bug
was not present in older pdftex, e.g. version 3.14159-1.10b, which was
part of tetex-2...

A simple illustration of the problem is with the trivial file:

\magnification \magstep3
%The following parindent and offset changes are not the cause of errors.
%They are merely to illustrate them clearly by writing at top left.
%Anything other than \magstep0 gives a placement error with pdftex 1.21a.
\parindent 0pt
\hoffset -1 truein
\voffset -1 truein
The top.
\end

With tex and xdvi, the words "The top." are placed at the immediate top
left. With pdftex 1.21a and xpdf (or acroread) they are not. With earlier
pdftex 1.10b (e.g.) they are.

I had an extensive discussion on comp.text.tex with Heiko Oberdiek, most
of which is at http://www.codecomments.com/Tex/message784423.html

The gist of it is that backward compatibility with plain tex files is very
important. As far as possible, it should be preserved transparently.
Authors should not be required to hack their files in order for them to
render the same in pdf as in dvi. Moreover there is a simple way to
provide this compatibility.

A reasonable way to fix the bug is to change pdftex.ini and hence
pdftex.fmt. (The corresponding pdfetex files ought also to be fixed.)

A proposed patched pdftex.ini file is attached. It consists simply of

% Thomas Esser, 1998, 2004. public domain.
\ifx\pdfoutput\undefined
\else
  \ifx\pdfoutput\relax
  \else
    \input pdftexconfig
    \pdfoutput=1
  \fi
\fi

\input plain

\ifx\pdfoutput\undefined
\else
  \ifx\pdfoutput\relax
  \else
\catcode`@=11
\def\m at g{%
\mag\count@
\hsize6.5truein\vsize8.9truein\dimen\footins8truein
%These commands fix the pdf sizes to be in true units.
\mag at fix\pdfhorigin \mag at fix\pdfvorigin
\mag at fix\pdfpagewidth \mag at fix\pdfpageheight
}
\def\mag at fix#1{%
 #1=\expandafter\convert at truept\the#1\relax
}
\begingroup
\catcode`P=12
\catcode`T=12
\lowercase{%
\endgroup
\def\convert at truept#1PT{%
#1truept%
}%
}%
\catcode`@=12
  \fi
\fi

\dump
\endinput

I don't know who takes responsibility for pdftex.ini. But clearly this
ought to be fixed for all distributions. I care most about tetex, because
it is what I use. Thanks,

	Ian Hutchinson
	http://www.psfc.mit.edu/people/hutch/
-------------- next part --------------
% Thomas Esser, 1998, 2004. public domain.
\ifx\pdfoutput\undefined
\else
  \ifx\pdfoutput\relax
  \else
    \input pdftexconfig
    \pdfoutput=1
  \fi
\fi

\input plain

\ifx\pdfoutput\undefined
\else
  \ifx\pdfoutput\relax
  \else
\catcode`@=11
\def\m at g{%
\mag\count@
\hsize6.5truein\vsize8.9truein\dimen\footins8truein
%These commands fix the pdf sizes to be in true units.
\mag at fix\pdfhorigin \mag at fix\pdfvorigin
\mag at fix\pdfpagewidth \mag at fix\pdfpageheight
}
\def\mag at fix#1{%
 #1=\expandafter\convert at truept\the#1\relax
}
\begingroup
\catcode`P=12
\catcode`T=12
\lowercase{%
\endgroup
\def\convert at truept#1PT{%
#1truept%
}%
}%
\catcode`@=12
  \fi
\fi

\dump
\endinput

From hartmut_henkel at gmx.de  Sat Feb 11 10:05:18 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sat, 11 Feb 2006 10:05:18 +0100 (CET)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
Message-ID: <Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>

On Fri, 10 Feb 2006 hutch at psfc.mit.edu wrote:

> %These commands fix the pdf sizes to be in true units.
> \mag at fix\pdfhorigin \mag at fix\pdfvorigin
> \mag at fix\pdfpagewidth \mag at fix\pdfpageheight

if this patch should be implemented at all (the current way is much
cleaner and more intuitive, as e. g. \pdfhorigin is handled naturally
like any other TeX dimension, after the description in the TeXbook) then
one should not forget that the list is not complete: There is also
\pdflinkmargin, \pdfdestmargin, and \pdfthreadmargin to be modified.

Regards, Hartmut

From hartmut_henkel at gmx.de  Sat Feb 11 10:23:21 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sat, 11 Feb 2006 10:23:21 +0100 (CET)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
	<Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>
Message-ID: <Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>

On Sat, 11 Feb 2006, Hartmut Henkel wrote:

> On Fri, 10 Feb 2006 hutch at psfc.mit.edu wrote:
>
> > %These commands fix the pdf sizes to be in true units.
> > \mag at fix\pdfhorigin \mag at fix\pdfvorigin
> > \mag at fix\pdfpagewidth \mag at fix\pdfpageheight
>
> if this patch should be implemented at all (the current way is much
> cleaner and more intuitive, as e. g. \pdfhorigin is handled naturally
> like any other TeX dimension, after the description in the TeXbook) then
> one should not forget that the list is not complete: There is also
> \pdflinkmargin, \pdfdestmargin, and \pdfthreadmargin to be modified.

...and the sentence in the pdftex manual

"Or, you can preadjust the \type{\pdfhorigin} value before typing
\type{\mag}, so that its value after the \type{\mag} command ends up at
1~true inch again."

would be wrong as then there would be a double-"correction". Any users
having used this tip would wonder about suddenly wrong dimensions. I'll
have to check my posters...

Regards, Hartmut



From hutch at psfc.mit.edu  Sat Feb 11 17:04:34 2006
From: hutch at psfc.mit.edu (Ian Hutchinson)
Date: Sat, 11 Feb 2006 11:04:34 -0500 (EST)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
	<Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>
	<Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>
Message-ID: <Pine.LNX.4.63.0602111053030.14010@tex2html.net>


On Sat, 11 Feb 2006, Hartmut Henkel wrote:
>> On Fri, 10 Feb 2006 hutch at psfc.mit.edu wrote:
>>
>>> %These commands fix the pdf sizes to be in true units.
>>> \mag at fix\pdfhorigin \mag at fix\pdfvorigin
>>> \mag at fix\pdfpagewidth \mag at fix\pdfpageheight
>>
>> if this patch should be implemented at all (the current way is much
>> cleaner and more intuitive, as e. g. \pdfhorigin is handled naturally
>> like any other TeX dimension, after the description in the TeXbook) then
>> one should not forget that the list is not complete: There is also
>> \pdflinkmargin, \pdfdestmargin, and \pdfthreadmargin to be modified.
>

It is not clear to me that those extra dimensions need to be fixed, 
although it might be good. What is vital is that plain documents that 
don't have reference to pdftex dimensions should still render properly in 
pdf, as they used to do in earlier pdftex versions.

The patch does not affect "the current way" at all, as far as I can see. 
It simply corrects erroneous values that arise when magnification is used 
because they have not been expressed in true units. It also won't affect 
latex documents which don't use the pdf[e]tex.ini formats.

> ...and the sentence in the pdftex manual
>
> "Or, you can preadjust the \type{\pdfhorigin} value before typing
> \type{\mag}, so that its value after the \type{\mag} command ends up at
> 1~true inch again."

This "tip", is of course an acknowledgement that without the patch, pdftex 
has broken all plain tex files with magnification. The point of the patch 
is to remove the necessity for authors/users to worry about the fact that 
\magnification is broken: because then it isn't! So the manual should 
presumably simply drop the tip.

>
> would be wrong as then there would be a double-"correction". Any users
> having used this tip would wonder about suddenly wrong dimensions. I'll
> have to check my posters...

Ian Hutchinson

From taco at elvenkind.com  Sun Feb 12 11:39:44 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 12 Feb 2006 11:39:44 +0100
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <Pine.LNX.4.63.0602111053030.14010@tex2html.net>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>	<Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>	<Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>
	<Pine.LNX.4.63.0602111053030.14010@tex2html.net>
Message-ID: <43EF1070.9060502@elvenkind.com>

Ian Hutchinson wrote:
> 
> It is not clear to me that those extra dimensions need to be fixed, 
> although it might be good. What is vital is that plain documents that 
> don't have reference to pdftex dimensions should still render properly in 
> pdf, as they used to do in earlier pdftex versions.

The discussion on c.t.t. about this went along the same lines, and
the main problem is that documents that use \magnification are
inherently flawed. The DVI format (i.e. TeX) claims not to know about
physical page dimensions; but at the same time it does allow you to
shift and scale the content of the physical output plane. There is an
inherent conflict there. Pdftex brings this in the spotlight because
the PDF format does have a physical page, and its offsets needs to be
specified.

The magnification scaling stuff was nice when all we had was bitmapped
fonts, but I believe anybody who still uses it in this day and age
should be hit on the head with the PostScript or PDF specification
(repeatedly).

That said, I believe this patch is not really a bad idea, but one
should change the formats name at the same time (it wouldnt be
just plain.tex anymore)

I thought these .ini files are maintained by the tex-live crew, btw?

Cheers, Taco

From hutch at psfc.mit.edu  Sun Feb 12 14:41:00 2006
From: hutch at psfc.mit.edu (Ian Hutchinson)
Date: Sun, 12 Feb 2006 08:41:00 -0500 (EST)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <43EF1070.9060502@elvenkind.com>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
	<Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>
	<Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>
	<Pine.LNX.4.63.0602111053030.14010@tex2html.net>
	<43EF1070.9060502@elvenkind.com>
Message-ID: <Pine.LNX.4.63.0602120816200.23543@tex2html.net>


On Sun, 12 Feb 2006, Taco Hoekwater wrote:

> The discussion on c.t.t. about this went along the same lines, and
> the main problem is that documents that use \magnification are
> inherently flawed. The DVI format (i.e. TeX) claims not to know about
> physical page dimensions; but at the same time it does allow you to
> shift and scale the content of the physical output plane. There is an
> inherent conflict there. Pdftex brings this in the spotlight because
> the PDF format does have a physical page, and its offsets needs to be
> specified.

I don't know where you get the idea that dvi does not know anything about 
page dimensions. It is clearly quite erroneous. TeX itself does specify 
its offsets, and dvips etc specify their pages sizes in accordance with 
settings that need to be compatible with the extent of the text (i.e. 
\hsize, \vsize).

>
> The magnification scaling stuff was nice when all we had was bitmapped
> fonts, but I believe anybody who still uses it in this day and age
> should be hit on the head with the PostScript or PDF specification
> (repeatedly).

This comment, like many from others, misses the point. TeX is an archival 
representation of scientific documents. That is a major strength. TeX is 
not just a computer tool for producing new documents. You undermine the 
value of TeX if you abandon for no reason backward compatibility. Your 
opinions or those of others about the advisability of using magnification 
for new documents are not the issue at hand. Nothing in the patch I have 
offered affects any document that follows your advice and does not use 
magnification. The patch simply fixes those that do use it, whether new or 
old.

I won't argue with opinionated pronouncements about features of TeX that 
appear redundant or troublesome. I could make pronouncements of my own 
about other such features. However, I will continue to say loudly, that 
until a patch like this is applied, the latest version of pdftex has 
broken plain tex files for no good reason. That is a bad thing, and since 
the fix is so easy, it should be fixed ASAP.

>
> That said, I believe this patch is not really a bad idea, but one
> should change the formats name at the same time (it wouldnt be
> just plain.tex anymore)
>

The format I have proposed to patch is not plain, but pdftex.ini. The
plain.fmt never enters into consideration. plain is not being patched. A 
pdftex-specific file is being patched.


Ian Hutchinson

From martin at oneiros.de  Sun Feb 12 15:22:21 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Sun, 12 Feb 2006 15:22:21 +0100
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
Message-ID: <20060212142221.GI8426@lucien.oneiros.kn-bremen.de>

On 2006-02-10 23:16:13 -0500, hutch at psfc.mit.edu wrote:
> I had an extensive discussion on comp.text.tex with Heiko Oberdiek, most
> of which is at http://www.codecomments.com/Tex/message784423.html

ANOTHER forum. :-(

Is it so difficult to follow the instructions in the pdfTeX
REDAME?

Please, file a bug for this at sarovar; this will allow us to
archive this discussion (\mag et.al) once.

Please see also
    http://www.ntg.nl/pipermail/ntg-pdftex/2004-April/000487.html
    http://www.ntg.nl/pipermail/ntg-pdftex/2004-April/000488.html
    http://www.ntg.nl/pipermail/ntg-pdftex/2004-April/000489.html
    http://www.ntg.nl/pipermail/ntg-pdftex/2004-April/000492.html

I think I understand your problem, but the pdfTeX team thinks
that the current behaviour of pdfTeX (as it was up to 0.13d and
is since 1.20a) is the correct one.

Changing pdftex.ini should be done by the maintainers of TeX
distribution (e.g. teTeX, MikTeX etc.); but that would probably
break compatibility with newer documents.

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From noreply at sarovar.org  Sun Feb 12 18:12:40 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Sun, 12 Feb 2006 22:42:40 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-480 ] pdftex offset incorrect with
	\magnification. Patch included.
Message-ID: <E1F8Km8-0007Ew-00@sarovar.org>

Bugs item #480, was opened at 2006-02-12 17:12
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=480&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Ian Hutchinson (ihutch)
Assigned to: Nobody (None)
Summary: pdftex offset incorrect with \magnification. Patch included.

Initial Comment:
 Any plain tex file that uses
\magnification gives incorrect text placement in pdf.
This bug is present
in the latest pdftex version 1.21a. It apparently was
caused by the
introduction of the new variables \pdfvoffset and
\pdfhoffset. This bug
was not present in older pdftex, e.g. version
3.14159-1.10b, which was
part of tetex-2...

A simple illustration of the problem is with the
trivial file:

\magnification \magstep3
%The following parindent and offset changes are not the
cause of errors.
%They are merely to illustrate them clearly by writing
at top left.
%Anything other than \magstep0 gives a placement error
with pdftex 1.21a.
\parindent 0pt
\hoffset -1 truein
\voffset -1 truein
The top.
\end

With tex and xdvi, the words "The top." are placed at
the immediate top
left. With pdftex 1.21a and xpdf (or acroread) they are
not. With earlier
pdftex 1.10b (e.g.) they are.

I had an extensive discussion on comp.text.tex with
Heiko Oberdiek, most
of which is at
http://www.codecomments.com/Tex/message784423.html

The gist of it is that backward compatibility with
plain tex files is very
important. As far as possible, it should be preserved
transparently.
Authors should not be required to hack their files in
order for them to
render the same in pdf as in dvi. Moreover there is a
simple way to
provide this compatibility.

A reasonable way to fix the bug is to change pdftex.ini
and hence
pdftex.fmt. (The corresponding pdfetex files ought also
to be fixed.)

A proposed patched pdftex.ini file is attached. It
consists simply of

% Thomas Esser, 1998, 2004. public domain.
\ifx\pdfoutput\undefined
\else
  \ifx\pdfoutput\relax
  \else
    \input pdftexconfig
    \pdfoutput=1
  \fi
\fi

\input plain

\ifx\pdfoutput\undefined
\else
  \ifx\pdfoutput\relax
  \else
\catcode`@=11
\def\m at g{%
\mag\count@
\hsize6.5truein\vsize8.9truein\dimen\footins8truein
%These commands fix the pdf sizes to be in true units.
\mag at fix\pdfhorigin \mag at fix\pdfvorigin
\mag at fix\pdfpagewidth \mag at fix\pdfpageheight
}
\def\mag at fix#1{%
 #1=\expandafter\convert at truept\the#1\relax
}
\begingroup
\catcode`P=12
\catcode`T=12
\lowercase{%
\endgroup
\def\convert at truept#1PT{%
#1truept%
}%
}%
\catcode`@=12
  \fi
\fi

\dump
\endinput

I don't know who takes responsibility for pdftex.ini.
But clearly this
ought to be fixed for all distributions. I care most
about tetex, because
it is what I use. Thanks,

        Ian Hutchinson


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=480&group_id=106

From hutch at psfc.mit.edu  Sun Feb 12 18:32:41 2006
From: hutch at psfc.mit.edu (hutch at psfc.mit.edu)
Date: Sun, 12 Feb 2006 12:32:41 -0500 (EST)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <20060212142221.GI8426@lucien.oneiros.kn-bremen.de>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
	<20060212142221.GI8426@lucien.oneiros.kn-bremen.de>
Message-ID: <Pine.LNX.4.58.0602121222270.4575@localhost.localdomain>

On Sun, 12 Feb 2006, Martin [iso-8859-1] Schröder wrote:
 ....  [Sarcastic comment removed]
>
> Please, file a bug for this at sarovar; this will allow us to
> archive this discussion (\mag et.al) once.

OK, done, since you insist.

> I think I understand your problem, but the pdfTeX team thinks
> that the current behaviour of pdfTeX (as it was up to 0.13d and
> is since 1.20a) is the correct one.

No, as my report and original email make clear this bug is NOT present in
version: pdfTeX (Web2C 7.4.5) 3.14159-1.10b, nor as far as I know
any earlier versions.

> Changing pdftex.ini should be done by the maintainers of TeX
> distribution (e.g. teTeX, MikTeX etc.); but that would probably
> break compatibility with newer documents.

No, it would break nothing in documents that don't use \magnification.
Since the version of pdftex with this bug has only recently been included
in TeX distributions, there are probably very few documents whose authors
have been forced to introduce incompatible hacks to overcome it. The
sooner it is fixed, though, the better.

As far as where the fix should be introduced, IMHO, it would be better if
the pdftex dimensions were all in true units, in which case this would
never have arisen and the pdftex.ini file would not have to be patched
like this. However, I sense that pdftex maintainers/developers wish to
resist that, for their own reasons. If so, then patching pdftex.ini seems
a reasonable compromise.

Ian Hutchinson.

From noreply at sarovar.org  Mon Feb 13 00:07:34 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 04:37:34 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-479 ] Nested links
Message-ID: <E1F8QJa-0001bV-00@sarovar.org>

Bugs item #479, was opened at 2006-02-09 18:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=479&group_id=106

>Category: Annotations
>Group: v1.30.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
>Assigned to: Hartmut Henkel (hhenkel)
>Summary: Nested links

Initial Comment:
Hello,

Dario Teixeira reported a problem on the pdfTeX
mailing list:

> I have come across an interesting issue with hyperref
> and pdftex.  Whenever one hyperlink is nested inside 
> another, the entire remainder of the line is shown
> as an hyperlink.
> 
> If you are wondering why on earth would someone want
> to have nested hyperlinks, please take a look at this
> sample document I created; it also displays the
"feature":
> http://www.dse.nl/~dario/misc/nestedlinks.pdf  [50KB]

I consider this as bug in pdfTeX and have
generated a small test file (plain format):

\showboxbreadth=\maxdimen
\showboxdepth=\maxdimen
[part before]
\pdfstartlink goto name{Hello}
[hello start
  \pdfstartlink attr{/C[1 0 0]} goto name{World}
  [inside world]%
  \pdfendlink\space
stop]%
\pdfendlink\space
[part after]\par
\showlists  

\vfill\eject
\pdfdest name{Hello}XYZ\relax
Hello
\vfill\eject
\pdfdest name{World}XYZ\relax
World
\end

Three annotations are generated by pdfTeX 1.30.4:

7 0 obj <<
/Type /Annot
/Rect [148.989 757.436 540 767.399]
/Subtype /Link
/A << /S /GoTo /D (Hello) >>
>> endobj
8 0 obj <<
/Type /Annot
/C[1 0 0] 
/Rect [199.439 757.436 257.361 767.399]
/Subtype /Link
/A << /S /GoTo /D (World) >>
>> endobj
9 0 obj <<
/Type /Annot
/Rect [257.361 757.436 281.769 767.399]
/Subtype /Link
/A << /S /GoTo /D (Hello) >>
>> endobj

Either there should be two overlapping
annotations or three distinct ones.
At any case "540" in the first rect is too large.

As workaround, the outer/enclosing annotation
can put into a box (\hbox in plain TeX, \mbox
in LaTeX). But it does not solve the problem,
because now the link cannot be broken across
lines.

Therefore the algorithm for annotations needs
to be reviewed and corrected.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 00:07

Message:
Logged In: YES 
user_id=421

Confirmed with the latest beta.

_Can_ links be nested? And if they can, is there a limit on
the nesting depth?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=479&group_id=106

From noreply at sarovar.org  Mon Feb 13 00:35:22 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 05:05:22 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-473 ] \ifabsnum and \ifabsdim
Message-ID: <E1F8QkU-0004fR-00@sarovar.org>

Patches item #473, was opened at 2006-01-27 15:20
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=473&group_id=106

Category: Primitives
>Group: v1.30.0
Status: Open
>Resolution: Accepted
>Priority: 4
Submitted By: Taco Hoekwater (taco)
>Assigned to: Martin Schr?der (oneiros)
Summary: \ifabsnum and \ifabsdim

Initial Comment:
Here is a small change file that implements two new
etex primitives :
  \ifabsnum 
  \ifabsdim 
Usage is the same as \ifnum and \ifdim. The only 
difference is that they negate the values if they are
negative before comparing.

----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-27 15:31

Message:
Logged In: YES 
user_id=927

intended usage: 

\ifabsdim \dimexpr \maxheight - \currentheight \relax < .5pt 
  assume that we're done 
\fi 

it can also be used to handle rounding errors when doing
roundtrip calculations 


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=473&group_id=106

From martin at oneiros.de  Mon Feb 13 01:21:40 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon, 13 Feb 2006 01:21:40 +0100
Subject: [NTG-pdftex] 1.40.0-beta-20060213
Message-ID: <20060213002139.GC16285@lucien.oneiros.kn-bremen.de>

http://sarovar.org/download.php/913/pdftex-1.40.0-beta-20060213.tar.bz2
http://sarovar.org/download.php/914/pdftex-1.40.0-beta-20060125-20060213.diff.gz

- pdftex.web has been improved a bit
- new patch:
  - 473 \ifabsnum and \ifabsdim
- the manual has been updated a bit and is again included

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de

From martin at oneiros.de  Mon Feb 13 01:30:46 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon, 13 Feb 2006 01:30:46 +0100
Subject: [NTG-pdftex] 1.40 Schedule
In-Reply-To: <20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
Message-ID: <20060213003046.GD16285@lucien.oneiros.kn-bremen.de>

On 2005-12-13 15:40:23 +0100, Martin Schr?der wrote:
> - beta, i.e. code cleanup till 2006-02-12 (2006W06)
>   here we are in feature freeze and can work on the manual and
>   news

A reminder: 
- the manual is still mostly 1.30 
    Hartmut? Pawel?

- we have no news
    I still like something like ltnews; unless someone (Hans?)
    provides something better, I propose simply using them as a
    template.

- patch 473 is the last one I will accept for 1.40

Oh yes:
> - rc0 on 2006-02-20 (2006W07)
>   bug hunting!
That's only one week away...

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From noreply at sarovar.org  Mon Feb 13 01:46:41 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 06:16:41 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-474 ] Use dynamically linked poppler
	library instead of xpdf code
Message-ID: <E1F8RrV-0003pC-00@sarovar.org>

Patches item #474, was opened at 2006-01-30 17:53
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

Category: None
>Group: v1.30.0
Status: Open
>Resolution: Postponed
Priority: 5
Submitted By: Frank K?ster (frank)
>Assigned to: Martin Schr?der (oneiros)
Summary: Use dynamically linked poppler library instead of xpdf code

Initial Comment:
This has already been applied and tested in Debian and
Ubuntu, but we suggest to apply it upstream.  There are
a few things to do, however, as Martin already pointed
out to me in a private mail.  I paraphrase the main points:

- the pdftex distribution should not ship libpoppler.
Instead it should be possible to switch from xpdf to
libpoppler using autoconf magic, if libpoppler headers
are installed.  This needs some coding work

- We need a common API for xpdf and poppler.  This is
the tricky part, because the very reason for poppler's
existence is that the xpdf developer, Derek Noonburg,
refuses any patches that would lead to a shared
library. As Martin said, "for the beginning, a header
file with a couple of #ifdef'ed definitions should be
enough".

I'm going to subscribe to the pdftex devel list soon,
but am not yet subscribed currently.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:46

Message:
Logged In: YES 
user_id=421

This is too late for 1.40, so I'll postpone it.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

From noreply at sarovar.org  Mon Feb 13 01:50:41 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 06:20:41 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-474 ] Use dynamically linked poppler
	library instead of xpdf code
Message-ID: <E1F8RvN-0004cj-00@sarovar.org>

Patches item #474, was opened at 2006-01-30 17:53
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

>Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Frank K?ster (frank)
Assigned to: Martin Schr?der (oneiros)
Summary: Use dynamically linked poppler library instead of xpdf code

Initial Comment:
This has already been applied and tested in Debian and
Ubuntu, but we suggest to apply it upstream.  There are
a few things to do, however, as Martin already pointed
out to me in a private mail.  I paraphrase the main points:

- the pdftex distribution should not ship libpoppler.
Instead it should be possible to switch from xpdf to
libpoppler using autoconf magic, if libpoppler headers
are installed.  This needs some coding work

- We need a common API for xpdf and poppler.  This is
the tricky part, because the very reason for poppler's
existence is that the xpdf developer, Derek Noonburg,
refuses any patches that would lead to a shared
library. As Martin said, "for the beginning, a header
file with a couple of #ifdef'ed definitions should be
enough".

I'm going to subscribe to the pdftex devel list soon,
but am not yet subscribed currently.

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:50

Message:
Logged In: YES 
user_id=421

I've attached the patch by Frank from
http://www.ntg.nl/pipermail/ntg-pdftex/2006-February/001993.html

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:46

Message:
Logged In: YES 
user_id=421

This is too late for 1.40, so I'll postpone it.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

From noreply at sarovar.org  Mon Feb 13 08:58:45 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 13:28:45 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-474 ] Use dynamically linked poppler
	library instead of xpdf code
Message-ID: <E1F8Ybd-0006pT-00@sarovar.org>

Patches item #474, was opened at 2006-01-30 17:53
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

Category: PDF inclusion
Group: v1.30.0
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Frank K?ster (frank)
Assigned to: Martin Schr?der (oneiros)
Summary: Use dynamically linked poppler library instead of xpdf code

Initial Comment:
This has already been applied and tested in Debian and
Ubuntu, but we suggest to apply it upstream.  There are
a few things to do, however, as Martin already pointed
out to me in a private mail.  I paraphrase the main points:

- the pdftex distribution should not ship libpoppler.
Instead it should be possible to switch from xpdf to
libpoppler using autoconf magic, if libpoppler headers
are installed.  This needs some coding work

- We need a common API for xpdf and poppler.  This is
the tricky part, because the very reason for poppler's
existence is that the xpdf developer, Derek Noonburg,
refuses any patches that would lead to a shared
library. As Martin said, "for the beginning, a header
file with a couple of #ifdef'ed definitions should be
enough".

I'm going to subscribe to the pdftex devel list soon,
but am not yet subscribed currently.

----------------------------------------------------------------------

>Comment By: Frank K?ster (frank)
Date: 2006-02-13 08:58

Message:
Logged In: YES 
user_id=3360

I agree that this is something to think over and check very
well, so better not push it into 1.40.

But I'd appreciate if someone could answer my mail to
ntg-pdftex regarding the autoconf setup in pdftex, or if you
could tell me whom to ask specifically if nobody among the
active developers knows about it.

See you in Berlin,
Frank

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:50

Message:
Logged In: YES 
user_id=421

I've attached the patch by Frank from
http://www.ntg.nl/pipermail/ntg-pdftex/2006-February/001993.html

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 01:46

Message:
Logged In: YES 
user_id=421

This is too late for 1.40, so I'll postpone it.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=474&group_id=106

From pragma at wxs.nl  Mon Feb 13 10:18:58 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 13 Feb 2006 10:18:58 +0100
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <Pine.LNX.4.63.0602120816200.23543@tex2html.net>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
	<Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>
	<Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>
	<Pine.LNX.4.63.0602111053030.14010@tex2html.net>
	<43EF1070.9060502@elvenkind.com>
	<Pine.LNX.4.63.0602120816200.23543@tex2html.net>
Message-ID: <43F04F02.8020701@wxs.nl>

Ian Hutchinson wrote:
> On Sun, 12 Feb 2006, Taco Hoekwater wrote:
>
>   
>> The discussion on c.t.t. about this went along the same lines, and
>> the main problem is that documents that use \magnification are
>> inherently flawed. The DVI format (i.e. TeX) claims not to know about
>> physical page dimensions; but at the same time it does allow you to
>> shift and scale the content of the physical output plane. There is an
>> inherent conflict there. Pdftex brings this in the spotlight because
>> the PDF format does have a physical page, and its offsets needs to be
>> specified.
>>     
>
> I don't know where you get the idea that dvi does not know anything about 
> page dimensions. It is clearly quite erroneous. TeX itself does specify 
> its offsets, and dvips etc specify their pages sizes in accordance with 
> settings that need to be compatible with the extent of the text (i.e. 
> \hsize, \vsize).
>   
your claim does not stand; as taco says, *dvi* does not know about page 
dimensions, unless you've uncovered a new dvi opcode and page dimension 
related pure tex primitive

it's dvips that deals with the page dimenions (and it understands 
specials that specify them, but specials are, well, specials, not part 
of the tex standard)

pdftex being both frontend and backend has to deal with it and instead 
of relying on external configurations (like dvips) has more control 
built in

from the perspective of tex (macro packages) such things are often more 
complex than simply defining a page, since one has to deal with 
page-on-page mapping as well as the reference point, in tex/dvi upper 
left corner and in pdf(tex) the lower left corner and therefore pdftex 
needs to know the page dimensions at runtime (and the offsets are just 
[compatibility] left overs)

in the beginning pdftex didn't even support maginification and after it 
was implemented it went through several cycles of development because 
the results neded to be comparable to dvips output and controllable from 
the tex level (the problem with magnification is that in a dvi backend 
it only involves fonts and to be included graphics, while in pdftex it 
also involves annotations; in both situation it will probably break any 
literal code (ps/pdf) unless explicitly dealt with)
>> The magnification scaling stuff was nice when all we had was bitmapped
>> fonts, but I believe anybody who still uses it in this day and age
>> should be hit on the head with the PostScript or PDF specification
>> (repeatedly).
>>     
>
> This comment, like many from others, misses the point. TeX is an archival 
> representation of scientific documents. That is a major strength. TeX is 
> not just a computer tool for producing new documents. You undermine the 
> value of TeX if you abandon for no reason backward compatibility. Your 
> opinions or those of others about the advisability of using magnification 
> for new documents are not the issue at hand. Nothing in the patch I have 
> offered affects any document that follows your advice and does not use 
> magnification. The patch simply fixes those that do use it, whether new or 
> old.
>   
apart from the fixing aspect, it's normally macro packages that deal 
with such matters, so if anything is broken, fix or extend the macro 
package ... personally i don't even know what is in the ini files and i 
don't let my systems depend on it -)

magnification is indeed kind of obsolete, as is dvi (which is not 
portable anyway since it lacks certain information and the last 25 years 
nobody bothered with extending it to carry more information around [like 
encodings or graphics] cq. it was impossible to reach an agreement on 
such extensions]

the bug you mention is therefore more comparable to a (temporary) bug in 
dvips 

for the average tex user compatibility mostly means that one can still 
(maybe with small modifications) process old documents; magnification 
was never meant as a feature to be used for final prints, so if 
something fails in that area it does not break the compatibility story

with regards to processing old sources i'd be more concerned about

- changed hyphenation patterns
- patches in the program (less and less)
- patched macro code
- changes in fonts
- availability of additional resources

> I won't argue with opinionated pronouncements about features of TeX that 
> appear redundant or troublesome. I could make pronouncements of my own 
> about other such features. However, I will continue to say loudly, that 
> until a patch like this is applied, the latest version of pdftex has 
> broken plain tex files for no good reason. That is a bad thing, and since 
> the fix is so easy, it should be fixed ASAP.
>   
well, if it's broken it will be repaired,

what puzzles me is that nobody noticed this dureing the 'texlive code 
freeze', it looks like there are no plain tex users testing pdftex at 
that stage
>   
>> That said, I believe this patch is not really a bad idea, but one
>> should change the formats name at the same time (it wouldnt be
>> just plain.tex anymore)
>>
>>     
>
> The format I have proposed to patch is not plain, but pdftex.ini. The
> plain.fmt never enters into consideration. plain is not being patched. A 
> pdftex-specific file is being patched.
>   
indeed,

although i can imagine that the plain tex format could have a conditional section, doing those initializations; if we want certain code in there, we can propose it to dek (the web formatting code is also pdftex aware). 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From taco at elvenkind.com  Mon Feb 13 11:08:44 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 13 Feb 2006 11:08:44 +0100
Subject: [NTG-pdftex] 1.40 Schedule
In-Reply-To: <20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
Message-ID: <43F05AAC.9010802@elvenkind.com>



Martin Schr?der wrote:
> - patch 473 is the last one I will accept for 1.40

thanks

>>- rc0 on 2006-02-20 (2006W07)
>>  bug hunting!
> 
> That's only one week away...

i've been using the beta for a production job a few weeks
now and have not seen anything weird yet. :-)

Taco

From hutch at psfc.mit.edu  Mon Feb 13 14:57:24 2006
From: hutch at psfc.mit.edu (hutch at psfc.mit.edu)
Date: Mon, 13 Feb 2006 08:57:24 -0500 (EST)
Subject: [NTG-pdftex] Bug in pdftex. Fixed by attached pdftex.ini.
In-Reply-To: <43F04F02.8020701@wxs.nl>
References: <Pine.LNX.4.58.0602102314000.25029@ihutch.mit.edu>
	<Pine.LNX.4.61.0602110957050.3385@hahepc2.hahe>
	<Pine.LNX.4.61.0602111020140.3668@hahepc2.hahe>
	<Pine.LNX.4.63.0602111053030.14010@tex2html.net>
	<43EF1070.9060502@elvenkind.com>
	<Pine.LNX.4.63.0602120816200.23543@tex2html.net>
	<43F04F02.8020701@wxs.nl>
Message-ID: <Pine.LNX.4.58.0602130841400.4355@localhost.localdomain>


On Mon, 13 Feb 2006, Hans Hagen wrote:

> Ian Hutchinson wrote:
> > On Sun, 12 Feb 2006, Taco Hoekwater wrote:
> > I don't know where you get the idea that dvi does not know anything about
> > page dimensions. It is clearly quite erroneous. TeX itself does specify
> > its offsets, and dvips etc specify their pages sizes in accordance with
> > settings that need to be compatible with the extent of the text (i.e.
> > \hsize, \vsize).
> >
> your claim does not stand; as taco says, *dvi* does not know about page
> dimensions, unless you've uncovered a new dvi opcode and page dimension
> related pure tex primitive
>
> it's dvips that deals with the page dimenions (and it understands
> specials that specify them, but specials are, well, specials, not part
> of the tex standard)

I think you are just nit picking. Without dvi2something, the TeX system is
incomplete. You say only the 'something' needs to know paper size. I say,
of course, but \hsize has to be chosen with some knowledge of papersize,
so tex and something have to be coordinated even when dvi is in use.

> the bug you mention is therefore more comparable to a (temporary) bug in
> dvips

If it were just papersize, I would agree. When it is offsets as well,
which TeX knows about, then I would argue it is somewhat more fundamental.
But in any case, since pdftex is in a sense responsible for the work of
the combination tex+dvips, it's comparable to a bug in pdftex.

>
> for the average tex user compatibility mostly means that one can still
> (maybe with small modifications) process old documents; magnification
> was never meant as a feature to be used for final prints, so if
> something fails in that area it does not break the compatibility story

I totally disagree. What magnification is "meant for" is not just what one
person or group of persons thinks. I believe this misunderstanding of the
role in plain of \magnification is one reason why this bug has received
such short shrift until now. Compatibility is compatibility.

> > However, I will continue to say loudly, that
> > until a patch like this is applied, the latest version of pdftex has
> > broken plain tex files for no good reason. That is a bad thing, and since
> > the fix is so easy, it should be fixed ASAP.
> >
> well, if it's broken it will be repaired,

Excellent!

>
> what puzzles me is that nobody noticed this dureing the 'texlive code
> freeze', it looks like there are no plain tex users testing pdftex at
> that stage
> >

People did notice it, as you'll see if you go back through the mail
archives (although admittedly not that many people). The problem was not
properly diagnosed at the time (by my interpretation of the exchanges) and
the complaints were treated with considerable disdain, which probably
discouraged the pursuit of the problem. Not everyone is thick-skinned
enough to overcome the aggressive tone of the pdftex croud.

Regards,
		Ian Hutchinson.

From P.Jackowski at gust.org.pl  Mon Feb 13 15:59:18 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Mon, 13 Feb 2006 15:59:18 +0100
Subject: [NTG-pdftex] 1.40 Schedule
In-Reply-To: <20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
Message-ID: <43F09EC6.3070307@gust.org.pl>


> A reminder: 
> - the manual is still mostly 1.30 
>     Hartmut? Pawel?

Ooops the entire week I'm in Finland with poor possibilities to update 
anything. Will try however. What's the status of \pdfstrcmp and regexp 
stuff; still left experimental? And... Even if they are, meybe it is 
better to document those features to let people use and test the embryo?..

Best,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From martin at oneiros.de  Mon Feb 13 17:11:00 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon, 13 Feb 2006 17:11:00 +0100
Subject: [NTG-pdftex] 1.40 Schedule
In-Reply-To: <43F09EC6.3070307@gust.org.pl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
Message-ID: <20060213161100.GB31186@lucien.oneiros.kn-bremen.de>

On 2006-02-13 15:59:18 +0100, Pawel Jackowski wrote:
> Ooops the entire week I'm in Finland with poor possibilities to update 
> anything. Will try however. What's the status of \pdfstrcmp and regexp 
> stuff; still left experimental? And... Even if they are, meybe it is 
> better to document those features to let people use and test the embryo?..

Yes. Yes.

Have fun
    Martin
-- 
                    http://www.tm.oneiros.de

From pragma at wxs.nl  Mon Feb 13 17:26:45 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 13 Feb 2006 17:26:45 +0100
Subject: [NTG-pdftex] 1.40 Schedule
In-Reply-To: <43F09EC6.3070307@gust.org.pl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
Message-ID: <43F0B345.4010405@wxs.nl>

Pawe? Jackowski wrote:
>> A reminder: 
>> - the manual is still mostly 1.30 
>>     Hartmut? Pawel?
>>     
>
> Ooops the entire week I'm in Finland with poor possibilities to update 
> anything. Will try however. What's the status of \pdfstrcmp and regexp 
> stuff; still left experimental? And... Even if they are, meybe it is 
> better to document those features to let people use and test the embryo?..
>   
experimental, may even dissappear in favor of lua stuff (taco will start working on that soon) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Mon Feb 13 17:36:26 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Mon, 13 Feb 2006 17:36:26 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <86psm5og7k.fsf@alhambra.kuesterei.ch>
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
Message-ID: <20060213163626.GD31186@lucien.oneiros.kn-bremen.de>

On 2006-02-02 17:53:03 +0100, Frank K?ster wrote:
> The harder part is the autoconf magic required for the switching, and
> not even writing autoconf (at least not yet), but rather incorporating
> the changes:
> 
> On my system, "./reautoconf" does not work, instead complains:
> 
> autoconf: invalid option -m
> 
> 
> I have
> 
> $ autoconf --version
> autoconf (GNU Autoconf) 2.59
> Written by David J. MacKenzie and Akim Demaille.
> 
> Copyright (C) 2003 Free Software Foundation, Inc.
> 
> Or is there a different way to regenerate configure after changes to its
> source files?

There surely is, but I don't know it offhand. Our auto* experts
are Thomas Esser (busy offline) and Olaf Weber (who should have a
new hard disc now).

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From noreply at sarovar.org  Mon Feb 13 17:40:11 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 22:10:11 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-466 ] \primitive and \ifprimitive
Message-ID: <E1F8gkF-0001Zq-00@sarovar.org>

Patches item #466, was opened at 2006-01-07 17:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

Category: Primitives
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 4
Submitted By: Taco Hoekwater (taco)
Assigned to: Martin Schr?der (oneiros)
Summary: \primitive and \ifprimitive

Initial Comment:
This patch implements two new primitives:

  \primitive \par

This will run the 'primitive' command \par, even if it 
has been re- or undefined in the meantime. \primitive
is not expandable, because it may be asked to execute
unexpandable primitives as well as expandable ones.

If you supply a nonexistant primitive, it will be 
ignored (no error is raised).

The second primitive is a new type of \if:

  \ifprimitive \par ... \else .. \fi

returns true if the current meaning of \par is the
'primitive' command \par.


The patch is against alpha-20051226, i hope that is not 
too old (?). I expect to do at least one minor update 
during the beta cycle, after the pdftex code is 
flattened. It was quite a struggle to make this 
change file work ok, and as a result, there are 
a few ugly web hacks.


----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-13 17:40

Message:
Logged In: YES 
user_id=3344

IMHO it would be better to rephrase the above to (and change
the implementation accordingly :-():

<quote mode="changed">
\primitive is expandable, because it may asked to execute
expandable primitives as well as unexpandable ones.

\primitive<cs> will expand to one token, the original TeX
primitive.  This token will then be processed further as usual.
</quote>


If \primitive is left unexpandable, a lot of programming
techniques seems to be unavailable, e.g., all redefined
expandable primitives in expandable-only context.

Or any assignment to the get the original primitive, like

\edef\orignumber{\expandafter\noexpand\primitive\number}

\expandafter\let\expandafter\orignumber\primitive\number


Sidenote: The new \primitive seems to implement a subset of
a full-blown namespace mechanism.  If (pdf)TeX would have
namespaces, one simply has to access the appropriate token
within the "primitive" namespace (e.g. \primitive::number to
 access the original \number primitive, assuming the
notation \<namespace>::<csname>).  How about choosing an
appropriate namespace mechanism for (pdf)TeX and
implementing it instead?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

From noreply at sarovar.org  Mon Feb 13 18:56:28 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 23:26:28 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-466 ] \primitive and \ifprimitive
Message-ID: <E1F8hw4-0001IK-00@sarovar.org>

Patches item #466, was opened at 2006-01-07 17:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

Category: Primitives
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 4
Submitted By: Taco Hoekwater (taco)
Assigned to: Martin Schr?der (oneiros)
Summary: \primitive and \ifprimitive

Initial Comment:
This patch implements two new primitives:

  \primitive \par

This will run the 'primitive' command \par, even if it 
has been re- or undefined in the meantime. \primitive
is not expandable, because it may be asked to execute
unexpandable primitives as well as expandable ones.

If you supply a nonexistant primitive, it will be 
ignored (no error is raised).

The second primitive is a new type of \if:

  \ifprimitive \par ... \else .. \fi

returns true if the current meaning of \par is the
'primitive' command \par.


The patch is against alpha-20051226, i hope that is not 
too old (?). I expect to do at least one minor update 
during the beta cycle, after the pdftex code is 
flattened. It was quite a struggle to make this 
change file work ok, and as a result, there are 
a few ugly web hacks.


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-02-13 18:56

Message:
Logged In: YES 
user_id=1608

We need to think about this. 

I see your point, but making \primitive expandable forces
the introduction of un-redefinable tokens, and that has its
own problematic side-effects (like slowing down each and
every definition). I welcome third opinions on whether the 
benefits outweigh that downside.

At one point I tried making the expandability depend on the
referred primitive, but that gave me headaches at the
implementation stage (a pity, because that would have been
nice).

Yet another solution is to have an expandable command as
well as an unexpandable command (two primitives instead of
just the single \primitive).

On the side note: I will happily write an implementation ...
but only if someone comes up with a specification that works
under all conditions instead of only under specific
programming styles :-)



----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-13 17:40

Message:
Logged In: YES 
user_id=3344

IMHO it would be better to rephrase the above to (and change
the implementation accordingly :-():

<quote mode="changed">
\primitive is expandable, because it may asked to execute
expandable primitives as well as unexpandable ones.

\primitive<cs> will expand to one token, the original TeX
primitive.  This token will then be processed further as usual.
</quote>


If \primitive is left unexpandable, a lot of programming
techniques seems to be unavailable, e.g., all redefined
expandable primitives in expandable-only context.

Or any assignment to the get the original primitive, like

\edef\orignumber{\expandafter\noexpand\primitive\number}

\expandafter\let\expandafter\orignumber\primitive\number


Sidenote: The new \primitive seems to implement a subset of
a full-blown namespace mechanism.  If (pdf)TeX would have
namespaces, one simply has to access the appropriate token
within the "primitive" namespace (e.g. \primitive::number to
 access the original \number primitive, assuming the
notation \<namespace>::<csname>).  How about choosing an
appropriate namespace mechanism for (pdf)TeX and
implementing it instead?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

From noreply at sarovar.org  Mon Feb 13 19:04:10 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 23:34:10 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-481 ] "This can't happen (flushing)"
	with extra kerning+expansion+ligatures
Message-ID: <E1F8i3W-0001Op-00@sarovar.org>

Bugs item #481, was opened at 2006-02-13 18:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=481&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: "This can't happen (flushing)" with extra kerning+expansion+ligatures

Initial Comment:
With the following test file, pdftex will abort with
"This can't happen (flushing)":

\pdfadjustspacing=1
\pdffontexpand\font 20 20 4 autoexpand
\pdfappendkern=1
\knaccode\font`i=100

\hsize10em
foo fii foo foo foo foo
% but this works:
%foo f{}ii foo foo foo foo
\bye


Hartmut's analysis was:

-----------------------------------
FWIW, this happens in function do_subst_font(). But it
starts with
auto_expand_kern(), where the given kern indeed is
appended to the i of
"fi" and also to the 2nd "i". It seems as if at this
time "fi" is not
yet seen as a ligature. Then in do_subst_font() the
"fi" is somehow
already a ligature, and now the kern is part of the
lig_ptr list (which
is wrong). Then font(r) is recursively changed to 51,
the expanded font
number, and so the kern, which should not be in this
list, gets the 51
as its type. But it must be 11 for a kern. Maybe a
change should be that
the kern does not end up in the lig_ptr list, but
should come after the
"fi" ligature. No idea, how.
-----------------------------------


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=481&group_id=106

From noreply at sarovar.org  Mon Feb 13 19:04:19 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 23:34:19 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-482 ] extra kerning does not work with
	ligatures
Message-ID: <E1F8i3f-0001PB-00@sarovar.org>

Bugs item #482, was opened at 2006-02-13 18:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=482&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: extra kerning does not work with ligatures

Initial Comment:
Appending or prepending kerns with the new primitives
does not work with ligatures. It works, though, when
the ligatures are accessed via \char:

\pdfprependkern=1
\pdfappendkern=1
\def\setkn#1{%
  \knbccode\font #1 = 200\relax
  \knaccode\font #1 = 200\relax
}
\setkn{`a}
\setkn{11} % ff
\setkn{12} % fi
\setkn{`z}

afffiz\par
a\char11 \char12 z
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=482&group_id=106

From noreply at sarovar.org  Mon Feb 13 19:04:28 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 23:34:28 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-483 ] extra kerning inhibits extra
	spacing
Message-ID: <E1F8i3o-0001PS-00@sarovar.org>

Bugs item #483, was opened at 2006-02-13 18:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=483&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: extra kerning inhibits extra spacing

Initial Comment:
The new extension don't work together:

\pdfadjustinterwordglue=1
\knbscode\font`\e=1000

The test

\pdfappendkern=1
\knaccode\font`\e=1

The test
\bye


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=483&group_id=106

From noreply at sarovar.org  Mon Feb 13 19:04:43 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 23:34:43 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-484 ] extra kerning inhibits hyphenation
Message-ID: <E1F8i43-0001Pw-00@sarovar.org>

Bugs item #484, was opened at 2006-02-13 18:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=484&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
Summary: extra kerning inhibits hyphenation

Initial Comment:
Hyphenation will be inhibited by appended or prepended
kerns: 

\showhyphens{pdftex}
{
 \pdfprependkern=1
 \knbccode\font`e=100
 \showhyphens{pdftex}
}
{
 \pdfappendkern=1
 \knaccode\font`e=100
 \showhyphens{pdftex}
}
\bye


(In a milder mood, I would have filed this as a feature
request, not as a bug report. But I do think that it's
a major drawback, which renders this new extension
useless for a lot of applications.)

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=484&group_id=106

From noreply at sarovar.org  Mon Feb 13 19:05:10 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 13 Feb 2006 23:35:10 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-462 ] HZ font expansion by text
	matrix manipulation
Message-ID: <E1F8i4U-0001Qq-00@sarovar.org>

Patches item #462, was opened at 2005-12-23 22:35
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

Category: Positioning
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: HZ font expansion by text matrix manipulation

Initial Comment:
Use textmatrix Tm instead of /FontMatrix for font
expansion. Then a font file will be embedded only once
for all expansion factors. Gives smaller PDF files.
Works then also for non-embedded fonts. TrueType not
tried yet. Rough patch only, incomplete, work in
progress, no warranty, not for production.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-13 18:05

Message:
Logged In: YES 
user_id=2217

Will this make it into 1.40? I would love to see it included.

I've tested it a bit and did not find any problems (I'm also
using it for the pre-built microtype documentation on CTAN). 

Regards,
Robert

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

From noreply at sarovar.org  Mon Feb 13 19:41:27 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Feb 2006 00:11:27 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-462 ] HZ font expansion by text
	matrix manipulation
Message-ID: <E1F8idb-0005V8-00@sarovar.org>

Patches item #462, was opened at 2005-12-23 23:35
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

Category: Positioning
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: HZ font expansion by text matrix manipulation

Initial Comment:
Use textmatrix Tm instead of /FontMatrix for font
expansion. Then a font file will be embedded only once
for all expansion factors. Gives smaller PDF files.
Works then also for non-embedded fonts. TrueType not
tried yet. Rough patch only, incomplete, work in
progress, no warranty, not for production.

Regards, Hartmut

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 19:41

Message:
Logged In: YES 
user_id=421

The last word from Hartmut was that it's not ready yet and
he'd be working on an improved version.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-13 19:05

Message:
Logged In: YES 
user_id=2217

Will this make it into 1.40? I would love to see it included.

I've tested it a bit and did not find any problems (I'm also
using it for the pre-built microtype documentation on CTAN). 

Regards,
Robert

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

From noreply at sarovar.org  Mon Feb 13 21:25:59 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Feb 2006 01:55:59 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-481 ] "This can't happen (flushing)"
	with extra kerning+expansion+ligatures
Message-ID: <E1F8kGl-0000DB-00@sarovar.org>

Bugs item #481, was opened at 2006-02-13 19:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=481&group_id=106

Category: hz
Group: v1.40.0
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: The Thanh Han (hanthethanh)
>Summary: "This can't happen (flushing)" with extra kerning+expansion+ligatures

Initial Comment:
With the following test file, pdftex will abort with
"This can't happen (flushing)":

\pdfadjustspacing=1
\pdffontexpand\font 20 20 4 autoexpand
\pdfappendkern=1
\knaccode\font`i=100

\hsize10em
foo fii foo foo foo foo
% but this works:
%foo f{}ii foo foo foo foo
\bye


Hartmut's analysis was:

-----------------------------------
FWIW, this happens in function do_subst_font(). But it
starts with
auto_expand_kern(), where the given kern indeed is
appended to the i of
"fi" and also to the 2nd "i". It seems as if at this
time "fi" is not
yet seen as a ligature. Then in do_subst_font() the
"fi" is somehow
already a ligature, and now the kern is part of the
lig_ptr list (which
is wrong). Then font(r) is recursively changed to 51,
the expanded font
number, and so the kern, which should not be in this
list, gets the 51
as its type. But it must be 11 for a kern. Maybe a
change should be that
the kern does not end up in the lig_ptr list, but
should come after the
"fi" ligature. No idea, how.
-----------------------------------


----------------------------------------------------------------------

>Comment By: Hartmut Henkel (hhenkel)
Date: 2006-02-13 21:25

Message:
Logged In: YES 
user_id=929

My text above had a typo, sorry. Before you start
searching... it's auto_append_kern(), not auto_expand_kern().

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=481&group_id=106

From te at dbs.uni-hannover.de  Mon Feb 13 22:05:50 2006
From: te at dbs.uni-hannover.de (Thomas Esser)
Date: Mon, 13 Feb 2006 22:05:50 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
Message-ID: <20060213210550.GB19626@dbs.uni-hannover.de>

> > The harder part is the autoconf magic required for the switching, and
> > not even writing autoconf (at least not yet), but rather incorporating
> > the changes:
> > 
> > On my system, "./reautoconf" does not work, instead complains:
> > 
> > autoconf: invalid option -m

Two options:
  1) install autoconf-2.13 and use that
  2) try the same in my current tree (available from
       rsync://tug.org/tetexdevsrc/).
     That tree is already converted to autoconf-2.5x.

Given the fact that Peter Breitenlohner has already worked out how to
convert all packages that are part of teTeX (his work is now included
in teTeX's new source tree), it should be fairly easy to make the same
for the rest of TL, too. I honestly hope that the next version of TL
will no longer use autoconf-2.13.

Thomas

From P.Jackowski at gust.org.pl  Tue Feb 14 01:22:44 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Tue, 14 Feb 2006 01:22:44 +0100
Subject: [NTG-pdftex]  1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F0B345.4010405@wxs.nl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
Message-ID: <43F122D4.6090506@gust.org.pl>

Pawel:
[...]>What's the status of \pdfstrcmp and regexp
>> stuff; still left experimental? And... Even if they are, meybe it is 
>> better to document those features to let people use and test the 
>> embryo?..

Hans:
> experimental, may even dissappear in favor of lua stuff (taco will start 
> working on that soon)

Aaa, so if luaTeX might *replace* anything, i belive it makes no sense 
to write even a word. After tracking all the patches some more doubts:

1. '-etex' cmdline switch is already mentioned in 'pdftex --help' but I 
couldn't  force it to work; the option is 'not recognized' during format 
creation (pdftex-beta, 1.40.0, 13.02.2006 compiled under Cygwin).

2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?

3. \primitive, \ifprimitive; to be documented or to be replaced with 
namespaces?

4. \pdfinsertht, experiments with snapping and kerning (patch #415)?

BR,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From kakuto at fsci.fuk.kindai.ac.jp  Tue Feb 14 02:22:14 2006
From: kakuto at fsci.fuk.kindai.ac.jp (Akira Kakuto)
Date: Tue, 14 Feb 2006 10:22:14 +0900
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: Your message of "Tue, 14 Feb 2006 01:22:44 +0100"
References: <43F122D4.6090506@gust.org.pl>
Message-ID: <200602140122.k1E1MF8Q012892@jupiter.fsci.fuk.kindai.ac.jp>

> 1. '-etex' cmdline switch is already mentioned in 'pdftex --help' but I 
> couldn't  force it to work; the option is 'not recognized' during format 
> creation (pdftex-beta, 1.40.0, 13.02.2006 compiled under Cygwin).

-etex is effective on my w32 binary. I investigated the difference:

Best,
Akira

--- texmfmp.c.org	Wed Jan 04 03:12:46 2006
+++ texmfmp.c	Tue Feb 14 10:14:15 2006
@@ -42,8 +42,6 @@
 #include <etexdir/etexextra.h>
 #elif defined (pdfTeX)
 #include <pdftexdir/pdftexextra.h>
-#elif defined (pdfeTeX)
-#include <pdfetexdir/pdfetexextra.h>
 #elif defined (Omega)
 #include <omegadir/omegaextra.h>
 #elif defined (eOmega)
@@ -148,7 +146,7 @@
 static int eightbitp;
 #endif /* Omega || eOmega || Aleph */
 
-#if defined(pdfTeX) || defined(pdfeTeX)
+#if defined(pdfTeX)
 char *ptexbanner;
 #endif
 
@@ -180,7 +178,7 @@
   /* Must be initialized before options are parsed.  */
   interactionoption = 4;
 
-#if defined(pdfTeX) || defined(pdfeTeX)
+#if defined(pdfTeX)
   ptexbanner = BANNER;
 #endif
 
@@ -264,7 +262,7 @@
       fprintf(stderr, "-enc only works with -ini\n");
     }
 #endif
-#if defined(eTeX) || defined(pdfeTeX) || defined(Aleph)
+#if defined(eTeX) || defined(pdfTeX) || defined(Aleph)
     if (etexp) {
       fprintf(stderr, "-etex only works with -ini\n");
     }
@@ -774,14 +772,14 @@
       { "mltex",                     0, &mltexp, 1 },
       { "enc",                       0, &enctexp, 1 },
 #endif /* !Omega && !eOmega && !Aleph */
-#if defined (eTeX) || defined(pdfeTeX) || defined(Aleph)
+#if defined (eTeX) || defined(pdfTeX) || defined(Aleph)
       { "etex",                      0, &etexp, 1 },
-#endif /* eTeX || pdfeTeX || Aleph */
+#endif /* eTeX || pdfTeX || Aleph */
       { "output-comment",            1, 0, 0 },
       { "output-directory",          1, 0, 0 },
-#if defined(pdfTeX) || defined(pdfeTeX)
+#if defined(pdfTeX)
       { "output-format",             1, 0, 0 },
-#endif /* pdfTeX or pdfeTeX */
+#endif /* pdfTeX */
       { "shell-escape",              0, &shellenabledp, 1 },
       { "no-shell-escape",           0, &shellenabledp, -1 },
       { "debug-format",              0, &debugformatfile, 1 },
@@ -895,7 +893,7 @@
           parse_src_specials_option(optarg);
        }
 #endif /* TeX */
-#if defined(pdfTeX) || defined(pdfeTeX)
+#if defined(pdfTeX)
     } else if (ARGUMENT_IS ("output-format")) {
        pdfoutputoption = 1;
        if (strcmp(optarg, "dvi") == 0) {
@@ -906,7 +904,7 @@
          WARNING1 ("Ignoring unknown value `%s' for --output-format", optarg);
          pdfoutputoption = 0;
        }
-#endif /* pdfTeX || pdfeTeX */
+#endif /* pdfTeX */
 #if defined (TeX) || defined (MF) || defined (MP)
     } else if (ARGUMENT_IS ("translate-file")) {
       translate_filename = optarg;
@@ -1610,7 +1608,7 @@
 }
 
 /* FIXME -- some (most?) of this can/should be moved to the Pascal/WEB side. */
-#if !defined(pdfTeX) && !defined(pdfeTeX)
+#if !defined(pdfTeX)
 static void
 checkpoolpointer (poolpointer poolptr, size_t len)
 {

From noreply at sarovar.org  Tue Feb 14 08:17:30 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Feb 2006 12:47:30 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-466 ] \primitive and \ifprimitive
Message-ID: <E1F8uRG-0000w8-00@sarovar.org>

Patches item #466, was opened at 2006-01-07 17:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

Category: Primitives
Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 4
Submitted By: Taco Hoekwater (taco)
Assigned to: Martin Schr?der (oneiros)
Summary: \primitive and \ifprimitive

Initial Comment:
This patch implements two new primitives:

  \primitive \par

This will run the 'primitive' command \par, even if it 
has been re- or undefined in the meantime. \primitive
is not expandable, because it may be asked to execute
unexpandable primitives as well as expandable ones.

If you supply a nonexistant primitive, it will be 
ignored (no error is raised).

The second primitive is a new type of \if:

  \ifprimitive \par ... \else .. \fi

returns true if the current meaning of \par is the
'primitive' command \par.


The patch is against alpha-20051226, i hope that is not 
too old (?). I expect to do at least one minor update 
during the beta cycle, after the pdftex code is 
flattened. It was quite a struggle to make this 
change file work ok, and as a result, there are 
a few ugly web hacks.


----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-14 08:17

Message:
Logged In: YES 
user_id=3344

IMHO it would be better to rephrase the above to (and change
the implementation accordingly :-():

<quote mode="changed">
\primitive is expandable, because it may asked to execute
expandable primitives as well as unexpandable ones.

\primitive<cs> will expand to one token, the original TeX
primitive.  This token will then be processed further as usual.
</quote>


If \primitive is left unexpandable, a lot of programming
techniques seems to be unavailable, e.g., all redefined
expandable primitives in expandable-only context.

Or any assignment to the get the original primitive, like

\edef\orignumber{\expandafter\noexpand\primitive\number}

\expandafter\let\expandafter\orignumber\primitive\number


Sidenote: The new \primitive seems to implement a subset of
a full-blown namespace mechanism.  If (pdf)TeX would have
namespaces, one simply has to access the appropriate token
within the "primitive" namespace (e.g. \primitive::number to
 access the original \number primitive, assuming the
notation \<namespace>::<csname>).  How about choosing an
appropriate namespace mechanism for (pdf)TeX and
implementing it instead?

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-13 18:56

Message:
Logged In: YES 
user_id=1608

We need to think about this. 

I see your point, but making \primitive expandable forces
the introduction of un-redefinable tokens, and that has its
own problematic side-effects (like slowing down each and
every definition). I welcome third opinions on whether the 
benefits outweigh that downside.

At one point I tried making the expandability depend on the
referred primitive, but that gave me headaches at the
implementation stage (a pity, because that would have been
nice).

Yet another solution is to have an expandable command as
well as an unexpandable command (two primitives instead of
just the single \primitive).

On the side note: I will happily write an implementation ...
but only if someone comes up with a specification that works
under all conditions instead of only under specific
programming styles :-)



----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-13 17:40

Message:
Logged In: YES 
user_id=3344

IMHO it would be better to rephrase the above to (and change
the implementation accordingly :-():

<quote mode="changed">
\primitive is expandable, because it may asked to execute
expandable primitives as well as unexpandable ones.

\primitive<cs> will expand to one token, the original TeX
primitive.  This token will then be processed further as usual.
</quote>


If \primitive is left unexpandable, a lot of programming
techniques seems to be unavailable, e.g., all redefined
expandable primitives in expandable-only context.

Or any assignment to the get the original primitive, like

\edef\orignumber{\expandafter\noexpand\primitive\number}

\expandafter\let\expandafter\orignumber\primitive\number


Sidenote: The new \primitive seems to implement a subset of
a full-blown namespace mechanism.  If (pdf)TeX would have
namespaces, one simply has to access the appropriate token
within the "primitive" namespace (e.g. \primitive::number to
 access the original \number primitive, assuming the
notation \<namespace>::<csname>).  How about choosing an
appropriate namespace mechanism for (pdf)TeX and
implementing it instead?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

From taco at elvenkind.com  Tue Feb 14 08:48:37 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Feb 2006 08:48:37 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F122D4.6090506@gust.org.pl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
Message-ID: <43F18B55.8090001@elvenkind.com>

Pawe? Jackowski wrote:
> 2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?

The pdfTeX manual is the right (only) place.

> 3. \primitive, \ifprimitive; to be documented or to be replaced with 
> namespaces?

My idea is: flag as experimental, \primitive may change its behaviour
still (depending the outcome of the discussion on sarovar).

I do not really expect a namespace solution coming soon. That is to
say: i certainly do not have the time to write a functional
specification for such an extension. If someone else feels up to that,
than I will happily (attempt to) write an implementation, but it would
still be too late for 1.40.

Cheers,
Taco

From P.Jackowski at gust.org.pl  Tue Feb 14 11:55:37 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Tue, 14 Feb 2006 11:55:37 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F18B55.8090001@elvenkind.com>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com>
Message-ID: <43F1B729.3060307@gust.org.pl>


>> 2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?
> The pdfTeX manual is the right (only) place.

Done. I doubted since in the patch note you say its etex change AND it 
seems to be enabled iff etex is enabled. No other pdftex primitives 
described in the manual behave like that.

>> 3. \primitive, \ifprimitive; to be documented or to be replaced with 
>> namespaces?
> My idea is: flag as experimental, \primitive may change its behaviour
> still (depending the outcome of the discussion on sarovar).
> 
> I do not really expect a namespace solution coming soon. That is to
> say: i certainly do not have the time to write a functional
> specification for such an extension. If someone else feels up to that,
> than I will happily (attempt to) write an implementation, but it would
> still be too late for 1.40.

Got that. Left undocumented, as snapping and kerning yet. Other things;
\pdfobjcompresslevel, \pdflastlink, \pdfsavepos (DVI), \ifabsnum, 
\ifabsdim are done. Something missed? Check welcome.

BeSt,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From noreply at sarovar.org  Tue Feb 14 13:02:54 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Feb 2006 17:32:54 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
Message-ID: <E1F8ytS-0005MZ-00@sarovar.org>

Patches item #93, was opened at 2004-07-15 12:12
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=93&group_id=106

Category: None
Group: None
Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Martin Schr?der (oneiros)
Assigned to: The Thanh Han (hanthethanh)
Summary: \quitvmode

Initial Comment:
The change file adds a new primitive called \quitvmode.
In vertical modes, it is identical to \indent, but in
horizontal and math modes it is \noindent.

See http://www.metatex.org/web/quitvmode.html

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-14 13:02

Message:
Logged In: YES 
user_id=3344

IMHO the name should include a \...indent to be consistent
with the existing \indent/\noindent, if this primitive has
similar functionality.

And why not using a macro solution? (This means that I ask
to please add a small rationale when introducing new
primitives.)

\def\quitvmode{%
  \ifvmode
    \indent
  \else
    \noindent
  \fi}

If I make this a \protected\def (using e-\TeX) this will
also cover the cases where TeX is looking ahead and
expanding tokens (i.e., inside alignments looking for \omit,
\span etc.).  Is there any unseen advantage of the new
primitive not covered by this macro resp. plain's
\leavevmode macro?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 16:42

Message:
Logged In: YES 
user_id=421

This has been included in 1.21a

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=93&group_id=106

From noreply at sarovar.org  Tue Feb 14 13:20:54 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Feb 2006 17:50:54 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
Message-ID: <E1F8zAs-0007ML-00@sarovar.org>

Patches item #93, was opened at 2004-07-15 12:12
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=93&group_id=106

Category: None
Group: None
Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Martin Schr?der (oneiros)
Assigned to: The Thanh Han (hanthethanh)
Summary: \quitvmode

Initial Comment:
The change file adds a new primitive called \quitvmode.
In vertical modes, it is identical to \indent, but in
horizontal and math modes it is \noindent.

See http://www.metatex.org/web/quitvmode.html

----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-02-14 13:20

Message:
Logged In: YES 
user_id=1608

http://www.metatex.org/web/quitvmode.html

Bernd, this is a repository for patches. Discussion normally
takes place on the ntg-pdftex mailing list, not here.

Cheers, Taco

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-14 13:02

Message:
Logged In: YES 
user_id=3344

IMHO the name should include a \...indent to be consistent
with the existing \indent/\noindent, if this primitive has
similar functionality.

And why not using a macro solution? (This means that I ask
to please add a small rationale when introducing new
primitives.)

\def\quitvmode{%
  \ifvmode
    \indent
  \else
    \noindent
  \fi}

If I make this a \protected\def (using e-\TeX) this will
also cover the cases where TeX is looking ahead and
expanding tokens (i.e., inside alignments looking for \omit,
\span etc.).  Is there any unseen advantage of the new
primitive not covered by this macro resp. plain's
\leavevmode macro?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 16:42

Message:
Logged In: YES 
user_id=421

This has been included in 1.21a

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=93&group_id=106

From frank at debian.org  Tue Feb 14 13:49:00 2006
From: frank at debian.org (=?iso-8859-1?q?Frank_K=FCster?=)
Date: Tue, 14 Feb 2006 13:49:00 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <20060213210550.GB19626@dbs.uni-hannover.de> (Thomas Esser's
	message of "Mon, 13 Feb 2006 22:05:50 +0100")
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
	<20060213210550.GB19626@dbs.uni-hannover.de>
Message-ID: <861wy6m7gj.fsf@alhambra.kuesterei.ch>

(resending with correct From: which is subscribed)

Thomas Esser <te at dbs.uni-hannover.de> wrote:

[ about adding a switch to pdftex to use libpoppler instead of included
xdpf code ]
>> > The harder part is the autoconf magic required for the switching, and
>> > not even writing autoconf (at least not yet), but rather incorporating
>> > the changes:
>> > 
>> > On my system, "./reautoconf" does not work, instead complains:
>> > 
>> > autoconf: invalid option -m
>
> Two options:
>   1) install autoconf-2.13 and use that
>   2) try the same in my current tree (available from
>        rsync://tug.org/tetexdevsrc/).
>      That tree is already converted to autoconf-2.5x.
>
> Given the fact that Peter Breitenlohner has already worked out how to
> convert all packages that are part of teTeX (his work is now included
> in teTeX's new source tree), it should be fairly easy to make the same
> for the rest of TL, too. I honestly hope that the next version of TL
> will no longer use autoconf-2.13.

That's good news, and I think it would be best if I start with that.

However, only if I'm sure that we will be able to incorporate this into
the standalone pdftex tarball, and into texlive.  Is there any
documentation how Peter did it, and what needs to be done for simple
updates?  And are there any binaries in texlive that aren't in the teTeX
tree and already converted?

Regards, Frank
-- 
Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX)


From noreply at sarovar.org  Tue Feb 14 15:01:11 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 14 Feb 2006 19:31:11 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
Message-ID: <E1F90jv-00011R-00@sarovar.org>

Patches item #93, was opened at 2004-07-15 10:12
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=93&group_id=106

Category: None
Group: None
Status: Closed
Resolution: Fixed
Priority: 5
Submitted By: Martin Schr?der (oneiros)
Assigned to: The Thanh Han (hanthethanh)
Summary: \quitvmode

Initial Comment:
The change file adds a new primitive called \quitvmode.
In vertical modes, it is identical to \indent, but in
horizontal and math modes it is \noindent.

See http://www.metatex.org/web/quitvmode.html

----------------------------------------------------------------------

>Comment By: Hans Hagen (hagen)
Date: 2006-02-14 14:01

Message:
Logged In: YES 
user_id=927

the original name was \dontleavehmode (kind of counterpart
of \leavevmode) but taco cooked up the \quitvmode name 

(in my opinion \leavevmode often does more harm than good -)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-14 12:20

Message:
Logged In: YES 
user_id=1608

http://www.metatex.org/web/quitvmode.html

Bernd, this is a repository for patches. Discussion normally
takes place on the ntg-pdftex mailing list, not here.

Cheers, Taco

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-14 12:02

Message:
Logged In: YES 
user_id=3344

IMHO the name should include a \...indent to be consistent
with the existing \indent/\noindent, if this primitive has
similar functionality.

And why not using a macro solution? (This means that I ask
to please add a small rationale when introducing new
primitives.)

\def\quitvmode{%
  \ifvmode
    \indent
  \else
    \noindent
  \fi}

If I make this a \protected\def (using e-\TeX) this will
also cover the cases where TeX is looking ahead and
expanding tokens (i.e., inside alignments looking for \omit,
\span etc.).  Is there any unseen advantage of the new
primitive not covered by this macro resp. plain's
\leavevmode macro?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-05-13 14:42

Message:
Logged In: YES 
user_id=421

This has been included in 1.21a

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=93&group_id=106

From taco at elvenkind.com  Tue Feb 14 16:00:49 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Feb 2006 16:00:49 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
Message-ID: <43F1F0A1.5080904@elvenkind.com>



Bernd Raichle wrote:
> Ok, I move the discussion back from sarovar to the ntg-pdftex list ...

Cool, thanks.

> Thus I am still missing the rationale why a new primitive was
> introduced.  (I didn't find anything within my backlog of this list
> and the list archive is missing a search functionality.)

A functional equivalent macro of \quitvmode is:

   \protected\def\quitvmode{\ifvmode \indent \fi }

but that only works when e-TeX is enabled.

In a traditional TeX, the \if test will sometiems be executed
at the wrong time, or you end up with undesired side-effects
like \relax tokens.

So yes, the primitive is unneeded in 'pdfetex', but it was really
needed when there still was a non-etex pdftex.

Greetings, Taco



From pragma at wxs.nl  Tue Feb 14 17:15:35 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 17:15:35 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F1F0A1.5080904@elvenkind.com>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com>
Message-ID: <43F20227.8010400@wxs.nl>

Taco Hoekwater wrote:
> A functional equivalent macro of \quitvmode is:
>
>    \protected\def\quitvmode{\ifvmode \indent \fi }
>
> but that only works when e-TeX is enabled.
>   
or better: \protected\def\quitvmode{\ifvmode \primitive \indent \fi }
> In a traditional TeX, the \if test will sometiems be executed
> at the wrong time, or you end up with undesired side-effects
> like \relax tokens.
>
> So yes, the primitive is unneeded in 'pdfetex', but it was really
> needed when there still was a non-etex pdftex.
>   
Hans


-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From olaf at infovore.xs4all.nl  Tue Feb 14 19:21:14 2006
From: olaf at infovore.xs4all.nl (Olaf Weber)
Date: Tue, 14 Feb 2006 19:21:14 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <20060213163626.GD31186@lucien.oneiros.kn-bremen.de> (Martin
	=?iso-8859-1?Q?Schr=F6der's?= message of "Mon,
	13 Feb 2006 17:36:26 +0100")
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
Message-ID: <87vevh4x9h.fsf@infovore.xs4all.nl>

Martin Schr?der writes:
> On 2006-02-02 17:53:03 +0100, Frank K?ster wrote:

>> The harder part is the autoconf magic required for the switching, and
>> not even writing autoconf (at least not yet), but rather incorporating
>> the changes:
>> 
>> On my system, "./reautoconf" does not work, instead complains:
>> 
>> autoconf: invalid option -m
>> 
>> 
>> I have
>> 
>> $ autoconf --version
>> autoconf (GNU Autoconf) 2.59
>> Written by David J. MacKenzie and Akim Demaille.
>> 
>> Copyright (C) 2003 Free Software Foundation, Inc.
>> 
>> Or is there a different way to regenerate configure after changes to its
>> source files?

> There surely is, but I don't know it offhand. Our auto* experts
> are Thomas Esser (busy offline) and Olaf Weber (who should have a
> new hard disc now).

Actually, it was the system that died, with the harddisk one of the
few usable parts remaining.  But part of the fallout of all this is
that I've done little useful (TeX-wise) for some time now.

The reautoconf script in the source tree should be running the
hacked-up autoconf 2.13 that's also in the source tree.  I don't
_think_ you need autoconf 2.13 installed as well, but am not certain
at this point.  As Thomas points out, the autoconf mess should be
resolved in the nearish future by 2.13 being abandoned.

-- 
Olaf Weber

               (This space left blank for technical reasons.)


From frank at debian.org  Tue Feb 14 19:51:01 2006
From: frank at debian.org (=?iso-8859-1?q?Frank_K=FCster?=)
Date: Tue, 14 Feb 2006 19:51:01 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <87vevh4x9h.fsf@infovore.xs4all.nl> (Olaf Weber's message of
	"Tue, 14 Feb 2006 19:21:14 +0100")
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
	<87vevh4x9h.fsf@infovore.xs4all.nl>
Message-ID: <86mzgtwz8q.fsf@alhambra.kuesterei.ch>

Olaf Weber <olaf at infovore.xs4all.nl> wrote:

> The reautoconf script in the source tree should be running the
> hacked-up autoconf 2.13 that's also in the source tree.  

It should, as in "it is supposed to", but it doesn't:

frank at riesling:~/src/pdftex-1.40.0-beta-20060125/src$ head -4 reautoconf
#!/bin/sh

echo .
autoconf  -m texk/etc/autoconf

executing "./reautoconf" just calls the autoconf that's in the path.

> I don't
> _think_ you need autoconf 2.13 installed as well, but am not certain
> at this point.  As Thomas points out, the autoconf mess should be
> resolved in the nearish future by 2.13 being abandoned.

As Thomas said, most of the work has already been done.   Will this be
ported to pdftex soon?  Err, and who's going to do it?

TIA, Frank
-- 
Frank K?ster
Single Molecule Spectroscopy, Protein Folding @ Inst. f. Biochemie, Univ. Z?rich
Debian Developer (teTeX)


From martin at oneiros.de  Tue Feb 14 20:27:56 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue, 14 Feb 2006 20:27:56 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <86mzgtwz8q.fsf@alhambra.kuesterei.ch>
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
	<87vevh4x9h.fsf@infovore.xs4all.nl>
	<86mzgtwz8q.fsf@alhambra.kuesterei.ch>
Message-ID: <20060214192756.GA15052@lucien.oneiros.kn-bremen.de>

On 2006-02-14 19:51:01 +0100, Frank K?ster wrote:
> Olaf Weber <olaf at infovore.xs4all.nl> wrote:
> 
> > The reautoconf script in the source tree should be running the
> > hacked-up autoconf 2.13 that's also in the source tree.  
> 
> It should, as in "it is supposed to", but it doesn't:
> 
> frank at riesling:~/src/pdftex-1.40.0-beta-20060125/src$ head -4 reautoconf

I haven't copied all changed made by Thomas to my beta...

[...]

> As Thomas said, most of the work has already been done.   Will this be
> ported to pdftex soon?  Err, and who's going to do it?

The release will have it.

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From hartmut_henkel at gmx.de  Tue Feb 14 20:42:40 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue, 14 Feb 2006 20:42:40 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F1B729.3060307@gust.org.pl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
Message-ID: <Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>

On Tue, 14 Feb 2006, [UTF-8] Pawe? Jackowski wrote:

>
> >> 2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?
> > The pdfTeX manual is the right (only) place.
>
> Done.

newest CVS manual with newest cont-tmf.zip stops compiling here with

subsubject      : - Expandable commands
[16.14])
! Incomplete \ifx; all text was ignored after line 2034.

It's caused by \Tex {\ifabsnum}

How to do this?

Regards, Hartmut

From martin at oneiros.de  Tue Feb 14 21:17:19 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue, 14 Feb 2006 21:17:19 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
Message-ID: <20060214201719.GC15052@lucien.oneiros.kn-bremen.de>

On 2006-02-14 20:42:40 +0100, Hartmut Henkel wrote:
> On Tue, 14 Feb 2006, [UTF-8] Pawe? Jackowski wrote:
> 
> >
> > >> 2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?
> > > The pdfTeX manual is the right (only) place.
> >
> > Done.
> 
> newest CVS manual with newest cont-tmf.zip stops compiling here with
> 
> subsubject      : - Expandable commands
> [16.14])
> ! Incomplete \ifx; all text was ignored after line 2034.
> 
> It's caused by \Tex {\ifabsnum}
> 
> How to do this?

It seems \type doesn't handle \iffoo ...

Hans?

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From hartmut_henkel at gmx.de  Tue Feb 14 21:24:41 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue, 14 Feb 2006 21:24:41 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
Message-ID: <Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>

On Tue, 14 Feb 2006, Martin Schr?der wrote:

> On 2006-02-14 20:42:40 +0100, Hartmut Henkel wrote:
> > On Tue, 14 Feb 2006, [UTF-8] Pawe? Jackowski wrote:
> > >
> > > >> 2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?
> > > > The pdfTeX manual is the right (only) place.
> > >
> > > Done.
> >
> > newest CVS manual with newest cont-tmf.zip stops compiling here with
> >
> > subsubject      : - Expandable commands
> > [16.14])
> > ! Incomplete \ifx; all text was ignored after line 2034.
> >
> > It's caused by \Tex {\ifabsnum}
> >
> > How to do this?
>
> It seems \type doesn't handle \iffoo ...

yes, this works

\starttext
\def\foo#1{\type{#1}}

{\catcode`\i=12
\foo {\ifabsnum}
}

{\def\ifabsnum{\relax}
\foo {\ifabsnum}
}

\stoptext

but it's ugly.

> Hans?

Hans?

Regards, Hartmut

From vvv at vsu.ru  Tue Feb 14 21:48:45 2006
From: vvv at vsu.ru (Vladimir Volovich)
Date: Tue, 14 Feb 2006 23:48:45 +0300
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F1F0A1.5080904@elvenkind.com> (Taco Hoekwater's message of
	"Tue, 14 Feb 2006 16:00:49 +0100")
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com>
Message-ID: <8764nh7jki.fsf@vvv.vsu.ru>

"TH" == Taco Hoekwater writes:

 >> Thus I am still missing the rationale why a new primitive was
 >> introduced.  (I didn't find anything within my backlog of this
 >> list and the list archive is missing a search functionality.)
[...]
 TH> So yes, the primitive is unneeded in 'pdfetex', but it was really
 TH> needed when there still was a non-etex pdftex.

so did the need for this primitive become moot, since there will only
be pdfetex from now on? the less unneeded things, the better. :)

Best,
v.


From pragma at wxs.nl  Tue Feb 14 21:57:44 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 21:57:44 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
Message-ID: <43F24448.8000601@wxs.nl>

Martin ? wrote:
>
> It seems \type doesn't handle \iffoo ...
>
> Hans?
>   
hm, it does here in a test file, but depending on arg passing verbatim is always a bit tricky (tex doing tex -) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From pragma at wxs.nl  Tue Feb 14 22:05:28 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 22:05:28 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
Message-ID: <43F24618.5030104@wxs.nl>

Hartmut Henkel wrote:
> On Tue, 14 Feb 2006, Martin Schr?der wrote:
>
>   
>> On 2006-02-14 20:42:40 +0100, Hartmut Henkel wrote:
>>     
>>> On Tue, 14 Feb 2006, [UTF-8] Pawe? Jackowski wrote:
>>>       
>>>>>> 2. \ifabsnum, \ifabsdim; eTeX manual or pdfTeX manual?
>>>>>>             
>>>>> The pdfTeX manual is the right (only) place.
>>>>>           
>>>> Done.
>>>>         
>>> newest CVS manual with newest cont-tmf.zip stops compiling here with
>>>
>>> subsubject      : - Expandable commands
>>> [16.14])
>>> ! Incomplete \ifx; all text was ignored after line 2034.
>>>
>>> It's caused by \Tex {\ifabsnum}
>>>
>>> How to do this?
>>>       
>> It seems \type doesn't handle \iffoo ...
>>     
>
> yes, this works
>
> \starttext
> \def\foo#1{\type{#1}}
>
> {\catcode`\i=12
> \foo {\ifabsnum}
> }
>
> {\def\ifabsnum{\relax}
> \foo {\ifabsnum}
> }
>
> \stoptext
>
> but it's ugly.
>   
hm, this works here,

\def\xx#1{\type{#1}}

\starttext

\xx {\ifabsnum}

\stoptext

so, how old is your context? (there has been a bug in the code for a 
while due to a faulty fix that dealt with verbatim and tables)

(in case f real trouble one can configure a few things using 
\recodeverbatimmode; the problem with verbatim mode is that it also 
supports syntax highlighting and such  and there is no  real robust way 
to cover all situations at the same time)

Hans

-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Tue Feb 14 22:05:59 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue, 14 Feb 2006 22:05:59 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <8764nh7jki.fsf@vvv.vsu.ru>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
Message-ID: <20060214210559.GD15052@lucien.oneiros.kn-bremen.de>

On 2006-02-14 23:48:45 +0300, Vladimir Volovich wrote:
> "TH" == Taco Hoekwater writes:
>  TH> So yes, the primitive is unneeded in 'pdfetex', but it was really
>  TH> needed when there still was a non-etex pdftex.
> 
> so did the need for this primitive become moot, since there will only
> be pdfetex from now on? the less unneeded things, the better. :)

Seems so. Does anybody really use it? We could allways emulate it
in pdftex.ini... :-}

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From pragma at wxs.nl  Tue Feb 14 22:08:03 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 22:08:03 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <8764nh7jki.fsf@vvv.vsu.ru>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
Message-ID: <43F246B3.5050607@wxs.nl>

Vladimir Volovich wrote:
> "TH" == Taco Hoekwater writes:
>
>  >> Thus I am still missing the rationale why a new primitive was
>  >> introduced.  (I didn't find anything within my backlog of this
>  >> list and the list archive is missing a search functionality.)
> [...]
>  TH> So yes, the primitive is unneeded in 'pdfetex', but it was really
>  TH> needed when there still was a non-etex pdftex.
>
> so did the need for this primitive become moot, since there will only
> be pdfetex from now on? the less unneeded things, the better. :)
>   
well, it's been around since version 1.21 so ... 

if we start removing features using the etex/whatever criterium, much more can be removed and we end up with broken macro packages; (and we can probably remove 75% of the whole tex tree too -) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Tue Feb 14 22:10:37 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue, 14 Feb 2006 22:10:37 +0100
Subject: [NTG-pdftex] 1.40 Manual
In-Reply-To: <43F24618.5030104@wxs.nl>
References: <20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
Message-ID: <20060214211036.GE15052@lucien.oneiros.kn-bremen.de>

On 2006-02-14 22:05:28 +0100, Hans Hagen wrote:
> so, how old is your context? (there has been a bug in the code for a 
> while due to a faulty fix that dealt with verbatim and tables)

teTeX 3.0
ConTeXt  ver: 2005.01.31

I want a TeX package manager... :-((

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From pragma at wxs.nl  Tue Feb 14 22:15:23 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 22:15:23 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <20060214210559.GD15052@lucien.oneiros.kn-bremen.de>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<20060214210559.GD15052@lucien.oneiros.kn-bremen.de>
Message-ID: <43F2486B.9030408@wxs.nl>

Martin ? wrote:
> On 2006-02-14 23:48:45 +0300, Vladimir Volovich wrote:
>   
>> "TH" == Taco Hoekwater writes:
>>  TH> So yes, the primitive is unneeded in 'pdfetex', but it was really
>>  TH> needed when there still was a non-etex pdftex.
>>
>> so did the need for this primitive become moot, since there will only
>> be pdfetex from now on? the less unneeded things, the better. :)
>>     
>
> Seems so. Does anybody really use it? We could allways emulate it
> in pdftex.ini... :-}
>   
context uses it and i don't use pdftex.ini; i also (for the moment) support an non-etex mode

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From vvv at vsu.ru  Tue Feb 14 22:13:21 2006
From: vvv at vsu.ru (Vladimir Volovich)
Date: Wed, 15 Feb 2006 00:13:21 +0300
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F246B3.5050607@wxs.nl> (Hans Hagen's message of "Tue, 14 Feb
	2006 22:08:03 +0100")
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl>
Message-ID: <87zmkt63v2.fsf@vvv.vsu.ru>

"HH" == Hans Hagen writes:

 TH> So yes, the primitive is unneeded in 'pdfetex', but it was really
 TH> needed when there still was a non-etex pdftex.
 >> so did the need for this primitive become moot, since there will
 >> only be pdfetex from now on? the less unneeded things, the
 >> better. :)
 HH> well, it's been around since version 1.21 so ...

well... if \quitvmode has already been around in released version,
then i don't understand why the patch with it's inclusion into
pdf(e)tex is being discussed at all...

 HH> if we start removing features using the etex/whatever criterium,
 HH> much more can be removed and we end up with broken macro
 HH> packages; (and we can probably remove 75% of the whole tex tree
 HH> too -)

at least please avoid adding new unnecessary primitives in the future. :)

Best,
v.


From hartmut_henkel at gmx.de  Tue Feb 14 22:20:14 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue, 14 Feb 2006 22:20:14 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F24618.5030104@wxs.nl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
Message-ID: <Pine.LNX.4.61.0602142216490.4364@hahepc2.hahe>

On Tue, 14 Feb 2006, Hans Hagen wrote:

> hm, this works here,
>
> \def\xx#1{\type{#1}}
>
> \starttext
>
> \xx {\ifabsnum}
>
> \stoptext
>
> so, how old is your context? (there has been a bug in the code for a
> while due to a faulty fix that dealt with verbatim and tables)

it's

ConTeXt  ver: 2006.02.03 21:03  fmt: 2006.2.14  int: english  mes: english

Just downloaded it today.

Regards, Hartmut

From vvv at vsu.ru  Tue Feb 14 22:17:12 2006
From: vvv at vsu.ru (Vladimir Volovich)
Date: Wed, 15 Feb 2006 00:17:12 +0300
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2486B.9030408@wxs.nl> (Hans Hagen's message of "Tue, 14 Feb
	2006 22:15:23 +0100")
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<20060214210559.GD15052@lucien.oneiros.kn-bremen.de>
	<43F2486B.9030408@wxs.nl>
Message-ID: <87vevh63on.fsf@vvv.vsu.ru>

"HH" == Hans Hagen writes:

 HH> context uses it and i don't use pdftex.ini;

well, you can define it if it is not defined in your file (obviously
not pdftex.ini)...

Best,
v.


From hartmut_henkel at gmx.de  Tue Feb 14 22:31:13 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue, 14 Feb 2006 22:31:13 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F24618.5030104@wxs.nl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
Message-ID: <Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>

On Tue, 14 Feb 2006, Hans Hagen wrote:

> hm, this works here,
>
> \def\xx#1{\type{#1}}
>
> \starttext
>
> \xx {\ifabsnum}

Hans, does your pdftex version already know about \ifabsnum?

> \stoptext

Regards, Hartmut

From pragma at wxs.nl  Tue Feb 14 22:34:50 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 22:34:50 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <87zmkt63v2.fsf@vvv.vsu.ru>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
Message-ID: <43F24CFA.2010307@wxs.nl>

Vladimir Volovich wrote:
> at least please avoid adding new unnecessary primitives in the future. :)
>   
as said, it was neccessary at that time

it depends; for instance, when we have open type font support, older pdftex specific font things can go away (like lig prevention); but we don't want to break existing macro code so ... 

also, the 'we have now etex' argument is not that strong: etex has been around for years now, context has provides etex overloads for quite a while now, but it's only last year that (when latex went etex) etex was seen as a kind of persistent part of tex and became the default engine; and even then, one needs to keep in mind that it will take years before you can really assume that users have an etex aware versions running. (the move from bitmap to outline fonts, dvi to pdf output, cm to lm fonts, changes in (e)fmt suffixes, changed locations of map/enc files, etc, demonstrates how stretched timelines can be)

Hans 
 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From pragma at wxs.nl  Tue Feb 14 22:40:13 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 22:40:13 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
	<Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
Message-ID: <43F24E3D.2090109@wxs.nl>

Hartmut Henkel wrote:
> On Tue, 14 Feb 2006, Hans Hagen wrote:
>
>   
>> hm, this works here,
>>
>> \def\xx#1{\type{#1}}
>>
>> \starttext
>>
>> \xx {\ifabsnum}
>>     
>
> Hans, does your pdftex version already know about \ifabsnum?
>   
no, i'm on windows and will only ask fabrice to make new binaries when i have the impression that there is something stable; as long as the codebase is not really multi platform i don't want to bother him with messy merges 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From pragma at wxs.nl  Tue Feb 14 22:41:00 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 22:41:00 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
	<Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
Message-ID: <43F24E6C.3020105@wxs.nl>

Hartmut Henkel wrote:
> On Tue, 14 Feb 2006, Hans Hagen wrote:
>
>   
>> hm, this works here,
>>
>> \def\xx#1{\type{#1}}
>>
>> \starttext
>>
>> \xx {\ifabsnum}
>>     
>
> Hans, does your pdftex version already know about \ifabsnum?
>   
you can try 

\chardef\recodeverbatimmode\plusone

(grouped since we don't want to affect other verbatim code) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Tue Feb 14 22:46:01 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Tue, 14 Feb 2006 22:46:01 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
References: <43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
	<Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
Message-ID: <20060214214601.GF15052@lucien.oneiros.kn-bremen.de>

On 2006-02-14 22:31:13 +0100, Hartmut Henkel wrote:
> Hans, does your pdftex version already know about \ifabsnum?

Doesn't matter: \iftrue on line 2033 will also fail.

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From taco at elvenkind.com  Tue Feb 14 22:47:50 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Feb 2006 22:47:50 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602142216490.4364@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>	<43F09EC6.3070307@gust.org.pl>	<43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl>	<43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>	<43F24618.5030104@wxs.nl>
	<Pine.LNX.4.61.0602142216490.4364@hahepc2.hahe>
Message-ID: <43F25006.4050102@elvenkind.com>

Hartmut Henkel wrote:
> On Tue, 14 Feb 2006, Hans Hagen wrote:
> 
> 
>>hm, this works here,
>>
>>\def\xx#1{\type{#1}}
>>
>>\starttext
>>\xx {\ifabsnum}
>>\stoptext

Sure, but that is because your \ifabsnum is an undefined control
sequence, since you are still using 1.30.5 :-)

Here is a bit of equivalent plain TeX code that crashes in the
same fashion:

   \def\xx#1{\type{#1}}
   \starttext
   \xx {\iffalse}
   \stoptext

The simplest solution (for now) is to start pdftex-t.tex with :

   \let\ifabsnum\relax
   \let\ifabsdim\relax


Cheers, Taco




From taco at elvenkind.com  Tue Feb 14 22:58:46 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Feb 2006 22:58:46 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <87zmkt63v2.fsf@vvv.vsu.ru>
References: <E1F90jv-00011R-00@sarovar.org>	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>	<43F1F0A1.5080904@elvenkind.com>
	<8764nh7jki.fsf@vvv.vsu.ru>	<43F246B3.5050607@wxs.nl>
	<87zmkt63v2.fsf@vvv.vsu.ru>
Message-ID: <43F25296.7060106@elvenkind.com>

Vladimir Volovich wrote:
> well... if \quitvmode has already been around in released version,
> then i don't understand why the patch with it's inclusion into
> pdf(e)tex is being discussed at all...

Bernd was curious about it.

Cheers,
Taco

From pragma at wxs.nl  Tue Feb 14 23:04:50 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 23:04:50 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <20060214214601.GF15052@lucien.oneiros.kn-bremen.de>
References: <43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
	<Pine.LNX.4.61.0602142229460.4537@hahepc2.hahe>
	<20060214214601.GF15052@lucien.oneiros.kn-bremen.de>
Message-ID: <43F25402.8070806@wxs.nl>

Martin ? wrote:
> On 2006-02-14 22:31:13 +0100, Hartmut Henkel wrote:
>   
>> Hans, does your pdftex version already know about \ifabsnum?
>>     
>
> Doesn't matter: \iftrue on line 2033 will also fail.
>   
i have an idea for a workaroud but it needs some testing, 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From pragma at wxs.nl  Tue Feb 14 23:24:18 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 14 Feb 2006 23:24:18 +0100
Subject: [NTG-pdftex] 1.40 Manual
In-Reply-To: <20060214211036.GE15052@lucien.oneiros.kn-bremen.de>
References: <20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602142038360.3912@hahepc2.hahe>
	<20060214201719.GC15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602142122390.4225@hahepc2.hahe>
	<43F24618.5030104@wxs.nl>
	<20060214211036.GE15052@lucien.oneiros.kn-bremen.de>
Message-ID: <43F25892.2030109@wxs.nl>

Martin ? wrote:
> On 2006-02-14 22:05:28 +0100, Hans Hagen wrote:
>   
>> so, how old is your context? (there has been a bug in the code for a 
>> while due to a faulty fix that dealt with verbatim and tables)
>>     
>
> teTeX 3.0
> ConTeXt  ver: 2005.01.31
>
> I want a TeX package manager... :-((
>   
aka miktex -) 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From hartmut_henkel at gmx.de  Wed Feb 15 00:29:07 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Wed, 15 Feb 2006 00:29:07 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <43F1B729.3060307@gust.org.pl>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
Message-ID: <Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>

There are quite a few places in the manual where pdftex and pdfetex are
mentioned. Should we remove the pdfetex references (leaving one remark
at the beginning about history)? And it's now that pdftex includes all
pdfetex functionality, and the extended format writing can still be
enabled by the asterisk *, right?

Regards, Hartmut

From martin at oneiros.de  Wed Feb 15 00:46:13 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 15 Feb 2006 00:46:13 +0100
Subject: [NTG-pdftex] 1.40 Manual
In-Reply-To: <Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
Message-ID: <20060214234613.GH15052@lucien.oneiros.kn-bremen.de>

On 2006-02-15 00:29:07 +0100, Hartmut Henkel wrote:
> There are quite a few places in the manual where pdftex and pdfetex are
> mentioned. Should we remove the pdfetex references (leaving one remark
> at the beginning about history)? And it's now that pdftex includes all

Yes.

> pdfetex functionality, and the extended format writing can still be
> enabled by the asterisk *, right?

Yes. And -etex :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From reinhard.kotucha at web.de  Wed Feb 15 03:19:19 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Wed, 15 Feb 2006 03:19:19 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <87zmkt63v2.fsf@vvv.vsu.ru>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
Message-ID: <17394.36775.442712.482249@zarniwoop.ms25.local>

>>>>> "Vladimir" == Vladimir Volovich <vvv at vsu.ru> writes:

  > at least please avoid adding new unnecessary primitives in the
  > future. :)

The current situation is quite crappy.  Plenty of new primitives are
introduced each day.  Most of them are useful but some of them should
be discussed and tested before they go into the mainstream release.
Some new primitives cannot be removed or changed because people
already use them even before anything had been released.

In good old days we had pdfxtex.  Why can't we have it again?  It was
a great thing for experimental stuff.

This is the current situation:

Taco: "There is a new primitive."
Bernd: "No need for a new primitive, a macro is sufficient."
Hans: "Don't remove the primitive, Context already depends on it."

(maybe I exaggerated a bit)

Why can't we have pdfxtex again?

Martin, I know that it's more work for you but I'm convinced that it's
worth the trouble.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------



From te at dbs.uni-hannover.de  Wed Feb 15 06:08:45 2006
From: te at dbs.uni-hannover.de (Thomas Esser)
Date: Wed, 15 Feb 2006 06:08:45 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <868xsem8tn.fsf@alhambra.kuesterei.ch>
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
	<20060213210550.GB19626@dbs.uni-hannover.de>
	<868xsem8tn.fsf@alhambra.kuesterei.ch>
Message-ID: <20060215050845.GB26879@dbs.uni-hannover.de>

> However, only if I'm sure that we will be able to incorporate this into
> the standalone pdftex tarball, and into texlive.  Is there any
> documentation how Peter did it, and what needs to be done for simple
> updates?

He has put his material (patches + instructions; both excellent) here:
  ftp://ftpth.mppmu.mpg.de/pub/peb/web2c/autoconf/

Peter has also contacted several authors IIRC, so he might have additional
information beyond this.

And, as I already wrote, my current stuff is available from
  rsync://tug.org/tetexdevsrc/
and the migration has already happened there (Peter, I'd be happy if
you look at this).

>  And are there any binaries in texlive that aren't in the teTeX
> tree and already converted?

I am not aware of any. Peter?

Thomas

From P.Jackowski at gust.org.pl  Wed Feb 15 08:23:55 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Wed, 15 Feb 2006 08:23:55 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
Message-ID: <43F2D70B.7040100@gust.org.pl>

Hi,

 > ! Incomplete \ifx; all text was ignored after line 2034.

Seems I had the same problem with ConTeXt taken from last TL; as Taco 
advised, I upgraded (to 2006.02.03) and now it works fine.

> There are quite a few places in the manual where pdftex and pdfetex are
> mentioned. Should we remove the pdfetex references (leaving one remark
> at the beginning about history)? And it's now that pdftex includes all
> pdfetex functionality, and the extended format writing can still be
> enabled by the asterisk *, right?

Ye, I didn't touch this part since I still can't force -etex option to 
work. Akira says however, that his binary works ok so og ahead.

Regards,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From pragma at wxs.nl  Wed Feb 15 09:53:21 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 15 Feb 2006 09:53:21 +0100
Subject: [NTG-pdftex] 1.40 Manual (was 1.40 Schedule)
In-Reply-To: <Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl> <43F0B345.4010405@wxs.nl>
	<43F122D4.6090506@gust.org.pl> <43F18B55.8090001@elvenkind.com>
	<43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
Message-ID: <43F2EC01.1040601@wxs.nl>

Hartmut Henkel wrote:
> There are quite a few places in the manual where pdftex and pdfetex are
> mentioned. Should we remove the pdfetex references (leaving one remark
> at the beginning about history)? And it's now that pdftex includes all
> pdfetex functionality, and the extended format writing can still be
> enabled by the asterisk *, right?
>   
makes sense indeed

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From taco at elvenkind.com  Wed Feb 15 10:02:37 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Feb 2006 10:02:37 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <17394.36775.442712.482249@zarniwoop.ms25.local>
References: <E1F90jv-00011R-00@sarovar.org>	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>	<43F1F0A1.5080904@elvenkind.com>	<8764nh7jki.fsf@vvv.vsu.ru>	<43F246B3.5050607@wxs.nl>	<87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
Message-ID: <43F2EE2D.3020109@elvenkind.com>



Reinhard Kotucha wrote:
  > In good old days we had pdfxtex.  Why can't we have it again?  It was
> a great thing for experimental stuff.

But nothing seems to gets noticed until it is in the mainstream
application (and no longer marked experimental), so having a
separate pdfxtex quite likely will not help. I am not against
reviving pdfxtex, but I doubt there is much to be gained from it.

We spent the better part of yesterday talking about a primitive
that has been published a year and a half ago, and whose tracker
item has been closed since may 2005. That is hardly indicative of
an active beta-tester base.

Also, \quitvmode is not superfluous except under etex. So:

"Vladimir" == Vladimir Volovich <vvv at vsu.ru> writes:
>   > at least please avoid adding new unnecessary primitives in the
>   > future.  :) 

I vote for the removal of \indent since it is not needed in etex.
We can patch plain.ini to contain its definition as a \protected
macro.  :-)

Cheers, Taco

From olaf at infovore.xs4all.nl  Wed Feb 15 10:10:43 2006
From: olaf at infovore.xs4all.nl (Olaf Weber)
Date: Wed, 15 Feb 2006 10:10:43 +0100
Subject: [NTG-pdftex] poppler usage, autoconf
In-Reply-To: <86mzgtwz8q.fsf@alhambra.kuesterei.ch> (Frank
	=?iso-8859-1?Q?K=FCster's?= message of "Tue,
	14 Feb 2006 19:51:01 +0100")
References: <86psm5og7k.fsf@alhambra.kuesterei.ch>
	<20060213163626.GD31186@lucien.oneiros.kn-bremen.de>
	<87vevh4x9h.fsf@infovore.xs4all.nl>
	<86mzgtwz8q.fsf@alhambra.kuesterei.ch>
Message-ID: <87irrhj8bw.fsf@infovore.xs4all.nl>

Frank K?ster writes:

> Olaf Weber <olaf at infovore.xs4all.nl> wrote:
>> The reautoconf script in the source tree should be running the
>> hacked-up autoconf 2.13 that's also in the source tree.  

> It should, as in "it is supposed to", but it doesn't:

> frank at riesling:~/src/pdftex-1.40.0-beta-20060125/src$ head -4 reautoconf
> #!/bin/sh

> echo .
> autoconf  -m texk/etc/autoconf

> executing "./reautoconf" just calls the autoconf that's in the path.

If this tree is derived from the texlive source tree, there might
(should) be a reautoconf.texk in there.

>> I don't _think_ you need autoconf 2.13 installed as well, but am
>> not certain at this point.  As Thomas points out, the autoconf mess
>> should be resolved in the nearish future by 2.13 being abandoned.

> As Thomas said, most of the work has already been done.   Will this be
> ported to pdftex soon?  Err, and who's going to do it?

If it isn't fixed in the standalone pdftex tree, this kind of issue
tends to be addressed when the pdftex changes are merged back into
web2c or teTeX.

-- 
Olaf Weber

               (This space left blank for technical reasons.)


From martin at oneiros.de  Wed Feb 15 10:17:16 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 15 Feb 2006 10:17:16 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2EE2D.3020109@elvenkind.com>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com>
Message-ID: <20060215091716.GA958@lucien.oneiros.kn-bremen.de>

On 2006-02-15 10:02:37 +0100, Taco Hoekwater wrote:
> Reinhard Kotucha wrote:
>   > In good old days we had pdfxtex.  Why can't we have it again?  It was
> > a great thing for experimental stuff.
> 
> But nothing seems to gets noticed until it is in the mainstream
> application (and no longer marked experimental), so having a

Well, we could be better at advertising our new features. And it
takes months before a release really hits the machines of users
(e.g. many are still running teTeX 2). 

But I'd expect Bernd to at least follow our NEWS...

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From noreply at sarovar.org  Wed Feb 15 10:10:19 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Feb 2006 14:40:19 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \ptexnoligatures
	should leave kerning intact
Message-ID: <E1F9Ifz-0002y0-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \ptexnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 10:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From noreply at sarovar.org  Wed Feb 15 10:17:50 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Feb 2006 14:47:50 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \ptexnoligatures
	should leave kerning intact
Message-ID: <E1F9InG-0004kN-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \ptexnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 10:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From P.Jackowski at gust.org.pl  Wed Feb 15 10:32:53 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Wed, 15 Feb 2006 10:32:53 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2EE2D.3020109@elvenkind.com>
References: <E1F90jv-00011R-00@sarovar.org>	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>	<43F1F0A1.5080904@elvenkind.com>	<8764nh7jki.fsf@vvv.vsu.ru>	<43F246B3.5050607@wxs.nl>	<87zmkt63v2.fsf@vvv.vsu.ru>	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com>
Message-ID: <43F2F545.2080009@gust.org.pl>

Taco Hoekwater napisa?(a):

> But nothing seems to gets noticed until it is in the mainstream
> application (and no longer marked experimental), so having a
> separate pdfxtex quite likely will not help. I am not against
> reviving pdfxtex, but I doubt there is much to be gained from it.

Agree - it wouldn't help but I'm rather against reviving xtex. I can't 
see anything wrong in adding new features to the mainstream *if* they 
remain (some kind of) a secret. Unless not mentioned in release notes or 
documented (afair \quitmode was not), the primitive does not exist for 
the end-user but for developers. Please don't make pdf*tex's again -)

Best,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From noreply at sarovar.org  Wed Feb 15 10:58:09 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Feb 2006 15:28:09 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \ptexnoligatures
	should leave kerning intact
Message-ID: <E1F9JQH-0000Wf-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \ptexnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:58

Message:
Logged In: YES 
user_id=1608

The attached patch disallows \pdfnoligatures and \tagcode in 
non-vmodes, and restores the assignment functionality of  
\tagcode (that was an unrelated bug in 1.40-beta)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 10:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From pragma at wxs.nl  Wed Feb 15 11:13:55 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 15 Feb 2006 11:13:55 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2F545.2080009@gust.org.pl>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com> <43F2F545.2080009@gust.org.pl>
Message-ID: <43F2FEE3.4010700@wxs.nl>

Pawe? Jackowski wrote:
> Taco Hoekwater napisa?(a):
>
>   
>> But nothing seems to gets noticed until it is in the mainstream
>> application (and no longer marked experimental), so having a
>> separate pdfxtex quite likely will not help. I am not against
>> reviving pdfxtex, but I doubt there is much to be gained from it.
>>     
>
> Agree - it wouldn't help but I'm rather against reviving xtex. I can't 
> see anything wrong in adding new features to the mainstream *if* they 
> remain (some kind of) a secret. Unless not mentioned in release notes or 
> documented (afair \quitmode was not), the primitive does not exist for 
> the end-user but for developers. Please don't make pdf*tex's again -)
>   
indeed. 

also, some new features are harmless, so they quickly reach a 'stable' state while others may interfere (most noticably the font related extensions) and those are kept 'undocumented' until proven stable (may take more that a year); in the past such features even got their interfaces changed while testing; because they can be disabled (and then don't interfere) they can safely be part of the mainstream pdftex

having two versions would make testing very painful 

Hans  

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From martin at oneiros.de  Wed Feb 15 11:25:26 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Wed, 15 Feb 2006 11:25:26 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2F545.2080009@gust.org.pl>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com> <43F2F545.2080009@gust.org.pl>
Message-ID: <20060215102526.GC958@lucien.oneiros.kn-bremen.de>

On 2006-02-15 10:32:53 +0100, Pawel Jackowski wrote:
> remain (some kind of) a secret. Unless not mentioned in release notes or 
> documented (afair \quitmode was not), the primitive does not exist for 

Yes. By carefully reading NEWS you might find out that something
called quitvmode was added in 1.21a, but what it does is still a
secret. :-)

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From oberdiek at uni-freiburg.de  Wed Feb 15 12:38:58 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Wed, 15 Feb 2006 12:38:58 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2EE2D.3020109@elvenkind.com>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com>
Message-ID: <20060215113858.GA11681@irwin.vpn.uni-freiburg.de>

Hello,

On Wed, Feb 15, 2006 at 10:02:37AM +0100, Taco Hoekwater wrote:

> "Vladimir" == Vladimir Volovich <vvv at vsu.ru> writes:
> >   > at least please avoid adding new unnecessary primitives in the
> >   > future.  :) 
> 
> I vote for the removal of \indent since it is not needed in etex.
> We can patch plain.ini to contain its definition as a \protected
> macro.  :-)

Good, what about
* \batchmode, \nonstopmode, \scrollmode, and \errorstopmode?
  Making them  macros using \interactionmode?
* \topmark, \firstmark, \botmark, \mark?
  Using robust macros instead that uses an eTeX "marks" resource?
:-))

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From raichle at Informatik.Uni-Stuttgart.DE  Wed Feb 15 13:31:34 2006
From: raichle at Informatik.Uni-Stuttgart.DE (Bernd Raichle)
Date: Wed, 15 Feb 2006 13:31:34 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2EE2D.3020109@elvenkind.com>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com>
Message-ID: <17395.7974.21597.27040@isostar.informatik.uni-stuttgart.de>

Hi Taco, hi pdftex developers!


Sorry, for bringing up "old" discussions and primitive.  I hope you
are not offended by discussing these old topics.  Nonetheless I think
that some (pdf)TeX changes have to be ... better discussed/discussed
again/documented/revised/removed (choose the appropriate, please).

I have the background of being a former member of the NTS and the
e-TeX team.  Within this team we had a lot of discussions about new
primitives, how these primitives should behave, what are the
implications, the restrictions etc.  The result was that only a small
part of the discussed primitives have been implemented and only a
subset of the implemented primitives have found its way into the
official e-TeX releases.  This was and is good, because the team was
sure that the extensions are as stable as TeX is.  And it was and is
bad, because e-TeX is "only" a small extension of TeX.



On Wednesday, 15 February 2006 10:02:37 +0100,
Taco Hoekwater <taco at elvenkind.com> writes:
 > Reinhard Kotucha wrote:
 >   > In good old days we had pdfxtex.  Why can't we have it again?  It was
 > > a great thing for experimental stuff.
 > 
 > But nothing seems to gets noticed until it is in the mainstream
 > application (and no longer marked experimental), so having a
 > separate pdfxtex quite likely will not help. I am not against
 > reviving pdfxtex, but I doubt there is much to be gained from it.

Do not revive pdfxtex.  Integrate new primitive in the mainstream
application, to have them available for testing by a broader audience.
No extra pdfxtex application is needed unless a change has too many
(unwanted) side effects or is in a very unstable state.

I propose to (a) better document the new primitive/functionality (this
includes atleast a short rationale, why the current (pdf)(e-)TeX has
to be extended/changed) and (b) mark all new primitive as experimental
until there is enough positive/negative feedback to switch the status
for experimental to stable.  And probably (c) mark primitive/
functionality as deprecated if it has to be removed/replaced in the
future.

Knuth has completely rewritten TeX after a few years.  IMHO it was a
good idea to throw away TeX78 and start TeX82 (almost) from scratch.
(It was a lot easier for him at this stage as it is for pdfTeX now
because the number of users/macro packages/documents was very low.)



 > We spent the better part of yesterday talking about a primitive
 > that has been published a year and a half ago, and whose tracker
 > item has been closed since may 2005. That is hardly indicative of
 > an active beta-tester base.

Beta-tester can only test something which is documented.  I have just
found the e-mails from July 2004 in the mailing list archive.  In 2004
I was not a member of this mailing list and the pdftex development has
not been moved to sarovar.

During the last days I have browsed through short pieces of the pdftex
code and the trackers at sarovar to understand some of the
(pdf)(e-)TeX extensions integrated during the last years.  Thus there
will probably more questions about changes during the next days and
weeks :-).



 > Also, \quitvmode is not superfluous except under etex. So:
 > 
 > "Vladimir" == Vladimir Volovich <vvv at vsu.ru> writes:
 > >   > at least please avoid adding new unnecessary primitives in the
 > >   > future.  :) 
 > 
 > I vote for the removal of \indent since it is not needed in etex.
 > We can patch plain.ini to contain its definition as a \protected
 > macro.  :-)

I second this proposal! ;-}

... if we are completely switching from the stable base called "TeX"
to something which is no more document/macro compatible with "TeX".


Regards,
  -bernd

From P.Jackowski at gust.org.pl  Wed Feb 15 15:34:12 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Wed, 15 Feb 2006 15:34:12 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <20060215102526.GC958@lucien.oneiros.kn-bremen.de>
References: <E1F90jv-00011R-00@sarovar.org>	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>	<43F1F0A1.5080904@elvenkind.com>
	<8764nh7jki.fsf@vvv.vsu.ru>	<43F246B3.5050607@wxs.nl>
	<87zmkt63v2.fsf@vvv.vsu.ru>	<17394.36775.442712.482249@zarniwoop.ms25.local>	<43F2EE2D.3020109@elvenkind.com>
	<43F2F545.2080009@gust.org.pl>
	<20060215102526.GC958@lucien.oneiros.kn-bremen.de>
Message-ID: <43F33BE4.7010302@gust.org.pl>

Martin:
> Yes. By carefully reading NEWS you might find out that something
> called quitvmode was added in 1.21a, but what it does is still a
> secret. :-)

Bernd:
> Beta-tester can only test something which is documented

Both true. Thinking loudly; what about adding to
every news file (or generating some extra 'dev-news', 'pre-manual' with) 
a brief description of new features; could be taken directly from patch 
comments... I belive those comments are enough for beta-testers, while 
end-users read the manual, where only stable things are described.

Hans:
> having two versions would make testing very painful 

Ye, and having two files is much less painfull ;)
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl


From noreply at sarovar.org  Wed Feb 15 18:38:01 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Wed, 15 Feb 2006 23:08:01 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1F9QbJ-0006IH-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: Primitives
Group: None
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: The Thanh Han (hanthethanh)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

Comment By: Frank Mittelbach (mittelbach)
Date: 2006-02-15 18:38

Message:
Logged In: YES 
user_id=3421

concerning register versus individual \if... primitves: I  
agree that numeric values are less easy to read but if the  
numeric codes are well chosen then they have the advantage  
of not cluttering the code, eg if you have to test for a  
number of different cases then a set of nested \if's is  
also not really helpful. Suppose for example you have to  
do different actions depending on the type of expansion.  
Then the register allows you to do this in a since \ifcase  
or in some \ifnum ...> . But of course this only works is  
the order is adjusted to typical usages.  
  
And non-numerical ones could still be implemented  
efficently at the macro level, eg  
  
 \def\ifinedef{\ifnum 1=\currentexpansionmode} 
 
as to \stopalignscanning: this is not identical to 
\protected as protection prevents expansion in all cases 
which is not necessarily what you need 
 
my 2 cents 
frank 

----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-17 23:22

Message:
Logged In: YES 
user_id=927

concerning alignments: 

- how about adding \everyaligncell (in addition to \everycr) 

- how about the other iftests? 

- (and \nospan -) 

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-16 21:23

Message:
Logged In: YES 
user_id=3333

@None: An \ifalignscanning primitive can also help macros like LaTeX's 
\multicolumn and other code that relies on seeing \noalign or \omit to 
recover gracefully with a comprehensible error message.

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-13 05:50

Message:
Logged In: YES 
user_id=3333

Yes, just ideas here, which is why I asked for comments. We can discuss 
this on the list (once my subscription is accepted).

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 11:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 10:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 09:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

From hartmut_henkel at gmx.de  Wed Feb 15 19:50:52 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Wed, 15 Feb 2006 19:50:52 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual
In-Reply-To: <20060214234613.GH15052@lucien.oneiros.kn-bremen.de>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
	<20060214234613.GH15052@lucien.oneiros.kn-bremen.de>
Message-ID: <Pine.LNX.4.61.0602151947300.3684@hahepc2.hahe>

On Wed, 15 Feb 2006, Martin Schr?der wrote:

> > pdfetex functionality, and the extended format writing can still be
> > enabled by the asterisk *, right?
>
> Yes. And -etex :-)

Does this work with your system? I just tried in fmtutil.cnf:

    pdfetex pdftex - -translate-file=cp227.tcx -etex pdftex.ini

does _not_ switch to etex mode here. But

    pdfetex pdftex - -translate-file=cp227.tcx *pdftex.ini

does it ok.

Regards, Hartmut

From hartmut_henkel at gmx.de  Wed Feb 15 19:58:16 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Wed, 15 Feb 2006 19:58:16 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual
In-Reply-To: <Pine.LNX.4.61.0602151947300.3684@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
	<20060214234613.GH15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602151947300.3684@hahepc2.hahe>
Message-ID: <Pine.LNX.4.61.0602151956470.3725@hahepc2.hahe>

On Wed, 15 Feb 2006, Hartmut Henkel wrote:

>     pdfetex pdftex - -translate-file=cp227.tcx -etex pdftex.ini

actually it says:

hahepc1:/home/hahe# pdftex -ini  -etex -jobname=pdfetex -progname=pdfetex -translate-file=cp227.tcx pdftex.ini
pdftex: unrecognized option `-etex'
This is pdfTeXk, Version 3.141592-1.40.0-beta-20060213 (Web2C 7.5.5) (INITEX)

Regards, Hartmut

From hartmut_henkel at gmx.de  Wed Feb 15 20:05:56 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Wed, 15 Feb 2006 20:05:56 +0100 (CET)
Subject: [NTG-pdftex] 1.40 Manual
In-Reply-To: <Pine.LNX.4.61.0602151956470.3725@hahepc2.hahe>
References: <20051213125230.GC21934@lucien.oneiros.kn-bremen.de>
	<20051213144023.GF21934@lucien.oneiros.kn-bremen.de>
	<20060213003046.GD16285@lucien.oneiros.kn-bremen.de>
	<43F09EC6.3070307@gust.org.pl>
	<43F0B345.4010405@wxs.nl> <43F122D4.6090506@gust.org.pl>
	<43F18B55.8090001@elvenkind.com> <43F1B729.3060307@gust.org.pl>
	<Pine.LNX.4.61.0602150024470.5339@hahepc2.hahe>
	<20060214234613.GH15052@lucien.oneiros.kn-bremen.de>
	<Pine.LNX.4.61.0602151947300.3684@hahepc2.hahe>
	<Pine.LNX.4.61.0602151956470.3725@hahepc2.hahe>
Message-ID: <Pine.LNX.4.61.0602152005040.3828@hahepc2.hahe>

On Wed, 15 Feb 2006, Hartmut Henkel wrote:

> On Wed, 15 Feb 2006, Hartmut Henkel wrote:
>
> >     pdfetex pdftex - -translate-file=cp227.tcx -etex pdftex.ini
>
> actually it says:
>
> hahepc1:/home/hahe# pdftex -ini  -etex -jobname=pdfetex -progname=pdfetex -translate-file=cp227.tcx pdftex.ini
> pdftex: unrecognized option `-etex'
> This is pdfTeXk, Version 3.141592-1.40.0-beta-20060213 (Web2C 7.5.5) (INITEX)

ah, Akira's patch (after 20060213) should solve this. Sorry for the
noise.

Regards, Hartmut

From P.Jackowski at gust.org.pl  Thu Feb 16 08:09:29 2006
From: P.Jackowski at gust.org.pl (=?ISO-8859-2?Q?Pawe=B3_Jackowski?=)
Date: Thu, 16 Feb 2006 08:09:29 +0100
Subject: [NTG-pdftex] hash in \pdfescapestring
Message-ID: <43F42529.1060500@gust.org.pl>

Heiko,

\pdfescapestring{#}

returns doubled hash of category 12. Is that ok? I mean if it
was two hashes in category 6 it wouldn't that strange, but all the
characters returned by \pdfescape* are \other. So I think the result for
\pdfescapestring{#} should be just one hash of cat 12. ?

pdftex-1.40.0-beta-20060213
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl


From oberdiek at uni-freiburg.de  Thu Feb 16 09:43:35 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu, 16 Feb 2006 09:43:35 +0100
Subject: [NTG-pdftex] hash in \pdfescapestring
In-Reply-To: <43F42529.1060500@gust.org.pl>
References: <43F42529.1060500@gust.org.pl>
Message-ID: <20060216084335.GA23108@irwin.vpn.uni-freiburg.de>

On Thu, Feb 16, 2006 at 08:09:29AM +0100, Pawe? Jackowski wrote:

> Heiko,
> 
> \pdfescapestring{#}
> 
> returns doubled hash of category 12. Is that ok? I mean if it
> was two hashes in category 6 it wouldn't that strange, but all the
> characters returned by \pdfescape* are \other. So I think the result for
> \pdfescapestring{#} should be just one hash of cat 12. ?

It's correct. \pdfescape* call the classic routine
"tokens_to_string" to get a string representation of the tokens.
Then the escape rules are applied.

During tokens_to_string TeX doubles # in this process and
add spaces after macro names.

"tokens_to_string" calls "show_token_list", defined by original TeX;
and is called by "print_pdf_toks" that many primitives use.

Same behaviour as \message, \detokenize, ...
Example for illustration:

\nopagenumbers
\tt

\message{[#|\relax|\string#]}
\pdfescapestring{[#|\relax|\string#]}

\begingroup
  \escapechar=-1
  \message{[#|\relax]}
  \pdfescapestring{[#|\relax|\string#]}
\endgroup

\detokenize{[#|\relax|\string#]}

\begingroup
  \catcode`/=0
  \catcode`\\=12
  /message{[\relax]}
  /pdfescapestring{[\relax]}

  /detokenize{[\relax]}
/endgroup

\end

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From oberdiek at uni-freiburg.de  Thu Feb 16 10:20:24 2006
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Thu, 16 Feb 2006 10:20:24 +0100
Subject: [NTG-pdftex] hash in \pdfescapestring
In-Reply-To: <20060216084335.GA23108@irwin.vpn.uni-freiburg.de>
References: <43F42529.1060500@gust.org.pl>
	<20060216084335.GA23108@irwin.vpn.uni-freiburg.de>
Message-ID: <20060216092023.GA24483@irwin.vpn.uni-freiburg.de>

On Thu, Feb 16, 2006 at 09:43:35AM +0100, Heiko Oberdiek wrote:

> Example for illustration:

Another example that shows the purpose of the \pdfescape* primitives:

\begingroup
\obeylines
\def^^M{^^J}%
\obeyspaces
\immediate\pdfobj{<<
  /Name (String)
  /Hello#World (Hello#World)
  /abc/\relax0 (abc/\relax0)
The result is invalid PDF. With the \string\pdfescape* functions
we get valid PDF name and string objects:
  /\pdfescapename{Name} (\pdfescapestring{String})
  /\pdfescapename{Hello#World} (\pdfescapestring{Hello#World})
  /\pdfescapename{abc/\relax_x} (\pdfescapestring{abc/\relax_x})
>>}%
\endgroup

\nopagenumbers
\null
\end

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>
-- 

From P.Jackowski at gust.org.pl  Thu Feb 16 12:51:09 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Thu, 16 Feb 2006 12:51:09 +0100
Subject: [NTG-pdftex] hash in \pdfescapestring
In-Reply-To: <20060216084335.GA23108@irwin.vpn.uni-freiburg.de>
References: <43F42529.1060500@gust.org.pl>
	<20060216084335.GA23108@irwin.vpn.uni-freiburg.de>
Message-ID: <43F4672D.6030404@gust.org.pl>

Pawel:
>>returns doubled hash of category 12. Is that ok? I mean if it
>>was two hashes in category 6 it wouldn't that strange, but all the
>>characters returned by \pdfescape* are \other. So I think the result for
>>\pdfescapestring{#} should be just one hash of cat 12. ?

Heiko:
> It's correct. \pdfescape* call the classic routine
> "tokens_to_string" to get a string representation of the tokens.
> Then the escape rules are applied.
> 
> During tokens_to_string TeX doubles # in this process and
> add spaces after macro names.
> 
> "tokens_to_string" calls "show_token_list", defined by original TeX;
> and is called by "print_pdf_toks" that many primitives use.
> 
> Same behaviour as \message, \detokenize, ...

It convinces me, that all of those commands should work consequently and 
I won't insist on changing anything -)

Yes, I know it complies all character-catcode-6-rules, but was just 
thinking is there is any profit of that behaviour in the case of 
\pdfescape*. I mean

	\message{#}         -> ## (writing)
	\def\hash{##}       -> #  (reading)

is texish and is symetric. But

	\pdfescapename{#} -> #23#23
	\pdfescapehex{#} -> 2323
	\pdfescapestring{#} -> ##

is just a consequence of hash-rulez but the doubled hash is always 
redundant. And of course double hash of category 12 remains double hash

	\pdfunescapehex{#23#23} -> ##

unless \scantokened or something...

So, the fact that \pdfescape* primitives doubles a hash is unusable. In 
practise, you need to use \string# to avoid doubles and I couldn't find 
realistic example, one may need to have them doubled. But still, it is 
good that all that commands are consistent.

Best,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl


From pragma at wxs.nl  Thu Feb 16 14:50:05 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 16 Feb 2006 14:50:05 +0100
Subject: [NTG-pdftex] hash in \pdfescapestring
In-Reply-To: <43F4672D.6030404@gust.org.pl>
References: <43F42529.1060500@gust.org.pl>
	<20060216084335.GA23108@irwin.vpn.uni-freiburg.de>
	<43F4672D.6030404@gust.org.pl>
Message-ID: <43F4830D.4030501@wxs.nl>

Pawe? Jackowski wrote:
> Pawel:
>   
>>> returns doubled hash of category 12. Is that ok? I mean if it
>>> was two hashes in category 6 it wouldn't that strange, but all the
>>> characters returned by \pdfescape* are \other. So I think the result for
>>> \pdfescapestring{#} should be just one hash of cat 12. ?
>>>       
>
> Heiko:
>   
>> It's correct. \pdfescape* call the classic routine
>> "tokens_to_string" to get a string representation of the tokens.
>> Then the escape rules are applied.
>>
>> During tokens_to_string TeX doubles # in this process and
>> add spaces after macro names.
>>
>> "tokens_to_string" calls "show_token_list", defined by original TeX;
>> and is called by "print_pdf_toks" that many primitives use.
>>
>> Same behaviour as \message, \detokenize, ...
>>     
>
> It convinces me, that all of those commands should work consequently and 
> I won't insist on changing anything -)
>
> Yes, I know it complies all character-catcode-6-rules, but was just 
> thinking is there is any profit of that behaviour in the case of 
> \pdfescape*. I mean
>
> 	\message{#}         -> ## (writing)
> 	\def\hash{##}       -> #  (reading)
>
> is texish and is symetric. But
>
> 	\pdfescapename{#} -> #23#23
> 	\pdfescapehex{#} -> 2323
> 	\pdfescapestring{#} -> ##
>
> is just a consequence of hash-rulez but the doubled hash is always 
> redundant. And of course double hash of category 12 remains double hash
>
> 	\pdfunescapehex{#23#23} -> ##
>
> unless \scantokened or something...
>
> So, the fact that \pdfescape* primitives doubles a hash is unusable. In 
> practise, you need to use \string# to avoid doubles and I couldn't find 
> realistic example, one may need to have them doubled. But still, it is 
> good that all that commands are consistent.
>
>   
in generall i think that it would be handy to have a way to disable the 
hash duplication (also in the other situations), because now one 
sometimes ends up in parsing them away; something \pdfduplicatesixcode 
[0|1] or so; getting rid of the space after the \cs is more tricky since 
info about a space originaly being there is lost at that stage.

Hans


-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From P.Jackowski at gust.org.pl  Thu Feb 16 14:50:21 2006
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Thu, 16 Feb 2006 14:50:21 +0100
Subject: [NTG-pdftex] hash in \pdfescapestring
In-Reply-To: <43F4672D.6030404@gust.org.pl>
References: <43F42529.1060500@gust.org.pl>	<20060216084335.GA23108@irwin.vpn.uni-freiburg.de>
	<43F4672D.6030404@gust.org.pl>
Message-ID: <43F4831D.9090909@gust.org.pl>

> 
> 	\pdfunescapehex{#23#23} -> ##
>

Sorry for mistake, should be

\pdfunescapehex{2323} -> ##

BR,
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From hartmut_henkel at gmx.de  Thu Feb 16 19:52:52 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu, 16 Feb 2006 19:52:52 +0100 (CET)
Subject: [NTG-pdftex] do we need pdfTeXk?
Message-ID: <Pine.LNX.4.61.0602161941500.3937@hahepc2.hahe>

TeXk is there since it is a modified TeX and therefore (i guess) it had
to be given a different name.

Does a similar formal or other reason exist for pdfTeXk vs. pdfTeX?

If not, we could change all "pdfTeXk" containing messages to "pdfTeX",
as done already with the "e". The various "k" features, like "%&-line
parsing enabled." are anyway individually flagged at program start.

Regards, Hartmut

From martin at oneiros.de  Thu Feb 16 20:06:18 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu, 16 Feb 2006 20:06:18 +0100
Subject: [NTG-pdftex] do we need pdfTeXk?
In-Reply-To: <Pine.LNX.4.61.0602161941500.3937@hahepc2.hahe>
References: <Pine.LNX.4.61.0602161941500.3937@hahepc2.hahe>
Message-ID: <20060216190618.GF22739@lucien.oneiros.kn-bremen.de>

On 2006-02-16 19:52:52 +0100, Hartmut Henkel wrote:
> TeXk is there since it is a modified TeX and therefore (i guess) it had
> to be given a different name.
> 
> Does a similar formal or other reason exist for pdfTeXk vs. pdfTeX?

At least the comments

@x [1] m.2 l.188 - Web2C: extensions imply we're not pdfeTeX
@x [1] m.2 l.188 - Web2C: extensions imply we're not pdfTeX

don't make sense to me anymore.

Olaf?

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From olaf at infovore.xs4all.nl  Fri Feb 17 18:38:00 2006
From: olaf at infovore.xs4all.nl (Olaf Weber)
Date: Fri, 17 Feb 2006 18:38:00 +0100
Subject: [NTG-pdftex] do we need pdfTeXk?
In-Reply-To: <20060216190618.GF22739@lucien.oneiros.kn-bremen.de> (Martin
	=?iso-8859-1?Q?Schr=F6der's?= message of "Thu,
	16 Feb 2006 20:06:18 +0100")
References: <Pine.LNX.4.61.0602161941500.3937@hahepc2.hahe>
	<20060216190618.GF22739@lucien.oneiros.kn-bremen.de>
Message-ID: <878xs9rimf.fsf@infovore.xs4all.nl>

Martin Schr?der writes:
> On 2006-02-16 19:52:52 +0100, Hartmut Henkel wrote:

>> TeXk is there since it is a modified TeX and therefore (i guess) it had
>> to be given a different name.
>> 
>> Does a similar formal or other reason exist for pdfTeXk vs. pdfTeX?

> At least the comments

> @x [1] m.2 l.188 - Web2C: extensions imply we're not pdfeTeX
> @x [1] m.2 l.188 - Web2C: extensions imply we're not pdfTeX

> don't make sense to me anymore.

> Olaf?

It was put in for consistency with the other flavours; I don't
particularly care one way or the other.

-- 
Olaf Weber

               (This space left blank for technical reasons.)


From reinhard.kotucha at web.de  Sat Feb 18 23:24:27 2006
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat, 18 Feb 2006 23:24:27 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <43F2F545.2080009@gust.org.pl>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com> <43F2F545.2080009@gust.org.pl>
Message-ID: <17399.40603.218378.606879@zarniwoop.ms25.local>

>>>>> "Pawe$,1 b(B" == Pawe$,1 b(B Jackowski <P.Jackowski at gust.org.pl> writes:

  > Taco Hoekwater napisa$,1 b(B(a):
  >> But nothing seems to gets noticed until it is in the mainstream
  >> application (and no longer marked experimental), so having a
  >> separate pdfxtex quite likely will not help. I am not against
  >> reviving pdfxtex, but I doubt there is much to be gained from it.

  > Agree - it wouldn't help but I'm rather against reviving xtex. I
  > can't see anything wrong in adding new features to the mainstream
  > *if* they remain (some kind of) a secret. Unless not mentioned in
  > release notes or documented (afair \quitmode was not), the
  > primitive does not exist for the end-user but for
  > developers. Please don't make pdf*tex's again -)

The idea of having pdfxtex again goes into the opposite direction.

I don't think that it is a good idea to keep experimental features
secret.  Hans sais that it is more painful to have two programs in
respect of testing.  This is the case if new features are kept secret.
I think that it makes more sense to have an experimental version where
all the new features are documented.  The experimental version should
be clearly marked as experimental.  And it should be documented.  It
should be distributed along with the mainstream release so that it is
made available to a broader audience.

Though it is more work for developers to test two programs instead of
one, what I want to have is more testers.  I want to have more testers
because probably a few of them are good programmers as well.  And
there is plenty to do in the future.

Documentation is important, but I don't think it's necessary to spend
much time on it.

You might wonder that you didn't get much feedback (if at all) though
pdfxtex is part of teTeX.  Well, the reason is that only developers
know what it is.  There is a manual page which is absolutely useless.
It is just a copy of the pdftex man page.  What do you expect?

As I said before, not much documentation is needed.  A simple manpage
(less than 10 lines) which points people to

  * the pdftex manpage,
  * pdfxtex-syntax.txt,
  * a README.

It is sufficient if the README is just a collection of announcements
of new features made on this mailing list.  It's not indended for end
users and people can look into the mailing list archive or ask on this
list when they are interested.

Some time ago I read somewhere (maybe in a mail from Hans) that
probably LuaTeX will be distributed along with pdfTeX for a while
until it finally will be renamed to pdfTeX.

This is exactly what I ask for with the only exception that it should
be called pdfxtex instead of LuaTeX and other experimental stuff can
go there as well.

There is LuaTeX now and there will be Unicode-TeX and OTF-TeX in the
future and they all will be renamed to pdfTeX sooner or later.  So why
not call all the experimental stuff pdfxtex?

If you put experimental stuff into the mainstream release you have to
be absolutely sure that it does not have any unwanted side effects.
Of course, an experimental version should work, but you have more
freedom for experiments because it is for evaluation only, not for
production.

In short:  It's a matter of philosophy.  You prefer to keep things
secret, I prefer to involve more people.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-4592165
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------



From pragma at wxs.nl  Sun Feb 19 18:46:50 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 19 Feb 2006 18:46:50 +0100
Subject: [NTG-pdftex] [ pdftex-Patches-93 ] \quitvmode
In-Reply-To: <17399.40603.218378.606879@zarniwoop.ms25.local>
References: <E1F90jv-00011R-00@sarovar.org>
	<17393.60117.459466.385430@isostar.informatik.uni-stuttgart.de>
	<43F1F0A1.5080904@elvenkind.com> <8764nh7jki.fsf@vvv.vsu.ru>
	<43F246B3.5050607@wxs.nl> <87zmkt63v2.fsf@vvv.vsu.ru>
	<17394.36775.442712.482249@zarniwoop.ms25.local>
	<43F2EE2D.3020109@elvenkind.com> <43F2F545.2080009@gust.org.pl>
	<17399.40603.218378.606879@zarniwoop.ms25.local>
Message-ID: <43F8AF0A.4060900@wxs.nl>

Reinhard Kotucha wrote:
> Some time ago I read somewhere (maybe in a mail from Hans) that
> probably LuaTeX will be distributed along with pdfTeX for a while
> until it finally will be renamed to pdfTeX.
>
> This is exactly what I ask for with the only exception that it should
> be called pdfxtex instead of LuaTeX and other experimental stuff can
> go there as well.
>   
part of the problem is that we have no control over what is shipped by 
distributers; most program sthat i use have 'stable' versions and 
'experimental' versions (take ghostscript)

one of the decisions made at the informal pdftex meeting that martin, 
hartmut, taco and i had was that we should have stable versions (.40 to 
start with), maybe bug fixes t that (.41) but then instead of pdfxtex we 
can have just (eg) version .50 as the experimental one

using two binaries (and therefore two formats etc) is simply no fun;
> There is LuaTeX now and there will be Unicode-TeX and OTF-TeX in the
> future and they all will be renamed to pdfTeX sooner or later.  So why
> not call all the experimental stuff pdfxtex?
>   
.50+ .60+ .70-+
> If you put experimental stuff into the mainstream release you have to
> be absolutely sure that it does not have any unwanted side effects.
> Of course, an experimental version should work, but you have more
> freedom for experiments because it is for evaluation only, not for
> production.
>   
distributers should not put the latest pdftex (no x) in their mainstream 
release anyway; only stable versions; normally the 'tex live code freeze 
version' is the one they should use
> In short:  It's a matter of philosophy.  You prefer to keep things
> secret, I prefer to involve more people.
>   
it has nothing to do with secrecy; take thanh's font related extensions, 
often the few people who ask for it do the first testing, then provide 
feedback, and thanh changes, extends etc things; a pretty fast cycle btw 
and history shows that in that process functionality and control 
changes; so it would put a burden on documenting that in that stage; 
even now, i'm sure that the new \*code (char based glue) cannot be 
described yet, since its behaviour may change, side effects may go away 
of become part of the spec etc

the sooner things are 'documented formally' (in the manual), the more 
dependencies show up since it will be used in packages; and since 
packages are normally uncontrolled (relative to each other) ... ; 
remember what fuzz there was when pdftex replaced tex in tl: many ways 
to test pdftexness, using old (obsolete) and new primitives, etc

(in the beginning of pdftex much testing was done in version that thanh 
just send me (binaries) and by using it for aday or two in a production 
environment processing big docs, most problems could be repaired without 
the need for readme's, change lists, etc)

anyhow, it's also a matter of convenience, speed up code writing/testing 
cycles etc

Hans

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From noreply at sarovar.org  Sun Feb 19 19:19:29 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Sun, 19 Feb 2006 23:49:29 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \ptexnoligatures
	should leave kerning intact
Message-ID: <E1FAt9d-0007zC-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 15:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \ptexnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Robert (schlcht)
Date: 2006-02-19 18:19

Message:
Logged In: YES 
user_id=2217

In my opinion, this latest patch is too restrictive. It
should be sufficient to document \pdfnoligatures as one of
those commands whose scope is global to the current
paragraph (and the rest of the document), just like setting,
say, \hyphenpenalty or \hsize in the middle of a paragraph
affects the complete paragraph. The current behaviour is
also consistent with that of the hz-related stuff: \rpcode
and friends have a retroactive effect, too. (Besides, the
patch would break microtype.sty, which sets up the fonts as
they are being loaded, which would happen in horizontal
mode, mostly... ;-)

PS. If it was for me, this feature request could be closed;
I totally accept the "known limitation".


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 09:58

Message:
Logged In: YES 
user_id=1608

The attached patch disallows \pdfnoligatures and \tagcode in 
non-vmodes, and restores the assignment functionality of  
\tagcode (that was an unrelated bug in 1.40-beta)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 09:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 09:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 20:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 16:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From noreply at sarovar.org  Mon Feb 20 09:56:27 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 20 Feb 2006 14:26:27 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \pdfnoligatures should
	leave kerning intact
Message-ID: <E1FB6qJ-0001aW-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
>Summary: \pdfnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-02-20 09:56

Message:
Logged In: YES 
user_id=1608

But it is not global for the current paragraph, it is 
only applied to words that are looked at for hyphenation.
Try this test, and have a close look at the first and third
word of the paragraph. There are even stranger possibilities
when \language is taken into account.

\font\tst=cmr10
\hsize=2in
\noindent \tst efficiency efficiency \hbox{efficiency}
\pdfnoligatures\tst efficiency efficiency efficiency
\bye


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-19 19:19

Message:
Logged In: YES 
user_id=2217

In my opinion, this latest patch is too restrictive. It
should be sufficient to document \pdfnoligatures as one of
those commands whose scope is global to the current
paragraph (and the rest of the document), just like setting,
say, \hyphenpenalty or \hsize in the middle of a paragraph
affects the complete paragraph. The current behaviour is
also consistent with that of the hz-related stuff: \rpcode
and friends have a retroactive effect, too. (Besides, the
patch would break microtype.sty, which sets up the fonts as
they are being loaded, which would happen in horizontal
mode, mostly... ;-)

PS. If it was for me, this feature request could be closed;
I totally accept the "known limitation".


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:58

Message:
Logged In: YES 
user_id=1608

The attached patch disallows \pdfnoligatures and \tagcode in 
non-vmodes, and restores the assignment functionality of  
\tagcode (that was an unrelated bug in 1.40-beta)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 10:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From noreply at sarovar.org  Mon Feb 20 16:40:28 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 20 Feb 2006 21:10:28 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \pdfnoligatures should
	leave kerning intact
Message-ID: <E1FBD9I-0002IU-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 15:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \pdfnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Robert (schlcht)
Date: 2006-02-20 15:40

Message:
Logged In: YES 
user_id=2217

Ah, I didn't realize it had such confusing effects. However,
I still believe that disallowing it in non-vmode is too
restrictive.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-20 08:56

Message:
Logged In: YES 
user_id=1608

But it is not global for the current paragraph, it is 
only applied to words that are looked at for hyphenation.
Try this test, and have a close look at the first and third
word of the paragraph. There are even stranger possibilities
when \language is taken into account.

\font\tst=cmr10
\hsize=2in
\noindent \tst efficiency efficiency \hbox{efficiency}
\pdfnoligatures\tst efficiency efficiency efficiency
\bye


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-19 18:19

Message:
Logged In: YES 
user_id=2217

In my opinion, this latest patch is too restrictive. It
should be sufficient to document \pdfnoligatures as one of
those commands whose scope is global to the current
paragraph (and the rest of the document), just like setting,
say, \hyphenpenalty or \hsize in the middle of a paragraph
affects the complete paragraph. The current behaviour is
also consistent with that of the hz-related stuff: \rpcode
and friends have a retroactive effect, too. (Besides, the
patch would break microtype.sty, which sets up the fonts as
they are being loaded, which would happen in horizontal
mode, mostly... ;-)

PS. If it was for me, this feature request could be closed;
I totally accept the "known limitation".


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 09:58

Message:
Logged In: YES 
user_id=1608

The attached patch disallows \pdfnoligatures and \tagcode in 
non-vmodes, and restores the assignment functionality of  
\tagcode (that was an unrelated bug in 1.40-beta)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 09:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 09:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 20:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 16:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From noreply at sarovar.org  Mon Feb 20 17:32:54 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 20 Feb 2006 22:02:54 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \pdfnoligatures should
	leave kerning intact
Message-ID: <E1FBDy2-0007yT-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \pdfnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-20 17:32

Message:
Logged In: YES 
user_id=3344

Looking at Taco's change file, it should be possible to
break his "non-vmode fix" by inserting
\vbox{\pdfnoligatures\font} or \vadjust{\pdfligatures\font}
in hmode.

A final fix is to reimplement this \pdfnoligatures
primitive: Either do not only change the |tag| field in the
char_info for all font glyphs, but remove the ligs from the
lig/kern program.  Or save the information that no ligature
should be constructed within the hlist (using a special node
to start and end the nolig part similar to the setlanguage
whatsit nodes or by adding the nolig flag to the character
nodes).

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-20 16:40

Message:
Logged In: YES 
user_id=2217

Ah, I didn't realize it had such confusing effects. However,
I still believe that disallowing it in non-vmode is too
restrictive.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-20 09:56

Message:
Logged In: YES 
user_id=1608

But it is not global for the current paragraph, it is 
only applied to words that are looked at for hyphenation.
Try this test, and have a close look at the first and third
word of the paragraph. There are even stranger possibilities
when \language is taken into account.

\font\tst=cmr10
\hsize=2in
\noindent \tst efficiency efficiency \hbox{efficiency}
\pdfnoligatures\tst efficiency efficiency efficiency
\bye


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-19 19:19

Message:
Logged In: YES 
user_id=2217

In my opinion, this latest patch is too restrictive. It
should be sufficient to document \pdfnoligatures as one of
those commands whose scope is global to the current
paragraph (and the rest of the document), just like setting,
say, \hyphenpenalty or \hsize in the middle of a paragraph
affects the complete paragraph. The current behaviour is
also consistent with that of the hz-related stuff: \rpcode
and friends have a retroactive effect, too. (Besides, the
patch would break microtype.sty, which sets up the fonts as
they are being loaded, which would happen in horizontal
mode, mostly... ;-)

PS. If it was for me, this feature request could be closed;
I totally accept the "known limitation".


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:58

Message:
Logged In: YES 
user_id=1608

The attached patch disallows \pdfnoligatures and \tagcode in 
non-vmodes, and restores the assignment functionality of  
\tagcode (that was an unrelated bug in 1.40-beta)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 10:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From noreply at sarovar.org  Mon Feb 20 17:50:58 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 20 Feb 2006 22:20:58 +0530
Subject: [NTG-pdftex] [ pdftex-Feature Requests-385 ] \pdfnoligatures should
	leave kerning intact
Message-ID: <E1FBEFW-0001p0-00@sarovar.org>

Feature Requests item #385, was opened at 2005-07-10 17:38
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Nobody (None)
Summary: \pdfnoligatures should leave kerning intact

Initial Comment:
% The new \ptexnoligatures primitive will break the
% horizontal positioning of \mathaccents if the base
% character is slanted.
% There is no problem with \accent, nor with \mathaccent
% on upright characters:

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\ptexnoligatures\tenit % OK
\ptexnoligatures\textfont0 % = cmr10, \rm  % OK
\ptexnoligatures\textfont1 % = cmmi10, \mit % breaks shift

$\dot{A} \dot{\rm{A}} \dot{\Delta} \dot{\mit\Delta}$
{\tenit \accent'137 A}

\bye,
Robert


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2006-02-20 17:50

Message:
Logged In: YES 
user_id=1608

Maybe we should just document the weird behaviour then and
keep the thing marked experimental? 

I do not have lots of time to spend on this hack right now, 
nor do I want to, since everything I do now will have to be 
thrown out again for version 1.50.

The change file that is attached to this feature item can 
then be ignored, except for that one line that  re-enables 
\tagcode.



----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-20 17:32

Message:
Logged In: YES 
user_id=3344

Looking at Taco's change file, it should be possible to
break his "non-vmode fix" by inserting
\vbox{\pdfnoligatures\font} or \vadjust{\pdfligatures\font}
in hmode.

A final fix is to reimplement this \pdfnoligatures
primitive: Either do not only change the |tag| field in the
char_info for all font glyphs, but remove the ligs from the
lig/kern program.  Or save the information that no ligature
should be constructed within the hlist (using a special node
to start and end the nolig part similar to the setlanguage
whatsit nodes or by adding the nolig flag to the character
nodes).

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-20 16:40

Message:
Logged In: YES 
user_id=2217

Ah, I didn't realize it had such confusing effects. However,
I still believe that disallowing it in non-vmode is too
restrictive.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-20 09:56

Message:
Logged In: YES 
user_id=1608

But it is not global for the current paragraph, it is 
only applied to words that are looked at for hyphenation.
Try this test, and have a close look at the first and third
word of the paragraph. There are even stranger possibilities
when \language is taken into account.

\font\tst=cmr10
\hsize=2in
\noindent \tst efficiency efficiency \hbox{efficiency}
\pdfnoligatures\tst efficiency efficiency efficiency
\bye


----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-19 19:19

Message:
Logged In: YES 
user_id=2217

In my opinion, this latest patch is too restrictive. It
should be sufficient to document \pdfnoligatures as one of
those commands whose scope is global to the current
paragraph (and the rest of the document), just like setting,
say, \hyphenpenalty or \hsize in the middle of a paragraph
affects the complete paragraph. The current behaviour is
also consistent with that of the hz-related stuff: \rpcode
and friends have a retroactive effect, too. (Besides, the
patch would break microtype.sty, which sets up the fonts as
they are being loaded, which would happen in horizontal
mode, mostly... ;-)

PS. If it was for me, this feature request could be closed;
I totally accept the "known limitation".


----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:58

Message:
Logged In: YES 
user_id=1608

The attached patch disallows \pdfnoligatures and \tagcode in 
non-vmodes, and restores the assignment functionality of  
\tagcode (that was an unrelated bug in 1.40-beta)



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-15 10:17

Message:
Logged In: YES 
user_id=1608

We can disallow the primitive in non-vertical mode. Makes sense.

----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-15 10:10

Message:
Logged In: YES 
user_id=3344

Another limitation which should be documented:

If \ptexnoligatures<font> is applied within a paragraph, the
ligs and kerns created and inserted before this command are
removed depending if a hyphenation pass is necessary to
justify the paragraph.

\ptexnoligatures<font> has the _global_ side effect to
suppress all ligs and kerns of the font which are created
_afterwards in time_.  TeX breaks the lines of a paragraph
at the end of the paragraph.  If hyphenation has to be
applied, ligs are remapped to single chars, (implicit) kerns
are removed ... and reconstituted afterwards using the font
information valid at this (later) time.  If the font info is
changed in between, which is true if \ptexnoligatures<font>
is applied, already inserted ligs and kerns are removed.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-07-12 22:23

Message:
Logged In: YES 
user_id=421

Changing this into a feature request.

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2005-07-10 18:50

Message:
Logged In: YES 
user_id=1608

This is because it (\ptexnoligatures) also disables the
kerning information for the font. You'll have to accept that
as a "known limitation" for now.




----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=496&aid=385&group_id=106

From aa056 at chebucto.ns.ca  Thu Feb 23 19:14:16 2006
From: aa056 at chebucto.ns.ca (George N. White III)
Date: Thu, 23 Feb 2006 14:14:16 -0400
Subject: [NTG-pdftex] pdftex-1.40.0-beta-20060213 glitches for -std=c99 in
	utils.c
Message-ID: <22af238a0602231014v49e3b48fv272422f96768a381@mail.gmail.com>

On SGI Irix using MipsPro compilers, pdftexdir/utils.c fails to
compile.  DBL_EPSILON was not defined (it is defined in float.h).

In line 729, ";" should be ",".  The following patch was "tested"
(e.g., "pdftex story" seems to work) on Irix and i686 debian linux
with -std=c99 to get snprint:

gwhite at guth3: ~/W/TeX/src/pdftex-1.40.0-beta-20060213
$ nm i686-linux/texk/web2c/pdftexdir/utils.o  | fgrep snprintf
         U snprintf
         U vsnprintf


*** utils.c.orig	Fri Jan 20 21:56:17 2006
--- utils.c	Wed Feb 22 15:34:23 2006
***************
*** 32,37 ****
--- 32,38 ----
  #include <kpathsea/c-fopen.h>
  #include <string.h>
  #include <time.h>
+ #include <float.h> /* for DBL_EPSILON */

  /*@unused@*/
  static const char perforce_id[] =
***************
*** 726,732 ****
      j = 0;
      for (i = 0; i < lin; i++) {
  #if defined (__STDC_VERSION__) && __STDC_VERSION__ >=199901L
!         snprintf (buf, sizeof (buf);
  #else
          sprintf (buf,
  #endif
--- 727,733 ----
      j = 0;
      for (i = 0; i < lin; i++) {
  #if defined (__STDC_VERSION__) && __STDC_VERSION__ >=199901L
!       snprintf (buf, sizeof (buf),
  #else
          sprintf (buf,
  #endif

--
George N. White III <aa056 at chebucto.ns.ca>
Head of St. Margarets Bay, Nova Scotia

From martin at oneiros.de  Thu Feb 23 19:34:41 2006
From: martin at oneiros.de (Martin =?iso-8859-1?Q?Schr=F6der?=)
Date: Thu, 23 Feb 2006 19:34:41 +0100
Subject: [NTG-pdftex] pdftex-1.40.0-beta-20060213 glitches for -std=c99
	in utils.c
In-Reply-To: <22af238a0602231014v49e3b48fv272422f96768a381@mail.gmail.com>
References: <22af238a0602231014v49e3b48fv272422f96768a381@mail.gmail.com>
Message-ID: <20060223183441.GF29232@lucien.oneiros.kn-bremen.de>

On 2006-02-23 14:14:16 -0400, George N. White III wrote:
> In line 729, ";" should be ",".  The following patch was "tested"
> (e.g., "pdftex story" seems to work) on Irix and i686 debian linux
> with -std=c99 to get snprint:

Thanks.

Best
    Martin
-- 
                    http://www.tm.oneiros.de

From noreply at sarovar.org  Fri Feb 24 06:42:45 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 24 Feb 2006 11:12:45 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-488 ] In pdfLaTeX Turkish babel won't
	work with graphicx package
Message-ID: <E1FCVj3-0006Kj-00@sarovar.org>

Bugs item #488, was opened at 2006-02-24 07:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=488&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Nerhun YILDIZ (nerhun)
Assigned to: Martin Schr?der (oneiros)
Summary: In pdfLaTeX Turkish babel won't work with graphicx package

Initial Comment:
I use Turkish bible in MiKTeX 2.4. When I use graphics 
or graphicx package and pdfLaTeX my document it crashes 
with about 30 errors. There is no difficulty in 
LaTeXing the same document and processing DVI instead 
of PDF. Here is the piece of minimal LaTeX code that 
crashes:


\documentclass{report}
\usepackage[turkish]{babel}
\usepackage{graphicx}
\begin{document}
\end{document}

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=488&group_id=106

From noreply at sarovar.org  Fri Feb 24 11:26:54 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 24 Feb 2006 15:56:54 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-488 ] In pdfLaTeX Turkish babel won't
	work with graphicx package
Message-ID: <E1FCaA2-0004P4-00@sarovar.org>

Bugs item #488, was opened at 2006-02-24 06:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=488&group_id=106

Category: Image inclusion
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Nerhun YILDIZ (nerhun)
Assigned to: Martin Schr?der (oneiros)
Summary: In pdfLaTeX Turkish babel won't work with graphicx package

Initial Comment:
I use Turkish bible in MiKTeX 2.4. When I use graphics 
or graphicx package and pdfLaTeX my document it crashes 
with about 30 errors. There is no difficulty in 
LaTeXing the same document and processing DVI instead 
of PDF. Here is the piece of minimal LaTeX code that 
crashes:


\documentclass{report}
\usepackage[turkish]{babel}
\usepackage{graphicx}
\begin{document}
\end{document}

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2006-02-24 11:26

Message:
Logged In: YES 
user_id=1276

Hello,

Turkish.ldf makes '=' active that will break many packages.
Graphicx loads pdftex.def and pdftex.def loads supp-pdf.tex
delayed (\AtBeginDocument) that loads supp-mis.tex that
relies on '=' with catcode 12 instead of an active one.
Babel makes '=' active \AtBeginDocument. Because babel
is loaded first, '=' is made active before supp-mis.tex
is loaded.

Solutions:

* Other order of packages:
    \usepackage{graphicx}
    \usepackage[turkish]{babel}

* Fixing the catcode for stuff that is loaded
  \AtBeginDocument between babel and document start:
    \usepackage[turkish]{babel}
    \AtBeginDocument{\shorthandoff{=}}% right after babel
    \usepackage{graphicx}
    ...
    \AtBeginDocument{\shorthandon{=}}%
    % right before \begin{document}
    \begin{document}

* Also I have updated pdftex.def to 0.03o in order to
  catch some catcode problems.

The bug is related to the choice of '=' as shorthand
character in turkish.ldf. It is definitly no matter of
pdfTeX, thus the bug can be closed here.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=488&group_id=106

From noreply at sarovar.org  Fri Feb 24 13:53:14 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Fri, 24 Feb 2006 18:23:14 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-488 ] In pdfLaTeX Turkish babel won't
	work with graphicx package
Message-ID: <E1FCcRe-0004Av-00@sarovar.org>

Bugs item #488, was opened at 2006-02-24 06:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=488&group_id=106

Category: Image inclusion
Group: None
>Status: Closed
>Resolution: Rejected
>Priority: 2
Submitted By: Nerhun YILDIZ (nerhun)
Assigned to: Martin Schr?der (oneiros)
Summary: In pdfLaTeX Turkish babel won't work with graphicx package

Initial Comment:
I use Turkish bible in MiKTeX 2.4. When I use graphics 
or graphicx package and pdfLaTeX my document it crashes 
with about 30 errors. There is no difficulty in 
LaTeXing the same document and processing DVI instead 
of PDF. Here is the piece of minimal LaTeX code that 
crashes:


\documentclass{report}
\usepackage[turkish]{babel}
\usepackage{graphicx}
\begin{document}
\end{document}

----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2006-02-24 13:53

Message:
Logged In: YES 
user_id=421

Closed, as this is a LaTeX/babel/pdftex.def problem.

----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2006-02-24 11:26

Message:
Logged In: YES 
user_id=1276

Hello,

Turkish.ldf makes '=' active that will break many packages.
Graphicx loads pdftex.def and pdftex.def loads supp-pdf.tex
delayed (\AtBeginDocument) that loads supp-mis.tex that
relies on '=' with catcode 12 instead of an active one.
Babel makes '=' active \AtBeginDocument. Because babel
is loaded first, '=' is made active before supp-mis.tex
is loaded.

Solutions:

* Other order of packages:
    \usepackage{graphicx}
    \usepackage[turkish]{babel}

* Fixing the catcode for stuff that is loaded
  \AtBeginDocument between babel and document start:
    \usepackage[turkish]{babel}
    \AtBeginDocument{\shorthandoff{=}}% right after babel
    \usepackage{graphicx}
    ...
    \AtBeginDocument{\shorthandon{=}}%
    % right before \begin{document}
    \begin{document}

* Also I have updated pdftex.def to 0.03o in order to
  catch some catcode problems.

The bug is related to the choice of '=' as shorthand
character in turkish.ldf. It is definitly no matter of
pdfTeX, thus the bug can be closed here.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=488&group_id=106

From noreply at sarovar.org  Mon Feb 27 21:59:33 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:29:33 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-462 ] HZ font expansion by text
	matrix manipulation
Message-ID: <E1FDpSv-0003DN-00@sarovar.org>

Patches item #462, was opened at 2005-12-23 23:35
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

Category: Positioning
Group: v1.40.0
Status: Open
>Resolution: Later
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: The Thanh Han (hanthethanh)
Summary: HZ font expansion by text matrix manipulation

Initial Comment:
Use textmatrix Tm instead of /FontMatrix for font
expansion. Then a font file will be embedded only once
for all expansion factors. Gives smaller PDF files.
Works then also for non-embedded fonts. TrueType not
tried yet. Rough patch only, incomplete, work in
progress, no warranty, not for production.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2006-02-13 19:41

Message:
Logged In: YES 
user_id=421

The last word from Hartmut was that it's not ready yet and
he'd be working on an improved version.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2006-02-13 19:05

Message:
Logged In: YES 
user_id=2217

Will this make it into 1.40? I would love to see it included.

I've tested it a bit and did not find any problems (I'm also
using it for the pre-built microtype documentation on CTAN). 

Regards,
Robert

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=462&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:00:10 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:30:10 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-386 ] grow obj_tab and dest_names
	arrays dynamically
Message-ID: <E1FDpTW-0003EQ-00@sarovar.org>

Patches item #386, was opened at 2005-07-10 20:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106

Category: Memory allocation
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hartmut Henkel (hhenkel)
Summary: grow obj_tab and dest_names arrays dynamically

Initial Comment:
experimental patch to grow the obj_tab and dest_names
arrays dynamically; arrays initially have 1000 entries.
This required also update of file avlstuff.c.

Similar to patch-366, which did this already for the
pdf_mem array. Then all (?) pdftex-specific memory
configuration parameters, obj_tab_size,
dest_names_size, and pdf_mem_size in texmf.cnf would be
ignored.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:19:00 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:49:00 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-415 ] various extensions and fixes
Message-ID: <E1FDplk-0005d3-00@sarovar.org>

Patches item #415, was opened at 2005-08-19 09:09
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=415&group_id=106

Category: Primitives
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Martin Schr?der (oneiros)
Summary: various extensions and fixes

Initial Comment:
This is a patch for various experimental extensions:

- \pdfinsertht: return the height of an insert
(requested by Hans); this has
  similar syntax to \pdftexrevision. 

- do not fail when \pdfobj is used with an invalid
object number (requested by Hans)

- snapping: support for grid typesetting -- see
snap.txt for details

- kern before space: allow changing interword glues in
a flexible way and inserting
    a kern before certain characters --  see
kern-before-interword-glue.txt for
    details

The notes in snap.txt and
kern-before-interword-glue.txt are from email
correspondence with people interested in; hence these
notes are somewhat
informal, inaccurate or out-of-date.

How to apply:
~~~~~~~~~~~~~
cd /path/to/pdftex-1.30.0-srcdir/src/texk
patch -p1 < /path/to/pdftex-20050818.patch
cd web2c
make pdfetex


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-09-04 18:22

Message:
Logged In: YES 
user_id=421

The patch for invalid object numbers is included in 1.30.1++

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=415&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:18:49 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:48:49 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-416 ] new primitive pdflastlink
Message-ID: <E1FDplZ-0005ct-00@sarovar.org>

Patches item #416, was opened at 2005-08-19 09:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=416&group_id=106

Category: Primitives
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Ralf Utermann (ralfu)
Assigned to: Hartmut Henkel (hhenkel)
Summary: new primitive pdflastlink

Initial Comment:
This patch implements a new primitive \pdflastlink
(analogous to \pdflastannot) which returns the object
number of the last object created with \pdfstartlink.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=416&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:19:11 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:49:11 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-427 ] Character positioning patch
Message-ID: <E1FDplv-0005dD-00@sarovar.org>

Patches item #427, was opened at 2005-09-11 12:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=427&group_id=106

Category: Positioning
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hans Hagen (hagen)
Summary: Character positioning patch

Initial Comment:
Experimental patch increases resolution of /Widths
array by 1 fractional digit, makes corrections of type
")-1(" and ")1(" in the TJ array happen much less
often, particularily for CM fonts. Gives e. g. 1 % PDF
file size shrink for pdfetex web sources compiled into PDF.

Rough patch only, not for production. Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:06

Message:
Logged In: YES 
user_id=929

Patch extended: Now pdf_set_origin has (h, v) parameters,
simplifies pdf_begin_text procedure.

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 00:25

Message:
Logged In: YES 
user_id=929

Removed pdf_first_space_corr variable, as it seems that it
was defunct anyway: There was no pdf_end_string procedure
call (only place where something is done with
pdf_first_space_corr), where afterwards the pdf_h variable
(then modified by pdf_first_space_corr) would actually be
used. E. g. pdf_moveto uses pdf_last_h instead, and after
pdf_end_text there is anyway a pdf_set_origin call.

And pdf_begin_string gets simpler.

Testing welcome!

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-03 01:16

Message:
Logged In: YES 
user_id=929

patch updated: now the TJ array building in procedure
pdf_begin_string is simplified/tidied up.

Testing welcome!

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=427&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:19:40 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:49:40 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-432 ] Rules in a PDF qQ group
Message-ID: <E1FDpmO-0005di-00@sarovar.org>

Patches item #432, was opened at 2005-10-06 21:01
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

Category: Positioning
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hans Hagen (hagen)
Summary: Rules in a PDF qQ group

Initial Comment:
Put rules with their positioning on the page inside a
qQ group. Should make \pdfliteral page {...} behave
consistently after text or rules or images, as then any
positioning starts from the PDF origin; no
delta-positioning anymore. It's already being tested in
pdfluatex. Just to have it at sarovar...

Testing welcome, particularily with text and graphics
transforms by graphicx package, to spot backward
incompatibilities, if any...

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:07

Message:
Logged In: YES 
user_id=929

Update pdf_set_origin_temp: Now has (h, v) parameters.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:20:33 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:50:33 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-434 ] Remove queued map item handling
Message-ID: <E1FDpnF-0005e7-00@sarovar.org>

Patches item #434, was opened at 2005-10-13 01:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=434&group_id=106

Category: Fonts
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Taco Hoekwater (taco)
Summary: Remove queued map item handling

Initial Comment:
Remove queued map item handling from mapfile.c
==============================================

Formerly all items from \pdfmapfile{+-=mapfile} or
\pdfmapline{+-=mapline} were queued up in a list until
the next font was selected; then the whole list was
processed, e. g. all queued mapfiles or maplines read in.

When one gave \pdfmapfile{mapfile} or
\pdfmapline{mapline} without +-=, the pending list was
cleared. The only practical use for this was to prevent
reading in the default mapfile. But this can be done
simpler, without queuing.

With this patch all \pdfmapfile{+-=mapfile} or
\pdfmapline{+-=mapline} requests are processed
completely and immediately without queuing, which means
that if e. g. a \pdfmapfile{+-=mapfile} primitive is
scanned, the mapfile will be read in right away. This
happens independently from selecting a font.

When \pdfmapfile{+-=mapfile} or \pdfmapline{+-=mapline}
is scanned, and there is a default mapfile, it is read
first and then the mapfile. Reading of the default
mapfile can be disabled by \pdfmapfile{} or
\pdfmapline{} or \pdfmapfile{mapfile} or
\pdfmapline{mapline} without +-= as long as the default
mapfile hasn't already been read in.

Latest when the first font is requested, the default
mapfile will be read, if this hasn't already been
disabled by the mentioned primitives. Apart from
possibly reading the default mapfile, there is no other
action when a font is requested, since the
\pdfmapfile{+-=mapfile} or \pdfmapline{+-=mapline}
primitives have already acted right away when they were
called.

The effects of this patch are the following:

* Initial mapfile reading still can be blocked in the
usual way.

* The difficult to describe queuing mechanism has gone,
code gets simpler.

* Mapfile reading happens directly by the primitives.

* Therefore it's possible to use \pdfretval with the
primitives, to check success of the mapfile/line
reading (not yet implemented).

* As the return value is connected to the \pdfmapfile
or \pdfmapline call, one can easier implement other map
setting primitives and give them return values. This
was not possible before, as the queuing was inbetween.

* For any standard use, the patch should be compatible
to the former queuing method.

The mapfile.c is a patched version of the mapfile.c
from Thanh's subfont patch pdftex-20050924.patch.gz for
pdftex-1.30.3.

Hope it doesn't sound too messy :-) For discussion.

Regards, Hartmut



----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=434&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:20:42 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:50:42 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-438 ] \pdfsavepos in DVI mode
Message-ID: <E1FDpnO-0005eG-00@sarovar.org>

Patches item #438, was opened at 2005-10-16 23:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

Category: Positioning
>Group: v1.40.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Hartmut Henkel (hhenkel)
Summary: \pdfsavepos in DVI mode

Initial Comment:
\pdfsavepos in DVI mode

Hello,

using \pdfsavepos in a package of mine (tabularht)
I was wondering, why \pdfsavepos is not allowed to
work in DVI mode. \pdfsavepos in PDF mode is based
on cur_h and cur_v, both coming from the DVI frontend.

The only difference I found is that the PDF format
and pdfTeX's PDF mode know about page dimensions.
Thus the directions of the axes are the same for
the PDF format and the values of \pdfsavepos
(\pdflastxpos, \pdflastypos).
  Origin:          lower left corner
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

The DVI case doesn't know about page dimensions, thus
I suggest using cur_h=0 and cur_v=0 as origin. It is
the left upper corner of the box that is being shipped
out.
  Origin:          left upper corner of the box
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

Thus the absolute values differ in both modes and I
don't see that this can be avoided. However, if the
application uses a reference point then the relative
values are exactly the same.

The attachted patch enables and implements \pdfsavepos
for the DVI mode. It also contains the patch for
bug 437 (Two \immediate cancel themselves).

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>


----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-10-17 13:39

Message:
Logged In: YES 
user_id=1276

Hello,

I have now extended the patch: \pdfpagewidth/height
are now used for the page dimensions. Also the
funny DVI origin offset of 1in is taken into
account. Thus the values in DVI and PDF mode are
the same. The exception is \pdf{h,v}origin. If
the value is not 1in, then the values differ in
DVI and PDF mode. However, also the DVI and PDF
output will differ in this case. Thus the different
values are then ok, I think.
  If someone wants to have the same values, he just
sets \pdfpage{width,height} and let \pdf{h,v}origin
untouched.

Hartmut Henkel wrote:
> to give page dimension info for pdftex also in
> DVI mode, one could implement the standard
> \special{papersize=x,y} also in pdftex (parallel
> to \pdfpagewidth/height), so that it would be
> scanned, and also go into the DVI file. Would
> this help?

I think, not really:
* Scanning of \specials are done in PDF mode already,
  but here it is not really necessary, the current
  drivers know about \pdfpage{width,height}.
* In DVI mode, the scanning of \special's contents
  must then be added to set \pdfpage{width,height}.
  But who needs this actually?
  * Relative positioning with \pdfsavepos works
    with or without the correct page size
    information.
  * Absolute positioning is more difficult in use
    (If you are somewhere in a box, how do you
    want to apply absolute positions?)
  * If someone insist on absolute positioning,
    he will probably not rely on an accidentally
    issued \special{papersize=...}. He will probably
    make sure, that the papersize information
    is set and then he can also set
    \pdfpage{width,height}.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

PS: The name of the patch file is now
    "v2-pdftex.ch.diff". And I have removed
    the patch of fixed bug 437.


----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-17 00:16

Message:
Logged In: YES 
user_id=929

to give page dimension info for pdftex also in DVI mode, one
could implement the standard \special{papersize=x,y} also in
pdftex (parallel to \pdfpagewidth/height), so that it would
be scanned, and also go into the DVI file. Would this help?

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:21:22 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:51:22 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-469 ] \currentexpansionmode +
	\ifalignscanning - \ifinedef
Message-ID: <E1FDpo2-0005eb-00@sarovar.org>

Patches item #469, was opened at 2006-01-12 02:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

Category: Primitives
>Group: v1.40.0
Status: Open
Resolution: Postponed
Priority: 5
Submitted By: Morten H?gholm (morten)
Assigned to: The Thanh Han (hanthethanh)
Summary: \currentexpansionmode + \ifalignscanning - \ifinedef

Initial Comment:
Here's a patch made against pdftex-1.40.0-alpha-20060111.  It 
removes the \ifinedef primitive for a different primitive, namely 
\currentexpansionmode. This read-only register is 0 when doing 
regular typesetting, 1 when inside \edef or \xdef and 2 in other 
cases of full expansion with scan_toks. It could possibly be 
extended to distinguish between \marks and \write etc. Comments 
more than welcome on this one!

I have also added an \ifalignscanning test. It is true whenever TeX 
is looking for \noalign etc. so is most useful for a 
\stopalignscanning function defined as 
  \def\stopalignscanning{\ifalignscanning\relax\fi}


----------------------------------------------------------------------

Comment By: Frank Mittelbach (mittelbach)
Date: 2006-02-15 18:38

Message:
Logged In: YES 
user_id=3421

concerning register versus individual \if... primitves: I  
agree that numeric values are less easy to read but if the  
numeric codes are well chosen then they have the advantage  
of not cluttering the code, eg if you have to test for a  
number of different cases then a set of nested \if's is  
also not really helpful. Suppose for example you have to  
do different actions depending on the type of expansion.  
Then the register allows you to do this in a since \ifcase  
or in some \ifnum ...> . But of course this only works is  
the order is adjusted to typical usages.  
  
And non-numerical ones could still be implemented  
efficently at the macro level, eg  
  
 \def\ifinedef{\ifnum 1=\currentexpansionmode} 
 
as to \stopalignscanning: this is not identical to 
\protected as protection prevents expansion in all cases 
which is not necessarily what you need 
 
my 2 cents 
frank 

----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-17 23:22

Message:
Logged In: YES 
user_id=927

concerning alignments: 

- how about adding \everyaligncell (in addition to \everycr) 

- how about the other iftests? 

- (and \nospan -) 

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-16 21:23

Message:
Logged In: YES 
user_id=3333

@None: An \ifalignscanning primitive can also help macros like LaTeX's 
\multicolumn and other code that relies on seeing \noalign or \omit to 
recover gracefully with a comprehensible error message.

----------------------------------------------------------------------

Comment By: Morten H?gholm (morten)
Date: 2006-01-13 05:50

Message:
Logged In: YES 
user_id=3333

Yes, just ideas here, which is why I asked for comments. We can discuss 
this on the list (once my subscription is accepted).

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-01-12 11:22

Message:
Logged In: YES 
user_id=1608

Like Hans, I also prefer separate if primitives, mainly
because I do not want to have to remember the meanings 
of the possible integer values (for that reason, I'm not 
too happy about \currentgrouptype either). 

Taco

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2006-01-12 10:14

Message:
Logged In: NO 

i wonder why we need \ifalignscanning or \stopalignscanner
at all when
eTeX already has this feature - any \protected macro stops the
scanning.


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-01-12 09:08

Message:
Logged In: YES 
user_id=927

somehow i think that if's are a better idea than a register
because in your case the register only registers one case at
the same time

(when i saw this patch the first time, i wondered why not a
complete set was implemented) 

- ifincsname
- ifinedef
- ifinwrite
- ifinspecial
- ifinpdfliteral 
- ifinannotbody
- ifinmessage (special case of write)
- ifinalign
- ifinmark 

probably some more (ok, normally all those conditions can
comfortably be catched in a macro package but if we add
them, we should be complete 

in addition to this there can be a register which keeps
track of the innermost one (we can have ifcsname inside an
edef inside an align 

concerning the \stopalignscanner i think it's better to have
something primitive like \crcr, say \endalign because using
if's can have its own problem 

(we should not worry to much about a name clash, since one
can always let it to another one); so, we should wait with
adding this patches till (1) we agree and (2) it is complete 

remark: also, it's dangerous to add patched before a decent
decission/interface is dediced upon; once it's in, we cannot
change it any more 


Hans 

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=469&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:21:58 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:51:58 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-386 ] grow obj_tab and dest_names
	arrays dynamically
Message-ID: <E1FDpoc-0005ev-00@sarovar.org>

Patches item #386, was opened at 2005-07-10 20:29
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106

Category: Memory allocation
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hartmut Henkel (hhenkel)
Summary: grow obj_tab and dest_names arrays dynamically

Initial Comment:
experimental patch to grow the obj_tab and dest_names
arrays dynamically; arrays initially have 1000 entries.
This required also update of file avlstuff.c.

Similar to patch-366, which did this already for the
pdf_mem array. Then all (?) pdftex-specific memory
configuration parameters, obj_tab_size,
dest_names_size, and pdf_mem_size in texmf.cnf would be
ignored.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=386&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:22:53 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:52:53 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-415 ] various extensions and fixes
Message-ID: <E1FDppV-0005fI-00@sarovar.org>

Patches item #415, was opened at 2005-08-19 09:09
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=415&group_id=106

Category: Primitives
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: The Thanh Han (hanthethanh)
Assigned to: Martin Schr?der (oneiros)
Summary: various extensions and fixes

Initial Comment:
This is a patch for various experimental extensions:

- \pdfinsertht: return the height of an insert
(requested by Hans); this has
  similar syntax to \pdftexrevision. 

- do not fail when \pdfobj is used with an invalid
object number (requested by Hans)

- snapping: support for grid typesetting -- see
snap.txt for details

- kern before space: allow changing interword glues in
a flexible way and inserting
    a kern before certain characters --  see
kern-before-interword-glue.txt for
    details

The notes in snap.txt and
kern-before-interword-glue.txt are from email
correspondence with people interested in; hence these
notes are somewhat
informal, inaccurate or out-of-date.

How to apply:
~~~~~~~~~~~~~
cd /path/to/pdftex-1.30.0-srcdir/src/texk
patch -p1 < /path/to/pdftex-20050818.patch
cd web2c
make pdfetex


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2005-09-04 18:22

Message:
Logged In: YES 
user_id=421

The patch for invalid object numbers is included in 1.30.1++

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=415&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:23:32 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:53:32 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-416 ] new primitive pdflastlink
Message-ID: <E1FDpq8-0006WJ-00@sarovar.org>

Patches item #416, was opened at 2005-08-19 09:42
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=416&group_id=106

Category: Primitives
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Ralf Utermann (ralfu)
Assigned to: Hartmut Henkel (hhenkel)
Summary: new primitive pdflastlink

Initial Comment:
This patch implements a new primitive \pdflastlink
(analogous to \pdflastannot) which returns the object
number of the last object created with \pdfstartlink.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=416&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:24:06 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:54:06 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-427 ] Character positioning patch
Message-ID: <E1FDpqg-0006WU-00@sarovar.org>

Patches item #427, was opened at 2005-09-11 12:39
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=427&group_id=106

Category: Positioning
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hans Hagen (hagen)
Summary: Character positioning patch

Initial Comment:
Experimental patch increases resolution of /Widths
array by 1 fractional digit, makes corrections of type
")-1(" and ")1(" in the TJ array happen much less
often, particularily for CM fonts. Gives e. g. 1 % PDF
file size shrink for pdfetex web sources compiled into PDF.

Rough patch only, not for production. Testing welcome.

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:06

Message:
Logged In: YES 
user_id=929

Patch extended: Now pdf_set_origin has (h, v) parameters,
simplifies pdf_begin_text procedure.

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 00:25

Message:
Logged In: YES 
user_id=929

Removed pdf_first_space_corr variable, as it seems that it
was defunct anyway: There was no pdf_end_string procedure
call (only place where something is done with
pdf_first_space_corr), where afterwards the pdf_h variable
(then modified by pdf_first_space_corr) would actually be
used. E. g. pdf_moveto uses pdf_last_h instead, and after
pdf_end_text there is anyway a pdf_set_origin call.

And pdf_begin_string gets simpler.

Testing welcome!

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-03 01:16

Message:
Logged In: YES 
user_id=929

patch updated: now the TJ array building in procedure
pdf_begin_string is simplified/tidied up.

Testing welcome!

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=427&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:25:41 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:55:41 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-432 ] Rules in a PDF qQ group
Message-ID: <E1FDpsD-0006XU-00@sarovar.org>

Patches item #432, was opened at 2005-10-06 21:01
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

Category: Positioning
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Hans Hagen (hagen)
Summary: Rules in a PDF qQ group

Initial Comment:
Put rules with their positioning on the page inside a
qQ group. Should make \pdfliteral page {...} behave
consistently after text or rules or images, as then any
positioning starts from the PDF origin; no
delta-positioning anymore. It's already being tested in
pdfluatex. Just to have it at sarovar...

Testing welcome, particularily with text and graphics
transforms by graphicx package, to spot backward
incompatibilities, if any...

Regards, Hartmut

----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-09 15:07

Message:
Logged In: YES 
user_id=929

Update pdf_set_origin_temp: Now has (h, v) parameters.

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=432&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:26:55 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:56:55 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-434 ] Remove queued map item handling
Message-ID: <E1FDptP-0006Xr-00@sarovar.org>

Patches item #434, was opened at 2005-10-13 01:08
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=434&group_id=106

Category: Fonts
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Hartmut Henkel (hhenkel)
Assigned to: Taco Hoekwater (taco)
Summary: Remove queued map item handling

Initial Comment:
Remove queued map item handling from mapfile.c
==============================================

Formerly all items from \pdfmapfile{+-=mapfile} or
\pdfmapline{+-=mapline} were queued up in a list until
the next font was selected; then the whole list was
processed, e. g. all queued mapfiles or maplines read in.

When one gave \pdfmapfile{mapfile} or
\pdfmapline{mapline} without +-=, the pending list was
cleared. The only practical use for this was to prevent
reading in the default mapfile. But this can be done
simpler, without queuing.

With this patch all \pdfmapfile{+-=mapfile} or
\pdfmapline{+-=mapline} requests are processed
completely and immediately without queuing, which means
that if e. g. a \pdfmapfile{+-=mapfile} primitive is
scanned, the mapfile will be read in right away. This
happens independently from selecting a font.

When \pdfmapfile{+-=mapfile} or \pdfmapline{+-=mapline}
is scanned, and there is a default mapfile, it is read
first and then the mapfile. Reading of the default
mapfile can be disabled by \pdfmapfile{} or
\pdfmapline{} or \pdfmapfile{mapfile} or
\pdfmapline{mapline} without +-= as long as the default
mapfile hasn't already been read in.

Latest when the first font is requested, the default
mapfile will be read, if this hasn't already been
disabled by the mentioned primitives. Apart from
possibly reading the default mapfile, there is no other
action when a font is requested, since the
\pdfmapfile{+-=mapfile} or \pdfmapline{+-=mapline}
primitives have already acted right away when they were
called.

The effects of this patch are the following:

* Initial mapfile reading still can be blocked in the
usual way.

* The difficult to describe queuing mechanism has gone,
code gets simpler.

* Mapfile reading happens directly by the primitives.

* Therefore it's possible to use \pdfretval with the
primitives, to check success of the mapfile/line
reading (not yet implemented).

* As the return value is connected to the \pdfmapfile
or \pdfmapline call, one can easier implement other map
setting primitives and give them return values. This
was not possible before, as the queuing was inbetween.

* For any standard use, the patch should be compatible
to the former queuing method.

The mapfile.c is a patched version of the mapfile.c
from Thanh's subfont patch pdftex-20050924.patch.gz for
pdftex-1.30.3.

Hope it doesn't sound too messy :-) For discussion.

Regards, Hartmut



----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=434&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:29:21 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:59:21 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-466 ] \primitive and \ifprimitive
Message-ID: <E1FDpvl-0006Yi-00@sarovar.org>

Patches item #466, was opened at 2006-01-07 17:22
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

Category: Primitives
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 4
Submitted By: Taco Hoekwater (taco)
Assigned to: Martin Schr?der (oneiros)
Summary: \primitive and \ifprimitive

Initial Comment:
This patch implements two new primitives:

  \primitive \par

This will run the 'primitive' command \par, even if it 
has been re- or undefined in the meantime. \primitive
is not expandable, because it may be asked to execute
unexpandable primitives as well as expandable ones.

If you supply a nonexistant primitive, it will be 
ignored (no error is raised).

The second primitive is a new type of \if:

  \ifprimitive \par ... \else .. \fi

returns true if the current meaning of \par is the
'primitive' command \par.


The patch is against alpha-20051226, i hope that is not 
too old (?). I expect to do at least one minor update 
during the beta cycle, after the pdftex code is 
flattened. It was quite a struggle to make this 
change file work ok, and as a result, there are 
a few ugly web hacks.


----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-14 08:17

Message:
Logged In: YES 
user_id=3344

IMHO it would be better to rephrase the above to (and change
the implementation accordingly :-():

<quote mode="changed">
\primitive is expandable, because it may asked to execute
expandable primitives as well as unexpandable ones.

\primitive<cs> will expand to one token, the original TeX
primitive.  This token will then be processed further as usual.
</quote>


If \primitive is left unexpandable, a lot of programming
techniques seems to be unavailable, e.g., all redefined
expandable primitives in expandable-only context.

Or any assignment to the get the original primitive, like

\edef\orignumber{\expandafter\noexpand\primitive\number}

\expandafter\let\expandafter\orignumber\primitive\number


Sidenote: The new \primitive seems to implement a subset of
a full-blown namespace mechanism.  If (pdf)TeX would have
namespaces, one simply has to access the appropriate token
within the "primitive" namespace (e.g. \primitive::number to
 access the original \number primitive, assuming the
notation \<namespace>::<csname>).  How about choosing an
appropriate namespace mechanism for (pdf)TeX and
implementing it instead?

----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2006-02-13 18:56

Message:
Logged In: YES 
user_id=1608

We need to think about this. 

I see your point, but making \primitive expandable forces
the introduction of un-redefinable tokens, and that has its
own problematic side-effects (like slowing down each and
every definition). I welcome third opinions on whether the 
benefits outweigh that downside.

At one point I tried making the expandability depend on the
referred primitive, but that gave me headaches at the
implementation stage (a pity, because that would have been
nice).

Yet another solution is to have an expandable command as
well as an unexpandable command (two primitives instead of
just the single \primitive).

On the side note: I will happily write an implementation ...
but only if someone comes up with a specification that works
under all conditions instead of only under specific
programming styles :-)



----------------------------------------------------------------------

Comment By: Bernd Raichle (bernd)
Date: 2006-02-13 17:40

Message:
Logged In: YES 
user_id=3344

IMHO it would be better to rephrase the above to (and change
the implementation accordingly :-():

<quote mode="changed">
\primitive is expandable, because it may asked to execute
expandable primitives as well as unexpandable ones.

\primitive<cs> will expand to one token, the original TeX
primitive.  This token will then be processed further as usual.
</quote>


If \primitive is left unexpandable, a lot of programming
techniques seems to be unavailable, e.g., all redefined
expandable primitives in expandable-only context.

Or any assignment to the get the original primitive, like

\edef\orignumber{\expandafter\noexpand\primitive\number}

\expandafter\let\expandafter\orignumber\primitive\number


Sidenote: The new \primitive seems to implement a subset of
a full-blown namespace mechanism.  If (pdf)TeX would have
namespaces, one simply has to access the appropriate token
within the "primitive" namespace (e.g. \primitive::number to
 access the original \number primitive, assuming the
notation \<namespace>::<csname>).  How about choosing an
appropriate namespace mechanism for (pdf)TeX and
implementing it instead?

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=466&group_id=106

From noreply at sarovar.org  Mon Feb 27 22:27:28 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 02:57:28 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-438 ] \pdfsavepos in DVI mode
Message-ID: <E1FDptw-0006Y4-00@sarovar.org>

Patches item #438, was opened at 2005-10-16 23:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

Category: Positioning
>Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Hartmut Henkel (hhenkel)
Summary: \pdfsavepos in DVI mode

Initial Comment:
\pdfsavepos in DVI mode

Hello,

using \pdfsavepos in a package of mine (tabularht)
I was wondering, why \pdfsavepos is not allowed to
work in DVI mode. \pdfsavepos in PDF mode is based
on cur_h and cur_v, both coming from the DVI frontend.

The only difference I found is that the PDF format
and pdfTeX's PDF mode know about page dimensions.
Thus the directions of the axes are the same for
the PDF format and the values of \pdfsavepos
(\pdflastxpos, \pdflastypos).
  Origin:          lower left corner
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

The DVI case doesn't know about page dimensions, thus
I suggest using cur_h=0 and cur_v=0 as origin. It is
the left upper corner of the box that is being shipped
out.
  Origin:          left upper corner of the box
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

Thus the absolute values differ in both modes and I
don't see that this can be avoided. However, if the
application uses a reference point then the relative
values are exactly the same.

The attachted patch enables and implements \pdfsavepos
for the DVI mode. It also contains the patch for
bug 437 (Two \immediate cancel themselves).

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>


----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-10-17 13:39

Message:
Logged In: YES 
user_id=1276

Hello,

I have now extended the patch: \pdfpagewidth/height
are now used for the page dimensions. Also the
funny DVI origin offset of 1in is taken into
account. Thus the values in DVI and PDF mode are
the same. The exception is \pdf{h,v}origin. If
the value is not 1in, then the values differ in
DVI and PDF mode. However, also the DVI and PDF
output will differ in this case. Thus the different
values are then ok, I think.
  If someone wants to have the same values, he just
sets \pdfpage{width,height} and let \pdf{h,v}origin
untouched.

Hartmut Henkel wrote:
> to give page dimension info for pdftex also in
> DVI mode, one could implement the standard
> \special{papersize=x,y} also in pdftex (parallel
> to \pdfpagewidth/height), so that it would be
> scanned, and also go into the DVI file. Would
> this help?

I think, not really:
* Scanning of \specials are done in PDF mode already,
  but here it is not really necessary, the current
  drivers know about \pdfpage{width,height}.
* In DVI mode, the scanning of \special's contents
  must then be added to set \pdfpage{width,height}.
  But who needs this actually?
  * Relative positioning with \pdfsavepos works
    with or without the correct page size
    information.
  * Absolute positioning is more difficult in use
    (If you are somewhere in a box, how do you
    want to apply absolute positions?)
  * If someone insist on absolute positioning,
    he will probably not rely on an accidentally
    issued \special{papersize=...}. He will probably
    make sure, that the papersize information
    is set and then he can also set
    \pdfpage{width,height}.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

PS: The name of the patch file is now
    "v2-pdftex.ch.diff". And I have removed
    the patch of fixed bug 437.


----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-17 00:16

Message:
Logged In: YES 
user_id=929

to give page dimension info for pdftex also in DVI mode, one
could implement the standard \special{papersize=x,y} also in
pdftex (parallel to \pdfpagewidth/height), so that it would
be scanned, and also go into the DVI file. Would this help?

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

From noreply at sarovar.org  Tue Feb 28 01:24:52 2006
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Tue, 28 Feb 2006 05:54:52 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-438 ] \pdfsavepos in DVI mode
Message-ID: <E1FDsfc-0001Aa-00@sarovar.org>

Patches item #438, was opened at 2005-10-16 21:52
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

Category: Positioning
Group: v1.30.0
Status: Open
Resolution: Accepted
Priority: 5
Submitted By: Heiko Oberdiek (oberdiek)
Assigned to: Hartmut Henkel (hhenkel)
Summary: \pdfsavepos in DVI mode

Initial Comment:
\pdfsavepos in DVI mode

Hello,

using \pdfsavepos in a package of mine (tabularht)
I was wondering, why \pdfsavepos is not allowed to
work in DVI mode. \pdfsavepos in PDF mode is based
on cur_h and cur_v, both coming from the DVI frontend.

The only difference I found is that the PDF format
and pdfTeX's PDF mode know about page dimensions.
Thus the directions of the axes are the same for
the PDF format and the values of \pdfsavepos
(\pdflastxpos, \pdflastypos).
  Origin:          lower left corner
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

The DVI case doesn't know about page dimensions, thus
I suggest using cur_h=0 and cur_v=0 as origin. It is
the left upper corner of the box that is being shipped
out.
  Origin:          left upper corner of the box
  horizontal axis: values increasing from left to right
  vertical axis:   values increasing from bottom to top
  unit:            sp

Thus the absolute values differ in both modes and I
don't see that this can be avoided. However, if the
application uses a reference point then the relative
values are exactly the same.

The attachted patch enables and implements \pdfsavepos
for the DVI mode. It also contains the patch for
bug 437 (Two \immediate cancel themselves).

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>


----------------------------------------------------------------------

Comment By: Hans Hagen (hagen)
Date: 2006-02-28 00:24

Message:
Logged In: YES 
user_id=927

positioning has always been available in dvi mode as well by
means of specials and postprocessing the dvi file (first by
a script by taco, later by the dvipos program that comes
with dvipdfmx);

btw, when you mean 'the current drivers' you refer to latex,
and you cannot assume that those are used outside latex, so
that is no real reference -) 

in a similar fashion the dvipos functionality is no real
reference either since it is mainly meant for appending info
to the context second-pass-info file; anyhow, since pdftex
is now the standard engine, there is no need to support the
dvipos specials (apart from backward compatibility in context)

because we had a "pos:papersize w h" special, dvipos could
provide the same reference frame as when using the pdftex
primitives; therefore,  using the pdfpagewidth and
pdfpageheight specification as in the suggested latest
patch) is the best way to go (at least for context) 

(Since we now have pdfpagewidth/height in dvi mode, we get
less and less \pdfprimitives that complain in dvi mode) 
 
Hans 


----------------------------------------------------------------------

Comment By: Heiko Oberdiek (oberdiek)
Date: 2005-10-17 11:39

Message:
Logged In: YES 
user_id=1276

Hello,

I have now extended the patch: \pdfpagewidth/height
are now used for the page dimensions. Also the
funny DVI origin offset of 1in is taken into
account. Thus the values in DVI and PDF mode are
the same. The exception is \pdf{h,v}origin. If
the value is not 1in, then the values differ in
DVI and PDF mode. However, also the DVI and PDF
output will differ in this case. Thus the different
values are then ok, I think.
  If someone wants to have the same values, he just
sets \pdfpage{width,height} and let \pdf{h,v}origin
untouched.

Hartmut Henkel wrote:
> to give page dimension info for pdftex also in
> DVI mode, one could implement the standard
> \special{papersize=x,y} also in pdftex (parallel
> to \pdfpagewidth/height), so that it would be
> scanned, and also go into the DVI file. Would
> this help?

I think, not really:
* Scanning of \specials are done in PDF mode already,
  but here it is not really necessary, the current
  drivers know about \pdfpage{width,height}.
* In DVI mode, the scanning of \special's contents
  must then be added to set \pdfpage{width,height}.
  But who needs this actually?
  * Relative positioning with \pdfsavepos works
    with or without the correct page size
    information.
  * Absolute positioning is more difficult in use
    (If you are somewhere in a box, how do you
    want to apply absolute positions?)
  * If someone insist on absolute positioning,
    he will probably not rely on an accidentally
    issued \special{papersize=...}. He will probably
    make sure, that the papersize information
    is set and then he can also set
    \pdfpage{width,height}.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

PS: The name of the patch file is now
    "v2-pdftex.ch.diff". And I have removed
    the patch of fixed bug 437.


----------------------------------------------------------------------

Comment By: Hartmut Henkel (hhenkel)
Date: 2005-10-16 22:16

Message:
Logged In: YES 
user_id=929

to give page dimension info for pdftex also in DVI mode, one
could implement the standard \special{papersize=x,y} also in
pdftex (parallel to \pdfpagewidth/height), so that it would
be scanned, and also go into the DVI file. Would this help?

Regards, Hartmut

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=438&group_id=106

From hartmut_henkel at gmx.de  Tue Feb 28 18:27:20 2006
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Tue, 28 Feb 2006 18:27:20 +0100 (CET)
Subject: [NTG-pdftex] [pdftex] pdftex, dvipdfmx, encguide
In-Reply-To: <44044EDC.9060709@wxs.nl>
References: <200602272117.k1RLHRi20887@f7.net>
	<Pine.LNX.4.64.0602280839540.3077@hahepc1.hahe>
	<20060228.140321.231485051.wl@gnu.org> <44044EDC.9060709@wxs.nl>
Message-ID: <Pine.LNX.4.64.0602281809470.3194@hahepc1.hahe>

On Tue, 28 Feb 2006, Hans Hagen wrote:

> Werner LEMBERG wrote:
> > > > I thought I'd pass on this recent note from Werner about pdftex
> > > > generating a much larger file than dvipdfmx.  [...]
> > > >
> > > thanks a lot. Very interesting! This was done with 1.21a, but even
> > > the new 1.40.0-beta is not better.
> >
> > This is the very reason why pdftex is a bad choice for documents
> > written in a CJK script.
> >
> indeed, although i remember that thanh looked into it (or was going to
> look into it)
>
> it should be put high on the agenda

it is there, now :-) The /Encoding in the embedded Type1 font file
should be independent from an external encoding. Currently the external
encoding is duplicated also in the font, unnecessarily, as this info is
ignored anyway, due to the full external /Encoding. So we might have
similar fonts in the PDF that differ only by their unused encodings.

I believe we should keep the original /Encoding inside the font intact
(unused anyway, only for information), using the value pairs coming with
the font file. We can reduce the size of the /Encoding vector in the
font so that only the entries of actually used glyphs are there. E. g.
if an external /Encoding says

13 --> /foo

and the internal original encoding says

55 --> /foo

then if 13 --> /foo is typeset by pdftex, we need to lookup /foo in some
hash or tree for the font file so we get the original 55 which goes into
the subsetted font file stream. I'll try this. Then there is some magic
needed to trigger glyph activation in one PFB file only...

Regards, Hartmut

