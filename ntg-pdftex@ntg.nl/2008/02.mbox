From noreply at sarovar.org  Mon Feb  4 15:13:46 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 04 Feb 2008 19:43:46 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-908 ] corrupted SMask
Message-ID: <E1JM24w-0006lY-00@sarovar.org>

Bugs item #908, was opened at 2008-01-26 11:04
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=908&group_id=106

Category: Image inclusion
Group: v1.40.6
>Status: Closed
Resolution: Works For Me
Priority: 5
Submitted By: Robert (schlcht)
Assigned to: Martin Schr?der (oneiros)
Summary: corrupted SMask

Initial Comment:
if an image with transparency is included, its SMask
will contain funny stuff. with the attached image, for
example, parts of the map file will be written to the
pdf file (don't open it in a viewer but an editor!).

\pdfcompresslevel0
\pdfximage{transp.png}
\pdfrefximage\pdflastximage

\bye


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-01-28 13:47

Message:
Logged In: YES 
user_id=421

Iff you are using Cygwin, then of course Cygwin ist the
problem. :-)

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2008-01-28 13:34

Message:
Logged In: YES 
user_id=2217

Here's the PDF I get (with 1.40.6 as well as 1.50). The
SMask object looks like this:
-----------------------
8 0 obj <<
/Type /XObject
/Subtype /Image
/Width 100
/Height 100
/BitsPerComponent 8
/ColorSpace /DeviceGray
/Length 20000
>>
stream
[10,000 chars]orunska-Regular " encantt-texnansi
ReEncodeFont " <antt-texnansi.enc <anttr.pfb
texnansi-anttrcap AntykwaTorunska-Regular "
encanttcap-texnansi ReEncodeFont " <anttcap-texnansi.enc
<anttr.pfb
texnansi-anttri AntykwaTorunska-Italic " encantt-texnansi
ReEncodeFont " <antt-texnansi.enc <anttri.pfb
texnansi-anttricap AntykwaTorunska-Italic "
encanttcap-texnansi ReEncodeFont " <anttcap-texnansi.enc
<anttri.pfb
[etc., until length of 20,000 is reached]
-----------------------
cygwin, again?


----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-01-26 17:35

Message:
Logged In: YES 
user_id=421

I can't reproduce this with either 1.40.5, 1.40.6-rc1, trunk
or stable.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=908&group_id=106

From noreply at sarovar.org  Mon Feb  4 15:14:05 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Mon, 04 Feb 2008 19:44:05 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-909 ] pdflatex does not respond,
	probably hitting an endless loop condition
Message-ID: <E1JM25F-0006lf-00@sarovar.org>

Bugs item #909, was opened at 2008-01-26 13:27
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=909&group_id=106

Category: None
Group: v1.40.3
>Status: Closed
>Resolution: Rejected
Priority: 5
Submitted By: Jorgen Moth (unijm)
Assigned to: Nobody (None)
Summary: pdflatex does not respond, probably hitting an endless loop condition

Initial Comment:
A number of students at the Danish Technical 
University has experienced pdflatex being captured in 
an internal endless, cpu-consuming loop. Typically the 
students utilize texmaker (who submits pdflatex jobs 
with default option -interaction=nonstopmode) to 
generate their reports. Due to errors in the input 
latex files not being corrected immediately by the 
students, this way of working stresses the pdflatex 
engine, and a number of looping conditions have 
occured. Enclosed please find an example of a setup 
which is able to reproduce the looping error. The 
error will appear by running "pdflatex report" and 
answer with an empty line (CR) when a figure can't be 
located and otherwise with "R" when an error appears, 
thus emulating the -interaction=nonstopmode used by 
texmaker. You quickly reach the no-response, but very 
cpu-time consuming condition. It is our hope that you 
will easily with your knowledge of the internals of 
pdflatex locate and fix this very annoying problem.
Best regards
Jorgen Moth
jorgen.moth at uni-c.dk
(www.uni-c.dk)

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-01-26 17:37

Message:
Logged In: YES 
user_id=421

Please provide a minimal self contained test case proving
that this is indeed a problem of pdftex.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=909&group_id=106

From jlaurens at users.sourceforge.net  Fri Feb  8 12:44:02 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Fri, 8 Feb 2008 12:44:02 +0100
Subject: [NTG-pdftex] Synchronization
Message-ID: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>

Hi,

I'd like to know the opinion of the developer team about  
synchronization and the patch I sent.

Now that xpdf allows both forwards and backwords synchronization, it  
might be time to raise the question.

JL

From taco at elvenkind.com  Fri Feb  8 13:52:23 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 08 Feb 2008 13:52:23 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
Message-ID: <47AC5087.6060407@elvenkind.com>

LAURENS J?r?me wrote:
> Hi,
> 
> I'd like to know the opinion of the developer team about  
> synchronization and the patch I sent.

I looked at Synchronize4.zip a while back and liked the general idea
well enough, but somehow never got around to writing up my feelings.

Here are a few remarks and questions:

* how does this patch relate to the --src-specials switch from web2c,
   and what editor/previewer combinations understand your files format?
   (and/or are likely to start doing that in the future)

* I consider the |if s>3| test in get_node() pretty bad style. There
   may very well be a conflicting extension in the future, and then it
   may turn out that your code suddenly needs rewriting. It is better
   to adjust the node-specific functions like new_null_box() etc.

   This will result in more lines of web changes, but it will be easier
   to maintain the code by someone that is not you.

* the web glue code in synchronize.c is not very pretty, but I doubt
   there is a nice solution to that, so just let it be.

* you should use actual C comments, though. Not the C++ // things.
   (Martin may have something more to say about C indentation style)

* you licensed the C file as GPL2, yes?

* the attachments seem missing in sarovar.org at the moment

Best wishes,
Taco

From jlaurens at users.sourceforge.net  Sat Feb  9 02:47:46 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Sat, 9 Feb 2008 02:47:46 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47AC5087.6060407@elvenkind.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
	<47AC5087.6060407@elvenkind.com>
Message-ID: <1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>


Le 8 f?vr. 08 ? 13:52, Taco Hoekwater a ?crit :

> LAURENS J?r?me wrote:
>> Hi,
>> I'd like to know the opinion of the developer team about   
>> synchronization and the patch I sent.
>
> I looked at Synchronize4.zip a while back and liked the general idea
> well enough, but somehow never got around to writing up my feelings.
>
> Here are a few remarks and questions:
>
> * how does this patch relate to the --src-specials switch from web2c,

No common code
better design
stronger design
better result

>
> and what editor/previewer combinations understand your files format?
> (and/or are likely to start doing that in the future)

I understand your question: you are wondering if this feature would be  
used by a viewer or an editor.
Anyone who ever used synchronization does not ask this question  
because he knows that such a synchronization is a "must have".

But let me give more technical answers.

- editors/viewers currently supporting .pdfsync files will most  
certainly support this new file format,
because from the editor/viewer developer point of view, supporting  
this new format is much easier than supporting the old pdfsync.
- Integrated TeX environments like iTeXMac2 or TeXShop on Mac OS X  
will support this feature because they want to provide the user a  
really efficient experience.
- this new synchronization scheme is conceptually well designed, and  
won't break where src-ltx, src-specials and pdfsync would break
- this synchronization scheme works the same for dvi or pdf

Next question is: how hard is it to support this new feature?

There are 2 possibilities, first, we can let things evolve according  
to nature's law and see what happens.
Second, we can help things go the right way. More precisely, I see 2  
possible designs, both relying on a synchronization controller, named  
"synchronizer"
Consider

1 - editor
2 - synchronizer
3 - viewer

forwards sync:

design 1:
- given a source file and a line number,  editor asks the synchronizer  
to display the output for that location in the source
- The synchronizer then parses the .sync file, finds out the real page  
and location to display, then asks the viewer to display it

design 2:
given a source file and a line number,  editor asks the synchronizer  
for the corresponding page number and location
The synchronizer then parses the .sync file, finds out the real page  
and location to display, and returns the result to the editor
Then the editor asks the viewer to display the result

backwards sync:

design 1:
given a pdf/dvi page and location, the viewer asks the synchronizer to  
display the intput for that location
The synchronizer then parses the .sync file, finds out the real line  
number and input source file to edit, then asks the editor to edit it

design 2:
given a pdf page and location, the viewer asks the synchronizer for  
the intput corresponding to that location
The synchronizer then parses the .sync file, finds out the real line  
number and input source file to edit, tand returns the result to the  
viewer
Then the viewer asks the editor to edit the result

The question is: where does the synchronizer live?

For integrated TeX environments, this controller should be integrated,  
just like the editor and the viewer are integrated.
But in general, the controller should be an external component(I vote  
for a ruby script)
to which the viewer and the editor would send messages. And this  
controller would be the same for all editors and viewers!

This is nothing but a MVC design: the model is the .sync file, the  
view is either the viewer or the editor, and both don't care about  
what is really inside the .sync file.

Once the synchronization controller is available as an external  
script, xpdf (forthcoming 3.0.3) would support synchronization with an  
appropriate config file.
I guess that auctex support would take just a few minutes.


>
>
> * I consider the |if s>3| test in get_node() pretty bad style. There
> may very well be a conflicting extension in the future, and then it
> may turn out that your code suddenly needs rewriting. It is better
> to adjust the node-specific functions like new_null_box() etc.
>
>
> This will result in more lines of web changes, but it will be easier
> to maintain the code by someone that is not you.

If you are talking about code design, I would follow you if you could  
explain what kind of extensions you are thinking of.

The actual synchronization rules are simple
- only nodes with size>3 are used for synchronization
- when a node is used for synchronization, the last 2 words are  
reserved for synchronization
- medium_node_size'd and box_node_size'd nodes are synchronized
- every type of node is a potential candidate for forthcoming  
enhancements in synchronization

By spreding initialization to many different places, you propose to  
create a set of rules and code for each type of node, mutliplying the  
synchronization hook points.
I have the impression that maintaining such a code would be a pain,  
even for the programmer!

However, if we want to initialize the nodes properly, we can do so in  
the node-specific function.
Unfortunately, those functions are not always used to create new nodes  
and one must take care of other routines.
But, how can we be sure that all the locations where initialization  
should take place are found? Any clue?

Another important problem concerns memory management.
I would not swear there is no memory leak.

>
>
> * the web glue code in synchronize.c is not very pretty, but I doubt
> there is a nice solution to that, so just let it be.

yes, this is not a strong design. I guess that everything could be  
made in web
but I don't know how (I don't want to;!), and I think it would have a  
non negligible computational cost when typesetting.

>
>
> * you should use actual C comments, though. Not the C++ // things.
> (Martin may have something more to say about C indentation style)
>
>
> * you licensed the C file as GPL2, yes?

Open source, whether GPL2 or something else, I don't know for sure  
because I was not given any hint about pdftex development rules.

>
>
> * the attachments seem missing in sarovar.org at the moment

All the attachments have been removed, there might be a good reason,  
should I upload once again?

>
>
> Best wishes,
> Taco
>


From taco at elvenkind.com  Sat Feb  9 09:43:59 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 09 Feb 2008 09:43:59 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>
	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
Message-ID: <47AD67CF.4030208@elvenkind.com>


Hi J?r?me,

LAURENS J?r?me wrote:
>>
>> * how does this patch relate to the --src-specials switch from web2c,
> 
> No common code
> better design
> stronger design
> better result

Does that mean that eventually we may get rid of --src-specials
completely? (That would be good). Right now, we will probably have
both at the same time and I was a little worried that they might
interfere with eachother. From you long explanation below, I now
understand that they don't.

>> and what editor/previewer combinations understand your files format?
>> (and/or are likely to start doing that in the future)
> 
> I understand your question: you are wondering if this feature would be  
> used by a viewer or an editor.
> Anyone who ever used synchronization does not ask this question  
> because he knows that such a synchronization is a "must have".

Thanks for the long technical answer as well. So far, I have never
really used editor synchronization tools in my TeX work. Personally,
I always found that the semi-automatic window changes were very
distracting. I have never been much of a fan of integrated TeX systems
either, for much the same reason (this is a matter of personal taste,
so don't take it as a critique on your patch).

>> This will result in more lines of web changes, but it will be easier
>> to maintain the code by someone that is not you.
> 
> If you are talking about code design, I would follow you if you could  
> explain what kind of extensions you are thinking of.

You made a convincing argument, so just leave it as is.

To give you an idea of what I am talking about, here is the list of
nodes that have size>3 already even without your patch in luatex
(you could consider luatex an extension to pdftex):

Core output nodes:       disc, box, rule, glyph, margin_kern

Whatits that are output: pdf_refxform, pdf_refximage,
                          pdf_annot, pdf_dest, pdf_thread,

Internal stream nodes:   ins_node, page_ins_node

Internal whatsits:       dir, open, local_par, pdf_colorstack,
                          user_defined

Temporary math objects:  style, radical_noad, accent_noad,
(about everything)       fraction_noad, noad

Alignment stack entries: align_stack

Paragraph breaking:      hyphenated, unhyphenated, passive, delta

Weird ones:              shape, pseudo_line
(variable size)

Some of those are candidates for synchronization, but many are not.
A whole bunch of them is never written to the output at all.

Like I said, leave your code as is. But I want to show you how
it would also have been possible (luatex pascal web, not pdftex,
but it does not really matter):

--
   @d box_node_size=8+synchronization_field_size
      {number of words to allocate for a box node}
--
   @p function new_null_box:pointer; {creates a new box node}
   var p:pointer; {the new node}
   begin p:=new_node(hlist_node,min_quarterword);
+ @<Initialize |list_node| synchronization fields@>;
   new_null_box:=p;
   end;
--
   @p function new_kern(@!w:scaled):pointer;
   var p:pointer; {the new node}
   begin p:=new_node(kern_node,normal);
   width(p):=w;
+ @<Initialize |medium_node| synchronization fields@>;
   new_kern:=p;
   end;
--
  ... etc
--
+ glue_node: begin
+  @<Synchronization dvi hook: output glue info@>;
+  @<Move right or output leaders@>;
+ end;
--
+ @ All synchronization stuff is handled in this section
+
+ @d synchronization_field_size==2
+
+ @<Initialize |list_node| synchronization fields@>=
+ begin
+ mem[p+box_node_size].int := synctag;
+ mem[p+box_node_size+1].int := line;
+ end
+ ....
+
+ @ @<Synchronization dvi hook: output glue info@>=
+ sync_glue(p);
+ ...

The main advantages:

* a person changing new_null_nox() can immediately see there
   is something going on with synchronization
* all the actual synchronization code is bundled together,
   allowing better documentation
* there may be a bit more code, but less initialization
   instructions are actually executed by the application.

>> * you licensed the C file as GPL2, yes?
> 
> Open source, whether GPL2 or something else, I don't know for sure  
> because I was not given any hint about pdftex development rules.

GPL2 is fine, just making sure.

>> * the attachments seem missing in sarovar.org at the moment
> 
> All the attachments have been removed, there might be a good reason,  
> should I upload once again?

I don't know why they were removed in the first place. Martin,
is that something you did?

Best wishes,
Taco


From hanthethanh at gmail.com  Sat Feb  9 11:06:09 2008
From: hanthethanh at gmail.com (The Thanh Han)
Date: Sat, 9 Feb 2008 11:06:09 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47AD67CF.4030208@elvenkind.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
	<47AC5087.6060407@elvenkind.com>
	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
	<47AD67CF.4030208@elvenkind.com>
Message-ID: <20080209100609.GY31469@localhost.localdomain>

I myself never used synchronization, however I believe
this is a very useful feature for a lot of users and if this
is supported by pdftex/luatex, many editors/viewers will
make use of it.

so, here is my vote for accepting Jerome's patch.

Thanh

From taco at elvenkind.com  Sat Feb  9 11:11:30 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 09 Feb 2008 11:11:30 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <20080209100609.GY31469@localhost.localdomain>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>
	<20080209100609.GY31469@localhost.localdomain>
Message-ID: <47AD7C52.9080603@elvenkind.com>

The Thanh Han wrote:
> 
> so, here is my vote for accepting Jerome's patch.

I never explicitly said so, but I am in favor as well.

The // comments really need fixing, though. The language is
C, not C++, and pdftex is not always compiled with gcc.


Best wishes,
Taco

From martin at oneiros.de  Sat Feb  9 13:17:15 2008
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Sat, 9 Feb 2008 13:17:15 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47AD67CF.4030208@elvenkind.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
	<47AC5087.6060407@elvenkind.com>
	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
	<47AD67CF.4030208@elvenkind.com>
Message-ID: <68c491a60802090417g5e8ce238k10f84e0332cdc888@mail.gmail.com>

2008/2/9, Taco Hoekwater <taco at elvenkind.com>:
> LAURENS J?r?me wrote:
> > Open source, whether GPL2 or something else, I don't know for sure
> > because I was not given any hint about pdftex development rules.
>
> GPL2 is fine, just making sure.

GPL2++, actually.

> >> * the attachments seem missing in sarovar.org at the moment
> >
> > All the attachments have been removed, there might be a good reason,
> > should I upload once again?
>
> I don't know why they were removed in the first place. Martin,
> is that something you did?

Seems to be a Sarovar problem. Note that it does not say that there
are no attachements; it just doesn't display them. The last line of
the page is "Existing Files:" -- wherever they are. :-(

Best
   Martin

From martin at oneiros.de  Sat Feb  9 13:22:37 2008
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Sat, 9 Feb 2008 13:22:37 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47AD7C52.9080603@elvenkind.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
	<47AC5087.6060407@elvenkind.com>
	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
	<47AD67CF.4030208@elvenkind.com>
	<20080209100609.GY31469@localhost.localdomain>
	<47AD7C52.9080603@elvenkind.com>
Message-ID: <68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>

2008/2/9, Taco Hoekwater <taco at elvenkind.com>:
> The Thanh Han wrote:
> > so, here is my vote for accepting Jerome's patch.
>
> I never explicitly said so, but I am in favor as well.

Me too.

> The // comments really need fixing, though. The language is
> C, not C++, and pdftex is not always compiled with gcc.

Once I get the code again, I'll polish it up.

Jerome, just send me the code per mail or try to attach it to #871 again.

Best
   Martin

From noreply at sarovar.org  Sat Feb  9 13:04:15 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Sat, 09 Feb 2008 17:34:15 +0530
Subject: [NTG-pdftex] [ pdftex-Patches-871 ] Synchronization: pdfsync.sty
	embedded (1)
Message-ID: <E1JNoRL-0006AE-00@sarovar.org>

Patches item #871, was opened at 2007-09-30 10:56
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=871&group_id=106

Category: User interaction
>Group: v1.50.0
Status: Open
>Resolution: Accepted
Priority: 5
Submitted By: Jerome LAURENS (jlaurens)
Assigned to: Martin Schr?der (oneiros)
Summary: Synchronization: pdfsync.sty embedded (1)

Initial Comment:
To the administrator, please remove the preceding patch submission

The purpose is to implement some extensions very useful for 
synchronization, both forwards and backwards. Synchronization is the 
ability for a text editor and a pdf viewer to work together, displaying the 
same thing at the same time. For example, a text editor can ask a pdf 
viewer to display and outline the character in the output corresponding to 
the character under the cursor.
Attached is a zip file containing diff against version 1.40.4, explanations 
and demonstrations in
synchronize.readme/synchronize+frames.pdf

PS: I have problems with my connection

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2008-01-29 10:40

Message:
Logged In: NO 

The pdfsync package is a tremendous boost in the
productivity for everyone that learns about it, specially
when working with pdf files of more than a couple of pages.
The synchronization between pdf viewer and tex editor is
essential for keeping track of the changes you are doing
without having to search over lots of .tex files or having
to scroll over the entire pdf to find the relevant section.
My work on latex is mainly done on Mac OS X using
eclipse+texlipse+pdftex and the Skim PDF reader and with my
discovery of pdfsync, the whole experience of writting latex
documents have improved to the point i would not use
anything else. So i would love to have this feature included
as soon as possible so it can become a standard and avoid
any package incompatibilities.

Also, it is well known that the syncrhonization feature has
been present a very long time for latex output to .dvi files
and i think it is the time to bring this essential feature
to the pdftex world to achieve the same level of functionality.

Regards,
Juan Ram?n Gonz?lez, Granada, Spain

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2008-01-28 10:50

Message:
Logged In: NO 

I understand the issue correctly, Laurens' suggested modification of pdftex 
would make synchronization a (potential) standard in all TeX installations 
and formats, without package incompatibilities. This should be regarded as 
an improvement over present implementations of this essential feature, at 
least essential for those who, like Schremmer, spend hours each day going 
back and forth between TeX source and pdf output.

Please add it soon,

Josep Maria Font
Barcelona 

----------------------------------------------------------------------

Comment By: Nobody (None)
Date: 2008-01-26 06:23

Message:
Logged In: NO 

As someone who spends hours everyday going back and forth between source 
and pdf with TeXShop under OSX 10.4.11, any improvement in the 
synchronization would be invaluable and so would Laurens's improvement.

Regards
--Schremmer

----------------------------------------------------------------------

Comment By: Jerome LAURENS (jlaurens)
Date: 2008-01-24 19:31

Message:
Logged In: YES 
user_id=4698

Ok, I found some time to make the necessary corrections and improvements.

The attached file contains explanations and examples about synchronization. 
The patch.diff file is the result of the "svn diff" command against the latest 
trunk (as of 01/24/08)
Compared to the previous versions, the command line switch now works 
properly and there is now a mean to take into account the x and y offset that 
may be used by a postprocessor like dvipdf.

Well, it is very difficult to find any kind of information/help about pdftex 
development, so please don't be too crude with me.

----------------------------------------------------------------------

Comment By: Robert (schlcht)
Date: 2007-12-19 17:21

Message:
Logged In: YES 
user_id=2217

Also, the command line switch seems to be broken. It only
works with \synchronize=1 in the source here.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2007-12-18 15:50

Message:
Logged In: YES 
user_id=421

Please update the patch against trunk and please use svn
diff. I refuse to look at this patch more closely since the
diff includes all the .svn files.

----------------------------------------------------------------------

Comment By: Jerome LAURENS (jlaurens)
Date: 2007-10-15 09:21

Message:
Logged In: YES 
user_id=4698

Synchronize3.zip is available.
It just adds a flag in the .sync file to indicate whether dvi or pdf mode was used.
So far I have found only one problem, using dvips or dvipdf with a concrete 
offset (-x and -y options) will break the synchronization. If such a filter is gentle 
enough to indicate that it used a custom offset, then viewers can take this into 
account and the synchronization is not broken. Viewers will check the above 
mentionned flag to look for customized offset.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2007-10-01 00:00

Message:
Logged In: YES 
user_id=421

You didn't attach Synchronize 2.zip yet...

----------------------------------------------------------------------

Comment By: Jerome LAURENS (jlaurens)
Date: 2007-09-30 23:10

Message:
Logged In: YES 
user_id=4698

Synchronize 2.zip is a version extending the previous one. Now synchronization 
works the same for both dvi and pdf output modes.


----------------------------------------------------------------------

Comment By: Jerome LAURENS (jlaurens)
Date: 2007-09-30 23:09

Message:
Logged In: YES 
user_id=4698

Synchronize 2.zip is a version extending the previous one. Now synchronization 
works the same for both dvi and pdf output modes.

----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=495&aid=871&group_id=106

From jlaurens at users.sourceforge.net  Sun Feb 10 19:48:26 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Sun, 10 Feb 2008 19:48:26 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
	<47AC5087.6060407@elvenkind.com>
	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
	<47AD67CF.4030208@elvenkind.com>
	<20080209100609.GY31469@localhost.localdomain>
	<47AD7C52.9080603@elvenkind.com>
	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>
Message-ID: <97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>

Hi folks,

I have made a real effort to improve the code.
I have removed the C++ comments, and tried to follow the english C  
formatting rules,
but this is not the main part.

To follow Taco's suggestion about coding style, I finally took some  
time to read Knuth's article on literate programming.
One of the consequences is that the patch no longer breaks weave.
The other consequence is that I took the liberty to gather all the  
synchronization code into one section, except the macro definitions of  
course.
This section is numbered 53b because I could not do anything else  
without breaking those weird *tex.ch.
It is less than 3 pages long, I can send the extract off list.

I also added some namespace convention.
It appears that refering to "synchronization", or "synchronize" in  
pdftex.web is ambiguous because there is already a synchronization  
problem concerning the terminal.
So I decided to change the name and call this "Synchronize TeXnology",  
abbreviated in the key word "synctex"
Now, if you

find trunk -exec grep "synctex" "{}" \; -print

you will find absolutely all the places where synchronization plays  
the slightest role.

Of course, the external file has been renamed to synctex.c
the auxiliary file is foo.synctex
the auxiliary shell script that will help editors and viewer to  
support synchronization will be named ... synctex.
I think that this external helper should be stored on CTAN, in support/ 
synctex

I forgot to say that the command line option is now -synctex=1 and the  
primitive is \synctex

there are 25 google pages for synctex, and no pages for ""synchronize  
texnology""

I could not upload anything to sarovar, it seems that some limit has  
been reached.
So I send the diff to Martin off list
If necessary, I can create a new patch entry at sarovar.

From pragma at wxs.nl  Sun Feb 10 20:22:33 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 10 Feb 2008 20:22:33 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>
	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>
Message-ID: <47AF4EF9.8030801@wxs.nl>

LAURENS J?r?me wrote:

> I forgot to say that the command line option is now -synctex=1 and the  
> primitive is \synctex

the primitive probably will be changes into something 
\pdfsynchronize=<number>

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jlaurens at users.sourceforge.net  Mon Feb 11 10:33:12 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Mon, 11 Feb 2008 10:33:12 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47AF4EF9.8030801@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>
	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>
	<47AF4EF9.8030801@wxs.nl>
Message-ID: <5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>


Le 10 f?vr. 08 ? 20:22, Hans Hagen a ?crit :

> LAURENS J?r?me wrote:
>
>> I forgot to say that the command line option is now -synctex=1 and  
>> the  primitive is \synctex
>
> the primitive probably will be changes into something  
> \pdfsynchronize=<number>

I don't think this is a good idea because synctex does not use any pdf  
related feature, unlike former pdfsync.
It would be misleading to include "pdf" in the name.
Moreover, one can see in synctex a common technology shared by all  
tex.web based engines, including xetex.

I agree that a name like \pdfsynchronize is more user friendly, but  
the advantage of synctex is that it can also be used in the CLI...
as I said the string "synctex" is also some kind of keyword.


From pragma at wxs.nl  Mon Feb 11 11:23:29 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 11 Feb 2008 11:23:29 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>
	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>
Message-ID: <47B02221.7080103@wxs.nl>

LAURENS J?r?me wrote:
> Le 10 f?vr. 08 ? 20:22, Hans Hagen a ?crit :
> 
>> LAURENS J?r?me wrote:
>>
>>> I forgot to say that the command line option is now -synctex=1 and  
>>> the  primitive is \synctex
>> the primitive probably will be changes into something  
>> \pdfsynchronize=<number>
> 
> I don't think this is a good idea because synctex does not use any pdf  
> related feature, unlike former pdfsync.
> It would be misleading to include "pdf" in the name.
> Moreover, one can see in synctex a common technology shared by all  
> tex.web based engines, including xetex.
> 
> I agree that a name like \pdfsynchronize is more user friendly, but  
> the advantage of synctex is that it can also be used in the CLI...
> as I said the string "synctex" is also some kind of keyword.

the policy for pdftex is not to introduce new primitives unless preceded 
by \pdf ... (not that i care that much because macro packages can deal 
with it but for latex it was considered a problem as there are many 
packages out there we don't know of), so such is life ...

anyhow, even if we use a non prefixed primitive, i'd like a more verbose one

\synchronizeoutputstate

or, actually, it belongs to the trace family

\traceoutputpositions

or so; since we're talking tex here, the tex in \synctex is somewhat 
strange; of course you can call your mechanism as such, but that;s a 
different matter

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From martin at oneiros.de  Mon Feb 11 11:35:14 2008
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 11 Feb 2008 11:35:14 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B02221.7080103@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>
	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>
	<47AD67CF.4030208@elvenkind.com>
	<20080209100609.GY31469@localhost.localdomain>
	<47AD7C52.9080603@elvenkind.com>
	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>
	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>
	<47AF4EF9.8030801@wxs.nl>
	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>
	<47B02221.7080103@wxs.nl>
Message-ID: <68c491a60802110235s1269c4dey788cacae338652dc@mail.gmail.com>

2008/2/11, Hans Hagen <pragma at wxs.nl>:
> LAURENS J?r?me wrote:
> > I agree that a name like \pdfsynchronize is more user friendly, but
> > the advantage of synctex is that it can also be used in the CLI...
> > as I said the string "synctex" is also some kind of keyword.
>
> the policy for pdftex is not to introduce new primitives unless preceded
> by \pdf ... (not that i care that much because macro packages can deal
> with it but for latex it was considered a problem as there are many
> packages out there we don't know of), so such is life ...

This isn't really an issue anymore with \pdfprimitive. :-)

> anyhow, even if we use a non prefixed primitive, i'd like a more verbose one
>
> \synchronizeoutputstate
>
> or, actually, it belongs to the trace family
>
> \traceoutputpositions
>
> or so; since we're talking tex here, the tex in \synctex is somewhat
> strange; of course you can call your mechanism as such, but that;s a
> different matter

Agreed. And we shouldn't forget to include Johnathan in the
discussion, since this should also end up in XeTeX. :-)

Best
   Martin

From pragma at wxs.nl  Mon Feb 11 11:43:56 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 11 Feb 2008 11:43:56 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <68c491a60802110235s1269c4dey788cacae338652dc@mail.gmail.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>
	<68c491a60802110235s1269c4dey788cacae338652dc@mail.gmail.com>
Message-ID: <47B026EC.1070603@wxs.nl>

Martin Schr?der wrote:
> 2008/2/11, Hans Hagen <pragma at wxs.nl>:
>> LAURENS J?r?me wrote:
>>> I agree that a name like \pdfsynchronize is more user friendly, but
>>> the advantage of synctex is that it can also be used in the CLI...
>>> as I said the string "synctex" is also some kind of keyword.
>> the policy for pdftex is not to introduce new primitives unless preceded
>> by \pdf ... (not that i care that much because macro packages can deal
>> with it but for latex it was considered a problem as there are many
>> packages out there we don't know of), so such is life ...
> 
> This isn't really an issue anymore with \pdfprimitive. :-)

huh? that's not so much different from a bunch of \let \mysavedwhatever 
\whatever and that was rejected (\primitive is not something that end 
users will use and i never could convince the team to not use the \pdf 
primitive

als, if so, we should start rename the existing \pdfwhatevers

>> anyhow, even if we use a non prefixed primitive, i'd like a more verbose one
>>
>> \synchronizeoutputstate
>>
>> or, actually, it belongs to the trace family
>>
>> \traceoutputpositions
>>
>> or so; since we're talking tex here, the tex in \synctex is somewhat
>> strange; of course you can call your mechanism as such, but that;s a
>> different matter
> 
> Agreed. And we shouldn't forget to include Johnathan in the
> discussion, since this should also end up in XeTeX. :-)

(btw, is there an indication of the speed penalty and influence on the 
memory footprint when this feature is not enabled?)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Mon Feb 11 11:53:53 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 11 Feb 2008 11:53:53 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B026EC.1070603@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<68c491a60802110235s1269c4dey788cacae338652dc@mail.gmail.com>
	<47B026EC.1070603@wxs.nl>
Message-ID: <47B02941.1000705@elvenkind.com>



Hans Hagen wrote:
> 
> (btw, is there an indication of the speed penalty and influence on the 
> memory footprint when this feature is not enabled?)

my guesstimate is less than half of a percent speed penalty,
and about a 1-2% node memory size increase, for plain tex.

Speed penalty for latex/context will be considerably lower still,
because they spend much more time interpreting macros.

The speed penalty will be higher when enable, of course, but
it makes no difference for memory consumption.

Best wishes,
Taco

From jlaurens at users.sourceforge.net  Mon Feb 11 19:15:54 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Mon, 11 Feb 2008 19:15:54 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B02221.7080103@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>
	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>
	<47B02221.7080103@wxs.nl>
Message-ID: <2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>


Le 11 f?vr. 08 ? 11:23, Hans Hagen a ?crit :
>
> the policy for pdftex is not to introduce new primitives unless  
> preceded by \pdf ... (not that i care that much because macro  
> packages can deal with it but for latex it was considered a problem  
> as there are many packages out there we don't know of), so such is  
> life ...
>
> anyhow, even if we use a non prefixed primitive, i'd like a more  
> verbose one
>
> \synchronizeoutputstate

this one seems ambiguous

>
> or, actually, it belongs to the trace family
>
> \traceoutputpositions
>
> or so; since we're talking tex here, the tex in \synctex is somewhat  
> strange; of course you can call your mechanism as such, but that;s a  
> different matter

Couldn't we adopt an intermediate position?

\tracesynctexpositions

where you consider synctex as a whole word, just like mutex, cortex,  
vortex, vertex and of course latex
In fact, due to performance reasons, only approximate output positions  
are traced,
the output position unit is tex sp, but the synctex position unit is  
8192 sp.
I would expect a \traceoutputpositions to really report the output  
position, not just something approximate.

\tracingsynctex is another choice. More texish, but I would not choose  
it.


JL

From P.Taylor at Rhul.Ac.Uk  Mon Feb 11 19:22:56 2008
From: P.Taylor at Rhul.Ac.Uk (Philip Taylor (Webmaster))
Date: Mon, 11 Feb 2008 18:22:56 +0000
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>
	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>
Message-ID: <47B09280.3070406@Rhul.Ac.Uk>

If we /are/ going to abbreviate "synchroni{s|z}e"
to "sync", could we please abbreviate it to
"synch", otherwise there are going to be a lot
of unintentional errors in coding ...

** Phil.
--------
[*] The "ch" group in "synchroni{s|z}e" is actually
     Greek "chi", whence indivisible.

From pragma at wxs.nl  Mon Feb 11 19:47:08 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 11 Feb 2008 19:47:08 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>
	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>
Message-ID: <47B0982C.2080000@wxs.nl>

LAURENS J?r?me wrote:

> Couldn't we adopt an intermediate position?
> 
> \tracesynctexpositions

i see no reason for 'tex' in the name, after all, we are running tex; 
also, nowadays there is no need to have short names (many new primitives 
have verbose names)

> where you consider synctex as a whole word, just like mutex, cortex,  
> vortex, vertex and of course latex
> In fact, due to performance reasons, only approximate output positions  
> are traced,
> the output position unit is tex sp, but the synctex position unit is  
> 8192 sp.
> I would expect a \traceoutputpositions to really report the output  
> position, not just something approximate.

well, i'm more thinking along the line ...

\traceoutputpositions = 0 : disabled
\traceoutputpositions = 1 : low resolution
\traceoutputpositions = 2 : medium resolution (8192 resolution)
\traceoutputpositions = 3 : high resolution

although position are always approximations (take for instance complex 
ligatures orgenerated code) i wonder if we should divert from the full 
sp resolution; i'd say: output the full number (no devision) and provide 
  resolution in the amount of sync points

(if this feature also ends up in luatex, then it will be full resolution 
if only because all dimensions accessible at the lua end are in scaled
points)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jlaurens at users.sourceforge.net  Mon Feb 11 23:42:27 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Mon, 11 Feb 2008 23:42:27 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B0982C.2080000@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>
	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>
	<47B0982C.2080000@wxs.nl>
Message-ID: <EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>


Le 11 f?vr. 08 ? 19:47, Hans Hagen a ?crit :

> LAURENS J?r?me wrote:
>
>> Couldn't we adopt an intermediate position?
>> \tracesynctexpositions
>
> i see no reason for 'tex' in the name, after all, we are running  
> tex; also, nowadays there is no need to have short names (many new  
> primitives have verbose names)
>
>> where you consider synctex as a whole word, just like mutex,  
>> cortex,  vortex, vertex and of course latex
>> In fact, due to performance reasons, only approximate output  
>> positions  are traced,
>> the output position unit is tex sp, but the synctex position unit  
>> is  8192 sp.
>> I would expect a \traceoutputpositions to really report the output   
>> position, not just something approximate.
>
> well, i'm more thinking along the line ...
>
> \traceoutputpositions = 0 : disabled
> \traceoutputpositions = 1 : low resolution
> \traceoutputpositions = 2 : medium resolution (8192 resolution)
> \traceoutputpositions = 3 : high resolution

Unfortunately, this is not what synctex is designed for.
It is more like

\tracesynctexpositions=0:disabled
\tracesynctexpositions=1:math, kern, glue, hbox
\tracesynctexpositions=2:add noads
\tracesynctexpositions=3:add some whatsits

All this is dedicated to the Editor/Viewer synchronization, and it is  
not advisable to use it for something else.

Roughly speaking, here is how synctex works:
1 - some nodes have been extended to -always- store synchronization  
information
2 - if some flag is enabled, this information is used to help  
synchronization.

Point 1 belongs to the data model, it is public and can be used by any  
other tex extension.
Point 2 is a controller, which means a piece of code that uses the  
data; it is -private- to synctex.
The \synctex (or \tracesynctexpositions) primitive controls the  
behaviour of this synctex controller.
So it is dedicated to point 2 and this is why it must be named  
accordingly.

If someone plans to use point 1 for another tex extension, then it  
will be possible to use your \traceoutputpositions terminology if this  
is relevant.

>
>
> although position are always approximations (take for instance  
> complex ligatures orgenerated code) i wonder if we should divert  
> from the full sp resolution; i'd say: output the full number (no  
> devision) and provide  resolution in the amount of sync points

ok, the question is about precision

>
>
> (if this feature also ends up in luatex, then it will be full  
> resolution if only because all dimensions accessible at the lua end  
> are in scaled
> points)
>

no, you are confusing the data and the controller.
Actually, the dimensions are available in full dimensions, but this is  
a deliberate choice of the controller to truncate them to a lower  
precision.
If the controller is implemented in lua, it will also decide to  
truncate simply because it is a matter of efficiency.
The purpose of the lower precision in synctex end is simply to reduce  
the size of the auxiliary output file.
If we use full resolution, then the size increases by 40%, which is - 
very- significant because I/O operations are involved.
8192 is the best choice for that purpose.

I hope this explanation will enlight the design of synctex, and make  
you understand how tex and synctex are tied together.

JL

From jlaurens at users.sourceforge.net  Mon Feb 11 23:44:20 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Mon, 11 Feb 2008 23:44:20 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B09280.3070406@Rhul.Ac.Uk>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>
	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>
	<47B09280.3070406@Rhul.Ac.Uk>
Message-ID: <18EDBF91-3D48-4A57-97FB-6F2BB8EC9D5A@users.sourceforge.net>


Le 11 f?vr. 08 ? 19:22, Philip Taylor (Webmaster) a ?crit :

> If we /are/ going to abbreviate "synchroni{s|z}e"
> to "sync", could we please abbreviate it to
> "synch", otherwise there are going to be a lot
> of unintentional errors in coding ...

synctex is the way to go

>
>
> ** Phil.
> --------
> [*] The "ch" group in "synchroni{s|z}e" is actually
>    Greek "chi", whence indivisible.
>


From pragma at wxs.nl  Tue Feb 12 09:26:07 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 12 Feb 2008 09:26:07 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>
	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>
Message-ID: <47B1581F.7000400@wxs.nl>

LAURENS J?r?me wrote:

> \tracesynctexpositions=0:disabled
> \tracesynctexpositions=1:math, kern, glue, hbox
> \tracesynctexpositions=2:add noads
> \tracesynctexpositions=3:add some whatsits

so, variant 2 and 3 are influencing the node lists (I assume that this 
does not influence the outout i.e. no inhibiting of the \last... 
primitives etc (sometimes whatsits can get in the way)

(btw, i then assume that there is also an implicit position insertion 
possible, like \injectsuchapositionhere or so)

> If someone plans to use point 1 for another tex extension, then it  
> will be possible to use your \traceoutputpositions terminology if this  
> is relevant.

in the case of luatex (as an example) >= 2 would not work out well 
because then all the user code that operates on a node list should take 
these extra nodes (whatsites) into acount (ignore them and such); so, in 
the case of luatex we would end up with just case 1 (but then in all 
nodes). If needed user code can inject additional nodes (like 2/3). At 
the end the info needed for synchronization can be written to file by a 
lua function that loops over the resulting lists (of a callback in the 
backend that produces the output), totally under user control. Of course 
then, someone can write a sync compatible format.

> Actually, the dimensions are available in full dimensions, but this is  
> a deliberate choice of the controller to truncate them to a lower  
> precision.

i assumed as much -)

> If the controller is implemented in lua, it will also decide to  
> truncate simply because it is a matter of efficiency.

it depends ... a bit of caching and a few more bytes may be cheaper than 
calculations

> The purpose of the lower precision in synctex end is simply to reduce  
> the size of the auxiliary output file.
> If we use full resolution, then the size increases by 40%, which is - 
> very- significant because I/O operations are involved.
> 8192 is the best choice for that purpose.

(i can even imagine that outputting base points is an alternative 
because after all, viewers work in such dimensions)

> I hope this explanation will enlight the design of synctex, and make  
> you understand how tex and synctex are tied together.

sure, but what we want to keep an eye on (at least for luatex) is that 
new functionality is open, not interfering, under user control etc

anyhow, pdftex is a good testbed for the sync feature (i suppose that 
xetex also needs some tweaking when method 2/3 comes inti play because 
it may manipulate node lists differently from pdftex and has additional 
node types)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Tue Feb 12 09:39:47 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 12 Feb 2008 09:39:47 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B1581F.7000400@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>
	<47B1581F.7000400@wxs.nl>
Message-ID: <47B15B53.4000604@elvenkind.com>



Hans Hagen wrote:
> LAURENS J?r?me wrote:
> 
>> \tracesynctexpositions=0:disabled
>> \tracesynctexpositions=1:math, kern, glue, hbox
>> \tracesynctexpositions=2:add noads
>> \tracesynctexpositions=3:add some whatsits
> 
> so, variant 2 and 3 are influencing the node lists (I assume that this 
> does not influence the outout i.e. no inhibiting of the \last... 
> primitives etc (sometimes whatsits can get in the way)

I assume they will just be adding more output for other node types
(read "add" as an abbreviation for "additionally, produce information
for .."). The point of this patch, iiuc, is that there is no need for
node list manupilations.

>> The purpose of the lower precision in synctex end is simply to reduce  
>> the size of the auxiliary output file.
>> If we use full resolution, then the size increases by 40%, which is - 
>> very- significant because I/O operations are involved.
>> 8192 is the best choice for that purpose.

It would be interesting to have the full precision as an option.
A macro package for two-pass page break optimization may want to
use the synctex file also , and such a package would really need
full precision to avoid rounding errors.

Best wishes,
Taco

From jlaurens at users.sourceforge.net  Tue Feb 12 10:53:54 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Tue, 12 Feb 2008 10:53:54 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B1581F.7000400@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>
	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>
	<47B1581F.7000400@wxs.nl>
Message-ID: <FE5F4E4F-9DDE-47CF-A614-EB77A72874F3@users.sourceforge.net>


Le 12 f?vr. 08 ? 09:26, Hans Hagen a ?crit :

> LAURENS J?r?me wrote:
>
>> \tracesynctexpositions=0:disabled
>> \tracesynctexpositions=1:math, kern, glue, hbox
>> \tracesynctexpositions=2:add noads
>> \tracesynctexpositions=3:add some whatsits
>
> so, variant 2 and 3 are influencing the node lists (I assume that  
> this does not influence the outout i.e. no inhibiting of the  
> \last... primitives etc (sometimes whatsits can get in the way)

Actually, absolutely no new node is created, unlike srcltx, src- 
specials and pdfsync
This is why there won't be compatibility problems with already  
existing macros.

>
>
> (btw, i then assume that there is also an implicit position  
> insertion possible, like \injectsuchapositionhere or so)

not yet.

The idea would be something like
\marksynctexposition{blah}
or
\synctexcomment{blah}
where blah is something related to the content, but I do not know yet  
how it should be designed

With synctex, you are absolutely sure that no new node has been created.
This is what makes the difference with srcltx, src specials and pdfsync
and this is what ensures that other packages won't break.

>
>
>> If someone plans to use point 1 for another tex extension, then it   
>> will be possible to use your \traceoutputpositions terminology if  
>> this  is relevant.
>
> in the case of luatex (as an example) >= 2 would not work out well  
> because then all the user code that operates on a node list should  
> take these extra nodes (whatsites) into acount (ignore them and  
> such); so, in the case of luatex we would end up with just case 1  
> (but then in all nodes). If needed user code can inject additional  
> nodes (like 2/3). At the end the info needed for synchronization can  
> be written to file by a lua function that loops over the resulting  
> lists (of a callback in the backend that produces the output),  
> totally under user control. Of course then, someone can write a sync  
> compatible format.

No, this is not how the patch works.
The purpose is not to create new nodes nor manipulate node lists, the  
purpose is only to observe existing nodes.
If you extend the size of some whatsit nodes, they will become  
observable,
and there will be more info in the output.

I guess the size of the node is not something publicly available in  
luatex,
otherwise there might be problems when changing the node size in the  
core of the engine.

>
>> Actually, the dimensions are available in full dimensions, but this  
>> is  a deliberate choice of the controller to truncate them to a  
>> lower  precision.
>
> i assumed as much -)
>
>> If the controller is implemented in lua, it will also decide to   
>> truncate simply because it is a matter of efficiency.
>
> it depends ... a bit of caching and a few more bytes may be cheaper  
> than calculations

All the problem lies into inter process communication.
If lua is able to talk directly to the viewer, the editor or the  
external synctex controller, then truncation is useless.
But as long as IPC is made through text files, then truncation is a  
real benefit.
And I am afraid it is difficult to avoid text files in that particular  
situation because we have no control on viewers nor editors.

JL

From pragma at wxs.nl  Tue Feb 12 11:10:18 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 12 Feb 2008 11:10:18 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <FE5F4E4F-9DDE-47CF-A614-EB77A72874F3@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>	<47B1581F.7000400@wxs.nl>
	<FE5F4E4F-9DDE-47CF-A614-EB77A72874F3@users.sourceforge.net>
Message-ID: <47B1708A.4030705@wxs.nl>

LAURENS J?r?me wrote:
> Le 12 f?vr. 08 ? 09:26, Hans Hagen a ?crit :
> 
>> LAURENS J?r?me wrote:
>>
>>> \tracesynctexpositions=0:disabled
>>> \tracesynctexpositions=1:math, kern, glue, hbox
>>> \tracesynctexpositions=2:add noads
>>> \tracesynctexpositions=3:add some whatsits
>> so, variant 2 and 3 are influencing the node lists (I assume that  
>> this does not influence the outout i.e. no inhibiting of the  
>> \last... primitives etc (sometimes whatsits can get in the way)
> 
> Actually, absolutely no new node is created, unlike srcltx, src- 
> specials and pdfsync
> This is why there won't be compatibility problems with already  
> existing macros.

ok, so 2 is not 'add noad's (which are nodes -) but 'add info to more 
nodes'

>>
>> (btw, i then assume that there is also an implicit position  
>> insertion possible, like \injectsuchapositionhere or so)
> 
> not yet.

maybe it makes sense to add such a primitive

> The idea would be something like
> \marksynctexposition{blah}
> or
> \synctexcomment{blah}
> where blah is something related to the content, but I do not know yet  
> how it should be designed

hm, adding labels would add more info to the log file (which you want to 
keep small)

> With synctex, you are absolutely sure that no new node has been created.
> This is what makes the difference with srcltx, src specials and pdfsync
> and this is what ensures that other packages won't break.

ok, good

> I guess the size of the node is not something publicly available in  
> luatex,
> otherwise there might be problems when changing the node size in the  
> core of the engine.

luatex has reimplemented nodes completely so any sync feature in there 
would work differently: i.e. extra fields in each node, accessible as 
such (from lua) and even manipulateable; the file location aspect is 
even a bit more tricky because one can overload the file handler and as 
such positional information that tracks back to the source also needs to 
carry (probably indirect) information about that (for instance: input 
can come from zip files, or input sequences can be transformed into 
other sequences); in that respect the writing of tracking info to a file 
may depends on what the macro package does with the input handling (of 
course this can be hidden from users by appropriate functions)

but there is no need to worry about that now (after all, this is the 
pdftex dev list)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jlaurens at users.sourceforge.net  Tue Feb 12 12:36:15 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Tue, 12 Feb 2008 12:36:15 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B1708A.4030705@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>	<47B1581F.7000400@wxs.nl>
	<FE5F4E4F-9DDE-47CF-A614-EB77A72874F3@users.sourceforge.net>
	<47B1708A.4030705@wxs.nl>
Message-ID: <8F6D975E-3A56-4650-B3BB-01DB4E8D1EEF@users.sourceforge.net>


Le 12 f?vr. 08 ? 11:10, Hans Hagen a ?crit :

> LAURENS J?r?me wrote:
>> Le 12 f?vr. 08 ? 09:26, Hans Hagen a ?crit :
>>> LAURENS J?r?me wrote:
>>>
>>>> \tracesynctexpositions=0:disabled
>>>> \tracesynctexpositions=1:math, kern, glue, hbox
>>>> \tracesynctexpositions=2:add noads
>>>> \tracesynctexpositions=3:add some whatsits
>>> so, variant 2 and 3 are influencing the node lists (I assume that   
>>> this does not influence the outout i.e. no inhibiting of the   
>>> \last... primitives etc (sometimes whatsits can get in the way)
>> Actually, absolutely no new node is created, unlike srcltx, src-  
>> specials and pdfsync
>> This is why there won't be compatibility problems with already   
>> existing macros.
>
> ok, so 2 is not 'add noad's (which are nodes -) but 'add info to  
> more nodes'

yes, I meant "add more nodes to the list of observable nodes"...

>
>
>>>
>>> (btw, i then assume that there is also an implicit position   
>>> insertion possible, like \injectsuchapositionhere or so)
>> not yet.
>
> maybe it makes sense to add such a primitive

>> The idea would be something like
>> \marksynctexposition{blah}
>> or
>> \synctexcomment{blah}
>> where blah is something related to the content, but I do not know  
>> yet  how it should be designed
>
> hm, adding labels would add more info to the log file (which you  
> want to keep small)

The preliminary explanations about synchronization (packed with the  
early versions of the patch)
is available at

http://itexmac.sourceforge.net/synchronize+Frames.pdf

If you take a look at pages 5-9, you will see exactly the information  
the synctex auxiliary file provides.
This is far better than former specials or pdfsync.
I can't measure for sure, but to give just an idea, I would say that  
with this information, I can synchronize 99% of the characters,
and 99.9% of the lines.
So I am not sure that a \injectsuchapositionhere would be of great help.
Maybe adding meta information/comment would help.




From pragma at wxs.nl  Tue Feb 12 13:07:42 2008
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 12 Feb 2008 13:07:42 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <8F6D975E-3A56-4650-B3BB-01DB4E8D1EEF@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>	<47B1581F.7000400@wxs.nl>	<FE5F4E4F-9DDE-47CF-A614-EB77A72874F3@users.sourceforge.net>	<47B1708A.4030705@wxs.nl>
	<8F6D975E-3A56-4650-B3BB-01DB4E8D1EEF@users.sourceforge.net>
Message-ID: <47B18C0E.5040408@wxs.nl>

LAURENS J?r?me wrote:

> http://itexmac.sourceforge.net/synchronize+Frames.pdf
> 
> If you take a look at pages 5-9, you will see exactly the information  
> the synctex auxiliary file provides.
> This is far better than former specials or pdfsync.
> I can't measure for sure, but to give just an idea, I would say that  
> with this information, I can synchronize 99% of the characters,
> and 99.9% of the lines.

btw, this all depends on the kind of document, (e.g. xml input where 
data is filtered from the tree is trikcy), but for traditionally edited 
tex docs this is probably true (apart from tables of contents, lists, 
generated info, but ther one can disable the mechanism)

> So I am not sure that a \injectsuchapositionhere would be of great help.
> Maybe adding meta information/comment would help.

it depends; i use \pdfsavepos cum suis lots of time (sometimes docs with 
many thousands of positions, and megabytes of multipass files) but this 
is different from a sync features (positional info carries much more 
info around)

just wondering ... why do you use h: and g: ? i can also imagine that 
you just use the node id (hlists and glues are just a few types)

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From jlaurens at users.sourceforge.net  Tue Feb 12 15:08:15 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Tue, 12 Feb 2008 15:08:15 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B15B53.4000604@elvenkind.com>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>
	<47B1581F.7000400@wxs.nl> <47B15B53.4000604@elvenkind.com>
Message-ID: <5DE998D8-CA84-4FC5-BE30-23AFA648574B@users.sourceforge.net>


Le 12 f?vr. 08 ? 09:39, Taco Hoekwater a ?crit :

>
>>> The purpose of the lower precision in synctex end is simply to  
>>> reduce  the size of the auxiliary output file.
>>> If we use full resolution, then the size increases by 40%, which  
>>> is - very- significant because I/O operations are involved.
>>> 8192 is the best choice for that purpose.
>
> It would be interesting to have the full precision as an option.
> A macro package for two-pass page break optimization may want to
> use the synctex file also , and such a package would really need
> full precision to avoid rounding errors.

I am not in favour of adding complexity to synctex out of its original  
purpose.
I can't see how .synctex would benefit a page breaker.
Conversely, basing extension on the synctex file will add limitations  
to both the extension and synctex.

can you elaborate?

From taco at elvenkind.com  Tue Feb 12 15:23:12 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 12 Feb 2008 15:23:12 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <5DE998D8-CA84-4FC5-BE30-23AFA648574B@users.sourceforge.net>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>	<47B1581F.7000400@wxs.nl>
	<47B15B53.4000604@elvenkind.com>
	<5DE998D8-CA84-4FC5-BE30-23AFA648574B@users.sourceforge.net>
Message-ID: <47B1ABD0.7060003@elvenkind.com>



LAURENS J?r?me wrote:
> Le 12 f?vr. 08 ? 09:39, Taco Hoekwater a ?crit :
> 
>>>> The purpose of the lower precision in synctex end is simply to  
>>>> reduce  the size of the auxiliary output file.
>>>> If we use full resolution, then the size increases by 40%, which  
>>>> is - very- significant because I/O operations are involved.
>>>> 8192 is the best choice for that purpose.
>> It would be interesting to have the full precision as an option.
>> A macro package for two-pass page break optimization may want to
>> use the synctex file also , and such a package would really need
>> full precision to avoid rounding errors.
> 
> I am not in favour of adding complexity to synctex out of its original  
> purpose.
> I can't see how .synctex would benefit a page breaker.
> Conversely, basing extension on the synctex file will add limitations  
> to both the extension and synctex.
> 
> can you elaborate?

I could, but no time. And it was not important anyway.

Best wishes,
Taco

From jlaurens at users.sourceforge.net  Tue Feb 12 15:55:33 2008
From: jlaurens at users.sourceforge.net (=?ISO-8859-1?Q?LAURENS_J=E9r=F4me?=)
Date: Tue, 12 Feb 2008 15:55:33 +0100
Subject: [NTG-pdftex] Synchronization
In-Reply-To: <47B18C0E.5040408@wxs.nl>
References: <E1C7FAA4-661D-43A5-B028-3EB9504783DE@users.sourceforge.net>	<47AC5087.6060407@elvenkind.com>	<1E4214C4-0C19-4DA3-918A-8BCA62D9B659@users.sourceforge.net>	<47AD67CF.4030208@elvenkind.com>	<20080209100609.GY31469@localhost.localdomain>	<47AD7C52.9080603@elvenkind.com>	<68c491a60802090422r240228d6qe7930d06b17d7159@mail.gmail.com>	<97DF4B90-492F-40D4-A06F-2E0B7FB778BF@users.sourceforge.net>	<47AF4EF9.8030801@wxs.nl>	<5BA251EA-7D82-4428-B091-3CFE8ED8E737@users.sourceforge.net>	<47B02221.7080103@wxs.nl>	<2B2B040C-A0FD-4687-ABBB-76058BAFB3AB@users.sourceforge.net>	<47B0982C.2080000@wxs.nl>	<EAAD6981-5207-46F3-A388-2AAF7E01134C@users.sourceforge.net>	<47B1581F.7000400@wxs.nl>	<FE5F4E4F-9DDE-47CF-A614-EB77A72874F3@users.sourceforge.net>	<47B1708A.4030705@wxs.nl>
	<8F6D975E-3A56-4650-B3BB-01DB4E8D1EEF@users.sourceforge.net>
	<47B18C0E.5040408@wxs.nl>
Message-ID: <0C907F8D-64E1-489B-BF3A-6917D8FCCC32@users.sourceforge.net>


Le 12 f?vr. 08 ? 13:07, Hans Hagen a ?crit :

>
> just wondering ... why do you use h: and g: ? i can also imagine  
> that you just use the node id (hlists and glues are just a few types)

hlists are useful because any output text belongs to an hlist.
But hlists are not always created at parse time, which means that  
their associate line number is not accurate.
On the contrary, glue nodes (like kern and math ones) are created at  
parse time,
which means that their associate line number is accurate.
Moreover, glues and kerns are naturally created during the process, no  
need to force anything.
Finally, TeX assumes that kern, math and glue nodes have the same size.

Basically, hlist are used to find where the text lies,
the glue, kern and math nodes are used to find the real line number  
inside the boxes.

JL

From noreply at sarovar.org  Thu Feb 14 00:55:23 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 05:25:23 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPRRj-0001Bv-00@sarovar.org>

Bugs item #917, was opened at 2008-02-13 18:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: None
Status: Open
Resolution: None
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Nobody (None)
Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 01:13:13 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 05:43:13 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPRiz-0004cs-00@sarovar.org>

Bugs item #917, was opened at 2008-02-14 00:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
>Group: v1.40.6
Status: Open
>Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
>Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 01:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 01:40:15 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 06:10:15 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPS99-0001yP-00@sarovar.org>

Bugs item #917, was opened at 2008-02-13 18:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Allin Cottrell (allin)
Date: 2008-02-13 19:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-13 19:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 01:40:47 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 06:10:47 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPS9f-0001zH-00@sarovar.org>

Bugs item #917, was opened at 2008-02-13 18:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-13 19:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-13 19:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 02:34:28 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 07:04:28 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPSzc-0003dC-00@sarovar.org>

Bugs item #917, was opened at 2008-02-13 18:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Allin Cottrell (allin)
Date: 2008-02-13 20:34

Message:
Logged In: YES 
user_id=4856

I've now tried using a much simpler map file, but that
didn't help.  Here what strace says, at the end of reading
the map file:

read(7, "wncysc10.pfb\nwncyss10 <wncyss10."..., 4096) = 783
read(7, "", 4096)                       = 0
close(7)                                = 0
munmap(0xb7fdc000, 4096)                = 0
write(1, "}", 1})                        = 1
brk(0x835e000)                          = 0x835e000
brk(0x838e000)                          = 0x838e000
write(6, "%PDF-1.4\n%\320\324\305\330\n3 0 obj
<<\n/Lengt"..., 156) = 156
write(2, "pdflatex: ", 10pdflatex: )              = 10
write(2, "Invalid argument\n", 17Invalid argument
)      = 17
write(5, "\relax \n", 8)               = 8
write(4, "This is pdfTeX, Version 3.141592"..., 1511) = 1511
exit_group(1)                           = ?




----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-13 19:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-13 19:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 09:10:17 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 13:40:17 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPZAf-0005Pj-00@sarovar.org>

Bugs item #917, was opened at 2008-02-14 00:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Taco Hoekwater (taco)
Date: 2008-02-14 09:10

Message:
Logged In: YES 
user_id=1608

Works for me as well.

The most likely candidate for creating this problem is the
pfb file, not the map file. The actual error message
probably comes from zlib, not the map file parser. 

Can you check that /usr/local/psfonts/bsr/cmr10.pfb is
exactly 26882 bytes long?


----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 02:34

Message:
Logged In: YES 
user_id=4856

I've now tried using a much simpler map file, but that
didn't help.  Here what strace says, at the end of reading
the map file:

read(7, "wncysc10.pfb\nwncyss10 <wncyss10."..., 4096) = 783
read(7, "", 4096)                       = 0
close(7)                                = 0
munmap(0xb7fdc000, 4096)                = 0
write(1, "}", 1})                        = 1
brk(0x835e000)                          = 0x835e000
brk(0x838e000)                          = 0x838e000
write(6, "%PDF-1.4\n%\320\324\305\330\n3 0 obj
<<\n/Lengt"..., 156) = 156
write(2, "pdflatex: ", 10pdflatex: )              = 10
write(2, "Invalid argument\n", 17Invalid argument
)      = 17
write(5, "\relax \n", 8)               = 8
write(4, "This is pdfTeX, Version 3.141592"..., 1511) = 1511
exit_group(1)                           = ?




----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 01:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 01:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 10:10:25 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 14:40:25 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPa6r-00085i-00@sarovar.org>

Bugs item #917, was opened at 2008-02-14 00:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 10:10

Message:
Logged In: YES 
user_id=421

The error message probably comes from the kernel or libc;
the string "Invalid argument" is only in ttf2afm.c

allin, can you start a gdb, set a breakpoint in exit and get
a backtrace?



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2008-02-14 09:10

Message:
Logged In: YES 
user_id=1608

Works for me as well.

The most likely candidate for creating this problem is the
pfb file, not the map file. The actual error message
probably comes from zlib, not the map file parser. 

Can you check that /usr/local/psfonts/bsr/cmr10.pfb is
exactly 26882 bytes long?


----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 02:34

Message:
Logged In: YES 
user_id=4856

I've now tried using a much simpler map file, but that
didn't help.  Here what strace says, at the end of reading
the map file:

read(7, "wncysc10.pfb\nwncyss10 <wncyss10."..., 4096) = 783
read(7, "", 4096)                       = 0
close(7)                                = 0
munmap(0xb7fdc000, 4096)                = 0
write(1, "}", 1})                        = 1
brk(0x835e000)                          = 0x835e000
brk(0x838e000)                          = 0x838e000
write(6, "%PDF-1.4\n%\320\324\305\330\n3 0 obj
<<\n/Lengt"..., 156) = 156
write(2, "pdflatex: ", 10pdflatex: )              = 10
write(2, "Invalid argument\n", 17Invalid argument
)      = 17
write(5, "\relax \n", 8)               = 8
write(4, "This is pdfTeX, Version 3.141592"..., 1511) = 1511
exit_group(1)                           = ?




----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 01:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 01:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 14:23:44 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 18:53:44 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPe40-0007Cy-00@sarovar.org>

Bugs item #917, was opened at 2008-02-14 00:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 14:23

Message:
Logged In: YES 
user_id=421

Are you by chance trying to produce a pdf larger then 2GiB?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 10:10

Message:
Logged In: YES 
user_id=421

The error message probably comes from the kernel or libc;
the string "Invalid argument" is only in ttf2afm.c

allin, can you start a gdb, set a breakpoint in exit and get
a backtrace?



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2008-02-14 09:10

Message:
Logged In: YES 
user_id=1608

Works for me as well.

The most likely candidate for creating this problem is the
pfb file, not the map file. The actual error message
probably comes from zlib, not the map file parser. 

Can you check that /usr/local/psfonts/bsr/cmr10.pfb is
exactly 26882 bytes long?


----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 02:34

Message:
Logged In: YES 
user_id=4856

I've now tried using a much simpler map file, but that
didn't help.  Here what strace says, at the end of reading
the map file:

read(7, "wncysc10.pfb\nwncyss10 <wncyss10."..., 4096) = 783
read(7, "", 4096)                       = 0
close(7)                                = 0
munmap(0xb7fdc000, 4096)                = 0
write(1, "}", 1})                        = 1
brk(0x835e000)                          = 0x835e000
brk(0x838e000)                          = 0x838e000
write(6, "%PDF-1.4\n%\320\324\305\330\n3 0 obj
<<\n/Lengt"..., 156) = 156
write(2, "pdflatex: ", 10pdflatex: )              = 10
write(2, "Invalid argument\n", 17Invalid argument
)      = 17
write(5, "\relax \n", 8)               = 8
write(4, "This is pdfTeX, Version 3.141592"..., 1511) = 1511
exit_group(1)                           = ?




----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 01:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 01:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 16:32:26 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 21:02:26 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPg4Y-0005bM-00@sarovar.org>

Bugs item #917, was opened at 2008-02-13 18:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
Status: Open
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Allin Cottrell (allin)
Date: 2008-02-14 10:32

Message:
Logged In: YES 
user_id=4856

"Are you by chance trying to produce a pdf larger then 2GiB?"

Ah, now we're getting somewhere!  No, the test file I was
using resulted in a pdf of only 4K, but... when I built 
pdftex I was using a version of build.sh that I had 
previously modified and saved, and it did not contain
the configure flag "--disable-largefile", which I see is
in the current build.sh.  I added that flag, recompiled
pdftex, and now it works fine.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 08:23

Message:
Logged In: YES 
user_id=421

Are you by chance trying to produce a pdf larger then 2GiB?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 04:10

Message:
Logged In: YES 
user_id=421

The error message probably comes from the kernel or libc;
the string "Invalid argument" is only in ttf2afm.c

allin, can you start a gdb, set a breakpoint in exit and get
a backtrace?



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2008-02-14 03:10

Message:
Logged In: YES 
user_id=1608

Works for me as well.

The most likely candidate for creating this problem is the
pfb file, not the map file. The actual error message
probably comes from zlib, not the map file parser. 

Can you check that /usr/local/psfonts/bsr/cmr10.pfb is
exactly 26882 bytes long?


----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-13 20:34

Message:
Logged In: YES 
user_id=4856

I've now tried using a much simpler map file, but that
didn't help.  Here what strace says, at the end of reading
the map file:

read(7, "wncysc10.pfb\nwncyss10 <wncyss10."..., 4096) = 783
read(7, "", 4096)                       = 0
close(7)                                = 0
munmap(0xb7fdc000, 4096)                = 0
write(1, "}", 1})                        = 1
brk(0x835e000)                          = 0x835e000
brk(0x838e000)                          = 0x838e000
write(6, "%PDF-1.4\n%\320\324\305\330\n3 0 obj
<<\n/Lengt"..., 156) = 156
write(2, "pdflatex: ", 10pdflatex: )              = 10
write(2, "Invalid argument\n", 17Invalid argument
)      = 17
write(5, "\relax \n", 8)               = 8
write(4, "This is pdfTeX, Version 3.141592"..., 1511) = 1511
exit_group(1)                           = ?




----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-13 19:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-13 19:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From noreply at sarovar.org  Thu Feb 14 16:43:19 2008
From: noreply at sarovar.org (noreply at sarovar.org)
Date: Thu, 14 Feb 2008 21:13:19 +0530
Subject: [NTG-pdftex] [ pdftex-Bugs-917 ] pdftex 1.40.6: "invalid argument"
	on parsing pdftex.map
Message-ID: <E1JPgF5-0008BV-00@sarovar.org>

Bugs item #917, was opened at 2008-02-14 00:55
You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

Category: None
Group: v1.40.6
>Status: Closed
Resolution: Works For Me
Priority: 5
Submitted By: Allin Cottrell (allin)
Assigned to: Martin Schr?der (oneiros)
>Summary: pdftex 1.40.6: "invalid argument" on parsing pdftex.map

Initial Comment:
Using an admittedly quite old pdftex.map, pdftex 1.40.5
would product correct output but pdftex 1.40.6 fails to
parse the map file.  pdftex.map is attached; here is
interactive output:

waverley:~/mytex/misc$ cat bug.tex 
\documentclass{article}
\begin{document}

Hello.

\end{document}

waverley:~/mytex/misc$ pdflatex bug
This is pdfTeX, Version 3.141592-1.40.6 (Web2C 7.5.6)
 \write18 enabled.
(./bug.tex
LaTeX2e <2003/12/01>
Babel <v3.7h> and hyphenation patterns for american,
russian, spanish, italian,
 polish, loaded.
(/usr/share/texmf/tex/latex/base/article.cls
Document Class: article 2004/02/16 v1.4f Standard LaTeX
document class
(/usr/share/texmf/tex/latex/base/size10.clo))
(./bug.aux) [1{/usr/share/texmf/f
onts/map/pdftex.map}pdflatex: Invalid argument


----------------------------------------------------------------------

>Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 16:43

Message:
Logged In: YES 
user_id=421

Then your compile was broken. We'll fix that in 1.50.0 :-)

----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 16:32

Message:
Logged In: YES 
user_id=4856

"Are you by chance trying to produce a pdf larger then 2GiB?"

Ah, now we're getting somewhere!  No, the test file I was
using resulted in a pdf of only 4K, but... when I built 
pdftex I was using a version of build.sh that I had 
previously modified and saved, and it did not contain
the configure flag "--disable-largefile", which I see is
in the current build.sh.  I added that flag, recompiled
pdftex, and now it works fine.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 14:23

Message:
Logged In: YES 
user_id=421

Are you by chance trying to produce a pdf larger then 2GiB?

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 10:10

Message:
Logged In: YES 
user_id=421

The error message probably comes from the kernel or libc;
the string "Invalid argument" is only in ttf2afm.c

allin, can you start a gdb, set a breakpoint in exit and get
a backtrace?



----------------------------------------------------------------------

Comment By: Taco Hoekwater (taco)
Date: 2008-02-14 09:10

Message:
Logged In: YES 
user_id=1608

Works for me as well.

The most likely candidate for creating this problem is the
pfb file, not the map file. The actual error message
probably comes from zlib, not the map file parser. 

Can you check that /usr/local/psfonts/bsr/cmr10.pfb is
exactly 26882 bytes long?


----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 02:34

Message:
Logged In: YES 
user_id=4856

I've now tried using a much simpler map file, but that
didn't help.  Here what strace says, at the end of reading
the map file:

read(7, "wncysc10.pfb\nwncyss10 <wncyss10."..., 4096) = 783
read(7, "", 4096)                       = 0
close(7)                                = 0
munmap(0xb7fdc000, 4096)                = 0
write(1, "}", 1})                        = 1
brk(0x835e000)                          = 0x835e000
brk(0x838e000)                          = 0x838e000
write(6, "%PDF-1.4\n%\320\324\305\330\n3 0 obj
<<\n/Lengt"..., 156) = 156
write(2, "pdflatex: ", 10pdflatex: )              = 10
write(2, "Invalid argument\n", 17Invalid argument
)      = 17
write(5, "\relax \n", 8)               = 8
write(4, "This is pdfTeX, Version 3.141592"..., 1511) = 1511
exit_group(1)                           = ?




----------------------------------------------------------------------

Comment By: Allin Cottrell (allin)
Date: 2008-02-14 01:40

Message:
Logged In: YES 
user_id=4856

Minimal test file and log from pdftex 1.40.5 are added below.

----------------------------------------------------------------------

Comment By: Martin Schr?der (oneiros)
Date: 2008-02-14 01:13

Message:
Logged In: YES 
user_id=421

I can't reproduce this; I can compile sample2e.tex with this
map file. Please attach a (minimal) test file. Also the log
of 1.40.5 for this file would be helpful.


----------------------------------------------------------------------

You can respond by visiting: 
http://sarovar.org/tracker/?func=detail&atid=493&aid=917&group_id=106

From taco at elvenkind.com  Wed Feb 27 11:31:52 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 27 Feb 2008 11:31:52 +0100
Subject: [NTG-pdftex] forwarded problem of 1.40.7 on powerpc
Message-ID: <47C53C18.1080707@elvenkind.com>


Hi guys,

See below for a bug in 1.40.7 as posted on the context list.
As I wrote there, it looks like an endianness issue because

   300000 >> 16 == 5

Either that, or some object has a different size on ppc, but that
seems unlikely to me.

I am hoping someone has a powerpc to try and sort this out.

Best wishes,
Taco

-------- Original Message --------
Subject: Re: [NTG-context] bib module and pdftex 1.40.7: Virtual memory 
exhausted using MiKTeX-2.7
Date: Wed, 27 Feb 2008 10:26:46 +0100
From: Thomas A. Schmitz <thomas.schmitz at uni-bonn.de>
Reply-To: mailing list for ConTeXt users <ntg-context at ntg.nl>
To: mailing list for ConTeXt users <ntg-context at ntg.nl>

On Feb 20, 2008, at 10:05 AM, luigi scarso wrote:

>> Just the other day, I encountered a mysterious error which may or may
>> not be related. I upgraded to pdftex 1.40.7 on all my boxes. This was
>> smooth on my intel-macs (OS X 10.5.2). On my powerpc-mac, I got a  
>> "TeX
>> capacity exceeded!" error with 1.40.7 for a file that compiled fine
>> with 1.40.5. I tried several times: all I did was dropping the pdftex
>> binary and pdftex.pool in place, rebuilding th format and compiling
>> the file. Compilation was smooth with 1.40.5 and consistently failed
>> with 1.40.7 (which I compiled and recompiled without any special
>> flags). I haven't pursued the matter for the moment and just went  
>> back
>> to 1.40.5, but I'm wondering if these problems are related.
> Do you have a test file ?
>

Sorry, it took me a while because this is the computer in my office,
from which I;ve been away for a while. I think I nailed it down: if I
try to include a pdf image into a ConTeXt document


\starttext
   \externalfigure[Logo][width=56mm,height=20mm]
\stoptext

(with any pdf file) I get this error:

<./Logo.pdf
! TeX capacity exceeded, sorry [PDF object stream buffer=5].
\dogetTPDfiguresize ...geBox {\@@DriverImageFile }
                                                    \xdef
\PDFimagereference {...

\doanalyzefiguredimensionsinternal ...tfiguresize

\setanalyzedfiguredimensio...
<argument> ...}\doanalyzefiguredimensionsinternal

\doanalyzefiguredimensions...

\firstoftwoarguments #1#2->#1

\dododoanalyzeunknownfiguretype ...guredimensions
                                                    \fi
\next2 ...dododoanalyzeunknownfiguretype {pdf}{#1}
                                                    \doprocesscommaitem
...
l.4

!  ==> Fatal error occurred, no output PDF file produced!

The pdf file is OK; this error only occurs with pdftex 1.40.7 on
powerpc (OS X, 10.5.2). The same file compiles fine with

luatex on powerpc and intel
pdftex 1.40.5 on powerpc and intel
pdftex 1.40.7 on OS X intel

All best

Thomas

___________________________________________________________________________________
If your question is of interest to others as well, please add an entry 
to the Wiki!

maillist : ntg-context at ntg.nl / 
http://www.ntg.nl/mailman/listinfo/ntg-context
webpage  : http://www.pragma-ade.nl / http://tex.aanhet.net
archive  : https://foundry.supelec.fr/projects/contextrev/
wiki     : http://contextgarden.net
___________________________________________________________________________________

From taco at elvenkind.com  Wed Feb 27 12:37:22 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 27 Feb 2008 12:37:22 +0100
Subject: [NTG-pdftex] forwarded problem of 1.40.7 on powerpc
In-Reply-To: <47C53C18.1080707@elvenkind.com>
References: <47C53C18.1080707@elvenkind.com>
Message-ID: <47C54B72.4060007@elvenkind.com>

Taco Hoekwater wrote:
> Hi guys,
> 
> See below for a bug in 1.40.7 as posted on the context list.
> As I wrote there, it looks like an endianness issue because
> 
>    300000 >> 16 == 5

Sorry about this, of course it isn't. But I still suspect an
endianness issue.

Best wishes,
Taco

From martin at oneiros.de  Wed Feb 27 13:03:44 2008
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 27 Feb 2008 13:03:44 +0100
Subject: [NTG-pdftex] forwarded problem of 1.40.7 on powerpc
In-Reply-To: <47C54B72.4060007@elvenkind.com>
References: <47C53C18.1080707@elvenkind.com> <47C54B72.4060007@elvenkind.com>
Message-ID: <68c491a60802270403q6d43ecd0v972e780f00dc9fdd@mail.gmail.com>

2008/2/27, Taco Hoekwater <taco at elvenkind.com>:
> Sorry about this, of course it isn't. But I still suspect an
>  endianness issue.

    if s > sup_pdf_os_buf_size - pdf_ptr then
        overflow("PDF object stream buffer", pdf_os_buf_size);

I suspect someone fiddled with --disable-largefile. :-(
pdf_ptr is a longinteger, i.e. off_t. s is an integer,
sup_pdf_os_buf_size is just a const. Surely s doesn't have to be a
longinteger?

Best
   Martin

From taco at elvenkind.com  Wed Feb 27 13:43:31 2008
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 27 Feb 2008 13:43:31 +0100
Subject: [NTG-pdftex] forwarded problem of 1.40.7 on powerpc
In-Reply-To: <68c491a60802270403q6d43ecd0v972e780f00dc9fdd@mail.gmail.com>
References: <47C53C18.1080707@elvenkind.com> <47C54B72.4060007@elvenkind.com>
	<68c491a60802270403q6d43ecd0v972e780f00dc9fdd@mail.gmail.com>
Message-ID: <47C55AF3.1060907@elvenkind.com>



Martin Schr?der wrote:
> 2008/2/27, Taco Hoekwater <taco at elvenkind.com>:
>> Sorry about this, of course it isn't. But I still suspect an
>>  endianness issue.
> 
>     if s > sup_pdf_os_buf_size - pdf_ptr then
>         overflow("PDF object stream buffer", pdf_os_buf_size);
> 
> I suspect someone fiddled with --disable-largefile. :-(
> pdf_ptr is a longinteger, i.e. off_t. s is an integer,
> sup_pdf_os_buf_size is just a const. Surely s doesn't have to be a
> longinteger?

perhaps the function is accidentally called with a longinteger
argument?



From martin at oneiros.de  Wed Feb 27 15:35:30 2008
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 27 Feb 2008 15:35:30 +0100
Subject: [NTG-pdftex] forwarded problem of 1.40.7 on powerpc
In-Reply-To: <47C55AF3.1060907@elvenkind.com>
References: <47C53C18.1080707@elvenkind.com> <47C54B72.4060007@elvenkind.com>
	<68c491a60802270403q6d43ecd0v972e780f00dc9fdd@mail.gmail.com>
	<47C55AF3.1060907@elvenkind.com>
Message-ID: <68c491a60802270635lbfb794ci7c78b9451f9c6c10@mail.gmail.com>

2008/2/27, Taco Hoekwater <taco at elvenkind.com>:
> perhaps the function is accidentally called with a longinteger
>  argument?

Not that I can see (I just checked).

Best
   Martin

From hartmut_henkel at gmx.de  Thu Feb 28 00:38:08 2008
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu, 28 Feb 2008 00:38:08 +0100 (CET)
Subject: [NTG-pdftex] forwarded problem of 1.40.7 on powerpc
In-Reply-To: <68c491a60802270403q6d43ecd0v972e780f00dc9fdd@mail.gmail.com>
References: <47C53C18.1080707@elvenkind.com> <47C54B72.4060007@elvenkind.com>
	<68c491a60802270403q6d43ecd0v972e780f00dc9fdd@mail.gmail.com>
Message-ID: <alpine.DEB.1.00.0802280033110.27589@hahepc1.hahe>

On Wed, 27 Feb 2008, Martin Schr?der wrote:

> 2008/2/27, Taco Hoekwater <taco at elvenkind.com>:
> > Sorry about this, of course it isn't. But I still suspect an
> >  endianness issue.
>
>     if s > sup_pdf_os_buf_size - pdf_ptr then

possibly this helps, by avoiding the subtraction:

      if s + pdf_ptr > sup_pdf_os_buf_size then

>         overflow("PDF object stream buffer", pdf_os_buf_size);

iirc we already had a similar looking problem that could be "solved" by
this type of change.

Regards, Hartmut

