From taco at elvenkind.com  Tue Jan 13 09:21:47 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 13 Jan 2009 09:21:47 +0100
Subject: [dev-context] Check your posts
Message-ID: <496C4F1B.4090502@elvenkind.com>

Hi all,

Since yesterday evening localtime the ntg mail server switched to an
external service for spam filtering. It is already clear that the
mail server indeed handles much less spam now, so it looks like a
great success.

Still, it is a rigorous change, and for the new few days I want
to ask everybody to keep an eye out for disappearing posts.

This message is crossposted. If you want to reply, please do so
to me personally, not to the lists.

Best wishes,
Taco

From sanjoy at MIT.EDU  Wed Jan 14 19:47:39 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Wed, 14 Jan 2009 13:47:39 -0500
Subject: [dev-context] mptopdf says 'Unable to make mpx file' (using TEX.mp)
Message-ID: <E1LNAmB-0002Vb-QA@approx.mit.edu>

Here is 'minimal.mp':

input TEX
beginfig(1)
  draw thelabel.top(TEX("90"), origin);
endfig;
end

It runs fine through mpost, but running 'mptopdf minimal.mp' instead
produces:

  MPtoPDF 1.3.3 : running 'texexec --mptex    minimal.mp'
  TeXExec | processing graphic 'minimal.mp'
  This is MetaPost, Version 0.993 (Web2C 7.5.6)
  (/usr/share/texmf/web2c/natural.tcx)
  (minimal.mp (/usr/share/texmf-texlive/metapost/base/TEX.mp) (mptextmp.mp
  >> mptextmp.mp
  >> mptextmp.mpx
  ! Unable to make mpx file.
  l.1 btex
	   90 etex
  Transcript written on minimal.log.
  TeXExec | runtime: 0.040707

  MPtoPDF 1.3.3 : no filename matches minimal

(After running mpost, the mptopdf command works fine, so delete all
 files except minimal.mp, then run 'mptopdf minimal.mp' to see the
 problem.)

I'm using the Debian unstable texlive/context packages on i386 (using
mkii).  Do others see this problem?  I don't think it's related to the
mpost version or to the Debian packaging.  I just tried a moderately
recent 'minimals' and mpost 1.110, and the problem is the same.

-Sanjoy

From taco at elvenkind.com  Thu Jan 15 09:50:52 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 15 Jan 2009 09:50:52 +0100
Subject: [dev-context] mptopdf says 'Unable to make mpx file' (using
	TEX.mp)
In-Reply-To: <E1LNAmB-0002Vb-QA@approx.mit.edu>
References: <E1LNAmB-0002Vb-QA@approx.mit.edu>
Message-ID: <496EF8EC.8070108@elvenkind.com>



Sanjoy Mahajan wrote:
> 
> I'm using the Debian unstable texlive/context packages on i386 (using
> mkii).  Do others see this problem?  I don't think it's related to the
> mpost version or to the Debian packaging.  I just tried a moderately
> recent 'minimals' and mpost 1.110, and the problem is the same.

I see the same problem here, but debugging makempx is a pain. Initial
'wild guess': mptextmp.mp seems to contain extra 'end' commands in
the ConTeXt-driven case.

Best wishes,
Taco

From taco at elvenkind.com  Fri Jan 30 19:03:44 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 30 Jan 2009 19:03:44 +0100
Subject: [dev-context] [NTG-context] new experimental
In-Reply-To: <49832AAA.4060100@wxs.nl>
References: <49831EE0.2050206@wxs.nl>	<68bfdc900901300758k679177edod23c5fc46dca2fba@mail.gmail.com>
	<49832AAA.4060100@wxs.nl>
Message-ID: <49834100.6020206@elvenkind.com>


Hi,

An note about the math stuff wrt. luatex itself: there is no released
beta yet, but current luatex trunk matches Hans' experimental version.
It labels itself version 0.33.0, the revision is #1847, and it seems
to be rather stable, despite massive math code changes.

There are two big user-visible changes so far
(this information is especially for Mojca & Aditya ).

* I have added xetex-compatible primitives for the setting of
   math- and delcodes (and derivates). The names start with \U...
   instead of \XeTeX..., though.

* Many of the math parameters are now separated out; some three
   dozen math parameters are definable in the eight math styles
   (\displaystyle, \textstyle, \scriptstyle, \scriptscriptstyle
    and \cramped versions thereof) using explicit TeX primitives
   or (easier, automatically) via loading of math fonts.

   Math fonts can now have a "MathConstants" lua subtable, this is
   simply the math data generated by fontforge, scaled to size.
   If this table is present in a font that is assigned to a math
   family slot, this data will be used instead of the traditional
   font parameters from \fam2 and \fam3.

The manual is updated but not quite up to speed yet, I will fix
that over the weekend (mostly explanations missing).

Nothing new in OpenType MATH is really supported yet except these
MathConstants (and Hans maps the traditional things like verticals
extenders and italic corrections to their tfm equivalents), but
there is definate progress.

Still to do/planned (in planned/proposed implementation order):

* Separate out the math spacing rules into parameters
* Allow \mathchardef-ed control sequences in text mode
* Support for automatic large operator size choosing
* Full support for Math-Style extensibles (with overlaps)
* Horizontal extensibles (\arrowfill, \bracefill)
* Stetch Stacks (for \overbrace cs.)
* Stacks (like \atop, but with more than two items)
* One-click full font&param switching (for \boldmath)
* Prescripts
* Flattened accents
* Bottom accents
* ??

(that list is open for discussion).


Have fun,

Taco

From pragma at wxs.nl  Fri Jan 30 20:05:02 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 30 Jan 2009 20:05:02 +0100
Subject: [dev-context] [NTG-context] new experimental
In-Reply-To: <49834100.6020206@elvenkind.com>
References: <49831EE0.2050206@wxs.nl>	<68bfdc900901300758k679177edod23c5fc46dca2fba@mail.gmail.com>	<49832AAA.4060100@wxs.nl>
	<49834100.6020206@elvenkind.com>
Message-ID: <49834F5E.7020909@wxs.nl>

Taco Hoekwater wrote:

> * Separate out the math spacing rules into parameters
> * Allow \mathchardef-ed control sequences in text mode
> * Support for automatic large operator size choosing
> * Full support for Math-Style extensibles (with overlaps)
> * Horizontal extensibles (\arrowfill, \bracefill)
> * Stetch Stacks (for \overbrace cs.)
> * Stacks (like \atop, but with more than two items)
> * One-click full font&param switching (for \boldmath)
> * Prescripts
> * Flattened accents
> * Bottom accents
> * ??

* more control over alignments and esp eqno, width, overshoot etc
* some more control over mathstyle/choice handling (i must find back the 
notes about that)

just a remark for M & A: this also measn that we don't need to sort our 
all things now (like those composed missing chars and arrow/accent mess) 
as it will be possibe to handle this in cleaner ways

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Feb 13 00:51:47 2009
From: taco at elvenkind.com (taco)
Date: Fri, 13 Feb 2009 00:51:47 +0100
Subject: [dev-context] this is a mail delivery test
Message-ID: <4994B613.2060809@elvenkind.com>

taco

From mojca.miklavec.lists at gmail.com  Sun Feb 15 11:40:45 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sun, 15 Feb 2009 11:40:45 +0100
Subject: [dev-context] How to ignore specific tree when extracting version
	from SVN?
Message-ID: <6faad9f00902150240v1c3908e2q5e079cb314eb7a36@mail.gmail.com>

Hello,

When building the binaries for minimals I decided to use the latest
SVN version of XeTeX. On the server I use:
     cd TRUNK && svn info | grep "Last Changed Rev:" | sed 's/^Last
Changed Rev: \(.*\)$/\1/' && cd ..
to determine version of XeTeX and whenever the version changes it
triggers rebuilding the binaries.

But I just figured out that since Jonathan's last commit about two
months ago there have been 71 SVN commits into polyglossia (8) and
xepersian (all the rest). This means that any fluent binary builder
had to compile XeTeX 71 times (and SVN had to store changes) in the
last two months for nothing as texmf tree doesn't influence the
binaries.

On the contrary, ignoring any changes in texmf tree would mean
compiling it just twice or so since August.

Any volunteer to send me one-liner to fix that? I'm able to write a
ruby script to filter that out, but I'm sure that there must be some
extremely simple one-liner (or three-liner) in bash to solve that.

Thanks a lot for any hints,
    Mojca

From arthur.reutenauer at normalesup.org  Sun Feb 15 16:29:08 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Sun, 15 Feb 2009 16:29:08 +0100
Subject: [dev-context] [Context] How to ignore specific tree when
	extracting version	from SVN?
In-Reply-To: <6faad9f00902150240v1c3908e2q5e079cb314eb7a36@mail.gmail.com>
References: <6faad9f00902150240v1c3908e2q5e079cb314eb7a36@mail.gmail.com>
Message-ID: <20090215152908.GY26572@phare.normalesup.org>

> Any volunteer to send me one-liner to fix that? I'm able to write a
> ruby script to filter that out, but I'm sure that there must be some
> extremely simple one-liner (or three-liner) in bash to solve that.

  All the actual source code resides in texk and libs.  So you may want
to simply run svn info in those two directories and compute the maximum
of the respective last revisions (in that case, 820, last November).

	Arthur

From schuster.wolfgang at googlemail.com  Fri Feb 20 18:06:52 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Fri, 20 Feb 2009 18:06:52 +0100
Subject: [dev-context] Packaging modules
Message-ID: <FCA518C8-0FB3-424D-B4B3-3E6660722B93@gmail.com>

Hi,

has anybody of you a nice script to create a zip for a ConTeXt
with subfolder for doc, xml and tex files.

I have for my letter module now 40+ files and use two different
directories, one for changes with all files at one place and
another one to create a zip with a tds compliant file structure
and a tpm to create the zip with textools.

I'm looking now for a script to work with my working dir only
and a single file where I list the files which should go in the
zip and in which directory they should end (e.g. doc/context/third/...).

Something in ruby or better lua, which could be included in context
would be nice.

Wolfgang


From schuster.wolfgang at googlemail.com  Sat Feb 21 14:23:51 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sat, 21 Feb 2009 14:23:51 +0100
Subject: [dev-context] Packaging modules
In-Reply-To: <499FBFD2.3020604@elvenkind.com>
References: <FCA518C8-0FB3-424D-B4B3-3E6660722B93@gmail.com>
	<499FBFD2.3020604@elvenkind.com>
Message-ID: <D529317A-B2AE-4FF7-9C6A-0A1D84E95EE6@gmail.com>


Am 21.02.2009 um 09:48 schrieb Taco Hoekwater:

>> has anybody of you a nice script to create a zip for a ConTeXt
>> with subfolder for doc, xml and tex files.
>
> Not me. I have basically the same layout you have, but with a bunch
> of symlinks instead of actual file duplication.

Thanks for the tip, it's a improvement.

Wolfgang


From taco at elvenkind.com  Sat Feb 21 09:48:18 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 21 Feb 2009 09:48:18 +0100
Subject: [dev-context] Packaging modules
In-Reply-To: <FCA518C8-0FB3-424D-B4B3-3E6660722B93@gmail.com>
References: <FCA518C8-0FB3-424D-B4B3-3E6660722B93@gmail.com>
Message-ID: <499FBFD2.3020604@elvenkind.com>

Wolfgang Schuster wrote:
> Hi,
> 
> has anybody of you a nice script to create a zip for a ConTeXt
> with subfolder for doc, xml and tex files.

Not me. I have basically the same layout you have, but with a bunch
of symlinks instead of actual file duplication.

Best wishes,
Taco

From taco at elvenkind.com  Tue Feb 24 15:28:51 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 24 Feb 2009 15:28:51 +0100
Subject: [dev-context] luatex beta 0.35.0
Message-ID: <49A40423.6090609@elvenkind.com>

Hi,

I have just uploaded luatex 0.35.0.

This is a beta in the process towards 0.40.0, the version that
will be included in texlive 2009. We have two big developments
underway right now:

* Hartmut is working on the DVI and PDF output, aiming for full
  support of all direction specifiers in both modes.
* Taco is working on extending the math engine, aiming for complete
  support of the OpenType and MathML concepts.

Both developments are well under way, but neither is perfect yet.
The main goal of this release is to give Hans' ConTeXt mkiv code
and its users a chance to catch up and test the progress so far.


What's new:

* The math handling portions of LuaTeX are converted to C code,
  and extended to support Unicode math. There are a great many
  related changes, see the new Math chapter in the manual for
  details.
* A nasty bug in the paragraph breaking routine was fixed.
  (All lines except the first one were believed to be wider then
  they really were. This affected which nodes were considered
  as active breakpoints)
* Various changes to the PDF backend to make it support non-latin
  directions.
* Fixed the behaviour of the page offsets. Placement of the output
  on the physical page should now work correctly in all directions,
  both in DVI and PDF.
  There now are \pageleftoffset and \pagetopoffset primitives.
* fontforge.apply_featurefile() was broken since 0.31.0
* The lua profiler library is added.
* The included lua filesystem library is now 1.4.1.
* Reading of pk files fixed.
* An optional space afer a <direction specifier> for \textdir c.s.
  is ignored from  now on.
* \bodydir and \pagedir can now be (re)set even after the first
  page has been output.
* The new callback mlist_to_hlist can be used to intercept the
  normal conversion of math lists to horizontal lists.
* The programs ttf2afm and pdftosrc are removed from the luatex
  distribution (these belong to pdftex).
* fontforge.open() now uses much less memory when opening large
  (CJK) fonts.
* The included libpng is now 1.2.35.
* Quite a lot of smaller bugfixes and cleanups (as usual).


The archives (just binaries at this time, hopefully there will be a
source package later) can be downloaded from supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

If you need the sources, please check out via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.31.3

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org

Have fun,
Taco



From preining at logic.at  Tue Mar 10 13:21:40 2009
From: preining at logic.at (Norbert Preining)
Date: Tue, 10 Mar 2009 13:21:40 +0100
Subject: [dev-context] [luatex] luatex beta 0.35.0
In-Reply-To: <49A40423.6090609@elvenkind.com>
References: <49A40423.6090609@elvenkind.com>
Message-ID: <20090310122140.GA18772@gamma.logic.tuwien.ac.at>

On Di, 24 Feb 2009, Taco Hoekwater wrote:
> I have just uploaded luatex 0.35.0.

BTW, Debian Sid now has luatex 0.35.0 packages, too, and together with
the context packages 2008.10.31-1 from experimental (I will upload to
unstable soon) MarkIV at least works after doing the usual post-install
stuff.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
BANTEER
A lusty and raucous old ballad sung after a particulary spectacular
araglin (q.v.) has been pulled off.
			--- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Mon Mar 23 10:53:04 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 23 Mar 2009 10:53:04 +0100
Subject: [dev-context] luatex beta 0.36.0
Message-ID: <49C75C00.6050100@elvenkind.com>

Hi,

I have just uploaded luatex 0.36.0.

This is a beta in the process towards 0.40.0, the version that
will be included in texlive 2009. This beta will be shortlived,
the plan is to release the next one in about a week.

The main reason for a release now is to prepare for a bunch
of important user-visible changes:

* The lua code for tex.enableprimitives() etc. is now there,
  but for this beta all the new primitives are still provided
  to the user.

  In next week's beta, these will be gone indeed, and only
  \directlua will remain present by default. See the mailing list
  archive: http://tug.org/pipermail/luatex/2009-March/000360.html
  for more information, the final syntax is explained in the
  manual.

* Multiple lua states have been removed and the old syntax
  now produces a (rather annoying) informational message.

* The fontforge table is renamed to fontloader. The old name
  is still there for the moment, but also produces a warning
  message.



A more detailed 'what's new':

* The included fontforge code is stripped considerably, and
  the lua table to access the code is renamed to 'fontloader'.
  The old name ('fontforge') will remain present for a while,
  but will eventually go away.

* New lua functions: tex.primitives(), tex.extraprimitives,
  tex.enableprimitives().  This is a prelude to a big change
  in the next beta: iniluatex will from now on start up with
  only the TeX82 primitives and \directlua, everything else
  has to be bootstrapped via tex.enableprimitives().
  See the manual for more details.

* Support for multiple lua states has been removed, and at the
  same time support for adding name ids to lua chunks has been
  added, and \closelua has been removed.  See the manual for
  more details.

* More changes to the PDF backend to make it support non-latin
  directions (form and image placement, vertical typesetting,
  synctex).

* The kpathsea library is updated. Highlights: cleaner build
  process (thanks to Peter Breitenlohner), cleaner mingw32
  (cross)compilation support, and a new reentrant API.

* Some possible endless loops within extended delimiters in
  math mode are now trapped.

* Movements inside VF font characters were considerably off
  due to a wrong conversion routine.

* Error handling for \outer has been reinstated, but can be
  suppressed via the new primitive \suppressoutererror.

* The new primitives: \suppresslongerror and \suppressifcsnameerror
  that can be used to suppress errors for \par in non-long macros
  and for non-expandable objects inside \ifcsname ... \endcsname,
  respectively.

* New lua function: node.vpack() via a patch from Khaled Hosny
  that also improves error handling in node.hpack().

* Fix the typo that caused \charic (instead of \charit)
  to be defined as a primitive.

* Suppression of hyphenation via \hyphenchar\font=-1 now works
  again.

* The lua functions tex.print(), tex.sprint(), tex.write() now
  accept an array of strings as well as vararg list of strings
  to print.

* A change to be build process: luatex.p is no longer split
  int smaller pieces before running the C compiler.

* Melissa O'Neill contributed a bugfix to the Type1 font
  subsetting code.

* A bunch of smaller bugfixes and cleanups (as usual).


The archives (now including source again) can be downloaded from
supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.36.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org

Have fun,
Taco



From taco at elvenkind.com  Mon Mar 23 11:04:23 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 23 Mar 2009 11:04:23 +0100
Subject: [dev-context] [luatex] luatex beta 0.36.0
In-Reply-To: <49C75C00.6050100@elvenkind.com>
References: <49C75C00.6050100@elvenkind.com>
Message-ID: <49C75EA7.8030705@elvenkind.com>


Hi,

Somehow I can't seem to do these announcements without an error :(

Taco Hoekwater wrote:
> 
> * New lua function: node.vpack() via a patch from Khaled Hosny
>   that also improves error handling in node.hpack().

Wrong attribution. The patch was by Yue Wang, sorry.

Best wishes,
Taco

From mojca.miklavec.lists at gmail.com  Mon Mar 23 21:23:28 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 23 Mar 2009 21:23:28 +0100
Subject: [dev-context] luatex beta 0.36.0
In-Reply-To: <49C75C00.6050100@elvenkind.com>
References: <49C75C00.6050100@elvenkind.com>
Message-ID: <6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>

On Mon, Mar 23, 2009 at 10:53, Taco Hoekwater wrote:
> Hi,
>
> I have just uploaded luatex 0.36.0.

Hello Taco,

I have some problems with compilation. Did other Mac users manage to
compile LuaTeX without problems?

 gcc -g -O2 -I/sw/include
-I/System/Library/Frameworks/Python.framework/Versions/2.3/include/python2.3
-I../inc -I../../../../../src/libs/luafontforge/fontforge/inc
-I../../../../../src/libs/luafontforge/fontforge/fontforge -I.
-Wmissing-prototypes -Wunused -Wimplicit -Wreturn-type -Wparentheses
-Wformat -Wchar-subscripts -DHAVE_CONFIG_H
-DSHAREDIR=\"/usr/local/share/fontforge\" -DLIBDIR=\"/usr/local/lib\"
-I/sw/include -I/System/Library/Frameworks/Python.framework/Versions/2.3/include/python2.3
-DPREFIX=\"/usr/local\" -c
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c -o
cvexport.o
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:
In function ?_ExportPlate?:
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:297:
error: ?spiro_cp? undeclared (first use in this function)
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:297:
error: (Each undeclared identifier is reported only once
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:297:
error: for each function it appears in.)
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:297:
error: ?spiros? undeclared (first use in this function)
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:313:
error: ?struct splinepointlist? has no member named ?spiros?
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:314:
error: ?struct splinepointlist? has no member named ?spiro_cnt?
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:315:
warning: implicit declaration of function ?SplineSet2SpiroCP?
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:317:
error: ?SPIRO_OPEN_CONTOUR? undeclared (first use in this function)
../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c:326:
error: ?struct splinepointlist? has no member named ?spiros?
make[2]: *** [cvexport.lo] Error 1
make[1]: *** [fontforge] Error 2
make: *** [../../libs/luafontforge/libff.a] Error 2
cp: statusa ?build/texk/web2c/luatex? ni mo? ugotoviti s stat: No such
file or directory

Mojca

From arthur.reutenauer at normalesup.org  Mon Mar 23 21:32:46 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Mon, 23 Mar 2009 21:32:46 +0100
Subject: [dev-context] luatex beta 0.36.0
In-Reply-To: <6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
References: <49C75C00.6050100@elvenkind.com>
	<6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
Message-ID: <20090323203246.GB26539@phare.normalesup.org>

> I have some problems with compilation. Did other Mac users manage to
> compile LuaTeX without problems?

  I had no problem on my end, using build.sh to compile the native
binary on Intel Mac OS 10.5.4

	Arthur

From mojca.miklavec.lists at gmail.com  Mon Mar 23 21:38:09 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 23 Mar 2009 21:38:09 +0100
Subject: [dev-context] luatex beta 0.36.0
In-Reply-To: <20090323203246.GB26539@phare.normalesup.org>
References: <49C75C00.6050100@elvenkind.com>
	<6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
	<20090323203246.GB26539@phare.normalesup.org>
Message-ID: <6faad9f00903231338j776e0b5dx7398d845c21a5a07@mail.gmail.com>

On Mon, Mar 23, 2009 at 21:32, Arthur Reutenauer wrote:
>> I have some problems with compilation. Did other Mac users manage to
>> compile LuaTeX without problems?
>
> ?I had no problem on my end, using build.sh to compile the native
> binary on Intel Mac OS 10.5.4

In that case I would be grateful for submitting them if you have a
chance to do so. The issue needs to be solved anyway, but at least the
binaries will be there.

Thanks,
   Mojca

From schuster.wolfgang at googlemail.com  Mon Mar 23 21:38:32 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Mon, 23 Mar 2009 21:38:32 +0100
Subject: [dev-context] luatex beta 0.36.0
In-Reply-To: <20090323203246.GB26539@phare.normalesup.org>
References: <49C75C00.6050100@elvenkind.com>
	<6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
	<20090323203246.GB26539@phare.normalesup.org>
Message-ID: <478AB2D5-42C0-47C1-ACE7-7F7598FB8D46@gmail.com>


Am 23.03.2009 um 21:32 schrieb Arthur Reutenauer:

>> I have some problems with compilation. Did other Mac users manage to
>> compile LuaTeX without problems?
>
>  I had no problem on my end, using build.sh to compile the native
> binary on Intel Mac OS 10.5.4

Works here too on 10.5.6.

Wolfgang


From taco at elvenkind.com  Mon Mar 23 22:32:57 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 23 Mar 2009 22:32:57 +0100
Subject: [dev-context] luatex beta 0.36.0
In-Reply-To: <6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
References: <49C75C00.6050100@elvenkind.com>
	<6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
Message-ID: <49C80009.60601@elvenkind.com>

Mojca Miklavec wrote:
> On Mon, Mar 23, 2009 at 10:53, Taco Hoekwater wrote:
>> Hi,
>>
>> I have just uploaded luatex 0.36.0.
> 
> Hello Taco,
> 
> I have some problems with compilation. Did other Mac users manage to
> compile LuaTeX without problems?
> 
> -DPREFIX=\"/usr/local\" -c
> ../../../../../src/libs/luafontforge/fontforge/fontforge/cvexport.c -o
> cvexport.o

Your checkout is broken, cvexport.c no longer exists in the repository
at all.

Best wishes,
Taco



From luigi.scarso at gmail.com  Tue Mar 24 00:39:22 2009
From: luigi.scarso at gmail.com (luigi scarso)
Date: Tue, 24 Mar 2009 00:39:22 +0100
Subject: [dev-context] luatex beta 0.36.0
In-Reply-To: <49C80009.60601@elvenkind.com>
References: <49C75C00.6050100@elvenkind.com>
	<6faad9f00903231323v63d89e5cj36c1e6ca6edd5a98@mail.gmail.com>
	<49C80009.60601@elvenkind.com>
Message-ID: <fe8d59da0903231639j5d1b953l7406fb833cac9126@mail.gmail.com>

>
> Your checkout is broken, cvexport.c no longer exists in the repository
> at all.
true;
I have update my checkout and compilation was ok for minimals .




-- 
luigi

From yuleopen at gmail.com  Mon Mar 23 11:25:43 2009
From: yuleopen at gmail.com (Yue Wang)
Date: Mon, 23 Mar 2009 18:25:43 +0800
Subject: [dev-context] [luatex] luatex beta 0.36.0
In-Reply-To: <49C75EA7.8030705@elvenkind.com>
References: <49C75C00.6050100@elvenkind.com> <49C75EA7.8030705@elvenkind.com>
Message-ID: <68bfdc900903230325j456521e8t5f2abcfbb4836f9e@mail.gmail.com>

Hi, Taco:

On Mon, Mar 23, 2009 at 6:04 PM, Taco Hoekwater <taco at elvenkind.com> wrote:
>
> Hi,
>
> Somehow I can't seem to do these announcements without an error :(
>
> Taco Hoekwater wrote:
>>
>> * New lua function: node.vpack() via a patch from Khaled Hosny
>> ? that also improves error handling in node.hpack().
>
> Wrong attribution. The patch was by Yue Wang, sorry.
>

Never mind:)

btw, vpack() and hpack() still admit numeric third argument (exactly
and additional are just macros in WEB source). So maybe it will be
better to change

            else if (lua_type(L, 3) == LUA_TNUMBER) {
                m = lua_tonumber(L, 3);
            } else {
                lua_pushstring(L, "incorrect 3rd argument");
            }

to

            else {
                lua_pushstring(L, "incorrect third argument");
                lua_error(L);
            }

So the conditional tests will be more strict.

Anyway, since the API will be changed in the future (as Hans said in
that mail), It is fine if we don't touch that at this moment.

> Best wishes,
> Taco
>

Yue Wang

From taco at elvenkind.com  Tue Mar 31 16:18:12 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 31 Mar 2009 16:18:12 +0200
Subject: [dev-context] luatex beta 0.37.0
Message-ID: <49D22624.2020302@elvenkind.com>

Hi,

I have just uploaded luatex 0.37.0.

This is a beta in the process towards 0.40.0, the version that
will be included in texlive 2009. This beta will be shortlived,
the plan is to release the next one in about a week.

This release is mainly intended to allow testing of two new things:

* The new build process, which is based on the one that will be
used for texlive 2009.

Lots of build-time stuff is overhauled, and that means that the binary
itself as well as the build process needs testing. Please try on
your system and let us know if something goes amiss.

* The new shell_escape = 'p' functionality invented by Karl and Akira.

Karl wrote about that:

> As I've mentioned to some of you, Akira and I have been implemented a
> restricted version of \write18: only commands which are explicitly
> listed in texmf.cnf can be executed.  Along with sufficient quoting, I
> think that this is secure enough that it can be enabled by default, and
> I plan to do this for TeX Live 2009.

The texmf.cnf variable for 'acceptable commands' is named
shell_escape_commands. In luatex, the variables shell_escape and
shell_escape_commands will be fetched from the texconfig table in case
of a disabled kpathsea (as context mkiv does).

The important thing to note is that if you are typesetting a document
with luatex (as opposed to executing a texlua script), these variables
now also effect the os.execute(), io.popen(), os.exec() and os.spawn()
functions. Unless a non-false value of shell_escape has been read from
either texmf.cnf or the texconfig table, these functions will not do
anything anymore.

Nothing has changed for the case where luatex is used as a script
interpreter.


==============================================================
Luatex beta-0.37.0 was released 20090331 (commit #2194)
==============================================================

* Luatex now implements shell_escape = 'p', a new feature
  in web2c that intends to make \write18 more secure.

* Attributes can now have negative values. The special value
  for 'unset' is lowered to -0x7FFFFFFF (it used to be -1).

* The lua 'kpse' library now has an object-oriented interface
  as companion to the procedural interface. This is useful for
  e.g. controlling the discovery of mplib files.

* The new internal integer parameter \outputbox allows setting
  of the output box number (default: 255, max: 65535)

* The new primitives \Udelimiterunder and \Udelimiterover
  complete the set of 'StretchStacks' for OpenType Math.

* Fixed a bug in font string conversions on the Macintosh that
  resulted in warnings about 'unaligned pointers being freed'.

* Khaled Hosny spotted a bunch of manual errors.

* There was bug in the width of math_accent objects when
  there were super- or subscripts attached to the accentee.

* In PDF mode, TRT \leaders were bugged.

* The source tree now uses the new texlive build system that
  Peter Breitenlohner created.

* There is now a single build.sh instead of four separate
  ones. It has a few options:
      --make      : only make, no make distclean; configure
      --parallel  : make -j 2 -l 3.0
      --nostrip   : do not strip binary
      --mingw     : crosscompile for mingw32 from i386-linux
      --ppc       : crosscompile for ppc osx on intel osx

  Note: --parallel still sometimes causes crashes due to
  timing errors, so use that option with care.

* Many compiler warnings have been removed (but not all yet).


The archives (now including source again) can be downloaded from
supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.37.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org

Have fun,
Taco



From taco at elvenkind.com  Tue Apr  7 10:10:33 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 07 Apr 2009 10:10:33 +0200
Subject: [dev-context] luatex format portability
Message-ID: <49DB0A79.7060807@elvenkind.com>


Hi,

This is a question for people that have powerpc/arm as well as
intel/amd machines and know how to compile the luatex repository
trunk:

Can you please try the latest and see if the luatex formats are
now platform-independent? As of commit 2207 it should be possible
to copy the generated formats from one machine to the other, even
(and especially) the context mkiv format with its internal lua
bytecodes.

I already know that i386 <-> amd64 works, but I am interested in
endianness tests.

Best wishes,
Taco

From taco at elvenkind.com  Fri Apr 10 12:49:38 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 10 Apr 2009 12:49:38 +0200
Subject: [dev-context] luatex beta 0.38.0
Message-ID: <49DF2442.306@elvenkind.com>

Hi,

I have just uploaded luatex 0.38.0.

This is a beta in the process towards 0.40.0, the version that
will be included in texlive 2009. This beta will be shortlived,
the plan is to release the next (hopefully last) intermediate
beta within a week.

What's new:

* tex.enableprimitives() had a bug were previously defined (but
  currently undefined) control sequences prevented the creation
  of the new csname.

* The special calling format callback.register('name', false)
  not only disables the callback, but also the builtin code it
  is supposed to replace.

* Empty \localleftbox and \localrightbox -es are now suppressed.

* Support for <f>.MathConstants.SubscriptShiftDownWithSuperscript
  was added, to solve the lack of "sub2" in OpenType math.

* Luatex now supports horizontal super- and subscript placement
  corrections via the OpenType MATH mathkern table. See the
  manual for details.

* node.write() no longer copies its argument node list before
  appending it.

* There are six new primitives that are verbose forms
  of one and two byte special tokens:
  \Usuperscript \Usubscript
  \Ustartmath \Ustopmath
  \Ustartdisplaymath \Ustopdisplaymath

* The attribute node leaks in math mode and alignmetns have been
  fixed.

* The 11 simple math noads are now combined into a single "noad"
  node type.

* Static linking against libstdc++ is working once again.

* There is a small fix in the keyword scanner to solve the
  problem of 'Runaway ... while scanning ???' that could happen
  for some primitives.

* Lua now also has the "architecture independent bytecode"
  patch applied.

* Lua is updated to version 5.1.4 with coco patches 1.1.5, and
  lpeg is now 0.9.

* Some TRT/TLT backend bugs are fixed.

* Various manual updates.



The archives (now including source again) can be downloaded from
supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.38.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org

Have fun,
Taco




From taco at elvenkind.com  Wed Apr 15 23:22:09 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Apr 2009 23:22:09 +0200
Subject: [dev-context] luatex beta 0.39.0
Message-ID: <49E65001.6020404@elvenkind.com>

Hi,

I have just uploaded luatex 0.39.0.

This is the last beta before 0.40.0, and we consider it to be
feature complete now. The difference between 0.39.0 and 0.40.0
will be nothing more than a newer version of MPlib, improvements
to the manual, and (probably) a few bugfixes.

What's new:

* iniluatex will from now on start up with only the TeX82 primitives
   and \directlua, everything else has to be bootstrapped via
   tex.enableprimitives(). This change was planned for 0.40.0,
   but *now* is the time to test it.

* A bugfix for \primitive in various expandable contexts,
   and \primitive now generates an error message when the
   argument is not actually a primitive's name.

* There was a bug found in the math accent handling.

* Large math operators are now treated like extensible characters
   in the sense that they can be composed of segments.

* The extra assign- and restore tracing information from eTeX
   had a massive bug because of a dangling else in the pascal web.
   As a side-effect of fixing this bugs, all such potential errors
   in the pascal web have been fixed (for now).

* The math parameters can now be set and queried from lua code
   via the new tex.setmath() and tex.getmath() functions.

* Reflection in a \hbox was broken.

* There was a leak of direction nodes in the paragraph builder.

* The font backend now does a small peek to differentiate
   truetype and postscript style opentype fonts. This fixes
   the "Can't find CFF table" bug for otf's with truetype outlines.

* Parameters and registers can now also be assinged to globally
   from lua (see the manual for details).

* It is now possible to query the current math style while a
   formula is still being constructed by using the new read-only
   value \mathstyle. Associated is the new command \Ustack that
   is to be used as a prefix for {.. \over ..} and friends.
   See the manual for more information.

* The embedded MPLib is brought up to date with the current
   metapost repository (version 1.110 and a few small patches).

* Luatex can now handle two breakpoints inside a single ligature
   (like for the functional word of-f-ice). The solution is not
   perfect yet, but the chance of missed hyphenation points in
   actual documents should now be negligible.

* Some speedups in the font loading code, and in the handling of
   pdf_literal nodes that are set from within Lua code.

* Some source code and manual cleanup, as usual.


The archives can be downloaded from supelec as usual:

         http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

   svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.39.0

Bugs and feature requests can be added to the issue tracker at

        http://tracker.luatex.org


Have fun,
Taco




From taco at elvenkind.com  Wed Apr 22 12:26:28 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 12:26:28 +0200
Subject: [dev-context] luatex beta 0.40.0
Message-ID: <49EEF0D4.1000606@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.0 to the foundry server,
and will commit the source code to texlive later today.

What's new:

* The embedded MPlib is updated to version 1.200.

* Texlua would crash if run font.read_tfm() was used.

* Luatex would crash on empty \patterns.

* Lots of small C code cleanups.

* \textdir inside a \hbox dir *** was wrong earlier.

* 0.39.0 introduced a bug that would make luatex crash whenever
  font expansion was used.

* Font tables returned by define_font can now have a key named
  'cache' that controls the internal lua font table caching.

* There is no longer a need for an explicit --progname if there
  is no input file given.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.40.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco




From taco at elvenkind.com  Wed Apr 22 14:23:12 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 14:23:12 +0200
Subject: [dev-context] [luatex] luatex beta 0.40.0
In-Reply-To: <49EEF0D4.1000606@elvenkind.com>
References: <49EEF0D4.1000606@elvenkind.com>
Message-ID: <49EF0C30.40302@elvenkind.com>


Hi again,

Taco Hoekwater wrote:
> Hi,
> 
> I have just uploaded luatex 0.40.0 to the foundry server,
> and will commit the source code to texlive later today.

As it turns out, there were two fatal flaws in the release,
so I have cheated a little and have delete the archive files.

I am now in the process of uploading new versions. I saw that
there had been two downloads of the old files already, those
people (I hope you know who you are) should fetch new the new
archives file that will be available shortly.

I am sorry for the inconvenience,

Taco



From taco at elvenkind.com  Wed Apr 22 16:52:52 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 16:52:52 +0200
Subject: [dev-context] metapost 1.200-rc1 package tests wanted
Message-ID: <49EF2F44.5030401@elvenkind.com>


Hi all,

I have just released a candidate package for metapost 1.200.

The source code should be finished now, it will be imported in
texlive in a minute. There are pending documentation changes but
there is plenty of time before the texlive 2009 deadline for non-
compiled source, so no rush there.

I will not repeat the lengthy CHANGES entry here, you can read that
in the file itself or under the notes link at supelec.fr:

  http://foundry.supelec.fr/frs/shownotes.php?release_id=335

The packaged files are here:

  http://foundry.supelec.fr/frs/?group_id=13&release_id=335

Testing is more than welcome!

Have fun,

Taco


From karl at huftis.org  Thu Apr 23 20:04:59 2009
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 23 Apr 2009 20:04:59 +0200
Subject: [dev-context] Norwegian in ConTeXt (a delayed answer)
In-Reply-To: <6faad9f00806160320k5237d4e5pe68d84ef861254a6@mail.gmail.com>
References: <6faad9f00806160320k5237d4e5pe68d84ef861254a6@mail.gmail.com>
Message-ID: <200904232005.01038.karl@huftis.org>

Hello Mojca and list!

Sorry for the very (almost a year) late reply, but I now finally have some time 
to devote to this issue. Please see the discussion below. What can I do to 
finally get Norwegian Bokm?l and Norwegian Nynorsk properly supported in 
ConTeXt?

Regards,
Karl Ove Hufthammer

M?ndag 16. juni 2008 skreiv Mojca Miklavec:
>Mojca/Hans/Mojca/Hans/Mojca wrote:
>>>>> And we need to improve support for "Norwegian" - the poor user asked
>>>>> for it more than one year ago.
>>>>
>>>> anyhow, norwegian ... the poor user is not that poor apart from 3
>>>> missing hyphenation exceptions -)
>>>
>>> No, he also sent translations for all the labels for Nynorsk that have
>>> never been included into ConTeXt, and language tags nn & nb have not
>>> been added either.
>>
>> hm, must have lost that
>
>[So I send this to the mailing list before a private conversation is lost
> again]
>
>It's still there:
>    http://thread.gmane.org/gmane.comp.tex.context.devel/349/
>
>The point we stopped at was: you wanted to keep no and derive nn & nb
>from it, but it stopped at hyphenation patterns somewhere (they were
>submitted to CTAN, but notheng has happened afterwards), and at the
>fact that nobody came up with a suggestion of how to derive the
>languages from each other.
>
>It really doesn't hurt if we define two languages nb and nn (such as
>there are multiple languages for Czech/Slovak,
>Croatian/Bosnian/Serbian), and "remove" no, in the sense that no can
>be left as a synonym to nb only.
>
>Specifically:
>
>-------------
>
>Hans F. Nordhaug:
>> I think "no" should be deprecated and giving a (useful) warning/error -
>> telling people to switch to "nb".
>
>-------------
>
>Karl:
>
>To sum up, we need the following language codes: nb and nn.
>And we need the following mappings:
>
>bokmal --> nb
>bokm?l --> nb (if possible)
>nynorsk --> nn
>norsk --> nb (with warning)
>norwegian --> nb (with warning)
>
>-------------
>
>Mojca:
>
>You also need to ask Hans how to provide a "'no' is not allowed
>language switch" warning or error.
>
>What are you planning to do with the "norwegian" interface?
>
>Hans: why is "Norwegian" currently not listed in mult-sys.tex? Because
>only languages which need something different than "ec" need to be
>listed there or is there some other reason?
>
>Hans, you pointed out the chineese module ... but from what I can see
>there, one needs to include the module explicitely and ConTeXt users
>are pampered too much ;) (i.e. everything should happen automatically)
>- is there a way to say something like this?
>
>\startlanguage[nn]
>  \setupitemize[stopper=]
>  \definesymbol[1][\endash]
>\stoplanguage
>
>-------------
>
>Karl/Mojca/Karl:
>>>    leftquotation=\leftguillemot,
>>>    rightquotation=\rightguillemot,
>>
>>Are the old values wrong or just an alternative?
>
>Well, there are no very strict rules in Norwegian; you *can* use every
>possible quotation mark. But the guillemots are certainly the preferred ones
>for (outer) quotations.
>
>-------------
>
>Karl:
>
>My suggestion is
>
>\definesymbol[1][{\symbol[dash]}]
>\definesymbol[2][{\symbol[star]}]
>\definesymbol[3][{\symbol[circle]}]
>\definesymbol[4][{\symbol[bullet]}]
>\definesymbol[5][{\symbol[triangle]}]
>
>and leave levels 6+ at their defaults. Norwegian people, feel free to
> comment on this. :)
>
>-------------
>
>Mojca:
>
>so it would really make sense to enable something like
>
>\startlanguagespecifics[nb]
>  \setupitemize[stopper=]
>
>  \definesymbol[1][{\symbol[dash]}]
>  \definesymbol[2][{\symbol[star]}]
>  \definesymbol[3][{\symbol[circle]}]
>  \definesymbol[4][{\symbol[bullet]}]
>  \definesymbol[5][{\symbol[triangle]}]
>\stoplanguagespecifics
>
>Perhaps that exists already, but I don't know how to do it.
>
>For Slovenian and Hungarian, the same "problem" exists. Now I use
>
>\def\placedotafter#1{#1.}
>\setuphead[section][numbercommand=\placedotafter]
>
>although it would be more clean if one could have something similar to
>
>\startlanguagespecifics[sl]
>  \setupheads[stopper=.]
>\stoplanguagespecifics
>
>in default settings once that will be implemented.
>
>-------------
>
>Karl:
>
>\setupheadtext [\s!nb] [\v!content=Innhold]
>\setupheadtext [\s!nn] [\v!content=Innhald]
>
>\setupheadtext [\s!nb] [\v!tables=Tabeller]
>\setupheadtext [\s!nn] [\v!tables=Tabellar]
>
>\setupheadtext [\s!nb] [\v!figures=Figurer]
>\setupheadtext [\s!nn] [\v!figures=Figurar]
>
>\setupheadtext [\s!nb] [\v!graphics=Bilde]
>\setupheadtext [\s!nn] [\v!graphics=Bilete]
>
>\setupheadtext [\s!nb] [\v!intermezzi=Intermesso]
>\setupheadtext [\s!nn] [\v!intermezzi=Intermesso]
>
>\setupheadtext [\s!nb] [\v!index=Register]
>\setupheadtext [\s!nn] [\v!index=Register]
>
>\setupheadtext [\s!nb] [\v!abbreviations=Forkortelser]
>\setupheadtext [\s!nn] [\v!abbreviations=Forkortingar]
>
>\setupheadtext [\s!nb] [\v!logos=Logoer]
>\setupheadtext [\s!nn] [\v!logos=Logoar]
>
>\setupheadtext [\s!nb] [\v!units=Enheter]
>\setupheadtext [\s!nn] [\v!units=Einingar]
>
>\setuplabeltext [\s!nb] [\v!table=Tabell ]
>\setuplabeltext [\s!nn] [\v!table=Tabell ]
>
>\setuplabeltext [\s!nb] [\v!figure=Figur ]
>\setuplabeltext [\s!nn] [\v!figure=Figur ]
>
>\setuplabeltext [\s!nb] [\v!intermezzo=Intermesso ]
>\setuplabeltext [\s!nn] [\v!intermezzo=Intermesso ]
>
>\setuplabeltext [\s!nb] [\v!graphic=Bilde ]
>\setuplabeltext [\s!nn] [\v!graphic=Bilete ]
>
>\setuplabeltext [\s!nb] [\v!chapter=]
>\setuplabeltext [\s!nn] [\v!chapter=]
>
>\setuplabeltext [\s!nb] [\v!section=]
>\setuplabeltext [\s!nn] [\v!section=]
>
>\setuplabeltext [\s!nb] [\v!subsection=]
>\setuplabeltext [\s!nn] [\v!subsection=]
>
>\setuplabeltext [\s!nb] [\v!subsubsection=]
>\setuplabeltext [\s!nn] [\v!subsubsection=]
>
>\setuplabeltext [\s!nb] [\v!subsubsubsection=]
>\setuplabeltext [\s!nn] [\v!subsubsubsection=]
>
>\setuplabeltext [\s!nb] [\v!appendix=] % Tillegg
>\setuplabeltext [\s!nn] [\v!appendix=] % Tillegg
>
>\setuplabeltext [\s!nb] [\v!part=Del]
>\setuplabeltext [\s!nn] [\v!part=Del]
>
>\setuplabeltext [\s!nb] [\v!line=linje ]
>\setuplabeltext [\s!nn] [\v!line=linje ]
>
>\setuplabeltext [\s!nb] [\v!lines=linjer ]
>\setuplabeltext [\s!nn] [\v!lines=linjer ]
>
>
>\setuplabeltext [\s!nb]   [\v!january=januar]
>\setuplabeltext [\s!nb]  [\v!february=februar]
>\setuplabeltext [\s!nb]     [\v!march=mars]
>\setuplabeltext [\s!nb]     [\v!april=april]
>\setuplabeltext [\s!nb]       [\v!may=mai]
>\setuplabeltext [\s!nb]      [\v!june=juni]
>\setuplabeltext [\s!nb]      [\v!july=juli]
>\setuplabeltext [\s!nb]    [\v!august=august]
>\setuplabeltext [\s!nb] [\v!september=september]
>\setuplabeltext [\s!nb]   [\v!october=oktober]
>\setuplabeltext [\s!nb]  [\v!november=november]
>\setuplabeltext [\s!nb]  [\v!december=desember]
>
>
>\setuplabeltext [\s!nn]   [\v!january=januar]
>\setuplabeltext [\s!nn]  [\v!february=februar]
>\setuplabeltext [\s!nn]     [\v!march=mars]
>\setuplabeltext [\s!nn]     [\v!april=april]
>\setuplabeltext [\s!nn]       [\v!may=mai]
>\setuplabeltext [\s!nn]      [\v!june=juni]
>\setuplabeltext [\s!nn]      [\v!july=juli]
>\setuplabeltext [\s!nn]    [\v!august=august]
>\setuplabeltext [\s!nn] [\v!september=september]
>\setuplabeltext [\s!nn]   [\v!october=oktober]
>\setuplabeltext [\s!nn]  [\v!november=november]
>\setuplabeltext [\s!nn]  [\v!december=desember]
>
>
>\setuplabeltext [\s!nb]    [\v!sunday=s\ostroke ndag]
>\setuplabeltext [\s!nb]    [\v!monday=mandag]
>\setuplabeltext [\s!nb]   [\v!tuesday=tirsdag]
>\setuplabeltext [\s!nb] [\v!wednesday=onsdag]
>\setuplabeltext [\s!nb]  [\v!thursday=torsdag]
>\setuplabeltext [\s!nb]    [\v!friday=fredag]
>\setuplabeltext [\s!nb]  [\v!saturday=l\ostroke rdag]
>
>\setuplabeltext [\s!nn]    [\v!sunday=sundag]
>\setuplabeltext [\s!nn]    [\v!monday=m\aring ndag]
>\setuplabeltext [\s!nn]   [\v!tuesday=tysdag]
>\setuplabeltext [\s!nn] [\v!wednesday=onsdag]
>\setuplabeltext [\s!nn]  [\v!thursday=torsdag]
>\setuplabeltext [\s!nn]    [\v!friday=fredag]
>\setuplabeltext [\s!nn]  [\v!saturday=laurdag]
>
>\setuplabeltext [\s!nb]    [\v!page=side ]
>\setuplabeltext [\s!nb]  [\v!atpage=p\aring\ side ]
>\setuplabeltext [\s!nb] [\v!hencefore=som vist over]
>\setuplabeltext [\s!nb] [\v!hereafter=som vist under]
>\setuplabeltext [\s!nb]       [\v!see=se ]
>
>\setuplabeltext [\s!nn]    [\v!page=side ]
>\setuplabeltext [\s!nn]  [\v!atpage=p\aring\ side ]
>\setuplabeltext [\s!nn] [\v!hencefore=som vist over]
>\setuplabeltext [\s!nn] [\v!hereafter=som vist under]
>\setuplabeltext [\s!nn]       [\v!see=sj\aring\ ]
>
>\setuplabeltext [\s!nb] [\v!january  :\s!mnem=jan.]
>\setuplabeltext [\s!nb] [\v!february :\s!mnem=feb.]
>\setuplabeltext [\s!nb] [\v!march    :\s!mnem=mars]
>\setuplabeltext [\s!nb] [\v!april    :\s!mnem=april]
>\setuplabeltext [\s!nb] [\v!may      :\s!mnem=mai]
>\setuplabeltext [\s!nb] [\v!june     :\s!mnem=juni]
>\setuplabeltext [\s!nb] [\v!july     :\s!mnem=juli]
>\setuplabeltext [\s!nb] [\v!august   :\s!mnem=aug.]
>\setuplabeltext [\s!nb] [\v!september:\s!mnem=sep.]
>\setuplabeltext [\s!nb] [\v!october  :\s!mnem=okt.]
>\setuplabeltext [\s!nb] [\v!november :\s!mnem=nov.]
>\setuplabeltext [\s!nb] [\v!december :\s!mnem=des.]
>
>
>\setuplabeltext [\s!nn] [\v!january  :\s!mnem=jan.]
>\setuplabeltext [\s!nn] [\v!february :\s!mnem=feb.]
>\setuplabeltext [\s!nn] [\v!march    :\s!mnem=mars]
>\setuplabeltext [\s!nn] [\v!april    :\s!mnem=april]
>\setuplabeltext [\s!nn] [\v!may      :\s!mnem=mai]
>\setuplabeltext [\s!nn] [\v!june     :\s!mnem=juni]
>\setuplabeltext [\s!nn] [\v!july     :\s!mnem=juli]
>\setuplabeltext [\s!nn] [\v!august   :\s!mnem=aug.]
>\setuplabeltext [\s!nn] [\v!september:\s!mnem=sep.]
>\setuplabeltext [\s!nn] [\v!october  :\s!mnem=okt.]
>\setuplabeltext [\s!nn] [\v!november :\s!mnem=nov.]
>\setuplabeltext [\s!nn] [\v!december :\s!mnem=des.]
>
>------------------
>
>Karl:
>
>\installlanguage
> [nn]
> [spacing=packed,
>  lefthyphenmin=2,
>  righthyphenmin=2,
>  leftsentence=---,
>  rightsentence=---,
>  leftsubsentence=---,
>  rightsubsentence=---,
>  leftquote=\upperleftsinglesixquote,
>  rightquote=\upperrightsingleninequote,
>  leftquotation=\leftguillemot,
>  rightquotation=\rightguillemot,
>  date={day,{.},\ ,month,\ ,year},
>  state=stop]
>
>This is for Norwegian Nynorsk ('nn'), but the same setup is used for
> Norwegian Bokm?l (the values used for 'day' differ, though -- see below).
>
>------------------
>
>Mojca


From mojca.miklavec.lists at gmail.com  Fri Apr 24 22:52:20 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Fri, 24 Apr 2009 22:52:20 +0200
Subject: [dev-context] Norwegian in ConTeXt (a delayed answer)
In-Reply-To: <200904232005.01038.karl@huftis.org>
References: <6faad9f00806160320k5237d4e5pe68d84ef861254a6@mail.gmail.com>
	<200904232005.01038.karl@huftis.org>
Message-ID: <6faad9f00904241352v6df9c597s244ec91b733caff@mail.gmail.com>

On Thu, Apr 23, 2009 at 20:04, Karl Ove Hufthammer wrote:
> Hello Mojca and list!
>
> Sorry for the very (almost a year) late reply, but I now finally have some time
> to devote to this issue. Please see the discussion below. What can I do to
> finally get Norwegian Bokm?l and Norwegian Nynorsk properly supported in
> ConTeXt?

What is missing at the moment?

 M?ndag 16. juni 2008 skreiv Mojca Miklavec:
>Mojca/Hans/Mojca/Hans/Mojca wrote:
>>>>> And we need to improve support for "Norwegian" - the poor user asked
>>>>> for it more than one year ago.
>>>>
>>>> anyhow, norwegian ... the poor user is not that poor apart from 3
>>>> missing hyphenation exceptions -)
>>>
>>> No, he also sent translations for all the labels for Nynorsk that have
>>> never been included into ConTeXt, and language tags nn & nb have not
>>> been added either.
>>
>> hm, must have lost that
>
>[So I send this to the mailing list before a private conversation is lost
> again]
>
>It's still there:
> ? ?http://thread.gmane.org/gmane.comp.tex.context.devel/349/
>
>The point we stopped at was: you wanted to keep no and derive nn & nb
>from it, but it stopped at hyphenation patterns somewhere (they were
>submitted to CTAN, but notheng has happened afterwards), and at the
>fact that nobody came up with a suggestion of how to derive the
>languages from each other.
>
>It really doesn't hurt if we define two languages nb and nn (such as
>there are multiple languages for Czech/Slovak,
>Croatian/Bosnian/Serbian), and "remove" no, in the sense that no can
>be left as a synonym to nb only.
>
>Specifically:

The labels nn and nb should work or are there any problems?

\installlanguage [\s!no]        [\s!nb]
\installlanguage [\s!norwegian] [\s!nb]
\installlanguage [\s!bokmal]    [\s!nb]
\installlanguage [\s!nynorsk]   [\s!nn]

Please check what's in patterns/lang-n[bno].pat.

>-------------
>
>Hans F. Nordhaug:
> I think "no" should be deprecated and giving a (useful) warning/error -
> telling people to switch to "nb".

Now it defaults to nb in ConTeXt (no error message).

>-------------
>
>Karl:
>
>To sum up, we need the following language codes: nb and nn.
>And we need the following mappings:
>
>bokmal --> nb
>bokm?l --> nb (if possible)
>nynorsk --> nn
>norsk --> nb (with warning)
>norwegian --> nb (with warning)

Please check the state in languages.dat in TeX Live 2008.

>-------------
>
>Mojca:
>
>You also need to ask Hans how to provide a "'no' is not allowed
>language switch" warning or error.
>
>What are you planning to do with the "norwegian" interface?
>
>Hans: why is "Norwegian" currently not listed in mult-sys.tex? Because
>only languages which need something different than "ec" need to be
>listed there or is there some other reason?
>
>Hans, you pointed out the chineese module ... but from what I can see
>there, one needs to include the module explicitely and ConTeXt users
>are pampered too much ;) (i.e. everything should happen automatically)
>- is there a way to say something like this?
>
>\startlanguage[nn]
> ?\setupitemize[stopper=]
> ?\definesymbol[1][\endash]
>\stoplanguage

There exists a command \startlanguagespecifics. So you could probably use

\startlanguagespecifics[de]
  \setupitemize[stopper=]
  \definesymbol[1][\endash]
\stoplanguagespecifics

But I didn't test it (there were many users complaining that this
doesn't work since recently and I didn't follow if it was resolved or
not).

>-------------
>
>Karl/Mojca/Karl:
>>> ? ?leftquotation=\leftguillemot,
>>> ? ?rightquotation=\rightguillemot,
>>
>>Are the old values wrong or just an alternative?
>
>Well, there are no very strict rules in Norwegian; you *can* use every
>possible quotation mark. But the guillemots are certainly the preferred ones
>for (outer) quotations.

You need to choose one default value. I dared changing the defaults
after one year. If there is one preferred value and if other
Norwegians agree, you may change that.

>-------------
>
>Karl:
>
>My suggestion is
>
>\definesymbol[1][{\symbol[dash]}]
>\definesymbol[2][{\symbol[star]}]
>\definesymbol[3][{\symbol[circle]}]
>\definesymbol[4][{\symbol[bullet]}]
>\definesymbol[5][{\symbol[triangle]}]
>
>and leave levels 6+ at their defaults. Norwegian people, feel free to
> comment on this. :)

I'm not a Norwegian, so I cannot comment :)

>-------------
>
>Mojca:
>
>For Slovenian and Hungarian, the same "problem" exists. Now I use
>
>\def\placedotafter#1{#1.}
>\setuphead[section][numbercommand=\placedotafter]
>
>although it would be more clean if one could have something similar to
>
>\startlanguagespecifics[sl]
> ?\setupheads[stopper=.]
>\stoplanguagespecifics
>
>in default settings once that will be implemented.

Dot after header should be implemented by now, but I didn't come to it
yet. You could use a separate thread to ask about it. It can be solved
for mkiv, a bit more difficult with mkii.

>-------------
>
>Karl:
>
>\setupheadtext [\s!nb] [\v!content=Innhold]
>\setupheadtext [\s!nn] [\v!content=Innhald]

Anything wrong or missing in lang-ger.tex?

Mojca

From taco at elvenkind.com  Mon Apr 27 11:54:17 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 27 Apr 2009 11:54:17 +0200
Subject: [dev-context] metapost 1.200-rc2 package tests wanted
Message-ID: <49F580C9.8060202@elvenkind.com>


Hi all,

I have just released a second candidate for metapost 1.200.

New in this candidate is an altered syntax for string valued
newinternals, as proposed by Stephan Hennig. Input should now
look like this:

 newinternal string s;% new string internal with empty string value
 newinternal numeric num;% new numeric internal with zero value
 newinternal n;% for compatibility: same as 'newinternal numeric n;'

Also, a buffer reallocation bug was found that could cause crashes.

The packaged files are here:

  http://foundry.supelec.fr/frs/?group_id=13&release_id=336

Testing is more than welcome!

Have fun,

Taco


From preining at logic.at  Mon Apr 27 18:49:33 2009
From: preining at logic.at (Norbert Preining)
Date: Mon, 27 Apr 2009 18:49:33 +0200
Subject: [dev-context] [luatex] luatex beta 0.40.0
In-Reply-To: <49EEF0D4.1000606@elvenkind.com>
References: <49EEF0D4.1000606@elvenkind.com>
Message-ID: <20090427164933.GA22138@gamma.logic.tuwien.ac.at>

On Mi, 22 Apr 2009, Taco Hoekwater wrote:
>   svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.40.0

luatex 0.40 has been uploaded to Debian and binaries for various archs
will be available soon on the usual unstable sources.

I included already the ini files rework, and updates to texdoc.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
TRISPEN (n.) A form of intelligent grass. It grows a single, tough
stalk and makes its home on lawns. When it sees the lawnmower coming
it lies down and pops up again after it has gone by.
			--- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Tue May  5 12:12:47 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 05 May 2009 12:12:47 +0200
Subject: [dev-context] [NTG-context] mkII with minimals
In-Reply-To: <200905051206.43878.alan.braslau@cea.fr>
References: <49FF5DFF.29762.1F8910E@wwl.musensturm.de>	<4A000658.8030903@elvenkind.com>	<20090505094833.GF26946@phare.normalesup.org>
	<200905051206.43878.alan.braslau@cea.fr>
Message-ID: <4A00111F.9070506@elvenkind.com>


Hi,

As Alan wrote, it seems there are continuous problems with both
the minimals and the context mkiv distribution currently. Is
there anything I myself can do to help out?


From mojca.miklavec.lists at gmail.com  Tue May  5 12:40:26 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 5 May 2009 12:40:26 +0200
Subject: [dev-context] [NTG-context] mkII with minimals
In-Reply-To: <4A00111F.9070506@elvenkind.com>
References: <49FF5DFF.29762.1F8910E@wwl.musensturm.de>
	<4A000658.8030903@elvenkind.com>
	<20090505094833.GF26946@phare.normalesup.org>
	<200905051206.43878.alan.braslau@cea.fr>
	<4A00111F.9070506@elvenkind.com>
Message-ID: <6faad9f00905050340s3c019d0bp935d3e4ad2336466@mail.gmail.com>

On Tue, May 5, 2009 at 12:12, Taco Hoekwater wrote:
>
> Hi,
>
> As Alan wrote, it seems there are continuous problems with both
> the minimals and the context mkiv distribution currently. Is
> there anything I myself can do to help out?

I fixed texmf.cnf (sorry, I fell asleep yesterday), but I cannot do
anything about mkiv bugs before we start supporting falling back to
arbitrary ConTeXt version.

What about the following possibility? We could set up some repository
(whatever - svn/git/anything) with all the versions, including all
experimental and beta versions. Those users that would need it could
place a copy into texmf-local and switch between ConTeXt versions
arbitrary. A script on server could commit versions to that
repository.

I have a feeling that somebody on the list already has such a
repository, but even if we start from scratch that should be OK. I
could have start storing all the experimental versions, full-blown, on
the server, but that would be a killing consumer of space, most
probably adding some 100MB on the server every day. (Another option to
explore is Hans' proposal which probably needs some tools on user
side.)

Mojca

From arthur.reutenauer at normalesup.org  Tue May  5 12:52:06 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Tue, 5 May 2009 12:52:06 +0200
Subject: [dev-context] [NTG-context] mkII with minimals
In-Reply-To: <6faad9f00905050340s3c019d0bp935d3e4ad2336466@mail.gmail.com>
References: <49FF5DFF.29762.1F8910E@wwl.musensturm.de>
	<4A000658.8030903@elvenkind.com>
	<20090505094833.GF26946@phare.normalesup.org>
	<200905051206.43878.alan.braslau@cea.fr>
	<4A00111F.9070506@elvenkind.com>
	<6faad9f00905050340s3c019d0bp935d3e4ad2336466@mail.gmail.com>
Message-ID: <20090505105206.GG26946@phare.normalesup.org>

> I have a feeling that somebody on the list already has such a
> repository

  There is the ConTeXt revisions repository at the Sup?lec foundry
(http://foundry.supelec.fr/projects/contextrev/), but I don't have the
impression that Taco maintains it any more.

>                                                                  I
> could have start storing all the experimental versions, full-blown, on
> the server, but that would be a killing consumer of space, most
> probably adding some 100MB on the server every day.

  I do have quite a lot of ConTeXt zips on my laptop, which I've been
collecting since approximately one year (probably not all, but
definitely a lot).  It is big, but not that terrible (1.7GB).  The main
ConTeXt zip is only 7MB after all.  Of course, it is around 30MB
uncompressed.

	Arthur

From pragma at wxs.nl  Tue May  5 12:55:44 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 05 May 2009 12:55:44 +0200
Subject: [dev-context] [NTG-context] mkII with minimals
In-Reply-To: <20090505105206.GG26946@phare.normalesup.org>
References: <49FF5DFF.29762.1F8910E@wwl.musensturm.de>	<4A000658.8030903@elvenkind.com>	<20090505094833.GF26946@phare.normalesup.org>	<200905051206.43878.alan.braslau@cea.fr>	<4A00111F.9070506@elvenkind.com>	<6faad9f00905050340s3c019d0bp935d3e4ad2336466@mail.gmail.com>
	<20090505105206.GG26946@phare.normalesup.org>
Message-ID: <4A001B30.2030707@wxs.nl>

Arthur Reutenauer wrote:
>> I have a feeling that somebody on the list already has such a
>> repository
> 
>   There is the ConTeXt revisions repository at the Sup?lec foundry
> (http://foundry.supelec.fr/projects/contextrev/), but I don't have the
> impression that Taco maintains it any more.

there will be a tex live release (current) which then results in an 
update ... simply too many changes to mkiv to bother with release notes now


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Tue May  5 13:04:14 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 05 May 2009 13:04:14 +0200
Subject: [dev-context] [NTG-context] mkII with minimals
In-Reply-To: <20090505105206.GG26946@phare.normalesup.org>
References: <49FF5DFF.29762.1F8910E@wwl.musensturm.de>
	<4A000658.8030903@elvenkind.com>
	<20090505094833.GF26946@phare.normalesup.org>
	<200905051206.43878.alan.braslau@cea.fr>
	<4A00111F.9070506@elvenkind.com>
	<6faad9f00905050340s3c019d0bp935d3e4ad2336466@mail.gmail.com>
	<20090505105206.GG26946@phare.normalesup.org>
Message-ID: <4A001D2E.3040705@elvenkind.com>

Arthur Reutenauer wrote:
>> I have a feeling that somebody on the list already has such a
>> repository
> 
>   There is the ConTeXt revisions repository at the Sup?lec foundry
> (http://foundry.supelec.fr/projects/contextrev/), but I don't have the
> impression that Taco maintains it any more.

Only 'current' releases are there right now, no betas are kept.

>   I do have quite a lot of ConTeXt zips on my laptop, which I've been
> collecting since approximately one year (probably not all, but
> definitely a lot).  It is big, but not that terrible (1.7GB).  The main
> ConTeXt zip is only 7MB after all.  Of course, it is around 30MB
> uncompressed.

A branch with all the beta's you have (perhaps since the last current)
would be useful at this stage, I think. If you can upload them to the
FRS section of the museum (you should have permission to do so already),
I can will them to the SVN Repo afterwards.


Best wishes,
Taco

From mojca.miklavec.lists at gmail.com  Tue May  5 13:38:56 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 5 May 2009 13:38:56 +0200
Subject: [dev-context] [NTG-context] mkII with minimals
In-Reply-To: <4A001D2E.3040705@elvenkind.com>
References: <49FF5DFF.29762.1F8910E@wwl.musensturm.de>
	<4A000658.8030903@elvenkind.com>
	<20090505094833.GF26946@phare.normalesup.org>
	<200905051206.43878.alan.braslau@cea.fr>
	<4A00111F.9070506@elvenkind.com>
	<6faad9f00905050340s3c019d0bp935d3e4ad2336466@mail.gmail.com>
	<20090505105206.GG26946@phare.normalesup.org>
	<4A001D2E.3040705@elvenkind.com>
Message-ID: <6faad9f00905050438n4696ae9bqeec3d91aece71ad7@mail.gmail.com>

On Tue, May 5, 2009 at 13:04, Taco Hoekwater wrote:
> Arthur Reutenauer wrote:
>>>
>>> I have a feeling that somebody on the list already has such a
>>> repository
>>
>> ?There is the ConTeXt revisions repository at the Sup?lec foundry
>> (http://foundry.supelec.fr/projects/contextrev/), but I don't have the
>> impression that Taco maintains it any more.
>
> Only 'current' releases are there right now, no betas are kept.

No, I think that someone from far East has some git repository with
every experimental version included.

Maybe that's Xan, but I'm not sure.

Mojca

From taco at elvenkind.com  Fri May  8 16:55:16 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 08 May 2009 16:55:16 +0200
Subject: [dev-context] luatex beta 0.40.1
Message-ID: <4A0447D4.6030404@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.1 to the foundry server,
and have committed the source code to texlive.

What's new:

* Vertical placement of root radicals and degrees is fixed.

* The use of \pageleftoffset could deviate from \hoffset
  if \mag != 1000.

* LuaTeX now issues a warning if \pagedir != \bodydir during
  shipout.

* The previous crash in font.read_tfm() was still not quite
  correct.

* The Web2C version is now also printed in the --version
  and --credits output.


* There is a new MPlib 1.200 release candidate with a few minor
  fixes included.

* The xpdf library is updated to patch level 3.

* New imports to the build system, from texlive. In particular,
  there is now configure-level support for building with
  libpoppler and support for building under cygwin 1.7 is added.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.40.1

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco





From taco at elvenkind.com  Fri May  8 17:06:35 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 08 May 2009 17:06:35 +0200
Subject: [dev-context] [Dev-luatex] luatex beta 0.40.1
In-Reply-To: <4A0447D4.6030404@elvenkind.com>
References: <4A0447D4.6030404@elvenkind.com>
Message-ID: <4A044A7B.3000404@elvenkind.com>


Hi guys,

Right after, I have switched the trunk to version number 0.41.0

Best wishes,
Taco

Taco Hoekwater wrote:
> Hi,
> 
> I have just uploaded luatex 0.40.1 to the foundry server,
> and have committed the source code to texlive.
> 


From mojca.miklavec.lists at gmail.com  Sat May  9 18:09:50 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sat, 9 May 2009 18:09:50 +0200
Subject: [dev-context] recent failure in mp graphics or clipping
Message-ID: <6faad9f00905090909x4d366251t49c47722aa3a0a74@mail.gmail.com>

Hello Hans,

I would need to create a minimal example, but I cannot do that before
I get the module to work again (\savebuffer) and I need to finish the
report first (before getting lost in bug reports instead of
concentrating on content).

When compiling one month old document with mkiv I stumble upon the
following problem. I had to run mkii to generate external files first
(via buffers) and then I tried to run mkiv and I get the following
error report. If it rings any bell to you, feel free to fix it and I
will gladly test it. (Which command exactly is undefined? \ifcsnameMPC
can indeed only be found at a single place, most probably undefined
indeed. I'm using clipping on PNG graphics if that helps.) Else I will
come back to it once I'm finished with the report. (I'm still using
mkii anyway, so there's no particular hurry.)

Thanks,
    Mojca

This is LuaTeX, Version beta-0.40.1-2009050813 (Web2C 7.5.7)
ConTeXt  ver: 2009.05.08 21:48 MKIV  fmt: 2009.5.8  int: english/english

------------------------------

aaa             : texmfstart --direct gnuplot 20-sor-gnuplot-3.plt
! Undefined control sequence.
\grabMPclippath ...layheight \height \ifcsnameMPC
                                                  :#1\endcsname \xdef \MPcli...
\dostartclipping ... \width \height l 0 \height l}
                                                  \pdfliteral {q 0 w \MPclip...
\dodowithnextbox ...g \@@cpmp \!!dimena \!!dimenb
                                                  \flushnextbox \dostopclipp...
\grafika ...OTgraphic [#2][width=\pixwidthbig pt]}
                                                  }
<argument> ...mbination [2*2]{\grafikahitrosti {4}
                                                  }{$n=4$} {\grafikahitrosti...
\centerline #1->\line {\hss #1
                              \hss }
l.292 \stopcombination}
                       \crlf\centerline{\useGNUPLOTgraphic[hitrost 50 3D][wi...
?

From pragma at wxs.nl  Sun May 10 17:18:05 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 10 May 2009 17:18:05 +0200
Subject: [dev-context] recent failure in mp graphics or clipping
In-Reply-To: <6faad9f00905090909x4d366251t49c47722aa3a0a74@mail.gmail.com>
References: <6faad9f00905090909x4d366251t49c47722aa3a0a74@mail.gmail.com>
Message-ID: <4A06F02D.7090801@wxs.nl>

Mojca Miklavec wrote:
> Hello Hans,
> 
> I would need to create a minimal example, but I cannot do that before
> I get the module to work again (\savebuffer) and I need to finish the
> report first (before getting lost in bug reports instead of
> concentrating on content).

add to core-buf.mkiv:

\def\savebuffer{\dosingleempty\dosavebuffer}
\def\dosavebuffer[#1]{\ctxlua{buffers.save("#1")}}

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Mon May 11 00:11:55 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 11 May 2009 00:11:55 +0200
Subject: [dev-context] recent failure in mp graphics or clipping
In-Reply-To: <4A06F02D.7090801@wxs.nl>
References: <6faad9f00905090909x4d366251t49c47722aa3a0a74@mail.gmail.com>
	<4A06F02D.7090801@wxs.nl>
Message-ID: <6faad9f00905101511l79dea003mda63afcf83703370@mail.gmail.com>

On Sun, May 10, 2009 at 17:18, Hans Hagen wrote:
>
> add to core-buf.mkiv:
>
> \def\savebuffer{\dosingleempty\dosavebuffer}
> \def\dosavebuffer[#1]{\ctxlua{buffers.save("#1")}}

Thanks a lot for adding the command again. Though the other problem is
still present. Minimal example to reproduce the problem:
    \clip{test}

! Undefined control sequence.
\grabMPclippath ...layheight \height \ifcsnameMPC
                                                  :#1\endcsname \xdef \MPcli...
\dostartclipping ... \width \height l 0 \height l}
                                                  \pdfliteral {q 0 w \MPclip...
\dodowithnextbox ...g \@@cpmp \!!dimena \!!dimenb
                                                  \flushnextbox \dostopclipp...
l.2 \clip{test}


Mojca

From taco at elvenkind.com  Mon May 11 11:09:41 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 11 May 2009 11:09:41 +0200
Subject: [dev-context] MetaPost 1.200 announcement
Message-ID: <4A07EB55.7020907@elvenkind.com>


The MetaPost team is happy to announce a new release of MetaPost:

----------------------------------------------------------------------
MetaPost 1.200
----------------------------------------------------------------------

The standalone distribution package and a win32 binary can be downloaded
immediately from

  http://foundry.supelec.fr/projects/metapost/

This release will also be available from CTAN soon, and it will be
included in the next TeXLive. The source package should compile normally
on all systems that are capable of compiling a modern web2c-based TeX
distribution.

The win32 binary is intended for texlive or a similar web2c-based
installation, this executable will *not* work for miktex.

Of course, we welcome any comments (either good or bad) that you may
have. Simply replying to this message is fine, but see the bottom of
the message for a more formal way to report bugs and feature requests.

----------------------------------------------------------------------
What is new in MetaPost version 1.200:
----------------------------------------------------------------------

New features:

* It is now possible to get the actual path drawing routines from a
  font glyph. The syntax is :

    q := glyph 113 of "cmr10";
    q := glyph "one.oldstyle" of "lmr10";

  "glyph" is a primary binary operator (like "subpath") that accepts
  a string or number and a string, and the result is a picture.

  The second argument is a tfm name. This will be combined with
  a fontmap entry to find the font's PostScript source file.

  If the first argument is a string, then it should be a Charstring
  name in the postscript font source. If the first argument is
  an integer, it is an index into the encoding of the font, and
  the Charstring that is mapped to that index is taken (it follows
  that numeric values have to be integers between 0 and 255).

  The returned picture can be empty (if the tfm or the pfb or the
  encoding or the Charstring was not found), otherwise it consists
  of a list of 'fill' objects that use the the 'grey' color model.
  Counterclockwise paths receive the grey value matching 'white',
  clockwise paths 'black'.

* MetaPost now supports string valued internal variables. Three of
  these are predefined ("jobname", "outputformat", "outputtemplate"),
  you can add more of them via "newinternal".

    newinternal string s;
    s := "hello";

  The type of a new internal is either 'string' or 'numeric',
  and defaults to numeric (this is for backward compatibility with
  older versions of MetaPost). String internals are initialized to
  the empty string, numeric internals are initialized to zero.

* MetaPost now has a second backend that generates Scalable Vector
  Graphics output. This new backend was requested by Dave Crossland, who
  also provided the funding to make it possible.  Dave, thank you again!

  The default value of "outputformat" is "eps"; when you assign "svg"
  you will get SVG output.

  If you use text labels with SVG, you will probably also want to set

    prologues:=3;

  With this setting, MetaPost will convert the font into curves
  (of course you also need a correct font map line, just as for
  PostScript output).

  With any other value of "prologues" you will simply get the SVG
  default text font in a system-dependant encoding. This is unlikely
  to be what you want!

  A simple example:

    outputformat := "svg";
    outputtemplate := "%j-%c.svg";
    beginfig(1);
    fill fullcircle scaled 100 withcolor .4red;
    endfig;
    end.

  In the lua bindings, there is the new figure method "svg()", that
  gives back the SVG output string. This is subtly different from the
  direct file output: the lua method does not prepend an XML declaration
  (this makes embedded use of the generated XML easier).

* The new internal string variable "outputtemplate" replaces
  "filenametemplate". The big difference is that "outputtemplate"
  is a true 'internal', so that you need a proper assignment.
  On the positive side, this means that you can use its current
  value with e.g. show and message.

* "outputtemplate" has a new type of replacement: internal variable
  names. Instead of the short "%j.%c", you could write:

     outputtemplate := "%{jobname}.%{charcode}" ;

  this type of replacement works for all internal variables,
  including those defined via "newinternal".

* There are two new numeric internals: "hour" and "minute".
  (these are a consequence of the outputtemplate change)

* The primitive "jobname" is now a string internal instead of a
  special case. This implies you can assign to "jobname", but
  such an assignment will only affect the picture output. The
  job name for the purposes of log and mem file names is fixed
  permanently at startup time and cannot be altered.

* "mpost" can now pretend to be dvitomp. Either copy the executable
  to the name "dvitomp", or pass the switch --dvitomp on the command
  line.

* The command line option --halt-on-error has been reinstated.

* There is a new -s<internal>=<value> command line switch that can
  be used to setup run time values. Such assignment will be executed
  after initialization is complete (i.e. after mem file loading) but
  before any other code is executed.

  This works for all internal variables, including one defined
  that may have been defined in the mem file via "newinternal".

* "tracingstats:=1;" now prints the highest and total input levels.

Bug fixes:

* The turningnumber calculation had a rounding error in the internal
  arithmetic that could cause incorrect numbers to be calculated
  (typically resulting in a 'turning numbers do not match' error).

* The parsing of command line arguments with options was broken.

* Reading of files with 8-bit names has been fixed.

* A patch by Melissa O'Neill fixes inclusion of some special Type1
  formats.

* There was a bug where, when "prologues:=3;", the lists of the
  DocumentResources/DocumentSuppliedResources could appear in the eps
  output partially uncommented.

* Troff labels were completely broken in all MPlib-based versions.

Other changes:

* Many, many improvements to the manual and the tutorial. Sorry
  Stephan, I don't know enough to list them all!

* The old executable build system has been replaced by the new build
  system from the TeXLive 2009 repository.

* The MetaPost (and mplib) source code is now released under LGPL
  instead of GPL, and uses a derivative of PyAvl instead of GNU libavl.

* The web2c 'mktexfmt' feature is enabled for the program "mpost" once
  again.

----------------------------------------------------------------------
Legal notice / license / bug reports
----------------------------------------------------------------------

MetaPost is a system for producing graphics developed by John Hobby
at AT&T, based on Donald Knuth's Metafont.  The MetaPost home page
is http://tug.org/metapost.

MetaPost is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation, either version 2 of the License, or (at your
option) any later version.

The MetaPost development project is currently hosted at Supelec,
https://foundry.supelec.fr/projects/metapost; please report bugs and
request enhancements through there if possible. Alternatively, you
can reach us through the <metapost at tug.org> mailing list as well.

Have fun!

Taco Hoekwater, for the MetaPost team, May 11, 2009.



From taco at elvenkind.com  Mon May 18 23:07:35 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 18 May 2009 23:07:35 +0200
Subject: [dev-context] Supelec is back
Message-ID: <4A11CE17.7090206@elvenkind.com>

Hi all,

For those of you who have not noticed yet: the foundry.supelec.fr
server is back online with new hardware and software, and is running
better than ever.

There is a small snag that some of you may have noticed already:
you will have to delete your current checkouts of all subversion
projects, because the machine now solely talks DAV (and besides
that, the repository UUIDs have changed as well).

If you have made local changes, put them aside first. The svn diff
command should still work as local changes are indeed remembered
locally. Once you have secured everything you want to save, move
or delete the whole old checkout, and run this command to get a
new checkout:

  svn checkout --username <yourname>
          http://foundry.supelec.fr/svn/<project>

Replace <project> with the project(s) you are working on and
fill in your system login for <yourname>, or use "anonymous"
for a read-only checkout (just hit <enter> at the password
prompt in that case).

Best wishes,
Taco

From mojca.miklavec.lists at gmail.com  Fri May 22 13:31:45 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Fri, 22 May 2009 13:31:45 +0200
Subject: [dev-context] images with dots in filenames
Message-ID: <6faad9f00905220431r2e321869hc7c98ffa02dc3298@mail.gmail.com>

Hello Hans,

I have file a-1.0.png. Using \extrernalfigure[a-1.0] (in mkii) results
in "a-1" not found. \extrernalfigure[a-1.0.png] works OK. Is that
behaviour expected/on purpose/hard to fix properly?

Thanks,
    Mojca

From mojca.miklavec.lists at gmail.com  Sat May 23 16:42:35 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sat, 23 May 2009 16:42:35 +0200
Subject: [dev-context] piping to ConTeXt
Message-ID: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>

Hello Hans,

Asymptote developers wonder if there's a way to pipe to ConTeXt. I
didn't start inspecting anything as I suspect that it's quite possible
that nobody has ever tried that so far.

The trick that John Bowman decided to use was to "\input null" (an
empty tex file "null.tex"), but I already had problems because I
(forgot that I) didn't have that file.

Mojca

From oliver.buerschaper at mpq.mpg.de  Sat May 23 17:03:48 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Sat, 23 May 2009 17:03:48 +0200
Subject: [dev-context] Making a minimals update svn friendly
Message-ID: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>

Hi folks,

what I would like to do is updating a minimal context tree which is  
under svn version control ... the problem with the current setup is that

mtxrun mtx-update.lua

deletes all .svn subdirectories in the destination directories it  
touches for synchronization. This is bad because it completely spoils  
version control.

However, by supplying the additional flag

--filter="P .svn"

to the rsync command one should be able to sync and still  
preserve .svn subdirectories. Hence I suggest the following patches to

mtxrun
mtx-update.lua

in order to make the updating process svn friendly:

diff bin/mtxrun bin.orig/mtxrun
9384c9384
< --~ 		["flags"]      = "-rpztlv --stats --filter='P .svn'",
---
 > --~ 		["flags"]      = "-rpztlv --stats",

diff bin/mtx-update.lua bin.orig/mtx-update.lua
459c459
<     states.set("rsync.flags.normal", environment.argument("flags"),  
"-rpztlv --stats --filter='P .svn'", true) -- ok
---
 >     states.set("rsync.flags.normal", environment.argument("flags"),  
"-rpztlv --stats", true) -- ok

This works on my machine (Mac OS X 10.5.7). I'm afraid I cannot test  
this on other platforms at the moment ...

What do you guys think?

Best,
Oliver

From adityam at umich.edu  Sat May 23 17:19:09 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sat, 23 May 2009 11:19:09 -0400 (EDT)
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>

On Sat, 23 May 2009, Mojca Miklavec wrote:

> Hello Hans,
>
> Asymptote developers wonder if there's a way to pipe to ConTeXt.

More precisely, they want to do the following:

context misc/null
...
...
*
\newbox\ASYbox
\newdimen\ASYdimen
\long\def\ASYbase#1#2{\leavevmode\setbox\ASYbox=\hbox{#1}\ASYdimen=\ht\ASYbox%
\setbox\ASYbox=\hbox{#2}\lower\ASYdimen\box\ASYbox}
\font\ASYfont=lmr12 at 12pt\ASYfont\switchtobodyfont[12pt]%
%
(Please type a command or say `\end')
*\setbox\ASYbox=\hbox{$x$}


*
*
*
*
*
*
*(Please type a command or say `\end')
*\showthe\wd\ASYbox
> 6.67703pt.

etc... (for the moment, ignore the fact that the font setup is incorrect)

> I
> didn't start inspecting anything as I suspect that it's quite possible
> that nobody has ever tried that so far.

Ideal will be to have --interactive switch.

> The trick that John Bowman decided to use was to "\input null" (an
> empty tex file "null.tex"), but I already had problems because I
> (forgot that I) didn't have that file.

Do you know someone who maintains a major ConText distribution. Maybe you 
can ask her to add that file :-)

Aditya

From adityam at umich.edu  Sat May 23 17:22:03 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sat, 23 May 2009 11:22:03 -0400 (EDT)
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
Message-ID: <alpine.LNX.2.00.0905231119390.28883@ybpnyubfg.ybpnyqbznva>

On Sat, 23 May 2009, Oliver Buerschaper wrote:

> What do you guys think?

If such a thing is added, we should also support other VCs.

BTW, I usually do

first-setup.sh --keep

so that the git directories are not deleted.

Aditya

From mojca.miklavec.lists at gmail.com  Sat May 23 18:16:53 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sat, 23 May 2009 18:16:53 +0200
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
Message-ID: <6faad9f00905230916v76eb1b4ai76dbc14c360472bf@mail.gmail.com>

On Sat, May 23, 2009 at 17:03, Oliver Buerschaper wrote:
> Hi folks,
>
> what I would like to do is updating a minimal context tree which is under
> svn version control ... the problem with the current setup is that
>
> mtxrun mtx-update.lua
>
> deletes all .svn subdirectories in the destination directories it touches
> for synchronization. This is bad because it completely spoils version
> control.
>
> However, by supplying the additional flag
>
> --filter="P .svn"
>
> to the rsync command one should be able to sync and still preserve .svn
> subdirectories. Hence I suggest the following patches to
>
> mtxrun
> mtx-update.lua
>
> in order to make the updating process svn friendly:
>
> diff bin/mtxrun bin.orig/mtxrun
> 9384c9384
> < --~ ? ? ? ? ? ["flags"] ? ? ?= "-rpztlv --stats --filter='P .svn'",
> ---
>> --~ ? ? ? ? ? ["flags"] ? ? ?= "-rpztlv --stats",
>
> diff bin/mtx-update.lua bin.orig/mtx-update.lua
> 459c459
> < ? ? states.set("rsync.flags.normal", environment.argument("flags"),
> "-rpztlv --stats --filter='P .svn'", true) -- ok
> ---
>> ? ? states.set("rsync.flags.normal", environment.argument("flags"),
>> "-rpztlv --stats", true) -- ok
>
> This works on my machine (Mac OS X 10.5.7). I'm afraid I cannot test this on
> other platforms at the moment ...
>
> What do you guys think?

That sounds fine to me. Though I suspect that one could add
    --flags="-rpzltv --filter='P .svn'"
when calling rsync, this would probably fail because of
    states.set("rsync.flags.normal", environment.argument("flags"),
"-rpztlv --stats", true) -- ok
    states.set("rsync.flags.delete", nil, "--delete", true) -- ok
so the second one is hardcoded.

To what Aditya has answered: --keep option is probably not the
solution to what Oliver wants to achieve. I suspect that he indeed
wants to delete obsolete files, but preserve .svn.

This needs to be fixed by Hans, but my preference would probably be to
fix the behaviour for the other hardcoded delete flag. Exactly because
there might pop up other users wanting to ignore their git, mercurial,
darcs, ... files. And it would make sense to document that behaviour
somewhere.

Mojca

From pragma at wxs.nl  Sat May 23 19:40:33 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 23 May 2009 19:40:33 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
Message-ID: <4A183511.7020805@wxs.nl>

Mojca Miklavec wrote:

> Asymptote developers wonder if there's a way to pipe to ConTeXt. I
> didn't start inspecting anything as I suspect that it's quite possible
> that nobody has ever tried that so far.

i have no clue what that means; context is just using tex so anything 
that applies to tex (the engine) applies to context

do you know why this piping is needed?

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat May 23 19:56:48 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 23 May 2009 19:56:48 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A1838E0.5000705@wxs.nl>

Aditya Mahajan wrote:

> context misc/null
> ....
> ....
> *
> \newbox\ASYbox
> \newdimen\ASYdimen
> \long\def\ASYbase#1#2{\leavevmode\setbox\ASYbox=\hbox{#1}\ASYdimen=\ht\ASYbox% 
> 
> \setbox\ASYbox=\hbox{#2}\lower\ASYdimen\box\ASYbox}
> \font\ASYfont=lmr12 at 12pt\ASYfont\switchtobodyfont[12pt]%
> %
> (Please type a command or say `\end')
> *\setbox\ASYbox=\hbox{$x$}
> 
> 
> *
> *
> *
> *
> *
> *
> *(Please type a command or say `\end')
> *\showthe\wd\ASYbox
>> 6.67703pt.
> 
> etc... (for the moment, ignore the fact that the font setup is incorrect)

hm, this should be possible but you should keep in mind then that the 
run is separate from the main run so dimensions (and fonts and ...) 
might not reflect reality

if real integration is needed, a multipass approach might make more 
sense (ok, one can pass environments to the null run if needed)

(1) run asymptote from current run on tex file, (2) during that run 
asymptote creates a tex file, (3) after the run tex picks up its run and 
processes that tex file writing dimensions to another file, (4) another 
asymptote run uses those dimensions

anyhow, it all depends on what one wants to achieve ... in mkiv we can 
also think of:

(1) open socket connection, (2) run asymptote from current run on tex 
file (in parallel), (3) communicate via socket till done

i'm not sure how well this works, maybe just pipes are better, but 
experiments that we did with that (before mplib) made us pessimistic as 
there are platform and timing issues involved


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat May 23 21:06:38 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 23 May 2009 21:06:38 +0200
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
Message-ID: <4A18493E.8090604@wxs.nl>

Oliver Buerschaper wrote:
> Hi folks,
> 
> what I would like to do is updating a minimal context tree which is 
> under svn version control ... the problem with the current setup is that
> 
> mtxrun mtx-update.lua
> 
> deletes all .svn subdirectories in the destination directories it 
> touches for synchronization. This is bad because it completely spoils 
> version control.
> 
> However, by supplying the additional flag
> 
> --filter="P .svn"
> 
> to the rsync command one should be able to sync and still preserve .svn 
> subdirectories. Hence I suggest the following patches to

but that's only for texmf-local i assume

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat May 23 21:09:03 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 23 May 2009 21:09:03 +0200
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <6faad9f00905230916v76eb1b4ai76dbc14c360472bf@mail.gmail.com>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
	<6faad9f00905230916v76eb1b4ai76dbc14c360472bf@mail.gmail.com>
Message-ID: <4A1849CF.8070905@wxs.nl>

Mojca Miklavec wrote:

> This needs to be fixed by Hans, but my preference would probably be to
> fix the behaviour for the other hardcoded delete flag. Exactly because
> there might pop up other users wanting to ignore their git, mercurial,
> darcs, ... files. And it would make sense to document that behaviour
> somewhere.

how about adding a --filter flag? we might assume that users who have 
complex setups script the update anyway

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Sun May 24 00:00:36 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sun, 24 May 2009 00:00:36 +0200
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <4A18493E.8090604@wxs.nl>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
	<4A18493E.8090604@wxs.nl>
Message-ID: <6faad9f00905231500m7c19c532lcb87808f09973730@mail.gmail.com>

On Sat, May 23, 2009 at 21:06, Hans Hagen wrote:
> Oliver Buerschaper wrote:
>>
>> However, by supplying the additional flag
>>
>> --filter="P .svn"
>>
>> to the rsync command one should be able to sync and still preserve .svn
>> subdirectories. Hence I suggest the following patches to
>
> but that's only for texmf-local i assume

I'm just guessing that Oliver is asking about the whole installation.
texmf-local is left intact anyway.

Mojca

From mojca.miklavec.lists at gmail.com  Sun May 24 01:26:08 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sun, 24 May 2009 01:26:08 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
Message-ID: <6faad9f00905231626u5abf5b05v8c9d6b89ca30585a@mail.gmail.com>

On Sat, May 23, 2009 at 17:19, Aditya Mahajan wrote:
>
> Do you know someone who maintains a major ConText distribution.

Indeed I have very poor contacts (I don't know many people even if
they live in the same village).

> Maybe you can ask her to add that file :-)

Once we figure out if it's needed for this purpose at all.

Mojca

From adityam at umich.edu  Sun May 24 04:43:31 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sat, 23 May 2009 22:43:31 -0400 (EDT)
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <6faad9f00905231626u5abf5b05v8c9d6b89ca30585a@mail.gmail.com>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
	<6faad9f00905231626u5abf5b05v8c9d6b89ca30585a@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.0905232241300.8600@ybpnyubfg.ybpnyqbznva>

On Sun, 24 May 2009, Mojca Miklavec wrote:

>> Maybe you can ask her to add that file :-)
>
> Once we figure out if it's needed for this purpose at all.

There is already a use for it. When you type \input nonexistantfile, then 
you can type "null" at the tex prompt to make tex continue with the rest 
of the compilation. And there is no harm in adding the file, it is really 
small :)

Aditya

From pragma at wxs.nl  Sun May 24 12:22:08 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 24 May 2009 12:22:08 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <alpine.LNX.2.00.0905232241300.8600@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>	<6faad9f00905231626u5abf5b05v8c9d6b89ca30585a@mail.gmail.com>
	<alpine.LNX.2.00.0905232241300.8600@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A191FD0.4020207@wxs.nl>

Aditya Mahajan wrote:
> On Sun, 24 May 2009, Mojca Miklavec wrote:
> 
>>> Maybe you can ask her to add that file :-)
>>
>> Once we figure out if it's needed for this purpose at all.
> 
> There is already a use for it. When you type \input nonexistantfile, 
> then you can type "null" at the tex prompt to make tex continue with the 
> rest of the compilation. And there is no harm in adding the file, it is 
> really small :)

i actually have in the past) removed that null.tex because i don't like 
that kind of hackery; also there are other ways to stop tex

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sun May 24 12:30:25 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 24 May 2009 12:30:25 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>
	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A1921C1.2040600@wxs.nl>

Aditya Mahajan wrote:
> On Sat, 23 May 2009, Mojca Miklavec wrote:
> 
>> Hello Hans,
>>
>> Asymptote developers wonder if there's a way to pipe to ConTeXt.
> 
> More precisely, they want to do the following:
> 
> context misc/null
> ....
> ....
> *
> \newbox\ASYbox
> \newdimen\ASYdimen
> \long\def\ASYbase#1#2{\leavevmode\setbox\ASYbox=\hbox{#1}\ASYdimen=\ht\ASYbox% 
> 
> \setbox\ASYbox=\hbox{#2}\lower\ASYdimen\box\ASYbox}
> \font\ASYfont=lmr12 at 12pt\ASYfont\switchtobodyfont[12pt]%
> %
> (Please type a command or say `\end')
> *\setbox\ASYbox=\hbox{$x$}
> 
> 
> *
> *
> *
> *
> *
> *
> *(Please type a command or say `\end')
> *\showthe\wd\ASYbox
>> 6.67703pt.

a more context friendly way would be to load a module that defined a few 
commands, like

\newbox\ASYbox

\def\showASYdimensions
   {\immediate\write16{ASY whd:
       \the\wd\ASYbox\space
       \the\ht\ASYbox\space
       \the\dp\ASYbox\space}}

\long\def\setASYhbox#1%
   {\setbox\ASTbox\hbox{#1}\showASYdimensions}

\long\def\setASYvbox#1%
   {\setbox\ASTbox\vbox{#1}\showASYdimensions}

or whatever set of commands is needed. Kind of a ASY interface. That way 
we can finetune at the tex level, for instance:

\long\def\setASYhbox#1%
   {\setbox\ASTbox\hbox{\strut#1}%
    \showASYdimensions}

\long\def\setASYvbox#1%
  {\setbox\ASTbox\vbox{\forgetall\begstrut#1\endstrut}%
   \showASYdimensions}

which might give better output

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Sun May 24 13:16:15 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 24 May 2009 13:16:15 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <4A1921C1.2040600@wxs.nl>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
	<4A1921C1.2040600@wxs.nl>
Message-ID: <4A192C7F.50405@elvenkind.com>

Hans Hagen wrote:
> 
> a more context friendly way would be to load a module that defined a few 
> commands, like

I think that is not the point. The point is that sometimes you want
to pipe input directly into context, and you simply can't at the
moment, because context and texexec refuse to run without an input
file name.

Everything else that is discussed in this thread is just a distraction.

Best wishes,
Taco



From pragma at wxs.nl  Sun May 24 13:58:47 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 24 May 2009 13:58:47 +0200
Subject: [dev-context] piping to ConTeXt
In-Reply-To: <4A192C7F.50405@elvenkind.com>
References: <6faad9f00905230742uc78a0a6x11b2854933e98585@mail.gmail.com>	<alpine.LNX.2.00.0905231113500.28883@ybpnyubfg.ybpnyqbznva>
	<4A1921C1.2040600@wxs.nl> <4A192C7F.50405@elvenkind.com>
Message-ID: <4A193677.3010902@wxs.nl>

Taco Hoekwater wrote:
> Hans Hagen wrote:
>>
>> a more context friendly way would be to load a module that defined a 
>> few commands, like
> 
> I think that is not the point. The point is that sometimes you want
> to pipe input directly into context, and you simply can't at the
> moment, because context and texexec refuse to run without an input
> file name.

sure, that's why we have --pipe now

> Everything else that is discussed in this thread is just a distraction.

indeed, but since we're discussing asymptote support it makes sense to 
see how we do it as convenient as possible (for instance i can imagine 
that graphics made that wat somehow need to match the parent doc and so)

as a side effect, "context --global m-asymp" with m-asymp being an empty 
file or one defining a few helpers would automatically enter scroll mode 
  -)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oliver.buerschaper at mpq.mpg.de  Mon May 25 03:30:15 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Mon, 25 May 2009 11:30:15 +1000
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <6faad9f00905231500m7c19c532lcb87808f09973730@mail.gmail.com>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
	<4A18493E.8090604@wxs.nl>
	<6faad9f00905231500m7c19c532lcb87808f09973730@mail.gmail.com>
Message-ID: <7D363C0F-3A9E-4AD2-8FA7-0E4B73FFF640@mpq.mpg.de>

>>> However, by supplying the additional flag
>>>
>>> --filter="P .svn"
>>>
>>> to the rsync command one should be able to sync and still  
>>> preserve .svn
>>> subdirectories. Hence I suggest the following patches to
>>
>> but that's only for texmf-local i assume
>
> I'm just guessing that Oliver is asking about the whole installation.
> texmf-local is left intact anyway.

Exactly. I downloaded the minimals distro from scratch and put the  
entire distro tree under svn control. What I would like to update now  
is this very installation ...

Best,
Oliver

From oliver.buerschaper at mpq.mpg.de  Mon May 25 03:33:28 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Mon, 25 May 2009 11:33:28 +1000
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <6faad9f00905230916v76eb1b4ai76dbc14c360472bf@mail.gmail.com>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
	<6faad9f00905230916v76eb1b4ai76dbc14c360472bf@mail.gmail.com>
Message-ID: <7470CEB4-C9BE-49CD-8A43-83D7AB7C2D3F@mpq.mpg.de>

> To what Aditya has answered: --keep option is probably not the
> solution to what Oliver wants to achieve. I suspect that he indeed
> wants to delete obsolete files, but preserve .svn.

Yep. (Although I'm not quite sure what --keep exactly does here.)

Oliver

From adityam at umich.edu  Mon May 25 03:55:01 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 24 May 2009 21:55:01 -0400 (EDT)
Subject: [dev-context] Making a minimals update svn friendly
In-Reply-To: <7470CEB4-C9BE-49CD-8A43-83D7AB7C2D3F@mpq.mpg.de>
References: <E37A0F59-40A4-454B-BD87-EE03EA28736D@mpq.mpg.de>
	<6faad9f00905230916v76eb1b4ai76dbc14c360472bf@mail.gmail.com>
	<7470CEB4-C9BE-49CD-8A43-83D7AB7C2D3F@mpq.mpg.de>
Message-ID: <alpine.LNX.2.00.0905242154340.26682@ybpnyubfg.ybpnyqbznva>

On Mon, 25 May 2009, Oliver Buerschaper wrote:

>> To what Aditya has answered: --keep option is probably not the
>> solution to what Oliver wants to achieve. I suspect that he indeed
>> wants to delete obsolete files, but preserve .svn.
>
> Yep. (Although I'm not quite sure what --keep exactly does here.)

Does not add --delete flag to rsync.

Aditya

From taco at elvenkind.com  Wed May 27 15:26:50 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 27 May 2009 15:26:50 +0200
Subject: [dev-context] MetaPost 1.201 announcement
Message-ID: <4A1D3F9A.9050706@elvenkind.com>


The MetaPost team is happy to announce a new release of MetaPost:

----------------------------------------------------------------------
MetaPost 1.201
----------------------------------------------------------------------

The standalone distribution package and a win32 binary can be downloaded
immediately from

  http://foundry.supelec.fr/gf/project/metapost/

This release will also be available from CTAN soon, and it will be
included in the next TeXLive. The source package should compile normally
on all systems that are capable of compiling a modern web2c-based TeX
distribution.

The win32 binary is intended for texlive or a similar web2c-based
installation, this executable will *not* work for miktex.

Of course, we welcome any comments (either good or bad) that you may
have. Simply replying to this message is fine, but see the bottom of
the message for a more formal way to report bugs and feature requests.

----------------------------------------------------------------------
What is new in MetaPost version 1.201:
----------------------------------------------------------------------

Bug fixes:

* There was a bug where sometimes the outer contour of a glyph that was
  asked for via 'glyph X of' was missing from te output, depending on
  the path drawing order inside the Type1 font.

* Handling of MPTEXPRE label prefix files was broken.

* Font subsetting for 8-bit characters in Type1 fonts was broken.

* The use of "%{outputtemplate}" inside "outputtemplate" now generates
  an error.

* The first letter of the input file name was swallowed in the log file.

* There is some rudimentary support for infinite recursion trapping now,
  to help prevent segfaults&crashes due to C call stack exhaustion.

* An unlucky change in glibc made compilation fail on new GNU/Linux
  systems due to multiple incompatible definitions of 'getline()'.

* There was a bug in the handling of quoted external commands for
  MPXCOMMAND | MPXMAINCMD | TEX.

* The main input file's opening brace and filename were not shown in
  the log file output.

* Non-colored picture objects (clipping and setbounds paths) are now
  ignored when the color part is asked from within "within", for
  backward compatibility reasons.

* The trip and trap files are now part of the distribution and the
  mptrap files have been updated.

* The standard web2c argv[0] mem file mimicri was broken: 1.200 was
  always looking for "mpost.mem" even when called under another name.

* The manual pages for "mpost" and "dvitomp" have been updated, and the
  old "mp" manual page has been removed.

* The first letter of any missing input file name was not shown in the
  terminal error message.

* Output files are now once again written in the current directory even
  if an explicit source directory is given. This includes the creation
  of mpx files, but some trickery is used so that up-to-date existing
  mpx files from the source directory take precedence.


----------------------------------------------------------------------
Legal notice / license / bug reports
----------------------------------------------------------------------

MetaPost is a system for producing graphics developed by John Hobby
at AT&T, based on Donald Knuth's Metafont.  The MetaPost home page
is http://tug.org/metapost.

MetaPost is free software: you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

The MetaPost development project is currently hosted at Supelec,
http://foundry.supelec.fr/gf/project/metapost; please report bugs and
request enhancements through there if possible. Alternatively, you
can reach us through the <metapost at tug.org> mailing list as well.

Have fun!

Taco Hoekwater, for the MetaPost team, May 27, 2009.


From taco at elvenkind.com  Wed Jun  3 10:22:31 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 03 Jun 2009 10:22:31 +0200
Subject: [dev-context] MetaPost 1.202 announcement
Message-ID: <4A2632C7.8040502@elvenkind.com>


The MetaPost team is happy to announce a new release of MetaPost:

----------------------------------------------------------------------
MetaPost 1.202
----------------------------------------------------------------------

The standalone distribution package and a win32 binary can be downloaded
immediately from

  http://foundry.supelec.fr/gf/project/metapost/

This release will also be available from CTAN soon, and it will be
included in the next TeXLive. The source package should compile normally
on all systems that are capable of compiling a modern web2c-based TeX
distribution.

The win32 binary is intended for texlive or a similar web2c-based
installation, this executable will *not* work for miktex.

Of course, we welcome any comments (either good or bad) that you may
have. Simply replying to this message is fine, but see the bottom of
the message for a more formal way to report bugs and feature requests.

----------------------------------------------------------------------
What is new in MetaPost version 1.202:
----------------------------------------------------------------------

Bug fixes:

* Fix greypart <numeric> (always returned 0).

* Make 'withcolor true' explicitly reset the color model to
  uninitialized.

* Report which mem file can't be found, and use 'plain' instead of PLAIN
  in the mem search warning messages.

* Fix a crash on subsetting of some Type1 fonts because of a temporary
  buffer overrun.

* Correct a crash on SVG text output when the 8th bit is set.

* Fix the use (reference) of 8-bit glyphs in SVG mode when prologues:=3.

* Fix the output of text strings that reference the character at
  index 0.

* Use ".ps" as file extension for negative charcodes (for backward
  compatibility).

* Metapost sometimes printed "mp_vacuous" instead of "vacuous".

* Fix rounding of negative scaled and fraction values.

* Restore the error for 'arctime' out-of-bounds.

* Moved the "turningnumber algorithms do not agree" message out of reach
  (now only printed if tracingchoices>2 )

* Fix a problem with dash scaling during picture copying.

* TFM header bytes were written out with an offset of one.

* Updated the mptrap files.

----------------------------------------------------------------------
Legal notice / license / bug reports
----------------------------------------------------------------------

MetaPost is a system for producing graphics developed by John Hobby
at AT&T, based on Donald Knuth's Metafont.  The MetaPost home page
is http://tug.org/metapost.

MetaPost is free software: you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

The MetaPost development project is currently hosted at Supelec,
http://foundry.supelec.fr/gf/project/metapost; please report bugs and
request enhancements through there if possible. Alternatively, you
can reach us through the <metapost at tug.org> mailing list as well.

Have fun!

Taco Hoekwater, for the MetaPost team, June 3, 2009.


From taco at elvenkind.com  Wed Jun  3 15:42:13 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 03 Jun 2009 15:42:13 +0200
Subject: [dev-context] luatex beta 0.40.2
Message-ID: <4A267DB5.9090804@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.2 to the foundry server,
and have committed the source code to texlive.

What's new:

* Fix for a compilation warning under Cygwin.

* A complicated bugfix by Hartmut for a rounding problem in the
  VF loading that resulted in 'character width mismatch in font
  XY.vf ignored' messages at large load sizes

* The embedded MPlib is now 1.202.

* The post_page_number callback was accidentally run when
  shipping out xforms as well as during actual pages.

* When a math accent char doesn't have a bot_accent placer,
  luatex now uses the top_accent placer, if present.

* A crash caused by \Uroot .. {<list>}{...} is fixed

* A portability fix for solaris 8 sparc using sun studio
  compiler, and one for glibc > 2.9.90

* luatex -ini now sets the \catcode of the BOM character to
  ignore (9)

* Kpathsea is updated from TeXLive, giving four extra types of
  searchable files: 'font feature files','cid maps','mlbib',
  and 'mlbst'.

* libpng is now 1.2.36


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.40.2

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco





From sanjoy at MIT.EDU  Fri Jun  5 15:57:18 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Fri, 05 Jun 2009 09:57:18 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal vertical
	mode
Message-ID: <E1MCZv4-0006JO-8U@approx.mit.edu>

I've been running across the following error once a week or so:

  [MP to PDF] (./fig.320)
  floatblocks     : 16 placed
  ! You can't use `\vadjust' in internal vertical mode.
  <recently read> \vadjust 

  \sidefloatoutput ... \parskip \zeropoint \vadjust 
						    {\penalty \minusone }\iffl.
  <argument> ...\fi \else \the \defaultstreamoutput 
						    \fi 
  \firstoftwoarguments #1#2->#1

  \dodonormaloutput ...lty \the \OTRcommand \output 
						    \outputmessage -{normal}\o.

  \invokeoutputroutine ...enalty }\dodonormaloutput 
						    \outputmessage -{trying}\o.
  ...
  l.1316 

  ? 

  This is MetaPost, Version 0.993 (Web2C 7.5.6)
  (lumping-mpgraph.mp [1]
  metafun 2009-5-5 07:22
   )


It is very sensitive to the vertical spacing, and goes away when I
edit even slightly, but I've made the most minimal example that I can.
It is attached as a zip file whose contents are:

M Filemode      Length  Date         Time      File
- ----------  --------  -----------  --------  -----------
  -rw-r--r--       745   5-Jun-2009  09:09:20  fig.2
  -rw-r--r--      1162   5-Jun-2009  09:09:20  fig.202
  -rw-r--r--      3552   5-Jun-2009  09:09:20  fig.301
  -rw-r--r--      2807   5-Jun-2009  09:09:20  fig.302
  -rw-r--r--      3820   5-Jun-2009  09:09:20  fig.306
  -rw-r--r--      5748   5-Jun-2009  09:09:20  fig.307
  -rw-r--r--      2915   5-Jun-2009  09:09:20  fig.308
  -rw-r--r--     48157   5-Jun-2009  09:09:20  fig.310
  -rw-r--r--      8219   5-Jun-2009  09:09:20  fig.311
  -rw-r--r--      2683   5-Jun-2009  09:09:20  fig.320
  -rw-r--r--      3827   5-Jun-2009  09:09:20  fig.350
  -rw-r--r--      3291   5-Jun-2009  09:09:20  fig.351
  -rw-r--r--      1853   5-Jun-2009  09:09:20  fig.618
  -rw-r--r--      2054   5-Jun-2009  09:09:20  fig.619
  -rw-r--r--      2076   5-Jun-2009  09:09:20  fig.621
  -rw-r--r--      1720   5-Jun-2009  09:09:20  fig.623
  -rw-r--r--     42313   5-Jun-2009  09:44:10  lumping.tex
- ----------  --------  -----------  --------  -----------
                136942                         17 files

Run 'texexec lumping.tex' to see the problem.

I'm using context 2009.5.5 from the Debian unstable package.

I tried running lumping.tex on the live context, but could not reproduce
the problem.  I think that is because the figure files are not included
in the live run, and their absence changes the vertical spacing enough
to hide the problem.

I also tried downloading and running it through the latest minimals, but
the minimals failed trying to load the palatino fonts, and I haven't yet
figured out if that problem is with my setup or with the minimals.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/zip
Size: 58567 bytes
Desc: vadjust.zip
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090605/fe711f12/attachment-0001.zip>

From taco at elvenkind.com  Fri Jun  5 16:11:20 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 05 Jun 2009 16:11:20 +0200
Subject: [dev-context] error: You can't use `\vadjust' in internal
 vertical mode
In-Reply-To: <E1MCZv4-0006JO-8U@approx.mit.edu>
References: <E1MCZv4-0006JO-8U@approx.mit.edu>
Message-ID: <4A292788.2000408@elvenkind.com>



Sanjoy Mahajan wrote:
> 
> 
> It is very sensitive to the vertical spacing, and goes away when I
> edit even slightly, 

Either the bug is fixed or there is a subtle difference between
our installations, but I do not get an error. Versions:


  This is pdfTeX, Version 3.1415926-1.50.0-alpha-20080414
  ConTeXt  ver: 2009.06.03 11:48 MKII
  This is MetaPost, version 1.202

Best wishes,
Taco

From sanjoy at MIT.EDU  Fri Jun  5 20:49:23 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Fri, 05 Jun 2009 14:49:23 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: Your message of "Fri, 05 Jun 2009 16:11:20 +0200."
	<4A292788.2000408@elvenkind.com>
Message-ID: <E1MCeTj-0000zk-Dd@approx.mit.edu>

Okay, thanks for testing it.  To see what change fixed the problem (or
maybe hid it), I'll first update to the the latest ConTeXt, then try
updating pdftex (I'm using 1.40.3), and then try updating metapost (I'm
using 0.993).

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From sanjoy at MIT.EDU  Fri Jun  5 21:53:17 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Fri, 05 Jun 2009 15:53:17 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: Your message of "Fri, 05 Jun 2009 16:11:20 +0200."
	<4A292788.2000408@elvenkind.com>
Message-ID: <E1MCfTZ-0002Ah-Nt@approx.mit.edu>

As part of the plan of debugging by trying one infrastructure at a time,
I just updated to Context 2009.06.04.  I downloaded and unzipped
cont-tmf.zip (from pragma), putting everything into ~/texmf/, then ran
"texexec --make --all" to remake the formats.  (Everything else
tex-related is from the Debian 'unstable' texlive 2007 packages.)

texexec fails on this test file:

  \usetypescript[palatino][\defaultencoding]
  \setupbodyfont[palatino,11pt]
  \starttext
  \input tufte
  \stoptext

with the following error:

  kpathsea: Running mktextfm ec-qplr
  /usr/share/texmf/web2c/mktexnam: Could not map typeface abbreviation c- for ec-qplr.
  /usr/share/texmf/web2c/mktexnam: Need to update /usr/share/texmf-texlive/fonts/map/fontname/special.map?
  mktextfm: Running mf-nowin -progname=mf \mode:=ljfour; mag:=1; nonstopmode; input ec-qplr
  This is METAFONT, Version 2.71828 (Web2C 7.5.6)

  kpathsea: Running mktexmf ec-qplr
  ! I can't find file `ec-qplr'.
  <*> ...=ljfour; mag:=1; nonstopmode; input ec-qplr


It may be a Debian-specific problem (CC'ing Norbert for that reason), or
maybe something strange on my laptop, but I've stayed as close to the
vanilla Debian setup as possible.  I thought I might need to update the
latin modern fonts, but the Debian package is already v1.106, which
looks like the latest version on the LM site.

Does this latest context requires texlive 2008 (for newer map files or a
newer pdftex)?

-Sanjoy

From sanjoy at MIT.EDU  Sat Jun  6 05:25:06 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Fri, 05 Jun 2009 23:25:06 -0400
Subject: [dev-context] use of \phantombox doesn't match its definition
Message-ID: <E1MCmWo-0005Nq-I5@approx.mit.edu>

In trying to install the latest context on my system, I installed
texlive 2008, then the 2009.06.04 context, and rebuilt the formats.

Using texlive 2008 solved my problems with the Palatino fonts not being
found (compared to when I was using the latest context with texlive
2007).  However, the following file fails on my laptop, and on the live
Context (also 2009.06.04, texlive 2008):

\newbox\phantombox
\def\lowest#1{\setbox\phantombox=\vbox{\vphantom{$\displaystyle{#1}$}}}
\def\support{\copy\phantombox}

\starttext

\startformula
\lowest{Q}
\underbrace{\support Q}_{dx}
\stopformula 

\stoptext

The error is:

! Use of \phantombox doesn't match its definition.
\lowest #1->\setbox \phantombox =
                                 \vbox {\vphantom {$\displaystyle {#1}$}}
l.8 \lowest{Q}

Changing all uses of \phantombox to \phantomboxff fixes the problem, so
maybe there's a name clash, but I couldn't find it in the context source
code.

-Sanjoy

From taco at elvenkind.com  Sat Jun  6 09:30:35 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 06 Jun 2009 09:30:35 +0200
Subject: [dev-context] use of \phantombox doesn't match its definition
In-Reply-To: <E1MCmWo-0005Nq-I5@approx.mit.edu>
References: <E1MCmWo-0005Nq-I5@approx.mit.edu>
Message-ID: <4A2A1B1B.9020209@elvenkind.com>

Sanjoy Mahajan wrote:
> 
> Changing all uses of \phantombox to \phantomboxff fixes the problem, so
> maybe there's a name clash, but I couldn't find it in the context source
> code.

pack-box.mki[iv]:

   \def\phantombox[#1]%


Best wishes,
Taco

From sanjoy at MIT.EDU  Sat Jun  6 13:30:13 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Sat, 06 Jun 2009 07:30:13 -0400
Subject: [dev-context] use of \phantombox doesn't match its definition
In-Reply-To: Your message of "Sat, 06 Jun 2009 09:30:35 +0200."
	<4A2A1B1B.9020209@elvenkind.com>
Message-ID: <E1MCu6H-000684-5G@approx.mit.edu>

Thanks!  I need to update my grep-the-context-source script to search
.mki[iv] files, not only .tex files.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From mojca.miklavec.lists at gmail.com  Sun Jun  7 23:17:58 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sun, 7 Jun 2009 23:17:58 +0200
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: <E1MCfTZ-0002Ah-Nt@approx.mit.edu>
References: <4A292788.2000408@elvenkind.com> <E1MCfTZ-0002Ah-Nt@approx.mit.edu>
Message-ID: <6faad9f00906071417g5d0ea85bu5e1f3ab56f9424a9@mail.gmail.com>

On Fri, Jun 5, 2009 at 21:53, Sanjoy Mahajan wrote:
>
> Does this latest context requires texlive 2008 (for newer map files or a
> newer pdftex)?

You need to fetch recent TeX Gyre at least.

(You may ask Norbert, but one could keep patching TeX packages in 2007
to infinity.)

Mojca

From taco at elvenkind.com  Mon Jun  8 10:58:13 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 08 Jun 2009 10:58:13 +0200
Subject: [dev-context] luatex beta 0.40.3
Message-ID: <4A2CD2A5.8030005@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.3 to the foundry server,
and have committed the source code to texlive.

What's new:

* A set of portability fixes for the AIX compiler from Vladimir
  Volovich.

* A set of fixes to the synctex support.

* A patch to the build script to prevent installed X11 headers
  from being required.

* Some weave (web syntax) fixes from Manuel P?gouri?-Gonnard.

* A simplification in luatex.ch (it is now less verbose
  about the web2c-specific extensions) from Karl Berry.

* A fix in the handling of UTF-8 (input) file names.

* Hyphenation exceptions were case sensitive in 0.40.2.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.40.3

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco





From mojca.miklavec.lists at gmail.com  Mon Jun  8 13:28:01 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 8 Jun 2009 13:28:01 +0200
Subject: [dev-context] removing .pgf file with --purgeall
Message-ID: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>

Hello Hans,

may I request removing \jobname.pgf when doing context/ctxtools
--purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
default (similar to \jobname-mpgraph*, only serving a different
purpose) and is only needed when a document is compiled on computer
without tikz installed.

(Low priority request.)

Mojca

From khaledhosny at eglug.org  Mon Jun  8 13:39:38 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 8 Jun 2009 14:39:38 +0300
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
Message-ID: <20090608113938.GA15074@khaled-laptop>

On Mon, Jun 08, 2009 at 01:28:01PM +0200, Mojca Miklavec wrote:
> Hello Hans,
> 
> may I request removing \jobname.pgf when doing context/ctxtools
> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
> default (similar to \jobname-mpgraph*, only serving a different
> purpose) and is only needed when a document is compiled on computer
> without tikz installed.
> 
> (Low priority request.)

While on it, may I request removing .synctex.gz generated when SyncTeX
is enabled (I know it is needed for previewers, but I assume --purgeall
to remove every generated file except the output document).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090608/5ba94248/attachment.bin>

From schuster.wolfgang at googlemail.com  Tue Jun  9 09:13:46 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Tue, 9 Jun 2009 09:13:46 +0200
Subject: [dev-context] setupbodyfont
Message-ID: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>

Hi Hans,

I run with my simplefonts module in two problems when I try to set the  
bodyfont,
the regard math and fallback fonts and I was only to solve them by  
redefining
of a few values.


1. I have to set the bodyfont at the same time when I set a individual  
font for
    serif, sans or mono. This works fine for the the three text style  
but not when
    I try to switch to a different math font, which is frozen with the  
first
    \setupbodyfont command and can only be changed when I the main  
fontclass
    (created with \registerfontclass in \definetypeface) and the style  
value
    for rm (I need the 'rm' style to allow e.g. ss as document style).

    Here is a example to illustrate the problem:

\definetypeface[mainface][rm][serif][times][default]

\setupbodyfont[mainface,ss,12pt]

\definetypeface[mainface][ss][sans][helvetica][default]
\definetypeface[mainface][tt][mono][courier][default]

\definetypeface[mainface][mm][math][palatino][default]

% comment/uncomment the following two lines to see how
% the math font changes with/without these redefinitions

\letvalueempty{@@tfmainfacedefault}%
\undefinevalue{@f at st@rm}%
\setupbodyfont[mainface,ss,12pt]

%\definetypeface[mainface][mm][math][cambria][default]

%\letvalueempty{@@tfmainfacedefault}%
%\undefinevalue{@f at st@rm}%
%\setupbodyfont[mainface,ss,12pt]

\starttext

text

\rmtf regular \it italic \bf bold \bi bolditalic

\sstf regular \it italic \bf bold \bi bolditalic

\tttf regular \it italic \bf bold \bi bolditalic

$$ c^2 = a^2 + b^2 $$

\stoptext


2. The fallback for the main style (i.e. \rmtf) is frozen too with
    the first \setupbodyfont line in the document with can be only reset
    when I undefine \newfontidentifier, a example for this is:

\starttypescript [serif] [mainfont]
     \setups[font:fallback:serif]
     \definefontsynonym [Serif] [name:texgyrepagellaregular]  
[fallbacks=mainfont,features=default]
\stoptypescript

\definetypeface [mainfont] [rm] [serif] [mainfont] [default]

\setupbodyfont[mainfont,rm]

\definefontfallback [mainfont] [name:texgyretermesregular]  
[0x0065-0x0070] [force=yes]

% The following line is necessary to enable the fallback font for the  
main
% style after the bodyfont is set, if this isn't done the complete text
% below is typeset in Pagella whereas e-p should be in Times

\undefinevalue\newfontidentifier
\setupbodyfont[mainfont,rm]

\starttext

abcdefghijkmnopqrstuvwxyz

\stoptext


I would prefer something documented (e.g. \setupbodyfont[reload,...])  
which can
be used to get the same effect as I did with my hacks because I like  
now my new
font module, it's lot easier than direct method to set fallback fonts.

TIA
Wolfgang


From schuster.wolfgang at googlemail.com  Tue Jun  9 10:50:20 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Tue, 9 Jun 2009 10:50:20 +0200
Subject: [dev-context] setupbodyfont
In-Reply-To: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
References: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
Message-ID: <BB7CDD01-BC9B-49FA-A68D-F5AA9E455255@gmail.com>


Am 09.06.2009 um 09:13 schrieb Wolfgang Schuster:

> Hi Hans,
>
> I run with my simplefonts module in two problems when I try to set  
> the bodyfont,
> the regard math and fallback fonts and I was only to solve them by  
> redefining
> of a few values.
>
>
> 1. I have to set the bodyfont at the same time when I set a  
> individual font for
>  serif, sans or mono. This works fine for the the three text style  
> but not when
>  I try to switch to a different math font, which is frozen with the  
> first
>  \setupbodyfont command and can only be changed when I the main  
> fontclass
>  (created with \registerfontclass in \definetypeface) and the style  
> value
>  for rm (I need the 'rm' style to allow e.g. ss as document style).

Small correction, I have to undefine the currently used style, i.e. in  
my
example below I have to reset the sans serif style, not the serif one.

>  Here is a example to illustrate the problem:
>
> \definetypeface[mainface][rm][serif][times][default]
>
> \setupbodyfont[mainface,ss,12pt]
>
> \definetypeface[mainface][ss][sans][helvetica][default]
> \definetypeface[mainface][tt][mono][courier][default]
>
> \definetypeface[mainface][mm][math][palatino][default]
>
> % comment/uncomment the following two lines to see how
> % the math font changes with/without these redefinitions
>
> \letvalueempty{@@tfmainfacedefault}%
> \undefinevalue{@f at st@rm}%

\undefinevalue{@f at st@ss}%

> \setupbodyfont[mainface,ss,12pt]
>
> %\definetypeface[mainface][mm][math][cambria][default]
>
> %\letvalueempty{@@tfmainfacedefault}%
> %\undefinevalue{@f at st@rm}%
> %\setupbodyfont[mainface,ss,12pt]
>
> \starttext
>
> text
>
> \rmtf regular \it italic \bf bold \bi bolditalic
>
> \sstf regular \it italic \bf bold \bi bolditalic
>
> \tttf regular \it italic \bf bold \bi bolditalic
>
> $$ c^2 = a^2 + b^2 $$
>
> \stoptext
>
>
> 2. The fallback for the main style (i.e. \rmtf) is frozen too with
>  the first \setupbodyfont line in the document with can be only reset
>  when I undefine \newfontidentifier, a example for this is:
>
> \starttypescript [serif] [mainfont]
>   \setups[font:fallback:serif]
>   \definefontsynonym [Serif] [name:texgyrepagellaregular]  
> [fallbacks=mainfont,features=default]
> \stoptypescript
>
> \definetypeface [mainfont] [rm] [serif] [mainfont] [default]
>
> \setupbodyfont[mainfont,rm]
>
> \definefontfallback [mainfont] [name:texgyretermesregular]  
> [0x0065-0x0070] [force=yes]
>
> % The following line is necessary to enable the fallback font for  
> the main
> % style after the bodyfont is set, if this isn't done the complete  
> text
> % below is typeset in Pagella whereas e-p should be in Times
>
> \undefinevalue\newfontidentifier
> \setupbodyfont[mainfont,rm]
>
> \starttext
>
> abcdefghijkmnopqrstuvwxyz
>
> \stoptext
>
>
> I would prefer something documented (e.g.  
> \setupbodyfont[reload,...]) which can
> be used to get the same effect as I did with my hacks because I like  
> now my new
> font module, it's lot easier than direct method to set fallback fonts.
>
> TIA
> Wolfgang

From schuster.wolfgang at googlemail.com  Tue Jun  9 11:07:01 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Tue, 9 Jun 2009 11:07:01 +0200
Subject: [dev-context] setupbodyfont
In-Reply-To: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
References: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
Message-ID: <E7CE98B7-711D-44A5-A764-D3CD8BB0FD28@gmail.com>


Am 09.06.2009 um 09:13 schrieb Wolfgang Schuster:

> 1. I have to set the bodyfont at the same time when I set a  
> individual font for
>   serif, sans or mono. This works fine for the the three text style  
> but not when
>   I try to switch to a different math font, which is frozen with the  
> first
>   \setupbodyfont command and can only be changed when I the main  
> fontclass
>   (created with \registerfontclass in \definetypeface) and the style  
> value
>   for rm (I need the 'rm' style to allow e.g. ss as document style).


This point is trickier than I thought, my two hacks work only when
I use 'rm' for the main bodyfont style but it do no longer work when
I try to set 'ss' as main style because with

   \undefinevalue{@f at st@rm}%

I'm able to use the sans style as main font but the math setting is
now ignored and with

   \undefinevalue{@f at st@ss}%

I get the right math font and it's no longer possible to use a different
style for the main font.

Wolfgang


From pragma at wxs.nl  Tue Jun  9 11:33:45 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 09 Jun 2009 11:33:45 +0200
Subject: [dev-context] setupbodyfont
In-Reply-To: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
References: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
Message-ID: <4A2E2C79.9010102@wxs.nl>

Wolfgang Schuster wrote:
> Hi Hans,
> 
> I run with my simplefonts module in two problems when I try to set the 
> bodyfont,
> the regard math and fallback fonts and I was only to solve them by 
> redefining
> of a few values.
> 
> 
> 1. I have to set the bodyfont at the same time when I set a individual 
> font for
>    serif, sans or mono. This works fine for the the three text style but 
> not when
>    I try to switch to a different math font, which is frozen with the first
>    \setupbodyfont command and can only be changed when I the main fontclass
>    (created with \registerfontclass in \definetypeface) and the style value
>    for rm (I need the 'rm' style to allow e.g. ss as document style).

typefaces are global in order to make them fast; so, multiple typefaces 
should have a different namespace ; once the bodyfont is chosen, font 
definitions take place and are remembered (per class); there is no way 
to reset them unless we store the definitions (which slows down font 
handling)

the fact that you can do it with math is actually a bug (i fixed that) 
because there the mathsize (extra property) was not part of the check of 
already being defined

> 2. The fallback for the main style (i.e. \rmtf) is frozen too with
>    the first \setupbodyfont line in the document with can be only reset
>    when I undefine \newfontidentifier, a example for this is:

the same

> I would prefer something documented (e.g. \setupbodyfont[reload,...]) 
> which can
> be used to get the same effect as I did with my hacks because I like now 
> my new
> font module, it's lot easier than direct method to set fallback fonts.

well, docu is easy:

\setupbodyfont[someclass]

starts freezing the (font file related) definitions related to someclass 
and there is currently no way to reset that

normally a style will define several classes then and switching between 
them is quite fast as only the namespace changes

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Tue Jun  9 14:50:53 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 09 Jun 2009 14:50:53 +0200
Subject: [dev-context] MetaPost 1.203 announcement
Message-ID: <4A2E5AAD.8080900@elvenkind.com>


The MetaPost team is happy to announce a new release of MetaPost:

----------------------------------------------------------------------
MetaPost 1.203
----------------------------------------------------------------------

The standalone distribution package and a win32 binary can be downloaded
immediately from

  http://foundry.supelec.fr/gf/project/metapost/

This release will also be available from CTAN soon, and it will be
included in the next TeXLive. The source package should compile normally
on all systems that are capable of compiling a modern web2c-based TeX
distribution.

The win32 binary is intended for texlive or a similar web2c-based
installation, this executable will *not* work for miktex.

Of course, we welcome any comments (either good or bad) that you may
have. Simply replying to this message is fine, but see the bottom of
the message for a more formal way to report bugs and feature requests.

----------------------------------------------------------------------
What is new in MetaPost version 1.203:
----------------------------------------------------------------------

* Building version 1.202 for source required X11 headers to be
  installed.

* Another infinite recursion trap added, now for erroneous vardefs
  with suffixes (reported by Nicola Vitacolonna).

* Fix infinite loop recursion on integer overflow (reported by Nicola
  Vitacolonna, fix based on a hint from Dan Luecking).

* In version 1.202, setting "job_name" from lua code caused a crash.

* The "filename" field on the lua figure object in 1.202 was just the
  extension, instead of the whole file name.

----------------------------------------------------------------------
Legal notice / license / bug reports
----------------------------------------------------------------------

MetaPost is a system for producing graphics developed by John Hobby
at AT&T, based on Donald Knuth's Metafont.  The MetaPost home page
is http://tug.org/metapost.

MetaPost is free software: you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

The MetaPost development project is currently hosted at Supelec,
http://foundry.supelec.fr/gf/project/metapost; please report bugs and
request enhancements through there if possible. Alternatively, you
can reach us through the <metapost at tug.org> mailing list as well.

Have fun!

Taco Hoekwater, for the MetaPost team, June 9, 2009.



From taco at elvenkind.com  Tue Jun  9 15:58:02 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 09 Jun 2009 15:58:02 +0200
Subject: [dev-context] luatex beta 0.40.4
Message-ID: <4A2E6A6A.2010304@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.4 to the foundry server,
and have committed the source code to texlive.

What's new:

* \the\textfont0 returned a number instead of doing a font switch.

* The embedded MPlib is now 1.203.

The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.40.4

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco





From preining at logic.at  Tue Jun  9 16:26:57 2009
From: preining at logic.at (Norbert Preining)
Date: Tue, 9 Jun 2009 16:26:57 +0200
Subject: [dev-context] [Dev-luatex] luatex beta 0.40.4
In-Reply-To: <4A2E6A6A.2010304@elvenkind.com>
References: <4A2E6A6A.2010304@elvenkind.com>
Message-ID: <20090609142657.GE31330@gamma.logic.tuwien.ac.at>

On Di, 09 Jun 2009, Taco Hoekwater wrote:
> I have just uploaded luatex 0.40.4 to the foundry server,
> and have committed the source code to texlive.

Debian packages uploaded to unstable, new binaries for all possible
archs will be available in a few days.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
GODALMING (n.)
Wonderful rush of relief on discovering that the ely (q.v.) and the
wembley (q.v.) were in fact false alarms.
			--- Douglas Adams, The Meaning of Liff

From pragma at wxs.nl  Tue Jun  9 17:48:34 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 09 Jun 2009 17:48:34 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
Message-ID: <4A2E8452.3040905@wxs.nl>

Mojca Miklavec wrote:
> Hello Hans,
> 
> may I request removing \jobname.pgf when doing context/ctxtools
> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
> default (similar to \jobname-mpgraph*, only serving a different
> purpose) and is only needed when a document is compiled on computer
> without tikz installed.

is this name configureable? can we turn it into something 
\jobname-temp.pgf or so? (as we do with the mp temp files)
or maybe \jobname-pgfgraphic.pgf or so


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Jun  9 17:50:39 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 09 Jun 2009 17:50:39 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <20090608113938.GA15074@khaled-laptop>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
	<20090608113938.GA15074@khaled-laptop>
Message-ID: <4A2E84CF.5070703@wxs.nl>

Khaled Hosny wrote:
> On Mon, Jun 08, 2009 at 01:28:01PM +0200, Mojca Miklavec wrote:
>> Hello Hans,
>>
>> may I request removing \jobname.pgf when doing context/ctxtools
>> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
>> default (similar to \jobname-mpgraph*, only serving a different
>> purpose) and is only needed when a document is compiled on computer
>> without tikz installed.
>>
>> (Low priority request.)
> 
> While on it, may I request removing .synctex.gz generated when SyncTeX
> is enabled (I know it is needed for previewers, but I assume --purgeall
> to remove every generated file except the output document).

local temporary_runfiles = {
     "tui", "tua", "tup", "ted", "tes", "top",
     "log", "tmp", "run", "bck", "rlg",
     "mpt", "mpx", "mpd", "mpo", "mpb",
     "ctl", "synctex.gz",
}

can you test it?




-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Tue Jun  9 18:48:13 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 9 Jun 2009 18:48:13 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <4A2E8452.3040905@wxs.nl>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
	<4A2E8452.3040905@wxs.nl>
Message-ID: <6faad9f00906090948l51ce4784j13af1360f36a74c3@mail.gmail.com>

On Tue, Jun 9, 2009 at 17:48, Hans Hagen wrote:
> Mojca Miklavec wrote:
>>
>> Hello Hans,
>>
>> may I request removing \jobname.pgf when doing context/ctxtools
>> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
>> default (similar to \jobname-mpgraph*, only serving a different
>> purpose) and is only needed when a document is compiled on computer
>> without tikz installed.
>
> is this name configureable? can we turn it into something \jobname-temp.pgf
> or so? (as we do with the mp temp files)
> or maybe \jobname-pgfgraphic.pgf or so.

I don't believe that it's configurable (though it could be possible to
send a request to Till Tantau). The code is just:

\def\pgfutil at aux@read at hook{
  \pgfutil at IfFileExists{\jobname.pgf}{\input \jobname.pgf\relax}{}
  \csname newwrite\endcsname\pgfutil at auxout
  \csname openout\endcsname\pgfutil at auxout\jobname.pgf
}

Is the main concern being afraid of removing some file with the same ending?

Mojca

From khaledhosny at eglug.org  Tue Jun  9 19:01:30 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Tue, 9 Jun 2009 20:01:30 +0300
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <4A2E84CF.5070703@wxs.nl>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
	<20090608113938.GA15074@khaled-laptop> <4A2E84CF.5070703@wxs.nl>
Message-ID: <20090609170130.GA23428@khaled-laptop>

On Tue, Jun 09, 2009 at 05:50:39PM +0200, Hans Hagen wrote:
> Khaled Hosny wrote:
>> On Mon, Jun 08, 2009 at 01:28:01PM +0200, Mojca Miklavec wrote:
>>> Hello Hans,
>>>
>>> may I request removing \jobname.pgf when doing context/ctxtools
>>> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
>>> default (similar to \jobname-mpgraph*, only serving a different
>>> purpose) and is only needed when a document is compiled on computer
>>> without tikz installed.
>>>
>>> (Low priority request.)
>>
>> While on it, may I request removing .synctex.gz generated when SyncTeX
>> is enabled (I know it is needed for previewers, but I assume --purgeall
>> to remove every generated file except the output document).
>
> local temporary_runfiles = {
>     "tui", "tua", "tup", "ted", "tes", "top",
>     "log", "tmp", "run", "bck", "rlg",
>     "mpt", "mpx", "mpd", "mpo", "mpb",
>     "ctl", "synctex.gz",
> }
>
> can you test it?
This works for me, but I think we need to added it to ctxtools.rb for
'ctxtools --purgefiles --all' too?

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090609/f8bdb4a0/attachment.bin>

From pragma at wxs.nl  Wed Jun 10 11:27:52 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 10 Jun 2009 11:27:52 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <6faad9f00906090948l51ce4784j13af1360f36a74c3@mail.gmail.com>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>	
	<4A2E8452.3040905@wxs.nl>
	<6faad9f00906090948l51ce4784j13af1360f36a74c3@mail.gmail.com>
Message-ID: <4A2F7C98.3050807@wxs.nl>

Mojca Miklavec wrote:
> On Tue, Jun 9, 2009 at 17:48, Hans Hagen wrote:
>> Mojca Miklavec wrote:
>>> Hello Hans,
>>>
>>> may I request removing \jobname.pgf when doing context/ctxtools
>>> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
>>> default (similar to \jobname-mpgraph*, only serving a different
>>> purpose) and is only needed when a document is compiled on computer
>>> without tikz installed.
>> is this name configureable? can we turn it into something \jobname-temp.pgf
>> or so? (as we do with the mp temp files)
>> or maybe \jobname-pgfgraphic.pgf or so.
> 
> I don't believe that it's configurable (though it could be possible to
> send a request to Till Tantau). The code is just:
> 
> \def\pgfutil at aux@read at hook{
>   \pgfutil at IfFileExists{\jobname.pgf}{\input \jobname.pgf\relax}{}
>   \csname newwrite\endcsname\pgfutil at auxout
>   \csname openout\endcsname\pgfutil at auxout\jobname.pgf
> }
> 
> Is the main concern being afraid of removing some file with the same ending?

indeed; it's why i have the -mpgraph

it would be handy if there was

\def\pfgfilename{\jobname.pgf}

or so, but for the moment i've just added the suffix to the remove list 
and we leave it to the user not to use the pgf suffix otherwise

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Wed Jun 10 11:28:18 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 10 Jun 2009 11:28:18 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <20090609170130.GA23428@khaled-laptop>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
	<20090608113938.GA15074@khaled-laptop> <4A2E84CF.5070703@wxs.nl>
	<20090609170130.GA23428@khaled-laptop>
Message-ID: <4A2F7CB2.6060000@wxs.nl>

Khaled Hosny wrote:
> On Tue, Jun 09, 2009 at 05:50:39PM +0200, Hans Hagen wrote:
>> Khaled Hosny wrote:
>>> On Mon, Jun 08, 2009 at 01:28:01PM +0200, Mojca Miklavec wrote:
>>>> Hello Hans,
>>>>
>>>> may I request removing \jobname.pgf when doing context/ctxtools
>>>> --purgeall (in both mkii/mkiv)? That's a file that TikZ creates by
>>>> default (similar to \jobname-mpgraph*, only serving a different
>>>> purpose) and is only needed when a document is compiled on computer
>>>> without tikz installed.
>>>>
>>>> (Low priority request.)
>>> While on it, may I request removing .synctex.gz generated when SyncTeX
>>> is enabled (I know it is needed for previewers, but I assume --purgeall
>>> to remove every generated file except the output document).
>> local temporary_runfiles = {
>>     "tui", "tua", "tup", "ted", "tes", "top",
>>     "log", "tmp", "run", "bck", "rlg",
>>     "mpt", "mpx", "mpd", "mpo", "mpb",
>>     "ctl", "synctex.gz",
>> }
>>
>> can you test it?
> This works for me, but I think we need to added it to ctxtools.rb for
> 'ctxtools --purgefiles --all' too?

ctxtools becomes obsolete


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oliver.buerschaper at mpq.mpg.de  Wed Jun 10 12:42:21 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Wed, 10 Jun 2009 20:42:21 +1000
Subject: [dev-context] removing BibTeX auxiliary files with --purgeall
Message-ID: <C12E67F1-1F8E-499E-BF0A-E079EF4C350F@mpq.mpg.de>

Hello Hans and Taco,

may I also add the request that temporary files created by BibTeX are  
deleted automatically by --purgeall? That is,

*.blg
*.aux

It'll probably be wise to keep the *.bbl file :-) Although it is  
created automatically by the BibTeX run I need to tweak it manually at  
times ...

Best wishes,
Oliver


P.S. I cannot test this with MkIV at the moment but MkII doesn't  
delete those files for sure ...

From khaledhosny at eglug.org  Wed Jun 10 13:49:46 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 10 Jun 2009 14:49:46 +0300
Subject: [dev-context] Crash with luatex-fonts
Message-ID: <20090610114946.GA17150@khaled-laptop>

The following sample would crash luatex using context distriputed
luatex-plain format:
%%%
\font\arab="SimpleNaskhi.ttf:script=arab;language=dflt;mode=node;+init;+medi;+fina;+rlig;+liga;+mark"\arab
\textdir TRT
????? 
\bye
%%%

(the font used
http://code.google.com/p/raqm/source/browse/trunk/fonts/simplenaskhi/SimpleNaskhi.ttf)

With the message:
%%%
error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
attempt to call field 'register_message' (a nil value)
%%%

It seems that fonts.register_message is not defined. 
Pressing enter after that will crash luatex:

%%%
luatex: ../../../source/texk/web2c/luatexdir/tex/linebreak.c:1660:
ext_do_line_break: Assertion `varmem[((cur_p)+1)].hh.v.RH ==
0+4+4+4+4+4+4+2+2+2' failed.
Aborted
%%%

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090610/6e18f1e8/attachment.bin>

From khaledhosny at eglug.org  Wed Jun 10 13:51:57 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 10 Jun 2009 14:51:57 +0300
Subject: [dev-context] Crash with luatex-fonts
In-Reply-To: <20090610114946.GA17150@khaled-laptop>
References: <20090610114946.GA17150@khaled-laptop>
Message-ID: <20090610115157.GB17150@khaled-laptop>

It works fine with context, BTW.

On Wed, Jun 10, 2009 at 02:49:46PM +0300, Khaled Hosny wrote:
> The following sample would crash luatex using context distriputed
> luatex-plain format:
> %%%
> \font\arab="SimpleNaskhi.ttf:script=arab;language=dflt;mode=node;+init;+medi;+fina;+rlig;+liga;+mark"\arab
> \textdir TRT
> ????? 
> \bye
> %%%
> 
> (the font used
> http://code.google.com/p/raqm/source/browse/trunk/fonts/simplenaskhi/SimpleNaskhi.ttf)
> 
> With the message:
> %%%
> error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
> attempt to call field 'register_message' (a nil value)
> %%%
> 
> It seems that fonts.register_message is not defined. 
> Pressing enter after that will crash luatex:
> 
> %%%
> luatex: ../../../source/texk/web2c/luatexdir/tex/linebreak.c:1660:
> ext_do_line_break: Assertion `varmem[((cur_p)+1)].hh.v.RH ==
> 0+4+4+4+4+4+4+2+2+2' failed.
> Aborted
> %%%
> 
> Regards,
>  Khaled
> 
> 
> -- 
>  Khaled Hosny
>  Arabic localiser and member of Arabeyes.org team
>  Free font developer

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090610/feb644d5/attachment.bin>

From taco at elvenkind.com  Wed Jun 10 13:52:28 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 10 Jun 2009 13:52:28 +0200
Subject: [dev-context] Crash with luatex-fonts
In-Reply-To: <20090610114946.GA17150@khaled-laptop>
References: <20090610114946.GA17150@khaled-laptop>
Message-ID: <4A2F9E7C.9000603@elvenkind.com>



Khaled Hosny wrote:
> %%%
> error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
> attempt to call field 'register_message' (a nil value)
> %%%

This is the bug (a lua or font problem).

> %%%
> luatex: ../../../source/texk/web2c/luatexdir/tex/linebreak.c:1660:
> ext_do_line_break: Assertion `varmem[((cur_p)+1)].hh.v.RH ==
> 0+4+4+4+4+4+4+2+2+2' failed.
> Aborted
> %%%

This is just a result of the earlier bug.

Best wishes,
Taco

From khaledhosny at eglug.org  Wed Jun 10 13:59:16 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 10 Jun 2009 14:59:16 +0300
Subject: [dev-context] Crash with luatex-fonts
In-Reply-To: <4A2F9E7C.9000603@elvenkind.com>
References: <20090610114946.GA17150@khaled-laptop>
	<4A2F9E7C.9000603@elvenkind.com>
Message-ID: <20090610115916.GA18402@khaled-laptop>

On Wed, Jun 10, 2009 at 01:52:28PM +0200, Taco Hoekwater wrote:
> 
> 
> Khaled Hosny wrote:
> > %%%
> > error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
> > attempt to call field 'register_message' (a nil value)
> > %%%
> 
> This is the bug (a lua or font problem).

The font has a ligature that don't have base anchors (that part of lua
code is about reporting this, I guess). If I replace
fonts.register_message with a dummy function it'll work.

> > %%%
> > luatex: ../../../source/texk/web2c/luatexdir/tex/linebreak.c:1660:
> > ext_do_line_break: Assertion `varmem[((cur_p)+1)].hh.v.RH ==
> > 0+4+4+4+4+4+4+2+2+2' failed.
> > Aborted
> > %%%
> 
> This is just a result of the earlier bug.

I thought so, I was just wondering why luatex don't exit cleanly (but I
think it may be the lua code fault not the engine).

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090610/8358f782/attachment.bin>

From pragma at wxs.nl  Wed Jun 10 15:38:29 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 10 Jun 2009 15:38:29 +0200
Subject: [dev-context] Crash with luatex-fonts
In-Reply-To: <20090610115916.GA18402@khaled-laptop>
References: <20090610114946.GA17150@khaled-laptop>	<4A2F9E7C.9000603@elvenkind.com>
	<20090610115916.GA18402@khaled-laptop>
Message-ID: <4A2FB755.9060204@wxs.nl>

Khaled Hosny wrote:
> On Wed, Jun 10, 2009 at 01:52:28PM +0200, Taco Hoekwater wrote:
>>
>> Khaled Hosny wrote:
>>> %%%
>>> error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
>>> attempt to call field 'register_message' (a nil value)
>>> %%%
>> This is the bug (a lua or font problem).
> 
> The font has a ligature that don't have base anchors (that part of lua
> code is about reporting this, I guess). If I replace
> fonts.register_message with a dummy function it'll work.

i'll add

function fonts.register_message()
end

to font-mis.lua

Hans



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From sanjoy at MIT.EDU  Wed Jun 10 15:58:22 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Wed, 10 Jun 2009 09:58:22 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: Your message of "Sun, 07 Jun 2009 23:17:58 +0200."
	<6faad9f00906071417g5d0ea85bu5e1f3ab56f9424a9@mail.gmail.com>
Message-ID: <E1MEOJq-0001pZ-RD@approx.mit.edu>

> You need to fetch recent TeX Gyre at least.

Thanks, and good thought.  I just installed the tex-gyre package from
Norbert's repository and that fixed the problem.  Now I can use all my
longer documents to test the 2009.06.04 context version.

By the way, do the context minimals require a separate installation of
tex-gyre?  When I installed the minimals, I think I remember seeing the
same font problems as I saw before I installed tex-gyre.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From taco at elvenkind.com  Wed Jun 10 16:05:28 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 10 Jun 2009 16:05:28 +0200
Subject: [dev-context] luatex beta 0.40.5
Message-ID: <4A2FBDA8.2010208@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.5 to the foundry server,
and have committed the source code to texlive.

What's new:

* One of the internal print functions accidentally encoded its
  argument string to UTF-8 even though it was already UTF-8.

* Some of the log and terminal UTF-8 output was gibberish.

The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.40.5

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From preining at logic.at  Wed Jun 10 18:17:47 2009
From: preining at logic.at (Norbert Preining)
Date: Wed, 10 Jun 2009 18:17:47 +0200
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: <E1MEOJq-0001pZ-RD@approx.mit.edu>
References: <6faad9f00906071417g5d0ea85bu5e1f3ab56f9424a9@mail.gmail.com>
	<E1MEOJq-0001pZ-RD@approx.mit.edu>
Message-ID: <20090610161747.GC30535@gamma.logic.tuwien.ac.at>

On Mi, 10 Jun 2009, Sanjoy Mahajan wrote:
> Thanks, and good thought.  I just installed the tex-gyre package from
> Norbert's repository and that fixed the problem.  Now I can use all my
> longer documents to test the 2009.06.04 context version.

Yeah, sorry, but that is all a bit a pain. I need the newer tex-gyre,
and lmodern fonts in Debian, but need newer TeX Live for that, first.
So, puhhh, at some time I have to do the work.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
CONG (n.)
Strange-shaped metal utensil found at the back of the saucepan
cupboard. Many authorities believe that congs provide conclusive proof
of the existence of a now extinct form of yellow vegetable which the
Victorians used to boil mercilessly.
			--- Douglas Adams, The Meaning of Liff

From khaledhosny at eglug.org  Wed Jun 10 22:15:13 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 10 Jun 2009 23:15:13 +0300
Subject: [dev-context] Crash with luatex-fonts
In-Reply-To: <4A2FB755.9060204@wxs.nl>
References: <20090610114946.GA17150@khaled-laptop>
	<4A2F9E7C.9000603@elvenkind.com>
	<20090610115916.GA18402@khaled-laptop> <4A2FB755.9060204@wxs.nl>
Message-ID: <20090610201513.GA8235@khaled-laptop>

On Wed, Jun 10, 2009 at 03:38:29PM +0200, Hans Hagen wrote:
> Khaled Hosny wrote:
>> On Wed, Jun 10, 2009 at 01:52:28PM +0200, Taco Hoekwater wrote:
>>>
>>> Khaled Hosny wrote:
>>>> %%%
>>>> error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
>>>> attempt to call field 'register_message' (a nil value)
>>>> %%%
>>> This is the bug (a lua or font problem).
>>
>> The font has a ligature that don't have base anchors (that part of lua
>> code is about reporting this, I guess). If I replace
>> fonts.register_message with a dummy function it'll work.
>
> i'll add
>
> function fonts.register_message()
> end
>
> to font-mis.lua

I updated to context 2009.06.10 20:06, but still getting that crash.
luatex-fonts.lua doesn't load font-mis.lua, adding it there (and
commnting luatex-fonts-merged.lua line) fixes it.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090610/f883391c/attachment.bin>

From pragma at wxs.nl  Wed Jun 10 23:32:55 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 10 Jun 2009 23:32:55 +0200
Subject: [dev-context] Crash with luatex-fonts
In-Reply-To: <20090610201513.GA8235@khaled-laptop>
References: <20090610114946.GA17150@khaled-laptop>
	<4A2F9E7C.9000603@elvenkind.com>
	<20090610115916.GA18402@khaled-laptop>
	<4A2FB755.9060204@wxs.nl> <20090610201513.GA8235@khaled-laptop>
Message-ID: <4A302687.6080400@wxs.nl>

Khaled Hosny wrote:
> On Wed, Jun 10, 2009 at 03:38:29PM +0200, Hans Hagen wrote:
>> Khaled Hosny wrote:
>>> On Wed, Jun 10, 2009 at 01:52:28PM +0200, Taco Hoekwater wrote:
>>>> Khaled Hosny wrote:
>>>>> %%%
>>>>> error: ...texmf/tex/plain/luatex-plain/luatex-fonts-merged.lua:7765:
>>>>> attempt to call field 'register_message' (a nil value)
>>>>> %%%
>>>> This is the bug (a lua or font problem).
>>> The font has a ligature that don't have base anchors (that part of lua
>>> code is about reporting this, I guess). If I replace
>>> fonts.register_message with a dummy function it'll work.
>> i'll add
>>
>> function fonts.register_message()
>> end
>>
>> to font-mis.lua
> 
> I updated to context 2009.06.10 20:06, but still getting that crash.
> luatex-fonts.lua doesn't load font-mis.lua, adding it there (and
> commnting luatex-fonts-merged.lua line) fixes it.

ah, should be font-dum


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Thu Jun 11 12:39:54 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Thu, 11 Jun 2009 12:39:54 +0200
Subject: [dev-context] setupbodyfont
In-Reply-To: <4A2E2C79.9010102@wxs.nl>
References: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
	<4A2E2C79.9010102@wxs.nl>
Message-ID: <3DDF922F-89C4-457D-AB6F-F87762A00571@gmail.com>


Am 09.06.2009 um 11:33 schrieb Hans Hagen:

>> I would prefer something documented (e.g.  
>> \setupbodyfont[reload,...]) which can
>> be used to get the same effect as I did with my hacks because I  
>> like now my new
>> font module, it's lot easier than direct method to set fallback  
>> fonts.
>
> well, docu is easy:
>
> \setupbodyfont[someclass]
>
> starts freezing the (font file related) definitions related to  
> someclass and there is currently no way to reset that
>
> normally a style will define several classes then and switching  
> between them is quite fast as only the namespace changes

I have now a different way to solve my problem without changing values  
but math has a problem with this.


Example:

\definetypeface[mine:1][rm][serif][cambria][default]
\definetypeface[mine:1][mm][math] [modern] [default]

\setupbodyfont[mine:1,14pt]

\definetypeface[mine:2][rm][serif][cambria][default]
\definetypeface[mine:2][mm][math] [cambria][default]

\setupbodyfont[mine:2,14pt]

\starttext

\startformula
c^2 = a^2 + b^2
\stopformula

\stoptext


Error:

! \textfont0 is undefined (character 99).
\stopdisplaymath ->\stopinnermath $$
                                     \ifgridsnapping \egroup  
\afterdisplayspa...
\dostopformula ...eter \c!alternative \v!formula }
                                                   \resetlastlinewidth  
\nonoi...
l.15 \stopformula


Wolfgang


From pragma at wxs.nl  Thu Jun 11 12:46:02 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 11 Jun 2009 12:46:02 +0200
Subject: [dev-context] setupbodyfont
In-Reply-To: <3DDF922F-89C4-457D-AB6F-F87762A00571@gmail.com>
References: <17129AA7-02C1-4AA4-A927-BF4BA708882C@gmail.com>
	<4A2E2C79.9010102@wxs.nl>
	<3DDF922F-89C4-457D-AB6F-F87762A00571@gmail.com>
Message-ID: <4A30E06A.8060405@wxs.nl>

Wolfgang Schuster wrote:
> 
> Am 09.06.2009 um 11:33 schrieb Hans Hagen:
> 
>>> I would prefer something documented (e.g. \setupbodyfont[reload,...]) 
>>> which can
>>> be used to get the same effect as I did with my hacks because I like 
>>> now my new
>>> font module, it's lot easier than direct method to set fallback fonts.
>>
>> well, docu is easy:
>>
>> \setupbodyfont[someclass]
>>
>> starts freezing the (font file related) definitions related to 
>> someclass and there is currently no way to reset that
>>
>> normally a style will define several classes then and switching 
>> between them is quite fast as only the namespace changes
> 
> I have now a different way to solve my problem without changing values 
> but math has a problem with this.
> 
> 
> Example:
> 
> \definetypeface[mine:1][rm][serif][cambria][default]
> \definetypeface[mine:1][mm][math] [modern] [default]
> 
> \setupbodyfont[mine:1,14pt]
> 
> \definetypeface[mine:2][rm][serif][cambria][default]
> \definetypeface[mine:2][mm][math] [cambria][default]
> 
> \setupbodyfont[mine:2,14pt]
> 
> \starttext
> 
> \startformula
> c^2 = a^2 + b^2
> \stopformula
> 
> \stoptext

for the moment add

\definebodyfontenvironment[14pt]


(remind me in a few weeks to look into it)


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From sanjoy at MIT.EDU  Thu Jun 11 16:35:52 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Thu, 11 Jun 2009 10:35:52 -0400
Subject: [dev-context] should texexec abort if write18,
	\runMP* needed but not set?
Message-ID: <E1MElNg-0000b5-Te@approx.mit.edu>

In testing a recent ConText (with texlive2008) using my math textbook, I
noticed that the problem backgrounds were not placed correctly.  Below
is a minimal test file where no background shows up.

Eventually I figured out the cause: The defaults are \runMPgraphicsfalse
and \runMPTEXgraphicsfalse and shell_escape = f (in texmf.cnf).  Setting
them all true fixed the backgrounds.

This is with ConTeXt  ver: 2009.06.04 22:20 MKII  (texlive 2008).

Could/should texexec abort if runtime metapost is needed but write18 and
\runMP* are not true?  That way seems safer than silently producing a
document different from what the user expects.

The long-term solution is probably that it all work even if those
variables are not true, but it is probably tricky to implement all the
subprocess communication and coordination.

-Sanjoy



\setupcolors[state=start]
% sly textbackground method from Aditya Mahajan (2006), "Homework
% Assignments in CONTEXT", PracTEX Journal, No. 4.
\definetextbackground
    [problembackground]
    [           mp=background:random,
          location=paragraph,
             width=local,
    ]

\startuseMPgraphic{background:random}
    path p;
    for i = 1 upto nofmultipars :
      p = (multipars[i]);
      fill p withcolor 0.90white;
    endfor;
\stopuseMPgraphic

\chardef\kindofpagetextareas\plusone

\starttext
\startproblembackground
\input tufte
\stopproblembackground
\stoptext

From sanjoy at MIT.EDU  Thu Jun 11 16:53:18 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Thu, 11 Jun 2009 10:53:18 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: Your message of "Fri, 05 Jun 2009 16:11:20 +0200."
	<4A292788.2000408@elvenkind.com>
Message-ID: <E1MEleY-0000hk-Un@approx.mit.edu>

> Either the bug is fixed or there is a subtle difference between
> our installations, but I do not get an error. Versions:
>  This is pdfTeX, Version 3.1415926-1.50.0-alpha-20080414
>  ConTeXt  ver: 2009.06.03 11:48 MKII
>  This is MetaPost, version 1.202

I also don't see the problem with a newer installation.  In particular:

  Creator:        ConTeXt - 2009.06.04 22:20
  Producer:       pdfTeX-1.40.9
  (with texlive2008)

But I also noticed that the vertical spacing is different from what
ConTeXt 2008.10.31 produces (part of Debian texlive2007).  The vadjust
problem is very sensitive to the vertical spacing, so a change in
vertical spacing might be hiding the problem.

I'll use the newer ConTeXt/pdftex setup for the full math textbook (of
which lumping.tex is a chapter).  That should be a good test of whether
the vadjust problem is still there.

By the way, is it worth my tracking down the difference in the vertical
spacing?  Or is that an expected change between 2008.10.31 and
2009.06.04?

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From mojca.miklavec.lists at gmail.com  Thu Jun 11 19:18:24 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Thu, 11 Jun 2009 19:18:24 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <4A2F7CB2.6060000@wxs.nl>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
	<20090608113938.GA15074@khaled-laptop> <4A2E84CF.5070703@wxs.nl>
	<20090609170130.GA23428@khaled-laptop> <4A2F7CB2.6060000@wxs.nl>
Message-ID: <6faad9f00906111018h68cf16act333cf3e6095c39d5@mail.gmail.com>

>> This works for me, but I think we need to added it to ctxtools.rb for
>> 'ctxtools --purgefiles --all' too?
>
> ctxtools becomes obsolete

I would have used context --purge, but that one doesn't purge the junk
that mkii generates.

But there only 6 characters to add to this list it ctxtools, right?
(OK, a bit more to handle both requests.)

    $forsuresuffixes = [
        "tui", "tua", "tup", "ted", "tes", "top",
    ...

Mojca

From sanjoy at MIT.EDU  Thu Jun 11 21:34:40 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Thu, 11 Jun 2009 15:34:40 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: Your message of "Fri, 05 Jun 2009 16:11:20 +0200."
	<4A292788.2000408@elvenkind.com>
Message-ID: <E1MEq2q-0004pn-Hb@approx.mit.edu>

> Either the bug is fixed or there is a subtle difference between
> our installations, but I do not get an error

I've reproduced the problem using a more recent ConTeXt:

  ConTeXt  ver: 2009.06.04 22:20 MKII
  pdfTeXk, Version 3.1415926-1.40.9 

The test files are in the attached zip file, which expands into a
vadjust-problem/ directory.  Then "texexec symmetry.tex" reproduces the
problem for me.  Here is the error message:

./symmetry.tex:920: You can't use `\vadjust' in internal vertical mode.
<recently read> \vadjust 
                         
\sidefloatoutput ... \parskip \zeropoint \vadjust 
                                                  {\penalty \minusone }\iffl...
<argument> ...\fi \else \the \defaultstreamoutput 
                                                  \fi 
\firstoftwoarguments #1#2->#1
                             
\dodonormaloutput ...lty \the \OTRcommand \output 
                                                  \outputmessage -{normal}\o...

\invokeoutputroutine ...enalty }\dodonormaloutput 
                                                  \outputmessage -{trying}\o...
...


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/zip
Size: 46050 bytes
Desc: vadjust-problem.zip
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090611/66647d04/attachment-0001.zip>

From sanjoy at MIT.EDU  Thu Jun 11 22:01:12 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Thu, 11 Jun 2009 16:01:12 -0400
Subject: [dev-context] particular mpost label fails with recent ConTeXt
Message-ID: <E1MEqSW-000503-P2@approx.mit.edu>

With a recent ConTeXt, the following file (run with "mpost -mem=metafun
test.mp")

  % use ConTeXt to typeset labels (needs -mem=metafun option)
  verbatimtex %&cont-en
  etex

  beginfig(100)
    % flow arrow
    label(btex $\displaystyle\buildrel \rm Flow \over
      {=\joinrel=\joinrel\Longrightarrow}$ etex, origin);
  endfig;
  end

fails with:

  ! Unable to make mpx file.
  l.7   label(btex
		   $\displaystyle\buildrel \rm Flow \over
  Transcript written on fig.log.


The error in mpxerr.log is:

  ! Illegal unit of measure (pt inserted).
  <to be read again> 
		     =
  <argument> =
	      \joinrel =\joinrel \Longrightarrow 
  \buildrel ...mathrel {\mathop {\kern \zerocount #2
						    }\limits ^{#1}}
  l.14     {=\joinrel=\joinrel\Longrightarrow}
					      $%


It works with ConTeXt 2008.10.31.  It fails with ConTeXt 2009.06.04
(with texlive2007 from Debian or with vanilla texlive2008).

From taco at elvenkind.com  Thu Jun 11 22:10:18 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 11 Jun 2009 22:10:18 +0200
Subject: [dev-context] error: You can't use `\vadjust' in internal
 vertical mode
In-Reply-To: <E1MEq2q-0004pn-Hb@approx.mit.edu>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu>
Message-ID: <4A3164AA.4060202@elvenkind.com>

Sanjoy Mahajan wrote:
>> Either the bug is fixed or there is a subtle difference between
>> our installations, but I do not get an error
> 
> I've reproduced the problem using a more recent ConTeXt:
> 
>   ConTeXt  ver: 2009.06.04 22:20 MKII
>   pdfTeXk, Version 3.1415926-1.40.9 
> 
> The test files are in the attached zip file, which expands into a
> vadjust-problem/ directory.  Then "texexec symmetry.tex" reproduces the
> problem for me.  Here is the error message:

Yes, here too now. I'll investigate this (but it could take a while).

From taco at elvenkind.com  Thu Jun 11 22:27:58 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 11 Jun 2009 22:27:58 +0200
Subject: [dev-context] particular mpost label fails with recent ConTeXt
In-Reply-To: <E1MEqSW-000503-P2@approx.mit.edu>
References: <E1MEqSW-000503-P2@approx.mit.edu>
Message-ID: <4A3168CE.6070902@elvenkind.com>

Sanjoy Mahajan wrote:
> The error in mpxerr.log is:
> 
>   ! Illegal unit of measure (pt inserted).
>   <to be read again> 
> 		     =
>   <argument> =
> 	      \joinrel =\joinrel \Longrightarrow 
>   \buildrel ...mathrel {\mathop {\kern \zerocount #2
> 						    }\limits ^{#1}}
>   l.14     {=\joinrel=\joinrel\Longrightarrow}
> 					      $%

The problem is that the \zerocount that is used in buildrel:

\def\buildrel#1\over#2%
   {\mathrel{\mathop{\kern\zerocount#2}\limits^{#1}}}


somehow ends up being a \chardef. A shorter test file is:

   \starttext
   $\buildrel a \over b $
   \stoptext

the weird thing is that I can't figure out where that definition
takes place ?? (well, there is one in syst-ini, but that should
have been overwritten by the one in syst-gen, afaik).

Best wishes,
Taco


From pragma at wxs.nl  Fri Jun 12 09:55:45 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 09:55:45 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <6faad9f00906111018h68cf16act333cf3e6095c39d5@mail.gmail.com>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>	
	<20090608113938.GA15074@khaled-laptop> <4A2E84CF.5070703@wxs.nl>	
	<20090609170130.GA23428@khaled-laptop> <4A2F7CB2.6060000@wxs.nl>
	<6faad9f00906111018h68cf16act333cf3e6095c39d5@mail.gmail.com>
Message-ID: <4A320A01.6050205@wxs.nl>

Mojca Miklavec wrote:
>>> This works for me, but I think we need to added it to ctxtools.rb for
>>> 'ctxtools --purgefiles --all' too?
>> ctxtools becomes obsolete
> 
> I would have used context --purge, but that one doesn't purge the junk
> that mkii generates.
> 
> But there only 6 characters to add to this list it ctxtools, right?
> (OK, a bit more to handle both requests.)
> 
>     $forsuresuffixes = [
>         "tui", "tua", "tup", "ted", "tes", "top",
>     ...

so:

         "pgf", "synctex.gz",


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Fri Jun 12 10:21:55 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 10:21:55 +0200
Subject: [dev-context] particular mpost label fails with recent ConTeXt
In-Reply-To: <4A3168CE.6070902@elvenkind.com>
References: <E1MEqSW-000503-P2@approx.mit.edu> <4A3168CE.6070902@elvenkind.com>
Message-ID: <4A321023.1070205@wxs.nl>

Taco Hoekwater wrote:
> Sanjoy Mahajan wrote:
>> The error in mpxerr.log is:
>>
>>   ! Illegal unit of measure (pt inserted).
>>   <to be read again>              =
>>   <argument> =
>>           \joinrel =\joinrel \Longrightarrow   \buildrel ...mathrel 
>> {\mathop {\kern \zerocount #2
>>                             }\limits ^{#1}}
>>   l.14     {=\joinrel=\joinrel\Longrightarrow}
>>                           $%
> 
> The problem is that the \zerocount that is used in buildrel:
> 
> \def\buildrel#1\over#2%
>   {\mathrel{\mathop{\kern\zerocount#2}\limits^{#1}}}
> 
> 
> somehow ends up being a \chardef. A shorter test file is:
> 
>   \starttext
>   $\buildrel a \over b $
>   \stoptext
> 
> the weird thing is that I can't figure out where that definition
> takes place ?? (well, there is one in syst-ini, but that should
> have been overwritten by the one in syst-gen, afaik).

math-ini.mkii

\def\buildrel#1\over#2%
   {\mathrel{\mathop{\kern\zeropoint#2}\limits^{#1}}}

-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Jun 12 10:46:44 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 12 Jun 2009 10:46:44 +0200
Subject: [dev-context] particular mpost label fails with recent ConTeXt
In-Reply-To: <4A321023.1070205@wxs.nl>
References: <E1MEqSW-000503-P2@approx.mit.edu>
	<4A3168CE.6070902@elvenkind.com> <4A321023.1070205@wxs.nl>
Message-ID: <4A3215F4.9010808@elvenkind.com>



Hans Hagen wrote:
>>
>> the weird thing is that I can't figure out where that definition
>> takes place ?? (well, there is one in syst-ini, but that should
>> have been overwritten by the one in syst-gen, afaik).
> 
> math-ini.mkii
> 
> \def\buildrel#1\over#2%
>   {\mathrel{\mathop{\kern\zeropoint#2}\limits^{#1}}}

Well, yeah. I meant the (incorrect!) redefinition of \zeropoint.

Best wishes,
Taco


From pragma at wxs.nl  Fri Jun 12 18:03:16 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 18:03:16 +0200
Subject: [dev-context] error: You can't use `\vadjust' in
 internal	vertical mode
In-Reply-To: <E1MEq2q-0004pn-Hb@approx.mit.edu>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu>
Message-ID: <4A327C44.6040700@wxs.nl>

Sanjoy Mahajan wrote:
>> Either the bug is fixed or there is a subtle difference between
>> our installations, but I do not get an error

interesting, i get an error on ...  pplb8r

i think i'm going to blame mojca ... (this will trigger her into 
solution mode)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Fri Jun 12 18:08:25 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 18:08:25 +0200
Subject: [dev-context] error: You can't use `\vadjust' in
 internal	vertical mode
In-Reply-To: <4A327C44.6040700@wxs.nl>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu> <4A327C44.6040700@wxs.nl>
Message-ID: <4A327D79.1050301@wxs.nl>

Hans Hagen wrote:
> Sanjoy Mahajan wrote:
>>> Either the bug is fixed or there is a subtle difference between
>>> our installations, but I do not get an error
> 
> interesting, i get an error on ...  pplb8r
> 
> i think i'm going to blame mojca ... (this will trigger her into 
> solution mode)

ok, the problem is in the images ... please make images self contained 
and don't depent on funny fonts being present on the system

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Fri Jun 12 18:21:01 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 18:21:01 +0200
Subject: [dev-context] should texexec abort if write18,
 \runMP* needed but not set?
In-Reply-To: <E1MElNg-0000b5-Te@approx.mit.edu>
References: <E1MElNg-0000b5-Te@approx.mit.edu>
Message-ID: <4A32806D.2020108@wxs.nl>

Sanjoy Mahajan wrote:

> The long-term solution is probably that it all work even if those
> variables are not true, but it is probably tricky to implement all the
> subprocess communication and coordination.

a more near solution is to switch to mkiv as it does things internally 
and mp processing takes no runtime


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Jun 12 18:31:00 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 12 Jun 2009 18:31:00 +0200
Subject: [dev-context] error: You can't use `\vadjust' in
 internal	vertical mode
In-Reply-To: <4A327D79.1050301@wxs.nl>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu> <4A327C44.6040700@wxs.nl>
	<4A327D79.1050301@wxs.nl>
Message-ID: <4A3282C4.2080503@elvenkind.com>

Hans Hagen wrote:
> Hans Hagen wrote:
>> Sanjoy Mahajan wrote:
>>>> Either the bug is fixed or there is a subtle difference between
>>>> our installations, but I do not get an error
>>
>> interesting, i get an error on ...  pplb8r
>>
>> i think i'm going to blame mojca ... (this will trigger her into 
>> solution mode)
> 
> ok, the problem is in the images ... please make images self contained 

I don 't think so. I have the font (which is just Palatino-Roman), and
I still get that \vadjust message error.

From pragma at wxs.nl  Fri Jun 12 18:45:38 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 18:45:38 +0200
Subject: [dev-context] error: You can't use `\vadjust' in
 internal	vertical mode
In-Reply-To: <4A3282C4.2080503@elvenkind.com>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu> <4A327C44.6040700@wxs.nl>
	<4A327D79.1050301@wxs.nl> <4A3282C4.2080503@elvenkind.com>
Message-ID: <4A328632.1010804@wxs.nl>

Taco Hoekwater wrote:
> Hans Hagen wrote:
>> Hans Hagen wrote:
>>> Sanjoy Mahajan wrote:
>>>>> Either the bug is fixed or there is a subtle difference between
>>>>> our installations, but I do not get an error
>>>
>>> interesting, i get an error on ...  pplb8r
>>>
>>> i think i'm going to blame mojca ... (this will trigger her into 
>>> solution mode)
>>
>> ok, the problem is in the images ... please make images self contained 
> 
> I don 't think so. I have the font (which is just Palatino-Roman), and

well, the a map file issue .. but i gave up on those funny tex fonts 
(esp the ones ending on r)

anyhow, with the new zip i get the error



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Jun 12 18:54:39 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 12 Jun 2009 18:54:39 +0200
Subject: [dev-context] error: You can't use `\vadjust' in
 internal	vertical mode
In-Reply-To: <4A328632.1010804@wxs.nl>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu> <4A327C44.6040700@wxs.nl>
	<4A327D79.1050301@wxs.nl> <4A3282C4.2080503@elvenkind.com>
	<4A328632.1010804@wxs.nl>
Message-ID: <4A32884F.5010609@elvenkind.com>

Hans Hagen wrote:
> Taco Hoekwater wrote:
>> Hans Hagen wrote:
>>> Hans Hagen wrote:
>>>> Sanjoy Mahajan wrote:
>>>>>> Either the bug is fixed or there is a subtle difference between
>>>>>> our installations, but I do not get an error
>>>>
>>>> interesting, i get an error on ...  pplb8r
>>>>
>>>> i think i'm going to blame mojca ... (this will trigger her into 
>>>> solution mode)
>>>
>>> ok, the problem is in the images ... please make images self contained 
>>
>> I don 't think so. I have the font (which is just Palatino-Roman), and
> 
> well, the a map file issue .. but i gave up on those funny tex fonts 
> (esp the ones ending on r)
> 
> anyhow, with the new zip i get the error

If I patch \sidefloatoutput (page-sid.tex) like so:

\def\sidefloatoutput
   {\iffloatshort
      \unvbox\normalpagebox
      \setbox\floatbottom\lastbox
      \ifdim\wd\floatbottom>\sidefloathsize
        \penalty-201
        \box\floatbottom
      \else
        \ifvoid\floatbottom
        \else
          \restoreleftindent
          \ifdim\wd\floatbottom<\sidefloathsize
            \parskip\zeropoint
            %\noindent
-           \vadjust{\penalty\minusone}%
+           \ifinner\else \vadjust{\penalty\minusone}\fi


it runs without error. It looks like the side float output routine
is called in the middle of this math display:

   \startformula
   a-b+c-d+f-g+h-e\equiv1\ (\mod 3),
   \stopformula
   which shows that all vertices cannot be made multiples of~3
   simultaneously.

I think my patch somewhat odd, but at least it does not crash and I fear
that the sidefloat output in this case (a float next to a display that
forces a page break) is somewhat undefined anyway.


Best wishes,
Taco


From pragma at wxs.nl  Fri Jun 12 19:12:51 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 12 Jun 2009 19:12:51 +0200
Subject: [dev-context] error: You can't use `\vadjust' in
 internal	vertical mode
In-Reply-To: <4A32884F.5010609@elvenkind.com>
References: <E1MEq2q-0004pn-Hb@approx.mit.edu> <4A327C44.6040700@wxs.nl>
	<4A327D79.1050301@wxs.nl> <4A3282C4.2080503@elvenkind.com>
	<4A328632.1010804@wxs.nl> <4A32884F.5010609@elvenkind.com>
Message-ID: <4A328C93.20508@wxs.nl>

Taco Hoekwater wrote:
> Hans Hagen wrote:
>> Taco Hoekwater wrote:
>>> Hans Hagen wrote:
>>>> Hans Hagen wrote:
>>>>> Sanjoy Mahajan wrote:
>>>>>>> Either the bug is fixed or there is a subtle difference between
>>>>>>> our installations, but I do not get an error
>>>>>
>>>>> interesting, i get an error on ...  pplb8r
>>>>>
>>>>> i think i'm going to blame mojca ... (this will trigger her into 
>>>>> solution mode)
>>>>
>>>> ok, the problem is in the images ... please make images self contained 
>>>
>>> I don 't think so. I have the font (which is just Palatino-Roman), and
>>
>> well, the a map file issue .. but i gave up on those funny tex fonts 
>> (esp the ones ending on r)
>>
>> anyhow, with the new zip i get the error
> 
> If I patch \sidefloatoutput (page-sid.tex) like so:
> 
> \def\sidefloatoutput
>   {\iffloatshort
>      \unvbox\normalpagebox
>      \setbox\floatbottom\lastbox
>      \ifdim\wd\floatbottom>\sidefloathsize
>        \penalty-201
>        \box\floatbottom
>      \else
>        \ifvoid\floatbottom
>        \else
>          \restoreleftindent
>          \ifdim\wd\floatbottom<\sidefloathsize
>            \parskip\zeropoint
>            %\noindent
> -           \vadjust{\penalty\minusone}%
> +           \ifinner\else \vadjust{\penalty\minusone}\fi
> 
> 
> it runs without error. It looks like the side float output routine
> is called in the middle of this math display:
> 
>   \startformula
>   a-b+c-d+f-g+h-e\equiv1\ (\mod 3),
>   \stopformula
>   which shows that all vertices cannot be made multiples of~3
>   simultaneously.
> 
> I think my patch somewhat odd, but at least it does not crash and I fear
> that the sidefloat output in this case (a float next to a display that
> forces a page break) is somewhat undefined anyway.

ah .. i was already staring at it for a while

it's the first time that i run into something with side floats (started 
out as copied code from a tug boat article)

there's also a patch needed for

        \ifinner\else\vadjust{\penalty\minusone}\fi

later on

Thanks

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From sanjoy at MIT.EDU  Sat Jun 13 04:45:19 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Fri, 12 Jun 2009 22:45:19 -0400
Subject: [dev-context] error: You can't use `\vadjust' in internal
	vertical mode
In-Reply-To: Your message of "Fri, 12 Jun 2009 19:12:51 +0200."
	<4A328C93.20508@wxs.nl>
Message-ID: <E1MFJF9-0000gF-LL@approx.mit.edu>

> there's also a patch needed for
>  \ifinner\else\vadjust{\penalty\minusone}\fi
> later on

With Taco's patch to both \vadjust lines, the bug disappears here.  I'll
keep running the modified version to see whether it triggers in other
cases, but I think it's solved.

Thanks much.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From taco at elvenkind.com  Sun Jun 14 10:38:38 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 14 Jun 2009 10:38:38 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <4A33595C.2000709@wxs.nl>
References: <h0v08b$a5k$1@ger.gmane.org> <4A33595C.2000709@wxs.nl>
Message-ID: <4A34B70E.1020801@elvenkind.com>

Hans Hagen wrote:
>>
>> Some text.
>>
>> {
>>   \switchtobodyfont[concrete]
>>   More text.
>> }
> 
> concrete roman? mkiv does not support bitmap fonts out of the box

Well, mkiv does indeed define a typescript for concrete in type-otf ....

Best wishes,
Taco

From schuster.wolfgang at googlemail.com  Sun Jun 14 10:43:28 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 14 Jun 2009 10:43:28 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <4A34B70E.1020801@elvenkind.com>
References: <h0v08b$a5k$1@ger.gmane.org> <4A33595C.2000709@wxs.nl>
	<4A34B70E.1020801@elvenkind.com>
Message-ID: <4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>


Am 14.06.2009 um 10:38 schrieb Taco Hoekwater:

> Hans Hagen wrote:
>>>
>>> Some text.
>>>
>>> {
>>>  \switchtobodyfont[concrete]
>>>  More text.
>>> }
>> concrete roman? mkiv does not support bitmap fonts out of the box
>
> Well, mkiv does indeed define a typescript for concrete in type- 
> otf ....

It doesn't, concrete is not part of type-otf.mkiv, only type-otf.mkii

Wolfgang


From taco at elvenkind.com  Sun Jun 14 10:45:16 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 14 Jun 2009 10:45:16 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>
References: <h0v08b$a5k$1@ger.gmane.org>
	<4A33595C.2000709@wxs.nl>	<4A34B70E.1020801@elvenkind.com>
	<4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>
Message-ID: <4A34B89C.2010902@elvenkind.com>

Wolfgang Schuster wrote:
> 
> Am 14.06.2009 um 10:38 schrieb Taco Hoekwater:
> 
>> Hans Hagen wrote:
>>>>
>>>> Some text.
>>>>
>>>> {
>>>>  \switchtobodyfont[concrete]
>>>>  More text.
>>>> }
>>> concrete roman? mkiv does not support bitmap fonts out of the box
>>
>> Well, mkiv does indeed define a typescript for concrete in type-otf ....
> 
> It doesn't, concrete is not part of type-otf.mkiv, only type-otf.mkii

In current?

From schuster.wolfgang at googlemail.com  Sun Jun 14 10:48:31 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 14 Jun 2009 10:48:31 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <4A34B89C.2010902@elvenkind.com>
References: <h0v08b$a5k$1@ger.gmane.org>
	<4A33595C.2000709@wxs.nl>	<4A34B70E.1020801@elvenkind.com>
	<4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>
	<4A34B89C.2010902@elvenkind.com>
Message-ID: <A44E0AE5-F693-4AAD-8204-3CE267964DFB@gmail.com>


Am 14.06.2009 um 10:45 schrieb Taco Hoekwater:

> Wolfgang Schuster wrote:
>> Am 14.06.2009 um 10:38 schrieb Taco Hoekwater:
>>> Well, mkiv does indeed define a typescript for concrete in type- 
>>> otf ....
>> It doesn't, concrete is not part of type-otf.mkiv, only type-otf.mkii
>
> In current?

Beta

Wolfgang


From taco at elvenkind.com  Sun Jun 14 10:49:46 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 14 Jun 2009 10:49:46 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <A44E0AE5-F693-4AAD-8204-3CE267964DFB@gmail.com>
References: <h0v08b$a5k$1@ger.gmane.org>
	<4A33595C.2000709@wxs.nl>	<4A34B70E.1020801@elvenkind.com>
	<4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>
	<4A34B89C.2010902@elvenkind.com>
	<A44E0AE5-F693-4AAD-8204-3CE267964DFB@gmail.com>
Message-ID: <4A34B9AA.10104@elvenkind.com>

Wolfgang Schuster wrote:
> 
> Am 14.06.2009 um 10:45 schrieb Taco Hoekwater:
> 
>> Wolfgang Schuster wrote:
>>> Am 14.06.2009 um 10:38 schrieb Taco Hoekwater:
>>>> Well, mkiv does indeed define a typescript for concrete in type-otf 
>>>> ....
>>> It doesn't, concrete is not part of type-otf.mkiv, only type-otf.mkii
>>
>> In current?
> 
> Beta

I thought so. For practical reasons, the manual documents current
only. (btw, it is getting time for a new current, I think).

Best wishes,
Taco

From patrick at gundla.ch  Sun Jun 14 10:55:56 2009
From: patrick at gundla.ch (Patrick Gundlach)
Date: Sun, 14 Jun 2009 10:55:56 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <4A34B9AA.10104@elvenkind.com> (Taco Hoekwater's message of "Sun\,
	14 Jun 2009 10\:49\:46 +0200")
References: <h0v08b$a5k$1@ger.gmane.org> <4A33595C.2000709@wxs.nl>
	<4A34B70E.1020801@elvenkind.com>
	<4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>
	<4A34B89C.2010902@elvenkind.com>
	<A44E0AE5-F693-4AAD-8204-3CE267964DFB@gmail.com>
	<4A34B9AA.10104@elvenkind.com>
Message-ID: <m1r5xni483.fsf@levana.de>


> only. (btw, it is getting time for a new current, I think).

Yes, please. That way I can test the repository :)

Patrick
-- 
ConTeXt wiki and more: http://contextgarden.net

From luigi.scarso at gmail.com  Sun Jun 14 18:50:08 2009
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sun, 14 Jun 2009 18:50:08 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <4A34B9AA.10104@elvenkind.com>
References: <h0v08b$a5k$1@ger.gmane.org> <4A33595C.2000709@wxs.nl>
	<4A34B70E.1020801@elvenkind.com>
	<4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>
	<4A34B89C.2010902@elvenkind.com>
	<A44E0AE5-F693-4AAD-8204-3CE267964DFB@gmail.com>
	<4A34B9AA.10104@elvenkind.com>
Message-ID: <fe8d59da0906140950s5aa8c429nbcbfc828500691b1@mail.gmail.com>

>
> I thought so. For practical reasons, the manual documents current
> only. (btw, it is getting time for a new current, I think).
>
+1

-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090614/66eb6c67/attachment.html>

From pragma at wxs.nl  Sun Jun 14 19:15:24 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 14 Jun 2009 19:15:24 +0200
Subject: [dev-context] Is this font changing allowed/correct?
In-Reply-To: <fe8d59da0906140950s5aa8c429nbcbfc828500691b1@mail.gmail.com>
References: <h0v08b$a5k$1@ger.gmane.org>
	<4A33595C.2000709@wxs.nl>	<4A34B70E.1020801@elvenkind.com>	<4D614B49-98E5-43F0-BEDE-4D2107229E31@gmail.com>	<4A34B89C.2010902@elvenkind.com>	<A44E0AE5-F693-4AAD-8204-3CE267964DFB@gmail.com>	<4A34B9AA.10104@elvenkind.com>
	<fe8d59da0906140950s5aa8c429nbcbfc828500691b1@mail.gmail.com>
Message-ID: <4A35302C.7030806@wxs.nl>

luigi scarso wrote:
>> I thought so. For practical reasons, the manual documents current
>> only. (btw, it is getting time for a new current, I think).
>>
> +1

be warned .. you need to adapt a log of the module documentation code 
... many new files and changed names

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Mon Jun 15 23:50:07 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 15 Jun 2009 23:50:07 +0200
Subject: [dev-context] removing .pgf file with --purgeall
In-Reply-To: <4A320A01.6050205@wxs.nl>
References: <6faad9f00906080428g70f9420ara0cca5aeaf3040bf@mail.gmail.com>
	<20090608113938.GA15074@khaled-laptop> <4A2E84CF.5070703@wxs.nl>
	<20090609170130.GA23428@khaled-laptop> <4A2F7CB2.6060000@wxs.nl>
	<6faad9f00906111018h68cf16act333cf3e6095c39d5@mail.gmail.com>
	<4A320A01.6050205@wxs.nl>
Message-ID: <6faad9f00906151450u77012ff7n6862ea2fc8f1bcc3@mail.gmail.com>

On Fri, Jun 12, 2009 at 09:55, Hans Hagen wrote:
> Mojca Miklavec wrote:
>>>>
>>>> This works for me, but I think we need to added it to ctxtools.rb for
>>>> 'ctxtools --purgefiles --all' too?
>>>
>>> ctxtools becomes obsolete
>>
>> I would have used context --purge, but that one doesn't purge the junk
>> that mkii generates.
>>
>> But there only 6 characters to add to this list it ctxtools, right?
>> (OK, a bit more to handle both requests.)
>>
>> ? ?$forsuresuffixes = [
>> ? ? ? ?"tui", "tua", "tup", "ted", "tes", "top",
>> ? ?...
>
> so:
>
> ? ? ? ?"pgf", "synctex.gz",

It seems to work (almost) OK, thanks a lot. I have made a tiny minor
mistake though.

$forsuresuffixes cleans the files on "--purge" while $texnonesuffixes
cleans them on "--purge --all".

So it might be slighty better to have

    $forsuresuffixes = [
        "tui", "tua", "tup", "ted", "tes", "top",
        "log", "tmp", "run", "bck", "rlg",
        "mpt", "mpx", "mpd", "mpo", "mpb",
        "ctl", "synctex.gz(busy)",
        "tmp.md5", "tmp.out"
    ]
    $texonlysuffixes = [
        "dvi", "ps", "pdf"
    ]
    $texnonesuffixes = [
        "tuo", "tub", "top", "tuc", "pgf", "synctex.gz"
    ]

but now I'm already too annoying, so you may just as well ignore the
notice above :) :)


On the other hand
(1) neither "context --purge" nor "context --purge --all" remove the .synctex.gz
(2) running "context somefile" deletes somefile.synctex.gz
none of which is probably the desired effect.

I have been scratching my head about (2) for quite some time, but then
I figured out that it indeed makes sense to delete the synctex file.

The problem with (1) is that
    local suffix = file.extname(name)
only returns .gz and that one is not properly recognized when compared
with "synctex.gz".
Apart from that I would put "pgf" and "synctex.gz" under
"persistent_runfiles" rather than "temporary_runfiles" (like in mkii).

Mojca

From taco at elvenkind.com  Tue Jun 16 13:55:42 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 16 Jun 2009 13:55:42 +0200
Subject: [dev-context] context reference
In-Reply-To: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
Message-ID: <4A37883E.4050502@elvenkind.com>



Peter M?nster wrote:
> Hello Taco,
> 
> I would like to keep a working copy of the context-reference
> (http://foundry.supelec.fr/svn/contextman/context-reference) on my
> hard-drive and use this as my first reference for my context questions, in
> order to send you suggestions for improvements whenever I notice some.
> 
> But of course, first it should compile. Today there are some errors, the
> first one is this one:
> 
> ! Undefined control sequence.
> <recently read> \blacktriangleleft 

Oh, right (I knew this). Hans, any idea where it went?

Best wishes,
taco

From mojca.miklavec.lists at gmail.com  Tue Jun 16 14:33:57 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 16 Jun 2009 14:33:57 +0200
Subject: [dev-context] context reference
In-Reply-To: <4A37883E.4050502@elvenkind.com>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
	<4A37883E.4050502@elvenkind.com>
Message-ID: <6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>

On Tue, Jun 16, 2009 at 13:55, Taco Hoekwater wrote:
>
>> ! Undefined control sequence.
>> <recently read> \blacktriangleleft
>
> Oh, right (I knew this). Hans, any idea where it went?

It comes from the old "ma" encoding and I guess it has never been
added to char-def.lua in the first place. (The symbols from mi, sy,
... have been checked more carefully than those from ma, mb, ...)

Is this U+25C0 or U+25C2 (or maybe even U+25C4)?

Mojca

From mojca.miklavec.lists at gmail.com  Tue Jun 16 14:49:42 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 16 Jun 2009 14:49:42 +0200
Subject: [dev-context] context reference
In-Reply-To: <6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
	<4A37883E.4050502@elvenkind.com>
	<6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
Message-ID: <6faad9f00906160549s1c88d028r1616727521995a0@mail.gmail.com>

I have just found an interesting source that could be used to check
for any missing characters:

http://www.xmlgrrl.com/publications/DSDTD/apd.html
http://www.ic.unicamp.br/~tomasz/misc/isoent-ref.pdf

Mojca

On Tue, Jun 16, 2009 at 14:33, Mojca
Miklavec<mojca.miklavec.lists at gmail.com> wrote:
> On Tue, Jun 16, 2009 at 13:55, Taco Hoekwater wrote:
>>
>>> ! Undefined control sequence.
>>> <recently read> \blacktriangleleft
>>
>> Oh, right (I knew this). Hans, any idea where it went?
>
> It comes from the old "ma" encoding and I guess it has never been
> added to char-def.lua in the first place. (The symbols from mi, sy,
> ... have been checked more carefully than those from ma, mb, ...)
>
> Is this U+25C0 or U+25C2 (or maybe even U+25C4)?
>
> Mojca
>

From mojca.miklavec.lists at gmail.com  Tue Jun 16 15:02:12 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 16 Jun 2009 15:02:12 +0200
Subject: [dev-context] context reference
In-Reply-To: <6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
	<4A37883E.4050502@elvenkind.com>
	<6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
Message-ID: <6faad9f00906160602t7a300ecbp5ee72c069ab007b0@mail.gmail.com>

On Tue, Jun 16, 2009 at 14:33, Mojca Miklavec wrote:
> On Tue, Jun 16, 2009 at 13:55, Taco Hoekwater wrote:
>>
>>> ! Undefined control sequence.
>>> <recently read> \blacktriangleleft
>>
>> Oh, right (I knew this). Hans, any idea where it went?
>
> It comes from the old "ma" encoding and I guess it has never been
> added to char-def.lua in the first place. (The symbols from mi, sy,
> ... have been checked more carefully than those from ma, mb, ...)
>
> Is this U+25C0 or U+25C2 (or maybe even U+25C4)?

math-vfu.lua says 25C0, but this document
(http://www.xmlgrrl.com/publications/DSDTD/apd.html) would rather
suggest 25C2:


In char-def.lua:

the following two lines need to be added to either [0x25C0]={ or
[0x25C2]={ inside char-def.lua:
  mathclass="rel",
  mathname="blacktriangleleft",
and if they are added to 25C2 then also the entry in math-vfu.lua
should be changed (and all other characters as well).

How do the characters in Cambria math look like? Which one comes closer?

Mojca

From arthur.reutenauer at normalesup.org  Tue Jun 16 15:52:00 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Tue, 16 Jun 2009 15:52:00 +0200
Subject: [dev-context] context reference
In-Reply-To: <6faad9f00906160602t7a300ecbp5ee72c069ab007b0@mail.gmail.com>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
	<4A37883E.4050502@elvenkind.com>
	<6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
	<6faad9f00906160602t7a300ecbp5ee72c069ab007b0@mail.gmail.com>
Message-ID: <20090616135200.GA4767@phare.normalesup.org>

> How do the characters in Cambria math look like? Which one comes closer?

  The criterion would rather be: how is it used in ConTeXt?  And from
what I read in symb-mis.tex, it seems that it is used as a "rewind"
character, hence a rather big triangle, more like U+2520 than U+2522.

	Arthur

From taco at elvenkind.com  Tue Jun 16 15:28:23 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 16 Jun 2009 15:28:23 +0200
Subject: [dev-context] context reference
In-Reply-To: <6faad9f00906160602t7a300ecbp5ee72c069ab007b0@mail.gmail.com>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>	
	<4A37883E.4050502@elvenkind.com>	
	<6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
	<6faad9f00906160602t7a300ecbp5ee72c069ab007b0@mail.gmail.com>
Message-ID: <4A379DF7.8060001@elvenkind.com>


Hi,

Mojca Miklavec wrote:
> 
> the following two lines need to be added to either [0x25C0]={ or
> [0x25C2]={ inside char-def.lua:
>   mathclass="rel",
>   mathname="blacktriangleleft",
> and if they are added to 25C2 then also the entry in math-vfu.lua
> should be changed (and all other characters as well).

The actual usage in the manual is as a flipped version of 0x2023
(triangular bullet) but that doesn't exist at all. Which Unicode
character is best for the math relation, I have no idea (but see below).

> How do the characters in Cambria math look like? Which one comes closer?

There are no black triangles in Cambria Math *at all*, it seems.

Best wishes,
Taco


From arthur.reutenauer at normalesup.org  Tue Jun 16 16:18:08 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Tue, 16 Jun 2009 16:18:08 +0200
Subject: [dev-context] context reference
In-Reply-To: <4A379DF7.8060001@elvenkind.com>
References: <alpine.LNX.2.00.0906161334290.25471@gaston.couberia.bzh>
	<4A37883E.4050502@elvenkind.com>
	<6faad9f00906160533p314c9b5dk1f7c80e63213d1f8@mail.gmail.com>
	<6faad9f00906160602t7a300ecbp5ee72c069ab007b0@mail.gmail.com>
	<4A379DF7.8060001@elvenkind.com>
Message-ID: <20090616141808.GA21077@phare.normalesup.org>

> The actual usage in the manual is as a flipped version of 0x2023
> (triangular bullet) but that doesn't exist at all. Which Unicode
> character is best for the math relation, I have no idea (but see below).

  Oh.  Then I got it completely wrong in my earlier mail; since U+2023
has a reference to U+25B8, the smaller one, this would rather plead for
using U+25C2, its sibling, as \blacktriangleleft.

> There are no black triangles in Cambria Math *at all*, it seems.

  Indeed, the U+25XX row is entitled ?Geometric Shapes? and is not
related to math.

	Arthur

From taco at elvenkind.com  Thu Jun 25 10:49:55 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 25 Jun 2009 10:49:55 +0200
Subject: [dev-context] MetaPost 1.204 announcement
Message-ID: <4A433A33.2070009@elvenkind.com>


The MetaPost team is happy to announce a new release of MetaPost:

----------------------------------------------------------------------
MetaPost 1.204
----------------------------------------------------------------------

The standalone distribution package and a win32 binary can be downloaded
immediately from

  http://foundry.supelec.fr/gf/project/metapost/

This release will also be available from CTAN soon, and it will be
included in the next TeXLive. The source package should compile normally
on all systems that are capable of compiling a modern web2c-based TeX
distribution.

The win32 binary is intended for texlive or a similar web2c-based
installation, this executable will *not* work for miktex.

Of course, we welcome any comments (either good or bad) that you may
have. Simply replying to this message is fine, but see the bottom of
the message for a more formal way to report bugs and feature requests.

----------------------------------------------------------------------
What is new in MetaPost version 1.204:
----------------------------------------------------------------------

* Metapost could go into an endless output loop when characters in
  bitmap fonts where used, because it tried to limit the %*Font output
  line to a specific number of bytes.

----------------------------------------------------------------------
Legal notice / license / bug reports
----------------------------------------------------------------------

MetaPost is a system for producing graphics developed by John Hobby
at AT&T, based on Donald Knuth's Metafont.  The MetaPost home page
is http://tug.org/metapost.

MetaPost is free software: you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

The MetaPost development project is currently hosted at Supelec,
http://foundry.supelec.fr/gf/project/metapost; please report bugs and
request enhancements through there if possible. Alternatively, you
can reach us through the <metapost at tug.org> mailing list as well.

Have fun!

Taco Hoekwater, for the MetaPost team, June 25, 2009.


From taco at elvenkind.com  Thu Jun 25 14:55:55 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 25 Jun 2009 14:55:55 +0200
Subject: [dev-context] Luatex beta 0.40.6
Message-ID: <4A4373DB.1060004@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.6 to the foundry server,
and have committed the source code to texlive.

What's new:

* Fix two string vs. toks bugs in the lua node interface:
  whatsit,annot and whatsit,startlink data assignments were
  made directly as strings instead of being converted to tokens.

* Sometimes pdf.print() could be used before the proper structures
  were initialized.

* There was a bug in the type codes for the lua package filter
  callback: wrong extra info was passed to lua for the alignment
  and vsplit cases.

* The math parameters \Umathlimitdownvgap, \Umathlimitdownbgap,
  and \Umathlimitdownkern have been renamed to \Umathlimitbelowbgap,
  \Umathlimitbelowvgap, and \Umathlimitbelowkern to be more
  consistent with the other parameter names.

* The embedded MPlib is now 1.204.

* Handling of UTF-8 hyphenation exceptions has been fixed.

* There were a number of typos in the manual.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.40.6

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From taco at elvenkind.com  Mon Jul 13 11:11:06 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 13 Jul 2009 11:11:06 +0200
Subject: [dev-context] MetaPost 1.205 announcement
Message-ID: <4A5AFA2A.4010506@elvenkind.com>


The MetaPost team is happy to announce a new release of MetaPost:

----------------------------------------------------------------------
MetaPost 1.205
----------------------------------------------------------------------

The standalone distribution package and a win32 binary can be downloaded
immediately from

  http://foundry.supelec.fr/gf/project/metapost/

This release will also be available from CTAN soon, and it will be
included in the next TeXLive. The source package should compile normally
on all systems that are capable of compiling a modern web2c-based TeX
distribution.

The win32 binary is intended for texlive or a similar web2c-based
installation, this executable will *not* work for miktex.

Of course, we welcome any comments (either good or bad) that you may
have. Simply replying to this message is fine, but see the bottom of
the message for a more formal way to report bugs and feature requests.

----------------------------------------------------------------------
What is new in MetaPost version 1.205:
----------------------------------------------------------------------

* Metapost did not handle well files with extensions other than .mp.

----------------------------------------------------------------------
Legal notice / license / bug reports
----------------------------------------------------------------------

MetaPost is a system for producing graphics developed by John Hobby
at AT&T, based on Donald Knuth's Metafont.  The MetaPost home page
is http://tug.org/metapost.

MetaPost is free software: you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

The MetaPost development project is currently hosted at Supelec,
http://foundry.supelec.fr/gf/project/metapost; please report bugs and
request enhancements through there if possible. Alternatively, you
can reach us through the <metapost at tug.org> mailing list as well.

Have fun!

Taco Hoekwater, for the MetaPost team, July 13, 2009.



From atl at comp.lancs.ac.uk  Tue Jul 14 11:56:39 2009
From: atl at comp.lancs.ac.uk (Adam Lindsay)
Date: Tue, 14 Jul 2009 10:56:39 +0100
Subject: [dev-context] thecontextbook.com
Message-ID: <4A5C5657.6060207@comp.lancs.ac.uk>

Hi all,

My domain "thecontextbook.com" is coming up for renewal *very* soon (the 
17th). Is there anyone in the community I can transfer it to so that it 
might get some public usage?

I'm fond of the idea of the domain, but life and competing projects have 
just gotten in the way of pushing that idea forward in my foreseeable 
future.

Hope all is well,
adam
http://twitter.com/atl
http://atl.me

From taco at elvenkind.com  Fri Jul 17 12:31:56 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 17 Jul 2009 12:31:56 +0200
Subject: [dev-context] Luatex 0.42.0 (a snapshot release)
Message-ID: <4A60531C.20502@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.42.0.

NOTE: This snapshot is just for testing the new sources and the
updated build process, do NOT trust this binary for production work!


There is a whole lot of work done on the luatex internals since the
previous beta, and just judging by the amount of work done it seems
likely that there will be a few serious bugs remaining. There are two
big internal changes. Both changes are invisible to the user, but
definately worth mentioning:

* There is no pascal (web) code in luatex at all anymore, everything
  is now converted into plain C and split over about 50 source files.
  Later, this code will be converted back to CWEB (almost all comments
  have been kept) but first we want to spend a few months reorganizing
  the code base.

* The PDF backend has been reorganized a lot, and most of the global
  variables are not put into a single backend structure. Work in this
  area is not complete, but getting there.


The other newsworthy changes are:

* There is a new node.tail() function

* lua-loaded fonts now support a 'nomath' key to speed up
  loading the lua table.

* A bugfix in the ttf reader for the inclusion backend, and
  (also in the backend) support for treating ttc files by
  pretending they are single ttf fonts (both patches from pdftex)

* Add Khaled Hosny's man page to the repository

* The \pdfcompresslevel is now effectively fixed as soon as
  output to the pdf file has occurred.

* Patched status.filename so that it (nearly) always returns a
  file name.

* fix '\the\delcode' and disable '\the\odelcode', '\the\Udelcode',
  and '\the\Udelcodenum'

* Handle jfifs where either xres or yres is 0 and the other
  res is != 0 (from pdftex)

* The single-argument version of lang.hyphenate() was broken.

* Get rid of the \directlua/\latelua number warning.

* The Lua coroutine patch (coco) is now disabled on linux
  powerpc architectures (because it caused crashes)

* Removed obsolete pdftex primitives:
  \pdfoptionalwaysusepdfpagebox
  \pdfoptionpdfinclusionerrorlevel
  \pdfforcepagebox
  \pdfmovechars

* The loading speed of large fonts (especially ttf) via the
  fontloader library, and the inclusion speed for subsetting
  in the backend have both been improved.

* The 'pdf' lua library has been enhanced with various new
  functions, see the manual for details.

* BLT and BRT glyph position fixed.

* Various fixes for synctex offsets.

* Support for exotic font string encodings has been removed
  from the fontloader library.

* The embedded MPlib is now 1.205.

* libpng is now 1.2.38.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/0.42.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From schuster.wolfgang at googlemail.com  Sun Jul 19 10:05:46 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 19 Jul 2009 10:05:46 +0200
Subject: [dev-context] processing comma/assignmentlist
Message-ID: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>

Hi,

there are two macros I miss there (for the moment) in ConTeXt

1. \startprocesscommacommand/\stopprocesscommacommand equivalent to
    \startprocesscommalist/\stopprocesscommalist from cont-new.tex

2. A command to access the keys and labels of a assignment list at  
user level, e.g.

    \def\myassignmentlist[#1]%
      {\def\dosomethingwithkeyandvalue##1##2##3{... ##2 ... ##3}% ##1  
= namespace (not used here)
       \dogetparameter\dosomethingwithkeyandvalue[...][#1]}

    \myassignmentlist[..,..=..,..=..]

Wolfgang


From pragma at wxs.nl  Sun Jul 19 13:09:16 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 19 Jul 2009 13:09:16 +0200
Subject: [dev-context] processing comma/assignmentlist
In-Reply-To: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>
References: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>
Message-ID: <4A62FEDC.7060100@wxs.nl>

Wolfgang Schuster wrote:
> Hi,
> 
> there are two macros I miss there (for the moment) in ConTeXt
> 
> 1. \startprocesscommacommand/\stopprocesscommacommand equivalent to
>    \startprocesscommalist/\stopprocesscommalist from cont-new.tex

ok, i added that one and moved this code to syst modules

> 2. A command to access the keys and labels of a assignment list at user 
> level, e.g.
> 
>    \def\myassignmentlist[#1]%
>      {\def\dosomethingwithkeyandvalue##1##2##3{... ##2 ... ##3}% ##1 = 
> namespace (not used here)
>       \dogetparameter\dosomethingwithkeyandvalue[...][#1]}
> 
>    \myassignmentlist[..,..=..,..=..]

is this the best name? maybe

\getmyparameters[a=1,b=]\handler

(or \getmyparameters\handler [a=1,b=])




-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Sun Jul 19 13:16:07 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 19 Jul 2009 13:16:07 +0200
Subject: [dev-context] processing comma/assignmentlist
In-Reply-To: <4A62FEDC.7060100@wxs.nl>
References: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>
	<4A62FEDC.7060100@wxs.nl>
Message-ID: <64C11DF5-AE4E-4A99-AC8B-15755D8BE70B@gmail.com>


Am 19.07.2009 um 13:09 schrieb Hans Hagen:

>> 2. A command to access the keys and labels of a assignment list at  
>> user level, e.g.
>>   \def\myassignmentlist[#1]%
>>     {\def\dosomethingwithkeyandvalue##1##2##3{... ##2 ... ##3}% ##1  
>> = namespace (not used here)
>>      \dogetparameter\dosomethingwithkeyandvalue[...][#1]}
>>   \myassignmentlist[..,..=..,..=..]
>
> is this the best name? maybe
>
> \getmyparameters[a=1,b=]\handler
>
> (or \getmyparameters\handler [a=1,b=])

This was only a example where I needed a command name but I don't know  
if I really need
such a function, I rewrote my macro now and \getparameter seems to be  
sufficient.

Wolfgang


From schuster.wolfgang at googlemail.com  Sun Jul 19 19:30:39 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 19 Jul 2009 19:30:39 +0200
Subject: [dev-context] processing comma/assignmentlist
In-Reply-To: <4A62FEDC.7060100@wxs.nl>
References: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>
	<4A62FEDC.7060100@wxs.nl>
Message-ID: <3F5853F5-B127-4517-A2C7-E92D20DAA37A@gmail.com>


Am 19.07.2009 um 13:09 schrieb Hans Hagen:

>> 2. A command to access the keys and labels of a assignment list at  
>> user level, e.g.
>> \def\myassignmentlist[#1]%
>>   {\def\dosomethingwithkeyandvalue##1##2##3{... ##2 ... ##3}% ##1 =  
>> namespace (not used here)
>>    \dogetparameter\dosomethingwithkeyandvalue[...][#1]}
>> \myassignmentlist[..,..=..,..=..]
>
> is this the best name? maybe
>
> \getmyparameters[a=1,b=]\handler

Looks good but in the form

\processassignmentlist[a=1,b=2,...]\docommand

and (as equivalent to \processcommacommand)

\processassignmentcommand[\mylist]\docommand

where \docommand is defined as

\def\docommand#1#2{...} % #1 = key, #2 = value

Wolfgang


From mojca.miklavec.lists at gmail.com  Mon Jul 20 17:05:08 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 20 Jul 2009 17:05:08 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
Message-ID: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>

With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
errors that follow)

! Undefined control sequence.
\pgfutil at addpdfresource@colorspaces ...olorspaces
                                                  {#1}
l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }

?

I don't know if that's a problem with TikZ or ConTeXt (no time to
debug now, but maybe I can try to prepare some minimal example that
fails; later). ConTeXt MKII works fine on the same document.

Mojca

From adityam at umich.edu  Mon Jul 20 17:38:55 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Mon, 20 Jul 2009 11:38:55 -0400 (EDT)
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.0907201135570.15108@ybpnyubfg.ybpnyqbznva>

On Mon, 20 Jul 2009, Mojca Miklavec wrote:

> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
> errors that follow)
>
> ! Undefined control sequence.
> \pgfutil at addpdfresource@colorspaces ...olorspaces
>                                                  {#1}
> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
>
> ?
>
> I don't know if that's a problem with TikZ or ConTeXt (no time to
> debug now, but maybe I can try to prepare some minimal example that
> fails; later). ConTeXt MKII works fine on the same document.

A minimal (or even not so minimal) example will surely help. If it is 
something on the ConTeXt side, we can add it to the mkii compatibility 
module, m-mkii.mkiv.

Also, which version of tikz are you using?

Aditya


From pragma at wxs.nl  Mon Jul 20 17:46:35 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 20 Jul 2009 17:46:35 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
Message-ID: <4A64915B.5010909@wxs.nl>

Mojca Miklavec wrote:
> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
> errors that follow)
> 
> ! Undefined control sequence.
> \pgfutil at addpdfresource@colorspaces ...olorspaces
>                                                   {#1}
> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
> 
> ?
> 
> I don't know if that's a problem with TikZ or ConTeXt (no time to
> debug now, but maybe I can try to prepare some minimal example that
> fails; later). ConTeXt MKII works fine on the same document.

this has to do with the fact that tikz manipulates documents resources

it probably went unnnoticed in previous mkiv and mkii, but that way tikz 
was obscuring regular context resource handling (i.e. when you use mp an 
tikz mixed one of them wins with respect to resources so the other 
kind's graphics fail to view i.e. shades, transparencies, etc)

therefore in mkiv all access is shielded and goes via special macros:

\pdfbackendsetextgstate {name}{legal pdf}
\pdfbackendsetcolorspace{name}{legal pdf}
\pdfbackendsetpattern   {name}{legal pdf}
\pdfbackendsetshade     {name}{legal pdf}

normal "legal pdf" is a reference like 123 0 R

If more access is needed, i can add it but it will always go via an 
interface as in mkiv most \pdfcommands are going away.

So, tikz needs to be adapted to this. A few weeks ago I looked at it but 
found out that i had an old version so delayed it.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Mon Jul 20 17:49:05 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 20 Jul 2009 17:49:05 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <alpine.LNX.2.00.0907201135570.15108@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
	<alpine.LNX.2.00.0907201135570.15108@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A6491F1.7000101@wxs.nl>

Aditya Mahajan wrote:
> On Mon, 20 Jul 2009, Mojca Miklavec wrote:
> 
>> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
>> errors that follow)
>>
>> ! Undefined control sequence.
>> \pgfutil at addpdfresource@colorspaces ...olorspaces
>>                                                  {#1}
>> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
>>
>> ?
>>
>> I don't know if that's a problem with TikZ or ConTeXt (no time to
>> debug now, but maybe I can try to prepare some minimal example that
>> fails; later). ConTeXt MKII works fine on the same document.
> 
> A minimal (or even not so minimal) example will surely help. If it is 
> something on the ConTeXt side, we can add it to the mkii compatibility 
> module, m-mkii.mkiv.

probably only a few lines patch in some of the tikz context files is needed

indeed having a sample + the latest version helps (the problem is that i 
  normally keep all tex stuff in my main texlive tree, and only updates 
that once per year as it is some reference)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Mon Jul 20 18:18:45 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 20 Jul 2009 18:18:45 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <4A6491F1.7000101@wxs.nl>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
	<alpine.LNX.2.00.0907201135570.15108@ybpnyubfg.ybpnyqbznva>
	<4A6491F1.7000101@wxs.nl>
Message-ID: <6faad9f00907200918p612aef4fg1f57392bfe63dd15@mail.gmail.com>

On Mon, Jul 20, 2009 at 17:49, Hans Hagen wrote:
> Aditya Mahajan wrote:
>>
>> On Mon, 20 Jul 2009, Mojca Miklavec wrote:
>>
>>> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
>>> errors that follow)
>>>
>>> ! Undefined control sequence.
>>> \pgfutil at addpdfresource@colorspaces ...olorspaces
>>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? {#1}
>>> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
>>>
>>> ?
>>>
>>> I don't know if that's a problem with TikZ or ConTeXt (no time to
>>> debug now, but maybe I can try to prepare some minimal example that
>>> fails; later). ConTeXt MKII works fine on the same document.
>>
>> A minimal (or even not so minimal) example will surely help. If it is
>> something on the ConTeXt side, we can add it to the mkii compatibility
>> module, m-mkii.mkiv.
>
> probably only a few lines patch in some of the tikz context files is needed
>
> indeed having a sample + the latest version helps (the problem is that i
> ?normally keep all tex stuff in my main texlive tree, and only updates that
> once per year as it is some reference)

Not sure if minimal example is needed: I suspect that almost anything breaks ...

\usemodule[tikz]
\starttext
\starttikzpicture
\fill[gray] (1,1) rectangle +(1,1);
\stoptikzpicture
\stoptext

TikZ gets updated on regular basis from CVS. I cannot say which
version exactly I'm using (how do I check that easily?), but ChangeLog
mentions "2009-07-08" as the latest entry. I suspect that recent
changes in MKIV broke functionality, not recent changes in TikZ
itself.

To Hans (and Till Tantau as well): you can get the latest version with
--extras=t-tikz in ConTeXt minimals (that's what I am using).

I just wanted to check if sectioning has been fixed, but I didn't
manage to compile the document at all (later on there were some other
problems). Starting with
    ! Math error: parameter \Umathquad\displaystyle is not set.
and going to infinity ... :) If that means that I need a more recent
version of LuaTeX then I'm not going to try it out now.

Mojca

From mojca.miklavec.lists at gmail.com  Mon Jul 20 18:24:52 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Mon, 20 Jul 2009 18:24:52 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <6faad9f00907200918p612aef4fg1f57392bfe63dd15@mail.gmail.com>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
	<alpine.LNX.2.00.0907201135570.15108@ybpnyubfg.ybpnyqbznva>
	<4A6491F1.7000101@wxs.nl>
	<6faad9f00907200918p612aef4fg1f57392bfe63dd15@mail.gmail.com>
Message-ID: <6faad9f00907200924i190eb5f3s13cafdb67d9d0d87@mail.gmail.com>

Pgfplots also seem to be broken (loading the module is enough to
trigger the error), but that's also broken in MKII. That needs to be
fixed by the author and I think that the problem is unrelated.

Mojca

From pragma at wxs.nl  Mon Jul 20 19:43:29 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 20 Jul 2009 19:43:29 +0200
Subject: [dev-context] processing comma/assignmentlist
In-Reply-To: <3F5853F5-B127-4517-A2C7-E92D20DAA37A@gmail.com>
References: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>
	<4A62FEDC.7060100@wxs.nl>
	<3F5853F5-B127-4517-A2C7-E92D20DAA37A@gmail.com>
Message-ID: <4A64ACC1.50203@wxs.nl>

Wolfgang Schuster wrote:
> 
> Am 19.07.2009 um 13:09 schrieb Hans Hagen:
> 
>>> 2. A command to access the keys and labels of a assignment list at 
>>> user level, e.g.
>>> \def\myassignmentlist[#1]%
>>>   {\def\dosomethingwithkeyandvalue##1##2##3{... ##2 ... ##3}% ##1 = 
>>> namespace (not used here)
>>>    \dogetparameter\dosomethingwithkeyandvalue[...][#1]}
>>> \myassignmentlist[..,..=..,..=..]
>>
>> is this the best name? maybe
>>
>> \getmyparameters[a=1,b=]\handler
> 
> Looks good but in the form
> 
> \processassignmentlist[a=1,b=2,...]\docommand
> 
> and (as equivalent to \processcommacommand)
> 
> \processassignmentcommand[\mylist]\docommand
> 
> where \docommand is defined as
> 
> \def\docommand#1#2{...} % #1 = key, #2 = value
> 

i added

\def\processassignmentlist[#1]#2% #2 == \command{key}{value]
   {\def\doprocessassignmententry##1{#2}% {##2}{##3} % namespace is ignored
    \dogetparameters\doprocessassignmententry[][#1]}

\def\processassignmentcommand[#1]%
   {\normalexpanded{\noexpand\processassignmentlist[][#1]}}


test case:

\def\showpair#1#2{key:#1, value:#2\par}

\processassignmentlist[a=1,b=2]\showpair




-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Mon Jul 20 19:58:05 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Mon, 20 Jul 2009 19:58:05 +0200
Subject: [dev-context] appendtoks / csname
Message-ID: <6EE99909-514B-45F8-941E-665A1200AA84@gmail.com>

Hi,

I look for a convient way to use \appendtoks with a token list
which is accessed with \csname ... \endcsname, e.g.

   \appendtoks <something> \to\csname <mytoks>\endcsname


This works when I enclose the \csname/\endcsname pair in braces

   \appendtoks <something> \to{\csname <mytoks>\endcsname}

but this did not look very pleasant to my eyes.


I thought something similar to \addvalue would be nice

   \addtoks{<mytoks>}{<something>}

Wolfgang


From schuster.wolfgang at googlemail.com  Mon Jul 20 20:10:11 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Mon, 20 Jul 2009 20:10:11 +0200
Subject: [dev-context] processing comma/assignmentlist
In-Reply-To: <4A64ACC1.50203@wxs.nl>
References: <68865276-5FA4-4135-B0CA-7BA2DEF5A6AB@gmail.com>
	<4A62FEDC.7060100@wxs.nl>
	<3F5853F5-B127-4517-A2C7-E92D20DAA37A@gmail.com>
	<4A64ACC1.50203@wxs.nl>
Message-ID: <0011F92E-0645-4910-8733-CB94C1C44299@gmail.com>


Am 20.07.2009 um 19:43 schrieb Hans Hagen:

> i added

thank you very much :)

> \def\processassignmentcommand[#1]%
>  {\normalexpanded{\noexpand\processassignmentlist[][#1]}}

the empty bracket pair here is wrong

Wolfgang


From pragma at wxs.nl  Mon Jul 20 22:35:48 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 20 Jul 2009 22:35:48 +0200
Subject: [dev-context] appendtoks / csname
In-Reply-To: <6EE99909-514B-45F8-941E-665A1200AA84@gmail.com>
References: <6EE99909-514B-45F8-941E-665A1200AA84@gmail.com>
Message-ID: <4A64D524.6090709@wxs.nl>

Wolfgang Schuster wrote:
> Hi,
> 
> I look for a convient way to use \appendtoks with a token list
> which is accessed with \csname ... \endcsname, e.g.
> 
>   \appendtoks <something> \to\csname <mytoks>\endcsname
> 
> 
> This works when I enclose the \csname/\endcsname pair in braces
> 
>   \appendtoks <something> \to{\csname <mytoks>\endcsname}
> 
> but this did not look very pleasant to my eyes.
> 
> 
> I thought something similar to \addvalue would be nice
> 
>   \addtoks{<mytoks>}{<something>}

actually, i'm considering an extra set but with a different syntax, like

\appendtotoks\name{...} which sometimes saves passing an argument

but there is some trickery in the current macros that keeps {} that 
needs to be preserved; also, on the luatex agenda is an append primitive 
so we need to cleanup this bit anyway

i'll give it a thought

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From peter.rolf at arcor.de  Tue Jul 21 14:20:51 2009
From: peter.rolf at arcor.de (Peter Rolf)
Date: Tue, 21 Jul 2009 14:20:51 +0200
Subject: [dev-context] messy PDF (mkiv)
Message-ID: <4A65B2A3.6060408@arcor.de>

Hi,

while debugging I found some minor problems in the produced PDF code. 
There is a bug in one of the /Catalog entries (/PageLayout /auto). The 
other problems are more of cosmetic nature (only one harmless bug).

The PDF for the attached example

- contains 4 totally empty and *unreferenced* dictionaries (obj 5-8)
 
(only cosmetic)
- obj 11 is questionable
  (but I can't read the PS function code, so maybe it makes sense somehow)

(only cosmetic)
- obj 20 (/JavaScript) is referring to an empty /Names dictionary;
  should only be added if there is JS in the document

And that's all for the moment (more to come with other example) :)


Best wishes, Peter


This is LuaTeX, Version beta-0.42.0-2009071821
MTXrun | current version: 2009.07.20 19:44

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: mp.tex
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090721/634f00c6/attachment.asc>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mp.pdf
Type: application/pdf
Size: 2467 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090721/634f00c6/attachment.pdf>

From peter.rolf at arcor.de  Tue Jul 21 14:21:37 2009
From: peter.rolf at arcor.de (Peter Rolf)
Date: Tue, 21 Jul 2009 14:21:37 +0200
Subject: [dev-context] lpdf.dictionary
Message-ID: <4A65B2D1.9030100@arcor.de>

Hi Hans,

can you implement *ordered* output with 'lpdf.dictionary'? There are two 
reasons why I ask.

- My md5 hashing mechanism depends on the order of the entries. I think 
its much easier to implement an ordered output than to create a hashing 
mechanism, that checks for equal content. I also doubt, that there is a 
faster alternative for this job than md5.
- Also debugging is a pain with longer dictionaries (I have to use a 
check list).


Best wishes, Peter

From pragma at wxs.nl  Tue Jul 21 23:16:52 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 21 Jul 2009 23:16:52 +0200
Subject: [dev-context] lpdf.dictionary
In-Reply-To: <4A65B2D1.9030100@arcor.de>
References: <4A65B2D1.9030100@arcor.de>
Message-ID: <4A663044.6060002@wxs.nl>

Peter Rolf wrote:
> Hi Hans,
> 
> can you implement *ordered* output with 'lpdf.dictionary'? There are two 
> reasons why I ask.
> 
> - My md5 hashing mechanism depends on the order of the entries. I think 
> its much easier to implement an ordered output than to create a hashing 
> mechanism, that checks for equal content. I also doubt, that there is a 
> faster alternative for this job than md5.
> - Also debugging is a pain with longer dictionaries (I have to use a 
> check list).

as the dictionary is a hash, ordering would imply way more overhead than 
i'm willing to accept so why not use the serialized stream as hash, ie. 
just d() given that d is a dictionary; there is no gain in an md5

i might provide a 'shared object' mechanism in the lpdf code (i 
considered it for some mechanisms)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Jul 21 23:27:25 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 21 Jul 2009 23:27:25 +0200
Subject: [dev-context] messy PDF (mkiv)
In-Reply-To: <4A65B2A3.6060408@arcor.de>
References: <4A65B2A3.6060408@arcor.de>
Message-ID: <4A6632BD.9060008@wxs.nl>

Peter Rolf wrote:
> Hi,
> 
> while debugging I found some minor problems in the produced PDF code. 
> There is a bug in one of the /Catalog entries (/PageLayout /auto). The 
> other problems are more of cosmetic nature (only one harmless bug).

example ...

> The PDF for the attached example
> 
> - contains 4 totally empty and *unreferenced* dictionaries (obj 5-8)
> 
> (only cosmetic)
> - obj 11 is questionable
>  (but I can't read the PS function code, so maybe it makes sense somehow)

indeed, as i use forward references the only way to get rid of them is 
to use multipass data which then demands an extra run (nearly always as 
object numbers get changed.

as pdf files have soms slack anyway this is a small price for saving a run

> (only cosmetic)
> - obj 20 (/JavaScript) is referring to an empty /Names dictionary;
>  should only be added if there is JS in the document

again, it's a foward reference

> And that's all for the moment (more to come with other example) :)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From adityam at umich.edu  Wed Jul 22 02:05:02 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Tue, 21 Jul 2009 20:05:02 -0400 (EDT)
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <4A64915B.5010909@wxs.nl>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
	<4A64915B.5010909@wxs.nl>
Message-ID: <alpine.LNX.2.00.0907211943500.22956@ybpnyubfg.ybpnyqbznva>

On Mon, 20 Jul 2009, Hans Hagen wrote:

> Mojca Miklavec wrote:
>> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
>> errors that follow)
>> 
>> ! Undefined control sequence.
>> \pgfutil at addpdfresource@colorspaces ...olorspaces
>>                                                   {#1}
>> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
>> 
>> ?
>> 
>> I don't know if that's a problem with TikZ or ConTeXt (no time to
>> debug now, but maybe I can try to prepare some minimal example that
>> fails; later). ConTeXt MKII works fine on the same document.
>
> this has to do with the fact that tikz manipulates documents resources
>
> it probably went unnnoticed in previous mkiv and mkii, but that way tikz was 
> obscuring regular context resource handling (i.e. when you use mp an tikz 
> mixed one of them wins with respect to resources so the other kind's graphics 
> fail to view i.e. shades, transparencies, etc)
>
> therefore in mkiv all access is shielded and goes via special macros:
>
> \pdfbackendsetextgstate {name}{legal pdf}
> \pdfbackendsetcolorspace{name}{legal pdf}
> \pdfbackendsetpattern   {name}{legal pdf}
> \pdfbackendsetshade     {name}{legal pdf}
>
> normal "legal pdf" is a reference like 123 0 R
>
> If more access is needed, i can add it but it will always go via an interface 
> as in mkiv most \pdfcommands are going away.
>
> So, tikz needs to be adapted to this. A few weeks ago I looked at it but 
> found out that i had an old version so delayed it.

I am using the latest context minimals with latest tikz.

Test file:

\logginall
\usemodule[tikz]
\starttext
\input knuth
\stoptext


The log file says

\pgfutil at addpdfresource@colorspaces #1->\appendtoPDFdocumentcolorspaces 
{#1}
#1<- /pgfprgb [/Pattern /DeviceRGB]
{undefined}

So, \appendtoPDFdocumentcolorspaces is undefined.

Now, \append...colorspaces is defined in back-pdf.tex which AFAIU that 
file is not loaded. It is redefined in spec-fdf.mkii, so mkii uses that 
defininition. In mkiv, back-pdf.mkiv defines \pdfbackendsetcolorspace.

So, which command should tikz use so that it works with both mkii and 
mkiv. Or should it do a \beginLUATEX redefinition of some macros for mkiv?
The relavant tikz file is tex/generic/pgf/pgfutil-context.def so the 
changes there will not affect latex.

Aditya

From pragma at wxs.nl  Wed Jul 22 10:01:12 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 22 Jul 2009 10:01:12 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <alpine.LNX.2.00.0907211943500.22956@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>
	<4A64915B.5010909@wxs.nl>
	<alpine.LNX.2.00.0907211943500.22956@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A66C748.3090004@wxs.nl>

Aditya Mahajan wrote:
> On Mon, 20 Jul 2009, Hans Hagen wrote:
> 
>> Mojca Miklavec wrote:
>>> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
>>> errors that follow)
>>>
>>> ! Undefined control sequence.
>>> \pgfutil at addpdfresource@colorspaces ...olorspaces
>>>                                                   {#1}
>>> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
>>>
>>> ?
>>>
>>> I don't know if that's a problem with TikZ or ConTeXt (no time to
>>> debug now, but maybe I can try to prepare some minimal example that
>>> fails; later). ConTeXt MKII works fine on the same document.
>>
>> this has to do with the fact that tikz manipulates documents resources
>>
>> it probably went unnnoticed in previous mkiv and mkii, but that way 
>> tikz was obscuring regular context resource handling (i.e. when you 
>> use mp an tikz mixed one of them wins with respect to resources so the 
>> other kind's graphics fail to view i.e. shades, transparencies, etc)
>>
>> therefore in mkiv all access is shielded and goes via special macros:
>>
>> \pdfbackendsetextgstate {name}{legal pdf}
>> \pdfbackendsetcolorspace{name}{legal pdf}
>> \pdfbackendsetpattern   {name}{legal pdf}
>> \pdfbackendsetshade     {name}{legal pdf}
>>
>> normal "legal pdf" is a reference like 123 0 R
>>
>> If more access is needed, i can add it but it will always go via an 
>> interface as in mkiv most \pdfcommands are going away.
>>
>> So, tikz needs to be adapted to this. A few weeks ago I looked at it 
>> but found out that i had an old version so delayed it.
> 
> I am using the latest context minimals with latest tikz.
> 
> Test file:
> 
> \logginall
> \usemodule[tikz]
> \starttext
> \input knuth
> \stoptext
> 
> 
> The log file says
> 
> \pgfutil at addpdfresource@colorspaces #1->\appendtoPDFdocumentcolorspaces 
> {#1}
> #1<- /pgfprgb [/Pattern /DeviceRGB]
> {undefined}

hm, my logfile says nothing

> So, \appendtoPDFdocumentcolorspaces is undefined.
> 
> Now, \append...colorspaces is defined in back-pdf.tex which AFAIU that 
> file is not loaded. It is redefined in spec-fdf.mkii, so mkii uses that 
> defininition. In mkiv, back-pdf.mkiv defines \pdfbackendsetcolorspace.
> 
> So, which command should tikz use so that it works with both mkii and 
> mkiv. Or should it do a \beginLUATEX redefinition of some macros for mkiv?
> The relavant tikz file is tex/generic/pgf/pgfutil-context.def so the 
> changes there will not affect latex.

something

\ifnum\texengine=\luatexengine
   \pdfbackendsetcolorspace{pgfprgb}{[/Pattern /DeviceRGB]}%
\else
   \appendtoPDFdocumentcolorspaces{/pgfprgb [/Pattern /DeviceRGB]}%
\fi

but i didn't test it


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Wed Jul 22 11:30:39 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 22 Jul 2009 11:30:39 +0200
Subject: [dev-context] problem with TikZ & ConTeXt MKIV
In-Reply-To: <4A66C748.3090004@wxs.nl>
References: <6faad9f00907200805l4651907eq9a9fe6cca892c978@mail.gmail.com>	<4A64915B.5010909@wxs.nl>	<alpine.LNX.2.00.0907211943500.22956@ybpnyubfg.ybpnyqbznva>
	<4A66C748.3090004@wxs.nl>
Message-ID: <4A66DC3F.1000700@wxs.nl>

Hans Hagen wrote:
> Aditya Mahajan wrote:
>> On Mon, 20 Jul 2009, Hans Hagen wrote:
>>
>>> Mojca Miklavec wrote:
>>>> With 2009.07.20 09:35 MKIV & latest TikZ I get (among many other
>>>> errors that follow)
>>>>
>>>> ! Undefined control sequence.
>>>> \pgfutil at addpdfresource@colorspaces ...olorspaces
>>>>                                                   {#1}
>>>> l.396 ...rspaces{ /pgfprgb [/Pattern /DeviceRGB] }
>>>>
>>>> ?
>>>>
>>>> I don't know if that's a problem with TikZ or ConTeXt (no time to
>>>> debug now, but maybe I can try to prepare some minimal example that
>>>> fails; later). ConTeXt MKII works fine on the same document.
>>>
>>> this has to do with the fact that tikz manipulates documents resources
>>>
>>> it probably went unnnoticed in previous mkiv and mkii, but that way 
>>> tikz was obscuring regular context resource handling (i.e. when you 
>>> use mp an tikz mixed one of them wins with respect to resources so 
>>> the other kind's graphics fail to view i.e. shades, transparencies, etc)
>>>
>>> therefore in mkiv all access is shielded and goes via special macros:
>>>
>>> \pdfbackendsetextgstate {name}{legal pdf}
>>> \pdfbackendsetcolorspace{name}{legal pdf}
>>> \pdfbackendsetpattern   {name}{legal pdf}
>>> \pdfbackendsetshade     {name}{legal pdf}
>>>
>>> normal "legal pdf" is a reference like 123 0 R
>>>
>>> If more access is needed, i can add it but it will always go via an 
>>> interface as in mkiv most \pdfcommands are going away.
>>>
>>> So, tikz needs to be adapted to this. A few weeks ago I looked at it 
>>> but found out that i had an old version so delayed it.
>>
>> I am using the latest context minimals with latest tikz.
>>
>> Test file:
>>
>> \logginall
>> \usemodule[tikz]
>> \starttext
>> \input knuth
>> \stoptext
>>
>>
>> The log file says
>>
>> \pgfutil at addpdfresource@colorspaces 
>> #1->\appendtoPDFdocumentcolorspaces {#1}
>> #1<- /pgfprgb [/Pattern /DeviceRGB]
>> {undefined}
> 
> hm, my logfile says nothing
> 
>> So, \appendtoPDFdocumentcolorspaces is undefined.
>>
>> Now, \append...colorspaces is defined in back-pdf.tex which AFAIU that 
>> file is not loaded. It is redefined in spec-fdf.mkii, so mkii uses 
>> that defininition. In mkiv, back-pdf.mkiv defines 
>> \pdfbackendsetcolorspace.
>>
>> So, which command should tikz use so that it works with both mkii and 
>> mkiv. Or should it do a \beginLUATEX redefinition of some macros for 
>> mkiv?
>> The relavant tikz file is tex/generic/pgf/pgfutil-context.def so the 
>> changes there will not affect latex.
> 
> something
> 
> \ifnum\texengine=\luatexengine
>   \pdfbackendsetcolorspace{pgfprgb}{[/Pattern /DeviceRGB]}%
> \else
>   \appendtoPDFdocumentcolorspaces{/pgfprgb [/Pattern /DeviceRGB]}%
> \fi
> 
> but i didn't test it

i tried to locate the relevant code but as not all context specific code 
sits in the context subdir i give up (Till probably can fix it way faster)

The following code at least gets the resource pointers in the file 
(works with beta on the website) but the objects that are refered to are 
not saved in the file

\def\dopgf at sys@pdf at addtopageresources@extgs   /#1 
#2\relax{\pdfbackendsetextgstate{#1}{#2}}
\def\dopgf at sys@pdf at addtopageresources@patterns/#1 
#2\relax{\pdfbackendsetpattern  {#1}{#2}}

\def\pgf at sys@pdf at addtopageresources@extgs 
#1{\normalexpanded{\noexpand\dopgf at sys@pdf at addtopageresources@extgs 
#1\relax}}
\def\pgf at sys@pdf at addtopageresources@patterns#1{\normalexpanded{\noexpand\dopgf at sys@pdf at addtopageresources@patterns#1\relax}}

the two step is needed because \pdfbackendsetextgstate expects two 
arguments (in principle shades can also be dealt with but tikz keeps 
them local to the xform so there is no problem there)

i tested with:

\starttext

\usetikzlibrary{patterns}

\starttikzpicture
     \draw[pattern color=red,pattern=bricks] (0,0) circle (1cm);
\stoptikzpicture

\stoptext


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Tue Aug  4 15:21:51 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 04 Aug 2009 15:21:51 +0200
Subject: [dev-context] Test message
Message-ID: <4A7835EF.1000608@elvenkind.com>

Sorry, please ignore

From schuster.wolfgang at googlemail.com  Wed Aug  5 23:49:55 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Wed, 5 Aug 2009 23:49:55 +0200
Subject: [dev-context] A few questions
Message-ID: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>

Hi Hans,

here are a few questions which I want to ask since a few days.


1. texdefinition

I like start/stoptexdefinition because it makes the source for certain  
macros more readable
than \def allows me but is there a way to use it for macros without  
parameters?


2. commalists

Together with texdefinition I use now start/stopprocesscommalist  
(feature request: I need also
start/stopprocessassignmentlist) but I can use the list value without  
the need to define a command
where I specify what should happen with it

   \startprocesscommalist[a,b,c,...]
   the current list value is #1\par
   \stopprocesscommalist

but why is there not something equivalent for the normal  
processcommalist because the start/stop
method is not the best method when you need nested lists, something  
like this would be nice then
(I know \doprocesscommalist is already defined):

   \doprocesscommalist[a,b,c,...]%
     {\processcommalist[x,y,z,...]%
        {do something with #1 and ##1}}


3. setups

The various start/stopsetups environments another nice feature but  
what's the correct method when
I want my own setup environment, should I adapt the following line  
from core-env to my own command

   \def\startsetups     {\xxstartsetups\plusone  \stopsetups     } \let 
\stopsetups     \relax

and use method from lxml-ini to access/flush the content?


4. Mixed assignment/comma lists

Are mixed lists of normal comma elements and assignments are allowed  
by ConTeXt?s syntax because
there is a command in the source (\processassignlist) to process the  
non assignment values from
the list? On the other side these values generate a error message on  
the terminal where one can read
there is a missing '=' in the element and this message can't be  
disabled (without hacks).


Kind regards,
Wolfgang


From pragma at wxs.nl  Thu Aug  6 23:42:49 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 06 Aug 2009 23:42:49 +0200
Subject: [dev-context] A few questions
In-Reply-To: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
Message-ID: <4A7B4E59.2050905@wxs.nl>

Wolfgang Schuster wrote:
> Hi Hans,
> 
> here are a few questions which I want to ask since a few days.
> 
> 
> 1. texdefinition
> 
> I like start/stoptexdefinition because it makes the source for certain 
> macros more readable
> than \def allows me but is there a way to use it for macros without 
> parameters?

this works

\starttexdefinition test {}
oeps
\stoptexdefinition

[\test]


we can consider something like:

\starttexdefinition test optional,optional,argument,argument
oeps
\stoptexdefinition

which then becomes

\def\test[#1][#2]#3#4%

etc but i'm only willing to support that if we can stick to reasonable 
definitions

or even

\starttexdefinition test optional:ns,argument:name
oeps
\stoptexdefinition

which then automatically makes you a \getvariable{ns}{key} as well as \name

or maybe like xml:

\starttexdefinition test ns:optional,argument
oeps
\stoptexdefinition

with then makes an \getvariable{ns}{first} and so

needs a bit of thinking

> 2. commalists
> 
> Together with texdefinition I use now start/stopprocesscommalist 
> (feature request: I need also
> start/stopprocessassignmentlist) but I can use the list value without 
> the need to define a command
> where I specify what should happen with it
> 
>   \startprocesscommalist[a,b,c,...]
>   the current list value is #1\par
>   \stopprocesscommalist
> 
> but why is there not something equivalent for the normal 
> processcommalist because the start/stop
> method is not the best method when you need nested lists, something like 
> this would be nice then
> (I know \doprocesscommalist is already defined):
> 
>   \doprocesscommalist[a,b,c,...]%
>     {\processcommalist[x,y,z,...]%
>        {do something with #1 and ##1}}

hm, probably possible but not trivial (maybe not even robust) ... needs 
thinking (also a bit slower as we explicitly need a trick similar to the 
one used in dorecurse

> 
> 3. setups
> 
> The various start/stopsetups environments another nice feature but 
> what's the correct method when
> I want my own setup environment, should I adapt the following line from 
> core-env to my own command
> 
>   \def\startsetups     {\xxstartsetups\plusone  \stopsetups     } 
> \let\stopsetups     \relax
> 
> and use method from lxml-ini to access/flush the content?

you mean that you want to pass an argument to a setup? (mandate in 
xmlsetup)

> 4. Mixed assignment/comma lists
> 
> Are mixed lists of normal comma elements and assignments are allowed by 
> ConTeXt?s syntax because
> there is a command in the source (\processassignlist) to process the non 
> assignment values from
> the list? On the other side these values generate a error message on the 
> terminal where one can read
> there is a missing '=' in the element and this message can't be disabled 
> (without hacks).

yeah, a matter of choice ... we can drop the message if users don't mind

we shouldn't end up with too many variants and personally i don't like 
the mix (i.e. foo==yes can be used)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Fri Aug  7 11:46:27 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Fri, 7 Aug 2009 11:46:27 +0200
Subject: [dev-context] A few questions
In-Reply-To: <4A7B4E59.2050905@wxs.nl>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
Message-ID: <D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>


Am 06.08.2009 um 23:42 schrieb Hans Hagen:

>> 1. texdefinition
>> I like start/stoptexdefinition because it makes the source for  
>> certain macros more readable
>> than \def allows me but is there a way to use it for macros without  
>> parameters?
>
> this works
>
> \starttexdefinition test {}
> oeps
> \stoptexdefinition
>
> [\test]

not very nice and don't look pleasant to me

> we can consider something like:
>
> \starttexdefinition test optional,optional,argument,argument
> oeps
> \stoptexdefinition
>
> which then becomes
>
> \def\test[#1][#2]#3#4%
>
> etc but i'm only willing to support that if we can stick to  
> reasonable definitions
>
> or even
>
> \starttexdefinition test optional:ns,argument:name
> oeps
> \stoptexdefinition
>
> which then automatically makes you a \getvariable{ns}{key} as well  
> as \name
>
> or maybe like xml:
>
> \starttexdefinition test ns:optional,argument
> oeps
> \stoptexdefinition
>
> with then makes an \getvariable{ns}{first} and so
>
> needs a bit of thinking

i get the feeling we're moving towards latex3 (brr), before this  
happens drop the whole
thing and i don't like \getvariable in this context anyway

>> 2. commalists
>> Together with texdefinition I use now start/stopprocesscommalist  
>> (feature request: I need also
>> start/stopprocessassignmentlist) but I can use the list value  
>> without the need to define a command
>> where I specify what should happen with it
>>  \startprocesscommalist[a,b,c,...]
>>  the current list value is #1\par
>>  \stopprocesscommalist
>> but why is there not something equivalent for the normal  
>> processcommalist because the start/stop
>> method is not the best method when you need nested lists, something  
>> like this would be nice then
>> (I know \doprocesscommalist is already defined):
>>  \doprocesscommalist[a,b,c,...]%
>>    {\processcommalist[x,y,z,...]%
>>       {do something with #1 and ##1}}
>
> hm, probably possible but not trivial (maybe not even robust) ...  
> needs thinking (also a bit slower as we explicitly need a trick  
> similar to the one used in dorecurse

when the inner list is used inside of a group the following works

   \long\def\processcommalistwithcontent[#1]#2%
     {\def\currentcommalistcommand##1{#2}%
      \processcommalist[#1]\currentcommalistcommand}

   \processcommalistwithcontent[a,b,c] 
{{\processcommalistwithcontent[x,y,z]{This is subelement ##1 of  
element #1.\par}}}

but the extra pair of braces is kind of akward. Working without them  
is not the problem

   \newcount\commalistdepth

   \long\def\processcommalistwithcontent[#1]#2%
     {\advance\commalistdepth\plusone
      \long\expandafter\def\csname list:\number\commalistdepth 
\endcsname##1{#2}%
      \def\currentcommalistcommand{\csname list:\number\commalistdepth 
\endcsname}%
      \processcommalist[#1]\currentcommalistcommand
      \advance\commalistdepth\minusone}

   \processcommalistwithcontent[a,b,c] 
{\processcommalistwithcontent[x,y,z]{This is subelement ##1 of element  
#1.\par}}

but as you mentioned above some kind of check (depth counter) is needed.

>> 3. setups
>> The various start/stopsetups environments another nice feature but  
>> what's the correct method when
>> I want my own setup environment, should I adapt the following line  
>> from core-env to my own command
>>  \def\startsetups     {\xxstartsetups\plusone  \stopsetups     }  
>> \let\stopsetups     \relax
>> and use method from lxml-ini to access/flush the content?
>
> you mean that you want to pass an argument to a setup? (mandate in  
> xmlsetup)

yes, more or less what you do with xml in mkiv

   \startxmlsetups ...
   do this in that
   \xmlflush{#1}
   do more things
   \stopxmlsetups

in my games module for the input for chess, go ...

   \startpgnsetups move
   do a few things before the move
   \pgnflush{#1}
   do a few things after the move
   \stoppgnsetups

>> 4. Mixed assignment/comma lists
>> Are mixed lists of normal comma elements and assignments are  
>> allowed by ConTeXt?s syntax because
>> there is a command in the source (\processassignlist) to process  
>> the non assignment values from
>> the list? On the other side these values generate a error message  
>> on the terminal where one can read
>> there is a missing '=' in the element and this message can't be  
>> disabled (without hacks).
>
> yeah, a matter of choice ... we can drop the message if users don't  
> mind
>
> we shouldn't end up with too many variants and personally i don't  
> like the mix (i.e. foo==yes can be used)

if the context way is to avoid comma values and assignment values in  
the same list the message should better remain

Wolfgang


From pragma at wxs.nl  Fri Aug  7 12:02:23 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 07 Aug 2009 12:02:23 +0200
Subject: [dev-context] A few questions
In-Reply-To: <D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
Message-ID: <4A7BFBAF.3090406@wxs.nl>

Wolfgang Schuster wrote:

> not very nice and don't look pleasant to me

sure, but a pleasant solution takes me more time -)

> i get the feeling we're moving towards latex3 (brr), before this happens 
> drop the whole
> thing and i don't like \getvariable in this context anyway

there was a presentation about this ltx3 low level syntax and i 
definitely don't want to have something like that; it's more that in 
context we have this system of [optional]{whatever} that we might want 
to support

>   \long\def\processcommalistwithcontent[#1]#2%
>     {\def\currentcommalistcommand##1{#2}%
>      \processcommalist[#1]\currentcommalistcommand}
> 
>   
> \processcommalistwithcontent[a,b,c]{{\processcommalistwithcontent[x,y,z]{This 
> is subelement ##1 of element #1.\par}}}
> 
> but the extra pair of braces is kind of akward. Working without them is 
> not the problem
> 
>   \newcount\commalistdepth
> 
>   \long\def\processcommalistwithcontent[#1]#2%
>     {\advance\commalistdepth\plusone
>      \long\expandafter\def\csname 
> list:\number\commalistdepth\endcsname##1{#2}%
>      \def\currentcommalistcommand{\csname 
> list:\number\commalistdepth\endcsname}%
>      \processcommalist[#1]\currentcommalistcommand
>      \advance\commalistdepth\minusone}
> 
>   
> \processcommalistwithcontent[a,b,c]{\processcommalistwithcontent[x,y,z]{This 
> is subelement ##1 of element #1.\par}}
> 
> but as you mentioned above some kind of check (depth counter) is needed.

right

> in my games module for the input for chess, go ...
> 
>   \startpgnsetups move
>   do a few things before the move
>   \pgnflush{#1}
>   do a few things after the move
>   \stoppgnsetups

well, maybe something like

\starttexsetups move
  do a few things before the move
  \pgnflush{#1}
  do a few things after the move
\stoptexsetups

as generic case?

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Fri Aug  7 12:17:41 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Fri, 7 Aug 2009 12:17:41 +0200
Subject: [dev-context] A few questions
In-Reply-To: <4A7BFBAF.3090406@wxs.nl>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
	<4A7BFBAF.3090406@wxs.nl>
Message-ID: <73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>


Am 07.08.2009 um 12:02 schrieb Hans Hagen:

> Wolfgang Schuster wrote:
>
>> not very nice and don't look pleasant to me
>
> sure, but a pleasant solution takes me more time -)

that's why i asked, i wasn't able to write a pleasant one myself

>> i get the feeling we're moving towards latex3 (brr), before this  
>> happens drop the whole
>> thing and i don't like \getvariable in this context anyway
>
> there was a presentation about this ltx3 low level syntax and i  
> definitely don't want to have something like that; it's more that in  
> context we have this system of [optional]{whatever} that we might  
> want to support

me neither, the latex3 system is too complicated and one has to  
remember what n, N, x ... means etc.

there are a few interesting things like namespaces for module/macros  
but that's not worth the effort they take

>> in my games module for the input for chess, go ...
>>  \startpgnsetups move
>>  do a few things before the move
>>  \pgnflush{#1}
>>  do a few things after the move
>>  \stoppgnsetups
>
> well, maybe something like
>
> \starttexsetups move
> do a few things before the move
> \pgnflush{#1}
> do a few things after the move
> \stoptexsetups
>
> as generic case?

i have to think about this but when i think about the current progress  
on the module i won't come back to this before 2010 :)

Wolfgang


From pragma at wxs.nl  Fri Aug  7 14:18:41 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 07 Aug 2009 14:18:41 +0200
Subject: [dev-context] A few questions
In-Reply-To: <73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
	<4A7BFBAF.3090406@wxs.nl>
	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>
Message-ID: <4A7C1BA1.7030802@wxs.nl>

Wolfgang Schuster wrote:
> 
> Am 07.08.2009 um 12:02 schrieb Hans Hagen:
> 
>> Wolfgang Schuster wrote:
>>
>>> not very nice and don't look pleasant to me
>>
>> sure, but a pleasant solution takes me more time -)
> 
> that's why i asked, i wasn't able to write a pleasant one myself
> 
>>> i get the feeling we're moving towards latex3 (brr), before this 
>>> happens drop the whole
>>> thing and i don't like \getvariable in this context anyway
>>
>> there was a presentation about this ltx3 low level syntax and i 
>> definitely don't want to have something like that; it's more that in 
>> context we have this system of [optional]{whatever} that we might want 
>> to support
> 
> me neither, the latex3 system is too complicated and one has to remember 
> what n, N, x ... means etc.

indeed, and also kind of redundant as the name should denote the usage, 
i.e. imagine that in e.g. lua we did  myfunction_takes_num_and_num

i would not be surprised if it's also quite slow (esp when used in core 
code) and core code is not used by users anyway

> there are a few interesting things like namespaces for module/macros but 
> that's not worth the effort they take

indeed, but keep in mind that in context we seldom have other interfaces 
that [] and {}, no optoinal * etc

>>> in my games module for the input for chess, go ...
>>>  \startpgnsetups move
>>>  do a few things before the move
>>>  \pgnflush{#1}
>>>  do a few things after the move
>>>  \stoppgnsetups
>>
>> well, maybe something like
>>
>> \starttexsetups move
>> do a few things before the move
>> \pgnflush{#1}
>> do a few things after the move
>> \stoptexsetups
>>
>> as generic case?
> 
> i have to think about this but when i think about the current progress 
> on the module i won't come back to this before 2010 :)



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From adityam at umich.edu  Fri Aug  7 14:33:23 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Fri, 7 Aug 2009 08:33:23 -0400 (EDT)
Subject: [dev-context] A few questions
In-Reply-To: <4A7C1BA1.7030802@wxs.nl>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
	<4A7BFBAF.3090406@wxs.nl>
	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>
	<4A7C1BA1.7030802@wxs.nl>
Message-ID: <alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>

On Fri, 7 Aug 2009, Hans Hagen wrote:

>>>> i get the feeling we're moving towards latex3 (brr), before this happens 
>>>> drop the whole
>>>> thing and i don't like \getvariable in this context anyway
>>> 
>>> there was a presentation about this ltx3 low level syntax and i definitely 
>>> don't want to have something like that; it's more that in context we have 
>>> this system of [optional]{whatever} that we might want to support
>> 
>> me neither, the latex3 system is too complicated and one has to remember 
>> what n, N, x ... means etc.
>
> indeed, and also kind of redundant as the name should denote the usage, i.e. 
> imagine that in e.g. lua we did  myfunction_takes_num_and_num
>
> i would not be surprised if it's also quite slow (esp when used in core code) 
> and core code is not used by users anyway
>
>> there are a few interesting things like namespaces for module/macros but 
>> that's not worth the effort they take
>
> indeed, but keep in mind that in context we seldom have other interfaces that 
> [] and {}, no optoinal * etc

One good thing with LaTeX 3 syntax is that something like

\DeclareDocumentCommand\foo { o o m } will be (from what I understand) 
equivalent to

\def\foo
  {\dodoubleempty\dofoo}

\def\dofoo[#1][#2]#3{...}

When I started using context, I was surprised that context did not have 
anything for optional arguments. We could have something like

\definesinglearugment\foo[#1]#2{...}

to be equal to

\def\foo{\dosingleargument\dofoo}
\def\dofoo[#1]#2{...}

and

\definesingleempty\foo[#1]#2{...]

to be equal to

\def\foo{\dosingleempty\dofoo}
\def\dofoo[#1]#2{...}

and similar things for \definedoublearugment, \definetripleargument, etc. 
I am not convinced that this is a good thing, but using something like 
this in the core may result in a 10% reduction in the code size and might 
kill a few dodos :)

Aditya

From pragma at wxs.nl  Fri Aug  7 20:27:32 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 07 Aug 2009 20:27:32 +0200
Subject: [dev-context] A few questions
In-Reply-To: <alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>	<4A7B4E59.2050905@wxs.nl>	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>	<4A7BFBAF.3090406@wxs.nl>	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>	<4A7C1BA1.7030802@wxs.nl>
	<alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A7C7214.1070507@wxs.nl>

Aditya Mahajan wrote:

> When I started using context, I was surprised that context did not have 
> anything for optional arguments. We could have something like
> 
> \definesinglearugment\foo[#1]#2{...}
> 
> to be equal to
> 
> \def\foo{\dosingleargument\dofoo}
> \def\dofoo[#1]#2{...}
> 
> and
> 
> \definesingleempty\foo[#1]#2{...]
> 
> to be equal to
> 
> \def\foo{\dosingleempty\dofoo}
> \def\dofoo[#1]#2{...}
> 
> and similar things for \definedoublearugment, \definetripleargument, 
> etc. I am not convinced that this is a good thing, but using something 
> like this in the core may result in a 10% reduction in the code size and 
> might kill a few dodos :)

there is \definecomplexorsimple

anyhow, it does not save commands and does not reduce the code size as 
you still need the intermediates; it might increase the format 
generation time with a few millisec

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oliver.buerschaper at mpq.mpg.de  Wed Aug 12 17:35:53 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Wed, 12 Aug 2009 17:35:53 +0200
Subject: [dev-context] Mac installation package
Message-ID: <F27E6159-A128-4E9D-A4C9-94A4F21B7ED1@mpq.mpg.de>

Dear all,

I've finally got around to actually make the Mac installation package  
happen :-) So please find a test version of the package (for Intel  
Macs running Tiger or higher) at

http://svn.contextgarden.net/minimals/installer/osx/

This package is identical to the Minimals distribution as of  
2009.06.11 13:24 except for the following:

1. It only contains MkIV
2. Configuration files are adapted to Mac OS X
3. It doesn't contain scripts etc. needed for other platforms

The installation experience should be rather pleasant, since you'll  
just have to double-click the installation package. After the  
installation is complete head over to "System Preferences > TeX  
Distribution" and you should find a new item called "ConTeXt  
2009-06-11-beta" alongside "MacTeX 2008" etc. This means that by now  
you should be able to typeset your documents with a simple

context myfile.tex

in the Terminal. (TeXShop support is easy and will be included in the  
next revision.)

For the more curious: the package installs its TDS to /usr/local/ 
context/2009-06-11-beta and sets up a per user cache at ~/.context/ 
2009-06-11-beta. The directory for user additions is ~/Library/texmf  
and is shared with TeXLive. Fonts installed at the usual locations in  
Mac OS X should be recognized by ConTeXt as well. For the even more  
curious, there's also a readme file in the disk image ;-)

I'd be glad if as many people as possible on this list would give it a  
try and report back their experience. Once the package turns out to  
work as intended I'll make it available to the wider public.

Many thanks in advance to all testers!

Happy TeXing,
Oliver
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 194 bytes
Desc: Signierter Teil der Nachricht
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090812/2e1db6cb/attachment.pgp>

From pragma at wxs.nl  Wed Aug 12 21:21:32 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 12 Aug 2009 21:21:32 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <F27E6159-A128-4E9D-A4C9-94A4F21B7ED1@mpq.mpg.de>
References: <F27E6159-A128-4E9D-A4C9-94A4F21B7ED1@mpq.mpg.de>
Message-ID: <4A83163C.3030503@wxs.nl>

Oliver Buerschaper wrote:

> in the Terminal. (TeXShop support is easy and will be included in the 
> next revision.)

then also consider texworks

thanks

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Thu Aug 13 21:01:52 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Thu, 13 Aug 2009 21:01:52 +0200
Subject: [dev-context] A few questions
In-Reply-To: <alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
	<4A7BFBAF.3090406@wxs.nl>
	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>
	<4A7C1BA1.7030802@wxs.nl>
	<alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
Message-ID: <71C9BCE4-84AA-441F-B006-264241ED8B41@gmail.com>


Am 07.08.2009 um 14:33 schrieb Aditya Mahajan:

> When I started using context, I was surprised that context did not  
> have anything for optional arguments. We could have something like
>
> \definesinglearugment\foo[#1]#2{...}
>
> to be equal to
>
> \def\foo{\dosingleargument\dofoo}
> \def\dofoo[#1]#2{...}
>
> and
>
> \definesingleempty\foo[#1]#2{...]
>
> to be equal to
>
> \def\foo{\dosingleempty\dofoo}
> \def\dofoo[#1]#2{...}
>
> and similar things for \definedoublearugment, \definetripleargument,  
> etc. I am not convinced that this is a good thing, but using  
> something like this in the core may result in a 10% reduction in the  
> code size and might kill a few dodos :)


It's now your turn to extend the macro to more optional arguments.

\def\define
  {\doifnextoptionalelse\dodefine\nodefine}

\def\nodefine{\dodefine[0]}

\def\dodefine[#1]#2%
  {\doifnextoptionalelse{\dododefine[#1]#2}{\nododefine[#1]#2}}

\def\dododefine[#1]#2[#3]#4%
  {\definecomplexorsimple#2
   \setvalue{simple\strippedcsname#2}{\getvalue{complex 
\strippedcsname#2}[#3]}%
   \ifcase0#1\relax
      \setvalue{complex\strippedcsname#2}{#4}%
      \setvalue{simple\strippedcsname #2}{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2##3{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2##3##4{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2##3##4##5{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2##3##4##5##6{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2##3##4##5##6##6{#4}%
   \or\setvalue{complex\strippedcsname#2}[##1]##2##3##4##5##6##7##8{#4}%
   \or\setvalue{complex\strippedcsname#2} 
[##1]##2##3##4##5##6##7##8##9{#4}%
   \fi}

\def\nododefine[#1]#2#3%
  {\ifx#2\undefined
   \else
     \showmessage{systems}{4}{\string#2}%
   \fi
   \ifcase0#1\def#2{#3}%
   \or\def#2##1{#3}%
   \or\def#2##1##2{#3}%
   \or\def#2##1##2##3{#3}%
   \or\def#2##1##2##3##4{#3}%
   \or\def#2##1##2##3##4##5{#3}%
   \or\def#2##1##2##3##4##5##6{#3}%
   \or\def#2##1##2##3##4##5##6##7{#3}%
   \or\def#2##1##2##3##4##5##6##7##8{#3}%
   \or\def#2##1##2##3##4##5##6##7##8##9{#3}%
   \else\def#2{#3}%
   \fi}

\starttext

\define\foo{bar}

\define[2]\bar{bar:#1:#2}

\define[2]\help[me]{help #1 #2}

\foo

\bar{a}{b}

\help{john}

\help[you]{mike}

\stoptext

Wolfgang


From pragma at wxs.nl  Thu Aug 13 23:35:16 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 13 Aug 2009 23:35:16 +0200
Subject: [dev-context] A few questions
In-Reply-To: <71C9BCE4-84AA-441F-B006-264241ED8B41@gmail.com>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>	<4A7B4E59.2050905@wxs.nl>	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>	<4A7BFBAF.3090406@wxs.nl>	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>	<4A7C1BA1.7030802@wxs.nl>	<alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
	<71C9BCE4-84AA-441F-B006-264241ED8B41@gmail.com>
Message-ID: <4A848714.3040809@wxs.nl>

Wolfgang Schuster wrote:

> It's now your turn to extend the macro to more optional arguments.

hm, your challenging me? i must be crazy but here you go

\startluacode
     local texsprint, ctxcatcodes = tex.sprint, tex.ctxcatcodes
     local format, match, gmatch, rep = string.format, string.match, 
string.gmatch, string.rep
     local empty = {
         "single",
         "double",
         "triple",
         "quadruple",
         "quintuple",
     }
     local check = {
         "first",
         "second",
         "third",
         "fourth",
         "fifth",
     }
     function commands.define(str)
         -- we could store the defaults in lua and call lua instead but 
why bother
         local arg, cmd = match(str,"(.*)\\(.-)$")
         local a = { }
         for s in gmatch(arg,"%[(.-)%]") do
             a[#a+1] = s
         end
         local n = tonumber(a[#a])
         if n then
             a[#a] = nil
         else
             n = 0
         end
         texsprint(ctxcatcodes,format("\\unexpanded\\def\\%s",cmd))
         if #a > 0 then
 
texsprint(ctxcatcodes,format("{\\do%sempty\\do%s}",empty[#a],cmd))
             texsprint(ctxcatcodes,format("\\def\\do%s",cmd))
             for i=1,#a do
                 texsprint(ctxcatcodes,"[#",i,"]")
             end
             texsprint(ctxcatcodes,"{")
             for i=#a,1,-1 do
                 texsprint(ctxcatcodes,format("\\if%sargument",check[i]))
                 texsprint(ctxcatcodes,format("\\def\\next{\\dodo%s",cmd))
                 for j=1,#a-i do
                     texsprint(ctxcatcodes,format("[%s]",a[j]))
                 end
                 for j=1,i do
                     texsprint(ctxcatcodes,format("[#%s]",j))
                 end
                 texsprint(ctxcatcodes,"}")
                 if i == 1 then
                     texsprint(ctxcatcodes,rep("\\fi",#a))
                 else
                     texsprint(ctxcatcodes,"\\else")
                 end
             end
             texsprint(ctxcatcodes,"\\next}")
             texsprint(ctxcatcodes,format("\\def\\dodo%s",cmd))
             for i=1,#a do
                 texsprint(ctxcatcodes,"[#",i,"]")
             end
         end
         for i=1,n do
             texsprint(ctxcatcodes,"#",#a+i)
         end
     end
\stopluacode

\def\define#1#{\ctxlua{commands.define([[\detokenize{#1}]])}}

\starttext
     \define[2]\whatevera{#1+#2}
     \whatevera{A}{B}
     \define[me][too][2]\whateverb{#1+#2+#3+#4}
     \whateverb[A]{B}{C}
     \whateverb[A][B]{C}{D}
\stoptext

we might add some \longs here and there


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From j.hecke at seh.de  Fri Aug 14 11:11:27 2009
From: j.hecke at seh.de (=?ISO-8859-1?Q?J=F6rg_Hecke?=)
Date: Fri, 14 Aug 2009 11:11:27 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <mailman.1.1250157602.6800.dev-context@ntg.nl>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
Message-ID: <C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>

Hi,

> I'd be glad if as many people as possible on this list would give it a
> try and report back their experience. Once the package turns out to
> work as intended I'll make it available to the wider public.

I gave it a try and it works quite nice. Since I am currently using  
Context/MKII (Installed via the TexLive 2008 distribution) for my  
documents, your solution would provide even me with a fairly simple  
method to use the current minimals installation and to try out MKIV.  
Even switching between "Context-2009-06-11-beta", "gwTeX" and  
"TeXLive-2008" by using the TeX Distribution system preference panel  
works.
A Testdocument works with "TeXLive-2008" (texexec  
produktvorschlag.tex) as well as with your installation  
"Context-2009-06-11-beta" (context produktvorschlag.tex)

Another Question though:
------------------------
Would it be possible to install (optionally perhaps) third party  
modules like t-letter and t-simplefonts also? I would like to try to  
use Myriad Pro and using simplefonts seems to be the simplest solution  
for that (at least for me when reading through the wiki. I don't think  
that I am able to create typescripts, support files for TeX etc.).

Or can I install these third party modules by myself in your  
"Context-2009-06-11-beta" tree (downloading first-setup.sh in your  
folder "/usr/local/context/2009-06-11-beta" failed for me, perhaps due  
to missing rights?)?

Many thanks for working on such a nice installer package for such a  
simple users as me on the Mac.

Best Regards

J?rg	

From schuster.wolfgang at googlemail.com  Fri Aug 14 16:06:37 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Fri, 14 Aug 2009 16:06:37 +0200
Subject: [dev-context] A few questions
In-Reply-To: <4A848714.3040809@wxs.nl>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>	<4A7B4E59.2050905@wxs.nl>	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>	<4A7BFBAF.3090406@wxs.nl>	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>	<4A7C1BA1.7030802@wxs.nl>	<alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
	<71C9BCE4-84AA-441F-B006-264241ED8B41@gmail.com>
	<4A848714.3040809@wxs.nl>
Message-ID: <46F558F0-CE63-43CE-AD10-53DC8E46688E@gmail.com>


Am 13.08.2009 um 23:35 schrieb Hans Hagen:

> Wolfgang Schuster wrote:
>
>> It's now your turn to extend the macro to more optional arguments.
>
> hm, your challenging me?

not really, the sentence was directed to Aditya

> i must be crazy but here you go

that's awesome :)

Wolfgang


From oliver.buerschaper at mpq.mpg.de  Fri Aug 14 19:54:21 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Fri, 14 Aug 2009 19:54:21 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
Message-ID: <C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>

> I gave it a try and it works quite nice. Since I am currently using  
> Context/MKII (Installed via the TexLive 2008 distribution) for my  
> documents, your solution would provide even me with a fairly simple  
> method to use the current minimals installation and to try out MKIV.  
> Even switching between "Context-2009-06-11-beta", "gwTeX" and  
> "TeXLive-2008" by using the TeX Distribution system preference panel  
> works.
> A Testdocument works with "TeXLive-2008" (texexec  
> produktvorschlag.tex) as well as with your installation  
> "Context-2009-06-11-beta" (context produktvorschlag.tex)

:-)


> Would it be possible to install (optionally perhaps) third party  
> modules like t-letter and t-simplefonts also?

Yeah, that should be doable. The Apple installer definitely supports  
packages with several (optional) components. And I think it's a very  
nice thing to have right out of the box. I'll put it on the roadmap.

In the meantime you may install any third party material manually (see  
below).


> Or can I install these third party modules by myself in your  
> "Context-2009-06-11-beta" tree (downloading first-setup.sh in your  
> folder "/usr/local/context/2009-06-11-beta" failed for me, perhaps  
> due to missing rights?)?

Well, you can. If you want these modules to be available to all local  
users of your Mac  place the entire directory hierarchy of each module  
in the tree /usr/local/context/2009-06-11-beta/texmf-local. You'll  
need admin access though since /usr/local/context is a protected  
system directory.

If you want the modules to be available only to yourself put their  
files in ~/Library/texmf (where ~ denotes your home directory). For  
this you don't need admin rights. Be warned though that the ~/Library/ 
texmf tree is shared with TeXLive. Hence anything you put there  
supersedes older versions of the same stuff contained in TeXLive and  
this might cause some funny interferences when you run an old ConTeXt  
from the TeXLive distribution ...

In both cases you need to issue

luatools --generate

before ConTeXt recognizes the new additions. If you installed the  
modules in the system location you need to repeat this step for each  
local user.

Note that this package is still experimental so ~/Library/texmf (as  
well as most other things) might be subject to change.

Oliver

From adityam at umich.edu  Sat Aug 15 04:58:13 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Fri, 14 Aug 2009 22:58:13 -0400 (EDT)
Subject: [dev-context] A few questions
In-Reply-To: <46F558F0-CE63-43CE-AD10-53DC8E46688E@gmail.com>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>
	<4A7B4E59.2050905@wxs.nl>
	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>
	<4A7BFBAF.3090406@wxs.nl>
	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>
	<4A7C1BA1.7030802@wxs.nl>
	<alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>
	<71C9BCE4-84AA-441F-B006-264241ED8B41@gmail.com>
	<4A848714.3040809@wxs.nl>
	<46F558F0-CE63-43CE-AD10-53DC8E46688E@gmail.com>
Message-ID: <alpine.LNX.2.00.0908142256320.22839@ybpnyubfg.ybpnyqbznva>

On Fri, 14 Aug 2009, Wolfgang Schuster wrote:

>
> Am 13.08.2009 um 23:35 schrieb Hans Hagen:
>
>> Wolfgang Schuster wrote:
>> 
>>> It's now your turn to extend the macro to more optional arguments.
>> 
>> hm, your challenging me?
>
> not really, the sentence was directed to Aditya

Hey, I don't want to get involved in a coding challenge with you two. I 
am more than happy to enjoy the duel from the sidelines.

Aditya

From pragma at wxs.nl  Sun Aug 16 17:52:42 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 16 Aug 2009 17:52:42 +0200
Subject: [dev-context] A few questions
In-Reply-To: <alpine.LNX.2.00.0908142256320.22839@ybpnyubfg.ybpnyqbznva>
References: <B11C7B73-2988-4238-9968-13008347F636@gmail.com>	<4A7B4E59.2050905@wxs.nl>	<D2DB1DF1-8C5C-4A7E-AF49-C064222F2189@gmail.com>	<4A7BFBAF.3090406@wxs.nl>	<73871A3A-6D1E-4A6D-8A9B-67F1898D0EDA@gmail.com>	<4A7C1BA1.7030802@wxs.nl>	<alpine.LNX.2.00.0908070821010.8226@ybpnyubfg.ybpnyqbznva>	<71C9BCE4-84AA-441F-B006-264241ED8B41@gmail.com>	<4A848714.3040809@wxs.nl>	<46F558F0-CE63-43CE-AD10-53DC8E46688E@gmail.com>
	<alpine.LNX.2.00.0908142256320.22839@ybpnyubfg.ybpnyqbznva>
Message-ID: <4A882B4A.20203@wxs.nl>

Aditya Mahajan wrote:
> On Fri, 14 Aug 2009, Wolfgang Schuster wrote:
> 
>>
>> Am 13.08.2009 um 23:35 schrieb Hans Hagen:
>>
>>> Wolfgang Schuster wrote:
>>>
>>>> It's now your turn to extend the macro to more optional arguments.
>>>
>>> hm, your challenging me?
>>
>> not really, the sentence was directed to Aditya
> 
> Hey, I don't want to get involved in a coding challenge with you two. I 
> am more than happy to enjoy the duel from the sidelines.

well, you could have opted for ways to define delimited math comands 
using dollar signs but i remember that we recently agreed on getting rid 
of dollars

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From j.hecke at seh.de  Tue Aug 18 15:10:11 2009
From: j.hecke at seh.de (=?ISO-8859-1?Q?J=F6rg_Hecke?=)
Date: Tue, 18 Aug 2009 15:10:11 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
Message-ID: <8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>

>> Would it be possible to install (optionally perhaps) third party  
>> modules like t-letter and t-simplefonts also?
> Yeah, that should be doable. The Apple installer definitely supports  
> packages with several (optional) components. ... I'll put it on the  
> roadmap.

Great. Many thanks for that!

> Well, you can. If you want these modules to be available to all  
> local users of your Mac  place the entire directory hierarchy of  
> each module in the tree /usr/local/context/2009-06-11-beta/texmf- 
> local. You'll need admin access though since /usr/local/context is a  
> protected system directory.

I knew I need an installer. :-(
I have downloaded the archive "t-simplefonts-2009.08.01.zip" from <http://modules.contextgarden.net/simplefonts 
 > and placed this zip file in the place "/usr/local/context/ 
2009-06-11-beta/texmf-local" and switched to the terminal:

---Terminal Output---
titus:~ jh$ su admin
Password: ********
bash-3.2$ cd /usr/local/context/2009-06-11-beta/texmf-local
bash-3.2$ ls
t-simplefonts-2009.08.01.zip
bash-3.2$ sudo unzip t-simplefonts-2009.08.01.zip
Password: ********
Archive:  t-simplefonts-2009.08.01.zip
    creating: tex/
    creating: tex/context/
    creating: tex/context/third/
    creating: tex/context/third/simplefonts/
    ...
bash-3.2$ ls
doc                          t-simplefonts-2009.08.01.zip
source                       tex
bash-3.2$ sudo luatools --generate
LuaTools | fileio: variable SELFAUTOLOC set to /usr/local/context/ 
2009-06-11-beta/texmf-osx-intel/bin
LuaTools | fileio: variable SELFAUTODIR set to /usr/local/context/ 
2009-06-11-beta/texmf-osx-intel
LuaTools | fileio: variable SELFAUTOPARENT set to /usr/local/context/ 
2009-06-11-beta
LuaTools | fileio: variable TEXMFCNF set to {$SELFAUTODIR, 
$SELFAUTOPARENT}{,{/share,}/texmf{-local,.local,}/web2c}
LuaTools | fileio: loading configuration file /usr/local/context/ 
2009-06-11-beta/texmf/web2c/texmfcnf.lua
.....

Then I tried a simple test file after using "luatool --generate" on my  
non-admin account:
titus:wech jh$ luatool --generate
titus:wech jh$ context myriad.tex
...
...
/2009-06-11-beta/texmf-context/tex/context/base/type-otf.mkiv)))
system          : myriad.top loaded
(myriad.top)
fonts           : preloading latin modern fonts
bodyfont        : 12pt rm is loaded
language        : language en is active
system          : module simplefonts loaded
(/usr/local/context/2009-06-11-beta/texmf-local/tex/context/third/ 
simplefonts/t-simplefonts.tex
loading         : ConTeXt User Module / Simplefonts
! Undefined control sequence.
l.707 \startprocesscommacommand
                                [\simplefonts!weight]
?
---Terminal Output---


Well, it seems that your instructions did basically work, since the  
module simplefonts is loaded. But nevertheless the simple test file  
aborts and complains about " Undefined control sequence. l.707  
\startprocesscommacommand[\simplefonts!weight]".

Do you have an idea what went wrong on my side?

The content of the file "myriad.tex" is just:

\mainlanguage[de]
\setuplayout[middle]
% \definefontfeature[default][default][
%   mode=node,
%   protrusion=quality,
%   expansion=quality,
%   onum=yes,pnum=yes]
\usemodule[simplefonts] %[size=10pt]
\setmainfont[Myriad Pro]
% \setupbodyfont[ss,10pt]
%
% \setupinterlinespace[line=2.6ex]
%
% \definefont[big][Serif at .25\vsize]
\starttext
Nun denn.
\stoptext

The Myriad font is installed, see Screenshot "Schriftsammlung.pdf".
Definitely a dump error on my side, but could you please give me a  
hint on how to proceed?

It seems that I am really dependent on your installer...

Many thanks again for your help and patience

Best regards

Joerg Hecke
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Schriftsammlung.pdf
Type: application/pdf
Size: 61330 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090818/e2509d07/attachment-0001.pdf>
-------------- next part --------------





From oliver.buerschaper at mpq.mpg.de  Wed Aug 19 10:43:16 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Wed, 19 Aug 2009 10:43:16 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
Message-ID: <47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>

> I knew I need an installer. :-(
> I have downloaded the archive "t-simplefonts-2009.08.01.zip" from <http://modules.contextgarden.net/simplefonts 
> > and placed this zip file in the place "/usr/local/context/ 
> 2009-06-11-beta/texmf-local" and switched to the terminal:
>
> ---Terminal Output---
> titus:~ jh$ su admin
> Password: ********
> bash-3.2$ cd /usr/local/context/2009-06-11-beta/texmf-local
> bash-3.2$ ls
> t-simplefonts-2009.08.01.zip
> bash-3.2$ sudo unzip t-simplefonts-2009.08.01.zip
> Password: ********
> Archive:  t-simplefonts-2009.08.01.zip
> creating: tex/
> creating: tex/context/
> creating: tex/context/third/
> creating: tex/context/third/simplefonts/
> ...
> bash-3.2$ ls
> doc                          t-simplefonts-2009.08.01.zip
> source                       tex
> bash-3.2$ sudo luatools --generate
> LuaTools | fileio: variable SELFAUTOLOC set to /usr/local/context/ 
> 2009-06-11-beta/texmf-osx-intel/bin
> LuaTools | fileio: variable SELFAUTODIR set to /usr/local/context/ 
> 2009-06-11-beta/texmf-osx-intel
> LuaTools | fileio: variable SELFAUTOPARENT set to /usr/local/context/ 
> 2009-06-11-beta
> LuaTools | fileio: variable TEXMFCNF set to {$SELFAUTODIR, 
> $SELFAUTOPARENT}{,{/share,}/texmf{-local,.local,}/web2c}
> LuaTools | fileio: loading configuration file /usr/local/context/ 
> 2009-06-11-beta/texmf/web2c/texmfcnf.lua
> .....
>
> Then I tried a simple test file after using "luatool --generate" on  
> my non-admin account:
> titus:wech jh$ luatool --generate
> titus:wech jh$ context myriad.tex
> ...
> ...
> /2009-06-11-beta/texmf-context/tex/context/base/type-otf.mkiv)))
> system          : myriad.top loaded
> (myriad.top)
> fonts           : preloading latin modern fonts
> bodyfont        : 12pt rm is loaded
> language        : language en is active
> system          : module simplefonts loaded
> (/usr/local/context/2009-06-11-beta/texmf-local/tex/context/third/ 
> simplefonts/t-simplefonts.tex
> loading         : ConTeXt User Module / Simplefonts
> ! Undefined control sequence.
> l.707 \startprocesscommacommand
>                             [\simplefonts!weight]
> ?
> ---Terminal Output---
>
>
> Well, it seems that your instructions did basically work, since the  
> module simplefonts is loaded. But nevertheless the simple test file  
> aborts and complains about " Undefined control sequence. l.707  
> \startprocesscommacommand[\simplefonts!weight]".
>
> Do you have an idea what went wrong on my side?

Yes. Although the module is found it crashes during initialization.  
Observe that

---
\usemodule[simplefonts]


\starttext

This tests whether the module \type{t-simplefonts} is loaded  
successfully.

\stoptext
---

already hangs. The reason is that the latest version of the t- 
simplefonts module (which is the one you obtained) makes use of  
ConTeXt kernel commands (\startprocesscommacommand) which seem to have  
only been introduced lately. In other words, the version I packaged  
into the experimental installer is too old for the current module. So  
not your fault.

Keep in mind though that this might happen frequently without warning  
since you're working with development code here. For the moment I'm  
merely trying to establish something along the lines of a nightly  
installer build ... since there's no regression test suite I can't  
even test whether anything works but the most basic features. Also,  
modules don't check for a minimum kernel version required :-(

Best,
Oliver

From taco at elvenkind.com  Wed Aug 19 10:53:27 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 19 Aug 2009 10:53:27 +0200
Subject: [dev-context] Luatex 0.43.0 announcement
Message-ID: <4A8BBD87.6050004@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.43.0.

New features:

* There is a new allowed key in the table trhat is returned
  by lua-loaded fonts: <f>.psname. This value should be set
  to the original PostScript font name of the font. Fonts inside
  dfont and ttc collections are fetched using this field
  (if it is missing, <f>.fullname will be used instead).

* It is now possible to use Apple dfont font files
  (those that contain at least one outline font).

* \latelua is now allowed inside leaders.

* There is a new callback: process_output_buffer, from Manuel
  P?gouri?-Gonnard. This callback is called just before
  \write acts, so it can be used to alter the file encoding
  of text output files.

* There is a new node.dimensions() function, which calculates
  the natural size of (part of) a list of nodes.

* The new primitive \gleaders provides 'globally aligned'
  leaders.

* The DVI and PDF backends now share much code internally.

* The embedded MPlib is now 1.207.

* libpng is now 1.2.39.

Bugfixes:

* We fixed lots of anonymous bugs introduced in 0.42.0 (as expected)

* fontloader.info() errors are no longer fatal, the function now
  just returns a nil,"error string" pair.

* Automatically inserted kerns for \accents are now once again
  valid word ends, as in \TEX.

* Fixed the placement of math displays in mixed direction
  settings.

* The \pdfcompresslevel is now dynamic again.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.43.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From schuster.wolfgang at googlemail.com  Wed Aug 19 18:37:21 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Wed, 19 Aug 2009 18:37:21 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
Message-ID: <292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>


Am 19.08.2009 um 10:43 schrieb Oliver Buerschaper:

>> Well, it seems that your instructions did basically work, since the  
>> module simplefonts is loaded. But nevertheless the simple test file  
>> aborts and complains about " Undefined control sequence. l.707  
>> \startprocesscommacommand[\simplefonts!weight]".
>>
>> Do you have an idea what went wrong on my side?
>
> Yes. Although the module is found it crashes during initialization.  
> Observe that
>
> ---
> \usemodule[simplefonts]
>
>
> \starttext
>
> This tests whether the module \type{t-simplefonts} is loaded  
> successfully.
>
> \stoptext
> ---
>
> already hangs. The reason is that the latest version of the t- 
> simplefonts module (which is the one you obtained) makes use of  
> ConTeXt kernel commands (\startprocesscommacommand) which seem to  
> have only been introduced lately. In other words, the version I  
> packaged into the experimental installer is too old for the current  
> module. So not your fault.

You're right and the command was added *for* the simplefonts module :)

> Keep in mind though that this might happen frequently without  
> warning since you're working with development code here. For the  
> moment I'm merely trying to establish something along the lines of a  
> nightly installer build ... since there's no regression test suite I  
> can't even test whether anything works but the most basic features.  
> Also, modules don't check for a minimum kernel version required :-(

There is a command to check the context version

%D \macros
%D   {doifolderversionelse}
%D
%D We start with a macro specially for Aditya who wants to be able
%D to use development versions of \MKIV\ for real documents.
%D
%D \starttyping
%D \doifolderversionelse\contextversion{2001.02.03}{yes}{no}
%D \doifolderversionelse\contextversion{3001.02.03}{yes}{no}
%D \stoptyping

and end the module and output a message in the terminal but then you  
will
you will get a error message in the document itself because a few  
commands
(e.g. \setmainfont) are no longer defined.

Wolfgang


From oliver.buerschaper at mpq.mpg.de  Thu Aug 20 10:23:09 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Thu, 20 Aug 2009 10:23:09 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
Message-ID: <40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>

>> Keep in mind though that this might happen frequently without  
>> warning since you're working with development code here. For the  
>> moment I'm merely trying to establish something along the lines of  
>> a nightly installer build ... since there's no regression test  
>> suite I can't even test whether anything works but the most basic  
>> features. Also, modules don't check for a minimum kernel version  
>> required :-(
>
> There is a command to check the context version
>
> %D \macros
> %D   {doifolderversionelse}
> %D
> %D We start with a macro specially for Aditya who wants to be able
> %D to use development versions of \MKIV\ for real documents.
> %D
> %D \starttyping
> %D \doifolderversionelse\contextversion{2001.02.03}{yes}{no}
> %D \doifolderversionelse\contextversion{3001.02.03}{yes}{no}
> %D \stoptyping
>
> and end the module and output a message in the terminal but then you  
> will
> you will get a error message in the document itself because a few  
> commands
> (e.g. \setmainfont) are no longer defined.

Would it then be possible to have ConTeXt grind to a complete halt  
once it encounters a module whose minimum requirements aren't met?  
Since TeX would have to give up on the document anyway perhaps an  
early bail out could be the more graceful option ... what do you think?

Oliver

From schuster.wolfgang at googlemail.com  Thu Aug 20 15:21:13 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Thu, 20 Aug 2009 15:21:13 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
Message-ID: <04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>


Am 20.08.2009 um 10:23 schrieb Oliver Buerschaper:

> Would it then be possible to have ConTeXt grind to a complete halt  
> once it encounters a module whose minimum requirements aren't met?

\doifolderversionelse\contextversion{2100.01.01}\normalend\donothing
%\doifolderversionelse\contextversion{2009.07.01}\normalend\donothing

\starttext
Hello
\stoptext

> Since TeX would have to give up on the document anyway perhaps an  
> early bail out could be the more graceful option ... what do you  
> think?


I can add this test to my module together with a message at the  
terminal.

Wolfgang


From j.hecke at seh.de  Thu Aug 20 18:08:43 2009
From: j.hecke at seh.de (=?ISO-8859-1?Q?J=F6rg_Hecke?=)
Date: Thu, 20 Aug 2009 18:08:43 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
Message-ID: <D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>

Hi,

> ... The reason is that the latest version of the t-simplefonts  
> module (which is the one you obtained) makes use of ConTeXt kernel  
> commands (\startprocesscommacommand) which seem to have only been  
> introduced lately. In other words, the version I packaged into the  
> experimental installer is too old for the current module. So not  
> your fault.

Ok. So the point is that I should search for an older version of the t- 
simplefonts module which does not yet request this new and specific  
kernel command, right?
(Or just skip the idea of trying to use Myriad Pro I assume)

> Keep in mind though that this might happen frequently without  
> warning since you're working with development code here. For the  
> moment I'm merely trying to establish something along the lines of a  
> nightly installer build ... since there's no regression test suite I  
> can't even test whether anything works but the most basic features.  
> Also, modules don't check for a minimum kernel version required :-(


Hmm, yep. Quite a fair warning. OK. I was so na?ve, that it would be a  
breeze to add some modules simply by myself. My problem is really to  
detect whether it was my stupidity (in 99% the case) or if something  
else went wrong.
I do read the ntg-context list and many remarks ("This is broken in  
MKIV", "Ah I see, just use this patch...") are quite kind of scary to  
me, since I would be completely lost applying such patches, snippets  
of code, etc. But overall, all the information and the help of the  
context lists is really extremly informative and helpful and I am  
learning lots of new things daily.

But using fonts is beyond my horizon at the moment, unfortunately.  
Therefor I was keen on trying the simplefonts module.

I will definitely look forward to your next version of the installer.

many thanks again for all and regards
J?rg





From schuster.wolfgang at googlemail.com  Thu Aug 20 18:46:40 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Thu, 20 Aug 2009 18:46:40 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>
Message-ID: <9691437A-B9F8-44D2-AC5A-B608E9BD7917@gmail.com>

A non-text attachment was scrubbed...
Name: t-simplefonts-2009.07.14.zip
Type: application/zip
Size: 15429 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20090820/00056dc7/attachment-0001.zip>
-------------- next part --------------

Am 20.08.2009 um 18:08 schrieb J?rg Hecke:

> Ok. So the point is that I should search for an older version of the  
> t-simplefonts module which does not yet request this new and  
> specific kernel command, right?

You can try the following version http://bitbucket.org/wolfs/simplefonts/src/0a2adbda3117/files/t-simplefonts.tex 
  (or use the attached version, was on the garden afair) but i won't  
provide support in the case there is a problem with them.

> (Or just skip the idea of trying to use Myriad Pro I assume)

There is a package with typescripts (including Myriad Pro) on the  
garden you can use.

Wolfgang


From j.hecke at seh.de  Thu Aug 20 22:26:24 2009
From: j.hecke at seh.de (=?ISO-8859-1?Q?J=F6rg_Hecke?=)
Date: Thu, 20 Aug 2009 22:26:24 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <9691437A-B9F8-44D2-AC5A-B608E9BD7917@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>
	<9691437A-B9F8-44D2-AC5A-B608E9BD7917@gmail.com>
Message-ID: <174ACCE3-9C13-4AB3-B8F6-E1D166B65063@seh.de>

> <t-simplefonts-2009.07.14.zip>

Wow. I have used the attached version and it worked right out of the  
box with the Context Minimals version installed by the installer of  
Oliver and his instructions.

> You can try the following version http://bitbucket.org/wolfs/simplefonts/src/0a2adbda3117/files/t-simplefonts.tex 
>  (or use the attached version, was on the garden afair) but i won't  
> provide support in the case there is a problem with them.

Yes, I understand that. Many thanks for your help! The simple test  
file runs just fine right now.

> There is a package with typescripts (including Myriad Pro) on the  
> garden you can use.

Thanks for that tip. You mean here: <http://wiki.contextgarden.net/TypeScripts 
 > ?
Can't find that package there. Seems to be a little bit tricky to  
find. I'll keep on searching.

Many thanks for your help so far!

Regards
J?rg

From schuster.wolfgang at googlemail.com  Fri Aug 21 17:56:08 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Fri, 21 Aug 2009 17:56:08 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <174ACCE3-9C13-4AB3-B8F6-E1D166B65063@seh.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>
	<9691437A-B9F8-44D2-AC5A-B608E9BD7917@gmail.com>
	<174ACCE3-9C13-4AB3-B8F6-E1D166B65063@seh.de>
Message-ID: <129C4415-FB4F-40B3-9727-36484B8E96D3@gmail.com>


Am 20.08.2009 um 22:26 schrieb J?rg Hecke:

>> There is a package with typescripts (including Myriad Pro) on the  
>> garden you can use.
>
> Thanks for that tip. You mean here: <http://wiki.contextgarden.net/TypeScripts 
> > ?
> Can't find that package there. Seems to be a little bit tricky to  
> find. I'll keep on searching.

The zip is here http://modules.contextgarden.net/typescripts and the  
dev version
can be found at http://bitbucket.org/wolfs/typescripts/ but as i don't  
need them
myself other users are needed to add more typescripts.

Wolfgang


From j.hecke at seh.de  Fri Aug 21 22:45:51 2009
From: j.hecke at seh.de (=?ISO-8859-1?Q?J=F6rg_Hecke?=)
Date: Fri, 21 Aug 2009 22:45:51 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <129C4415-FB4F-40B3-9727-36484B8E96D3@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>
	<9691437A-B9F8-44D2-AC5A-B608E9BD7917@gmail.com>
	<174ACCE3-9C13-4AB3-B8F6-E1D166B65063@seh.de>
	<129C4415-FB4F-40B3-9727-36484B8E96D3@gmail.com>
Message-ID: <6CE05C89-41CE-4EC0-AF15-E71FC442820C@seh.de>


Am 21.08.2009 um 17:56 schrieb Wolfgang Schuster:
> The zip is here http://modules.contextgarden.net/typescripts and the  
> dev version
> can be found at http://bitbucket.org/wolfs/typescripts/ but as i  
> don't need them
> myself other users are needed to add more typescripts.

Ahh many thanks for the links. I have not looked at the modules site.  
I'll download it right away and will try to get it work in the  
standard TeXlive Context (MKII) distribution.

Thanks and a nice WE!
J?rg 

From schuster.wolfgang at googlemail.com  Sat Aug 22 12:42:29 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sat, 22 Aug 2009 12:42:29 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <6CE05C89-41CE-4EC0-AF15-E71FC442820C@seh.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<D814981B-BDF4-4E9B-A8AD-99F80A267E54@seh.de>
	<9691437A-B9F8-44D2-AC5A-B608E9BD7917@gmail.com>
	<174ACCE3-9C13-4AB3-B8F6-E1D166B65063@seh.de>
	<129C4415-FB4F-40B3-9727-36484B8E96D3@gmail.com>
	<6CE05C89-41CE-4EC0-AF15-E71FC442820C@seh.de>
Message-ID: <9D56D818-7A24-41EA-889F-83FCAA5237BF@gmail.com>


Am 21.08.2009 um 22:45 schrieb J?rg Hecke:

> Ahh many thanks for the links. I have not looked at the modules  
> site. I'll download it right away and will try to get it work in the  
> standard TeXlive Context (MKII) distribution.

The typescripts in the package work only with LuaTeX or XeTeX, to use  
them
with TeXLive 2008 process your files with 'texexec --xetex <filename>'.

There will be *no* support for pdfTeX from me.

Wolfgang


From oliver.buerschaper at mpq.mpg.de  Sat Aug 22 13:47:06 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Sat, 22 Aug 2009 13:47:06 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
Message-ID: <C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>

>> Would it then be possible to have ConTeXt grind to a complete halt  
>> once it encounters a module whose minimum requirements aren't met?
>
> \doifolderversionelse\contextversion{2100.01.01}\normalend\donothing
> %\doifolderversionelse\contextversion{2009.07.01}\normalend\donothing
>
> \starttext
> Hello
> \stoptext

That's great! It's almost what I was looking for ... yet I think  
\normalend might not be drastic enough ;-) Namely, running this  
example with

context test.tex

gives me the following terminal output:

---
MTXrun | run 1: luatex --fmt="/Users/oliver/.context/2009-06-13-beta/ 
luatex-cache/context/18b584d8d585db5fc4cbfa8499d343d8/formats/cont-en"  
--lua="/Users/oliver/.context/2009-06-13-beta/luatex-cache/context/ 
18b584d8d585db5fc4cbfa8499d343d8/formats/cont-en.lui" --backend=pdf "./ 
general-0002.tex"
This is LuaTeX, Version beta-0.40.5-2009061123 (Web2C 2009)
  \write18 enabled.
(general-0002.tex
color           : system all is global activated
color           : system gray is global activated
color           : mpcmyk color space is supported
color           : mpspot color space is supported
color           : system rgb is global activated
color           : system all is global activated

ConTeXt  ver: 2009.06.13 13:37 MKIV  fmt: 2009.8.15  int: english/ 
english

system          : cont-new loaded
(/usr/local/context/2009-06-13-beta/texmf-context/tex/context/base/ 
cont-new.tex
systems         : beware: some patches loaded from cont-new.tex
(/usr/local/context/2009-06-13-beta/texmf-context/tex/context/base/ 
cont-new.mkiv) (/usr/local/context/2009-06-13-beta/texmf-context/tex/ 
context/base/cont-mtx.tex))
system          : cont-fil loaded
(/usr/local/context/2009-06-13-beta/texmf-context/tex/context/base/ 
cont-fil.tex
loading         : ConTeXt File Synonyms
)
system          : cont-sys.rme loaded
(/usr/local/context/2009-06-13-beta/texmf-context/tex/context/user/ 
cont-sys.rme (/usr/local/context/2009-06-13-beta/texmf-context/tex/ 
context/base/type-tmf.tex) (/usr/local/context/2009-06-13-beta/texmf- 
context/tex/context/base/type-siz.tex (/usr/local/context/2009-06-13- 
beta/texmf-context/tex/context/base/type-siz.mkiv)) (/usr/local/ 
context/2009-06-13-beta/texmf-context/tex/context/base/type-otf.tex (/ 
usr/local/context/2009-06-13-beta/texmf-context/tex/context/base/type- 
otf.mkiv)))
system          : general-0002.top loaded
(general-0002.top)
fonts           : preloading latin modern fonts
bodyfont        : 12pt rm is loaded
language        : language en is active
  )
mkiv lua stats : used config path          - /usr/local/context/ 
2009-06-13-beta/texmf/web2c/texmf.cnf
mkiv lua stats : used cache path           - /Users/oliver/.context/ 
2009-06-13-beta
mkiv lua stats : input load time           - 0.022 seconds
mkiv lua stats : stored bytecode data      - 170 modules, 45 tables,  
215 chunks
mkiv lua stats : cleaned up reserved nodes - 18 nodes, 8 lists of 1411
mkiv lua stats : node memory usage         - 18 glue_spec, 2 dir
mkiv lua stats : loaded patterns           - en:us:pat:exc:2
mkiv lua stats : startup time              - 0.706 seconds (including  
runtime option file processing)
mkiv lua stats : callbacks                 - direct: 56, indirect:  
4741, total: 4797
mkiv lua stats : loaded fonts              - 31 files: lmmono12- 
regular.otf lmmono8-regular.otf lmmono9-regular.otf lmroman12-bold.otf  
lmroman12-regular.otf lmroman7-bold.otf lmroman7-regular.otf lmroman9- 
bold.otf lmroman9-regular.otf lmsans12-regular.otf lmsans8-regular.otf  
lmsans9-regular.otf eufb10.tfm eufb7.tfm eufb9.tfm eufm10.tfm  
eufm7.tfm eufm9.tfm msam10.tfm msam7.tfm msbm10.tfm msbm7.tfm  
lmex10.tfm lmmi12.tfm lmmi7.tfm lmmi9.tfm lmmib10.tfm lmmib7.tfm  
lmsy10.tfm lmsy7.tfm lmsy9.tfm
mkiv lua stats : fonts load time           - 0.369 seconds
mkiv lua stats : result saved in file      - general-0002.pdf
mkiv lua stats : luatex banner             - this is luatex, version  
beta-0.40.5
mkiv lua stats : control sequences         - 29596 of 165536
mkiv lua stats : current memory usage      - 29 MB (ctx: 29 MB)
mkiv lua stats : runtime                   - 1.242 seconds
MTXrun | total runtime: 1.270
---

This states erronously that the result was saved in a PDF file (sixth  
line from the bottom) although it wasn't (which is correct, of course).

What's more important, the exit status of the context command is 0  
(via echo $?) indicating that there was no problem at all! This might  
turn out problematic as soon as documents are processed in a batch  
run ... (like e.g. a regression test suite ;-)


>> Since TeX would have to give up on the document anyway perhaps an  
>> early bail out could be the more graceful option ... what do you  
>> think?
>
>
> I can add this test to my module together with a message at the  
> terminal.

This would be wonderful!

Perhaps one could even integrate this requirement check into the  
module loading code of the kernel. For example, one might enforce that  
each valid module has to declare a field like "minkernelversion" in  
its header ... just thinking out loud.

Oliver

From oliver.buerschaper at mpq.mpg.de  Sat Aug 22 14:09:17 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Sat, 22 Aug 2009 14:09:17 +0200
Subject: [dev-context] Cache path creation
Message-ID: <A24BF75B-9C4A-414E-9F06-CFBDAB94DB30@mpq.mpg.de>

Dear all,

here's a thing that's puzzling me ... I set up the cache path in texmf/ 
web2c/texmfcnf.lua to point to a location which doesn't exist yet.  
Running

luatools --generate

now gives me different results with ConTeXt versions 2009.06.11 and  
2009.06.13. The former one politely asks me whether it should generate  
the cache path while the latter version does not but moves straight on  
to business. Grepping through the source code I'm somehow unable to  
find out which part of the source is responsible for this change :-(

Personally, I prefer the second behaviour anyway. This is because I  
adjusted texmfcnf.lua deliberately such that the cache data is dumped  
to the user's home directory. In particular, luatools --generate  
doesn't need admin rights so if for some reason it attempts to write  
to protected system areas this will be blocked anyway. So let's say  
I'm just curious ...

Oliver

From pragma at wxs.nl  Sat Aug 22 15:05:18 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 22 Aug 2009 15:05:18 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
Message-ID: <4A8FED0E.1000906@wxs.nl>

Oliver Buerschaper wrote:
>>> Would it then be possible to have ConTeXt grind to a complete halt 
>>> once it encounters a module whose minimum requirements aren't met?
>>
>> \doifolderversionelse\contextversion{2100.01.01}\normalend\donothing
>> %\doifolderversionelse\contextversion{2009.07.01}\normalend\donothing
>>
>> \starttext
>> Hello
>> \stoptext
> 
> That's great! It's almost what I was looking for ... yet I think 
> \normalend might not be drastic enough ;-) Namely, running this example 
> with

I'll add:

\unprotect

\def\forcequitjob#1%
   {\writestatus\m!systems{forcing quit: #1}%
    \batchmode
    \dorecurse\textlevel\stoptext
    \normalend}

\protect

\starttext
     test \forcequitjob{whatever}
\stoptext


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat Aug 22 15:14:39 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 22 Aug 2009 15:14:39 +0200
Subject: [dev-context] Cache path creation
In-Reply-To: <A24BF75B-9C4A-414E-9F06-CFBDAB94DB30@mpq.mpg.de>
References: <A24BF75B-9C4A-414E-9F06-CFBDAB94DB30@mpq.mpg.de>
Message-ID: <4A8FEF3F.1000408@wxs.nl>

Oliver Buerschaper wrote:
> Dear all,
> 
> here's a thing that's puzzling me ... I set up the cache path in 
> texmf/web2c/texmfcnf.lua to point to a location which doesn't exist yet. 
> Running
> 
> luatools --generate
> 
> now gives me different results with ConTeXt versions 2009.06.11 and 
> 2009.06.13. The former one politely asks me whether it should generate 
> the cache path while the latter version does not but moves straight on 
> to business. Grepping through the source code I'm somehow unable to find 
> out which part of the source is responsible for this change :-(
> 
> Personally, I prefer the second behaviour anyway. This is because I 
> adjusted texmfcnf.lua deliberately such that the cache data is dumped to 
> the user's home directory. In particular, luatools --generate doesn't 
> need admin rights so if for some reason it attempts to write to 
> protected system areas this will be blocked anyway. So let's say I'm 
> just curious ...

maybe a difference between the mtxrun/luatools files (with merged, maybe 
older, libs) and the rest

anyhow, this is the code that creates ...

                     elseif caches.force or io.ask(format("\nShould I 
create the cache path %s?",cachepath), "no", { "yes", "no" }) == "yes" then
                         dir.mkdirs(cachepath)


Hans



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Sun Aug 23 15:11:51 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 23 Aug 2009 15:11:51 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
Message-ID: <EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>


Am 22.08.2009 um 13:47 schrieb Oliver Buerschaper:

> What's more important, the exit status of the context command is 0  
> (via echo $?) indicating that there was no problem at all! This  
> might turn out problematic as soon as documents are processed in a  
> batch run ... (like e.g. a regression test suite ;-)

*You* want to write a test suite for ConTeXt?

> Perhaps one could even integrate this requirement check into the  
> module loading code of the kernel. For example, one might enforce  
> that each valid module has to declare a field like  
> "minkernelversion" in its header ... just thinking out loud.

The problem with such systems is they lead always to incompatibilities  
with older
ConTeXt installations (think about TeXLive) and we had one at the end  
of last year
when Hans changed the multilingual interface to allow a persian  
interface.

Wolfgang


From adityam at umich.edu  Sun Aug 23 17:22:38 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 23 Aug 2009 11:22:38 -0400 (EDT)
Subject: [dev-context] Mac installation package
In-Reply-To: <EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
Message-ID: <alpine.LNX.2.00.0908231117210.31641@ybpnyubfg.ybpnyqbznva>

On Sun, 23 Aug 2009, Wolfgang Schuster wrote:

>
> Am 22.08.2009 um 13:47 schrieb Oliver Buerschaper:
>
>> What's more important, the exit status of the context command is 0 (via 
>> echo $?) indicating that there was no problem at all! This might turn out 
>> problematic as soon as documents are processed in a batch run ... (like 
>> e.g. a regression test suite ;-)
>
> *You* want to write a test suite for ConTeXt?

The test suite is there. There is even a script in the test suit that 
compares the outputs of two versions at pixel level. All we need is people 
to submit tests and then someone to monitor the test suite. See
http://wiki.contextgarden.net/Test

>> Perhaps one could even integrate this requirement check into the module 
>> loading code of the kernel. For example, one might enforce that each valid 
>> module has to declare a field like "minkernelversion" in its header ... 
>> just thinking out loud.
>
> The problem with such systems is they lead always to incompatibilities 
> with ConTeXt installations (think about TeXLive) and we had one at the 
> end of last year when Hans changed the multilingual interface to allow a 
> persian interface.

Loading of lua files has this feature. For modules, asking for a 
minimum kernel version is no guarantee that the module will work with 
future versions of ConTeXT :-)

Aditya

From oliver.buerschaper at mpq.mpg.de  Sun Aug 23 17:52:55 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Sun, 23 Aug 2009 17:52:55 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
Message-ID: <E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>

>> What's more important, the exit status of the context command is 0  
>> (via echo $?) indicating that there was no problem at all! This  
>> might turn out problematic as soon as documents are processed in a  
>> batch run ... (like e.g. a regression test suite ;-)
>
> *You* want to write a test suite for ConTeXt?

Well, not exactly ... this might be too ambitious an endeavour for one  
person alone ;-)

I'm trying though to store a bunch of test cases locally which I  
sporadically collect from the main mailing test whenever a bug report  
shows up. If only to have something I can test my installation package  
against ...

For the moment I'm mainly interested in whether these test cases  
compile at all hence my remark about the exit status ... (After all,  
if that can't be automated any further verification steps will be  
pretty much useless I guess.)


>> Perhaps one could even integrate this requirement check into the  
>> module loading code of the kernel. For example, one might enforce  
>> that each valid module has to declare a field like  
>> "minkernelversion" in its header ... just thinking out loud.
>
> The problem with such systems is they lead always to  
> incompatibilities with older
> ConTeXt installations (think about TeXLive) and we had one at the  
> end of last year
> when Hans changed the multilingual interface to allow a persian  
> interface.

I agree that my suggestion would sacrifice backwards compatibility. At  
the same time I'm not sure how much change to the MkIV kernel is  
desirable given that MkII is considered frozen. I'm really in no  
position to have an educated opinion on whether there should be as few  
changes as possible or rather the occasional clear cut. It's just that  
if you guys think that some clear cuts are due for MkIV anyway then  
there will probably be never a better time than now to make module  
loading more bullet-proof. As I was saying, I'm just thinking out  
loud ;-)

Oliver

From schuster.wolfgang at googlemail.com  Sun Aug 23 20:38:15 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 23 Aug 2009 20:38:15 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <alpine.LNX.2.00.0908231117210.31641@ybpnyubfg.ybpnyqbznva>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<alpine.LNX.2.00.0908231117210.31641@ybpnyubfg.ybpnyqbznva>
Message-ID: <1B36EC6C-3B23-4B6E-9740-1430852F59D6@gmail.com>


Am 23.08.2009 um 17:22 schrieb Aditya Mahajan:

>> *You* want to write a test suite for ConTeXt?
>
> The test suite is there. There is even a script in the test suit  
> that compares the outputs of two versions at pixel level. All we  
> need is people to submit tests and then someone to monitor the test  
> suite. See
> http://wiki.contextgarden.net/Test

Is this still alive and used?

Wolfgang


From schuster.wolfgang at googlemail.com  Sun Aug 23 20:48:21 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 23 Aug 2009 20:48:21 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
Message-ID: <1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>


Am 23.08.2009 um 17:52 schrieb Oliver Buerschaper:

> I agree that my suggestion would sacrifice backwards compatibility.  
> At the same time I'm not sure how much change to the MkIV kernel is  
> desirable given that MkII is considered frozen. I'm really in no  
> position to have an educated opinion on whether there should be as  
> few changes as possible or rather the occasional clear cut. It's  
> just that if you guys think that some clear cuts are due for MkIV  
> anyway then there will probably be never a better time than now to  
> make module loading more bullet-proof. As I was saying, I'm just  
> thinking out loud ;-)

MkIV is ConTeXt?s feature without an doubt but it's not so easy as you  
think.

I have myself two modules which work only with MkIV (simplefonts and  
games) but
bigger ones like simpleslides or letter are just complexer styles and  
you can't
expect from a user to upgrade to MkIV just to make a presentation or  
to write
a short letter.

I thought about integrating the version check into \setupmodule  
because the command
is only used in modules and available in MkII and MkIV but Thomas and  
Aditya use it
in the simpleslides module to pass parameters to the module and this a  
few times
at different places and not only at the start of the file.

Wolfgang


From adityam at umich.edu  Sun Aug 23 22:03:03 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 23 Aug 2009 16:03:03 -0400 (EDT)
Subject: [dev-context] Mac installation package
In-Reply-To: <1B36EC6C-3B23-4B6E-9740-1430852F59D6@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<alpine.LNX.2.00.0908231117210.31641@ybpnyubfg.ybpnyqbznva>
	<1B36EC6C-3B23-4B6E-9740-1430852F59D6@gmail.com>
Message-ID: <alpine.LNX.2.00.0908231600220.31641@ybpnyubfg.ybpnyqbznva>

On Sun, 23 Aug 2009, Wolfgang Schuster wrote:

>
> Am 23.08.2009 um 17:22 schrieb Aditya Mahajan:
>
>>> *You* want to write a test suite for ConTeXt?
>> 
>> The test suite is there. There is even a script in the test suit that 
>> compares the outputs of two versions at pixel level. All we need is people 
>> to submit tests and then someone to monitor the test suite. See
>> http://wiki.contextgarden.net/Test
>
> Is this still alive and used?

It is alive (as in, you can submit test cases) but it is not used. I think 
that Hans and Taco have made it clear that someone else need to volunteer 
for running the test suite.

Sanjoy had some ideas, but then he became busy with other things.

I still think that it is a good idea for people to submit examples to the 
test suite. Maybe having enough tests will be an incentive for someone to 
write a regression suite.

Aditya

From adityam at umich.edu  Sun Aug 23 22:06:44 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 23 Aug 2009 16:06:44 -0400 (EDT)
Subject: [dev-context] Mac installation package
In-Reply-To: <1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
Message-ID: <alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>

On Sun, 23 Aug 2009, Wolfgang Schuster wrote:

>
> Am 23.08.2009 um 17:52 schrieb Oliver Buerschaper:
>
>> I agree that my suggestion would sacrifice backwards compatibility. At the 
>> same time I'm not sure how much change to the MkIV kernel is desirable 
>> given that MkII is considered frozen. I'm really in no position to have an 
>> educated opinion on whether there should be as few changes as possible or 
>> rather the occasional clear cut. It's just that if you guys think that some 
>> clear cuts are due for MkIV anyway then there will probably be never a 
>> better time than now to make module loading more bullet-proof. As I was 
>> saying, I'm just thinking out loud ;-)
>
> MkIV is ConTeXt?s feature without an doubt but it's not so easy as you think.
>
> I have myself two modules which work only with MkIV (simplefonts and 
> games) but bigger ones like simpleslides or letter are just complexer 
> styles and you can't expect from a user to upgrade to MkIV just to make 
> a presentation or to write a short letter.
>
> I thought about integrating the version check into \setupmodule because 
> the command is only used in modules and available in MkII and MkIV but 
> Thomas and Aditya use it in the simpleslides module to pass parameters 
> to the module and this a few times at different places and not only at 
> the start of the file.

If you have a suggestion that will make things cleaner, we (Thomas and I) 
can easily change the internals of simple slides to accomodate that.

Aditya

From schuster.wolfgang at googlemail.com  Sun Aug 23 23:18:39 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 23 Aug 2009 23:18:39 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
Message-ID: <BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>


Am 23.08.2009 um 22:06 schrieb Aditya Mahajan:

> On Sun, 23 Aug 2009, Wolfgang Schuster wrote:
>
>> I thought about integrating the version check into \setupmodule  
>> because the command is only used in modules and available in MkII  
>> and MkIV but Thomas and Aditya use it in the simpleslides module to  
>> pass parameters to the module and this a few times at different  
>> places and not only at the start of the file.
>
> If you have a suggestion that will make things cleaner, we (Thomas  
> and I) can easily change the internals of simple slides to  
> accomodate that.

To stop the TeX run we can have

   \setupmodule[contextversion=2009.08.22]

at the begin of a module and ConTeXt will abort the run if the key  
'contextversion'
has a value and context is older than the user has requested.

In your module you can either use \getparameters or ? what I think you  
want in your
module ? \setvariables because it's not very different to \setupmodule.

Wolfgang


From adityam at umich.edu  Mon Aug 24 00:17:58 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 23 Aug 2009 18:17:58 -0400 (EDT)
Subject: [dev-context] Mac installation package
In-Reply-To: <BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>
Message-ID: <alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>

On Sun, 23 Aug 2009, Wolfgang Schuster wrote:

>
> Am 23.08.2009 um 22:06 schrieb Aditya Mahajan:
>
>> On Sun, 23 Aug 2009, Wolfgang Schuster wrote:
>> 
>>> I thought about integrating the version check into \setupmodule because 
>>> the command is only used in modules and available in MkII and MkIV but 
>>> Thomas and Aditya use it in the simpleslides module to pass parameters to 
>>> the module and this a few times at different places and not only at the 
>>> start of the file.
>> 
>> If you have a suggestion that will make things cleaner, we (Thomas and I) 
>> can easily change the internals of simple slides to accomodate that.

> In your module you can either use \getparameters or ? what I think you 
> want in your module ? \setvariables because it's not very different to 
> \setupmodule.

I thought that \setupmodule was meant for passing parameters to modules, 
mainly because of the following comment in core-fil

% \usemodule[newmml]
% \usemodule[newmml][a=b]
% \usemodule[x][newmml]
% \usemodule[x][newmml][a=b]
%
% \startmodule [mathml]
%   \setupmodule[a=c] \relax [\currentmoduleparameter{a}] % user vars will 
be set afterwards
%   \setupmodule[a=c] \relax [\currentmoduleparameter{a}] % user vars are 
now forgotten
% \stopmodule

As, \setupmodule is just \getparameters with a few defaults in place, 
I can also use \getparamters with \currentmoduleparamters.

> To stop the TeX run we can have
>
> \setupmodule[contextversion=2009.08.22]
>
> at the begin of a module and ConTeXt will abort the run if the key 
> 'contextversion' has a value and context is older than the user has 
> requested.

Do you want this to check to be part of the definition of \setupmodule? 
One difficultly that I see is that typically this will mean that we need 
to set this separately for each engine.

Aditya

From schuster.wolfgang at googlemail.com  Mon Aug 24 09:19:42 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Mon, 24 Aug 2009 09:19:42 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>
	<alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>
Message-ID: <56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>


Am 24.08.2009 um 00:17 schrieb Aditya Mahajan:

>> In your module you can either use \getparameters or ? what I think  
>> you want in your module ? \setvariables because it's not very  
>> different to \setupmodule.
>
> I thought that \setupmodule was meant for passing parameters to  
> modules, mainly because of the following comment in core-fil

Is this passing parameters to the module, I don't think so!

\def\dosetupTitle[#1]%
   {\setupmodule[simpleslides:title][#1]}

> As, \setupmodule is just \getparameters with a few defaults in  
> place, I can also use \getparamters with \currentmoduleparamters.

You use \currentmoduleparameter only in t-simpleslides to load a style  
file
but \moduleparameter is used many other files to setvariables etc. and  
the last
one is more like \getvariables (which use rawparameters)

>> To stop the TeX run we can have
>>
>> \setupmodule[contextversion=2009.08.22]
>>
>> at the begin of a module and ConTeXt will abort the run if the key  
>> 'contextversion' has a value and context is older than the user has  
>> requested.
>
> Do you want this to check to be part of the definition of  
> \setupmodule? One difficultly that I see is that typically this will  
> mean that we need to set this separately for each engine.

I don't need such a check, it was Olivers idea and I thought about a  
idea how this
can be integrated without introducing a new command which breaks  
backward compatibility.

Wolfgang


From oliver.buerschaper at mpq.mpg.de  Mon Aug 24 09:52:29 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Mon, 24 Aug 2009 09:52:29 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <alpine.LNX.2.00.0908231117210.31641@ybpnyubfg.ybpnyqbznva>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<alpine.LNX.2.00.0908231117210.31641@ybpnyubfg.ybpnyqbznva>
Message-ID: <3F061609-F467-4DAD-815E-3A2C2750591E@mpq.mpg.de>

>> *You* want to write a test suite for ConTeXt?
>
> The test suite is there. There is even a script in the test suit  
> that compares the outputs of two versions at pixel level. All we  
> need is people to submit tests and then someone to monitor the test  
> suite. See
> http://wiki.contextgarden.net/Test

Yep, I almost forgot about that ... so we have a foundation to build  
on! Someone then also needs to decide on which test code conforms to  
(current) valid syntax (which is probably *not* just everything that  
compiles ... think of deprecated code, hacks, workarounds etc. that  
aren't considered best practices).


>> The problem with such systems is they lead always to  
>> incompatibilities with ConTeXt installations (think about TeXLive)  
>> and we had one at the end of last year when Hans changed the  
>> multilingual interface to allow a persian interface.
>
> Loading of lua files has this feature. For modules, asking for a  
> minimum kernel version is no guarantee that the module will work  
> with future versions of ConTeXT :-)

Yes, but it's a start ...

Oliver

From oliver.buerschaper at mpq.mpg.de  Mon Aug 24 10:07:16 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Mon, 24 Aug 2009 10:07:16 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
Message-ID: <AB01F7DB-9A9A-436B-9471-C973AE027C58@mpq.mpg.de>

> MkIV is ConTeXt?s feature without an doubt but it's not so easy as  
> you think.
>
> I have myself two modules which work only with MkIV (simplefonts and  
> games) but
> bigger ones like simpleslides or letter are just complexer styles  
> and you can't
> expect from a user to upgrade to MkIV just to make a presentation or  
> to write
> a short letter.
>
> I thought about integrating the version check into \setupmodule  
> because the command
> is only used in modules and available in MkII and MkIV but Thomas  
> and Aditya use it
> in the simpleslides module to pass parameters to the module and this  
> a few times
> at different places and not only at the start of the file.

Perhaps this is too simple ... what about some passive check on behalf  
of the module? That is, would the MkII kernel evaluate another field  
in the module's header upon loading or ignore it because it doesn't  
recognize the additional info? In the latter case the MkIV kernel  
could evaluate the additional header and refuse to load the module if  
necessary.

Of course, this wouldn't prevent an MkIV only module from being loaded  
in MkII but it would implement the compatibility check at least for  
MkIV. But that's probably fine given that some modules are MkIV  
exclusive already :-) And even for existing modules one will probably  
have to split into (frozen?) MkII and current MkIV versions at some  
point anyway ...

Well, just a thought.

Oliver

From adityam at umich.edu  Mon Aug 24 16:27:50 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Mon, 24 Aug 2009 10:27:50 -0400 (EDT)
Subject: [dev-context] Mac installation package
In-Reply-To: <56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>
	<alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>
	<56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>
Message-ID: <alpine.LNX.2.00.0908241023140.1174@ybpnyubfg.ybpnyqbznva>

On Mon, 24 Aug 2009, Wolfgang Schuster wrote:

>
> Am 24.08.2009 um 00:17 schrieb Aditya Mahajan:
>
>>> In your module you can either use \getparameters or ? what I think you 
>>> want in your module ? \setvariables because it's not very different to 
>>> \setupmodule.
>> 
>> I thought that \setupmodule was meant for passing parameters to modules, 
>> mainly because of the following comment in core-fil
>
> Is this passing parameters to the module, I don't think so!
>
> \def\dosetupTitle[#1]%
> {\setupmodule[simpleslides:title][#1]}

Oh those. I had forgotten about them :) I will change these to 
\getvariables.

>> As, \setupmodule is just \getparameters with a few defaults in place, I can 
>> also use \getparamters with \currentmoduleparamters.
>
> You use \currentmoduleparameter only in t-simpleslides to load a style file
> but \moduleparameter is used many other files to setvariables etc. and the 
> last
> one is more like \getvariables (which use rawparameters)

I agree.

>>> To stop the TeX run we can have
>>> 
>>> \setupmodule[contextversion=2009.08.22]
>>> 
>>> at the begin of a module and ConTeXt will abort the run if the key 
>>> 'contextversion' has a value and context is older than the user has 
>>> requested.
>> 
>> Do you want this to check to be part of the definition of \setupmodule? One 
>> difficultly that I see is that typically this will mean that we need to set 
>> this separately for each engine.
>
> I don't need such a check, it was Olivers idea and I thought about a idea how 
> this
> can be integrated without introducing a new command which breaks backward 
> compatibility.


I meant that when you said
\setupmodule[contextversion=...]", what is the implementation you had in 
mind. \setupmodule macro doing the checking, or the module writer doing 
the checking.

Aditya

From schuster.wolfgang at googlemail.com  Mon Aug 24 23:55:31 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Mon, 24 Aug 2009 23:55:31 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <alpine.LNX.2.00.0908241023140.1174@ybpnyubfg.ybpnyqbznva>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>
	<alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>
	<56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>
	<alpine.LNX.2.00.0908241023140.1174@ybpnyubfg.ybpnyqbznva>
Message-ID: <DD0F0EB5-ED76-466A-9C79-139389D2469E@gmail.com>


Am 24.08.2009 um 16:27 schrieb Aditya Mahajan:

>>>> To stop the TeX run we can have
>>>> \setupmodule[contextversion=2009.08.22]
>>>> at the begin of a module and ConTeXt will abort the run if the  
>>>> key 'contextversion' has a value and context is older than the  
>>>> user has requested.
>>> Do you want this to check to be part of the definition of  
>>> \setupmodule? One difficultly that I see is that typically this  
>>> will mean that we need to set this separately for each engine.
>>
>> I don't need such a check, it was Olivers idea and I thought about  
>> a idea how this
>> can be integrated without introducing a new command which breaks  
>> backward compatibility.
>
> I meant that when you said
> \setupmodule[contextversion=...]", what is the implementation you  
> had in mind. \setupmodule macro doing the checking, or the module  
> writer doing the checking.

I think it's up to the developer to write something in the module,
e.g. http://bitbucket.org/wolfs/simplefonts/src/46a1f454bccc/files/t-simplefonts.tex
but it's not so hard to integrate it into the \setupmodule command.

% untested, it should only show how \setupmodule can be extended to  
stop a tex run
% when a module is used with a too old context version

\def\c!contextversion{contextversion}

\def\doabortmodule#1#2#3%
   {\doif{#2}\c!contextversion{\doifolderversionelse\contextversion{#3} 
{\forcequitjob{#1}}\donothing}}

\def\dosetupmodule[#1][#2]%
   {\scratchtoks\expandafter{\currentmoduleparameters}%
    \ifsecondargument
      \getparameters[\??md:#1:][#2]%
      \expanded{\getparameters[\??md:#1:][\the\scratchtoks]}%
      \processassignmentlist[#2]{\doabortmodule{#1}}%
    \else
      \getparameters[\??md:\currentmodule:][#1]%
      \expanded{\getparameters[\??md:\currentmodule:][\the 
\scratchtoks]}%
      \processassignmentlist[#1]{\doabortmodule\currentmodule}%
    \fi
    \let\currentmoduleparameters\empty}

Wolfgang


From pragma at wxs.nl  Tue Aug 25 00:20:13 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 25 Aug 2009 00:20:13 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <DD0F0EB5-ED76-466A-9C79-139389D2469E@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>	<alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>	<56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>	<alpine.LNX.2.00.0908241023140.1174@ybpnyubfg.ybpnyqbznva>
	<DD0F0EB5-ED76-466A-9C79-139389D2469E@gmail.com>
Message-ID: <4A93121D.8050309@wxs.nl>

Wolfgang Schuster wrote:
> 
> Am 24.08.2009 um 16:27 schrieb Aditya Mahajan:
> 
>>>>> To stop the TeX run we can have
>>>>> \setupmodule[contextversion=2009.08.22]
>>>>> at the begin of a module and ConTeXt will abort the run if the key 
>>>>> 'contextversion' has a value and context is older than the user has 
>>>>> requested.
>>>> Do you want this to check to be part of the definition of 
>>>> \setupmodule? One difficultly that I see is that typically this will 
>>>> mean that we need to set this separately for each engine.
>>>
>>> I don't need such a check, it was Olivers idea and I thought about a 
>>> idea how this
>>> can be integrated without introducing a new command which breaks 
>>> backward compatibility.
>>
>> I meant that when you said
>> \setupmodule[contextversion=...]", what is the implementation you had 
>> in mind. \setupmodule macro doing the checking, or the module writer 
>> doing the checking.
> 
> I think it's up to the developer to write something in the module,
> e.g. 
> http://bitbucket.org/wolfs/simplefonts/src/46a1f454bccc/files/t-simplefonts.tex 
> 
> but it's not so hard to integrate it into the \setupmodule command.
> 
> % untested, it should only show how \setupmodule can be extended to stop 
> a tex run
> % when a module is used with a too old context version
> 
> \def\c!contextversion{contextversion}
> 
> \def\doabortmodule#1#2#3%
>   
> {\doif{#2}\c!contextversion{\doifolderversionelse\contextversion{#3}{\forcequitjob{#1}}\donothing}} 
> 
> 
> \def\dosetupmodule[#1][#2]%
>   {\scratchtoks\expandafter{\currentmoduleparameters}%
>    \ifsecondargument
>      \getparameters[\??md:#1:][#2]%
>      \expanded{\getparameters[\??md:#1:][\the\scratchtoks]}%

no need for toks

\expanded{\getparameters[\??md:#1:]\expandafter}\expandafter[\currentmoduleparameters]% 


but maybe a \hetparameterscommand makes more sense -)

>      \processassignmentlist[#2]{\doabortmodule{#1}}%
>    \else
>      \getparameters[\??md:\currentmodule:][#1]%
>      \expanded{\getparameters[\??md:\currentmodule:][\the\scratchtoks]}%
>      \processassignmentlist[#1]{\doabortmodule\currentmodule}%
>    \fi
>    \let\currentmoduleparameters\empty}

but anyway, i wonder if we should go that route; normally context is 
downward compatible and eventually mkiv will become more stable


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From adityam at umich.edu  Tue Aug 25 03:39:14 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Mon, 24 Aug 2009 21:39:14 -0400 (EDT)
Subject: [dev-context] Mac installation package
In-Reply-To: <DD0F0EB5-ED76-466A-9C79-139389D2469E@gmail.com>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>
	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>
	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>
	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>
	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>
	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>
	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>
	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>
	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>
	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>
	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>
	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>
	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>
	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>
	<alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>
	<56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>
	<alpine.LNX.2.00.0908241023140.1174@ybpnyubfg.ybpnyqbznva>
	<DD0F0EB5-ED76-466A-9C79-139389D2469E@gmail.com>
Message-ID: <alpine.LNX.2.00.0908242137210.29068@ybpnyubfg.ybpnyqbznva>

On Mon, 24 Aug 2009, Wolfgang Schuster wrote:

>
> Am 24.08.2009 um 16:27 schrieb Aditya Mahajan:
>
>>>>> To stop the TeX run we can have
>>>>> \setupmodule[contextversion=2009.08.22]
>>>>> at the begin of a module and ConTeXt will abort the run if the key 
>>>>> 'contextversion' has a value and context is older than the user has 
>>>>> requested.
>>>> Do you want this to check to be part of the definition of \setupmodule? 
>>>> One difficultly that I see is that typically this will mean that we need 
>>>> to set this separately for each engine.
>>> 
>>> I don't need such a check, it was Olivers idea and I thought about a idea 
>>> how this
>>> can be integrated without introducing a new command which breaks backward 
>>> compatibility.
>> 
>> I meant that when you said
>> \setupmodule[contextversion=...]", what is the implementation you had in 
>> mind. \setupmodule macro doing the checking, or the module writer doing the 
>> checking.
>
> I think it's up to the developer to write something in the module,
> e.g. 
> http://bitbucket.org/wolfs/simplefonts/src/46a1f454bccc/files/t-simplefonts.tex
> but it's not so hard to integrate it into the \setupmodule command.

Thanks for clarifying. I also think that it is better to do this 
selectively for each module rather than in the core.

Aditya

From schuster.wolfgang at googlemail.com  Tue Aug 25 09:35:32 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Tue, 25 Aug 2009 09:35:32 +0200
Subject: [dev-context] Mac installation package
In-Reply-To: <4A93121D.8050309@wxs.nl>
References: <mailman.1.1250157602.6800.dev-context@ntg.nl>	<C795C312-9E77-47EA-B5E6-B416ECBEBE79@seh.de>	<C279C687-17DC-43DA-8ED9-FC4449CEBF98@mpq.mpg.de>	<8F04C441-57F3-4676-92E9-2649C4C83D4C@seh.de>	<47E4969C-A209-46EC-B56C-87AC5947437A@mpq.mpg.de>	<292C18ED-BBFB-45BD-A573-6B572EEA7D68@gmail.com>	<40B49E03-5779-4500-9254-B6F76B308B1D@mpq.mpg.de>	<04AC7B89-FC75-40D4-81AA-426C4D4DFF6D@gmail.com>	<C616F08B-CE84-4B94-9B6E-9B153BCBCD4B@mpq.mpg.de>	<EB9E1AFE-999D-4983-A236-F0A2F88F6B6E@gmail.com>	<E3BB3E6F-F311-4B18-8F07-AAC11AD60E2C@mpq.mpg.de>	<1612EB44-6272-4B40-8F94-138087FA8742@gmail.com>	<alpine.LNX.2.00.0908231604380.31641@ybpnyubfg.ybpnyqbznva>	<BF687544-DF07-4431-A029-1821D0E0B626@gmail.com>	<alpine.LNX.2.00.0908231724150.31641@ybpnyubfg.ybpnyqbznva>	<56E828CA-D12A-4435-AF1F-B3B04035319E@gmail.com>	<alpine.LNX.2.00.0908241023140.1174@ybpnyubfg.ybpnyqbznva>
	<DD0F0EB5-ED76-466A-9C79-139389D2469E@gmail.com>
	<4A93121D.8050309@wxs.nl>
Message-ID: <1404359C-81CE-4E3D-A92A-43C15D419741@gmail.com>


Am 25.08.2009 um 00:20 schrieb Hans Hagen:

>> \def\dosetupmodule[#1][#2]%
>> {\scratchtoks\expandafter{\currentmoduleparameters}%
>>  \ifsecondargument
>>    \getparameters[\??md:#1:][#2]%
>>    \expanded{\getparameters[\??md:#1:][\the\scratchtoks]}%
>
> no need for toks
>
> \expanded{\getparameters[\??md:#1:]\expandafter} 
> \expandafter[\currentmoduleparameters]%

hey, you wrote \setupmodule and not me

> but maybe a \hetparameterscommand makes more sense -)

\hetparameterscommand?

>>    \processassignmentlist[#2]{\doabortmodule{#1}}%
>>  \else
>>    \getparameters[\??md:\currentmodule:][#1]%
>>    \expanded{\getparameters[\??md:\currentmodule:][\the 
>> \scratchtoks]}%
>>    \processassignmentlist[#1]{\doabortmodule\currentmodule}%
>>  \fi
>>  \let\currentmoduleparameters\empty}
>
> but anyway, i wonder if we should go that route; normally context is  
> downward compatible and eventually mkiv will become more stable

it was just a example how things can be done

Wolfgang


From taco at elvenkind.com  Mon Sep  7 10:14:54 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 07 Sep 2009 10:14:54 +0200
Subject: [dev-context] [Fwd: context manual]
Message-ID: <4AA4C0FE.6050908@elvenkind.com>

Hi Hans,

Thanks for the message below, it is always a pleasure to get detailed
comments and corrections list yours. So far, I have been te person that
has written most of the updates to the two manual chapters. However,
I am not yet ready to get back to that task, so I am redirecting
your message to dev-context for safe keeping. And who knows, maybe
someone else will step in ...

Best wishes,
Taco

-------- Original Message --------
Subject: 	context manual
Date: 	Mon, 31 Aug 2009 11:19:33 +0200
From: 	Hans van der Meer <H.vanderMeer at uva.nl>
To: 	Taco Hoekwater <taco at elvenkind.com>



Taco,
I do not know who writes/maintains the new context manual texts. I
suspect it is not you, given everything you have on your workbench.
Would you be so kind as to forward this to the author/maintainer?

I have studied somewhat on the texts "Typography" and "Fonts" and have
some remarks. Apart from pointing out a few typos I hope to contribute
positively by delineating passages that were unclear to me and make
suggestions for these. The pagenumbering is that from the pdf files
retrieved from the website about a month ago.

I would like to express my appreciation for this work, really needed in
view of the fact that the original manuals start showing their age. My
comments, therefore, do not imply any criticism.

with best regards
Hans van der Meer

Chapter on Typography

page 14 typo: ... the nearest smaller body font environment is that is
already defined [first is superfluous]

page 20 typo in legenda Table 1.8: ... define hw and cg as 'lucida
handwriting' [missing ti]

page 26: the text below the grey block describing \definefontfeature
seems no to describe the second parameter IDENTIFIER. In fact, below the
block there is: The second argument is a mix, and I think that should
read: The third argument is... Then the description of the second
argument is missing.
Further down the descriptions of tlig and trep are about texligatures
and texquotes, respectively. The near identical texts made me look very
hard for the difference (at first it looked to me an artifact from cut
and paste!); I suggest to reformulate so as to draw more attention to
their different purposes.

Chapter on Fonts

page 2 suggested clarification at the end of the first paragraph below
the block defining \definefontsynonym: ... replacement possible. Beware,
an injudicious choice of successive replacements can induce an infinite
loop and the bottom level is never reached.

page 2 typo below example: In this example, the argument [interchanged
letters]

page 2 example at bottom of the page [file:Iwoa-Regular]: I came about a
situation where for a pfb access it was absolute necessary to add the
suffix .tfm in order to distinguish from another font definition. So
perhaps add a line to the example where that suffix is explicitely used.

page 3 above definition of \setupfontsynonym typo: percolate [not
perculate according to my dictionary, this typo is found elsewhere too]

page 3 in the definition block for \setupfontsynonym: I find the
"inherits from \definefontsynonym" difficult to grasp. Does it mean that
the second parameter here is the same as the third parameter found on
the previous page in the definition of \definefontsynonym? Then the
different argument position clouds the understanding. Furthermore I
wrestled with the word 'inherit'; I tend to understand that in the sense
as classes and subclasses in object oriented programming languages
(having these in my background obviously). But I think another word than
inherit would make clearer that it is 'the same argument as..'

Example on page 5 \ContextLogo \char 2: I interprete the \ContextLogo as
the font switch, but why does \char 2 result in the text CONTEXT?

\definebodyfont example at top of page 7: tf=tir at 10pt Here I cannot
find what 'tir' means, it just 'falls out of the sky' (a Dutch saying).
Although I happen to know that tir is the name of a tfm file in the
Times font set, I suspect that many reader will not. I would suggest
something added above like: ... commercial font in which 'tir' is one of
the font files.

Long \definebodyfont example page 7: Lots of readers will know that cmr
and friends are the Computer Modern Fonts. But wouldn't it be nice to
introduce the font filename in the text above with something like: Hans
Hagen started out using the Computer Modern Roman fonts (cmr).

Example of combining \ss and \sl on page 8: As I understand it, only the
third line of the example is really a combination of \ss and \sl, the
two lines above only about \ss and \sl separately. I guess the sentence
above the example should reflect this.

\definebodyfont examples on page 8: The first, long \definebodyfont
example defines besides tf also bf, it, etc. The text below carries the
suggestion that the three \definebodyfont's below it are doing the same
as the long one before. I suggest disambigue with some dots like so:
[tf=Sans sa 1.000, bf=...]

At bottom of the same page 8: I suggest adding an explicite
clarification of what 'default' means, for example: And in the actual
ConTeXt core the default body fonts are in fact defined with commands
like this, where 'default' stands for a whole bunch of sizes:

Below defintion block of \definebodyfont on page 9: "You can even define
totally new keywords, if you want that." Either an example of that here
or a reference to the same later in the text would be nice. Now the text
seems an appetizer that subsequently is witheld from the reader.

Above definition block of \definebodyfont on page 10 typo: can be used
to define [not defined]. And below that block: definition [missing i]

Below definition block of \definebodyfont on page 10: The sentence "This
was used in ... the identifier default because these definitions were to
be used from within other definitions." Is unclear to me, I fail to see
the 'because'.

On page 10: The two blocks defining each a variant of \definebodyfont I
find confusing. The differ only in the position of the arguments,
IDENTIFIER in first/third position. I would like to see more (explicit)
explanation here, especially on the purpose of these variants. Also the
sentence with ".. so there is clear code that can be shown..." leaves me
in the dark. Or should it read "... there is no clear code...?

At about twothirds of page 11 in 1.5: "...there can be up to three
arguments, and these two sets of arguments..." What are the two sets in
the three arguments? Or is meant the arguments of \usetypescript and
\starttypescript, respectively? Then it would possibly be better to make
that explicit.

At the bottom of page 11: "\usetypescript appears in the list that is
the second argument of \starttypescript..." The text leaves the third
argument in limbo. Is that third argument not matched? How then relate
the two arguments of the example \usetypescript[palatino][ec] to the
third argument of \starttypescipt? It was not clear to me.

Below table on page 12 typo: though [was tough]

In that same sentence on page 12: "Extra arguments to \usetypescript are
ignored..." Are these extra arguments a third, fourth, fifth, etc that
can be added to \usetypescript? What is their role than? If not in MKIV
in MKII perhaps?

Same page 1.5.1 first paragraph: "especially to the third, fourth,..."
suggestion is "especially to its third, fourth,..."

Same page last paragraph typo: precise [was preciese]

Third paragraph on page 13 typo: searched [missing r]

Last example on page 13: \typescriptthree I know this is the macro to
which the third argument of the \starttypescript is defined. But I am
not sure the general reader is aware of that here. I cannot remember
seeing that explained in the text before.

First paragraph page 14: Continuing my last remark, I would suggest an
addition: "Because this is the third argument (\typescriptthree was
defined to ec)..."

Last sentence before 1.5.2 on page 15: I would prefer a rephrase to "...
the Palatino-specific typescripts did acutally define font synonyms,
loaded a map file, and called a predefined bodyfont." I find the "did
actually do anything except" confusing, especially the 'except'.

In table under 1.5.2. on page 15: I find the [*] arguments not explained
and wonder what it means. Obviously not the "matches everything known
from grep" because in one of the examples [*] stands opposed to [all].

Below table on page 15: Can you please elaborate [dtp], it would clarify
the significance of the example.

In 1.5.3 starting on page 17: I think I can remember an email where Hans
Hagen told me about \enableboldmath needed to make boldmath active. I
cannot find it mentioned here. Is it obsolete now?

Second square root example on page 18: It says "Bold math looks like
this:" but below it I see four lines of which the last only in bold. And
I have difficulty to see the difference in typeface with the same
example above, at first sight they appear the same and one has to look
carefully. Perhaps the difference pointed out in the text?

On page 18 over to page 19: "We can also use an indirect method:" Then
in the following example I have difficulty to understand the meaning of
"indirect method".

First paragraph on page 21: "We cannot on the forehand..." My knowledge
of the english language is not as good as I would like, but cannot you
write here: "We cannot know beforehand in what font..." But I might be
totally wrong here.

Last paragraph before 1.7 on page 21 typo: already [missing e]

This is as far as I got.




From taco at elvenkind.com  Thu Oct  1 09:37:16 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 01 Oct 2009 09:37:16 +0200
Subject: [dev-context] Second problem with Pizza and Problems
In-Reply-To: <794B95DF-D56C-4202-B46B-82478004F881@suddenlink.net>
References: <794B95DF-D56C-4202-B46B-82478004F881@suddenlink.net>
Message-ID: <4AC45C2C.4080007@elvenkind.com>


Hi David,

The tikz problem was on the mailing list already.

This problem is because of euler math: the virtual fonts for that
use computer modern for the missing glyphs in the euler set, and
those are not provided by the minimals.

A workaround is to add this statement after the \assignment

  \pdfmapline{=cmsy10 LMMathSymbols10-Italic "enclmmathsy ReEncodeFont"
 <lm-mathsy.enc  <lmsy10.pfb }

(it has to come after the font initialization, hence the ugly place)

Perhaps the minimals should ship the traditional math fonts (cc
dev-context), otherwise we could re-create the euler virtual fonts,
or this mapline (and a dozen or so similar ones) could go into the
euler typescript.

Best wishes,
Taco

David Arnold wrote:
> Hans, Taco,
> 
> If I remove the \usemodule[tikz] and the tikz code, as in the attached
> junk.tex, I still have a problem.
> 
> systems         : end file junk at line 71
> system          : cont-err loaded
> (/Users/darnold/context/tex/texmf-context/tex/context/base/cont-err.tex
> systems         : no file 'cont-sys.tex', using 'cont-sys.rme' instead
> )
> ){/Users/darnold/context/tex/texmf/fonts/enc/dvips/tex-gyre/q-texnansi-sc.enc
> }{/Users/darnold/context/tex/texmf/fonts/enc/dvips/tex-gyre/q-texnansi.enc}
> !pdfTeX error: pdftex (file cmsy10.pfb): cannot open Type 1 font file
> for readi
> ng
>  ==> Fatal error occurred, no output PDF file produced!
> TeXExec | runtime: 0.527318
> 
> This uses the same style files I sent with previous post.
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 

From adityam at umich.edu  Sun Oct  4 19:14:24 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 4 Oct 2009 13:14:24 -0400 (EDT)
Subject: [dev-context] Second problem with Pizza and Problems
In-Reply-To: <4AC45C2C.4080007@elvenkind.com>
References: <794B95DF-D56C-4202-B46B-82478004F881@suddenlink.net>
	<4AC45C2C.4080007@elvenkind.com>
Message-ID: <alpine.LNX.2.00.0910041307220.13299@ybpnyubfg.ybpnyqbznva>

On Thu, 1 Oct 2009, Taco Hoekwater wrote:

> This problem is because of euler math: the virtual fonts for that
> use computer modern for the missing glyphs in the euler set, and
> those are not provided by the minimals.
>
> A workaround is to add this statement after the \assignment
>
>  \pdfmapline{=cmsy10 LMMathSymbols10-Italic "enclmmathsy ReEncodeFont"
> <lm-mathsy.enc  <lmsy10.pfb }
>
> (it has to come after the font initialization, hence the ugly place)
>
> Perhaps the minimals should ship the traditional math fonts (cc
> dev-context), otherwise we could re-create the euler virtual fonts,
> or this mapline (and a dozen or so similar ones) could go into the
> euler typescript.

I thought that we had (by "we" I mean Mojca) already taken care of this/
Here is a minimal example.

\definetypeface [mainface] [rm] [serif] [palatino] [default] [encoding=texnansi]
\definetypeface [mainface] [mm] [math]  [euler] [euler] [encoding=texnansi]

\setupbodyfont[mainface]

\starttext
test $E= \mu c^2 \int_{a}^b \exists$
\stoptext

pdffonts test.pdf gives

name                                 type              emb sub uni object ID
------------------------------------ ----------------- --- --- --- ---------
WXUTWK+TeXGyrePagella-Regular        Type 1            yes yes no       4  0
ZXUTFO+EURM10                        Type 1            yes yes no       5  0
KVDNPZ+EUFM10                        Type 1            yes yes no       6  0
JQWHRK+EUEX10                        Type 1            yes yes no       7  0
YXBNQG+LMMathSymbols10-Regular       Type 1            yes yes no       8  0

So, LM symbols font is being used (for \exists).

David, which version are you using?

Aditya

From taco at elvenkind.com  Tue Oct 13 09:55:22 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 13 Oct 2009 09:55:22 +0200
Subject: [dev-context] bibliography
Message-ID: <4AD4326A.3070507@elvenkind.com>

Hi Patrick,

Can you kick the bib module off contextgarden? Hans has moved
the code to the core, so the standalone module is now obsolete.

Best wishes,
Taco

From mojca.miklavec.lists at gmail.com  Tue Oct 13 16:38:57 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 13 Oct 2009 16:38:57 +0200
Subject: [dev-context] bibliography
In-Reply-To: <4AD4326A.3070507@elvenkind.com>
References: <4AD4326A.3070507@elvenkind.com>
Message-ID: <6faad9f00910130738t6362b1aal763b3dcb5b8b5bcb@mail.gmail.com>

On Tue, Oct 13, 2009 at 09:55, Taco Hoekwater wrote:
> Hi Patrick,
>
> Can you kick the bib module off contextgarden? Hans has moved
> the code to the core, so the standalone module is now obsolete.

Done.

Mojca

From patrick at gundla.ch  Wed Oct 14 04:36:08 2009
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 14 Oct 2009 04:36:08 +0200
Subject: [dev-context] bibliography
In-Reply-To: <4AD4326A.3070507@elvenkind.com>
References: <4AD4326A.3070507@elvenkind.com>
Message-ID: <D4D6330A-7A66-40CB-A2A8-3DE2CFCD07B1@gundla.ch>

On Tue, Oct 13, 2009 at 09:55, Taco Hoekwater wrote:
> Hi Patrick,
>
> Can you kick the bib module off contextgarden? Hans has moved
> the code to the core, so the standalone module is now obsolete.

Done.

Patrick


From mojca.miklavec.lists at gmail.com  Wed Oct 14 14:28:29 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Wed, 14 Oct 2009 14:28:29 +0200
Subject: [dev-context] bibliography
In-Reply-To: <D4D6330A-7A66-40CB-A2A8-3DE2CFCD07B1@gundla.ch>
References: <4AD4326A.3070507@elvenkind.com>
	<D4D6330A-7A66-40CB-A2A8-3DE2CFCD07B1@gundla.ch>
Message-ID: <6faad9f00910140528w13079e3n99d92ff8902f29f8@mail.gmail.com>

On Wed, Oct 14, 2009 at 04:36, Patrick Gundlach wrote:
> On Tue, Oct 13, 2009 at 09:55, Taco Hoekwater wrote:
>>
>> Hi Patrick,
>>
>> Can you kick the bib module off contextgarden? Hans has moved
>> the code to the core, so the standalone module is now obsolete.
>
> Done.

Two people claiming the same thing. You removed it from
modules.contextgarden.net, right? Taco - what exactly did you have in
mind? I removed it just from minimals.

Mojca

From taco at elvenkind.com  Wed Oct 14 14:31:59 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 14 Oct 2009 14:31:59 +0200
Subject: [dev-context] bibliography
In-Reply-To: <6faad9f00910140528w13079e3n99d92ff8902f29f8@mail.gmail.com>
References: <4AD4326A.3070507@elvenkind.com>	<D4D6330A-7A66-40CB-A2A8-3DE2CFCD07B1@gundla.ch>
	<6faad9f00910140528w13079e3n99d92ff8902f29f8@mail.gmail.com>
Message-ID: <4AD5C4BF.2060900@elvenkind.com>



Mojca Miklavec wrote:
> On Wed, Oct 14, 2009 at 04:36, Patrick Gundlach wrote:
>> On Tue, Oct 13, 2009 at 09:55, Taco Hoekwater wrote:
>>> Hi Patrick,
>>>
>>> Can you kick the bib module off contextgarden? Hans has moved
>>> the code to the core, so the standalone module is now obsolete.
>> Done.
> 
> Two people claiming the same thing. You removed it from
> modules.contextgarden.net, right? Taco - what exactly did you have in

I was going for the modules section. :)

From mojca.miklavec.lists at gmail.com  Wed Oct 14 14:34:37 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Wed, 14 Oct 2009 14:34:37 +0200
Subject: [dev-context] bibliography
In-Reply-To: <4AD5C4BF.2060900@elvenkind.com>
References: <4AD4326A.3070507@elvenkind.com>
	<D4D6330A-7A66-40CB-A2A8-3DE2CFCD07B1@gundla.ch>
	<6faad9f00910140528w13079e3n99d92ff8902f29f8@mail.gmail.com>
	<4AD5C4BF.2060900@elvenkind.com>
Message-ID: <6faad9f00910140534u53153e61j4443b7185a0de887@mail.gmail.com>

On Wed, Oct 14, 2009 at 14:31, Taco Hoekwater wrote:
> Mojca Miklavec wrote:
>> On Wed, Oct 14, 2009 at 04:36, Patrick Gundlach wrote:
>>> On Tue, Oct 13, 2009 at 09:55, Taco Hoekwater wrote:
>>>> Hi Patrick,
>>>>
>>>> Can you kick the bib module off contextgarden? Hans has moved
>>>> the code to the core, so the standalone module is now obsolete.
>>> Done.
>>
>> Two people claiming the same thing. You removed it from
>> modules.contextgarden.net, right? Taco - what exactly did you have in
>
> I was going for the modules section. :)

OK, that's perfect :) We both did what had to be done anyway :)

Mojca

From taco at elvenkind.com  Tue Oct 27 12:06:09 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 27 Oct 2009 12:06:09 +0100
Subject: [dev-context] Luatex 0.44.0 announcement
Message-ID: <4AE6D421.5090105@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.44.0.

There are not a lot of new features yet, but this releases fixes
a fair amount of bugs found in 0.43.0 (and earlier versions).

New features:

* libpng is now 1.2.40.

* hlist nodes now have a subtype to distinguish hlists generated
  by the paragraph breaking, explicit \hbox commands, and other
  (as-yet-undefined) sources.

* \pdfobj now has an extra optional keyword: 'uncompressed',
  which forces the object to be written to the PDF in plain
  text (see the manual for the exact details).

* The lua file from the luamd5 library (which provides the
  md5.hexsuma() function) is now embedded in the executable.

Bug fixes:

* \latelua now works in DVI mode again.

* status.output_file_name could crash when used too soon.

* In 0.43, rules were not output at all in DVI mode.

* \leavevmode\penalty-10000\penalty-10000 crashed luatex.

* the API of margin kern nodes to lua was using the wrong
  fields in the nodes.

* A few fixes to the manual.

* PDF Xref stream dicts were slightly non-conformant.

* There was too much space between two consecutive math displays
  (this bug was inherited from Aleph)

* Synctex was broken (thanks, Akira)

* Font mark classes were handled incorrectly by the fontloader
  code.

* There was a crash possible with certain types of named PDF
  destinations.

* Math delimiters and large operators in new MATH fonts no
  longer apply the italic correction (this fixes placements
  of super- and subscripts on such items for those fonts).

* The converter from lua strings to token lists (for the node
  interface) sometimes generated invalid tokens.

* CFF (OpenType) fonts now listen to 'embedding="full"'. TTF
  is still todo.

* Font tables with 'embedding="no"' would cause luatex to crash.

* \pdfobj file {} failed to find the file if there was no lua
  callback in place.

* An optimization in MS Mincho caused luatex to crash.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.44.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From mojca.miklavec.lists at gmail.com  Tue Oct 27 15:06:42 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 27 Oct 2009 15:06:42 +0100
Subject: [dev-context] [Dev-luatex] Luatex 0.44.0 announcement
In-Reply-To: <4AE6D421.5090105@elvenkind.com>
References: <4AE6D421.5090105@elvenkind.com>
Message-ID: <6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>

On Tue, Oct 27, 2009 at 12:06, Taco Hoekwater wrote:
> Hi,
>
> I have just uploaded the archives for a new luatex release, 0.44.0.

My computer is still in Arnhem. If any mac addicts want to have mac
support in minimals before [put some random number of days here], we
need other volunteers.

Same goes for linux (desirable to compile on as old machine as
possible; up to now we have used debian etch).

Mojca

From arthur.reutenauer at normalesup.org  Tue Oct 27 15:14:14 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Tue, 27 Oct 2009 15:14:14 +0100
Subject: [dev-context] [Context] [Dev-luatex] Luatex 0.44.0 announcement
In-Reply-To: <6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>
References: <4AE6D421.5090105@elvenkind.com>
	<6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>
Message-ID: <20091027141414.GG26127@phare.normalesup.org>

> My computer is still in Arnhem. If any mac addicts want to have mac
> support in minimals before [put some random number of days here], we
> need other volunteers.

  I can do that for the Mac, no problem.  Just tell me how you compile
universal binaries, I think I'm not up-to-date on this.

	Arthur

From yuleopen at gmail.com  Tue Oct 27 15:23:12 2009
From: yuleopen at gmail.com (Yue Wang)
Date: Tue, 27 Oct 2009 10:23:12 -0400
Subject: [dev-context] [Context] [Dev-luatex] Luatex 0.44.0 announcement
In-Reply-To: <20091027141414.GG26127@phare.normalesup.org>
References: <4AE6D421.5090105@elvenkind.com>
	<6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>
	<20091027141414.GG26127@phare.normalesup.org>
Message-ID: <68bfdc900910270723o6ab5e50ao6d78a93d2edb1f69@mail.gmail.com>

Hi,

I can compile the x86 and ppc binaries.

Yue Wang

On Tue, Oct 27, 2009 at 10:14 AM, Arthur Reutenauer
<arthur.reutenauer at normalesup.org> wrote:
>> My computer is still in Arnhem. If any mac addicts want to have mac
>> support in minimals before [put some random number of days here], we
>> need other volunteers.
>
> ?I can do that for the Mac, no problem. ?Just tell me how you compile
> universal binaries, I think I'm not up-to-date on this.
>

universal binaries are too big. I think we should provide two
binaries, one for ppc and one for intel.
btw, apple already dropped ppc support in Mac OS X 10.6 and moved to x86_64.
We need to think about how to compile LuaTeX in x86_64.

> ? ? ? ?Arthur
>
> _______________________________________________
> Mailing list: https://launchpad.net/~context
> Post to ? ? : context at lists.launchpad.net
> Unsubscribe : https://launchpad.net/~context
> More help ? : https://help.launchpad.net/ListHelp
>

From pragma at wxs.nl  Tue Oct 27 16:00:41 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 27 Oct 2009 16:00:41 +0100
Subject: [dev-context] [Context] [Dev-luatex] Luatex 0.44.0 announcement
In-Reply-To: <6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>
References: <4AE6D421.5090105@elvenkind.com>
	<6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>
Message-ID: <4AE70B19.80001@wxs.nl>

Mojca Miklavec wrote:
> On Tue, Oct 27, 2009 at 12:06, Taco Hoekwater wrote:
>> Hi,
>>
>> I have just uploaded the archives for a new luatex release, 0.44.0.
> 
> My computer is still in Arnhem. If any mac addicts want to have mac
> support in minimals before [put some random number of days here], we
> need other volunteers.

or we have to get you a new mac

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Tue Oct 27 18:02:04 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 27 Oct 2009 18:02:04 +0100
Subject: [dev-context] [Context] [Dev-luatex] Luatex 0.44.0 announcement
In-Reply-To: <20091027141414.GG26127@phare.normalesup.org>
References: <4AE6D421.5090105@elvenkind.com>
	<6faad9f00910270706u754486f8x7d3d98015fa65b0@mail.gmail.com>
	<20091027141414.GG26127@phare.normalesup.org>
Message-ID: <6faad9f00910271002l31b51f07n1dc1d12ac6e11ba7@mail.gmail.com>

On Tue, Oct 27, 2009 at 15:14, Arthur Reutenauer wrote:
>> My computer is still in Arnhem. If any mac addicts want to have mac
>> support in minimals before [put some random number of days here], we
>> need other volunteers.
>
> ?I can do that for the Mac, no problem. ?Just tell me how you compile
> universal binaries, I think I'm not up-to-date on this.

Take a look at the source code
(http://svn.contextgarden.net/minimals-src/build-binaries/build-binaries.sh).
It's done with lipo.

# generates universal binaries for osx
call_lipo() {
	command="lipo -create $BUILDDIR/bin/osx-intel/current/$1/$2
$BUILDDIR/bin/osx-ppc/current/$1/$2 -output
$BUILDDIR/bin/osx-universal/current/$1/$2"
	# display
	echo "$command"
	#execute
	mkdir -p "$BUILDDIR/bin/osx-universal/current/$1"
	svn add -q --depth=empty "$BUILDDIR/bin/osx-universal/current/$1"
	do_cmd "combine intel & ppc binaries for $2" $command
	svn add -q "$BUILDDIR/bin/osx-universal/current/$1/$2"
}

We don't use those binaries yet, so maybe we are never going to use
them at all (you may skip that step, just make sure that there will be
binaries for intel and ppc, possibly working on ... tiger?). Or make
it work on leopard and wait for the first one to complain :)

Mojca

From khaledhosny at eglug.org  Thu Oct 29 15:52:59 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 29 Oct 2009 16:52:59 +0200
Subject: [dev-context] [Dev-luatex] Luatex 0.44.0 announcement
In-Reply-To: <4AE6D421.5090105@elvenkind.com>
References: <4AE6D421.5090105@elvenkind.com>
Message-ID: <20091029145259.GA27671@khaled-laptop>

On Tue, Oct 27, 2009 at 12:06:09PM +0100, Taco Hoekwater wrote:
> * Math delimiters and large operators in new MATH fonts no
>   longer apply the italic correction (this fixes placements
>   of super- and subscripts on such items for those fonts).

This doesn't sound the correct way to me. The described algorithm in
MATH specification is to set subscripts immediately after the base
(without italic correction) and shift superscripts horizontally by the
amount of italic correction, then apply math kerning if present, this
way fonts with no math kerning will still give acceptable output and
need for math kerning will be minimized.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20091029/5009650b/attachment.pgp>

From mojca.miklavec.lists at gmail.com  Tue Nov 10 16:07:01 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 10 Nov 2009 16:07:01 +0100
Subject: [dev-context] refereces in mkiv
Message-ID: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>

Hello Hans,

what's the status of referencing mechanism in MKIV? (I have some
memories that you were implementing some fancy features, but the
simple example doesn't work at the moment):

\placeformula[test]
\startformula
a+b=c
\stopformula
\in[test]

Thanks,
    Mojca

From adityam at umich.edu  Tue Nov 10 16:12:23 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Tue, 10 Nov 2009 10:12:23 -0500 (EST)
Subject: [dev-context] refereces in mkiv
In-Reply-To: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
Message-ID: <alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>

On Tue, 10 Nov 2009, Mojca Miklavec wrote:

> Hello Hans,
>
> what's the status of referencing mechanism in MKIV? (I have some
> memories that you were implementing some fancy features, but the
> simple example doesn't work at the moment):
>
> \placeformula[test]
> \startformula
> a+b=c
> \stopformula
> \in[test]

Formula referencing has been working fine for a while now.
which version are you using? The example works correctly in 2009.11.09 and 
2009.11.02.

Aditya

From mojca.miklavec.lists at gmail.com  Tue Nov 10 16:35:30 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 10 Nov 2009 16:35:30 +0100
Subject: [dev-context] refereces in mkiv
In-Reply-To: <alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
	<alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>
Message-ID: <6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>

On Tue, Nov 10, 2009 at 16:12, Aditya Mahajan wrote:
> On Tue, 10 Nov 2009, Mojca Miklavec wrote:
>
>> Hello Hans,
>>
>> what's the status of referencing mechanism in MKIV? (I have some
>> memories that you were implementing some fancy features, but the
>> simple example doesn't work at the moment):
>>
>> \placeformula[test]
>> \startformula
>> a+b=c
>> \stopformula
>> \in[test]
>
> Formula referencing has been working fine for a while now.
> which version are you using? The example works correctly in 2009.11.09 and
> 2009.11.02.

The almost-latest one, I guess (2009.11.10 13:30, beta-0.44.0).
And this time I have no TeX Live installed or whatever other version
of ConTeXt that could interfere.

Never mind. I have just seem to have a bad karma. What happens on your
machine with \placeformula[test one]?

Mojca

From adityam at umich.edu  Tue Nov 10 16:45:46 2009
From: adityam at umich.edu (Aditya Mahajan)
Date: Tue, 10 Nov 2009 10:45:46 -0500 (EST)
Subject: [dev-context] refereces in mkiv
In-Reply-To: <6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
	<alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>
	<6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>
Message-ID: <alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>

On Tue, 10 Nov 2009, Mojca Miklavec wrote:

> On Tue, Nov 10, 2009 at 16:12, Aditya Mahajan wrote:
>> On Tue, 10 Nov 2009, Mojca Miklavec wrote:
>>
>>> Hello Hans,
>>>
>>> what's the status of referencing mechanism in MKIV? (I have some
>>> memories that you were implementing some fancy features, but the
>>> simple example doesn't work at the moment):
>>>
>>> \placeformula[test]
>>> \startformula
>>> a+b=c
>>> \stopformula
>>> \in[test]
>>
>> Formula referencing has been working fine for a while now.
>> which version are you using? The example works correctly in 2009.11.09 and
>> 2009.11.02.
>
> The almost-latest one, I guess (2009.11.10 13:30, beta-0.44.0).
> And this time I have no TeX Live installed or whatever other version
> of ConTeXt that could interfere.
>
> Never mind. I have just seem to have a bad karma. What happens on your
> machine with \placeformula[test one]?

that does not work. label with spaces works with sections but not with 
formulas.

Aditya

From pragma at wxs.nl  Tue Nov 10 16:49:20 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 10 Nov 2009 16:49:20 +0100
Subject: [dev-context] refereces in mkiv
In-Reply-To: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
Message-ID: <4AF98B80.8080605@wxs.nl>

Mojca Miklavec wrote:
> Hello Hans,
> 
> what's the status of referencing mechanism in MKIV? (I have some
> memories that you were implementing some fancy features, but the
> simple example doesn't work at the moment):
> 
> \placeformula[test]
> \startformula
> a+b=c
> \stopformula
> \in[test]

if you install the minimals this should work ok -)

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Nov 10 16:52:55 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 10 Nov 2009 16:52:55 +0100
Subject: [dev-context] refereces in mkiv
In-Reply-To: <alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>	<alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>	<6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>
	<alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>
Message-ID: <4AF98C57.3060003@wxs.nl>

Aditya Mahajan wrote:

> that does not work. label with spaces works with sections but not with 
> formulas.

hm, weird

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Tue Nov 10 16:57:43 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 10 Nov 2009 16:57:43 +0100
Subject: [dev-context] refereces in mkiv
In-Reply-To: <alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>	<alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>	<6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>
	<alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>
Message-ID: <4AF98D77.1000400@wxs.nl>

Aditya Mahajan wrote:
> On Tue, 10 Nov 2009, Mojca Miklavec wrote:
> 
>> On Tue, Nov 10, 2009 at 16:12, Aditya Mahajan wrote:
>>> On Tue, 10 Nov 2009, Mojca Miklavec wrote:
>>>
>>>> Hello Hans,
>>>>
>>>> what's the status of referencing mechanism in MKIV? (I have some
>>>> memories that you were implementing some fancy features, but the
>>>> simple example doesn't work at the moment):
>>>>
>>>> \placeformula[test]
>>>> \startformula
>>>> a+b=c
>>>> \stopformula
>>>> \in[test]
>>>
>>> Formula referencing has been working fine for a while now.
>>> which version are you using? The example works correctly in 
>>> 2009.11.09 and
>>> 2009.11.02.
>>
>> The almost-latest one, I guess (2009.11.10 13:30, beta-0.44.0).
>> And this time I have no TeX Live installed or whatever other version
>> of ConTeXt that could interfere.
>>
>> Never mind. I have just seem to have a bad karma. What happens on your
>> machine with \placeformula[test one]?

str-ref.lua, line 199:


                     for s in gmatch(reference,"%s*([^,]+)") do

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mojca.miklavec.lists at gmail.com  Tue Nov 10 18:07:28 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Tue, 10 Nov 2009 18:07:28 +0100
Subject: [dev-context] refereces in mkiv
In-Reply-To: <4AF98D77.1000400@wxs.nl>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>
	<alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>
	<6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>
	<alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>
	<4AF98D77.1000400@wxs.nl>
Message-ID: <6faad9f00911100907h7d43c3cax3c207e5fc4e1bc19@mail.gmail.com>

On Tue, Nov 10, 2009 at 16:57, Hans Hagen wrote:
>
> str-ref.lua, line 199:
>
>
> ? ? ? ? ? ? ? ? ? ?for s in gmatch(reference,"%s*([^,]+)") do

Great! This solves the problem, thanks a lot Hans.

Mojca

(PS: for some weird reason the references have not worked at all with
current (I won't test again), but then I changed the test case before
updating, so I didn't notice that the latest version almost worked.)

From pragma at wxs.nl  Tue Nov 10 18:52:27 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 10 Nov 2009 18:52:27 +0100
Subject: [dev-context] refereces in mkiv
In-Reply-To: <6faad9f00911100907h7d43c3cax3c207e5fc4e1bc19@mail.gmail.com>
References: <6faad9f00911100707t16e29b6yb178bae76b5e3f47@mail.gmail.com>	<alpine.LNX.2.01.0911101010480.4863@ybpnyubfg.ybpnyqbznva>	<6faad9f00911100735p431e54dew48147a1ee7f41242@mail.gmail.com>	<alpine.LNX.2.01.0911101041460.7612@ybpnyubfg.ybpnyqbznva>	<4AF98D77.1000400@wxs.nl>
	<6faad9f00911100907h7d43c3cax3c207e5fc4e1bc19@mail.gmail.com>
Message-ID: <4AF9A85B.8090507@wxs.nl>

Mojca Miklavec wrote:
> On Tue, Nov 10, 2009 at 16:57, Hans Hagen wrote:
>> str-ref.lua, line 199:
>>
>>
>>                    for s in gmatch(reference,"%s*([^,]+)") do
> 
> Great! This solves the problem, thanks a lot Hans.
> 
> Mojca
> 
> (PS: for some weird reason the references have not worked at all with
> current (I won't test again), but then I changed the test case before
> updating, so I didn't notice that the latest version almost worked.)

math numbering has been redone and is under testing and not in the 
current but only in beta

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Nov 13 12:47:02 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 13 Nov 2009 12:47:02 +0100
Subject: [dev-context] Plant flu breakout?
Message-ID: <4AFD4736.5040204@elvenkind.com>


Hi,

It looks like the garden is down again.


Best wishes,
Taco

From taco at elvenkind.com  Wed Nov 18 16:15:10 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 18 Nov 2009 16:15:10 +0100
Subject: [dev-context] Luatex 0.45.0 announcement
Message-ID: <4B040F7E.2060709@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.45.0.

New features:

* Loading big OTF fonts via lua is now much faster than before,
  at the expense of a bit of precision loss in the calculated
  bounding boxes.

* Two new token lists are provided: \pdfxformresources and
  \pdfxformattr, as an alternative to \pdfxform keywords.

* \input and \openin now accept braced filenames.

* The \endlinechar can now be set to any value between 0 and 127.

* Luatex can now optionally use kpathsea to find lua require()
  files.

* The new primitives \aligntab and \alignmark are aliases for
  the use of & and # in alignments.

* \pdfrefximage [width <dimen>] [height <dimen>] [depth <dimen>] <imageref>
  overrules settings from \pdfximage for this \pdfrefximage call only

* The print precision for small numbers in lua code (tostring)
  has been improved.

* Akira Kakuto suppled a patch that restricts writing to files
  with names such as latex.bat etc. (on windows only)

* (un-feature): from now on luatex now only handles 4 direction
  specifiers: TLT (latin), TRT (arabic), RTT (cjk), and LTL
  (mongolian). The other directions now generate an error.

* (un-feature): xpdf's automatic lower- and uppercasing retry attempts
  for nonfound image pdf files has been removed.

* The callbacks hpack_filter, vpack_filter and pre_output_filter
  pass on an extra string argument for the direction, when known
  (nil == use default).

* The lua functions node.hpack(), node.vpack() and node.dimensions()
  now accept an optional direction argument (not given == use default).

* \pdfrefxform [width <dimen>] [height <dimen>] [depth <dimen>] <formref>
  scales a form object; similar principle as with \pdfximage: depth alone
  doesn't scale, it shifts vertically.

* A change to the relative ordering inside font name discovery for use
  by the backend: now it tries <f>.psname first, as that is much less
  likely to contain spaces.

* For ttc fonts, now the used subfont name and its index id are printed
  to the terminal, and if the backend cannot find a ttc subfont, the
  run is aborted.

Bug fixes:

* Prevent crashes for lua-loaded fonts without a (tfm) name.

* Remove spurious newlines in the output pdf that could be the
  result of using \pdfximage for an included pdf figure too early.

* Full font embedding for wide otf and ttf fonts now really
  works (older versions only pretended that it did work).

* node.dimensions() sometimes continued past the 'stop' node.

* Images inside virtual fonts were broken.

* The processing of \language=-1 was wrong, resulting in
  hyphenation attempts even though there was no proper language
  set up.

* Fix for finding files in --output-directory.

* Fix for handling of --file-line-error.

* tex.box[] assignments are now checked to make sure the assigned
  node has the right id (hlist or vlist).

* show_node_list (as in \showbox) produced spurious local_par
  whatsit prints in the output after direction nodes.

* The handling of pdf literals has been sped up.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.45.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From preining at logic.at  Thu Nov 19 00:56:52 2009
From: preining at logic.at (Norbert Preining)
Date: Thu, 19 Nov 2009 00:56:52 +0100
Subject: [dev-context] [Dev-luatex] Luatex 0.45.0 announcement
In-Reply-To: <4B040F7E.2060709@elvenkind.com>
References: <4B040F7E.2060709@elvenkind.com>
Message-ID: <20091118235652.GG7080@gamma.logic.tuwien.ac.at>

On Mi, 18 Nov 2009, Taco Hoekwater wrote:
> I have just uploaded the archives for a new luatex release, 0.45.0.

and it can be obtained from Debian/experimental already.


Thanks a lot Taco!

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining                                        Associate Professor
JAIST Japan Advanced Institute of Science and Technology   preining at jaist.ac.jp
Vienna University of Technology                               preining at logic.at
Debian Developer (Debian TeX Task Force)                    preining at debian.org
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
SILLOTH (n.)
Something that was sticky, and is now furry, found on the carpet under
the sofa the morning after a party.
			--- Douglas Adams, The Meaning of Liff

From sanjoy at MIT.EDU  Sat Nov 21 22:08:19 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Sat, 21 Nov 2009 16:08:19 -0500
Subject: [dev-context] linebreak regression with TL2009 versus TL2008
Message-ID: <E1NBxBr-0005Bu-94@approx.mit.edu>

The following test file

=============================================================
\usetypescript[palatino][ec]
\setupbodyfont[palatino,10.5pt]

\setuplayout[width=4.75in]

\showframe

\starttext

knowledge.  The diverse examples help separate the tool---the
general principle---from the particular applications so that you
can grasp and transfer the tool to problems of particular interest to
you.

\stoptext
=============================================================

works fine with the a recent context (2009.11.21) on top of TL 2008.
But the linebreak is terrible if I use the same context on top of
TL2009.  I cannot find the cause.


From bogus@does.not.exist.com  Wed Oct 21 10:18:07 2009
From: bogus@does.not.exist.com ()
Date: Wed, 21 Oct 2009 08:18:07 -0000
Subject: No subject
Message-ID: <mailman.3.1258837827.22152.dev-context@ntg.nl>

Overfull \hbox (25.72205pt too wide) in paragraph at lines 10--14
[]\*palatino10.5ptmmnnrm*: knowledge. The di-verse ex-am-ples help sep-a-rate t
he tool---the gen-eral principle---

\hbox(7.55998+2.96098)x343.28249, glue set - 1.0
.\hbox(0.0+0.0)x0.0
.\*palatino10.5ptmmnnrm*: k
.\*palatino10.5ptmmnnrm*: n
.\*palatino10.5ptmmnnrm*: o
.\kern-0.2625
.etc.


Below is the full log file.  

At first I thought the problem was in TeX Gyre versus the former
Palatino, but both runs use TeX Gyre.  The only other difference that I
can see is the pdftex versions:

TL2009: This is pdfTeX, Version 3.1415926-1.40.10 (TeX Live 2009) (format=cont-en 2009.11.20)  21 NOV 2009 15:18
Tl2008: This is pdfTeXk, Version 3.1415926-1.40.9 (Web2C 7.5.7) (format=cont-en 2009.6.12)  21 NOV 2009 15:16

Other than that, the runs with TL 2008 and TL 2009 produce exactly the
same log file except for the overfull hbox message, and '2008' becoming
'2009' in all the filenames, and write18 being enabled in one but not
the other (I think with 2008).

Any ideas whether this is a font problem, pdftex problem, or a context
problem (probably unlikely given that both runs use the same context
source files)?

-Sanjoy


This is pdfTeX, Version 3.1415926-1.40.10 (TeX Live 2009) (format=cont-en 2009.11.21)  21 NOV 2009 16:00
entering extended mode
 file:line:error style messages enabled.
 %&-line parsing enabled.
 (/home/sanjoy/texmf-ctx/tl2009-20091121/web2c/natural.tcx)
**test.tex \emergencyend
(./test.tex

ConTeXt  ver: 2009.11.21 11:45 MKII  fmt: 2009.11.21  int: english/english

system          : cont-new loaded
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/cont-new.tex
systems         : beware: some patches loaded from cont-new.tex
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/cont-new.mkii))
system          : cont-fil loaded
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/cont-fil.tex
loading         : ConTeXt File Synonyms
)
system          : cont-sys.rme loaded
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/user/cont-sys.rme
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/type-tmf.tex
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/type-tmf.mkii))
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/type-siz.tex
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/type-siz.mkii))
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/type-one.tex
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/type-one.mkii)))
system          : test.top loaded
(./test.top
)
bodyfont        : 12pt rm is loaded
language        : patterns nl->texnansi:texnansi->1->2:2 nl->ec:ec->2->2:2 us->
ec:ec->3->2:3 de->texnansi:texnansi->4->3:3 de->ec:ec->5->3:3 da->ec:ec->6->2:2
 sv->ec:ec->7->2:2 gb->ec:ec->8->2:2 fr->texnansi:texnansi->9->2:2 fr->ec:ec->1
0->2:2 es->ec:ec->11->2:2 ca->ec:ec->12->2:2 it->texnansi:texnansi->13->2:2 it-
>ec:ec->14->2:2 la->ec:ec->15->2:2 pt->texnansi:texnansi->16->2:2 pt->ec:ec->17
->2:2 ro->ec:ec->18->2:2 pl->pl0:pl0->19->2:2 pl->ec:ec->20->2:2 pl->qx:qx->21-
>2:2 cs->il2:il2->22->2:2 cs->ec:ec->23->2:2 sk->il2:il2->24->2:2 sk->ec:ec->25
->2:2 hr->ec:ec->26->2:2 sl->ec:ec->27->2:2 tr->ec:ec->28->2:2 agr->agr:agr->30
->2:2 fi->ec:ec->31->2:2 hu->ec:ec->32->2:2 ru->t2a:t2a->34->2:2 uk->t2a:t2a->3
5->3:3 loaded
specials        : dvips loaded
\openout3 = `test.tui'.

\openout0 = `test-mpgraph.mp'.

\openout0 = `mpgraph.mp'.

systems         : system commands are disabled
language        : language en is active
specials        : loading definition file tpd
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/spec-tpd.mkii
specials        : loading definition file fdf
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/spec-fdf.mkii)) (/home
/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/page-run.mkii
loading         : ConTeXt Page Macros / Runtime Macros
) (./test.tuo) (./test.tuo) (./test.tuo) (./test.tuo) (./test.tuo) (./test.tuo)
(./test.tuo) (./test.tuo) (./test.tuo) (./test.tuo) (./test.tuo)
publications    : file test.bbl not found, waiting for bibtex
(./test.tuo)
systems         : begin file test at line 8

Overfull \hbox (25.72205pt too wide) in paragraph at lines 10--14
[]\*palatino10.5ptmmnnrm*: knowledge. The di-verse ex-am-ples help sep-a-rate t
he tool---the gen-eral principle---

\hbox(7.55998+2.96098)x343.28249, glue set - 1.0
.\hbox(0.0+0.0)x0.0
.\*palatino10.5ptmmnnrm*: k
.\*palatino10.5ptmmnnrm*: n
.\*palatino10.5ptmmnnrm*: o
.\kern-0.2625
.etc.

fonts           : resetting map file list
{/home/sanjoy/texmf-ctx/tl2009-20091121/fonts/map/pdftex/context/original-empty
.map}
fonts           : using map file: original-base
{/home/sanjoy/texmf-ctx/tl2009-20091121/fonts/map/pdftex/context/original-base.
map}
fonts           : using map file: original-ams-base
{/home/sanjoy/texmf-ctx/tl2009-20091121/fonts/map/pdftex/context/original-ams-b
ase.map}
fonts           : using map file: original-public-lm
{/home/sanjoy/texmf-ctx/tl2009-20091121/fonts/map/pdftex/context/original-publi
c-lm.map}
fonts           : using map file: lm-ec
{/usr/local/texlive/2009/texmf-dist/fonts/map/dvips/lm/lm-ec.map}
fonts           : using map file: lm-math
{/usr/local/texlive/2009/texmf-dist/fonts/map/dvips/lm/lm-math.map}
fonts           : using map file: lm-rm
{/usr/local/texlive/2009/texmf-dist/fonts/map/dvips/lm/lm-rm.map}
fonts           : using map file: original-ams-euler
{/home/sanjoy/texmf-ctx/tl2009-20091121/fonts/map/pdftex/context/original-ams-e
uler.map}
fonts           : using map file: qpl-ec
{/usr/local/texlive/2009/texmf-dist/fonts/map/dvips/tex-gyre/qpl-ec.map}
fonts           : using map file: original-youngryu-px
{/home/sanjoy/texmf-ctx/tl2009-20091121/fonts/map/pdftex/context/original-young
ryu-px.map} (/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/sort-def.m
kii) (/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/sort-lan.mkii) [1
.1]
systems         : end file test at line 15
system          : cont-err loaded
(/home/sanjoy/texmf-ctx/tl2009-20091121/tex/context/base/cont-err.tex
systems         : no file 'cont-sys.tex', using 'cont-sys.rme' instead
) ) 
Here is how much of TeX's memory you used:
 2697 strings out of 456429
 49119 string characters out of 2525280
 4775366 words of memory out of 7192449
 43186 multiletter control sequences out of 15000+200000
 178380 words of font info for 99 fonts, out of 3000000 for 9000
 396 hyphenation exceptions out of 8191
 51i,17n,77p,259b,542s stack positions out of 5000i,500n,10000p,200000b,50000s
{/usr/local/texlive/2009/texmf-dist/fonts/enc/dvips/tex-gyre/q-ec.enc}</usr/
local/texlive/2009/texmf-dist/fonts/type1/public/tex-gyre/qplr.pfb>

pdfTeX warning: pdftex: no GlyphToUnicode entry has been inserted yet!
Output written on test.pdf (1 page, 25868 bytes).
PDF statistics:
 13 PDF objects out of 1000 (max. 8388607)
 8 compressed objects within 1 object stream
 0 named destinations out of 1000 (max. 500000)
 1 words of extra memory for PDF output out of 10000 (max. 10000000)


From schuster.wolfgang at googlemail.com  Sun Nov 22 10:37:14 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 22 Nov 2009 10:37:14 +0100
Subject: [dev-context] Mathdesign / MnSymbol
Message-ID: <B94ADC95-6AFD-41F6-AC5B-6BE370017936@googlemail.com>

Hi,

can the mathdesign [1] and mnsymbol [2] fonts be included in the minimals.

[1] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mathdesign
[2] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mnsymbol

Wolfgang


From mojca.miklavec.lists at gmail.com  Sun Nov 22 15:01:54 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sun, 22 Nov 2009 15:01:54 +0100
Subject: [dev-context] Mathdesign / MnSymbol
In-Reply-To: <B94ADC95-6AFD-41F6-AC5B-6BE370017936@googlemail.com>
References: <B94ADC95-6AFD-41F6-AC5B-6BE370017936@googlemail.com>
Message-ID: <6faad9f00911220601s7edb35a4y711f967ed6e2be7f@mail.gmail.com>

On Sun, Nov 22, 2009 at 10:37, Wolfgang Schuster wrote:
> Hi,
>
> can the mathdesign [1] and mnsymbol [2] fonts be included in the minimals.
>
> [1] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mathdesign
> [2] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mnsymbol

Oh, so ConTeXt is getting support for MnSymbol? Great!

What files are needed? For MKII or MKIV? All the files? Do you have
any nice idea how to organize fonts, so that users don't need to fetch
all the fonts?

I guess that it's OK to just take them from TeX Live tree, we don't
need the very latest version from CTAN, right?

Mojca

From mojca.miklavec.lists at gmail.com  Sun Nov 22 16:28:00 2009
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Sun, 22 Nov 2009 16:28:00 +0100
Subject: [dev-context] Mathdesign / MnSymbol
In-Reply-To: <6faad9f00911220601s7edb35a4y711f967ed6e2be7f@mail.gmail.com>
References: <B94ADC95-6AFD-41F6-AC5B-6BE370017936@googlemail.com>
	<6faad9f00911220601s7edb35a4y711f967ed6e2be7f@mail.gmail.com>
Message-ID: <6faad9f00911220728w49c34a9dh5f03069ebfd6fa4d@mail.gmail.com>

On Sun, Nov 22, 2009 at 15:01, Mojca Miklavec wrote:
> On Sun, Nov 22, 2009 at 10:37, Wolfgang Schuster wrote:
>> Hi,
>>
>> can the mathdesign [1] and mnsymbol [2] fonts be included in the minimals.
>>
>> [1] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mathdesign
>> [2] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mnsymbol
>
> Oh, so ConTeXt is getting support for MnSymbol? Great!
>
> What files are needed? For MKII or MKIV? All the files? Do you have
> any nice idea how to organize fonts, so that users don't need to fetch
> all the fonts?
>
> I guess that it's OK to just take them from TeX Live tree, we don't
> need the very latest version from CTAN, right?

I added the fonts to current/fonts/extra, but this needs improvement.

Locally you may try to modify bin/mtx-update to fetch those fonts, but
I need some good idea how to handle additional fonts. (I still think
that it would be nice to have some "minimal version" with just LM
installed and some "maxi" version that installs all the modules and
fonts).

Mojca

From sanjoy at MIT.EDU  Sun Nov 22 16:57:19 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Sun, 22 Nov 2009 10:57:19 -0500
Subject: [dev-context] bib: article title with -- comes out mangled
Message-ID: <E1NCEoR-0000gE-FY@approx.mit.edu>

This test file has a mangled article title where the "--" was located in
the bibtex entry (a few accented characters show up).  Commenting in the
\enableregime removes the accented characters, but now there's a mix of
different dashes almost joined together.

  % \enableregime[utf]
  \usemodule[bib]
  \setupbibtex[database=project]

  \starttext
  Look up the Shannon--Nyquist sampling theorem \cite[Jerri:1977].
  \blank[3*big]
  \placepublications[criterium=all]
  \stoptext

Here is the bibtex file

@Article{Jerri:1977,
  author = 	 {A. J. Jerri},
  title = 	 {The {S}hannon sampling theorem ?- {I}ts various extensions and applications: A tutorial review},
  journal = 	 {Proceedings of the IEEE},
  year = 	 1977,
  volume = 	 65,
  number = 	 11,
  pages = 	 {1565--1596}}

(A workaround is to make the " -- " into "---", which is what it should
have been anyway.)

This is with context 2009.10.27 16:35 MKII in the Debian TL2009 packages.
I also see the problem with 2009.11.20 on top of vanilla TL2009 or
vanilla TL2008.

-Sanjoy

From schuster.wolfgang at googlemail.com  Sun Nov 22 17:41:36 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 22 Nov 2009 17:41:36 +0100
Subject: [dev-context] Mathdesign / MnSymbol
In-Reply-To: <6faad9f00911220601s7edb35a4y711f967ed6e2be7f@mail.gmail.com>
References: <B94ADC95-6AFD-41F6-AC5B-6BE370017936@googlemail.com>
	<6faad9f00911220601s7edb35a4y711f967ed6e2be7f@mail.gmail.com>
Message-ID: <0D8EAE65-8680-4AD5-84A3-786879C3A38E@googlemail.com>


Am 22.11.2009 um 15:01 schrieb Mojca Miklavec:

>> can the mathdesign [1] and mnsymbol [2] fonts be included in the minimals.
>> 
>> [1] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mathdesign
>> [2] http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=mnsymbol
> 
> Oh, so ConTeXt is getting support for MnSymbol? Great!

only when i figure out how to use the greek letters from the text font
for math because mnsymbol contains only symbols but no greek or italic
alphabets

> What files are needed? For MKII or MKIV? All the files? Do you have
> any nice idea how to organize fonts, so that users don't need to fetch
> all the fonts?

i have no interest in mkii, the only thing i will do is to write
a typescript and a virtual font for mkiv

Wolfgang


From sanjoy at MIT.EDU  Sun Nov 22 18:38:29 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Sun, 22 Nov 2009 12:38:29 -0500
Subject: [dev-context] bib: triple dash in article title causes problems
	(minimal example)
Message-ID: <E1NCGOL-0001rw-Vl@approx.mit.edu>

To continue my earlier message about "--" in bibtex titles:

I replaced the "--" with a triple dash "---" but still had problems
unless I used \enableregime[utf].  Even then I had problems if I was
also using products and projects, where \enableregime[utf] seemed to
have no effect for the bibliography.

Attached is a minimal set of files as a .tgz.

Unpack and do 'cd test'; then 'make'.  The resulting PDF, at least on my
system (TL 2009 Debian + context 2009.10.27) has the accent characters
instead of the em-dash.  A small-size png image of it is attached.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/x-gzip
Size: 1751 bytes
Desc: test.tgz
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20091122/3911c8fa/attachment-0001.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 7593 bytes
Desc: test.png
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20091122/3911c8fa/attachment-0001.png>

From taco at elvenkind.com  Mon Nov 23 08:44:08 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 23 Nov 2009 08:44:08 +0100
Subject: [dev-context] bib: triple dash in article title causes problems
 (minimal example)
In-Reply-To: <E1NCGOL-0001rw-Vl@approx.mit.edu>
References: <E1NCGOL-0001rw-Vl@approx.mit.edu>
Message-ID: <4B0A3D48.3020701@elvenkind.com>



Sanjoy Mahajan wrote:
> To continue my earlier message about "--" in bibtex titles:
> 
> I replaced the "--" with a triple dash "---" but still had problems
> unless I used \enableregime[utf].  Even then I had problems if I was
> also using products and projects, where \enableregime[utf] seemed to
> have no effect for the bibliography.

This is the key problem, I think: adding an explicit \enableregime
before the \startcomponent will likely fix the problem. The issue
is that bbl file, which is normally read at \starttext is read at
a different point in time for source that uses products/projects.

Best wishes,
Taco

From sanjoy at MIT.EDU  Mon Nov 23 20:15:39 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Mon, 23 Nov 2009 14:15:39 -0500
Subject: [dev-context] bib: triple dash in article title causes problems
	(minimal example)
In-Reply-To: Your message of "Mon, 23 Nov 2009 08:44:08 +0100."
	<4B0A3D48.3020701@elvenkind.com>
Message-ID: <E1NCeNv-0006Lv-4G@approx.mit.edu>

Taco Hoekwater <taco at elvenkind.com> wrote:

> This is the key problem, I think: adding an explicit \enableregime
> before the \startcomponent will likely fix the problem. The issue
> is that bbl file, which is normally read at \starttext is read at
> a different point in time for source that uses products/projects.

The bibliography was typeset the product file itself, so I put
\enableregime[utf] before the \startproduct.  It worked as you
predicted.  

I had made a related experiment: to put \enableregime[utf] at the start
of the .bbl file, then to run texexec with --once (to prevent bibtex
from remaking the .bbl file).  That also worked, but it was intended as
a method of debuggin rather than as a usable workaround.

However, even with your fix, I'm still partly confused.  Why isn't the
"---" in the article title treated like a TeX em-dash?  In other words,
why is the utf regime needed at all?

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From taco at elvenkind.com  Tue Nov 24 07:43:09 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 24 Nov 2009 07:43:09 +0100
Subject: [dev-context] bib: triple dash in article title causes problems
 (minimal example)
In-Reply-To: <E1NCeNv-0006Lv-4G@approx.mit.edu>
References: <E1NCeNv-0006Lv-4G@approx.mit.edu>
Message-ID: <4B0B807D.3050705@elvenkind.com>

Sanjoy Mahajan wrote:
> 
> However, even with your fix, I'm still partly confused.  Why isn't the
> "---" in the article title treated like a TeX em-dash?  In other words,
> why is the utf regime needed at all?

In your original post, the first of the -- was not a hyphen, but U+2014.

Best wishes,
Taco




From sanjoy at MIT.EDU  Tue Nov 24 15:55:37 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Tue, 24 Nov 2009 09:55:37 -0500
Subject: [dev-context] bib: triple dash in article title causes problems
	(minimal example)
In-Reply-To: Your message of "Tue, 24 Nov 2009 07:43:09 +0100."
	<4B0B807D.3050705@elvenkind.com>
Message-ID: <E1NCwnp-0001eS-0k@approx.mit.edu>

That was it!  I think I cut and paste the title from the IEEE website,
to minimize transcription errors, and never noticed the U+2014.  In
Emacs, at least with the font I use, it looks so like a "-" that I would
not have noticed it without your pointing it out.

I should add a 'find any unicode characters' command to my Makefiles.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From taco at elvenkind.com  Thu Nov 26 16:27:16 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 26 Nov 2009 16:27:16 +0100
Subject: [dev-context] Luatex 0.46.0 announcement
Message-ID: <4B0E9E54.7070005@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.46.0.

There are two important reason for this release:

* It fixes an xform bug that is quite serious as it produces
  invalid pdf files (see below)

* There is now experimental support for loading external .dll/.so
  files for lua extension modules. Copied from a message I sent to
  the dev-luatex list a few days ago:

> I have committed an experimental patch that
> enables dynamic loading for external compiled libraries unless --safer
> is given on the command-line.
> 
> It is experimental because:
> 
> * it assumes that all architectures except windows will be happy with
>   using dlopen (windows has its own code which does not need compile-
>   time support, but you have to have an installed lua51.dll from e.g.
>   http://luabinaries.luaforge.net ).
> 
> * I made only minimal changes to kpathsea.
> 
> * there may be lua libraries out there that fail horribly.
> 
> As with pure lua require() files, luatex will only use kpathsea if the
> library is initialized already.
> 
> kpathsea changes in detail:
> 
> I added the kpse_clua_format identifier that searches for files with
> extension .dll and .so. The texmf.cnf setting for this variable is
> CLUAINPUTS, and by default it has this value:
> 
> CLUAINPUTS=.:$SELFAUTOLOC/lib/{$progname,$engine,}/lua//
> 
> This is the best I could do on short notice: the architecture has to
> be in the path somewhere, and the fastest way to do that is to search
> below the binary directory only.
> 
> One level up (lib parallel to bin) would have been nicer, as the
> context minimals have arch and bin swapped (texmf-linux/bin as opposed
> to bin/i386-linux) but that would not have worked in texlive.

If you know how to compile dynamic libraries on your platform,
a good library to play with is Lua BitOp, http://bitop.luajit.org/
(single C source file and comes with a nice test lua script).


And here is the normal list of features and bugfixes in 0.46.0
--------------------------------------------------------------

New features:

* The build.sh script now has better support for new MacOSX-es
  (patch from Mojca).

* Luatex now has experimental support for dynamic loading of
  external compiled lua libraries. Building luatex and loading
  external .so/.dll files is reported to work on Windows,
  linux and osx, other platforms are still unknown.

* pdf.obj{type="stream"} no longer converts its argument to and
  from a tokenlist. This allows the use of binary data in the
  "string" argument. Such data does still have to hidden from
  the normal file parser by putting the code in a dofile()
  or by using string.char(), though.

Bug fixes:

* Luatex 0.45.0 was not able to find truetype nor opentype fonts
  if there were no callbacks defined (patch from Pawel).

* 0.45.0 printed the user input instead of the full pathname
  for \input-ed tex files.

* The TFM reader now rejects fonts with tfm names that are
  longer than 255 characters because such font names cannot
  be stored in a DVI file.

* The combination of \immediate\pdfxform followed by a later
  \pdfrefxform could cause broken pdf output files because
  the box used for the form could have been freed and even
  reused already at that moment in time, sometimes resulting
  in an invalid transformation matrix.

* The placement of super- and subscripts for displaystyle
  \int's in CambriaMath is now better than before. It still
  needs a tweak to the metrics though: in the current version,
  the italic correction has to be substracted from the width
  of the integral sign to get correct placement (context mkiv
  does this).  to be continued ...



The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.46.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From sanjoy at MIT.EDU  Sat Nov 28 20:00:31 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Sat, 28 Nov 2009 14:00:31 -0500
Subject: [dev-context] bib: space gobbled after \cite
Message-ID: <E1NESX1-0006uU-6J@approx.mit.edu>

With recent versions of ConTeXt, spaces after \cite[Author:1977] are
getting eaten.  I'm pretty sure that did not happen with versions from a
while ago, but the archives suggest that it happened a long while ago:

   <http://www.mail-archive.com/ntg-context at let.uu.nl/msg00062.html>

The minimal test file:

=============================================
\usemodule[bib]
\setupbibtex[database=statement, sort=author]

\starttext

Polya said \cite[Polya:1966] in 1966: "finished mathematics consists
of proofs, but mathematics in the making consists of guesses."

\blank
\placepublications

\stoptext
==============================================

The first line ends up "Polya said (Polya, 1966)in 1966..." with no
space after the close paren.  (This is with 2009.10.27 16:35 MKII on top
of TL 2009 from Debian.)

Here is statement.bib to complete the example:

@Misc{Polya:1966,
  author =	 {George Polya},
  title =	 {Let us teach guessing},
  howpublished = {VHS},
  year =	 {1966},
  publisher =	 {Mathematical Association of America},
}

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From taco at elvenkind.com  Sun Nov 29 09:01:27 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 29 Nov 2009 09:01:27 +0100
Subject: [dev-context] bib: space gobbled after \cite
In-Reply-To: <E1NESX1-0006uU-6J@approx.mit.edu>
References: <E1NESX1-0006uU-6J@approx.mit.edu>
Message-ID: <4B122A57.2000306@elvenkind.com>

Sanjoy Mahajan wrote:
> With recent versions of ConTeXt, spaces after \cite[Author:1977] are
> getting eaten.  I'm pretty sure that did not happen with versions from a
> while ago, but the archives suggest that it happened a long while ago:
> 
>    <http://www.mail-archive.com/ntg-context at let.uu.nl/msg00062.html>
> 

Perhaps 'strictinspectnextcharacter' is broken in the current release?

Best wishes,
Taco





From sanjoy at MIT.EDU  Sun Nov 29 16:04:38 2009
From: sanjoy at MIT.EDU (Sanjoy Mahajan)
Date: Sun, 29 Nov 2009 10:04:38 -0500
Subject: [dev-context] bib: space gobbled after \cite
In-Reply-To: Your message of "Sun, 29 Nov 2009 09:01:27 +0100."
	<4B122A57.2000306@elvenkind.com>
Message-ID: <E1NElKI-0005ad-26@approx.mit.edu>

> Perhaps 'strictinspectnextcharacter' is broken in the current release?

It might include several past releases, including a few back into 2008.
I first noticed the problem using ConTeXt 2008.10.31 but didn't manage
to make a minimal example with it (many attempts didn't work) and only
finally sat down and did so recently.

Therefore, if you look for a change to 'strictinspectnextcharacter',
don't limit your gaze just to the most recent changes.

-Sanjoy

`Until lions have their historians, tales of the hunt shall always
 glorify the hunters.'  --African Proverb

From pragma at wxs.nl  Mon Nov 30 12:53:54 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 30 Nov 2009 12:53:54 +0100
Subject: [dev-context] bib: space gobbled after \cite
In-Reply-To: <4B122A57.2000306@elvenkind.com>
References: <E1NESX1-0006uU-6J@approx.mit.edu> <4B122A57.2000306@elvenkind.com>
Message-ID: <4B13B252.80504@wxs.nl>

Taco Hoekwater wrote:
> Sanjoy Mahajan wrote:
>> With recent versions of ConTeXt, spaces after \cite[Author:1977] are
>> getting eaten.  I'm pretty sure that did not happen with versions from a
>> while ago, but the archives suggest that it happened a long while ago:
>>
>>    <http://www.mail-archive.com/ntg-context at let.uu.nl/msg00062.html>
>>
> 
> Perhaps 'strictinspectnextcharacter' is broken in the current release?

for a while cite takes two optional arguments so some more strictness is 
needed; a next beta will solve it

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at googlemail.com  Sun Dec  6 20:27:35 2009
From: schuster.wolfgang at googlemail.com (Wolfgang Schuster)
Date: Sun, 6 Dec 2009 20:27:35 +0100
Subject: [dev-context] Liliypond
Message-ID: <96F814DF-009B-4993-8141-528BFCEED3C8@googlemail.com>

Hi,

the lilypond module stores the files below the third directory in both doc and tex folders,
can the files be moved in a subdirectory with the name lilypond like all other module do.

Regards,
Wolfgang


From khaledhosny at eglug.org  Sat Dec 12 11:29:10 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 12 Dec 2009 12:29:10 +0200
Subject: [dev-context] [Dev-luatex] Luatex 0.46.0 announcement
In-Reply-To: <4B0E9E54.7070005@elvenkind.com>
References: <4B0E9E54.7070005@elvenkind.com>
Message-ID: <20091212102910.GA3200@khaled-laptop>

On Thu, Nov 26, 2009 at 04:27:16PM +0100, Taco Hoekwater wrote:
> * There is now experimental support for loading external .dll/.so
>   files for lua extension modules.

The manual (p 30) still says "Dynamic loading of .so and .dll files is
disabled on all platforms."

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-context/attachments/20091212/fcef0059/attachment.pgp>

From taco at elvenkind.com  Fri Dec 18 11:02:54 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 18 Dec 2009 11:02:54 +0100
Subject: [dev-context] Luatex 0.47.0 announcement
Message-ID: <4B2B534E.3070800@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.47.0.

This will be the last beta before the next major release (0.50),
so please test this version as thoroughly as you can.

New features:

* New read-write lua variables pdf.pdfcatalog, pdf.pdfnames,
  pdf.pdfinfo, pdf.pdftrailer

* The horizontal mode nodes that are added to lines during line
  breaking now inherit the attributes from the first and last node
  inside the created line.

* The new function pdf.registerannot(<number>) registers an
  annotation object number to be included in the current
  page's /Annots list.

* The variables <metrics>.Mathconstants.FractionDelimiterSize
  and <metrics>.Mathconstants.FractionDelimiterDisplayStyleSize
  are added to the font table. This allows proper setting of the
  size parameters for TeX's ...withdelims math primitives.

* The internal representation of the string pool is reorganized
  (the pool of string characters is now allocated dynamically),
  and as a side-effect the lua variable status.init_pool_ptr
  is deprecated and will be removed in a later version. Also,
  status.pool_ptr now simply returns the current number of bytes
  in use for string characters.

* There are new lua variables pdf.pdfmapline and pdf.pdfmapfile
  (write-only strings that mimic \pdfmapline and \pdfmapfile).

* \pdfobj data and attribute are now stored as C strings instead
  of as token lists (this should speed up cases with a lot of data).

* Artificially slanted fonts now work via the pdf text matrix
  (instead of adjusting the actual font) so that it now also
  works for non-Type1 fonts. The lua <metrics>.slant font key is
  now obeyed in all cases.

* The lua function font.id(<string>) returns the internal font id
  number belonging to a control sequence name.

* Pdf image inclusion is optimized such that objects from an
  external pdf will now be included only once even if they are
  referenced from multiple inclusions.

Bug fixes:

* Protrusion for non-TLT documents did not work properly for
  the hyphenation character.

* \lastbox could not remove the paragraph indent box for non-TLT
  documents.

* Pdf images (\pdfximage) are no longer kept open during the
  whole run, but closed and reopened. An error is raised if
  the file has changed between \pdfximage and \pdfrefximage.
  This prevents the 'too many open files' error when lots of
  images are included.

* On Win32 Pdf image files are locked during the time that it is
  open, to prevent unnoticed file changes by external sources.

* Compilation now again works on FreeBSD.

* Format sharing between 32-bit and 64-bit architectures was
  broken.

* Unsetting attributes from lua could sometimes result in
  the unset state persisting beyond the current group level.

* If something went wrong in the scanning of pdf action items,
  the error message reported the current primitive name
  incorrectly.

* Luatex would crash on non-existant pdfs that were referenced
  from map file entries.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.47.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco



From taco at elvenkind.com  Thu Dec 24 17:15:09 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 24 Dec 2009 17:15:09 +0100
Subject: [dev-context] Luatex 0.50.0 announcement
Message-ID: <4B33938D.306@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.50.0.

This release starts a new chain of stable beta's.

New features:

* Fonts now listen also to the 'extend' key in the lua font
  metrics table, and the processing for this is done via de
  pdf text matrix instead of via the font matrix, which means
  it now works for all font types.

* The embedded Metapost library is now at version 1.209.

Dropped features:

* It is no longer possible for fonts from embedded pdf files
  to be replaced by / merged with the document fonts of the
  enveloping pdf. This regression may be temporary, depending
  on how the rewritten font backend will look after beta 0.60.

Bug fixes:

* Use of \middle confused the \mathstyle operation.

* \pdfcolorstack handling was broken.

* node.unset_attribute() had a bug whereby it inverted the
  requested result in some cases (the node on which the unset
  was called was sometimes the only node at the current level
  that *kept* the attribute).

* During font expansion, the internal font copy had one character
  information object less than the original, resulting in the
  disappearance of a glyph in some fonts when font expansion
  was active.

* Placement of operator scripts of OT MATH fonts is adjusted
  to be conformant with Word's logic where the italic correction
  is only used to tuck in the subscript and for nothing else.

* luafontloader.open() no longer writes directly to stderr in
  case of internal font errors.

* Any <pdf_refobj_node>.objnum could not be assigned to.

* The lua 'pdf' table could not be assigned to.

* The lua 'md5' library was returning incorrect results on
  64-bit architectures.

* Luatex now compiles on GNU Hurd systems.

* Fix segfault when embedding stream file object (these
  backend segfaults were a side-effect of the string pool
  patches).

The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.50.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From preining at logic.at  Fri Dec 25 16:41:58 2009
From: preining at logic.at (Norbert Preining)
Date: Fri, 25 Dec 2009 16:41:58 +0100
Subject: [dev-context] [Dev-luatex] Luatex 0.50.0 announcement
In-Reply-To: <4B33938D.306@elvenkind.com>
References: <4B33938D.306@elvenkind.com>
Message-ID: <20091225154158.GP24732@gamma.logic.tuwien.ac.at>

On Do, 24 Dez 2009, Taco Hoekwater wrote:
> I have just uploaded the archives for a new luatex release, 0.50.0.
> This release starts a new chain of stable beta's.

And it is already in Debian/unstable, so enjoy.

Thanks Taco for all your work.

Best wishes

Norbert
------------------------------------------------------------------------
Norbert Preining            preining@{jaist.ac.jp, logic.at, debian.org}
JAIST, Japan            TU Wien, Austria           Debian TeX Task Force
DSA: 0x09C5B094   fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
------------------------------------------------------------------------
The major difference between a thing that might go wrong
and a thing that cannot possibly go wrong is that when a
thing that cannot possibly go wrong goes wrong it usually
turns out to be impossible to get at or repair.
                 --- One of the laws of computers and programming revealed.
                 --- Douglas Adams, The Hitchhikers Guide to the Galaxy

From taco at elvenkind.com  Mon Dec 28 16:08:48 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 28 Dec 2009 16:08:48 +0100
Subject: [dev-context] 'My' context & luatex domains have moved
Message-ID: <4B38CA00.1030609@elvenkind.com>

Hi all,

This regards

   context.aanhet.net
   www.metatex.org
   minimals.metatex.org
   www.luatex.org
   tracker.luatex.org


The sites in mentioned above have moved to a new hosting server,
with IP address 195.12.62.12.

This new server has a better net connection and more disk space,
and besides, the old server is going to be powerless in a few
days anyway.

Apart from the changed IP, everything else should function as
before. I you notive any new weirdnesses, please drop me a message.

Best wishes,
Taco

From oliver.buerschaper at mpq.mpg.de  Thu Dec 31 11:43:10 2009
From: oliver.buerschaper at mpq.mpg.de (Oliver Buerschaper)
Date: Thu, 31 Dec 2009 11:43:10 +0100
Subject: [dev-context] Bug in mtx-update.lua?
Message-ID: <43E02C8E-4D6C-40FA-BA90-5A4C562BD5EA@mpq.mpg.de>

Hi,

it appears the variable "texroot" isn't always protected properly when fed to rsync. If "texroot" contains a space then rsync fails (see below).

From what I can tell the problematic code is most probably in lines 364-369 of mtx-update.lua.


This shows up at the very end:

---
MTXrun | mtx update: updating luatools for osx-64: rsync -tgo --chmod=a+x /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-context/scripts/context/lua/luatools.lua /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-osx-64/bin/luatools
MTXrun | run: rsync -tgo --chmod=a+x /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-context/scripts/context/lua/luatools.lua /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-osx-64/bin/luatools
rsync: link_stat "/Users/albert/Documents/ConTeXt/Packaging/../Local" failed: No such file or directory (2)
rsync: link_stat "/Users/albert/Documents/ConTeXt/Packaging/Minimals/stable/texmf-context/scripts/context/lua/luatools.lua" failed: No such file or directory (2)
rsync: link_stat "/Users/albert/Documents/ConTeXt/Packaging/../Local" failed: No such file or directory (2)
rsync: push_dir#3 "/Users/albert/Documents/ConTeXt/Packaging/Minimals/stable/texmf-osx-64/bin" failed: No such file or directory (2)
rsync error: errors selecting input/output files, dirs (code 3) at /SourceCache/rsync/rsync-37.3/rsync/main.c(580) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-37.3/rsync/io.c(452) [sender=2.6.9]
MTXrun | mtx update: updating mtxrun for osx-64: rsync -tgo --chmod=a+x /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-context/scripts/context/lua/mtxrun.lua /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-osx-64/bin/mtxrun
MTXrun | run: rsync -tgo --chmod=a+x /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-context/scripts/context/lua/mtxrun.lua /Users/albert/Documents/ConTeXt/Packaging/../Local Minimals/stable/texmf-osx-64/bin/mtxrun
rsync: link_stat "/Users/albert/Documents/ConTeXt/Packaging/../Local" failed: No such file or directory (2)
rsync: link_stat "/Users/albert/Documents/ConTeXt/Packaging/Minimals/stable/texmf-context/scripts/context/lua/mtxrun.lua" failed: No such file or directory (2)
rsync: link_stat "/Users/albert/Documents/ConTeXt/Packaging/../Local" failed: No such file or directory (2)
rsync: push_dir#3 "/Users/albert/Documents/ConTeXt/Packaging/Minimals/stable/texmf-osx-64/bin" failed: No such file or directory (2)
rsync error: errors selecting input/output files, dirs (code 3) at /SourceCache/rsync/rsync-37.3/rsync/main.c(580) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-37.3/rsync/io.c(452) [sender=2.6.9]
---

Can you reproduce this?

Happy new year by the way :-)
Oliver

