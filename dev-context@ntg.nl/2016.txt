From schuster.wolfgang at gmail.com  Fri Jan  1 18:48:58 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Fri, 01 Jan 2016 18:48:58 +0100
Subject: [dev-context] strc-tag.lua
Message-ID: <5686BC0A.6040806@gmail.com>

Hi,

line 514:

implement {
     name      = "settaggedmetadata",
-   actions   = structures.tags.registermetadata,
+   actions   = tags.registermetadata,
     arguments = "string"

Wolfgang


From schuster.wolfgang at gmail.com  Sun Jan  3 22:01:25 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 03 Jan 2016 22:01:25 +0100
Subject: [dev-context] tabl-mis.mkiv: \setupparagraphs
Message-ID: <56898C25.3030305@gmail.com>

Hi,

\def\typo_paragraphs_setup[#1][#2][#3]% we are downward compatible with 
[each] and [1,3]
   {\ifthirdargument
      \doifelse{#2}\v!each
-      {\typo_paragraphs_setup_saved[#1][#3]}
+      
{\dorecurse{\namedparagraphsparameter{#1}\c!n}{\normalexpanded{\typo_paragraphs_setup_saved[#1:\recurselevel][#3]}}}
        
{\def\typo_paragraphs_setup_step##1{\typo_paragraphs_setup_saved[#1:##1][#3]}%
         \processcommalist[#2]\typo_paragraphs_setup_step}%
    \else\ifsecondargument
       \typo_paragraphs_setup_saved[#1][#2]%
    \else\iffirstargument
       \typo_paragraphs_setup_saved[#1]%
    \fi\fi\fi}

Wolfgang

From pragma at wxs.nl  Sun Jan  3 23:20:57 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 3 Jan 2016 23:20:57 +0100
Subject: [dev-context] tabl-mis.mkiv: \setupparagraphs
In-Reply-To: <56898C25.3030305@gmail.com>
References: <56898C25.3030305@gmail.com>
Message-ID: <56899EC9.6080206@wxs.nl>

On 1/3/2016 10:01 PM, Wolfgang Schuster wrote:
> Hi,
>
> \def\typo_paragraphs_setup[#1][#2][#3]% we are downward compatible with
> [each] and [1,3]
>    {\ifthirdargument
>       \doifelse{#2}\v!each
> -      {\typo_paragraphs_setup_saved[#1][#3]}
> +
> {\dorecurse{\namedparagraphsparameter{#1}\c!n}{\normalexpanded{\typo_paragraphs_setup_saved[#1:\recurselevel][#3]}}}
>
> {\def\typo_paragraphs_setup_step##1{\typo_paragraphs_setup_saved[#1:##1][#3]}%
>
>          \processcommalist[#2]\typo_paragraphs_setup_step}%
>     \else\ifsecondargument
>        \typo_paragraphs_setup_saved[#1][#2]%
>     \else\iffirstargument
>        \typo_paragraphs_setup_saved[#1]%
>     \fi\fi\fi}

or

        {\dorecurse{\namedparagraphsparameter{#1}\c!n}%
 
{\normalexpanded{\typo_paragraphs_setup_saved[#1:\recurselevel]}[#3]}}%

as we don't want to expand #3

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Mon Jan  4 12:22:09 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 04 Jan 2016 12:22:09 +0100
Subject: [dev-context] math-fen.mkiv
Message-ID: <568A55E1.80001@gmail.com>

Hi,

on line 193 it should be \rrbracket:

\installmathfencepair \ulcorner   \Luppercorner \urcorner   \Ruppercorner
\installmathfencepair \llcorner   \Llowercorner \lrcorner   \Rlowercorner
\installmathfencepair \lmoustache \Lmoustache   \rmoustache \Rmoustache
-\installmathfencepair \llbracket  \Lopenbracket \lrbracket  \Ropenbracket
+\installmathfencepair \llbracket  \Lopenbracket \rrbracket  \Ropenbracket
\installmathfencepair \lgroup     \Lgroup       \rgroup     \Rgroup

Wolfgang

From schuster.wolfgang at gmail.com  Mon Jan  4 12:26:26 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 04 Jan 2016 12:26:26 +0100
Subject: [dev-context] math-fen.mkiv
Message-ID: <568A56E2.2000809@gmail.com>

Hi,

on line 185 it should be \llangle:

\installmathfencepair \lbrace     \Lbrace       \rbrace     \Rbrace
\installmathfencepair \lbracket   \Lbracket     \rbracket   \Rbracket
\installmathfencepair \lparen     \Lparen       \rparen     \Rparen
\installmathfencepair \lparent    \Lparent      \rparent    \Rparent
\installmathfencepair \langle     \Langle       \rangle     \Rangle
-installmathfencepair \lrangle    \Ldoubleangle \rrangle    \Rdoubleangle
+\installmathfencepair \llangle    \Ldoubleangle \rrangle    \Rdoubleangle
\installmathfencepair \lbar       \Lbar         \rbar       \Rbar
\installmathfencepair \lVert      \Ldoublebar   \rVert      \Rdoublebar
\installmathfencepair \vert       \Lbar         \vert       \Rbar
\installmathfencepair \solidus    \Lsolidus     \solidus    \Rsolidus
\installmathfencepair \lfloor     \Lfloor       \rfloor     \Rfloor
\installmathfencepair \lceil      \Lceil        \rceil      \Rceil

Wolfgang

From schuster.wolfgang at gmail.com  Mon Jan  4 12:50:00 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 04 Jan 2016 12:50:00 +0100
Subject: [dev-context] \lparent or \lparent?
Message-ID: <568A5C68.5080802@gmail.com>

Hi,

do we need both definitions in math-fen.mkiv?

\installmathfencepair \lparen \Lparen \rparen \Rparen
\installmathfencepair \lparent \Lparent \rparent \Rparent


AFAIK \left\lparen should be the same as \left( but this doesnât work 
because there is
no defintion for \Lparen in math-fen.mkiv and char-def.lua contains only 
a entry for "lparent".


Here is a short example with the output of \lparen (and \rparen):

\starttext

\startformula
\left\lparen x \right\rparen
% \left\langle x \right\rangle
\left\lparent x \right\rparent
\stopformula

\type{\lparen }: \meaning\lparen \par
\type{\rparen }: \meaning\rparen \par
\type{\lparent}: \meaning\lparent \par
\type{\rparent}: \meaning\rparent

\stoptext


Wolfgang

From wolfgang.schuster at gmail.com  Mon Jan  4 13:01:34 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Mon, 04 Jan 2016 13:01:34 +0100
Subject: [dev-context] math-fen.mkiv: \lbar and \rbar
Message-ID: <568A5F1E.3060305@gmail.com>

Hi,

another broken delimiter command:

\starttext

\startformula
     \left\lbar x \right\rbar
\stopformula

\type{\lbar}: \meaning\lbar \par
\type{\rbar}: \meaning\rbar

\stoptext


Wolfgang

From pragma at wxs.nl  Mon Jan  4 13:46:22 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 4 Jan 2016 13:46:22 +0100
Subject: [dev-context] \lparent or \lparent?
In-Reply-To: <568A5C68.5080802@gmail.com>
References: <568A5C68.5080802@gmail.com>
Message-ID: <568A699E.70303@wxs.nl>

On 1/4/2016 12:50 PM, Wolfgang Schuster wrote:
> Hi,
>
> do we need both definitions in math-fen.mkiv?
>
> \installmathfencepair \lparen \Lparen \rparen \Rparen
> \installmathfencepair \lparent \Lparent \rparent \Rparent
>
>
> AFAIK \left\lparen should be the same as \left( but this doesnât work
> because there is
> no defintion for \Lparen in math-fen.mkiv and char-def.lua contains only
> a entry for "lparent".

so:

\let\lparen\lparent
\let\rparen\rparent

i think that they're there because some old time expectations but i have 
no problem dropping them

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at cea.fr  Mon Jan  4 17:12:38 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Mon, 4 Jan 2016 09:12:38 -0700
Subject: [dev-context] \lparent or \lparent?
In-Reply-To: <568A699E.70303@wxs.nl>
References: <568A5C68.5080802@gmail.com>
	<568A699E.70303@wxs.nl>
Message-ID: <20160104091238.6c9d682c@cea.fr>

Hi,

I do not know the history of \lparen and \lparent
(not in the TeX Book nor in the LaTeX Companion),
but I find these abbreviations to be unfortunate.

As Hans knows, we eliminated them from the bibliography subsystem,
preferring "parenthesis" to "paren" or "parent".

These cryptic (and confusing) abbreviations should be avoided when
possible. But, of course, we should keep "sacred" abbreviations that are
standard in TeX (but not necessarily all offshoots).

Alan

PS, how is this better than the TeX \left( ?
(it shouldn't matter that it is one rather than two tokens.)


On Mon, 4 Jan 2016 13:46:22 +0100
Hans Hagen <pragma at wxs.nl> wrote:

> On 1/4/2016 12:50 PM, Wolfgang Schuster wrote:
> > Hi,
> >
> > do we need both definitions in math-fen.mkiv?
> >
> > \installmathfencepair \lparen \Lparen \rparen \Rparen
> > \installmathfencepair \lparent \Lparent \rparent \Rparent
> >
> >
> > AFAIK \left\lparen should be the same as \left( but this doesnât
> > work because there is
> > no defintion for \Lparen in math-fen.mkiv and char-def.lua contains
> > only a entry for "lparent".  
> 
> so:
> 
> \let\lparen\lparent
> \let\rparen\rparent
> 
> i think that they're there because some old time expectations but i
> have no problem dropping them
> 
> Hans
> 
> 
> -----------------------------------------------------------------
>                                            Hans Hagen | PRAGMA ADE
>                Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
>      tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
>                                               | www.pragma-pod.nl
> -----------------------------------------------------------------
> _______________________________________________
> dev-context mailing list
> dev-context at ntg.nl
> http://mailman.ntg.nl/mailman/listinfo/dev-context



-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From pragma at wxs.nl  Mon Jan  4 17:33:13 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 4 Jan 2016 17:33:13 +0100
Subject: [dev-context] \lparent or \lparent?
In-Reply-To: <20160104091238.6c9d682c@cea.fr>
References: <568A5C68.5080802@gmail.com> <568A699E.70303@wxs.nl>
 <20160104091238.6c9d682c@cea.fr>
Message-ID: <568A9EC9.2070901@wxs.nl>

On 1/4/2016 5:12 PM, Alan BRASLAU wrote:
> Hi,
>
> I do not know the history of \lparen and \lparent
> (not in the TeX Book nor in the LaTeX Companion),
> but I find these abbreviations to be unfortunate.
>
> As Hans knows, we eliminated them from the bibliography subsystem,
> preferring "parenthesis" to "paren" or "parent".
>
> These cryptic (and confusing) abbreviations should be avoided when
> possible. But, of course, we should keep "sacred" abbreviations that are
> standard in TeX (but not necessarily all offshoots).
>
> Alan
>
> PS, how is this better than the TeX \left( ?
> (it shouldn't matter that it is one rather than two tokens.)

that depends ...

   \left\foo : one token
   \left(    : one token
   \left((   : interpreting ( ( becomes messy

so better is just

   \lparent foo \rparent

(tex is also a bit picky when it comes to unmatched \left and \right so 
we need to catch that too)

some of the abbreviations are coming from all those messy incomplete cq. 
merged cq ... systems that deal with math (mathml entities, traditional 
who-knows-where-they-come-from names, too tolerant asciimath hybrids, 
etc.) so that's why we have more such funny names than needed: it's the 
way we support automated typesetting ... you really don't want to know 
what nightmarisch stuff we need to support so keep in mind that not all 
defined \commands in the core are intended for users, so \lparen is 
there but it can be for any reason (current or past), e.g. some crap we 
ran into that was supported someplace else and that we have to support 
maybe just because some sloppy programmer decided to support a sloppy 
user not realizing possible conflicts or bad side effects elsewhere)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From adityam at umich.edu  Tue Jan  5 18:54:43 2016
From: adityam at umich.edu (Aditya Mahajan)
Date: Tue, 5 Jan 2016 12:54:43 -0500 (EST)
Subject: [dev-context] \lparent or \lparent?
In-Reply-To: <568A699E.70303@wxs.nl>
References: <568A5C68.5080802@gmail.com> <568A699E.70303@wxs.nl>
Message-ID: <alpine.OSX.2.02.1601051250410.21726@nqv-znpobbx>

On Mon, 4 Jan 2016, Hans Hagen wrote:

> On 1/4/2016 12:50 PM, Wolfgang Schuster wrote:
>> Hi,
>>
>> do we need both definitions in math-fen.mkiv?
>>
>> \installmathfencepair \lparen \Lparen \rparen \Rparen
>> \installmathfencepair \lparent \Lparent \rparent \Rparent
>>
>>
>> AFAIK \left\lparen should be the same as \left( but this doesnât work
>> because there is
>> no defintion for \Lparen in math-fen.mkiv and char-def.lua contains only
>> a entry for "lparent".
>
> so:
>
> \let\lparen\lparent
> \let\rparen\rparent
>
> i think that they're there because some old time expectations but i have 
> no problem dropping them

Probably because some users coming from latex expected them. The mathtools 
package defines \lparen and \rparen.

Personally, I find "(l|r)parent" to be an awkward name for the macros 
because it is not clear what "parent" means. (l|r)parenthesis is a better 
choice or, if a short name is needed, then (l|r)paren (so that it is clear 
we are abbreviating the name).

Aditya

From wolfgang.schuster at gmail.com  Wed Jan  6 10:28:26 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Wed, 06 Jan 2016 10:28:26 +0100
Subject: [dev-context] trac-vis.mkiv
Message-ID: <568CDE3A.4010900@gmail.com>

Hi,

\def\syst_visualizers_filled_hbox#1%
- {\node_backgrounds_boxes_initialize\hbox\backgroundcolorattr{#1}}
+ {\node_backgrounds_boxes_add\hbox[#1]}

Wolfgang

From schuster.wolfgang at gmail.com  Wed Jan  6 16:09:03 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Wed, 06 Jan 2016 16:09:03 +0100
Subject: [dev-context] type-ini.mkvi
Message-ID: <568D2E0F.6080508@gmail.com>

Hi,

\def\font_typefaces_setup[#class][#settings]%
   {\setcurrentfontclass{#class}%
    \let\globalfontclass\fontclass
-  \iffourthargument
+  \ifsecondargument
      \setupbodyfont[#settings]%
    \else\ifx\fontclass\empty
      \setupbodyfont[\s!rm]%
    \else\ifcsname\??typescriptdefaultstyles\fontclass\endcsname
     %\setupbodyfont[\csname\??typescriptdefaultstyles\fontclass\endcsname]%
      \expandafter\setupbodyfont\expandafter[\lastnamedcs]%
    \else
      \setupbodyfont[\s!rm]%
    \fi \fi \fi
    \ifmmode\mr\else\tf\fi} % needed ?

\def\font_typefaces_switch[#class][#settings]%
   {\setcurrentfontclass{#class}%
    \let\globalfontclass\globalfontclass
-  \iffourthargument
+  \ifsecondargument
      \switchtobodyfont[#settings]%
    \else\ifx\fontclass\empty
      \switchtobodyfont[\s!rm]%
    \else\ifcsname\??typescriptdefaultstyles\fontclass\endcsname
     
%\switchtobodyfont[\csname\??typescriptdefaultstyles\fontclass\endcsname]%
      \expandafter\switchtobodyfont\expandafter[\lastnamedcs]%
    \else
      \switchtobodyfont[\s!rm]%
    \fi \fi \fi
    \ifmmode\mr\else\tf\fi} % needed ?

Wolfgang

From schuster.wolfgang at gmail.com  Thu Jan  7 15:06:05 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 07 Jan 2016 15:06:05 +0100
Subject: [dev-context] typo-inj.mkiv
Message-ID: <568E70CD.9070505@gmail.com>

Hi,

are the definitions for \checknextinjector and \checkpreviousinjector 
correct because \checkpreviousinjector takes a argument but 
\checknextinjector doesnât?

typo-inj.mkiv:

\unexpanded\def\checknextinjector {\clf_checknextinjector}
\unexpanded\def\checkpreviousinjector {\clf_checkpreviousinjector}

typo-inj.lua:

implement { name = "checkpreviousinjector", actions = injectors.check, 
arguments = { "string", true } }
implement { name = "checknextinjector", actions = injectors.check }

Wolfgang

From luigi.scarso at gmail.com  Mon Jan 18 12:29:23 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Mon, 18 Jan 2016 12:29:23 +0100
Subject: [dev-context] Luatex 0.88.0 announcement
Message-ID: <CAG5iGsAYvaKNNT083rP1B6V_yxHmvjObtegwX7JrK0yMxyaEUQ@mail.gmail.com>

==============================================================
Luatex Release 0.88.0 was released 2016011500
==============================================================

This is a next step upto 0.90 and it has the following changes:

- mostly small bug fixes

- a few setters/getters added to the pdf namespace (were in the tex one
before)

- The current libraries under libs are now:
  * poppler-0.40.0
  * mpfr-3.1.3
  * luajit-2.1.0-beta1
  * gmp-6.1.0
  * zziplib-0.13.62
  * zlib-1.2.8
  * lua52-5.2.4
  * pixman-0.32.8
  * libpng-1.6.21
  * cairo-1.14.6


Have fun,
The luatex team
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160118/80b94800/attachment.html>

From schuster.wolfgang at gmail.com  Sat Jan 30 12:45:46 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 30 Jan 2016 12:45:46 +0100
Subject: [dev-context] x-set-11.mkiv
Message-ID: <56ACA26A.3060104@gmail.com>

Hi Hans,

the module still misses the {..,.=.,..} assignment type which is needed 
for \useMPgraphic, e.g.

\useMPgraphic{...}{..,.=.,..}


You have to add also xml setups for the new argument type, see attachment.


The following lines have to be fixed as well, e.g. âcd:oneargumentâ 
displays \...\#1 (notice the extra backslash)

\c!setup!definereserved {cd:noargument} {\c!setup!command! {\texescape}}
\c!setup!definereserved {cd:oneargument} {\c!setup!command! 
{\texescape\texthash1}}
\c!setup!definereserved {cd:twoarguments} {\c!setup!command! 
{\texescape\texthash1\texthash2}}
\c!setup!definereserved {cd:threearguments} {\c!setup!command! 
{\texescape\texthash1\texthash2\texthash3}}

and I have no idea what these are for

\c!setup!definereserved {cd:noargumentwrapped} {\c!setup!command! 
{\texescape...}}
\c!setup!definereserved {cd:oneargumentwrapped} {\c!setup!command! 
{\texescape...\texthash1}}
\c!setup!definereserved {cd:twoargumentswrapped} {\c!setup!command! 
{\texescape...\texthash1\texthash2}}
\c!setup!definereserved {cd:threeargumentswrapped} {\c!setup!command! 
{\texescape...\texthash1\texthash2\texthash3}}


Wolfgang
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: x-set-11.diff
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160130/4e6f39b8/attachment.ksh>

From pragma at wxs.nl  Sun Jan 31 11:39:28 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 31 Jan 2016 11:39:28 +0100
Subject: [dev-context] x-set-11.mkiv
In-Reply-To: <56ACA26A.3060104@gmail.com>
References: <56ACA26A.3060104@gmail.com>
Message-ID: <56ADE460.1080503@wxs.nl>

On 1/30/2016 12:45 PM, Wolfgang Schuster wrote:
> Hi Hans,
>
> the module still misses the {..,.=.,..} assignment type which is needed
> for \useMPgraphic, e.g.
>
> \useMPgraphic{...}{..,.=.,..}
>
>
> You have to add also xml setups for the new argument type, see attachment.
>
>
> The following lines have to be fixed as well, e.g. âcd:oneargumentâ
> displays \...\#1 (notice the extra backslash)
>
> \c!setup!definereserved {cd:noargument} {\c!setup!command! {\texescape}}
> \c!setup!definereserved {cd:oneargument} {\c!setup!command!
> {\texescape\texthash1}}
> \c!setup!definereserved {cd:twoarguments} {\c!setup!command!
> {\texescape\texthash1\texthash2}}
> \c!setup!definereserved {cd:threearguments} {\c!setup!command!
> {\texescape\texthash1\texthash2\texthash3}}
>
> and I have no idea what these are for
>
> \c!setup!definereserved {cd:noargumentwrapped} {\c!setup!command!
> {\texescape...}}
> \c!setup!definereserved {cd:oneargumentwrapped} {\c!setup!command!
> {\texescape...\texthash1}}
> \c!setup!definereserved {cd:twoargumentswrapped} {\c!setup!command!
> {\texescape...\texthash1\texthash2}}
> \c!setup!definereserved {cd:threeargumentswrapped} {\c!setup!command!
> {\texescape...\texthash1\texthash2\texthash3}}

cleanest without duplicating is

             <cd:keywords/>
             <cd:assignments/>
             <cd:keywords list="yes" />
             <cd:assignments list="yes" />
             <cd:keywords delimiters="braces"/>
             <cd:assignments delimiters="braces"/>
             <cd:keywords list="yes" delimiters="braces"/>
             <cd:assignments list="yes" delimiters="braces"/>

so i'll do that

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From wolfgang.schuster at gmail.com  Wed Feb  3 16:34:25 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Wed, 03 Feb 2016 16:34:25 +0100
Subject: [dev-context] x-set-11.mkiv
Message-ID: <56B21E01.6060803@gmail.com>

Hi Hans,

can you add the following two delimiters types (none and parentheses) to 
the keywords tag.

\xmlmapvalue {setups:keyword} {braces}      {\showSETUPkeywordbraces}
\xmlmapvalue {setups:keyword} {brackets}    {\showSETUPkeywordbrackets}
+\xmlmapvalue {setups:keyword} {parentheses} {\showSETUPkeywordparentheses}
+\xmlmapvalue {setups:keyword} {none}        {\showSETUPkeywordnone}

\starttexdefinition unexpanded showSETUPkeywordbraces #1
     \ifcase\kindofsetup
         \showSETUPline{\letterleftbrace...\letterrightbrace}
     \else
         \showSETUP{#1}
             {\letterleftbrace...\letterrightbrace}
             {\letterleftbrace...,...\letterrightbrace}
     \fi
\stoptexdefinition

\starttexdefinition unexpanded showSETUPkeywordbrackets #1
     \ifcase\kindofsetup
         \showSETUPline{[...]}
     \else
         \showSETUP{#1}
             {[...]}
             {[...,...]}
     \fi
\stoptexdefinition

+\starttexdefinition unexpanded showSETUPkeywordparentheses #1
+    \ifcase\kindofsetup
+        \showSETUPline{(...)}
+    \else
+        \showSETUP{#1}
+            {(...)}
+            {(...,...)}
+    \fi
+\stoptexdefinition

+\starttexdefinition unexpanded showSETUPkeywordnone #1
+    \ifcase\kindofsetup
+        \showSETUPline{...}
+    \else
+        \showSETUP{#1}
+            {...}
+            {.. ... ..}
+    \fi
+\stoptexdefinition


Wolfgang

From pragma at wxs.nl  Wed Feb  3 20:55:51 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 3 Feb 2016 20:55:51 +0100
Subject: [dev-context] x-set-11.mkiv
In-Reply-To: <56B21E01.6060803@gmail.com>
References: <56B21E01.6060803@gmail.com>
Message-ID: <56B25B47.3060106@wxs.nl>

On 2/3/2016 4:34 PM, Wolfgang Schuster wrote:
> Hi Hans,
>
> can you add the following two delimiters types (none and parentheses) to
> the keywords tag.

ok

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From luigi.scarso at gmail.com  Sat Feb  6 18:33:01 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sat, 6 Feb 2016 18:33:01 +0100
Subject: [dev-context] Luatex 0.89.0 announcement
Message-ID: <CAG5iGsDYgN+EHc=2EMZNH8w4AJ-TpXbzci3yVTQ38e2ke0G9+w@mail.gmail.com>

==============================================================
Luatex Release 0.89.0 was released 2016020500
==============================================================

No fundamental changes, just some fixes / improvements (and of course new
bugglets).

- New backend things:
 \pdfvariable pkfixeddpi = integer % > 0 : use only default dpi (so one can
do with one high res instance)
 \pdfvariable ignoreunknownimages = integer % > 0 : ignore missing and
inject something empty (to be used with care)
  and one can do this:
 \edef\foo{\pdfvariable foo}
 \def \oof{foo}
 \ifx\foo\oof don't fool me\fi
 (side effect of no longer aborting on missing, so one implement a catch)




As usual,
the archives can be downloaded from supelec:

        https://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co --username anonsvn --password anonsvn              \
      https://foundry.supelec.fr/svn/luatex/tags/beta-0.87.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org

When you use context or latex you need an updated format. The latest
version of
context can be fetched from the context garden, latex from ctan. For latex
you can contact David and Joseph as they are dealing with the update.


Have fun,
Hans, Luigi, Taco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160206/33d76835/attachment.html>

From schuster.wolfgang at gmail.com  Mon Feb  8 13:59:39 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 08 Feb 2016 13:59:39 +0100
Subject: [dev-context] math-ini.mkiv: \dotlessi
Message-ID: <56B8913B.9020603@gmail.com>

Hi,

there is a extra pair of braces needed in folllowing definitions, 
otherwise all following i and j are dotless.

-\unexpanded\def\mathdotlessi    {\mathdotless i}
-\unexpanded\def\mathdotlessj    {\mathdotless j}
+\unexpanded\def\mathdotlessi   {{\mathdotless i}}
+\unexpanded\def\mathdotlessj   {{\mathdotless j}}

Wolfgang

From schuster.wolfgang at gmail.com  Sat Feb 13 18:12:18 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 13 Feb 2016 18:12:18 +0100
Subject: [dev-context] font-ctx.lua
Message-ID: <56BF63F2.6000603@gmail.com>

Hi,

     implement {
         name      = "doifelsecurrentfonthasfeature",
-       actions   = { currentfonthasfeature, commands.doifelse },
+       actions   = { constructors.currentfonthasfeature, 
commands.doifelse },
         arguments = "string"
     }

Wolfgang

From schuster.wolfgang at gmail.com  Sun Feb 14 20:26:50 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 14 Feb 2016 20:26:50 +0100
Subject: [dev-context] strc-flt.mkvi
Message-ID: <56C0D4FA.3050806@gmail.com>

Hi,

\def\doifelserightpagefloat
   {\ifdoublesided
      \ifsinglesided
        \doubleexpandafter\firstoftwoarguments
      \else
-      \doubleexpandafter\doifelseoddfloatpage
+      \doubleexpandafter\doifelseoddpagefloat
      \fi
    \else
      \expandafter\firstoftwoarguments
    \fi}

-\def\doifelseoddfloatpage
+\def\doifelseoddpagefloat
   {\ifodd\purenumber\strc_float_realpage\space
      \expandafter\firstoftwoarguments
    \else
      \expandafter\secondoftwoarguments
    \fi}

Wolfgang

From pragma at wxs.nl  Mon Feb 15 11:34:57 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 15 Feb 2016 11:34:57 +0100
Subject: [dev-context] frule
Message-ID: <56C1A9D1.7070103@wxs.nl>

Hi,

A new feature ... not sure if i need to add the defineoverlays ...

\unprotect
     \def\overlayradius{\framedparameter\c!frameradius}
\protect

\dontcomplain

\starttext

\testfeatureonce{25}{\dontleavehmode
     \ruledhbox\bgroup
         \red
         \frule
             width  2cm
             height 2cm
             depth  1cm
             radius 2mm
             type   fill
             line   2pt
         \relax
         \hskip-2cm
         \green
         \frule
             width  2cm
             height 2cm
             depth  1cm
             radius 2mm
             line   2pt
         \relax
     \egroup
\space}

\blank

\startuseMPgraphic{demoshape:back}
     fill
         unitcircle xysized (RuleWidth,RuleHeight+RuleDepth)
         withcolor RuleColor ;
\stopuseMPgraphic

\startuseMPgraphic{demoshape:fore}
     draw
         unitcircle xysized (RuleWidth,RuleHeight+RuleDepth)
         withcolor RuleColor
         withpen pencircle scaled RuleThickness ;
\stopuseMPgraphic

\testfeatureonce{100}{\dontleavehmode
     \ruledhbox\bgroup
         \red
         \frule
             width  1cm
             height 3mm
             depth  1mm
             type   mp
             data   {\includeMPgraphic{demoshape:back}}
             line   2pt
         \relax
         \hskip-1cm
         \green
         \frule
             width  1cm
             height 3mm
             depth  1mm
             type   mp
             data   {\includeMPgraphic{demoshape:fore}}
             line   2pt
         \relax
     \egroup
\space}

\blank

\defineoverlay[normalframe]
   [\frule
      width \overlaywidth
      height\overlayheight
      line  \overlaylinewidth
    \relax]

\defineoverlay[ovalframe]
   [\frule
      width  \overlaywidth
      height \overlayheight
      line   \overlaylinewidth
      radius \overlayradius
    \relax]

\dontleavehmode
\testfeatureonce{1}{\setbox\scratchbox\hbox{\framed 
              {test}}}
                                             \framed 
               {test}
\testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=normalframe,frame=off]{test}}}
 
\framed[background=normalframe,frame=off]{test}
\testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[corner=round] 
              {test}}}
                                             \framed[corner=round] 
               {test}
\testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=ovalframe,frame=off] 
  {test}}}
 
\framed[background=ovalframe,frame=off]  {test}
\testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=ovalframe,frame=on] 
   {test}}}
 
\framed[background=ovalframe,frame=on]   {test}

\stoptext

-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at cea.fr  Mon Feb 15 18:17:00 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Mon, 15 Feb 2016 10:17:00 -0700
Subject: [dev-context] frule
In-Reply-To: <56C1A9D1.7070103@wxs.nl>
References: <56C1A9D1.7070103@wxs.nl>
Message-ID: <20160215101700.098e1635@cea.fr>

Even though it says "\dontcomplain"... ;-)

I am not sure that I understand the demonstration of the second part,
with the defineoverlays...

Alan

On Mon, 15 Feb 2016 11:34:57 +0100
Hans Hagen <pragma at wxs.nl> wrote:

> Hi,
> 
> A new feature ... not sure if i need to add the defineoverlays ...
> 
> \unprotect
>      \def\overlayradius{\framedparameter\c!frameradius}
> \protect
> 
> \dontcomplain
> 
> \starttext
> 
> \testfeatureonce{25}{\dontleavehmode
>      \ruledhbox\bgroup
>          \red
>          \frule
>              width  2cm
>              height 2cm
>              depth  1cm
>              radius 2mm
>              type   fill
>              line   2pt
>          \relax
>          \hskip-2cm
>          \green
>          \frule
>              width  2cm
>              height 2cm
>              depth  1cm
>              radius 2mm
>              line   2pt
>          \relax
>      \egroup
> \space}
> 
> \blank
> 
> \startuseMPgraphic{demoshape:back}
>      fill
>          unitcircle xysized (RuleWidth,RuleHeight+RuleDepth)
>          withcolor RuleColor ;
> \stopuseMPgraphic
> 
> \startuseMPgraphic{demoshape:fore}
>      draw
>          unitcircle xysized (RuleWidth,RuleHeight+RuleDepth)
>          withcolor RuleColor
>          withpen pencircle scaled RuleThickness ;
> \stopuseMPgraphic
> 
> \testfeatureonce{100}{\dontleavehmode
>      \ruledhbox\bgroup
>          \red
>          \frule
>              width  1cm
>              height 3mm
>              depth  1mm
>              type   mp
>              data   {\includeMPgraphic{demoshape:back}}
>              line   2pt
>          \relax
>          \hskip-1cm
>          \green
>          \frule
>              width  1cm
>              height 3mm
>              depth  1mm
>              type   mp
>              data   {\includeMPgraphic{demoshape:fore}}
>              line   2pt
>          \relax
>      \egroup
> \space}
> 
> \blank
> 
> \defineoverlay[normalframe]
>    [\frule
>       width \overlaywidth
>       height\overlayheight
>       line  \overlaylinewidth
>     \relax]
> 
> \defineoverlay[ovalframe]
>    [\frule
>       width  \overlaywidth
>       height \overlayheight
>       line   \overlaylinewidth
>       radius \overlayradius
>     \relax]
> 
> \dontleavehmode
> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed 
>               {test}}}
>                                              \framed 
>                {test}
> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=normalframe,frame=off]{test}}}
>  
> \framed[background=normalframe,frame=off]{test}
> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[corner=round] 
>               {test}}}
>                                              \framed[corner=round] 
>                {test}
> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=ovalframe,frame=off] 
>   {test}}}
>  
> \framed[background=ovalframe,frame=off]  {test}
> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=ovalframe,frame=on] 
>    {test}}}
>  
> \framed[background=ovalframe,frame=on]   {test}
> 
> \stoptext
> 



-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From pragma at wxs.nl  Mon Feb 15 18:36:15 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 15 Feb 2016 18:36:15 +0100
Subject: [dev-context] frule
In-Reply-To: <20160215101700.098e1635@cea.fr>
References: <56C1A9D1.7070103@wxs.nl> <20160215101700.098e1635@cea.fr>
Message-ID: <56C20C8F.4050200@wxs.nl>

On 2/15/2016 6:17 PM, Alan BRASLAU wrote:
> Even though it says "\dontcomplain"... ;-)
>
> I am not sure that I understand the demonstration of the second part,
> with the defineoverlays...

basically we use rules that get replaced by graphics (a normal framed 
has 4 overlapping rules, the example has one continuous shape)

> Alan
>
> On Mon, 15 Feb 2016 11:34:57 +0100
> Hans Hagen <pragma at wxs.nl> wrote:
>
>> Hi,
>>
>> A new feature ... not sure if i need to add the defineoverlays ...
>>
>> \unprotect
>>       \def\overlayradius{\framedparameter\c!frameradius}
>> \protect
>>
>> \dontcomplain
>>
>> \starttext
>>
>> \testfeatureonce{25}{\dontleavehmode
>>       \ruledhbox\bgroup
>>           \red
>>           \frule
>>               width  2cm
>>               height 2cm
>>               depth  1cm
>>               radius 2mm
>>               type   fill
>>               line   2pt
>>           \relax
>>           \hskip-2cm
>>           \green
>>           \frule
>>               width  2cm
>>               height 2cm
>>               depth  1cm
>>               radius 2mm
>>               line   2pt
>>           \relax
>>       \egroup
>> \space}
>>
>> \blank
>>
>> \startuseMPgraphic{demoshape:back}
>>       fill
>>           unitcircle xysized (RuleWidth,RuleHeight+RuleDepth)
>>           withcolor RuleColor ;
>> \stopuseMPgraphic
>>
>> \startuseMPgraphic{demoshape:fore}
>>       draw
>>           unitcircle xysized (RuleWidth,RuleHeight+RuleDepth)
>>           withcolor RuleColor
>>           withpen pencircle scaled RuleThickness ;
>> \stopuseMPgraphic
>>
>> \testfeatureonce{100}{\dontleavehmode
>>       \ruledhbox\bgroup
>>           \red
>>           \frule
>>               width  1cm
>>               height 3mm
>>               depth  1mm
>>               type   mp
>>               data   {\includeMPgraphic{demoshape:back}}
>>               line   2pt
>>           \relax
>>           \hskip-1cm
>>           \green
>>           \frule
>>               width  1cm
>>               height 3mm
>>               depth  1mm
>>               type   mp
>>               data   {\includeMPgraphic{demoshape:fore}}
>>               line   2pt
>>           \relax
>>       \egroup
>> \space}
>>
>> \blank
>>
>> \defineoverlay[normalframe]
>>     [\frule
>>        width \overlaywidth
>>        height\overlayheight
>>        line  \overlaylinewidth
>>      \relax]
>>
>> \defineoverlay[ovalframe]
>>     [\frule
>>        width  \overlaywidth
>>        height \overlayheight
>>        line   \overlaylinewidth
>>        radius \overlayradius
>>      \relax]
>>
>> \dontleavehmode
>> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed
>>                {test}}}
>>                                               \framed
>>                 {test}
>> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=normalframe,frame=off]{test}}}
>>
>> \framed[background=normalframe,frame=off]{test}
>> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[corner=round]
>>                {test}}}
>>                                               \framed[corner=round]
>>                 {test}
>> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=ovalframe,frame=off]
>>    {test}}}
>>
>> \framed[background=ovalframe,frame=off]  {test}
>> \testfeatureonce{1}{\setbox\scratchbox\hbox{\framed[background=ovalframe,frame=on]
>>     {test}}}
>>
>> \framed[background=ovalframe,frame=on]   {test}
>>
>> \stoptext
>>
>
>
>


-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at cea.fr  Mon Feb 15 18:39:44 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Mon, 15 Feb 2016 10:39:44 -0700
Subject: [dev-context] frule
In-Reply-To: <56C20C8F.4050200@wxs.nl>
References: <56C1A9D1.7070103@wxs.nl> <20160215101700.098e1635@cea.fr>
 <56C20C8F.4050200@wxs.nl>
Message-ID: <20160215103944.32b0fce1@cea.fr>

On Mon, 15 Feb 2016 18:36:15 +0100
Hans Hagen <pragma at wxs.nl> wrote:

> basically we use rules that get replaced by graphics (a normal framed 
> has 4 overlapping rules, the example has one continuous shape)

Nice, but I still don't understand the demonstration.

Alan

-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From pragma at wxs.nl  Mon Feb 15 20:15:46 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 15 Feb 2016 20:15:46 +0100
Subject: [dev-context] frule
In-Reply-To: <20160215103944.32b0fce1@cea.fr>
References: <56C1A9D1.7070103@wxs.nl> <20160215101700.098e1635@cea.fr>
 <56C20C8F.4050200@wxs.nl> <20160215103944.32b0fce1@cea.fr>
Message-ID: <56C223E2.9050002@wxs.nl>

On 2/15/2016 6:39 PM, Alan BRASLAU wrote:
> On Mon, 15 Feb 2016 18:36:15 +0100
> Hans Hagen <pragma at wxs.nl> wrote:
>
>> basically we use rules that get replaced by graphics (a normal framed
>> has 4 overlapping rules, the example has one continuous shape)
>
> Nice, but I still don't understand the demonstration.

it's more the kind of stuff wolfgang or aditya might use (or run into)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From lists at homerow.info  Wed Feb 17 21:32:54 2016
From: lists at homerow.info (Marco Patzer)
Date: Wed, 17 Feb 2016 21:32:54 +0100
Subject: [dev-context] typo-del.mkiv
Message-ID: <20160217213254.15afe438@homerow>

Hi!

Stumbled upon:

typo-del.mkiv:313:\def\typo_delimited_repeat_ideed
typo-del.mkiv:344:     \let\typo_delimited_repeat\typo_delimited_repeat_ideed

indeed

Marco

From schuster.wolfgang at gmail.com  Mon Feb 22 10:28:57 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 22 Feb 2016 10:28:57 +0100
Subject: [dev-context] page-mix.mkiv
Message-ID: <56CAD4D9.8030608@gmail.com>

Hi,

the space between columns is missing in the default direction.

\unexpanded\def\page_mix_routine_package
   {\clf_mixfinalize
    \setbox\b_page_mix_collected\vbox \bgroup
      \ifvoid\b_page_mix_preceding \else
      % \page_postprocessors_linenumbers_deepbox\b_page_mix_preceding % 
already done
        \vpack\bgroup
          \box\b_page_mix_preceding
        \egroup
        \global\d_page_mix_preceding_height\zeropoint
        \nointerlineskip
        % no no:
        % \prevdepth\strutdepth
      \fi
      \hskip\d_page_mix_leftskip
      \page_mix_hbox to \d_page_mix_max_width \bgroup
        \edef\p_separator{\mixedcolumnsparameter\c!separator}%
        \mixedcolumnseparatorwidth\d_page_mix_distance % 
\mixedcolumnsparameter\c!rulethickness\relax
        \edef\p_direction{\mixedcolumnsparameter\c!direction}%
        \ifx\p_direction\v!reverse
          \dostepwiserecurse\c_page_mix_n_of_columns\plusone\minusone
             {\page_mix_routine_package_step
              \ifnum\recurselevel>\plusone
                \page_mix_routine_package_separate
              \fi}%
        \else
          \dorecurse\c_page_mix_n_of_columns
             {\page_mix_routine_package_step
-            \ifnum\recurselevel<\c_page_mix_n_of_columns
+            \ifnum\recurselevel>\c_page_mix_n_of_columns
                \page_mix_routine_package_separate
              \fi}%
        \fi
      \egroup
    \egroup}

Wolfgang

From wolfgang.schuster at gmail.com  Mon Feb 22 10:36:34 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Mon, 22 Feb 2016 10:36:34 +0100
Subject: [dev-context] itemgroupcolumns: page-mix.mkiv
Message-ID: <56CAD6A2.9030602@gmail.com>

Hi,

can the direction setting be added to the itemgroup columns?

\definemixedcolumns
   [\s!itemgroupcolumns]
   [\c!n=\itemgroupparameter\c!n,
+  \c!direction=\itemgroupparameter\c!direction,
    \c!separator=\v!none,
    \c!splitmethod=\v!none,
    \c!grid=\v!tolerant,
    \c!internalgrid=\v!halfline, % new, we may still revert to \v!line
    \c!balance=\v!yes]

Wolfgang

From wolfgang.schuster at gmail.com  Tue Feb 23 14:25:00 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Tue, 23 Feb 2016 14:25:00 +0100
Subject: [dev-context] \math: math-ini.mkiv
Message-ID: <56CC5DAC.1050501@gmail.com>

Hi Hans,

can you this to math-ini.mkiv (line 262):

\let\math\mathematics

because the \math command is at the moment only a copy of the 
\mathmatics command from supp-mat.mkiv which doesnât support the 
optional argument.

Wolfgang


From pragma at wxs.nl  Tue Feb 23 15:44:58 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 23 Feb 2016 15:44:58 +0100
Subject: [dev-context] \math: math-ini.mkiv
In-Reply-To: <56CC5DAC.1050501@gmail.com>
References: <56CC5DAC.1050501@gmail.com>
Message-ID: <56CC706A.3050601@wxs.nl>

On 2/23/2016 2:25 PM, Wolfgang Schuster wrote:
> Hi Hans,
>
> can you this to math-ini.mkiv (line 262):
>
> \let\math\mathematics

sure, as long as we don't tell Alan that line 261 stays

> because the \math command is at the moment only a copy of the
> \mathmatics command from supp-mat.mkiv which doesnât support the
> optional argument.
>
> Wolfgang
>
> _______________________________________________
> dev-context mailing list
> dev-context at ntg.nl
> https://mailman.ntg.nl/mailman/listinfo/dev-context


-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at comcast.net  Wed Feb 24 06:19:52 2016
From: alan.braslau at comcast.net (Alan BRASLAU)
Date: Tue, 23 Feb 2016 22:19:52 -0700
Subject: [dev-context] \startplaceformula
Message-ID: <20160223221952.454fba19@comcast.net>

In strc-mat.mkiv, we have:

\let\startplaceformula\placeformula
\let\stopplaceformula \relax


But would it not be more coherent with respect to ConTeXt syntax for it
to be used as:

\startplaceformula [reference=ref]
\stopplaceformula

rather than the present

\startplaceformula [ref]
\stopplaceformula

? \startplaceformula should take all of the options of \setupformulas.


In the case of named formulas (\placenamedformula), one could have

\startplaceformula [reference=ref,title=name]
\stopplaceformula


This would of course require some minor modifications.

Alan

From pragma at wxs.nl  Wed Feb 24 10:58:06 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 24 Feb 2016 10:58:06 +0100
Subject: [dev-context] \startplaceformula
In-Reply-To: <20160223221952.454fba19@comcast.net>
References: <20160223221952.454fba19@comcast.net>
Message-ID: <56CD7EAE.3020105@wxs.nl>

On 2/24/2016 6:19 AM, Alan BRASLAU wrote:
> In strc-mat.mkiv, we have:
>
> \let\startplaceformula\placeformula
> \let\stopplaceformula \relax
>
>
> But would it not be more coherent with respect to ConTeXt syntax for it
> to be used as:
>
> \startplaceformula [reference=ref]
> \stopplaceformula
>
> rather than the present
>
> \startplaceformula [ref]
> \stopplaceformula
>
> ? \startplaceformula should take all of the options of \setupformulas.
>
>
> In the case of named formulas (\placenamedformula), one could have
>
> \startplaceformula [reference=ref,title=name]
> \stopplaceformula
>
>
> This would of course require some minor modifications.

indeed this is on the agenda (one of these when-i'm-in-the-mood things)

(the problem is that these mechanism are bit complicated by the fact 
that we need to pick up the content, need to deal with sub things, etc.)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Wed Feb 24 11:54:30 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Wed, 24 Feb 2016 11:54:30 +0100
Subject: [dev-context] strc-itm.mkvi
Message-ID: <56CD8BE6.60505@gmail.com>

Hi,

a simple fix for the new âhorizontalâ optional for itemgroups:

\def\strc_itemgroups_collected_flush_horizontal
{\begingroup
\scratchcounter\itemgroupparameter\c!n\relax
\ifnum\c_strc_itemgroups_collected_done>\plusone
\ifcase\modulonumber\scratchcounter\c_strc_itemgroups_collected_done\relax
% compensate for rounding errors
\hfill % \hskip\zeropoint plus \scaledpoint minus \scaledpoint
\allowbreak
\fi
\fi
\noindent % no \dontleavehmode
- \hbox to 
\dimexpr\availablehsize/\scratchcounter\relax{\collecteditemgroupitem}%
+ \hbox to 
\dimexpr\availablehsize/\scratchcounter\relax{\collecteditemgroupitem\hss}%
\endgroup}

Wolfgang

From pragma at wxs.nl  Thu Feb 25 14:04:59 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 25 Feb 2016 14:04:59 +0100
Subject: [dev-context] \startplaceformula
In-Reply-To: <20160223221952.454fba19@comcast.net>
References: <20160223221952.454fba19@comcast.net>
Message-ID: <56CEFBFB.8010606@wxs.nl>

On 2/24/2016 6:19 AM, Alan BRASLAU wrote:
> In strc-mat.mkiv, we have:
>
> \let\startplaceformula\placeformula
> \let\stopplaceformula \relax
>
>
> But would it not be more coherent with respect to ConTeXt syntax for it
> to be used as:
>
> \startplaceformula [reference=ref]
> \stopplaceformula
>
> rather than the present
>
> \startplaceformula [ref]
> \stopplaceformula
>
> ? \startplaceformula should take all of the options of \setupformulas.
>
>
> In the case of named formulas (\placenamedformula), one could have
>
> \startplaceformula [reference=ref,title=name]
> \stopplaceformula
>
>
> This would of course require some minor modifications.

i made the next ... so it's not entirely compatible (we need to keep the 
explicit \start..\stop because there can be matrices as well (unless i 
also patch those but let's not go too fast)

\starttext
     \startplaceformula
         \startformula
             e=mc^2
         \stopformula
     \stopplaceformula
     \startplaceformula[-]
         \startformula
             e=mc^2
         \stopformula
     \stopplaceformula
     \startplaceformula[x]
         \startformula
             e=mc^2
         \stopformula
     \stopplaceformula
     \startplaceformula[reference=foo]
         \startformula
             e=mc^2
         \stopformula
     \stopplaceformula
     \startplaceformula[title=whatever]
         \startformula
             e=mc^2
         \stopformula
     \stopplaceformula
     \startplaceformula[suffix=x]
         \startformula
             e=mc^2
         \stopformula
     \stopplaceformula
\stoptext



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Thu Feb 25 14:27:36 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 25 Feb 2016 14:27:36 +0100
Subject: [dev-context] \startplaceformula
In-Reply-To: <56CEFBFB.8010606@wxs.nl>
References: <20160223221952.454fba19@comcast.net> <56CEFBFB.8010606@wxs.nl>
Message-ID: <56CF0148.3070508@gmail.com>

> Hans Hagen <mailto:pragma at wxs.nl>
> 25. Februar 2016 um 14:04
>
>
> i made the next ... so it's not entirely compatible (we need to keep 
> the explicit \start..\stop because there can be matrices as well 
> (unless i also patch those but let's not go too fast)
>
> \starttext
>     \startplaceformula
this produces an unwanted empty brace because you forgot the dummy argument.

-\def\strc_formulas_start_place_nop
+\def\strc_formulas_start_place_nop[#1]%
   {\let\currentplaceformulareference\empty
    \let\currentplaceformulasuffix   \empty
    \strc_formulas_place_nop}

You reset also the wrong dummy parameter:

\def\strc_formulas_start_place_parameters[#1]%
- {\letdummyparameter\c!name     \empty
+ {\letdummyparameter\c!title    \empty
    \letdummyparameter\c!reference\empty
    \letdummyparameter\c!suffix   \empty
    \getdummyparameters[#1]%
    \edef\currentplaceformulatitle    {\dummyparameter\c!title}%
    \edef\currentplaceformulareference{\dummyparameter\c!reference}%
    \edef\currentplaceformulasuffix   {\dummyparameter\c!suffix}%
    \ifx\currentplaceformulatitle\empty\else
      \normalexpanded{\setformulalistentry{\currentplaceformulatitle}}%
    \fi
    \doifelsenextbgroup\strc_formulas_place_yes\strc_formulas_place_nop} 
% [ref]{}

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160225/3264c086/attachment.html>

From schuster.wolfgang at gmail.com  Thu Mar  3 18:12:31 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 03 Mar 2016 18:12:31 +0100
Subject: [dev-context] font-syn.lua
Message-ID: <56D8707F.1070308@gmail.com>

Hi,

local function check_name(data,result,filename,modification,suffix,subfont)
     -- shortcuts
     local specifications = data.specifications
     -- fetch
     [...]
     fontname   = fontname   or fullname or familyname or filebase -- 
maybe cleanfilename
     fullname   = fullname   or fontname
     familyname = familyname or fontname
     -- we do these sparse -- todo: check table type or change names in 
ff loader
     local units      = result.units       or 1000 -- can be zero too
     local designsize = result.designsize  or 0
-   local minsize    = result.mindesign   or 0
-   local maxsize    = result.maxdesign   or 0
+   local minsize    = result.minsize     or 0
+   local maxsize    = result.maxsize     or 0
     local angle      = result.italicangle or 0
     local pfmwidth   = result.pfmwidth    or 0
     local pfmweight  = result.pfmweight   or 0
     --
     [...]
     }
end

Wolfgang

From wolfgang.schuster at gmail.com  Fri Mar 11 14:51:12 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Fri, 11 Mar 2016 14:51:12 +0100
Subject: [dev-context] x-set-11.mkiv: \to
Message-ID: <56E2CD50.1020406@gmail.com>

Hi Hans,

delimiters like the \to in \setwidthof command get numbered and appear 
in the argument list which shouldnât happen (see attached example).

As there are more of these command (e.g. \from or \with) something like 
<cd:macro value="to"/> instead of <cd:to/> would be better.

Wolfgang
-------------- next part --------------
A non-text attachment was scrubbed...
Name: i-string.xml
Type: text/xml
Size: 308 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160311/8b62c9de/attachment.xml>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: setwidthof.tex
Type: application/x-tex
Size: 97 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160311/8b62c9de/attachment.tex>

From schuster.wolfgang at gmail.com  Sun Mar 13 18:54:49 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 13 Mar 2016 18:54:49 +0100
Subject: [dev-context] New columnsets mechanism
Message-ID: <56E5A969.5080203@gmail.com>

Hi Hans,

what are the official names of the new colmunsets implementation, 
\startpagegrid etc. or \startcolumnset etc.?

Wolfgang

From pragma at wxs.nl  Sun Mar 13 19:44:11 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 13 Mar 2016 19:44:11 +0100
Subject: [dev-context] New columnsets mechanism
In-Reply-To: <56E5A969.5080203@gmail.com>
References: <56E5A969.5080203@gmail.com>
Message-ID: <56E5B4FB.8050600@wxs.nl>

On 3/13/2016 6:54 PM, Wolfgang Schuster wrote:
> Hi Hans,
>
> what are the official names of the new colmunsets implementation,
> \startpagegrid etc. or \startcolumnset etc.?

at some point we can decide to make old columnsets a module so it's 
pagegrid (with columnset synonyms that might be overloaded)

(for now)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Mon Mar 14 09:59:52 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 14 Mar 2016 09:59:52 +0100
Subject: [dev-context] x-set-11.mkiv: <cd:apply/>
Message-ID: <56E67D88.8090801@gmail.com>

Hi Hans,

the "=>" in the apply tag has to be lowered to avoid a collision with 
the index number.

\unexpanded\def\showSETUPapply#1%
     {\showSETUP{#1}
-       {[..=>..]}
-       {[..,..=>..,...]}}
+       {[..\lower.25ex\hbox{=>}..]}
+       {[..,..\lower.25ex\hbox{=>}..,...]}}

Wolfgang

From schuster.wolfgang at gmail.com  Mon Mar 14 23:38:00 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 14 Mar 2016 23:38:00 +0100
Subject: [dev-context] syst-aux.mkiv: \checkedstrippedcsname
Message-ID: <56E73D48.40501@gmail.com>

Hi,

should the \checkedstrippedcsname accept arguments in braces like shown 
in the source example (line 3473 in syst-aux.mkiv) or was this dropped.

%% begin example
\starttext

\checkedstrippedcsname\foo

\checkedstrippedcsname{\foo}

\checkedstrippedcsname ABC

\checkedstrippedcsname{ABC}

\stoptext
%% end example

Wolfgang

From pragma at wxs.nl  Tue Mar 15 10:10:09 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 15 Mar 2016 10:10:09 +0100
Subject: [dev-context] syst-aux.mkiv: \checkedstrippedcsname
In-Reply-To: <56E73D48.40501@gmail.com>
References: <56E73D48.40501@gmail.com>
Message-ID: <56E7D171.7020702@wxs.nl>

On 3/14/2016 11:38 PM, Wolfgang Schuster wrote:
> Hi,
>
> should the \checkedstrippedcsname accept arguments in braces like shown
> in the source example (line 3473 in syst-aux.mkiv) or was this dropped.
>
> %% begin example
> \starttext
>
> \checkedstrippedcsname\foo
>
> \checkedstrippedcsname{\foo}
>
> \checkedstrippedcsname\foo
>
> \checkedstrippedcsname{ABC}
>
> \stoptext
> %% end example

as it maps onto a (new) primitive it's

\checkedstrippedcsname\foo
\checkedstrippedcsname foo

only

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Tue Mar 15 10:42:20 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Tue, 15 Mar 2016 10:42:20 +0100
Subject: [dev-context] syst-aux.mkiv: \checkedstrippedcsname
In-Reply-To: <56E7D171.7020702@wxs.nl>
References: <56E73D48.40501@gmail.com> <56E7D171.7020702@wxs.nl>
Message-ID: <56E7D8FC.5000609@gmail.com>

> Hans Hagen <mailto:pragma at wxs.nl>
> 15. MÃ¤rz 2016 um 10:10
>
>
> as it maps onto a (new) primitive it's
>
> \checkedstrippedcsname\foo
> \checkedstrippedcsname foo
>
> only
OK (noticed the existence \csstring a while ago).

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160315/1c023de5/attachment.html>

From alan.braslau at cea.fr  Wed Mar 16 20:41:00 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Wed, 16 Mar 2016 13:41:00 -0600
Subject: [dev-context] typo in type-imp-texgyre.mkiv ?
Message-ID: <20160316134100.6dc24110@cea.fr>

In type-imp-texgyre.mkiv,
is bonum,bookman repeated twice an error?

\starttypescript [\s!serif,\s!sans]
[adventor,bonum,bookman,heros,helvetica,pagella,palatino,bonum,bookman,schola,schoolbook,termes,times]

Alan

From pragma at wxs.nl  Thu Mar 17 09:39:22 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 17 Mar 2016 09:39:22 +0100
Subject: [dev-context] typo in type-imp-texgyre.mkiv ?
In-Reply-To: <20160316134100.6dc24110@cea.fr>
References: <20160316134100.6dc24110@cea.fr>
Message-ID: <56EA6D3A.9090805@wxs.nl>

On 3/16/2016 8:41 PM, Alan BRASLAU wrote:
> In type-imp-texgyre.mkiv,
> is bonum,bookman repeated twice an error?
>
> \starttypescript [\s!serif,\s!sans]
> [adventor,bonum,bookman,heros,helvetica,pagella,palatino,bonum,bookman,schola,schoolbook,termes,times]

i'll fix it

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at cea.fr  Thu Mar 17 19:07:49 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Thu, 17 Mar 2016 12:07:49 -0600
Subject: [dev-context] \showsetups
Message-ID: <20160317120749.3fb56499@cea.fr>

\showsetups displays "0ptpt". Oops!

Alan

From schuster.wolfgang at gmail.com  Thu Mar 17 23:13:09 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 17 Mar 2016 23:13:09 +0100
Subject: [dev-context] \showsetups
In-Reply-To: <20160317120749.3fb56499@cea.fr>
References: <20160317120749.3fb56499@cea.fr>
Message-ID: <56EB2BF5.9030300@gmail.com>

> Alan BRASLAU <mailto:alan.braslau at cea.fr>
> 17. MÃ¤rz 2016 um 19:07
> \showsetups displays "0ptpt". Oops!
Do you have a minimal example because I canât reproduce it.

\starttext
\showsetups
\stoptext

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160317/c862ef3a/attachment.html>

From alan.braslau at cea.fr  Thu Mar 17 23:37:38 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Thu, 17 Mar 2016 16:37:38 -0600
Subject: [dev-context] \showsetups
In-Reply-To: <56EB2BF5.9030300@gmail.com>
References: <20160317120749.3fb56499@cea.fr>
	<56EB2BF5.9030300@gmail.com>
Message-ID: <20160317163738.4355f065@cea.fr>

See attached, using a just updated version from the garden.

Alan

On Thu, 17 Mar 2016 23:13:09 +0100
Wolfgang Schuster <schuster.wolfgang at gmail.com> wrote:

> > Alan BRASLAU <mailto:alan.braslau at cea.fr>
> > 17. MÃ¤rz 2016 um 19:07
> > \showsetups displays "0ptpt". Oops!
> Do you have a minimal example because I canât reproduce it.
> 
> \starttext
> \showsetups
> \stoptext
> 
> Wolfgang



-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr
-------------- next part --------------
A non-text attachment was scrubbed...
Name: foo.pdf
Type: application/pdf
Size: 9940 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160317/bcc10fb2/attachment.pdf>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: foo.tex
Type: text/x-tex
Size: 33 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160317/bcc10fb2/attachment.tex>

From alan.braslau at cea.fr  Fri Mar 18 21:20:32 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Fri, 18 Mar 2016 14:20:32 -0600
Subject: [dev-context] font-pre.mkiv
Message-ID: <20160318142032.1a682cac@cea.fr>

In font-pre.mkiv

\definealternativestyle [\v!monobold] [\tt\bf] []

appears twice.


Also, should there be a

\definealternativestyle [\v!smallitalic] [\setsmallbodyfont\it] []




Alan

-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From alan.braslau at cea.fr  Fri Mar 18 22:22:25 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Fri, 18 Mar 2016 15:22:25 -0600
Subject: [dev-context] font-pre.mkiv
In-Reply-To: <20160318142032.1a682cac@cea.fr>
References: <20160318142032.1a682cac@cea.fr>
Message-ID: <20160318152225.75b1c194@cea.fr>

On Fri, 18 Mar 2016 14:20:32 -0600
Alan BRASLAU <alan.braslau at cea.fr> wrote:

> In font-pre.mkiv
> 
> \definealternativestyle [\v!monobold] [\tt\bf] []
> 
> appears twice.
> 
> 
> Also, should there be a
> 
> \definealternativestyle [\v!smallitalic] [\setsmallbodyfont\it] []


How about, as well (just for completeness):

\definealternativestyle [\v!camel]   [{\setcharactercasing[\v!camel]}] [{\setcharactercasing[\v!camel  ]}]


Alan

-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From schuster.wolfgang at gmail.com  Sat Mar 19 08:33:49 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 19 Mar 2016 08:33:49 +0100
Subject: [dev-context] publ-ini.mkiv: \citation
Message-ID: <56ED00DD.8090001@gmail.com>

Hi,

the bibliography module redefines the \citation two lines after the 
first definition and drops the \citation{...} method, is this intended?


Line 1386:

\unexpanded\def\citation  {\doifelsenextoptionalcs\btxlistcitation  
\btxdirectlistcite}
\unexpanded\def\nocitation{\doifelsenextoptionalcs\btxhiddencitation\btxdirecthiddencite}

\let\citation  \listcitation \let\cite  \citation
\let\nocitation\nocitation   \let\nocite\nocitation


Wolfgang

From pragma at wxs.nl  Sat Mar 19 11:31:12 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 19 Mar 2016 11:31:12 +0100
Subject: [dev-context] font-pre.mkiv
In-Reply-To: <20160318142032.1a682cac@cea.fr>
References: <20160318142032.1a682cac@cea.fr>
Message-ID: <56ED2A70.20309@wxs.nl>

On 3/18/2016 9:20 PM, Alan BRASLAU wrote:
> In font-pre.mkiv
>
> \definealternativestyle [\v!monobold] [\tt\bf] []
>
> appears twice.
>
>
> Also, should there be a
>
> \definealternativestyle [\v!smallitalic] [\setsmallbodyfont\it] []

ok

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at cea.fr  Sat Mar 19 11:43:37 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Sat, 19 Mar 2016 04:43:37 -0600
Subject: [dev-context] publ-ini.mkiv: \citation
In-Reply-To: <56ED00DD.8090001@gmail.com>
References: <56ED00DD.8090001@gmail.com>
Message-ID: <20160319044337.36cdbd33@cea.fr>

\citation and \cite are synonyms
\nocitation and \nocite are synonyms

\cite and \nocite are traditional bibTeX usage (in LaTeX).

\nocitation (\nocite) is a hidden citation, i.e. it pulls an entry
from the dataset, including it in the bibliography list, but does not
render a reference in the text.

This is useful, for example, to force a reference tag at the place
where a table or figure is called, but to postpone the rendering of
the reference to the bibliography to figure later in the floated table
or figure.

\nocite does the same thing as \cite[none] [key]

Alan



On Sat, 19 Mar 2016 08:33:49 +0100
Wolfgang Schuster <schuster.wolfgang at gmail.com> wrote:

> Hi,
> 
> the bibliography module redefines the \citation two lines after the 
> first definition and drops the \citation{...} method, is this
> intended?
> 
> 
> Line 1386:
> 
> \unexpanded\def\citation  {\doifelsenextoptionalcs\btxlistcitation  
> \btxdirectlistcite}
> \unexpanded\def\nocitation{\doifelsenextoptionalcs\btxhiddencitation\btxdirecthiddencite}
> 
> \let\citation  \listcitation \let\cite  \citation
> \let\nocitation\nocitation   \let\nocite\nocitation
> 
> 
> Wolfgang
> _______________________________________________
> dev-context mailing list
> dev-context at ntg.nl
> https://mailman.ntg.nl/mailman/listinfo/dev-context



-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From pragma at wxs.nl  Sat Mar 19 11:48:50 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 19 Mar 2016 11:48:50 +0100
Subject: [dev-context] publ-ini.mkiv: \citation
In-Reply-To: <20160319044337.36cdbd33@cea.fr>
References: <56ED00DD.8090001@gmail.com> <20160319044337.36cdbd33@cea.fr>
Message-ID: <56ED2E92.5020806@wxs.nl>

On 3/19/2016 11:43 AM, Alan BRASLAU wrote:
> \citation and \cite are synonyms
> \nocitation and \nocite are synonyms
>
> \cite and \nocite are traditional bibTeX usage (in LaTeX).
>
> \nocitation (\nocite) is a hidden citation, i.e. it pulls an entry
> from the dataset, including it in the bibliography list, but does not
> render a reference in the text.
>
> This is useful, for example, to force a reference tag at the place
> where a table or figure is called, but to postpone the rendering of
> the reference to the bibliography to figure later in the floated table
> or figure.
>
> \nocite does the same thing as \cite[none] [key]

so we have

\let\cite  \citation
\let\nocite\nocitation

(i think Wolfgang was referring to the fact that we aliased to 
\listcitation, one of the 4 variants needed to satisfy mojca's hunger 
for all kind of citations)

> On Sat, 19 Mar 2016 08:33:49 +0100
> Wolfgang Schuster <schuster.wolfgang at gmail.com> wrote:
>
>> Hi,
>>
>> the bibliography module redefines the \citation two lines after the
>> first definition and drops the \citation{...} method, is this
>> intended?
>>
>>
>> Line 1386:
>>
>> \unexpanded\def\citation  {\doifelsenextoptionalcs\btxlistcitation
>> \btxdirectlistcite}
>> \unexpanded\def\nocitation{\doifelsenextoptionalcs\btxhiddencitation\btxdirecthiddencite}
>>
>> \let\citation  \listcitation \let\cite  \citation
>> \let\nocitation\nocitation   \let\nocite\nocitation
>>
>>
>> Wolfgang
>> _______________________________________________
>> dev-context mailing list
>> dev-context at ntg.nl
>> https://mailman.ntg.nl/mailman/listinfo/dev-context
>
>
>


-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Sat Mar 19 11:50:04 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 19 Mar 2016 11:50:04 +0100
Subject: [dev-context] publ-ini.mkiv: \citation
In-Reply-To: <20160319044337.36cdbd33@cea.fr>
References: <56ED00DD.8090001@gmail.com> <20160319044337.36cdbd33@cea.fr>
Message-ID: <56ED2EDC.9000301@gmail.com>

> Alan BRASLAU <mailto:alan.braslau at cea.fr>
> 19. MÃ¤rz 2016 um 11:43
> \citation and \cite are synonyms
> \nocitation and \nocite are synonyms
>
> \cite and \nocite are traditional bibTeX usage (in LaTeX).
>
> \nocitation (\nocite) is a hidden citation, i.e. it pulls an entry
> from the dataset, including it in the bibliography list, but does not
> render a reference in the text.
>
> This is useful, for example, to force a reference tag at the place
> where a table or figure is called, but to postpone the rendering of
> the reference to the bibliography to figure later in the floated table
> or figure.
>
> \nocite does the same thing as \cite[none] [key]
This doesn't answer my question.


On line 1386 we have:

     \unexpanded\def\citation  {\doifelsenextoptionalcs\btxlistcitation  
\btxdirectlistcite}

which allows \citation{<REFERENCE>} but

     \let\citation  \listcitation

on line 1389 makes the \citation command a synonym for \listcitation 
which means
\citation{<REFERENCE>} isn't possible anymore.

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160319/a2ec7ce0/attachment.html>

From alan.braslau at cea.fr  Sat Mar 19 12:01:41 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Sat, 19 Mar 2016 05:01:41 -0600
Subject: [dev-context] publ-ini.mkiv: \citation
In-Reply-To: <56ED2E92.5020806@wxs.nl>
References: <56ED00DD.8090001@gmail.com> <20160319044337.36cdbd33@cea.fr>
 <56ED2E92.5020806@wxs.nl>
Message-ID: <20160319050141.3cf7b085@cea.fr>

What is this on line 1390?

\let\nocitation\nocitation


In fact, I never paid any attention to the \listcitation and
\textcitation variants.

Alan


On Sat, 19 Mar 2016 11:50:04 +0100
Wolfgang Schuster <schuster.wolfgang at gmail.com> wrote:

> This doesn't answer my question.
> 
> 
> On line 1386 we have:
> 
>      \unexpanded\def\citation
> {\doifelsenextoptionalcs\btxlistcitation \btxdirectlistcite}
> 
> which allows \citation{<REFERENCE>} but
> 
>      \let\citation  \listcitation
> 
> on line 1389 makes the \citation command a synonym for \listcitation 
> which means
> \citation{<REFERENCE>} isn't possible anymore.
> 
> Wolfgang


On Sat, 19 Mar 2016 11:48:50 +0100
Hans Hagen <pragma at wxs.nl> wrote:

> On 3/19/2016 11:43 AM, Alan BRASLAU wrote:
> > \citation and \cite are synonyms
> > \nocitation and \nocite are synonyms
> >
> > \cite and \nocite are traditional bibTeX usage (in LaTeX).
> >
> > \nocitation (\nocite) is a hidden citation, i.e. it pulls an entry
> > from the dataset, including it in the bibliography list, but does
> > not render a reference in the text.
> >
> > This is useful, for example, to force a reference tag at the place
> > where a table or figure is called, but to postpone the rendering of
> > the reference to the bibliography to figure later in the floated
> > table or figure.
> >
> > \nocite does the same thing as \cite[none] [key]  
> 
> so we have
> 
> \let\cite  \citation
> \let\nocite\nocitation
> 
> (i think Wolfgang was referring to the fact that we aliased to 
> \listcitation, one of the 4 variants needed to satisfy mojca's hunger 
> for all kind of citations)
> 
> > On Sat, 19 Mar 2016 08:33:49 +0100
> > Wolfgang Schuster <schuster.wolfgang at gmail.com> wrote:
> >  
> >> Hi,
> >>
> >> the bibliography module redefines the \citation two lines after the
> >> first definition and drops the \citation{...} method, is this
> >> intended?
> >>
> >>
> >> Line 1386:
> >>
> >> \unexpanded\def\citation  {\doifelsenextoptionalcs\btxlistcitation
> >> \btxdirectlistcite}
> >> \unexpanded\def\nocitation{\doifelsenextoptionalcs\btxhiddencitation\btxdirecthiddencite}
> >>
> >> \let\citation  \listcitation \let\cite  \citation
> >> \let\nocitation\nocitation   \let\nocite\nocitation
> >>
> >>
> >> Wolfgang
> >> _______________________________________________
> >> dev-context mailing list
> >> dev-context at ntg.nl
> >> https://mailman.ntg.nl/mailman/listinfo/dev-context  
> >
> >
> >  
> 
> 



-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From pragma at wxs.nl  Sat Mar 19 12:05:35 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 19 Mar 2016 12:05:35 +0100
Subject: [dev-context] publ-ini.mkiv: \citation
In-Reply-To: <20160319050141.3cf7b085@cea.fr>
References: <56ED00DD.8090001@gmail.com> <20160319044337.36cdbd33@cea.fr>
 <56ED2E92.5020806@wxs.nl> <20160319050141.3cf7b085@cea.fr>
Message-ID: <56ED327F.3080103@wxs.nl>

On 3/19/2016 12:01 PM, Alan BRASLAU wrote:
> What is this on line 1390?
>
> \let\nocitation\nocitation

a leftover from out endless struggle ... i now have just

\let\cite  \citation
\let\nocite\nocitation

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From alan.braslau at cea.fr  Sun Mar 20 18:40:17 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Sun, 20 Mar 2016 11:40:17 -0600
Subject: [dev-context] colo-imp-rgb.mkiv
Message-ID: <20160320114017.66e69e89@cea.fr>

Could we add lightcyan=cyan, lightmagenta=magenta, lightyellow=yellow
to colo-imp-rgb.mkiv, as attached, just for completeness? After all,
lightred=red, lightgreen=green, lightblue=blue. I know that they will
be redundant.

Alan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: colo-imp-rgb.mkiv
Type: application/octet-stream
Size: 8592 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160320/fe1b5df1/attachment.obj>

From alan.braslau at cea.fr  Sun Mar 20 18:42:43 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Sun, 20 Mar 2016 11:42:43 -0600
Subject: [dev-context] colo-imp-rgb.mkiv
In-Reply-To: <20160320114017.66e69e89@cea.fr>
References: <20160320114017.66e69e89@cea.fr>
Message-ID: <20160320114243.53eb90ad@cea.fr>

On Sun, 20 Mar 2016 11:40:17 -0600
Alan BRASLAU <alan.braslau at cea.fr> wrote:

> Could we add lightcyan=cyan, lightmagenta=magenta, lightyellow=yellow
> to colo-imp-rgb.mkiv, as attached, just for completeness? After all,
> lightred=red, lightgreen=green, lightblue=blue. I know that they will
> be redundant.

Also,

\definecolor [lightorange]  [r=1, g=.5]

From alan.braslau at cea.fr  Sun Mar 20 21:43:07 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Sun, 20 Mar 2016 14:43:07 -0600
Subject: [dev-context] [PROVENANCE  INTERNET] Re:  colo-imp-rgb.mkiv
In-Reply-To: <2793_1458495786_56EEE12A_2793_7340_1_20160320114243.53eb90ad@cea.fr>
References: <20160320114017.66e69e89@cea.fr>
 <2793_1458495786_56EEE12A_2793_7340_1_20160320114243.53eb90ad@cea.fr>
Message-ID: <20160320144307.4ef2adae@iram-hb-003386.extra.cea.fr>

See attached.
I also fixed the languages as well as added french.

Alan


On Sun, 20 Mar 2016 11:42:43 -0600
Alan BRASLAU <alan.braslau at cea.fr> wrote:

> On Sun, 20 Mar 2016 11:40:17 -0600
> Alan BRASLAU <alan.braslau at cea.fr> wrote:
> 
> > Could we add lightcyan=cyan, lightmagenta=magenta,
> > lightyellow=yellow to colo-imp-rgb.mkiv, as attached, just for
> > completeness? After all, lightred=red, lightgreen=green,
> > lightblue=blue. I know that they will be redundant.
> 
> Also,
> 
> \definecolor [lightorange]  [r=1, g=.5]

-------------- next part --------------
A non-text attachment was scrubbed...
Name: colo-imp-rgb.mkiv
Type: application/octet-stream
Size: 10636 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160320/da5c22f7/attachment-0001.obj>

From schuster.wolfgang at gmail.com  Mon Mar 21 08:26:30 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 21 Mar 2016 08:26:30 +0100
Subject: [dev-context] font-pre.mkiv: \definefontstyle
Message-ID: <56EFA226.6080900@gmail.com>

Hi,

can we add the following two synonyms for the math style (requied for 
the \definefontfamily command):

\definefontstyle [\v!math,\v!mathematics]          [\s!mm]

Wolfgang

From pragma at wxs.nl  Fri Mar 25 10:02:35 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 25 Mar 2016 10:02:35 +0100
Subject: [dev-context] core-con.mkiv: \doifelseconversionnumber
In-Reply-To: <55DD8B43.2070905@gmail.com>
References: <55DD8B43.2070905@gmail.com>
Message-ID: <56F4FEAB.4020107@wxs.nl>

On 8/26/2015 11:47 AM, Wolfgang Schuster wrote:
> Hi,
>
> the command \doifelseconversionnumber doesnât work with MkIV.
>
>
> %%%% begin example
> \starttext
>
> \defineconversion[ctx][c,o,n,t,e,x,t]
>
> ctx:
> \doloop{\doifelseconversionnumber{ctx}{\recurselevel}{[\recurselevel]}{\exitloop}}
>
>
> \stoptext
> %%%% end example

finaly fixed in next beta (somehow missed it)

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Fri Mar 25 11:02:07 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Fri, 25 Mar 2016 11:02:07 +0100
Subject: [dev-context] node-nut.lua
Message-ID: <56F50C9F.3010302@gmail.com>

Hi,

the beta reports a nil value for "getsubtype", fix below.

if not direct.is_glyph then
     local getchar    = direct.getchar
     local getid      = direct.getid
     local getfont    = direct.getfont
+   local getsubtype = direct.getsubtype
     local glyph_code = nodes.nodecodes.glyph
     function direct.is_glyph(n,f)
         local id   = getid(n)
         if id == glyph_code then
             if f and getfont(n) == f then
                 return getchar(n)
             else
                 return false
             end
         else
             return nil, id
         end
     end
     function direct.is_char(n,f)
         local id = getid(n)
         if id == glyph_code then
             if getsubtype(n) >= 256 then
                 return false
             elseif f and getfont(n) == f then
                 return getchar(n)
             else
                 return false
             end
         else
             return nil, id
         end
     end
end

Wolfgang

From luigi.scarso at gmail.com  Tue Mar 29 15:35:25 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Tue, 29 Mar 2016 15:35:25 +0200
Subject: [dev-context] Luatex 0.90.0 announcement
Message-ID: <CAG5iGsCCh+G0x1Hh0UnZdN7f1rPj7R3jfJ-qBwoRys0B2YE+Eg@mail.gmail.com>

==============================================================
LuaTeX Release 0.90.0 was released 2016032512
==============================================================

This is the version that will go on TeX Live 2016

- mostly small bug fixes
- a few setters/getters added to the pdf namespace (were in the tex one
before)
- a few patches to the lua interface macros
- a bit more control over protrusion edges
- no fundamental changes


As usual,
the archives can be downloaded from supelec:

        https://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:
 svn co --username anonsvn --password anonsvn
https://foundry.supelec.fr/svn/luatex/tags/beta-0.90.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org



Have fun,
Hans, Luigi, Taco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160329/ea556e21/attachment.html>

From wolfgang.schuster at gmail.com  Wed Mar 30 14:42:17 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Wed, 30 Mar 2016 14:42:17 +0200
Subject: [dev-context] font-pre.mkiv
Message-ID: <56FBC9A9.9010205@gmail.com>

Hi Hans,

the lnum tag is wrong in both features because the opposite of tnum is pnum.

\definefontfeature
   [inlinenumbers]
- [lnum=yes,
+ [pnum=yes,
    tnum=no]

\definefontfeature
   [tabularnumbers]
   [tnum=yes,
-  lnum=no]
+  pnum=no]

Wolfgang

From schuster.wolfgang at gmail.com  Sun Apr  3 18:20:45 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 03 Apr 2016 18:20:45 +0200
Subject: [dev-context] scrn-pag.mkvi
Message-ID: <570142DD.3040009@gmail.com>

Hi,

\appendtoks
-   \global\let\scrn_canvas_synchronize_simple 
\scrn_canvas_synchronize_simple
-   
\global\let\scrn_canvas_synchronize_complex\scrn_canvas_synchronize_complex
+   \global\let\scrn_canvas_synchronize_simple 
\scrn_canvas_synchronize_simple_indeed
+   
\global\let\scrn_canvas_synchronize_complex\scrn_canvas_synchronize_complex_indeed
\to \everysetupinteractionscreen

Wolfgang

From luigi.scarso at gmail.com  Thu Apr  7 11:34:27 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 7 Apr 2016 11:34:27 +0200
Subject: [dev-context] On LuaTeX beta-0.95.0
Message-ID: <CAG5iGsAar+zrY4LL6-xdyXoPQ3-_ihq7AK-Ze5wOdHL+ucJZdg@mail.gmail.com>

Hi all,
we have put beta-0.95.0 on the luatex svn  already from while,
but the tag is not frozen because:
1) Hans is working on the manual,
2) I keep  source/ in sync with TeXLive (kpathsea files etc ),
3) we fix bugs, of course --- the building process not always goes well on
every the platforms that we support.

The initial plan was to put 0.90.0 for TeXLive, but now we are pretty
confident that 0.95.0 is ok,  and we have no plan to touch the codebase in
source/ (bug fixing apart).
(@Karl: I can keep   Master/texmf-dist/doc/luatex/base in sync, if it's ok
for you)

For those that build from source:
A. Kakuto keeps the TeXLive repo aligned with the luatex repo, assuring
that the windows binaries are ok.
It's clear that, having two repos with the same program,  is a bit hard  to
decide which program is the latest one, so when I import from TeXLive in
the commit message I specify the
revision (e.g.  "sync with TL rev. 40299." );
in the luatex repo, trunk and tags/beta-0.95.0 are always aligned, always
first trunk and immediately after beta-0.95.0.
I found more simple to  have both the repos (texlive and luatex) on my
machine, but it's my choice.


Unfortunately currently the  contextgarden server has some problems,
and  perhaps not all context users have the latest luatex --- not a big
problen,
we are working on this.

The formal announcement of Luatex 0.95.0 very likely will be when the
TeXLive is frozen.
around 4may.


-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160407/012cc6a2/attachment.html>

From schuster.wolfgang at gmail.com  Sun Apr 10 18:43:25 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 10 Apr 2016 18:43:25 +0200
Subject: [dev-context] No format file with last beta
Message-ID: <570A82AD.6030205@gmail.com>

Hi Hans,

Iâm unable to generate a format file for MkIV with the last beta, the 
last line in the log is:

open source > 1 > 34 > 
/Users/wolf/context/beta/tex/texmf-context/tex/context/base/mkiv/node-ini.mkiv
loading : ConTeXt Node Support / Initialization


Could this be related to the LuaTeX version for the Mac:

This is LuaTeX, Version beta-0.90.0 (TeX Live 2016)

Wolfgang

From pragma at wxs.nl  Sun Apr 10 18:47:53 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 10 Apr 2016 18:47:53 +0200
Subject: [dev-context] No format file with last beta
In-Reply-To: <570A82AD.6030205@gmail.com>
References: <570A82AD.6030205@gmail.com>
Message-ID: <570A83B9.3050706@wxs.nl>

On 4/10/2016 6:43 PM, Wolfgang Schuster wrote:
> Hi Hans,
>
> Iâm unable to generate a format file for MkIV with the last beta, the
> last line in the log is:
>
> open source > 1 > 34 >
> /Users/wolf/context/beta/tex/texmf-context/tex/context/base/mkiv/node-ini.mkiv
>
> loading : ConTeXt Node Support / Initialization
>
>
> Could this be related to the LuaTeX version for the Mac:
>
> This is LuaTeX, Version beta-0.90.0 (TeX Live 2016)

yes, we're at 0.95 now but i'm somewhat puzzled .. can you try the 
version i just uploaded to the ftp

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Sun Apr 10 19:32:05 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 10 Apr 2016 19:32:05 +0200
Subject: [dev-context] No format file with last beta
In-Reply-To: <570A8A7E.8020205@wxs.nl>
References: <570A82AD.6030205@gmail.com> <570A83B9.3050706@wxs.nl>
 <570A892B.8020400@gmail.com> <570A8A7E.8020205@wxs.nl>
Message-ID: <570A8E15.8020503@gmail.com>

> Hans Hagen <mailto:pragma at wxs.nl>
> 10. April 2016 um 19:16
> i wonder at what point it crashes (where in what file)
It stops at the following line in node-ini.lua

local boundarycodes = mark(getsubtypes("boundary"))

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160410/dd815ad3/attachment.html>

From pragma at wxs.nl  Sun Apr 10 23:25:41 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 10 Apr 2016 23:25:41 +0200
Subject: [dev-context] No format file with last beta
In-Reply-To: <570A8E15.8020503@gmail.com>
References: <570A82AD.6030205@gmail.com> <570A83B9.3050706@wxs.nl>
 <570A892B.8020400@gmail.com> <570A8A7E.8020205@wxs.nl>
 <570A8E15.8020503@gmail.com>
Message-ID: <570AC4D5.8020202@wxs.nl>

On 4/10/2016 7:32 PM, Wolfgang Schuster wrote:
>> Hans Hagen <mailto:pragma at wxs.nl>
>> 10. April 2016 um 19:16
>> i wonder at what point it crashes (where in what file)
> It stops at the following line in node-ini.lua
>
> local boundarycodes = mark(getsubtypes("boundary"))

ok, till we have 0.95 latest we can do

-- for now:

local boundarycodes = allocate {
     [0] = "cancel",
     [1] = "user",
     [2] = "protrusion",
     [3] = "word",
}

-- local boundarycodes = mark(getsubtypes("boundary"))



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Mon Apr 11 00:18:10 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 11 Apr 2016 00:18:10 +0200
Subject: [dev-context] No format file with last beta
In-Reply-To: <570A8E15.8020503@gmail.com>
References: <570A82AD.6030205@gmail.com> <570A83B9.3050706@wxs.nl>
 <570A892B.8020400@gmail.com> <570A8A7E.8020205@wxs.nl>
 <570A8E15.8020503@gmail.com>
Message-ID: <570AD122.8060902@wxs.nl>

On 4/10/2016 7:32 PM, Wolfgang Schuster wrote:
>> Hans Hagen <mailto:pragma at wxs.nl>
>> 10. April 2016 um 19:16
>> i wonder at what point it crashes (where in what file)
> It stops at the following line in node-ini.lua
>
> local boundarycodes = mark(getsubtypes("boundary"))

new zip ... i'll only upload to the web server when ok

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Mon Apr 11 04:36:46 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 11 Apr 2016 04:36:46 +0200
Subject: [dev-context] No format file with last beta
In-Reply-To: <570AD122.8060902@wxs.nl>
References: <570A82AD.6030205@gmail.com> <570A83B9.3050706@wxs.nl>
 <570A892B.8020400@gmail.com> <570A8A7E.8020205@wxs.nl>
 <570A8E15.8020503@gmail.com> <570AD122.8060902@wxs.nl>
Message-ID: <570B0DBE.8080407@gmail.com>

> Hans Hagen <mailto:pragma at wxs.nl>
> 11. April 2016 um 00:18
>
> new zip ... i'll only upload to the web server when ok
The format is generated and I get a PDF, Luajittex does also work.

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160411/3146d894/attachment.html>

From alan.braslau at cea.fr  Mon Apr 11 05:16:09 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Sun, 10 Apr 2016 21:16:09 -0600
Subject: [dev-context] No format file with last beta
In-Reply-To: <570AD122.8060902@wxs.nl>
References: <570A82AD.6030205@gmail.com> <570A83B9.3050706@wxs.nl>
 <570A892B.8020400@gmail.com> <570A8A7E.8020205@wxs.nl>
 <570A8E15.8020503@gmail.com> <570AD122.8060902@wxs.nl>
Message-ID: <20160410211609.1905ec6e@cea.fr>

Hi

The latest beta on ftp.pragma-ade.com works on freebsd using a luatex
compiled from svn.

Alan

From schuster.wolfgang at gmail.com  Mon Apr 18 13:37:41 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 18 Apr 2016 13:37:41 +0200
Subject: [dev-context] font-ini.mkvi
Message-ID: <5714C705.5070609@gmail.com>

Hi,

use of "b" instead of "#".

\unexpanded\def\font_basics_define_body_font_c[#whatever][#dummya][#dummyb]% 
body|identifier
- {\font_basics_define_body_font_a[bwhatever][\s!rm][]}
+ {\font_basics_define_body_font_a[#whatever][\s!rm][]}

Wolfgang

From schuster.wolfgang at gmail.com  Tue Apr 19 13:52:30 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Tue, 19 Apr 2016 13:52:30 +0200
Subject: [dev-context] page-mak.mkvi
Message-ID: <57161BFE.3020000@gmail.com>

Hi,

is the empty second argument on purpose?

\definemakeup
   [\v!page]
   []

Wolfgang

From pragma at wxs.nl  Tue Apr 19 16:20:27 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 19 Apr 2016 16:20:27 +0200
Subject: [dev-context] page-mak.mkvi
In-Reply-To: <57161BFE.3020000@gmail.com>
References: <57161BFE.3020000@gmail.com>
Message-ID: <57163EAB.5010103@wxs.nl>

On 4/19/2016 1:52 PM, Wolfgang Schuster wrote:
> Hi,
>
> is the empty second argument on purpose?
>
> \definemakeup
>    [\v!page]
>    []

it probably was at some point

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
       tel: 038 477 53 69 | www.pragma-ade.com | www.pragma-pod.nl
-----------------------------------------------------------------

From brian at landy.cx  Wed May  4 22:37:50 2016
From: brian at landy.cx (Brian R. Landy)
Date: Wed, 04 May 2016 16:37:50 -0400 (EDT)
Subject: [dev-context] typo-tal.lua line 281 (alignment character isssue)
Message-ID: <alpine.BSO.2.20.1605041342450.5406@firefly.landy.cx>

Hi, I was hoping you would accept this patch to typo-tal.lua:

   index a67cd0a..100d95d 100644
   --- a/tex/texmf-context/tex/context/base/mkiv/typo-tal.lua
   +++ b/tex/texmf-context/tex/context/base/mkiv/typo-tal.lua
   @@ -278,7 +278,7 @@ function
   characteralign.handler(originalhead,where)
                if char then
                    local font = getfont(current)
                 -- local unicode = unicodes[font][char]
   -                local unicode = fontcharacters[font][char].unicode or char -- ignore tables
   +                local unicode = (fontcharacters[font][char] and fontcharacters[font][char].unicode or char) -- ignore tables
                    if not unicode then
                        -- no unicode so forget about it
                    elseif unicode == separator then
   --

This permits using certain special characters like the Unicode word 
joiner as the alignment character in a natural table.  Without the patch 
ConTeXt aborts with an error:

   ... typo-tal.lua:281: attempt to index field '?' (a nil value)

Thank you!

Best regards,
Brian

Here is a simple example that aborts without the patch:

\edef\mywordjoiner{\normalUchar"2060}
\starttext
\bTABLE
\setupTABLE[c][1][aligncharacter=yes,alignmentcharacter={\mywordjoiner},align=middle]
\bTABLEbody
\bTR
\bTD 1\mywordjoiner.234 \eTD
\bTD 1\mywordjoiner.234 \eTD
\eTR
\bTR
\bTD 123\mywordjoiner.4 \eTD
\bTD 123\mywordjoiner.4 \eTD
\eTR
\eTABLEbody
\eTABLE
\stoptext

From schuster.wolfgang at gmail.com  Tue May 10 15:15:48 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Tue, 10 May 2016 15:15:48 +0200
Subject: [dev-context] x-ldx.mkiv
Message-ID: <5731DF04.2060700@gmail.com>

Hi,

typo in line 96:

\startxmlsetups ldx:code
     \startpacked
     \xmlflush{#1}\relax
-   \scitepacked
+   \stoppacked
\stopxmlsetups

Wolfgang

From brian at landy.cx  Mon May 16 21:47:24 2016
From: brian at landy.cx (Brian R. Landy)
Date: Mon, 16 May 2016 15:47:24 -0400 (EDT)
Subject: [dev-context] mtx-context.lua
Message-ID: <alpine.BSO.2.20.1605161531230.923@firefly.landy.cx>


Hi, I noticed today that when running "context --jit" that return codes 
were not being passed back properly to the shell.

For example, with a simple file like this (text.tex):

   \starttext
   test\par
   \mybadmacro\par
   \stoptext

context --jit --nonstopmode test.tex ; echo ", RC=$?"

The log output will print:

   mtx-context     | fatal error: return code: 1, RC=0

But the shell return code is zero.  The below patch fixes it (I'm no Lua 
expert so perhaps there is a better approach):

   --- a/tex/texmf-context/scripts/context/lua/mtx-context.lua
   +++ b/tex/texmf-context/scripts/context/lua/mtx-context.lua
   @@ -108,7 +108,7 @@ local function restart(engine_old,engine_new)
        local command = format("%s --luaonly %q %s
        --redirected",engine_new,environment.ownname,environment.reconstructcommandline())
        report(format("redirect %s -> %s:
        %s",engine_old,engine_new,command))
        local result = os.execute(command)
   -    os.exit(result)
   +    os.exit(result/256)
    end


Best regards,
Brian

From luigi.scarso at gmail.com  Tue May 17 08:38:55 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Tue, 17 May 2016 08:38:55 +0200
Subject: [dev-context] mtx-context.lua
In-Reply-To: <alpine.BSO.2.20.1605161531230.923@firefly.landy.cx>
References: <alpine.BSO.2.20.1605161531230.923@firefly.landy.cx>
Message-ID: <CAG5iGsDXcJrdSi-v-PYn1b5H1=806sTfWgG-E9TQu0MWes3ALQ@mail.gmail.com>

On Mon, May 16, 2016 at 9:47 PM, Brian R. Landy <brian at landy.cx> wrote:

>
> Hi, I noticed today that when running "context --jit" that return codes
> were not being passed back properly to the shell.
>
> For example, with a simple file like this (text.tex):
>
>   \starttext
>   test\par
>   \mybadmacro\par
>   \stoptext
>
> context --jit --nonstopmode test.tex ; echo ", RC=$?"
>
> The log output will print:
>
>   mtx-context     | fatal error: return code: 1, RC=0
>
> But the shell return code is zero.  The below patch fixes it (I'm no Lua
> expert so perhaps there is a better approach):
>
>   --- a/tex/texmf-context/scripts/context/lua/mtx-context.lua
>   +++ b/tex/texmf-context/scripts/context/lua/mtx-context.lua
>   @@ -108,7 +108,7 @@ local function restart(engine_old,engine_new)
>        local command = format("%s --luaonly %q %s
>
>  --redirected",engine_new,environment.ownname,environment.reconstructcommandline())
>        report(format("redirect %s -> %s:
>        %s",engine_old,engine_new,command))
>        local result = os.execute(command)
>   -    os.exit(result)
>   +    os.exit(result/256)
>    end
>
>
> Best regards,
> Brian
> _______________________________________________
> dev-context mailing list
> dev-context at ntg.nl
> https://mailman.ntg.nl/mailman/listinfo/dev-context
>

hm

$ contextjit --nonstopmode test.tex 2>&1 >/dev/null ; echo $?
1
$ context --jit --nonstopmode test.tex 2>&1 >/dev/null ; echo $?
0
$ context  --nonstopmode test.tex 2>&1 >/dev/null ; echo $?
1

Thank you for the report
-- 
luigi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160517/f9f24ccd/attachment.html>

From schuster.wolfgang at gmail.com  Mon May 23 17:50:18 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 23 May 2016 17:50:18 +0200
Subject: [dev-context] i-math.xml
Message-ID: <574326BA.2030300@gmail.com>

Hi Hans,

I got a mail by Hans van der Meer about wrong entry for the 
\setupmathematics command.

<cd:command name="setupmathematics" file="math-ini.mkiv">
<cd:arguments>
<cd:resolve name="keyword-name-list-optional"/>
<cd:assignments list="yes">
<cd:parameter name="openup">
<cd:constant type="yes"/>
<cd:constant type="no" default="yes"/>
</cd:parameter>
                 [...]
<cd:parameter name="textcolor">
<cd:constant type="cd:color"/>
</cd:parameter>
- <cd:parameter name="functionstyle">
- <cd:resolve name="value-style"/>
- </cd:parameter>
+ <cd:parameter name="functioncolor">
+ <cd:constant type="cd:color"/>
+ </cd:parameter>
<cd:parameter name="integral">
<cd:constant type="limits"/>
<cd:constant type="nolimits"/>
<cd:constant type="autolimits" default="yes"/>
<cd:constant type="displaylimits"/>
<cd:constant type="none"/>
</cd:parameter>
<cd:parameter name="default">
<cd:constant type="normal"/>
<cd:constant type="italic" default="yes"/>
</cd:parameter>
</cd:assignments>
</cd:arguments>
</cd:command>

Wolfgang

From schuster.wolfgang at gmail.com  Mon May 23 17:56:39 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 23 May 2016 17:56:39 +0200
Subject: [dev-context] i-fontfamily.xml
Message-ID: <57432837.8010900@gmail.com>

Hi Hans,

1. The default value for the "force" key from \definefallbackfamily is "no".

<cd:command name="definefallbackfamily" file="font-sel.mkvi">
<cd:arguments>
<cd:resolve name="keyword-name"/>
<cd:keywords>
<cd:constant type="rm" default="yes"/>
<cd:constant type="ss"/>
<cd:constant type="tt"/>
<cd:constant type="mm"/>
<cd:constant type="hw"/>
<cd:constant type="cg"/>
<cd:constant type="roman"/>
<cd:constant type="serif"/>
<cd:constant type="regular"/>
<cd:constant type="sansserif"/>
<cd:constant type="sans"/>
<cd:constant type="support"/>
<cd:constant type="teletype"/>
<cd:constant type="type"/>
<cd:constant type="mono"/>
<cd:constant type="handwritten"/>
<cd:constant type="calligraphic"/>
<cd:constant type="math"/>
<cd:constant type="mathematics"/>
</cd:keywords>
<cd:resolve name="keyword-font"/>
<cd:assignments list="yes" optional="yes">
<cd:parameter name="rscale">
<cd:constant type="cd:number"/>
</cd:parameter>
                 [...]
<cd:parameter name="check">
<cd:constant type="yes"/>
<cd:constant type="no" default="yes"/>
</cd:parameter>
<cd:parameter name="force">
- <cd:constant type="yes" default="yes"/>
- <cd:constant type="no"/>
+ <cd:constant type="yes"/>
+ <cd:constant type="no" default="yes"/>
</cd:parameter>
<cd:parameter name="features">
<cd:constant type="cd:name"/>
</cd:parameter>
                 [...]
</cd:assignments>
</cd:arguments>
</cd:command>

2. There is a "s" missing in at the end of the assignments tag.

<cd:command name="definefontfamilypreset" file="font-sel.mkvi">
<cd:arguments>
<cd:resolve name="keyword-name"/>
- <cd:assignment list="yes">
- <cd:inherit name="definefontfamily"/>
- </cd:assignment>
+ <cd:assignments list="yes">
+ <cd:inherit name="definefontfamily"/>
+ </cd:assignments>
</cd:arguments>
</cd:command>

Wolfgang

From schuster.wolfgang at gmail.com  Mon May 30 18:35:03 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 30 May 2016 18:35:03 +0200
Subject: [dev-context] pack-rul.mkiv
Message-ID: <574C6BB7.8070003@gmail.com>

Hi Hans,

\def\pack_framed_start_content[#1]%
   {\bgroup
    \edef\currentframedcontent{#1}%
    \ifx\currentframedcontent\v!off
      \let\stopframedcontent\egroup
    \else
+    \checkframedcontentparent
      \let\stopframedcontent\pack_framed_stop_content_indeed
      \expandafter\pack_framed_start_content_indeed
    \fi}

Wolfgang

From luigi.scarso at gmail.com  Mon Jun  6 15:59:06 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Mon, 6 Jun 2016 15:59:06 +0200
Subject: [dev-context] Luatex 0.95.0 announcement
Message-ID: <CAG5iGsBqNFy-6zEK4ufWCs_3BpjvvqfobdLFw6P8fweywwWgug@mail.gmail.com>

==============================================================
LuaTeX Release 0.95 for TeX Live 2016 was released 2016042515
==============================================================

This is the official frozen TeXlive 2016 version and
a prerelease of the stable 1.0 version.

- deleted 'beta' from the luatex_version_string
- glues now have gluespec merged in (idem math and insert)
- registers are still glue specs
- the spec field in glues are gone
- extra tex.setglue and tex.setmuglue
- obsolete dvi related dir fields removed



Have fun,
Hans, Luigi, Taco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160606/6aa19e72/attachment.html>

From schuster.wolfgang at gmail.com  Sun Jun 12 21:36:00 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 12 Jun 2016 21:36:00 +0200
Subject: [dev-context] strc-mat.mkiv
Message-ID: <575DB9A0.9000500@gmail.com>

Hi Hans,

below is a simple patch for a error which is generated by the example at 
the end of the mail.

\unexpanded\def\strc_formulas_start_formula_indeed[#1][#2]% setting 
leftskip adaption is slow !
{\bgroup % HERE
\def\currentformula{#1}%
\dostarttaggedchained\t!formula\currentformula\??formula
\the\everybeforedisplayformula
\setfalse\c_strc_formulas_tight
%\formulastrutdp\strutdepth
%\formulastrutht\strutheight
\d_strc_formulas_display_skip_left \leftskip
\d_strc_formulas_display_skip_right \rightskip
\d_strc_formulas_display_width \formulaparameter\c!width\relax
\d_strc_formulas_display_margin_left \formulaparameter\c!leftmargin \relax
\d_strc_formulas_display_margin_right\formulaparameter\c!rightmargin\relax
\edef\p_option{\formulaparameter\c!option}%
- \edef\p_option{\ifx\p_option\empty\else\p_option,\fi#2}%
+ \ifsecondargument
+ \edef\p_option{\ifx\p_option\empty\else\p_option,\fi#2}%
+ \fi
\ifx\p_option\empty \else
\rawprocesscommacommand[\p_option]\strc_formulas_option
\fi
\edef\p_margin{\formulaparameter\c!margin}%
\ifx\p_margin\empty \else
\dosetleftskipadaption\p_margin
\d_strc_formulas_display_margin_left\leftskipadaption
\fi
\let\strc_formulas_start_formula\strc_formulas_start_formula_nested
\strc_formulas_forget_display_skips
\csname\e!start\formulaparameter\c!alternative\v!formula\endcsname}


%% begin example
\defineformula[pagella][option=pagella]

\starttext

% this works
%\startformula[pagella]
% c^2 = a^2 + b^2
%\stopformula

% this doesnât
\startpagellaformula
c^2 = a^2 + b^2
\stoppagellaformula

\stoptext
%% end example

Wolfgang

From schuster.wolfgang at gmail.com  Thu Jun 16 21:39:41 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 16 Jun 2016 21:39:41 +0200
Subject: [dev-context] tabl-tsp.mkiv
Message-ID: <5763007D.4040009@gmail.com>

Hi Hans,

the position to set the \usesamefloatnumber conditional has to be moved 
up a few lines
to fix a bug demonstrated by the example below.


\def\tabl_split_loop_body
   {\ifinsidecolumns
    [...]
    \else
      % hack
      \ifdim\pagegoal<\maxdimen
        \pagegoal\dimexpr\pagegoal+\lineheight\relax % etex
      \fi
      % brrr
      \ifdim\ht\tsplitresult>\zeropoint
        \setbox\tsplitresult\vbox
          {\unvbox\tsplitresult
           \tsplitinbetween
           \unvcopy\tsplittail}%
        
\page_split_float_process{\tsplitbeforeresult\box\tsplitresult\tsplitafterresult}%
        \doifnotinsidesplitfloat\tsplitafter
        \endgraf
+      \global\settrue\usesamefloatnumber
      \fi
      \ifinsidecolumns
        \goodbreak % was \doifnotinsidesplitfloat\goodbreak
      \else
        \page      % was \doifnotinsidesplitfloat\page
      \fi
-    \global\settrue\usesamefloatnumber % new, prevent next increment
    \fi}


%% begin example
\setuplayout[lines=6]

\starttext
     Text
     \startplacetable[location=split]
         \bTABLE \bTR \bTD \input tufte \eTD \eTR \eTABLE
     \stopplacetable
\stoptext
%% end example

Wolfgang

From oinos at gmx.es  Tue Jun 28 18:04:49 2016
From: oinos at gmx.es (Pablo Rodriguez)
Date: Tue, 28 Jun 2016 18:04:49 +0200
Subject: [dev-context] disable /PrintScaling None when not invoked
Message-ID: <302f34c8-2c16-51ad-e5f4-7f49ba386781@gmx.es>

Hans,

I have found that the values page, portrait, landscape and paper from
the option key in \setupinteractionscreen force the page scaling to none.

I think it is essential to have the fixed option only when explicitly
invoked.

I attach a patch that fixes the issue. Could it be applied to ConTeXt?

Many thanks in advance,

Pablo
-- 
http://www.ousia.tk
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fix-fixed.diff
Type: text/x-patch
Size: 726 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160628/75f9b2ca/attachment.bin>

From schuster.wolfgang at gmail.com  Tue Jul 12 17:30:04 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Tue, 12 Jul 2016 17:30:04 +0200
Subject: [dev-context] page-sel.mkvi
Message-ID: <57850CFC.6090700@gmail.com>

Hi,

the new category has to be added to the default settings for 
\insertpages and \filterpages.

\def\page_selectors_insert_indeed[#filename][#emptylist][#settings]%
   {\bgroup
    \dontcomplain
    \getfiguredimensions[#filename]%
-  
\setupcurrentwithpages[\c!width=\zeropoint,\c!n=\noffigurepages,#settings]%
+  
\setupcurrentwithpages[\c!width=\zeropoint,\c!n=\noffigurepages,\c!category=,#settings]%
    \global\c_page_selectors_n\directwithpagesparameter\c!n\relax
    \scratchwidth\directwithpagesparameter\c!width\relax
    \doifinset0{#emptylist}
      {\emptyhbox\page}%
    \dorecurse\c_page_selectors_n
      {\page_selectors_filter_a_page{#filename}\recurselevel
       \doifinset\recurselevel{#emptylist}
         {\emptyhbox\page}}%
    \egroup}

\def\page_selectors_filter[#filename][#selection][#settings]% % 
\noffigurepages not yet supported
   {\bgroup
    \dontcomplain
    \getfiguredimensions[#filename]%
-  
\setupcurrentwithpages[\c!width=\zeropoint,\c!n=\noffigurepages,#settings]%
+  
\setupcurrentwithpages[\c!width=\zeropoint,\c!n=\noffigurepages,\c!category=,#settings]%
    \global\c_page_selectors_n\directwithpagesparameter\c!n\relax
    \scratchwidth\directwithpagesparameter\c!width\relax
    \edef\p_selection{#selection}%
    \ifx\p_selection\v!even
      \dorecurse\c_page_selectors_n
        {\ifodd\recurselevel\else
           \page_selectors_filter_a_page{#filename}\recurselevel
         \fi}%
    \else\ifx\p_selection\v!odd
      \dorecurse\c_page_selectors_n
        {\ifodd\recurselevel\relax
           \page_selectors_filter_a_page{#filename}\recurselevel
         \fi}%
    \else
      \def\page_selectors_filter_step_indeed#page%
        {\ifnum#page>\c_page_selectors_n\else
           \page_selectors_filter_a_page{#filename}{#page}%
         \fi}%
      \def\page_selectors_filter_step#step%
        {\dowithrange{#step}\page_selectors_filter_step_indeed}%
      \processcommacommand[\p_selection]\page_selectors_filter_step
    \fi\fi
    \egroup}

Wolfgang

From schuster.wolfgang at gmail.com  Fri Jul 22 10:18:58 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Fri, 22 Jul 2016 10:18:58 +0200
Subject: [dev-context] pack-rul.mkiv
Message-ID: <5791D6F2.2030104@gmail.com>

Hi,

\def\pack_framed_text_start_direct[#1]%
   {\usebodyfontparameter\framedtextparameter
    \iffirstargument
      \setupcurrentframedtext[#1]%
    \fi
-  \edef\p_framed_text_strut{\letframedtextparameter\c!strut}%
+  \edef\p_framed_text_strut{\framedtextparameter\c!strut}%
    \letframedtextparameter\c!strut\v!no
    \inheritedframedtextframed\bgroup
      \blank[\v!disable]%
      \let\\=\endgraf
      \useframedtextstyleandcolor\c!style\c!color
      \vskip-\strutdp % brrr why is this needed ... needs to be sorted 
out, see testcase 1
      \framedtextparameter\c!inner
      \ifx\p_framed_text_strut\v!no
         \let\pack_framed_strut\relax
      \else
         \let\pack_framed_strut\strut
      \fi
      \bgroup
      \aftergroup\pack_framed_text_stop_direct
      \afterassignment\ignorespaces
      \afterassignment\pack_framed_strut
      \let\next=}

Wolfgang

From schuster.wolfgang at gmail.com  Sat Jul 23 09:46:08 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 23 Jul 2016 09:46:08 +0200
Subject: [dev-context] supp-box.mkiv: \beginvtop
Message-ID: <579320C0.1060805@gmail.com>

Hi Hans,

I saw you added \beginvbox (line 2928) etc. to the file, can you also 
add \beginvtop etc.

Wolfgang

From pragma at wxs.nl  Sat Jul 23 12:08:52 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 23 Jul 2016 12:08:52 +0200
Subject: [dev-context] supp-box.mkiv: \beginvtop
In-Reply-To: <579320C0.1060805@gmail.com>
References: <579320C0.1060805@gmail.com>
Message-ID: <37783112-6427-0b79-3b51-a068c7647e4f@wxs.nl>

On 7/23/2016 9:46 AM, Wolfgang Schuster wrote:
> Hi Hans,
>
> I saw you added \beginvbox (line 2928) etc. to the file, can you also
> add \beginvtop etc.

sure. btw, these changed / additions are mostly because i'm cleaning up 
the context namespace ... so 'context' has a limited set of functions 
and the macros get delegated to context.core (i.e get registered there)

so:

\ctxlua{inspect(table.sortedkeys(context))}

will give a clean list while still supporting context.foo

(also, ctx_ prefixed highlight special in my lexer so they stand out 
better)

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
        tel: 038 477 53 69 | www.pragma-ade.nl | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Sat Jul 23 12:23:22 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 23 Jul 2016 12:23:22 +0200
Subject: [dev-context] strc-itm.mkvi: \noitem
Message-ID: <5793459A.5000106@gmail.com>

Hi Hans,

can you fix the \noitem command with the definition below.


The command is used to increment the item counter to create lists like this:

     1.a. ...
     1.b. ...
     2.a. ...
     2.b. ...


%% begin example
\unprotect

%\let\strc_itemgroups_start_no_item\strc_itemgroups_start_item_nop

\def\strc_itemgroups_start_no_item
   {\let\currentitemreference\empty
    \strc_itemgroups_increment_item_counter
   %\advance\c_strc_itemgroups_n_of_items\plusone
    \setbox\b_strc_itemgroups\emptyhbox
    \strc_itemgroups_check_for_repeated
    \ignorespaces}

\protect

\showframe[text][text]

\starttext

%\startitemize[n,repeat]
%  \item Item 1 \startitemize[a] \item Item 1.a. \item Item 1.b. 
\stopitemize
%  \item Item 2 \startitemize[a] \item Item 2.a. \item Item 2.b. 
\stopitemize
%\stopitemize

\startitemize[n,repeat][width=0pt]
   \noitem \startitemize[a][width=2em] \item Item 1.a. \item Item 1.b. 
\stopitemize
   \noitem \startitemize[a][width=2em] \item Item 2.a. \item Item 2.b. 
\stopitemize
\stopitemize

\stoptext
%% end example

Wolfgang
-------------- next part --------------
A non-text attachment was scrubbed...
Name: noitem.tex
Type: application/x-tex
Size: 806 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160723/e8924855/attachment.tex>

From alan.braslau at cea.fr  Fri Jul 29 00:11:14 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Thu, 28 Jul 2016 16:11:14 -0600
Subject: [dev-context] lang-def.mkiv
Message-ID: <20160728161114.4206b63c@cea.fr>

See attached lang-def.mkiv.
Added missing system aliases for CJK languages.

Alan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lang-def.mkiv
Type: application/octet-stream
Size: 21712 bytes
Desc: not available
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20160728/bedfbd11/attachment-0001.obj>

From taco at elvenkind.com  Thu Aug 11 10:18:19 2016
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 11 Aug 2016 10:18:19 +0200
Subject: [dev-context] New style bibliographies
Message-ID: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>

Hi,

Working on the next issue of the CG Journal, I finally had a good reason to look at the new bibliography code. Even with a big manual, it was still a bit of challenge.

The article I was working on was written for mkii, and came with a prebuilt .bbl file for that (but not with the original .bib files). The original databases look like they were created for latex so there were some problems with embedded commands and it being 8-bit (ISO-latin), but that was to be expected.

Some other problems seems to be more related to differences between the mkii and the mkiv bibliography code. 

First question: is there a âdefaultâ or âstandardâ dataset, or not? If so, is it named âdefaultâ or âstandardâ? The bit of code on the wiki and the actual manual seem to disagree on that. My current solution looks like this:


  \usebtxdataset[h-all-forced.bbl]
  \usebtxdefinitions[aps]
  \setupbtxrendering[alternative=aps]
  â¦
  \placelistofpublications[criterium=text]

That works, but almost all the documentation uses either [default] or [standard].

Second question: It appears I need both \usebtxdefinitions and \setupbtxrendering, which surprised me. I understand that right now, there is only âapaâ and âapsâ, but it seems neither are preloaded? Without the \usebtxdefinitions, I did get a list of publications, but with horrible formatting, especially for âmanualâ and âinproceedingsâ.

Contrary to what the manual says, \cite[key] does not seem to work. however, \citation[key] does. So, in the preamble I now have

   \let\cite\citation

but isnât it weird that I needed that?


More importantly (read: "more timeconsuming-ly"), there are some differences in the .bbl processing compared to mkii, which is not great. So far, I found this:

* mkii used \arttitle in some spots. To be exact: in âarticleâ, âincollectionâ, and âinproceedingsâ entries. I changed the ones in âarticle' to \title inside the .bll to get these to work.

* That fixed âarticleâs, but âinproceedingsâ and âincollectionâ are broken, because these *also* has an actual \title for the complete proceedings/collection, and I do not know how to make the module display both titles. Please help, because I definitely need the âinproceedingsâ one to work properly! I now get formatted output like this:

  [18] J.-M. Hufflen, Proc. 6th ConTEXt Meeting
       & EuroTEX 2012 (2012).

(actually twice the exact same entry, because there were two articles by J-M in that one proceedings). Do I need \booktitle?
Not that I mind, but it is a little odd in the sense that a âcollectionâ has a title, but it is not really a âbook titleâ, it is a âcollection titleâ (and likewise for 'proceedingsâ) ;)

* In mkii, the bbl uses e.h. \artauthor[]{John}[J.]{}{Doe}. The problem I have there is that the new biblio code (at least the âapsâ version) inserts dots after the initials in the output list, So I end up with âJ.. Doeâ. I like the âadding a dotâ in principle, but if it stays, then it should definitely be conditional on whether or not the initials already have one. Having to edit the datafile the fix the double dot was quite uncomfortable.

* I had to change the .bbl, replacing all \pubyear with \year. The extra \pubâ¦ prefix was there because of conflicts with the primitive \year in mkii and it makes sense to not require it any more in mkiv, but nevertheless it would be helpful if \pubyear could be used as an alias to \year. Not the hardest change though, it was a single global replace in the bbl, so a low priority request.

* The new âapsâ style does not print the publisher name for âbookâ (at least, I probably missed others). I assume this is because of the ânot quite ready yetâ state of new biblio code, but I hope that will be fixed at some point. And there are probably a few other (less common) fields still missing, right?. Probably because the .bbl uses e.g. \pubname, not â\publisherâ? I donât want to go looking for these missing fields just now, but I would be willing to do at some later date.


Finally: the manual says there are various ârequired fieldsâ for the entry types. That is great, but could there be some (optional) visual feedback in the formatted list if such a required field is in fact missing? traditionally, that would a black square, but a bold *publisher missing* would be very useful.

Thatâs it for now. Sorry about the long list of complaints. I do appreciate the amount of work needed to get bibliographies working even without having to worry about backward compatibility, but I feel it is important that, if there is supposed to be backward compatibility, that it ten be as close to perfect as technically possible. Even if it is a bit of pain. 

Best wishes,
Taco





From taco at elvenkind.com  Thu Aug 11 10:22:37 2016
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 11 Aug 2016 10:22:37 +0200
Subject: [dev-context] New style bibliographies
In-Reply-To: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>
References: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>
Message-ID: <BBBA497A-4983-4F3A-915E-11D545924533@elvenkind.com>


> On 11 Aug 2016, at 10:18, Taco Hoekwater <taco at elvenkind.com> wrote:
> 
> Hi,
> 
> Working on the next issue of the CG Journal, I finally had a good reason to look at the new bibliography code. Even with a big manual, it was still a bit of challenge.
> 
> The article I was working on was written for mkii, and came with a prebuilt .bbl file for that (but not with the original .bib files). The original databases look like they were created for latex so there were some problems with embedded commands and it being 8-bit (ISO-latin), but that was to be expected.
> 
> Some other problems seems to be more related to differences between the mkii and the mkiv bibliography code. 
> 
> First question: is there a âdefaultâ or âstandardâ dataset, or not? If so, is it named âdefaultâ or âstandardâ? The bit of code on the wiki and the actual manual seem to disagree on that. My current solution looks like this:
> 
> 
>  \usebtxdataset[h-all-forced.bbl]
>  \usebtxdefinitions[aps]
>  \setupbtxrendering[alternative=aps]
>  â¦
>  \placelistofpublications[criterium=text]
> 
> That works, but almost all the documentation uses either [default] or [standard].
> 
> Second question: It appears I need both \usebtxdefinitions and \setupbtxrendering, which surprised me. I understand that right now, there is only âapaâ and âapsâ, but it seems neither are preloaded? Without the \usebtxdefinitions, I did get a list of publications, but with horrible formatting, especially for âmanualâ and âinproceedingsâ.
> 
> Contrary to what the manual says, \cite[key] does not seem to work. however, \citation[key] does. So, in the preamble I now have
> 
>   \let\cite\citation
> 
> but isnât it weird that I needed that?
> 
> 
> More importantly (read: "more timeconsuming-ly"), there are some differences in the .bbl processing compared to mkii, which is not great. So far, I found this:
> 
> * mkii used \arttitle in some spots. To be exact: in âarticleâ, âincollectionâ, and âinproceedingsâ entries. I changed the ones in âarticle' to \title inside the .bll to get these to work.
> 
> * That fixed âarticleâs, but âinproceedingsâ and âincollectionâ are broken, because these *also* has an actual \title for the complete proceedings/collection, and I do not know how to make the module display both titles. Please help, because I definitely need the âinproceedingsâ one to work properly! I now get formatted output like this:
> 
>  [18] J.-M. Hufflen, Proc. 6th ConTEXt Meeting
>       & EuroTEX 2012 (2012).
> 
> (actually twice the exact same entry, because there were two articles by J-M in that one proceedings). Do I need \booktitle?
> Not that I mind, but it is a little odd in the sense that a âcollectionâ has a title, but it is not really a âbook titleâ, it is a âcollection titleâ (and likewise for 'proceedingsâ) ;)
> 
> * In mkii, the bbl uses e.h. \artauthor[]{John}[J.]{}{Doe}. The problem I have there is that the new biblio code (at least the âapsâ version) inserts dots after the initials in the output list, So I end up with âJ.. Doeâ. I like the âadding a dotâ in principle, but if it stays, then it should definitely be conditional on whether or not the initials already have one. Having to edit the datafile the fix the double dot was quite uncomfortable.
> 
> * I had to change the .bbl, replacing all \pubyear with \year. The extra \pubâ¦ prefix was there because of conflicts with the primitive \year in mkii and it makes sense to not require it any more in mkiv, but nevertheless it would be helpful if \pubyear could be used as an alias to \year. Not the hardest change though, it was a single global replace in the bbl, so a low priority request.
> 
> * The new âapsâ style does not print the publisher name for âbookâ (at least, I probably missed others). I assume this is because of the ânot quite ready yetâ state of new biblio code, but I hope that will be fixed at some point. And there are probably a few other (less common) fields still missing, right?. Probably because the .bbl uses e.g. \pubname, not â\publisherâ? I donât want to go looking for these missing fields just now, but I would be willing to do at some later date.
> 
> 
> Finally: the manual says there are various ârequired fieldsâ for the entry types. That is great, but could there be some (optional) visual feedback in the formatted list if such a required field is in fact missing? traditionally, that would a black square, but a bold *publisher missing* would be very useful.
> 
> Thatâs it for now. Sorry about the long list of complaints. I do appreciate the amount of work needed to get bibliographies working even without having to worry about backward compatibility, but I feel it is important that, if there is supposed to be backward compatibility, that it ten be as close to perfect as technically possible. Even if it is a bit of pain. 
> 
> 

Addendum: It seems \cite (aka \citation) does not work inside footnotes? I get output like this:

  â¦ A good introduction to this scripting language is [<wall-etc2000>].

And the entry does not appear in the publication list.?!

Best wishes,
Taco







From taco at elvenkind.com  Thu Aug 11 10:26:56 2016
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 11 Aug 2016 10:26:56 +0200
Subject: [dev-context] New style bibliographies
In-Reply-To: <BBBA497A-4983-4F3A-915E-11D545924533@elvenkind.com>
References: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>
 <BBBA497A-4983-4F3A-915E-11D545924533@elvenkind.com>
Message-ID: <490AD97A-0265-415B-BFCD-083B15F4555A@elvenkind.com>

Hi,

> On 11 Aug 2016, at 10:22, Taco Hoekwater <taco at elvenkind.com> wrote:
> 
> Addendum: It seems \cite (aka \citation) does not work inside footnotes? I get output like this:
> 
>  â¦ A good introduction to this scripting language is [<wall-etc2000>].
> 
> And the entry does not appear in the publication list.?!

Sorry, ignore that. This is a missing entry, right? Is there a way to produce a list of those?

Taco Hoekwater
Elvenkind BV





From alan.braslau at cea.fr  Thu Aug 11 16:18:30 2016
From: alan.braslau at cea.fr (Alan BRASLAU)
Date: Thu, 11 Aug 2016 08:18:30 -0600
Subject: [dev-context] New style bibliographies
In-Reply-To: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>
References: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>
Message-ID: <20160811081830.1fa69851@cea.fr>

Hi Taco,


On Thu, 11 Aug 2016 10:18:19 +0200
Taco Hoekwater <taco at elvenkind.com> wrote:

> Hi,
> 
> Working on the next issue of the CG Journal, I finally had a good
> reason to look at the new bibliography code. Even with a big manual,
> it was still a bit of challenge.
> 
> The article I was working on was written for mkii, and came with a
> prebuilt .bbl file for that (but not with the original .bib files).
> The original databases look like they were created for latex so there
> were some problems with embedded commands and it being 8-bit
> (ISO-latin), but that was to be expected.
> 
> Some other problems seems to be more related to differences between
> the mkii and the mkiv bibliography code. 
> 
> First question: is there a âdefaultâ or âstandardâ dataset, or not?
> If so, is it named âdefaultâ or âstandardâ? The bit of code on the
> wiki and the actual manual seem to disagree on that. My current
> solution looks like this:
> 
> 
>   \usebtxdataset[h-all-forced.bbl]
>   \usebtxdefinitions[aps]
>   \setupbtxrendering[alternative=aps]
>   â¦
>   \placelistofpublications[criterium=text]
> 
> That works, but almost all the documentation uses either [default] or
> [standard].

I do not know anything about [standard].
For convenience, we define a "default" dataset. Hans has insisted,
however, that it would be good practice for a user to explicitly define
datasets.


> Second question: It appears I need both \usebtxdefinitions and
> \setupbtxrendering, which surprised me. I understand that right now,
> there is only âapaâ and âapsâ, but it seems neither are preloaded?
> Without the \usebtxdefinitions, I did get a list of publications, but
> with horrible formatting, especially for âmanualâ and âinproceedingsâ.

The default (not to be confused with the dataset named "default")
rendering is extremely minimal: only @book and @article are recognized.
The rendering style is very simplified too. Hans wanted to keep this
really minimal, so perhaps we can call it the "minimal" style.

You do NOT need to setup the rendering after loading a more complete
style. The manual states:

An alternative set of specifications can be selected using, for example
	\usebtxdefinitions[apa]

Alternately, the set of specifications can be loaded and (later)
activated using
	\loadbtxdefinitionfile[apa]
	â¦
	\setupbtx[specification=apa]

This is to allow loading multiple specifications (each in its own
namespace) and then choosing specifications when needed. This is
normally not very useful, but is used in the manual itself.

> Contrary to what the manual says, \cite[key] does not seem to work.
> however, \citation[key] does. So, in the preamble I now have
> 
>    \let\cite\citation
> 
> but isnât it weird that I needed that?

???
line 1391 of publ-ini.mkiv has this definition.

> More importantly (read: "more timeconsuming-ly"), there are some
> differences in the .bbl processing compared to mkii, which is not
> great. So far, I found this:
> 
> * mkii used \arttitle in some spots. To be exact: in âarticleâ,
> âincollectionâ, and âinproceedingsâ entries. I changed the ones in
> âarticle' to \title inside the .bll to get these to work.
> 
> * That fixed âarticleâs, but âinproceedingsâ and âincollectionâ are
> broken, because these *also* has an actual \title for the complete
> proceedings/collection, and I do not know how to make the module
> display both titles. Please help, because I definitely need the
> âinproceedingsâ one to work properly! I now get formatted output like
> this:
> 
>   [18] J.-M. Hufflen, Proc. 6th ConTEXt Meeting
>        & EuroTEX 2012 (2012).
> 
> (actually twice the exact same entry, because there were two articles
> by J-M in that one proceedings). Do I need \booktitle? Not that I
> mind, but it is a little odd in the sense that a âcollectionâ has a
> title, but it is not really a âbook titleâ, it is a âcollection
> titleâ (and likewise for 'proceedingsâ) ;)
> 
> * In mkii, the bbl uses e.h. \artauthor[]{John}[J.]{}{Doe}. The
> problem I have there is that the new biblio code (at least the âapsâ
> version) inserts dots after the initials in the output list, So I end
> up with âJ.. Doeâ. I like the âadding a dotâ in principle, but if it
> stays, then it should definitely be conditional on whether or not the
> initials already have one. Having to edit the datafile the fix the
> double dot was quite uncomfortable.
> 
> * I had to change the .bbl, replacing all \pubyear with \year. The
> extra \pubâ¦ prefix was there because of conflicts with the primitive
> \year in mkii and it makes sense to not require it any more in mkiv,
> but nevertheless it would be helpful if \pubyear could be used as an
> alias to \year. Not the hardest change though, it was a single global
> replace in the bbl, so a low priority request.

I noticed this in converting Idris' .bbl files.
As I never used (nor know) the old .bbl format, I did not spend any
time on this, nor did I bother Hans to look into it, but we probably
need to tune the .bbl -> .bib (i.e. lua tables) conversion. 


> * The new âapsâ style does not print the publisher name for
> âbookâ (at least, I probably missed others). I assume this is because
> of the ânot quite ready yetâ state of new biblio code, but I hope
> that will be fixed at some point. And there are probably a few other
> (less common) fields still missing, right?. Probably because the .bbl
> uses e.g. \pubname, not â\publisherâ? I donât want to go looking for
> these missing fields just now, but I would be willing to do at some
> later date.

pubname is NOT a bibtex field name, whereas publisher is.
This does not mean that pubname is incorrect for a .bbl, so this is an
example of tuning the .bbl -> .bib conversion, not a shortcoming of the
rendering specifications.

> Finally: the manual says there are various ârequired fieldsâ for the
> entry types. That is great, but could there be some (optional) visual
> feedback in the formatted list if such a required field is in fact
> missing? traditionally, that would a black square, but a bold
> *publisher missing* would be very useful.

There are debugging tools.

"required" vs. "optional" is a relative notion, and the rendering
specifications are tuned to remain robust when fields are missing. 
The notion of required comes from the original bibtex specifications,
and is reflected in tools such as jabref. But these do not necessarily
correspond to the official APA specifications, nor on the APS
guidelines.



> Thatâs it for now. Sorry about the long list of complaints. I do
> appreciate the amount of work needed to get bibliographies working
> even without having to worry about backward compatibility, but I feel
> it is important that, if there is supposed to be backward
> compatibility, that it ten be as close to perfect as technically
> possible. Even if it is a bit of pain. 

It sounds like the limitations that you see are in the .bbl
conversions. We are also working with Idris right now who is also
exercising the new system with his own requirements.

Alan

-- 
Alan Braslau
CEA DSM-IRAMIS-SPEC
CNRS UMR 3680
Orme des Merisiers
91191 Gif-sur-Yvette cedex FRANCE
tel: +33 1 69 08 73 15
fax: +33 1 69 08 87 86
mailto:alan.braslau at cea.fr

From taco at elvenkind.com  Fri Aug 12 09:50:59 2016
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 12 Aug 2016 09:50:59 +0200
Subject: [dev-context] New style bibliographies
In-Reply-To: <20160811081830.1fa69851@cea.fr>
References: <607590D4-055F-4891-871E-A18B9C1A82E0@elvenkind.com>
 <20160811081830.1fa69851@cea.fr>
Message-ID: <35DF468F-818E-4167-AFE6-9A93024FB13F@elvenkind.com>

Hi,

> On 11 Aug 2016, at 16:18, Alan BRASLAU <alan.braslau at cea.fr> wrote:
> 
> Hi Taco,
> 
> 
> On Thu, 11 Aug 2016 10:18:19 +0200
> Taco Hoekwater <taco at elvenkind.com> wrote:
>> 
>> First question: is there a âdefaultâ or âstandardâ dataset, or not?
>> If so, is it named âdefaultâ or âstandardâ? The bit of code on the
>> wiki and the actual manual seem to disagree on that. My current
>> solution looks like this:
>> 
>> 
>>  \usebtxdataset[h-all-forced.bbl]
>>  \usebtxdefinitions[aps]
>>  \setupbtxrendering[alternative=aps]
>>  â¦
>>  \placelistofpublications[criterium=text]
>> 
>> That works, but almost all the documentation uses either [default] or
>> [standard].
> 
> I do not know anything about [standard].

> For convenience, we define a "default" dataset. Hans has insisted,
> however, that it would be good practice for a user to explicitly define
> datasets.

[standard] comes from the presentation slides from Bassenge, that are 
linked from the wiki page âBiblographies in MkIVâ.

An actual user definition of [default] is used as an example in 
actual manual. 

Together, that is a little confusing. If [default] is indeed predefined,
then it should probably not be used as an example of defining a dataset.
The slides cannot be fixed I guess, but [standard] is an unlucky name
for a demonstration. 

In some later sections, the manual uses [example], and IMHO that is a lot
clearer.

> 
>> Second question: It appears I need both \usebtxdefinitions and
>> \setupbtxrendering, which surprised me. I understand that right now,
>> there is only âapaâ and âapsâ, but it seems neither are preloaded?
>> Without the \usebtxdefinitions, I did get a list of publications, but
>> with horrible formatting, especially for âmanualâ and âinproceedingsâ.
> 
> The default (not to be confused with the dataset named "default")
> rendering is extremely minimal: only @book and @article are recognized.

I find that a little odd, especially since it is not really documented
(unless I missed something in the manual). Why not do absolutely nothing,
then? 

Someone who needs âarticleâ is likely to need âinproceedingsâ, at 
least. And many ConTeXt users will want to have âelectronicâ and âotherâ.


> The rendering style is very simplified too. Hans wanted to keep this
> really minimal, so perhaps we can call it the "minimal" style.
> 
> You do NOT need to setup the rendering after loading a more complete
> style.

Oh right, yes it works! Sorry, I guess I got confused there.

A new side note: the manual section for \setupbtxrendering seems to be 
undecided about âalternative=â vs. âspecification=â (unless those
are synonyms): The quickref block uses âalternativeâ.

>> Contrary to what the manual says, \cite[key] does not seem to work.
>> however, \citation[key] does. So, in the preamble I now have
>> 
>>   \let\cite\citation
>> 
>> but isnât it weird that I needed that?
> 
> ???
> line 1391 of publ-ini.mkiv has this definition.

Nevertheless that does not work. In my document, \cite expands to:

  \protected macro:->\strc_references_apply_format {cite}

(which is a definition from strc-ref.mkvi, and does not work) 
whereas \citation expands to

  \protected macro:->\doifelsenextoptionalcs \btxlistcitation \btxdirectlistcite 

which works perfectly.

For now, I will tweak the bbl file some more to get rid of the incompatibilities,
but I hope all the bbl remarks I made earlier can be integrated at some point.

Btw, I found âpublications.cite.missingâ, and I really think that one should be
enabled by default. Missing bibliographic references is just as bad as missing
normal references.


Taco Hoekwater
Elvenkind BV





From taco at elvenkind.com  Thu Sep 22 22:03:17 2016
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 22 Sep 2016 22:03:17 +0200
Subject: [dev-context] Pragma website and alpha uploads?
Message-ID: <8F053B65-ACBC-4EF2-A71E-CD41BA0786E6@elvenkind.com>

Hi,

On the subject of 'latest', there is a bug it seems: it looks like the Download section of the pragma website no longer picks up 'latest' uploads since the change from '/alpha' to '/latest' in the folder name?

Best wishes,
Taco

From pragma at wxs.nl  Thu Sep 22 22:24:51 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 22 Sep 2016 22:24:51 +0200
Subject: [dev-context] Pragma website and alpha uploads?
In-Reply-To: <8F053B65-ACBC-4EF2-A71E-CD41BA0786E6@elvenkind.com>
References: <8F053B65-ACBC-4EF2-A71E-CD41BA0786E6@elvenkind.com>
Message-ID: <21d4762a-82dc-f212-5da5-0d19fa17e66b@wxs.nl>

On 9/22/2016 10:03 PM, Taco Hoekwater wrote:
> Hi,
>
> On the subject of 'latest', there is a bug it seems: it looks like the Download section of the pragma website no longer picks up 'latest' uploads since the change from '/alpha' to '/latest' in the folder name?

hm, i need to check it ... i rewrote the beta packer

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
        tel: 038 477 53 69 | www.pragma-ade.nl | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Thu Sep 22 22:29:16 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 22 Sep 2016 22:29:16 +0200
Subject: [dev-context] Pragma website and alpha uploads?
In-Reply-To: <8F053B65-ACBC-4EF2-A71E-CD41BA0786E6@elvenkind.com>
References: <8F053B65-ACBC-4EF2-A71E-CD41BA0786E6@elvenkind.com>
Message-ID: <73be50ac-0177-d8e5-e876-94a68e02ea75@wxs.nl>

On 9/22/2016 10:03 PM, Taco Hoekwater wrote:
> Hi,
>
> On the subject of 'latest', there is a bug it seems: it looks like the Download section of the pragma website no longer picks up 'latest' uploads since the change from '/alpha' to '/latest' in the folder name?

i always update latest and then deal with the others and that last bit 
was broken (as I forgot to adapt a variable name)

will be okay next time

i think mojca takes from latest anyway

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
        tel: 038 477 53 69 | www.pragma-ade.nl | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Mon Sep 26 20:04:53 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 26 Sep 2016 20:04:53 +0200
Subject: [dev-context] tabl-tbl.mkiv
Message-ID: <57E96345.2060908@gmail.com>

Hi,

\def\tabl_tabulate_inside_before
   {\ifhmode\par\fi
    \ifhmode
      \ifinsidesplitfloat
        \let\tabl_tabulate_inside_after    \relax
+      \let\tabl_tabulate_inside_inbetween\relax
      \else
        \vbox\bgroup
        \let\tabl_tabulate_inside_after    \egroup
+      \let\tabl_tabulate_inside_inbetween\relax
      \fi
    \else
      \let\tabl_tabulate_inside_after    \relax
+    \let\tabl_tabulate_inside_inbetween\relax
    \fi}

Wolfgang

From schuster.wolfgang at gmail.com  Tue Sep 27 10:24:07 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Tue, 27 Sep 2016 10:24:07 +0200
Subject: [dev-context] mult-def.lua
Message-ID: <57EA2CA7.9010604@gmail.com>

Hi,

cd:oneargument etc. are strings (no -s or -l variants)but something has 
to be changed because they end up with duplicated hashes (##1 instead of 
#1).

A entry for parentheses has to be added as well.

mult-def.lua:

   ["cd:xmlsetup"]={
    ["cs"]="xmlsetup",
    ["de"]="xmlsetup",
    ["en"]="xmlsetup",
    ["fr"]="xmlsetup",
    ["it"]="xmlsetup",
    ["nl"]="xmlsetup",
    ["ro"]="xmlsetup",
   },
+ ["cd:oneargument"]={
+  ["en"]="\\...#1",
+ },
+ ["cd:twoarguments"]={
+  ["en"]="\\...#1#2",
+ },
+ ["cd:threearguments"]={
+  ["en"]="\\...#1#2#3",
+ },
   ["cd:sign"]                      = { en = "[-+]" },
   ["cd:csname-s"]                  = { en = "\\..." },
   ["cd:csname-l"]                  = { en = "\\..." },
   ["cd:noargument-s"]              = { en = "\\..." },
   ["cd:noargument-l"]              = { en = "\\..." },
- ["cd:oneargument-s"]             = { en = "\\...#1" },
- ["cd:oneargument-l"]             = { en = "\\...#1" },
- ["cd:twoarguments-s"]            = { en = "\\...#1#2" },
- ["cd:twoarguments-l"]            = { en = "\\...#1#2" },
- ["cd:threearguments-s"]          = { en = "\\...#1#2#3" },
- ["cd:threearguments-l"]          = { en = "\\...#1#2#3" },
   ["cd:braces-s"]                  = { en = "{...}", lua = '"..."' },
   ["cd:braces-l"]                  = { en = "{...,...}", lua = '".. ... 
.."' },
   ["cd:brackets-s"]                = { en = "[...]", lua = "{ ... }" },
   ["cd:brackets-l"]                = { en = "[...,...]", lua = "{..., 
...}" },
+ ["cd:parentheses-s"]             = { en = "{...}", lua = '"..."' },
+ ["cd:parentheses-l"]             = { en = "{...,...}", lua = '".. ... 
.."' },
   ["cd:index-s"]                   = { en = "[...]" },
   ["cd:index-l"]                   = { en = "[..+...+..]" },

Wolfgang

From schuster.wolfgang at gmail.com  Tue Sep 27 10:29:00 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Tue, 27 Sep 2016 10:29:00 +0200
Subject: [dev-context] x-setups-basics.mkiv
Message-ID: <57EA2DCC.4020704@gmail.com>

Hi,

\unexpanded\def\show_setup_any#1#2%
   {\bgroup
    \global\advance\c_cmd_current_argument\plusone
-  \doif{\xmlatt{#1}{optional}}{yes}\donetrue\donefalse
+  \doifelse{\xmlatt{#1}{optional}}{yes}\donetrue\donefalse
    \setbox0=\hbox
      {\ifdone\sl\fi
       \doifelse{\xmlatt{#1}{list}}{yes}
         {\getsetupstring{cd:#2-l}}%
         {\getsetupstring{cd:#2-s}}}%
    \setbox2=\hbox to \wd0
      {\hss
       \ifcase\c_cmd_kind\else
         \ifcase\c_cmd_maximum_argument \relax
         \or
           \raise1.25\exheight\hbox
             {\txx *}%
         \else
           \raise1.25\exheight\hbox
             {\txx\the\c_cmd_current_argument}%
          \fi
       \fi
       \hss}%
    \setbox4=\hbox to \wd0
      {\hss
       \ifdone
         \lower2\exheight\hbox
           \bgroup
             \txx
             \getsetupstring{cd:optional}%
           \egroup
         \hss
       \fi}%
    \ht2\ht\strutbox
    \dp4\dp\strutbox
    \hskip.5\emwidth
    \wd0\zeropoint
    \box0
    \wd2\zeropoint
    \box2
    \box4%
    \egroup
    \ignorespaces}

Wolfgang

From luigi.scarso at gmail.com  Tue Sep 27 20:37:30 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Tue, 27 Sep 2016 20:37:30 +0200
Subject: [dev-context] Luatex 1.0.0 announcement
Message-ID: <CAG5iGsB77zAKECmMAZaforfXAoZS1cRw7yWiOz2xQS7kvc0K7A@mail.gmail.com>

Version 1.0.0

After some ten years of development and testing, today we have released
LuaTeX 1.0.0! Instead of staying below one and ending up with versions
like 0.99.1234, we decided that the moment is there to show the TeX
audience that LuaTeX is stable enough to loose its beta status. Although
functionality has evolved and sometimes been replaced, we have been using
LuaTeX in production right from the start. Of course there are bugs
and for sure we will fix them.

Our main objective is to provide a variant of TeX that permits user
extensions without the need to adapt the inner workings. We did add a few
things here and there but they mostly relate to opening up the inner parts
and/or the wish to influence some hard coded behaviour. Via Lua we managed
to support modern functionality without bloating the code or adding more
and more dependencies on foreign code. In the process a stable and flexible
MetaPost library became part of the engine.

The functionality as present now will stay. We might open up some more
parts, we will stepwise clean up the code base while staying as close as
possible to the Knuthian original, we will try to document bits and pieces.
We might also experiment a bit with better isolation of the backend, and
simplify some internals. For that we might use the experimental version
but if we divert too much we may need to give that another name.

We want to thank all those who have tested the betas and helped to make
LuaTeX better.

Hans Hagen
Hartmut Henkel
Taco Hoekwater
Luigi Scarso

From schuster.wolfgang at gmail.com  Wed Sep 28 09:56:12 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Wed, 28 Sep 2016 09:56:12 +0200
Subject: [dev-context] m-educat.mkiv
Message-ID: <57EB779C.1060506@gmail.com>

Hi,

\def\doanswerspace[#1]%
   {\begingroup
    \dontcomplain
    \setupanswerarea
      [\c!n=0,\c!m=,#1,\c!location=\v!text]%
+  \let\currenttextbackground\v!answerarea
    \doifelsenothing{\textbackgroundparameter\c!m}
      {\expandafter\donoanswerspace}
      {\expandafter\dodoanswerspace}%
    [#1]}

\def\dostartanswerlines[#1]%
   {\begingroup
    \dontcomplain
    \setupanswerarea
      [\c!n=0,\c!m=,#1,\c!location=\v!text]%
+  \let\currenttextbackground\v!answerarea
    \doifnot{\textbackgroundparameter\c!option}\v!joinedup\softbreak
    \doifelsenothing{\textbackgroundparameter\c!m}
      {\expandafter\donostartanswerlines}
      {\expandafter\dodostartanswerlines}%
    [#1]}

Wolfgang

From wolfgang.schuster at gmail.com  Wed Sep 28 14:37:31 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Wed, 28 Sep 2016 14:37:31 +0200
Subject: [dev-context] x-setups-basics.mkiv
Message-ID: <57EBB98B.5060104@gmail.com>

Hi,

\startxmlsetups xml:setups:instance
-   \xmlatt{#1}{value}\enspace
+   \xmlatt{#1}{value}\enskip
\stopxmlsetups

Wolfgang

From luigi.scarso at gmail.com  Mon Oct 10 13:54:23 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Mon, 10 Oct 2016 13:54:23 +0200
Subject: [dev-context] bad i-common-value.xml
Message-ID: <CAG5iGsBkLBHLYr6m=tMCCepZYgJWREmR7HYKA=RW-KyUG4x7iw@mail.gmail.com>

tex/texmf-context/tex/context/interface/mkiv$ xmllint *.xml >/dev/null
i-common-value.xml:14: parser error : Opening and ending tag mismatch:
parameter line 10 and define
    </cd:define>
                ^
i-common-value.xml:577: parser error : Opening and ending tag
mismatch: define line 9 and interface
</cd:interface>
               ^
i-common-value.xml:578: parser error : Premature end of data in tag
interface line 5

-- 
luigi

From luigi.scarso at gmail.com  Mon Oct 10 14:02:52 2016
From: luigi.scarso at gmail.com (luigi scarso)
Date: Mon, 10 Oct 2016 14:02:52 +0200
Subject: [dev-context] bad i-common-value.xml
In-Reply-To: <CAG5iGsBkLBHLYr6m=tMCCepZYgJWREmR7HYKA=RW-KyUG4x7iw@mail.gmail.com>
References: <CAG5iGsBkLBHLYr6m=tMCCepZYgJWREmR7HYKA=RW-KyUG4x7iw@mail.gmail.com>
Message-ID: <CAG5iGsAnMucT7OA=z93Pdj0cmuSwfYWq=6XLkS_sZ5LZvGJNJA@mail.gmail.com>

On Mon, Oct 10, 2016 at 1:54 PM, luigi scarso <luigi.scarso at gmail.com> wrote:
> tex/texmf-context/tex/context/interface/mkiv$ xmllint *.xml >/dev/null
> i-common-value.xml:14: parser error : Opening and ending tag mismatch:
> parameter line 10 and define
>     </cd:define>
>                 ^
> i-common-value.xml:577: parser error : Opening and ending tag
> mismatch: define line 9 and interface
> </cd:interface>
>                ^
> i-common-value.xml:578: parser error : Premature end of data in tag
> interface line 5
>
> --
> luigi

$ diff -u i-common-value.xml.wrong i-common-value.xml
--- i-common-value.xml.wrong 2016-10-10 14:01:57.270898721 +0200
+++ i-common-value.xml 2016-10-10 14:01:06.106900873 +0200
@@ -7,7 +7,7 @@
     <!-- backgrounds-->

     <cd:define name="value-background">
-        <cd:parameter name="background">
+        <cd:parameter name="background"/>
         <cd:constant type="foreground"/>
         <cd:constant type="color"/>
         <cd:constant type="cd:name"/>


-- 
luigi

From schuster.wolfgang at gmail.com  Mon Oct 10 17:43:15 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Mon, 10 Oct 2016 17:43:15 +0200
Subject: [dev-context] bad i-common-value.xml
In-Reply-To: <CAG5iGsBkLBHLYr6m=tMCCepZYgJWREmR7HYKA=RW-KyUG4x7iw@mail.gmail.com>
References: <CAG5iGsBkLBHLYr6m=tMCCepZYgJWREmR7HYKA=RW-KyUG4x7iw@mail.gmail.com>
Message-ID: <57FBB713.8000009@gmail.com>

> luigi scarso <mailto:luigi.scarso at gmail.com>
> 10. Oktober 2016 um 13:54
> tex/texmf-context/tex/context/interface/mkiv$ xmllint *.xml >/dev/null
> i-common-value.xml:14: parser error : Opening and ending tag mismatch:
> parameter line 10 and define
> </cd:define>
> ^
> i-common-value.xml:577: parser error : Opening and ending tag
> mismatch: define line 9 and interface
> </cd:interface>
> ^
> i-common-value.xml:578: parser error : Premature end of data in tag
> interface line 5

Already fixed in the last beta from 2016.10.08.

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20161010/ba02dfd4/attachment.html>

From schuster.wolfgang at gmail.com  Wed Oct 12 22:08:33 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Wed, 12 Oct 2016 22:08:33 +0200
Subject: [dev-context] x-setups-basics.mkiv
Message-ID: <57FE9841.3010201@gmail.com>

Hi,

grouping is necessary to keep \ttbf local.

\startxmlsetups xml:setups:typeset:line
+   \bgroup
     \ttbf
     \nohyphens
     \xmlsetup{#1}{xml:setups:make:prepare}
     \directsetup{xml:setups:make:start}
     \xmldoif{#1}{/arguments} {
         \bgroup
             \settrue\c_cmd_doing_line
             \global\c_cmd_current_argument\zerocount
             \ignorespaces
             \xmlfilter{#1}{/arguments/text()}
         \egroup
     }
     \directsetup{xml:setups:make:stop}
+   \egroup
\stopxmlsetups

Wolfgang

From schuster.wolfgang at gmail.com  Wed Oct 12 23:46:09 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Wed, 12 Oct 2016 23:46:09 +0200
Subject: [dev-context] m-chart.lua
Message-ID: <57FEAF21.1020101@gmail.com>

Hi,

not sure of this is correct.

local function process_texts(chart,xoffset,yoffset)
     local data = chart.data
     local hash = chart.hash
     if not data then
         return
     end
     charttexts = { }
     for i=1,#data do
         local cell = visible(chart,data[i])
         if cell then
             local x           = cell.x or 1
             local y           = cell.y or 1
             local figure      = cell.figure or ""
             local overlay     = cell.overlay or ""
             local destination = cell.destination or ""
             local texts       = cell.texts
             local noftexts    = #texts
             if noftexts > 0 then
                 for i=1,noftexts do
                     local text  = texts[i]
                     local data  = text.text
                     local align = text.align or ""
-                   local align = validlabellocations[align] or align
+                   local align = validtextlocations[align] or align
                     charttexts[#charttexts+1] = data
                     context('flow_chart_draw_text(%s,%s,textext("%s")) 
;',x,y,f_texttemplate_t(x,y,#charttexts,align,figure,overlay,destination))
                     if i == 1 then
                         figure      = ""
                         overlay     = ""
                         destination = ""
                     end
                 end
             elseif figure ~= "" or overlay ~= "" or destination ~= "" then
                 [...]
             end
         end
     end
end

Wolfgang

From schuster.wolfgang at gmail.com  Thu Oct 13 12:58:16 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 13 Oct 2016 12:58:16 +0200
Subject: [dev-context] m-hemistich.mkiv
Message-ID: <57FF68C8.9080106@gmail.com>

Hi,

\appendtoks
-   \setvalue{\currenthemistich}{\dohemistiches{\currenthemistich}}%
+   \setuevalue{\currenthemistich}{\hemistiches[\currenthemistich]}%
\to \everydefinehemistich

Wolfgang

From schuster.wolfgang at gmail.com  Sat Oct 15 11:15:14 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 15 Oct 2016 11:15:14 +0200
Subject: [dev-context] m-visual.mkiv
Message-ID: <5801F3A2.4010507@gmail.com>

Hi,

the scale values need a 0 before the decimal point.

\unexpanded\def\bodyfontgrid
   {\hpack
-    {{\linewidth.1pt\yellow\smashedgrid[\c!nx=30,\c!ny=30,\c!scale=.3333]}%
+    
{{\linewidth.1pt\yellow\smashedgrid[\c!nx=30,\c!ny=30,\c!scale=0.3333]}%
-     {\linewidth.2pt\green \smashedgrid[\c!nx=20,\c!ny=20,\c!scale=.5]}%
+     {\linewidth.2pt\green \smashedgrid[\c!nx=20,\c!ny=20,\c!scale=0.5]}%
       {\linewidth.3pt\red   \smashedgrid[\c!nx=10,\c!ny=10,\c!scale=1]}}}

Wolfgang

From schuster.wolfgang at gmail.com  Sun Oct 16 17:52:54 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sun, 16 Oct 2016 17:52:54 +0200
Subject: [dev-context] x-setups-basics.mkiv
Message-ID: <5803A256.1020308@gmail.com>

Hi,

\startxmlsetups xml:setups:inherit
%     \cmd_column_two_start{}{}
         \rawsetupstring{cd:inherits}:
         \enspace
         \letterbackslash
         \xmlatt{#1}{name}
+       \par
%     \cmd_column_two_stop
     \ignorespaces
\stopxmlsetups

Wolfgang

From schuster.wolfgang at gmail.com  Sat Oct 22 15:39:37 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 22 Oct 2016 15:39:37 +0200
Subject: [dev-context] strc-tag.lua
Message-ID: <580B6C19.2020300@gmail.com>

Hi,

function tags.start(tag,specification)
     if not enabled then
         codeinjections.enabletags()
         enabled = true
     end
     --
     labels[tag] = tag -- can go away
     --
     local attribute = #taglist + 1
     local tagindex  = (ids[tag] or 0) + 1
     --
     local completetag = tag .. ">" .. tagindex
     --
     ids[tag]      = tagindex
     lasttags[tag] = tagindex
     stacksize     = stacksize + 1
     --
     chain[stacksize] = completetag
     stack[stacksize] = attribute
     tagcontext[tag]  = completetag
     --
     local tagnesting = { unpack(chain,1,stacksize) } -- a copy so we 
can add actualtext
     --
     if specification then
         specification.attribute = attribute
         specification.tagindex  = tagindex
         specification.taglist   = tagnesting
         specification.tagname   = tag
         if metadata then
             specification.metadata = metadata
             metadata = nil
         end
         local userdata = specification.userdata
-       if user ~= "" and type(userdata) == "string"  then
+       if userdata ~= "" and type(userdata) == "string"  then
             specification.userdata = settings_to_hash(userdata)
         end
         local detail = specification.detail
         if detail == "" then
             specification.detail = nil
         end
         local parents = specification.parents
         if parents == "" then
             specification.parents = nil
         end
     else
         specification = {
             attribute = attribute,
             tagindex  = tagindex,
             taglist   = tagnesting,
             tagname   = tag,
             metadata  = metadata,
         }
         metadata = nil
     end
     --
     taglist[attribute]          = specification
     specifications[completetag] = specification
     --
     if completetag == "document>1" then
         specification.metadata = documentdata
     end
     --
     texattribute[a_tagged] = attribute
     return attribute
end

Wolfgang

From schuster.wolfgang at gmail.com  Thu Oct 27 14:19:11 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Thu, 27 Oct 2016 14:19:11 +0200
Subject: [dev-context] lang-def.mkiv
Message-ID: <5811F0BF.4070400@gmail.com>

Hi,

the quotation marks for greek have to be fixed because \greekleftquot 
doesnât exist in MkIV.

I changed also the symbols from (( to Â« which is shown on wikipedia.

\installlanguage
   [\s!gr]
   [\c!spacing=\v!packed,
    \c!leftsentence=\emdash,
    \c!rightsentence=\emdash,
    \c!leftsubsentence=\emdash,
    \c!rightsubsentence=\emdash,
-  \c!leftquote=\greekleftquot,
-  \c!rightquote=\greekrightquot,
-  \c!leftquotation=\greekleftquot,
-  \c!rightquotation=\greekrightquot,
+  \c!leftquote=â,
+  \c!rightquote=â,
+  \c!leftquotation=Â«,
+  \c!rightquotation=Â»,
    \c!date={\v!day\space\v!month\space\v!year},
    \s!patterns=\s!agr] % ok?

Wolfgang

From schuster.wolfgang at gmail.com  Fri Nov  4 13:31:14 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Fri, 04 Nov 2016 13:31:14 +0100
Subject: [dev-context] strc-con.mkvi: referenceprefix
Message-ID: <581C7F92.2090204@gmail.com>

Hi Hans,

can you enable the referenceprefix key for enumerations/descriptions:

strc-con.mkvi:

@@ -914,6 +914,10 @@
       \global\let\currentconstructionexpansion\v!no
     \fi
     %
+   \ifx\currentconstructionreferenceprefix\empty
+     \global\let\currentconstructionreferenceprefix\referenceprefix
+   \fi
+   %
     \ifx\currentconstructionexpansion\s!xml
       \xmlstartraw
         \xdef\currentconstructiontitle   {\constructionparameter\c!title}%
@@ -972,7 +976,7 @@
              internal  \nextinternalreference
              order     \nextinternalorderreference
              reference {\currentconstructionreference}
-            prefix    {\referenceprefix}
+            prefix    {\currentconstructionreferenceprefix}
            % block     {\currentsectionblock}
            % section   structures.sections.currentid(),
          }


Wolfgang

From schuster.wolfgang at gmail.com  Sat Nov  5 14:49:08 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 05 Nov 2016 14:49:08 +0100
Subject: [dev-context] strc-con.mkvi: Unwanted vertical space
Message-ID: <581DE354.5050405@gmail.com>

Hi,

the \nobreak command after \p_strc_constructions_inbetween in the top 
alternative inserts a unwanted parskip.


strc-con.mkvi:

\startsetups[\??constructionrenderings:\v!top]
     \strc_sectioning_prevent_page_break\plusone
     \let\\=\space
     \noindent
     \copy\constructionheadbox % why copy ?
     \par
     \nobreak
     
\edef\p_strc_constructions_inbetween{\constructionparameter\c!inbetween}%
     \ifx\p_strc_constructions_inbetween\empty \else
       \p_strc_constructions_inbetween
       \par
       \nobreak
     \fi
     \useconstructionstyleandcolor\c!style\c!color
     \ignorespaces
\stopsetups


%% begin example
\definedescription
   [testdescription]
   [alternative=top,
    inbetween=\nowhitespace,
    title=yes]

\setupwhitespace[2cm]

\starttext

\starttestdescription{Ward}
\input ward
\stoptestdescription

\stoptext
%% end example


Wolfgang

From pragma at wxs.nl  Sat Nov  5 19:17:59 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 5 Nov 2016 19:17:59 +0100
Subject: [dev-context] strc-con.mkvi: Unwanted vertical space
In-Reply-To: <581DE354.5050405@gmail.com>
References: <581DE354.5050405@gmail.com>
Message-ID: <0d0da54c-f27b-636a-1712-3c931e902d84@wxs.nl>

On 11/5/2016 2:49 PM, Wolfgang Schuster wrote:
> Hi,
>
> the \nobreak command after \p_strc_constructions_inbetween in the top
> alternative inserts a unwanted parskip.

so maybe

 >     \par
 >     \nobreak

can be

       \directcheckedvspacing\v!samepage


> strc-con.mkvi:
>
> \startsetups[\??constructionrenderings:\v!top]
>     \strc_sectioning_prevent_page_break\plusone
>     \let\\=\space
>     \noindent
>     \copy\constructionheadbox % why copy ?
>     \par
>     \nobreak
>
> \edef\p_strc_constructions_inbetween{\constructionparameter\c!inbetween}%
>     \ifx\p_strc_constructions_inbetween\empty \else
>       \p_strc_constructions_inbetween
>       \par
>       \nobreak
>     \fi
>     \useconstructionstyleandcolor\c!style\c!color
>     \ignorespaces
> \stopsetups
>
>
> %% begin example
> \definedescription
>   [testdescription]
>   [alternative=top,
>    inbetween=\nowhitespace,
>    title=yes]
>
> \setupwhitespace[2cm]
>
> \starttext
>
> \starttestdescription{Ward}
> \input ward
> \stoptestdescription
>
> \stoptext
> %% end example
>
>
> Wolfgang
> _______________________________________________
> dev-context mailing list
> dev-context at ntg.nl
> https://mailman.ntg.nl/mailman/listinfo/dev-context


-- 

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
        tel: 038 477 53 69 | www.pragma-ade.nl | www.pragma-pod.nl
-----------------------------------------------------------------

From schuster.wolfgang at gmail.com  Sat Nov  5 19:30:20 2016
From: schuster.wolfgang at gmail.com (Wolfgang Schuster)
Date: Sat, 05 Nov 2016 19:30:20 +0100
Subject: [dev-context] strc-con.mkvi: Unwanted vertical space
In-Reply-To: <0d0da54c-f27b-636a-1712-3c931e902d84@wxs.nl>
References: <581DE354.5050405@gmail.com>
 <0d0da54c-f27b-636a-1712-3c931e902d84@wxs.nl>
Message-ID: <581E253C.3010700@gmail.com>

> Hans Hagen <mailto:pragma at wxs.nl>
> 5. November 2016 um 19:17
> On 11/5/2016 2:49 PM, Wolfgang Schuster wrote:
>> Hi,
>>
>> the \nobreak command after \p_strc_constructions_inbetween in the top
>> alternative inserts a unwanted parskip.
>
> so maybe
>
> >     \par
> >     \nobreak
>
> can be
>
>       \directcheckedvspacing\v!samepage
Yes, this works.

Wolfgang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://mailman.ntg.nl/pipermail/dev-context/attachments/20161105/6489fd05/attachment.html>

From wolfgang.schuster at gmail.com  Wed Nov  9 16:46:45 2016
From: wolfgang.schuster at gmail.com (Wolfgang Schuster)
Date: Wed, 09 Nov 2016 16:46:45 +0100
Subject: [dev-context] \definefontsize changes definition of \tf
Message-ID: <582344E5.5080902@gmail.com>

Hi,

the \definefontsize and \definefontalternative redefine the \tf (and \it 
etc.) command and you canât use it in math to get \mathtf.

\starttext

\begingroup
\meaning\tf
\endgroup

\begingroup
\definefontsize[e]
\meaning\tf
\endgroup

\begingroup
\definefontalternative[md]
\meaning\tf
\endgroup

\stoptext

Wolfgang

From pragma at wxs.nl  Thu Nov 10 13:19:58 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 10 Nov 2016 13:19:58 +0100
Subject: [dev-context] \definefontsize changes definition of \tf
In-Reply-To: <582344E5.5080902@gmail.com>
References: <582344E5.5080902@gmail.com>
Message-ID: <193ee390-9aeb-244e-8fd5-436fedeb79d7@wxs.nl>

On 11/9/2016 4:46 PM, Wolfgang Schuster wrote:
> Hi,
>
> the \definefontsize and \definefontalternative redefine the \tf (and \it
> etc.) command and you canât use it in math to get \mathtf.
>
> \starttext
>
> \begingroup
> \meaning\tf
> \endgroup
>
> \begingroup
> \definefontsize[e]
> \meaning\tf
> \endgroup
>
> \begingroup
> \definefontalternative[md]
> \meaning\tf
> \endgroup
>
> \stoptext

possible fix in next beta


% \def\font_basics_check_text_bodyfont#style#alternative#size% size can 
be empty (checking needed as \bf is already defined)
% 
{\setugvalue{#style#size}{\font_helpers_set_current_font_style_size{#style}{#size}}% 
\rma
% 
\setugvalue{#alternative#size}{\font_helpers_set_current_font_alternative_size{#alternative}{#size}}% 
\sla
% 
\setugvalue{#style#alternative#size}{\font_helpers_set_current_font_style_alternative_size{#style}{#alternative}{#size}}% 
\rmsla
%    \ifcsname\s!normal#style\endcsname % text/math check
% 
\expandafter\let\csname#style\expandafter\endcsname\csname\s!normal#style\endcsname
%    \else
% 
\setugvalue{#style}{\font_helpers_set_current_font_style{#style}}% \rm
%    \fi
%    \ifcsname\s!normal#alternative\endcsname % text/math check
% 
\expandafter\let\csname#alternative\expandafter\endcsname\csname\s!normal#alternative\endcsname
%    \else
% 
\setugvalue{#alternative}{\font_helpers_set_current_font_alternative{#alternative}}% 
\sl
%    \fi
% 
\setugvalue{#style\s!x}{\font_helpers_set_current_font_x_style_alternative{#style}}% 
\rmx
% 
\setugvalue{#style\s!xx}{\font_helpers_set_current_font_xx_style_alternative{#style}}% 
\rmxx
% 
\setugvalue{#alternative\s!x}{\font_helpers_set_current_font_x_alternative{#alternative}}% 
\slx
% 
\setugvalue{#alternative\s!xx}{\font_helpers_set_current_font_xx_alternative{#alternative}}% 
\slxx
% 
\setugvalue{#style#alternative}{\font_helpers_set_current_font_style_alternative{#style}{#alternative}}}% 
\rmsl

% \def\font_basics_check_text_bodyfont#style#alternative#size% size can 
be empty (checking needed as \bf is already defined)
%   {\ifcsname#style#size\endcsname\else
% 
\setugvalue{#style#size}{\font_helpers_set_current_font_style_size{#style}{#size}}% 
\rma
%    \fi
%    \ifcsname#alternative#size\endcsname\else
% 
\setugvalue{#alternative#size}{\font_helpers_set_current_font_alternative_size{#alternative}{#size}}% 
\sla
%    \fi
%    \ifcsname#style#alternative#size\endcsname\else
% 
\setugvalue{#style#alternative#size}{\font_helpers_set_current_font_style_alternative_size{#style}{#alternative}{#size}}% 
\rmsla
%    \fi
%    \ifcsname#style\endcsname\else
% 
\setugvalue{#style}{\font_helpers_set_current_font_style{#style}}% \rm
%    \fi
%    \ifcsname#alternative\endcsname\else
% 
\setugvalue{#alternative}{\font_helpers_set_current_font_alternative{#alternative}}% 
\sl
%    \fi
%    \ifcsname#style\s!x\endcsname\else
%      \setugvalue{#style\s!x 
}{\font_helpers_set_current_font_x_style_alternative{#style}}% \rmx
% 
\setugvalue{#style\s!xx}{\font_helpers_set_current_font_xx_style_alternative{#style}}% 
\rmxx
%    \fi
%    \ifcsname#alternative\s!x\endcsname\else
%      \setugvalue{#alternative\s!x 
}{\font_helpers_set_current_font_x_alternative{#alternative}}% \slx
% 
\setugvalue{#alternative\s!xx}{\font_helpers_set_current_font_xx_alternative{#alternative}}% 
\slxx
%    \fi
%    \ifcsname#style#alternative\endcsname\else
% 
\setugvalue{#style#alternative}{\font_helpers_set_current_font_style_alternative{#style}{#alternative}}% 
\rmsl
%    \fi}

\def\font_basics_check_text_bodyfont_step#whatever#body% size can be 
empty (checking needed as \bf is already defined)
   {\ifcsname#whatever\endcsname\else
      \setugvalue{#whatever}{#body}%
    \fi}

\def\font_basics_check_text_bodyfont#style#alternative#size% size can be 
empty (checking needed as \bf is already defined)
 
{\font_basics_check_text_bodyfont_step{#style#size}{\font_helpers_set_current_font_style_size{#style}{#size}}% 
\rma
 
\font_basics_check_text_bodyfont_step{#alternative#size}{\font_helpers_set_current_font_alternative_size{#alternative}{#size}}% 
\sla
 
\font_basics_check_text_bodyfont_step{#style#alternative#size}{\font_helpers_set_current_font_style_alternative_size{#style}{#alternative}{#size}}% 
\rmsla
 
\font_basics_check_text_bodyfont_step{#style}{\font_helpers_set_current_font_style{#style}}% 
\rm
 
\font_basics_check_text_bodyfont_step{#alternative}{\font_helpers_set_current_font_alternative{#alternative}}% 
\sl
    \font_basics_check_text_bodyfont_step{#style\s!x 
}{\font_helpers_set_current_font_x_style_alternative{#style}}% \rmx
 
\font_basics_check_text_bodyfont_step{#style\s!xx}{\font_helpers_set_current_font_xx_style_alternative{#style}}% 
\rmxx
    \font_basics_check_text_bodyfont_step{#alternative\s!x 
}{\font_helpers_set_current_font_x_alternative{#alternative}}% \slx
 
\font_basics_check_text_bodyfont_step{#alternative\s!xx}{\font_helpers_set_current_font_xx_alternative{#alternative}}% 
\slxx
 
\font_basics_check_text_bodyfont_step{#style#alternative}{\font_helpers_set_current_font_style_alternative{#style}{#alternative}}}% 
\rmsl



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
        tel: 038 477 53 69 | www.pragma-ade.nl | www.pragma-pod.nl
-----------------------------------------------------------------

From lh at sdu.se  Tue Nov 15 17:01:52 2016
From: lh at sdu.se (Lars Hamren)
Date: Tue, 15 Nov 2016 17:01:52 +0100
Subject: [dev-context] Installing old version of context
Message-ID: <582B3170.7060605@sdu.se>

Hi,

My reference installation of context is from 2016-09-18.

Suddenly it has stopped working.

When I try to rebuild the formats (--make) it cant find context.lua.

I have traced system calls, and it does not look in the right directories.

If I copy mtx-context.lua to ./context.lua then it works.

Other installations do work. According to Murphys Law, it is only the
really important one that has stopped working.

It must be something that I have done. But what?

I have compared directory trees from about the seame time, but not found anything that motivates this failure.
The best thing would be to have the original tree from that date, but I don't have a copy.

All of the above is just background. Here comes the question:

Is there a way that I can install context as it would have been
installed on a given date? I mean all of context, not just the binaries.

/Lars

From lh at sdu.se  Thu Nov 17 15:35:33 2016
From: lh at sdu.se (Lars Hamren)
Date: Thu, 17 Nov 2016 15:35:33 +0100
Subject: [dev-context] Installing old version of context
In-Reply-To: <582B3170.7060605@sdu.se>
References: <582B3170.7060605@sdu.se>
Message-ID: <582DC035.8050401@sdu.se>

Bump.

Surely someone knows.

/Lars

From alan.braslau at cea.fr  Thu Nov 17 16:31:56 2016
From: alan.braslau at cea.fr (Alan Braslau)
Date: Thu, 17 Nov 2016 08:31:56 -0700
Subject: [dev-context] Installing old version of context
In-Reply-To: <582DC035.8050401@sdu.se>
References: <582B3170.7060605@sdu.se> <582DC035.8050401@sdu.se>
Message-ID: <CDE77C49-674B-47FD-BB61-2C8CA600B70A@cea.fr>

You should address your question to the ConTeXt (users) mailing list.

A simple answer is that the standalone distribution is organized so that one can keep a full copy per project or per period, thus assuring that one retains a fully functional version independent of rapid development.

Alan

> On 17 Nov 2016, at 07:35, Lars Hamren <lh at sdu.se> wrote:
> 
> Bump.
> 
> Surely someone knows.
> 
> /Lars


From taco at elvenkind.com  Fri Nov 18 09:27:25 2016
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 18 Nov 2016 09:27:25 +0100
Subject: [dev-context] Installing old version of context
In-Reply-To: <582E436C.40806@sdu.se>
References: <582B3170.7060605@sdu.se> <582DC035.8050401@sdu.se>
 <CDE77C49-674B-47FD-BB61-2C8CA600B70A@cea.fr> <582E040A.4080800@sdu.se>
 <e2355c87-1bc8-a2b3-be4e-ef9e58939ab8@wxs.nl> <582E436C.40806@sdu.se>
Message-ID: <BF0A5F29-DC89-44B9-BB5E-2450646C236B@elvenkind.com>

Hi,

> On 18 Nov 2016, at 00:55, Lars Hamren <lh at sdu.se> wrote:
> 
> 
> Hi,
> 
> > i'm not sure if there are zips on the garden
> 
> Not that I can find.

There are old zips at http://context.aanhet.net/ , but there was no easy access 
to them until now.  I just added that, and the archived zips from pragma-ade.com
are now all below this directory: 

   http://context.aanhet.net/archives/

Folder names are based on the time of mirroring. Note that I occasionally 
weed out duplicate mirrored files, only keeping the oldest one, so old folders
sometimes are not a complete mirror of http://www.pragma-ade.com/context/ ,
you may have to go back a few archives to get a full set of zip files.

Those zip files are also only the content of texmf-context, though. 

> 
> >> I'm sorry, but that does not answer my question. Can I install
> >> a version from a certain date (Ã  la version control), and if so, how?
> >
> > https://bitbucket.org/phg/context-mirror.git
> 
> Thanks. Unfortunately it only contains the files from tex/texmf-context,
> not e.g. the bin directories.
> 
> /Lars
> _______________________________________________
> dev-luatex mailing list
> dev-luatex at ntg.nl
> https://mailman.ntg.nl/mailman/listinfo/dev-luatex

Taco Hoekwater
Elvenkind BV





From lh at sdu.se  Fri Nov 18 19:55:12 2016
From: lh at sdu.se (Lars Hamren)
Date: Fri, 18 Nov 2016 19:55:12 +0100
Subject: [dev-context] Installing old version of context
In-Reply-To: <BF0A5F29-DC89-44B9-BB5E-2450646C236B@elvenkind.com>
References: <582B3170.7060605@sdu.se> <582DC035.8050401@sdu.se>
 <CDE77C49-674B-47FD-BB61-2C8CA600B70A@cea.fr> <582E040A.4080800@sdu.se>
 <e2355c87-1bc8-a2b3-be4e-ef9e58939ab8@wxs.nl> <582E436C.40806@sdu.se>
 <BF0A5F29-DC89-44B9-BB5E-2450646C236B@elvenkind.com>
Message-ID: <582F4E90.90100@sdu.se>

Hi,

> There are old zips athttp://context.aanhet.net/  , but there was no easy access
> to them until now.  I just added that, and the archived zips from pragma-ade.com
> are now all below this directory:
>
>     http://context.aanhet.net/archives/

Thank you for you effort!

I removed the contents of tex/texmf-context/, unpacked cont-tmf.zip from
http://context.aanhet.net/archives/context-2016-09-20.22/, restored the
two bin directories (I did have copies of them) and then ran:

     mtxrun --script context --autogenerate --make

After a while I got this error:

     open source     > level 1, order 282, name '/usr/local/prog/context/context-2016-09-15/tex/texmf-context/tex/context/base/mkiv/node-rul.mkiv'
     loading         : ConTeXt Core Macros / Bars

     lua error       > lua error on line 74 in file /usr/local/prog/context/context-2016-09-15/tex/texmf-context/tex/context/base/mkiv/node-rul.mkiv:

     ...-15/tex/texmf-context/tex/context/base/mkiv/node-rul.lua:420: table index is nil
     stack traceback:
             ...-15/tex/texmf-context/tex/context/base/mkiv/node-rul.lua:420: in function 'code'
             ...-15/tex/texmf-context/tex/context/base/mkiv/util-lua.lua:84: in function 'loadedluacode'
             ...-15/tex/texmf-context/tex/context/base/mkiv/luat-env.lua:104: in function 'luafilechunk'
             ...-15/tex/texmf-context/tex/context/base/mkiv/luat-cod.lua:45: in function 'registercode'
             [ctxlua]:1: in main chunk

     64     %D to deal with local settings at the \TEX\ end and remembering parameters
     65     %D at the \LUA\ end. We might do things differently now, but as settings normally
     66     %D don't change that often, we're not in a hurry to do that now. The problem at
     67     %D the \LUA\ end is that we don't know when to clean up.
     68
     69     \unprotect
     70
     71     %definesystemattribute[ruled]
     72     %definesystemattribute[shifted]
     73
     74 >>  \registerctxluafile{node-rul}{1.001}
     75
     76     \installcorenamespace{bar}
     77     \installcorenamespace{barindex}
     78     \installcorenamespace{barattribute}
     79     \installcorenamespace{barstack}
     80
     81     \installcommandhandler \??bar {bar} \??bar
     82
     83     \newtoks\t_node_rules_checklist

Luatex presents itself as

     This is LuaTeX, Version 0.98.3 (TeX Live 2017/dev)  (INITEX)

I have started working on making my code work with the latest
context installation. Hopefully there are not too many big changes.

/Lars

-- 
-------------------------------------------------------------------
Lars HamrÃ©n              WWW...: www.sdu.se
Svensk Datorutveckling   Email.: lh at sdu.se
VadmÃ¶llan 211            Mobile: +46(705)189090
S-225 94 Lund
Sweden

From pragma at wxs.nl  Fri Nov 18 23:14:28 2016
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 18 Nov 2016 23:14:28 +0100
Subject: [dev-context] Installing old version of context
In-Reply-To: <582F4E90.90100@sdu.se>
References: <582B3170.7060605@sdu.se> <582DC035.8050401@sdu.se>
 <CDE77C49-674B-47FD-BB61-2C8CA600B70A@cea.fr> <582E040A.4080800@sdu.se>
 <e2355c87-1bc8-a2b3-be4e-ef9e58939ab8@wxs.nl> <582E436C.40806@sdu.se>
 <BF0A5F29-DC89-44B9-BB5E-2450646C236B@elvenkind.com> <582F4E90.90100@sdu.se>
Message-ID: <85026df5-e37d-3473-7a41-b7b3caf3898a@wxs.nl>

On 11/18/2016 7:55 PM, Lars Hamren wrote:
> Hi,
>
>> There are old zips athttp://context.aanhet.net/  , but there was no
>> easy access
>> to them until now.  I just added that, and the archived zips from
>> pragma-ade.com
>> are now all below this directory:
>>
>>     http://context.aanhet.net/archives/
>
> Thank you for you effort!
>
> I removed the contents of tex/texmf-context/, unpacked cont-tmf.zip from
> http://context.aanhet.net/archives/context-2016-09-20.22/, restored the
> two bin directories (I did have copies of them) and then ran:
>
>     mtxrun --script context --autogenerate --make
>
> After a while I got this error:
>
>     open source     > level 1, order 282, name
> '/usr/local/prog/context/context-2016-09-15/tex/texmf-context/tex/context/base/mkiv/node-rul.mkiv'
>
>     loading         : ConTeXt Core Macros / Bars
>
>     lua error       > lua error on line 74 in file
> /usr/local/prog/context/context-2016-09-15/tex/texmf-context/tex/context/base/mkiv/node-rul.mkiv:
>
>
>     ...-15/tex/texmf-context/tex/context/base/mkiv/node-rul.lua:420:
> table index is nil
>     stack traceback:
>
> ...-15/tex/texmf-context/tex/context/base/mkiv/node-rul.lua:420: in
> function 'code'
>
> ...-15/tex/texmf-context/tex/context/base/mkiv/util-lua.lua:84: in
> function 'loadedluacode'
>
> ...-15/tex/texmf-context/tex/context/base/mkiv/luat-env.lua:104: in
> function 'luafilechunk'
>
> ...-15/tex/texmf-context/tex/context/base/mkiv/luat-cod.lua:45: in
> function 'registercode'
>             [ctxlua]:1: in main chunk
>
>     64     %D to deal with local settings at the \TEX\ end and
> remembering parameters
>     65     %D at the \LUA\ end. We might do things differently now, but
> as settings normally
>     66     %D don't change that often, we're not in a hurry to do that
> now. The problem at
>     67     %D the \LUA\ end is that we don't know when to clean up.
>     68
>     69     \unprotect
>     70
>     71     %definesystemattribute[ruled]
>     72     %definesystemattribute[shifted]
>     73
>     74 >>  \registerctxluafile{node-rul}{1.001}
>     75
>     76     \installcorenamespace{bar}
>     77     \installcorenamespace{barindex}
>     78     \installcorenamespace{barattribute}
>     79     \installcorenamespace{barstack}
>     80
>     81     \installcommandhandler \??bar {bar} \??bar
>     82
>     83     \newtoks\t_node_rules_checklist
>
> Luatex presents itself as
>
>     This is LuaTeX, Version 0.98.3 (TeX Live 2017/dev)  (INITEX)
>
> I have started working on making my code work with the latest
> context installation. Hopefully there are not too many big changes.

the current version is ok for luatex 1.0 .. there have been a few 
changes as part of finalizing 1.0 but not that many


Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
        tel: 038 477 53 69 | www.pragma-ade.nl | www.pragma-pod.nl
-----------------------------------------------------------------

From saso.zivanovic at guest.arnes.si  Tue Dec 27 13:09:33 2016
From: saso.zivanovic at guest.arnes.si (=?UTF-8?B?U2HFoW8gxb1pdmFub3ZpxIc=?=)
Date: Tue, 27 Dec 2016 12:09:33 -0000
Subject: [dev-context] local allocation in ConTeXt
Message-ID: <59f5f1dc-fb4b-5d2e-ca00-e870c6bfaa5a@guest.arnes.si>

Hi!

I'm the author of a PGF/TikZ-based LaTeX package Forest for drawing 
(linguistic) trees. I have received several requests to support ConTexT 
and I'm trying to do that now.

Forest uses a lot of \boxes. Actually, the number of boxes used cannot 
be known in advance, as it depends on the document. Here's why: Forest's 
main job is to place the nodes of a tree so that they don't overlap and 
to do that, it needs to first typeset the individual nodes and measure 
them. The typeset nodes are kept around and later used when typesetting 
the entire tree.

There are three reasons for keeping the typeset nodes, and not 
typesetting them again as part of the entire tree. First (at least 
historically): performance. Second: there is no guarantee that running 
the same code twice will result in the same box. Third: changing this 
now would break compatibility.

The typeset nodes are kept in "local" boxes. They are created using 
\locbox, which is defined either by plain eTeX format or package 
elocalloc.sty for LaTeX >2015. (Prior to LaTeX 2015, \locbox was defined 
in etex.sty.) elocalloc.sty's \locbox is somewhat broken, but still 
works, mainly because it seems no other package is using local 
allocation. ;-)

Using normal, "global" boxes, created by \newbox, would be bad. If a 
\newbox was simply executed for each new node, the number of used boxes 
would remain increased even after Forest was done with a tree, so in a 
document with lots of big trees, the upper limit of 32000+ could 
actually be hit. An alternative approach would be to track and reuse 
boxes which were created by \newbox by are not used anymore. But 
implementing such a tracking mechanism seems quite complicated, and 
besides, it would not be perfect: after exiting the TeX group where the 
tree is drawn, the allocated boxes would persist. (So, from the outside 
perspective, Forest's box usage in the entire document would equal the 
box usage of the largest tree.)

The approach taken in the implementation of \locbox seems quite 
appealing in its simplicity: The local boxes (counts etc) are allocated 
"from the top" (starting at 32767 and going down) and all the \chardefs 
and allocation register changes are local (i.e. not \global). A bit of 
care to prevent clashes with global allocation "from the bottom", and 
that's it.

I've studied the allocation mechanism of ConTeXt --- but note that I'm 
new to ConTeXt! ---  and it seems that I'd know how to implement 
\loc<thing>s using "from the top" approach, but there are two, or rather 
three, problems. (I took a look at both MKII and MKIV, but the changes 
seemed mostly cosmetic, so I concentrated on MKIV.)

1. I'm not sure how happy ConTeXt were if I changed the value of 
\c_syst_max_allocated_register.  The name seems to imply it should be 
constant.

2. Simply decreasing \c_syst_max_allocated_register would while doing a 
\locbox would also decrease the upper limit for, say, \loccount, as they 
use the same upper limit, i.e. \c_syst_max_allocated_register. A proper 
way would be to declare \c_syst_max_allocated_box_register etc. Again, I 
have no idea how such a change would impact other parts of the system. 
(Btw, elocalloc.sty's implementation, unlike the plain eTeX one, suffers 
from precisely this problem.)

3. It seems that, unlike in the messy LaTeX world, ConTeXt people like 
to do things The Right Way. ;-)  As making a change like this in a 
module is surely not The Right Way, I hope that ConTeXt developers can 
help me out here, either by implementing the local allocation (I'm happy 
to assist in any way) or by maybe suggesting an alternative approach. 
(Btw, if it helps, I guess a MKIV-only solution would be acceptable to 
most users.)

Thanks in advance,
SaÅ¡o Å½ivanoviÄ


