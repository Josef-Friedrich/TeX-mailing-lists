From root at mail.boekplan.nl  Tue Feb  1 12:29:11 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue,  1 Feb 2011 12:29:11 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110201112911.4816740060@mail.boekplan.nl>

------------------------------------------------------------------------
r4075 | hhenkel | 2011-01-31 23:57:41 +0100 (Mon, 31 Jan 2011) | 2 lines
Changed paths:
   A /branches/lua-obj (from /trunk:4074)

make branch from SVN 4074

------------------------------------------------------------------------
r4076 | hhenkel | 2011-02-01 00:19:58 +0100 (Tue, 01 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/lua/luastuff.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/luascripts/pdflua.lua
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pagetree.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pagetree.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdftypes.h

experimental scripted /Page & /Pages object handling

------------------------------------------------------------------------

From graham.douglas at readytext.co.uk  Tue Feb  1 20:21:44 2011
From: graham.douglas at readytext.co.uk (Graham Douglas)
Date: Tue, 01 Feb 2011 19:21:44 +0000
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
Message-ID: <4D485D48.8010201@readytext.co.uk>

Hi to all

Apologies in advance for the slightly off-topic nature of this
post. I've been reading about HarfBuzz which certainly looks to
be an interesting project. From the project page there is a link
to an article titled "State of Text Rendering" by Behdad Esfahbod

http://behdad.org/text/

Within that article is a section on TeX engines with a reference to
XeTeX and LuaTeX --- I'm just quoting a small bit of the article which
I hope is not too much out of context:

"The XeTeX creator is working on HarfBuzz on behalf of Mozilla now, and 
plans to port XeTeX to HarfBuzz eventually. In the long term though, 
pdfTeX's successor luaTeX should be made to do the same thing. There is 
more to Unicode support than just shaping, and in those areas the TeX 
engines can gain a lot by building on top of existing libraries."

At present my own understanding of the precise role that HarfBuzz could
play is a little sketch/hazy right now, but I'm working on that ;-). In 
the meantime I'd be interested to know if, in theory, HarfBuzz could be
usefully plugged into LuaTeX, such as via an external library 
(.so/.dll).From what I understand... HarfBuzz provides a shaping engine
so that, for example, it could provide useful services such as the bidi 
algorithm, and information that could be useful for typesetting complex
scripts such as Arabic. Again, I stress my currently incomplete 
understanding of the precise services HarfBuzz  would provide. lso,
how would you pass back to LuaTeX the results so that the LuaTeX engine
could use them?

If anyone could help me understand this a little more or indeed let me 
know if there really is nothing to explore that too would be good. I 
have not tried to compile HarfBuzz yet so have not played with it at 
all. I'm merely curious in light of the remarks on the HarfBuzz site.

Thank to anyone who can shed some light on this for me.

Cheers

Graham









From zappathustra at free.fr  Tue Feb  1 20:54:45 2011
From: zappathustra at free.fr (Paul Isambert)
Date: Tue, 01 Feb 2011 20:54:45 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <4D485D48.8010201@readytext.co.uk>
References: <4D485D48.8010201@readytext.co.uk>
Message-ID: <4D486505.7040605@free.fr>

Le 01/02/2011 20:21, Graham Douglas a ?crit :
> Hi to all
>
> Apologies in advance for the slightly off-topic nature of this
> post. I've been reading about HarfBuzz which certainly looks to
> be an interesting project. From the project page there is a link
> to an article titled "State of Text Rendering" by Behdad Esfahbod
>
> http://behdad.org/text/
>
> Within that article is a section on TeX engines with a reference to
> XeTeX and LuaTeX --- I'm just quoting a small bit of the article which
> I hope is not too much out of context:
>
> "The XeTeX creator is working on HarfBuzz on behalf of Mozilla now, 
> and plans to port XeTeX to HarfBuzz eventually. In the long term 
> though, pdfTeX's successor luaTeX should be made to do the same thing. 
> There is more to Unicode support than just shaping, and in those areas 
> the TeX engines can gain a lot by building on top of existing libraries."
>
> At present my own understanding of the precise role that HarfBuzz could
> play is a little sketch/hazy right now, but I'm working on that ;-). 
> In the meantime I'd be interested to know if, in theory, HarfBuzz 
> could be
> usefully plugged into LuaTeX, such as via an external library 
> (.so/.dll).From what I understand... HarfBuzz provides a shaping engine
> so that, for example, it could provide useful services such as the 
> bidi algorithm, and information that could be useful for typesetting 
> complex
> scripts such as Arabic. Again, I stress my currently incomplete 
> understanding of the precise services HarfBuzz  would provide. lso,
> how would you pass back to LuaTeX the results so that the LuaTeX engine
> could use them?
>
> If anyone could help me understand this a little more or indeed let me 
> know if there really is nothing to explore that too would be good. I 
> have not tried to compile HarfBuzz yet so have not played with it at 
> all. I'm merely curious in light of the remarks on the HarfBuzz site.

I don't understand exactly what HarfBuzz does, but as I get it it maps 
characters to glyphs, what it calls "text shaping", taking care of such 
things as substitutions and the like.

With LuaTeX (which I don't pretend to understand exactly either), when 
it comes to such matters, you're alone: you're the one in charge of 
"text shaping", even for ligatures from pairs of glyphs (e.g. "ff"), 
since you're supposed to have created them when loading the font. So I 
don't think integrating HarfBuzz would be in line with LuaTeX's 
philosophy, otherwise it would be no different from XeTeX in that 
respect. On the other hand, nothing prevents you (the user) from calling 
HarfBuzz (or doing whatever you're supposed to do with it) from LuaTeX, 
I guess.

As for the sentence "LuaTeX should be made to do the same thing", if 
"should" means "it'd be good", I suppose the author hasn't really 
understood LuaTeX; if "should" means "it is going to happen, normally", 
then /I/ haven't really understood LuaTeX. What the last sentence means 
is obscure to me.

Again, I don't know much about HarfBuzz, and I can't obviously make any 
authorized statement on LuaTeX, but that's how I see things.

Best,
Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.ntg.nl/pipermail/dev-luatex/attachments/20110201/c6fa8792/attachment.html>

From pragma at wxs.nl  Tue Feb  1 22:28:20 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 01 Feb 2011 22:28:20 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <4D486505.7040605@free.fr>
References: <4D485D48.8010201@readytext.co.uk> <4D486505.7040605@free.fr>
Message-ID: <4D487AF4.6080006@wxs.nl>

On 1-2-2011 8:54, Paul Isambert wrote:

> With LuaTeX (which I don't pretend to understand exactly either), when
> it comes to such matters, you're alone: you're the one in charge of
> "text shaping", even for ligatures from pairs of glyphs (e.g. "ff"),
> since you're supposed to have created them when loading the font. So I
> don't think integrating HarfBuzz would be in line with LuaTeX's
> philosophy, otherwise it would be no different from XeTeX in that
> respect. On the other hand, nothing prevents you (the user) from calling
> HarfBuzz (or doing whatever you're supposed to do with it) from LuaTeX,
> I guess.
>
> As for the sentence "LuaTeX should be made to do the same thing", if
> "should" means "it'd be good", I suppose the author hasn't really
> understood LuaTeX; if "should" means "it is going to happen, normally",
> then /I/ haven't really understood LuaTeX. What the last sentence means
> is obscure to me.
>
> Again, I don't know much about HarfBuzz, and I can't obviously make any
> authorized statement on LuaTeX, but that's how I see things.

LuaTeX is and will remain a TeX engine, an opened up one. One of the 
principles is that we won't hard code solutions other than the one 
provided by (traditional) TeX (although unicode is the coding and wide 
tfm fonts are corner stones). There is the default (relatively 
lightweight) font loader based on fontforge. There is no universal 
solution and hardcoding or binding to some other library is no option, 
if only because they come and go, and fashion can change. The idea is to 
have a stable engine (as stable as traditional tex itself) that can act 
as basis.

However, as one can load Lua libraries, any library that has a Lua 
interface can in principle be plugged in. So if someone wants another 
renderer, he/she can plug in something and as long as what gets returned 
suits tex's inner model (node lists) it's ok. In that respect luatex is 
indifferent to how/what/where it happens. Using some renderer is not so 
much different from using libraries to access databases or filesystems 
or ...

So, to answer your question: no extrnal rendering libraries will be 
linked in by default and none will be provided by the luatex team, but 
one can imagine external libraries to be used that get fed data from 
luatex and give something back that gets fed back into the machinery.

Of course, when a macro package depends on such libraries, it adds 
another depedency which can be a long term maintainance problem.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From patrick at gundla.ch  Wed Feb  2 08:11:54 2011
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 2 Feb 2011 08:11:54 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <4D485D48.8010201@readytext.co.uk>
References: <4D485D48.8010201@readytext.co.uk>
Message-ID: <D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>

Hi Graham,

very interesting link/thought. Thanks.

TeX has been the software for the best typesetting, at least for english texts and for some other languages and scripts. Now with XeTeX and LuaTeX we have the chance to extend the covered scripts to all used ones, so I guess.

So we need a text shaping engine, there is no doubt about that. The current situation is that every macro package has to reinvent the wheel and with LuaTeX, there will be many more applications beyond classic \TeX input, and these application also need to reinvent the wheel. So having a text shaping engine such as harfbuzz is only a question of time.

I'd like to see LuaTeX shipping with some default set of modules, for example an harfbuzz or an xml parser (I still can't believe that there is none built in)(, such as TeXlive ships with a bunch of LaTeX packages). Each one with a suitable interface for LuaTeX.

I don't expect this to happen anytime soon, for LuaTeX still needs a wider spread audience and there is currently a showstopper that prevents module loading in LuaTeX, but one day some experts will jump in and provide glue code/modules.

If LuaTeX does not open up, there will be a risk of forks. There is already a LuaTeX fork with an xml parser built in. I can understand the reluctance of the LuaTeX team to include unnecessary modules, and it would be helpful if there was a "contrib" directory with third party modules that will be built as a library (.so, .dll) which get installed in the TeXlive system. So one can say for example 'require "harfbuzz"' and have harfbuzz loaded on all platforms LuaTeX is running on.

Patrick


From pragma at wxs.nl  Wed Feb  2 09:30:53 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 02 Feb 2011 09:30:53 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
References: <4D485D48.8010201@readytext.co.uk>
	<D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
Message-ID: <4D49163D.9000403@wxs.nl>

On 2-2-2011 8:11, Patrick Gundlach wrote:

> If LuaTeX does not open up, there will be a risk of forks. There is already a LuaTeX fork with an xml parser built in. I can understand the reluctance of the LuaTeX team to include unnecessary modules, and it would be helpful if there was a "contrib" directory with third party modules that will be built as a library (.so, .dll) which get installed in the TeXlive system. So one can say for example 'require "harfbuzz"' and have harfbuzz loaded on all platforms LuaTeX is running on.

Eh ... luatex is opened up. One can just load libraries. Preloading a 
whole lot of (arbitrary) libraries makes no sense. I can imagine that at 
some point (when luatex 1 is out) that there will be a bunch of libs 
shipped alongside the binary distributions but that then has to be part 
of regular tex live and miktex and ... distributions. The thing with 
libraries is that they evolve independently and you cannot expect the 
luatex team to keep track of them. The only thing we can provide is a 
stable api into luatex.

It's not a matter of opening up, but a matter of packaging.  Also, when 
I run luatex I don't want at some point in the future to find out that 
an additional 125 libs (plus dependencies) are needed that I don't use.

A repository with additional modules is a secondary effort, alongside 
luatex. I know that Luigi has done lots of tests and is setting up some 
procedure for it, but as this is to be supported on *all* relevant 
platforms it's not something trivial. So, there will be something, but 
not preloaded. (Just like we don't preload macro definitions or fonts or 
...).

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From luigi.scarso at gmail.com  Wed Feb  2 09:56:56 2011
From: luigi.scarso at gmail.com (luigi scarso)
Date: Wed, 2 Feb 2011 09:56:56 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <4D49163D.9000403@wxs.nl>
References: <4D485D48.8010201@readytext.co.uk>
	<D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
	<4D49163D.9000403@wxs.nl>
Message-ID: <AANLkTikQYxB4oAdLjzYBPDYhgGhDzxyp8bHYTVBnixXT@mail.gmail.com>

On Wed, Feb 2, 2011 at 9:30 AM, Hans Hagen <pragma at wxs.nl> wrote:
> A repository with additional modules is a secondary effort, alongside
> luatex. I know that Luigi has done lots of tests and is setting up some
> procedure for it, but as this is to be supported on *all* relevant platforms
> it's not something trivial. So, there will be something, but not preloaded.
> (Just like we don't preload macro definitions or fonts or ...).
>
> Hans

True.

There are some solutions for this
1) handmade binding
The most efficient and long

2) SWIG
Automatic binding. Quick, solid, but you need a very good C library.
C++ is a nightmare (at least for me now)

3) a bridge ala lunatic.
If a python binding already exist, why build a different lua binding ?.
Just use a bit of lua/python mixed code.

Of course there are and will be always problems for maintenance (think
about python 2.6,2.7,3.1,3.2 for example)
For all these points, support for all platforms is something hard to achieve.
Actually I can compile and test in (in a 32bit Linux box)  libraries
for Linux and Windows with mingw
but I don't have any clue if I can do the same with Mac (of course
without buy a Mac)

Concerning xml: build a binding for libxml  & libxslt with swig should
be easy; the API is stable, the library is well tested
and available for most platform. Perhaps already exists a lua binding
and  even an handmade binding is feasible ---
so why a fork of Luatex ?


--
luigi

From patrick at gundla.ch  Wed Feb  2 10:00:21 2011
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 2 Feb 2011 10:00:21 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <4D49163D.9000403@wxs.nl>
References: <4D485D48.8010201@readytext.co.uk>
	<D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
	<4D49163D.9000403@wxs.nl>
Message-ID: <36DFD49E-2661-49CA-B1F9-9BE030DAF155@gundla.ch>


Am 02.02.2011 um 09:30 schrieb Hans Hagen:

> On 2-2-2011 8:11, Patrick Gundlach wrote:
> 
>> If LuaTeX does not open up, there will be a risk of forks. There is already a LuaTeX fork with an xml parser built in. I can understand the reluctance of the LuaTeX team to include unnecessary modules, and it would be helpful if there was a "contrib" directory with third party modules that will be built as a library (.so, .dll) which get installed in the TeXlive system. So one can say for example 'require "harfbuzz"' and have harfbuzz loaded on all platforms LuaTeX is running on.
> 
> Eh ... luatex is opened up. One can just load libraries.

No. Currently it is impossible to take a LuaTeX binary (from TeXlive for example) and load any non-trivial c-based module. At least for Mac OS X but I guess this is the same on all unix platforms. This makes it impossible to package for example an xml reader lua module into texlive. (See tracker item #555.) But this is - I assume - just a matter of time...

I am _not_ asking for including a whole bunch of libraries into LuaTeX. And I don't expect the already burdened LuaTeX (core) team to do all the work including the libraries. But the community could provide something like tlcontrib or modules.contextgarden.net where we collect luatex'ed libraries that eventually CTAN picks up and include into texlive/texmf/libs/luatex/ (or whatever). Or the mentioned contrib directory in the luatex source, where the optional modules are.

There will of course be complaints such as "my LaTeX document foo.tex does not work together with the library bar.dll in LuaTeX" as we have packages clash in LaTeX today. That's the backside of openness.

> [...] and you cannot expect the luatex team to keep track of them. The only thing we can provide is a stable api into luatex.

I don't expect this and the [stable] API is already there. I don't mind LuaTeX changing its API as long as it is documented somewhere (in the changelogs for example).


Patrick


From patrick at gundla.ch  Wed Feb  2 10:03:33 2011
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 2 Feb 2011 10:03:33 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <AANLkTikQYxB4oAdLjzYBPDYhgGhDzxyp8bHYTVBnixXT@mail.gmail.com>
References: <4D485D48.8010201@readytext.co.uk>
	<D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
	<4D49163D.9000403@wxs.nl>
	<AANLkTikQYxB4oAdLjzYBPDYhgGhDzxyp8bHYTVBnixXT@mail.gmail.com>
Message-ID: <3E9D0F37-3C27-4F94-9E12-CDFFF3D38A82@gundla.ch>



> Concerning xml: build a binding for libxml  & libxslt with swig should
> be easy; the API is stable, the library is well tested
> and available for most platform. Perhaps already exists a lua binding
> and  even an handmade binding is feasible ---
> so why a fork of Luatex ?

Because
a) loading such a module into existing luatex binaries is impossible at the moment (see other mail),
b) shipping one platform dependent file instead of two is less hassle and
c) compiling only one source is much easier then compiling two or more sources.

Patrick


From patrick at gundla.ch  Wed Feb  2 10:19:49 2011
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 2 Feb 2011 10:19:49 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
References: <4D485D48.8010201@readytext.co.uk>
	<D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
Message-ID: <80994CD1-A076-4CC5-9D7C-7920ADED35D9@gundla.ch>

Just to clarify what I mean:


> If LuaTeX does not open up, there will be a risk of forks. There is already a LuaTeX fork with an xml parser built in. I can understand the reluctance of the LuaTeX team to include unnecessary modules[...]

with that I mean a) the technical base of loading modules and b) the community to jump in and provide bindings which will be packed in a distribution. I can see (and I agree) why additional libraries are not hard coded into the luatex core. So I didn't want to criticize the LuaTeX team in any way and if I did, I apologize.

Patrick


From luigi.scarso at gmail.com  Wed Feb  2 10:39:48 2011
From: luigi.scarso at gmail.com (luigi scarso)
Date: Wed, 2 Feb 2011 10:39:48 +0100
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <3E9D0F37-3C27-4F94-9E12-CDFFF3D38A82@gundla.ch>
References: <4D485D48.8010201@readytext.co.uk>
	<D9672EE5-B94C-41EB-8B2C-FF78AB8905A0@gundla.ch>
	<4D49163D.9000403@wxs.nl>
	<AANLkTikQYxB4oAdLjzYBPDYhgGhDzxyp8bHYTVBnixXT@mail.gmail.com>
	<3E9D0F37-3C27-4F94-9E12-CDFFF3D38A82@gundla.ch>
Message-ID: <AANLkTinxEzrsJDLhAiBuF7iD1jmzxH3+PkrM=eZ4yPfB@mail.gmail.com>

On Wed, Feb 2, 2011 at 10:03 AM, Patrick Gundlach <patrick at gundla.ch> wrote:
>
>
>> Concerning xml: build a binding for libxml ?& libxslt with swig should
>> be easy; the API is stable, the library is well tested
>> and available for most platform. Perhaps already exists a lua binding
>> and ?even an handmade binding is feasible ---
>> so why a fork of Luatex ?
>
> Because
> a) loading such a module into existing luatex binaries is impossible at the moment (see other mail),
> b) shipping one platform dependent file instead of two is less hassle and
> c) compiling only one source is much easier then compiling two or more sources.
>
Too much drastic.
Actually it's possibile to load  non-trivial library but not *all* library.
As you wrote in #555 with sqlite there are some problems, and I
believe  that with SWIG you can
solve them *without* touch the luatex source/building phase

> b) shipping one platform dependent file instead of two is less hassle and
> c) compiling only one source is much easier then compiling two or more sources.
Again shipping and compiling maybe can be better, but not maintenance.
A bug in xyz library will be a bug in luatex that the luatex team must
solve for all platform.

Even for libxml thare are some prons & cons: a xml-based  workflow
probably doesn't need the xml
side of luatex.
-- 
luigi

From root at mail.boekplan.nl  Wed Feb  2 12:27:57 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed,  2 Feb 2011 12:27:57 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110202112758.4B14240049@mail.boekplan.nl>

------------------------------------------------------------------------
r4077 | hhenkel | 2011-02-01 23:12:26 +0100 (Tue, 01 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /branches/lua-obj/source/texk/web2c/luatexdir/luascripts/pdflua.lua
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdftypes.h

scripted /Catalog (experimental)

------------------------------------------------------------------------

From khaledhosny at eglug.org  Thu Feb  3 15:51:27 2011
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 3 Feb 2011 16:51:27 +0200
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <4D485D48.8010201@readytext.co.uk>
References: <4D485D48.8010201@readytext.co.uk>
Message-ID: <20110203145127.GC4072@khaled-laptop>

On Tue, Feb 01, 2011 at 07:21:44PM +0000, Graham Douglas wrote:
> Hi to all
> 
> Apologies in advance for the slightly off-topic nature of this
> post. I've been reading about HarfBuzz which certainly looks to
> be an interesting project. From the project page there is a link
> to an article titled "State of Text Rendering" by Behdad Esfahbod
> 
> http://behdad.org/text/
> 
> Within that article is a section on TeX engines with a reference to
> XeTeX and LuaTeX --- I'm just quoting a small bit of the article which
> I hope is not too much out of context:
> 
> "The XeTeX creator is working on HarfBuzz on behalf of Mozilla now,
> and plans to port XeTeX to HarfBuzz eventually. In the long term
> though, pdfTeX's successor luaTeX should be made to do the same
> thing. There is more to Unicode support than just shaping, and in
> those areas the TeX engines can gain a lot by building on top of
> existing libraries."
> 
> At present my own understanding of the precise role that HarfBuzz could
> play is a little sketch/hazy right now, but I'm working on that ;-).
> In the meantime I'd be interested to know if, in theory, HarfBuzz
> could be
> usefully plugged into LuaTeX, such as via an external library
> (.so/.dll).From what I understand... HarfBuzz provides a shaping
> engine
> so that, for example, it could provide useful services such as the
> bidi algorithm, and information that could be useful for typesetting
> complex
> scripts such as Arabic. Again, I stress my currently incomplete
> understanding of the precise services HarfBuzz  would provide. lso,
> how would you pass back to LuaTeX the results so that the LuaTeX engine
> could use them?
> 
> If anyone could help me understand this a little more or indeed let
> me know if there really is nothing to explore that too would be
> good. I have not tried to compile HarfBuzz yet so have not played
> with it at all. I'm merely curious in light of the remarks on the
> HarfBuzz site.
> 
> Thank to anyone who can shed some light on this for me.

HarfBuzz provide an OpenType layout engine (Graphite support existed at
some point, but were removed to be rewritten, AAT is planned in some
distant future) but no bidi (the client have to do it in its own or use
other libraries like fribidi).

HarfBuzz workflow is usually 1) loading a font in FreeType 2) shaping
text in HarfBuzz for that font 3) getting back glyph indices and
positions. Of course there are more details like itemizing the text,
selecting font features and so on.

FreeType is not mandatory, but using it simplifies the process.

Hans have written (and still improving) an OpenType layout engine
completely in lua(tex) and it more or less does what HarfBuzz would do,
it may support more features than HarfBuzz but HarfBuzz code is more
widely tested, so each have its pros and cons.

I can imagine a separate module where HarfBuzz is plugged into LuaTeX
allowing it to process node lists instead of text strings (HarfBuzz have
callbacks that I think can be used to plug function that deal with node
buffers instead of text strings), it can be an interesting exercise and
I expect HarfBuzz maintainer to be willing to cooperate.


Regards,
 Khaled

-- 
 Khaled Hosny
 Egyptian

From graham.douglas at readytext.co.uk  Thu Feb  3 21:54:37 2011
From: graham.douglas at readytext.co.uk (Graham Douglas)
Date: Thu, 03 Feb 2011 20:54:37 +0000
Subject: [Dev-luatex] HarfBuzz [slightly off-topic]
In-Reply-To: <20110203145127.GC4072@khaled-laptop>
References: <20110203145127.GC4072@khaled-laptop>
Message-ID: <4D4B160D.6070806@readytext.co.uk>

 > HarfBuzz provide an OpenType layout engine (Graphite support existed at
 > some point, but were removed to be rewritten, AAT is planned in some
 > distant future) but no bidi (the client have to do it in its own or use
 > other libraries like fribidi).
 >
 > HarfBuzz workflow is usually 1) loading a font in FreeType 2) shaping
 > text in HarfBuzz for that font 3) getting back glyph indices and
 > positions. Of course there are more details like itemizing the text,
 > selecting font features and so on.
 >
 > FreeType is not mandatory, but using it simplifies the process.
 >
 > Hans have written (and still improving) an OpenType layout engine
 > completely in lua(tex) and it more or less does what HarfBuzz would do,
 > it may support more features than HarfBuzz but HarfBuzz code is more
 > widely tested, so each have its pros and cons.
 >
 > I can imagine a separate module where HarfBuzz is plugged into LuaTeX
 > allowing it to process node lists instead of text strings (HarfBuzz have
 > callbacks that I think can be used to plug function that deal with node
 > buffers instead of text strings), it can be an interesting exercise and
 > I expect HarfBuzz maintainer to be willing to cooperate.
 >
 >
 > Regards,
 >  Khaled

-- 
 > Khaled Hosny
 > Egyptian


Dear Khaled

Thanks very much indeed for this helpful summary.
I've now compiled HarfBuzz on Windows (using Visual Studio)
so, it's time to explore it :-)

Just to add, I do of course understand why libraries such as HarfBuzz
should not be part of core LuaTeX and only ever "plugged in"
via library facilities as a DLL/so. As I'm sure many others have 
experienced when using/building tools, it can be quite annoying to
hit "multiple cascading library dependancies" which can be a real 
nightmare to sort out even for a one-off build, let alone trying to
maintain!

Thanks again to everyone for the discussions on this thread.

Cheers

Graham





From reinhard.kotucha at web.de  Sat Feb  5 21:11:52 2011
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sat, 5 Feb 2011 21:11:52 +0100
Subject: [Dev-luatex] file permissions
Message-ID: <19789.44808.7471.149364@zaphod.ms25.net>

Hi Taco,
when writing scripts in texlua, I often have to find out whether a
file or directory is readable or writable.  The permission flags I get
from lfs.attributes() are not sufficient.  Though I can determine the
UID and GID of the file owner, I still have to find out my own UID and
GID and whether I'm member of a particular group.  This is difficult,
sometimes impossible (without access to getpwent(3) and getgrent(3)),
and quite system dependent.

In order to test whether a file is readable I currently open this file
in a protected call.  This is also possible for directories when I run
lfs.dir() inside pcall().  It's not very elegant, and I still have
no idea how to test whether a file is writable.  I could try to open
the file in append mode, but I fear that if the file is writable, this
test would change the time stamps.  Not very elegant either.

I'm not aware of a better solution, but maybe I'm missing something.

If not, I propose a new function lfs.access() which takes a file name
and a string as an argument containing any combination of the letters
'r', 'w', or 'x' and returns the result of the system call access(2)
(as a boolean).

For instance, lfs.access(somefile, "rx") would then return the result
of the system call access(somefile, R_OK|X_OK).

On Windows there is a function _access() in the runtime lib which is
similar to access(2) on Unix, though the executable flag isn't
supported.  Maybe it can be ignored.  On the other hand it would be
very convenient if the function returns true if the file is in PATH
and its extension is in PATHEXT (as described in the MSVCRT sources).
This makes the function call more expensive, but I think that
access(2) is relatively expensive on Unix too because of the UID/GID
lookups.

I first considered to propose to extend lfs.isfile() and lfs.isdir()
by an optional argument, but because lfs.isfile() checks whether a
file is a regular file (which is fine), this seems to impose an
unnecessary limitation:

print(lfs.isfile('/dev/null'))
  => false

print(lfs.attributes('/dev/null', 'mode'))
  => char device

Hence, I think that a separate function lfs.access() makes more sense.

WDYT?

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From taco at elvenkind.com  Sun Feb  6 09:25:21 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 06 Feb 2011 09:25:21 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <19789.44808.7471.149364@zaphod.ms25.net>
References: <19789.44808.7471.149364@zaphod.ms25.net>
Message-ID: <4D4E5AF1.4070204@elvenkind.com>

On 02/05/2011 09:11 PM, Reinhard Kotucha wrote:
>
> Hence, I think that a separate function lfs.access() makes more sense.
>
> WDYT?

Sounds fine, I've put it on my todo list for 0.70

Best wishes,
Taco

From pragma at wxs.nl  Sun Feb  6 11:40:13 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 06 Feb 2011 11:40:13 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <19789.44808.7471.149364@zaphod.ms25.net>
References: <19789.44808.7471.149364@zaphod.ms25.net>
Message-ID: <4D4E7A8D.2020606@wxs.nl>

On 5-2-2011 9:11, Reinhard Kotucha wrote:

> In order to test whether a file is readable I currently open this file
> in a protected call.  This is also possible for directories when I run
> lfs.dir() inside pcall().  It's not very elegant, and I still have
> no idea how to test whether a file is writable.  I could try to open
> the file in append mode, but I fear that if the file is writable, this
> test would change the time stamps.  Not very elegant either.

I use something

function file.is_writable(name)
     local d = string.match(name,"^(.+)[/\\].-$") or "."
     local a = lfs.attributes(name) or lfs.attributes(d)
     return a and string/sub(a.permissions,2,2) == "w"
end

function file.is_readable(name)
     local a = lfs.attributes(name)
     return a and string.sub(a.permissions,1,1) == "r"
end

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From reinhard.kotucha at web.de  Sun Feb  6 15:56:34 2011
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sun, 6 Feb 2011 15:56:34 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <4D4E7A8D.2020606@wxs.nl>
References: <19789.44808.7471.149364@zaphod.ms25.net> <4D4E7A8D.2020606@wxs.nl>
Message-ID: <19790.46754.568644.675872@zaphod.ms25.net>

On 6 February 2011 Hans Hagen wrote:

 > On 5-2-2011 9:11, Reinhard Kotucha wrote:
 > 
 > > In order to test whether a file is readable I currently open this
 > > file in a protected call.  This is also possible for directories
 > > when I run lfs.dir() inside pcall().  It's not very elegant, and
 > > I still have no idea how to test whether a file is writable.  I
 > > could try to open the file in append mode, but I fear that if the
 > > file is writable, this test would change the time stamps.  Not
 > > very elegant either.
 > 
 > I use something
 > 
 > function file.is_writable(name)
 >      local d = string.match(name,"^(.+)[/\\].-$") or "."
 >      local a = lfs.attributes(name) or lfs.attributes(d)
 >      return a and string/sub(a.permissions,2,2) == "w"
 > end
 > 
 > function file.is_readable(name)
 >      local a = lfs.attributes(name)
 >      return a and string.sub(a.permissions,1,1) == "r"
 > end

Consider the following situation on Unix:

$ whoami
reinhard
$ ls -l /etc/passwd
-rw-r--r-- 1 root root 2269 Dec 19 14:57 /etc/passwd
 
Your test suggests that the file is writable, but this is only true
for root, not for the user who is running the script.  You actually
have to determine whether you are the owner of the file, or, if the
file is group writable, whether you are member of this group, or
whether the file is writable by everybody.

Regarding Windows, I'm not sure.  As far as I can see from the Lua
sources, permission flags are directly derived from a stat() call.
This means that they are related to the file owner too, not to the
current user.

If there is a file which is owned by the admin and is _not_ writable
by normal users, does your test really return 'false' if run by a
non-privileged user on Windows?

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From pragma at wxs.nl  Sun Feb  6 23:33:37 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 06 Feb 2011 23:33:37 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <19790.46754.568644.675872@zaphod.ms25.net>
References: <19789.44808.7471.149364@zaphod.ms25.net>	<4D4E7A8D.2020606@wxs.nl>
	<19790.46754.568644.675872@zaphod.ms25.net>
Message-ID: <4D4F21C1.3040602@wxs.nl>

On 6-2-2011 3:56, Reinhard Kotucha wrote:

> $ whoami
> reinhard
> $ ls -l /etc/passwd
> -rw-r--r-- 1 root root 2269 Dec 19 14:57 /etc/passwd
>
> Your test suggests that the file is writable, but this is only true
> for root, not for the user who is running the script.  You actually
> have to determine whether you are the owner of the file, or, if the
> file is group writable, whether you are member of this group, or
> whether the file is writable by everybody.

Isn't it a bug in the lfs library then? When is the point in returning 
an attribute that has no defined meaning?

> Regarding Windows, I'm not sure.  As far as I can see from the Lua
> sources, permission flags are directly derived from a stat() call.
> This means that they are related to the file owner too, not to the
> current user.

I suppose that we're only interested in the current user, so 
lfs.attributes should return the user's attributes. I was always under 
the impression that this was the case.

> If there is a file which is owned by the admin and is _not_ writable
> by normal users, does your test really return 'false' if run by a
> non-privileged user on Windows?

I don't know. Whatever we end up with it should be robust or at least 
predictable.

(i normally have only one account on computers and run everything as 
administrator or root)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From reinhard.kotucha at web.de  Mon Feb  7 01:41:09 2011
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Mon, 7 Feb 2011 01:41:09 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <4D4F21C1.3040602@wxs.nl>
References: <19789.44808.7471.149364@zaphod.ms25.net> <4D4E7A8D.2020606@wxs.nl>
	<19790.46754.568644.675872@zaphod.ms25.net>
	<4D4F21C1.3040602@wxs.nl>
Message-ID: <19791.16293.612499.342652@zaphod.ms25.net>

On 6 February 2011 Hans Hagen wrote:

 > On 6-2-2011 3:56, Reinhard Kotucha wrote:
 > 
 > > $ whoami
 > > reinhard
 > > $ ls -l /etc/passwd
 > > -rw-r--r-- 1 root root 2269 Dec 19 14:57 /etc/passwd
 > >
 > > Your test suggests that the file is writable, but this is only true
 > > for root, not for the user who is running the script.  You actually
 > > have to determine whether you are the owner of the file, or, if the
 > > file is group writable, whether you are member of this group, or
 > > whether the file is writable by everybody.
 > 
 > Isn't it a bug in the lfs library then? When is the point in returning 
 > an attribute that has no defined meaning?

No, it's not a bug.  The name "attributes" is misleading, "stat" would
be better.  It *has* a defined meaning, it just returns what's stored
in the stat structure of a particular file:

  struct stat {
        dev_t     st_dev;     /* ID of device containing file */
        ino_t     st_ino;     /* inode number */
        mode_t    st_mode;    /* protection */
        nlink_t   st_nlink;   /* number of hard links */
        uid_t     st_uid;     /* user ID of owner */
        gid_t     st_gid;     /* group ID of owner */
        dev_t     st_rdev;    /* device ID (if special file) */
        off_t     st_size;    /* total size, in bytes */
        blksize_t st_blksize; /* blocksize for file system I/O */
        blkcnt_t  st_blocks;  /* number of 512B blocks allocated */
        time_t    st_atime;   /* time of last access */
        time_t    st_mtime;   /* time of last modification */
        time_t    st_ctime;   /* time of last status change */
    };

This is exactly the information you see in directory listings.

lfs.attributes supports the stat() system call directly, except that
st_blksize and st_blocks are not defined on Windows and that st_mode
is split up into "permissions" and "mode".

 > > Regarding Windows, I'm not sure.  As far as I can see from the
 > > Lua sources, permission flags are directly derived from a stat()
 > > call.  This means that they are related to the file owner too,
 > > not to the current user.
 > 
 > I suppose that we're only interested in the current user, so
 > lfs.attributes should return the user's attributes. I was always
 > under the impression that this was the case.

I think that lfs.attributes is correct, despite its unfortunate name.
I proposed lfs.access() because access() and stat() are two distinct
system calls anyway.

 > > If there is a file which is owned by the admin and is _not_
 > > writable by normal users, does your test really return 'false' if
 > > run by a non-privileged user on Windows?
 > 
 > I don't know. Whatever we end up with it should be robust or at
 > least predictable.

I think that what I proposed is reliable and relatively easy to
implement.  At least there is an access() function in MSVCRT too which
does the same as the one on Unix, though the executable bit is ignored.  
And

   if lfs.access(file, 'rx') then ...

should be as robust and predictable as 

   if (-r $file && -x $file) { ...

in Perl.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha                                      Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover                              mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From taco at elvenkind.com  Mon Feb  7 09:01:47 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 07 Feb 2011 09:01:47 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <19791.16293.612499.342652@zaphod.ms25.net>
References: <19789.44808.7471.149364@zaphod.ms25.net>
	<4D4E7A8D.2020606@wxs.nl>	<19790.46754.568644.675872@zaphod.ms25.net>	<4D4F21C1.3040602@wxs.nl>
	<19791.16293.612499.342652@zaphod.ms25.net>
Message-ID: <4D4FA6EB.7060500@elvenkind.com>

On 02/07/2011 01:41 AM, Reinhard Kotucha wrote:
>
> I think that what I proposed is reliable and relatively easy to
> implement.

I agree with Reinhard. lfs functions tend to have low-level
names and interfaces just like the system library functions they
interface to.

Best wishes,
Taco

From pragma at wxs.nl  Mon Feb  7 11:42:40 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 07 Feb 2011 11:42:40 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <19791.16293.612499.342652@zaphod.ms25.net>
References: <19789.44808.7471.149364@zaphod.ms25.net>	<4D4E7A8D.2020606@wxs.nl>	<19790.46754.568644.675872@zaphod.ms25.net>	<4D4F21C1.3040602@wxs.nl>
	<19791.16293.612499.342652@zaphod.ms25.net>
Message-ID: <4D4FCCA0.8040307@wxs.nl>

On 7-2-2011 1:41, Reinhard Kotucha wrote:

> No, it's not a bug.  The name "attributes" is misleading, "stat" would
> be better.  It *has* a defined meaning, it just returns what's stored
> in the stat structure of a particular file:
>
>    struct stat {
>          dev_t     st_dev;     /* ID of device containing file */
>          ino_t     st_ino;     /* inode number */
>          mode_t    st_mode;    /* protection */
>          nlink_t   st_nlink;   /* number of hard links */
>          uid_t     st_uid;     /* user ID of owner */
>          gid_t     st_gid;     /* group ID of owner */
>          dev_t     st_rdev;    /* device ID (if special file) */
>          off_t     st_size;    /* total size, in bytes */
>          blksize_t st_blksize; /* blocksize for file system I/O */
>          blkcnt_t  st_blocks;  /* number of 512B blocks allocated */
>          time_t    st_atime;   /* time of last access */
>          time_t    st_mtime;   /* time of last modification */
>          time_t    st_ctime;   /* time of last status change */
>      };
>
> This is exactly the information you see in directory listings.
>
> lfs.attributes supports the stat() system call directly, except that
> st_blksize and st_blocks are not defined on Windows and that st_mode
> is split up into "permissions" and "mode".

So where does the 'permissions' info in lfs.attributes come from then? I 
assume that that should reflect access.

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Mon Feb  7 11:45:15 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 07 Feb 2011 11:45:15 +0100
Subject: [Dev-luatex] file permissions
In-Reply-To: <4D4FCCA0.8040307@wxs.nl>
References: <19789.44808.7471.149364@zaphod.ms25.net>	<4D4E7A8D.2020606@wxs.nl>	<19790.46754.568644.675872@zaphod.ms25.net>	<4D4F21C1.3040602@wxs.nl>	<19791.16293.612499.342652@zaphod.ms25.net>
	<4D4FCCA0.8040307@wxs.nl>
Message-ID: <4D4FCD3B.2090205@elvenkind.com>

On 02/07/2011 11:42 AM, Hans Hagen wrote:
>
> So where does the 'permissions' info in lfs.attributes come from then? I
> assume that that should reflect access.

The permissions key list access possibilities for the user, the user's 
group, and all others. That is why there are three sets of values.

What we do not have is a method to ascertain whether we are in fact
'user', 'user's group', or 'others'.

Best wishes,
Taco

From root at mail.boekplan.nl  Mon Feb  7 12:28:13 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Mon,  7 Feb 2011 12:28:13 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110207112813.47EEF4006B@mail.boekplan.nl>

------------------------------------------------------------------------
r4078 | hhenkel | 2011-02-06 22:32:20 +0100 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.w

(lua-obj) Real and Null objects fixed

------------------------------------------------------------------------
r4079 | hhenkel | 2011-02-07 00:23:36 +0100 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/luascripts/pdflua.lua
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdftypes.h

scripted /Info dict (experimental)

------------------------------------------------------------------------
r4080 | hhenkel | 2011-02-07 00:30:22 +0100 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/luascripts/pdflua.lua

fix infotoks

------------------------------------------------------------------------

From root at mail.boekplan.nl  Mon Feb  7 22:28:02 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Mon,  7 Feb 2011 22:28:02 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110207212803.037974006B@mail.boekplan.nl>

------------------------------------------------------------------------
r4081 | hhenkel | 2011-02-07 21:55:39 +0100 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/luascripts/pdflua.lua
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.h
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.w

create /Catalog and /Info dicts early

------------------------------------------------------------------------

From root at mail.boekplan.nl  Tue Feb  8 12:29:37 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue,  8 Feb 2011 12:29:37 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110208112937.E0B2D40049@mail.boekplan.nl>

------------------------------------------------------------------------
r4082 | oneiros | 2011-02-07 22:14:14 +0100 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   D /branches/0.30
   D /branches/0.40.x
   D /branches/0.60.x

rm obsolete branches

------------------------------------------------------------------------
r4083 | hhenkel | 2011-02-07 23:09:59 +0100 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /branches/lua-obj/source/texk/web2c/luatexdir/luascripts/pdflua.lua
   M /branches/lua-obj/source/texk/web2c/luatexdir/pdf/pdfluaapi.w

experimental getpagelist()

------------------------------------------------------------------------

From w.m.l at gmx.net  Wed Feb  9 19:22:53 2011
From: w.m.l at gmx.net (Robert)
Date: Wed, 09 Feb 2011 19:22:53 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
Message-ID: <4D52DB7D.7000803@gmx.net>

Hi,

here are two bugs:

* in pdftex, \letterspacefont does not disable the ligatures, but this 
is what happens in luatex.

* neither \tagcode nor \pdfnoligatures seem to have any effect (for 
non-letterspaced fonts, that is).

Example:

\input luaotfload.sty
\font\x="Latin Modern Roman:+liga;+tlig" at 12pt
\tagcode\x`\f=-1   % no effect
\pdfnoligatures\x  % ditto
\x fi --

\letterspacefont\y\x 100 % killing the ligatures
\y fi --
\bye

Best regards,
-- 
  Robert

From beingalink at googlemail.com  Wed Feb  9 19:43:55 2011
From: beingalink at googlemail.com (Beingalink)
Date: Wed, 9 Feb 2011 19:43:55 +0100
Subject: [Dev-luatex] Problem using dfont fonts with lualatex (Mactex)
Message-ID: <22CDC0C4-CB7B-4FF0-94EC-38A76C521903@googlemail.com>

I get following error message:

-----------------------------------------------------------------------------------------------------------
! LuaTeX error ...0/texmf-dist/tex/luatex/luaotfload/otfl-luat-dum.lua:67: bad
argument #2 to 'find_file' (invalid option 'truetype dictionary').
<to be read again>
\scan_stop:
l.112 ...=MatchLowercase,Ligatures=TeX]{Helvetica}
-----------------------------------------------------------------------------------------------------------

Google told me that this might be related to code that originally came from context but wasn't changed to work with luatex. But I'm not sure since I'm not a developer. If there's sth. I can do to identify/fix the bug, please don't hesitate to tell me.

Regards,
Tobias Link


From pragma at wxs.nl  Wed Feb  9 23:07:15 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 09 Feb 2011 23:07:15 +0100
Subject: [Dev-luatex] Problem using dfont fonts with lualatex (Mactex)
In-Reply-To: <22CDC0C4-CB7B-4FF0-94EC-38A76C521903@googlemail.com>
References: <22CDC0C4-CB7B-4FF0-94EC-38A76C521903@googlemail.com>
Message-ID: <4D531013.3010908@wxs.nl>

On 9-2-2011 7:43, Beingalink wrote:
> I get following error message:
>
> -----------------------------------------------------------------------------------------------------------
> ! LuaTeX error ...0/texmf-dist/tex/luatex/luaotfload/otfl-luat-dum.lua:67: bad
> argument #2 to 'find_file' (invalid option 'truetype dictionary').
> <to be read again>
> \scan_stop:
> l.112 ...=MatchLowercase,Ligatures=TeX]{Helvetica}
> -----------------------------------------------------------------------------------------------------------
>
> Google told me that this might be related to code that originally came from context but wasn't changed to work with luatex. But I'm not sure since I'm not a developer. If there's sth. I can do to identify/fix the bug, please don't hesitate to tell me.

It depends on what the kpse library expects as so called 'format' so if 
you can try to change the "truetype dictionary" into "truetype font" and 
see what happens. (I cannot test it as in context we use other methods 
for locating the files).

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From beingalink at googlemail.com  Thu Feb 10 00:17:32 2011
From: beingalink at googlemail.com (Beingalink)
Date: Thu, 10 Feb 2011 00:17:32 +0100
Subject: [Dev-luatex] Problem using dfont fonts with lualatex (Mactex)
In-Reply-To: <4D531013.3010908@wxs.nl>
References: <22CDC0C4-CB7B-4FF0-94EC-38A76C521903@googlemail.com>
	<4D531013.3010908@wxs.nl>
Message-ID: <D1FBF0C5-F754-4BD6-8B05-84DC2B74A6AB@googlemail.com>

Hi!

Thanks for your reply! Indeed, replacing "truetype dictionary" with "truetype fonts" in otfl-luat-dum.lua fixes the issue. I hope this will be officially fixed in the repository soon. But now I get another error message:

---------------------------------------------------------------------------------------------------------------------
! Font \zf at basefont=name:CenturySchoolbook at 10pt not loadable: metric data no
t found or bad.
<to be read again>
\scan_stop:
l.111 ...infont[Ligatures=TeX]{Century Schoolbook}
% Palatino, Times, Times ?
---------------------------------------------------------------------------------------------------------------------

It seems that the font "CenturySchoolbook" has no extension on the Mac and is called a "Font Suitcase". Perhaps you can help me there, too?

Kind regards,
Tobias Link


Am 09.02.2011 um 23:07 schrieb Hans Hagen:

> On 9-2-2011 7:43, Beingalink wrote:
>> I get following error message:
>> 
>> -----------------------------------------------------------------------------------------------------------
>> ! LuaTeX error ...0/texmf-dist/tex/luatex/luaotfload/otfl-luat-dum.lua:67: bad
>> argument #2 to 'find_file' (invalid option 'truetype dictionary').
>> <to be read again>
>> \scan_stop:
>> l.112 ...=MatchLowercase,Ligatures=TeX]{Helvetica}
>> -----------------------------------------------------------------------------------------------------------
>> 
>> Google told me that this might be related to code that originally came from context but wasn't changed to work with luatex. But I'm not sure since I'm not a developer. If there's sth. I can do to identify/fix the bug, please don't hesitate to tell me.
> 
> It depends on what the kpse library expects as so called 'format' so if you can try to change the "truetype dictionary" into "truetype font" and see what happens. (I cannot test it as in context we use other methods for locating the files).
> 
> Hans
> 
> -----------------------------------------------------------------
>                                          Hans Hagen | PRAGMA ADE
>              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
>    tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
>                                             | www.pragma-pod.nl
> -----------------------------------------------------------------


From taco at elvenkind.com  Thu Feb 10 06:25:47 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 10 Feb 2011 06:25:47 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D52DB7D.7000803@gmx.net>
References: <4D52DB7D.7000803@gmx.net>
Message-ID: <4D5376DB.8000800@elvenkind.com>

Hi Robert,

On 02/09/11 19:22, Robert wrote:
> Hi,
> 
> here are two bugs:
> 
> * in pdftex, \letterspacefont does not disable the ligatures, but this
> is what happens in luatex.
> 
> * neither \tagcode nor \pdfnoligatures seem to have any effect (for
> non-letterspaced fonts, that is).

I've created a tracker item, but I am not sure yet whether either of
them is actually a bug or simply a incompatibility.

Best wishes,
Taco

From pragma at wxs.nl  Thu Feb 10 08:59:53 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 10 Feb 2011 08:59:53 +0100
Subject: [Dev-luatex] Problem using dfont fonts with lualatex (Mactex)
In-Reply-To: <D1FBF0C5-F754-4BD6-8B05-84DC2B74A6AB@googlemail.com>
References: <22CDC0C4-CB7B-4FF0-94EC-38A76C521903@googlemail.com>
	<4D531013.3010908@wxs.nl>
	<D1FBF0C5-F754-4BD6-8B05-84DC2B74A6AB@googlemail.com>
Message-ID: <4D539AF9.6070500@wxs.nl>

On 10-2-2011 12:17, Beingalink wrote:
> Hi!
>
> Thanks for your reply! Indeed, replacing "truetype dictionary" with "truetype fonts" in otfl-luat-dum.lua fixes the issue. I hope this will be officially fixed in the repository soon. But now I get another error message:
>
> ---------------------------------------------------------------------------------------------------------------------
> ! Font \zf at basefont=name:CenturySchoolbook at 10pt not loadable: metric data no
> t found or bad.
> <to be read again>
> \scan_stop:
> l.111 ...infont[Ligatures=TeX]{Century Schoolbook}
> % Palatino, Times, Times ?
> ---------------------------------------------------------------------------------------------------------------------
>
> It seems that the font "CenturySchoolbook" has no extension on the Mac and is called a "Font Suitcase". Perhaps you can help me there, too?

We did some testing with dfonts when the loader was adapted to changes 
in the dfont specification. To be honest, I'd stay away from it. There 
are dfonts out there that are only to be used by the operating system 
and are not feature complete for instance.

I see that you use the name: prefix, how about using file: and then the 
filename? The name: prefix depends on a name database and afaik context 
and latex use a different approach for that (database code is plugged in 
so to say).

The only help I can think of is sending taco and me the font off-list so 
that we can see if it loads on our (non osx) machines.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From root at mail.boekplan.nl  Thu Feb 10 12:27:57 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Thu, 10 Feb 2011 12:27:57 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110210112757.535E540049@mail.boekplan.nl>

------------------------------------------------------------------------
r4084 | taco | 2011-02-10 10:06:29 +0100 (Thu, 10 Feb 2011) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/llfslibext.c

fix bug 549 + re-indent

------------------------------------------------------------------------
r4085 | taco | 2011-02-10 10:21:57 +0100 (Thu, 10 Feb 2011) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h

fix bug 547

------------------------------------------------------------------------
r4086 | taco | 2011-02-10 10:25:30 +0100 (Thu, 10 Feb 2011) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/font/luafont.w

fix bug #548

------------------------------------------------------------------------

From will.adams at frycomm.com  Thu Feb 10 13:36:22 2011
From: will.adams at frycomm.com (William Adams)
Date: Thu, 10 Feb 2011 07:36:22 -0500
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D52DB7D.7000803@gmx.net>
References: <4D52DB7D.7000803@gmx.net>
Message-ID: <3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>

On Feb 9, 2011, at 1:22 PM, Robert wrote:

> * in pdftex, \letterspacefont does not disable the ligatures, but this is what happens in luatex.

IMO that's a desireable behaviour, not a bug. See Bringhurst, Oliver Simon's _Introduction to Typography_ &c.

A control to turn it off or on (defaulting to disabling the ligatures) would be okay, but I've had to put a lot of effort into turning off ligatures when letterspacing and it's a pain.

William

-- 
William Adams
senior graphic designer
Fry Communications
Sphinx of black quartz, judge my vow.


From patrick at gundla.ch  Thu Feb 10 13:53:25 2011
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 10 Feb 2011 13:53:25 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
References: <4D52DB7D.7000803@gmx.net>
	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
Message-ID: <0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>

> 
>> * in pdftex, \letterspacefont does not disable the ligatures, but this is what happens in luatex.
> 
> IMO that's a desireable behaviour, not a bug. See Bringhurst, Oliver Simon's _Introduction to Typography_ &c.
> 
> A control to turn it off or on (defaulting to disabling the ligatures) would be okay, but I've had to put a lot of effort into turning off ligatures when letterspacing and it's a pain.

In older german texts ligatures are not letter spaced. For example:

B i s m a r ck

(the ck ligature is not seperated)

Patrick



From taco at elvenkind.com  Thu Feb 10 13:56:37 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 10 Feb 2011 13:56:37 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
Message-ID: <4D53E085.1060703@elvenkind.com>



On 02/10/11 13:53, Patrick Gundlach wrote:
>>
>>> * in pdftex, \letterspacefont does not disable the ligatures, but this is what happens in luatex.
>>
>> IMO that's a desireable behaviour, not a bug. See Bringhurst, Oliver Simon's _Introduction to Typography_ &c.
>>
>> A control to turn it off or on (defaulting to disabling the ligatures) would be okay, but I've had to put a lot of effort into turning off ligatures when letterspacing and it's a pain.
> 
> In older german texts ligatures are not letter spaced. For example:
> 
> B i s m a r ck
> 
> (the ck ligature is not seperated)

Neither was ij in dutch, but ff was separated. Which just goes to show
you that doing letterspacing automatically is hard....

From taco at elvenkind.com  Thu Feb 10 14:02:25 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 10 Feb 2011 14:02:25 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
Message-ID: <4D53E1E1.7050309@elvenkind.com>



On 02/10/11 13:59, William Adams wrote:
> 
> ck and ij would be (like ae and oe) diphthongs --- linguistic constructs denoting specific sounds.
> 
> ff is a ligature --- the joining together of two or more characters for stylistic or technical reasons.

But there is no distinction between those two in OpenType ...

From taco at elvenkind.com  Thu Feb 10 14:03:57 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 10 Feb 2011 14:03:57 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D53E1E1.7050309@elvenkind.com>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>	<4D53E085.1060703@elvenkind.com>	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
	<4D53E1E1.7050309@elvenkind.com>
Message-ID: <4D53E23D.6030901@elvenkind.com>



On 02/10/11 14:02, Taco Hoekwater wrote:
> 
> 
> On 02/10/11 13:59, William Adams wrote:
>>
>> ck and ij would be (like ae and oe) diphthongs --- linguistic constructs denoting specific sounds.
>>
>> ff is a ligature --- the joining together of two or more characters for stylistic or technical reasons.
> 
> But there is no distinction between those two in OpenType ...

Moral of this: if you want to do nice letterspacing in
luatex, use lua code instead of pdftex's \letterspacefont.

Best wishes,
Taco

From will.adams at frycomm.com  Thu Feb 10 13:59:06 2011
From: will.adams at frycomm.com (William Adams)
Date: Thu, 10 Feb 2011 07:59:06 -0500
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D53E085.1060703@elvenkind.com>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
Message-ID: <06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>

On Feb 10, 2011, at 7:56 AM, Taco Hoekwater wrote:

> On 02/10/11 13:53, Patrick Gundlach wrote:
>>> 
>>>> * in pdftex, \letterspacefont does not disable the ligatures, but this is what happens in luatex.
>>> 
>>> IMO that's a desireable behaviour, not a bug. See Bringhurst, Oliver Simon's _Introduction to Typography_ &c.
>>> 
>>> A control to turn it off or on (defaulting to disabling the ligatures) would be okay, but I've had to put a lot of effort into turning off ligatures when letterspacing and it's a pain.
>> 
>> In older german texts ligatures are not letter spaced. For example:
>> 
>> B i s m a r ck
>> 
>> (the ck ligature is not seperated)
> 
> Neither was ij in dutch, but ff was separated. Which just goes to show
> you that doing letterspacing automatically is hard....

ck and ij would be (like ae and oe) diphthongs --- linguistic constructs denoting specific sounds.

ff is a ligature --- the joining together of two or more characters for stylistic or technical reasons.

William

-- 
William Adams
senior graphic designer
Fry Communications
Sphinx of black quartz, judge my vow.


From will.adams at frycomm.com  Thu Feb 10 14:32:34 2011
From: will.adams at frycomm.com (William Adams)
Date: Thu, 10 Feb 2011 08:32:34 -0500
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D53E1E1.7050309@elvenkind.com>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
	<4D53E1E1.7050309@elvenkind.com>
Message-ID: <FBA3FE50-77DB-4066-8C88-C3599C4FC20B@frycomm.com>

On Feb 10, 2011, at 8:02 AM, Taco Hoekwater wrote:

> But there is no distinction between those two in OpenType ...

Couldn't one create that distinction by how one sets the text?

Directly input the unicode character for the diphthongs, while allowing the ligatures to be constructed by OpenType rules --- that way the diphthongs would be left alone in situations like this, while ligatures would never be made when not appropriate.

I thought this was the whole point behind the Unicode Consortium choosing not to allocate code points for ligatures.

William

-- 
William Adams
senior graphic designer
Fry Communications
Sphinx of black quartz, judge my vow.


From patrick at gundla.ch  Thu Feb 10 14:45:31 2011
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 10 Feb 2011 14:45:31 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <FBA3FE50-77DB-4066-8C88-C3599C4FC20B@frycomm.com>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
	<4D53E1E1.7050309@elvenkind.com>
	<FBA3FE50-77DB-4066-8C88-C3599C4FC20B@frycomm.com>
Message-ID: <B0E7A280-C4F1-4058-9A8F-DDF90005D998@gundla.ch>


> Couldn't one create that distinction by how one sets the text?
> 
> Directly input the unicode character for the diphthongs, while allowing the ligatures to be constructed by OpenType rules --- that way the diphthongs would be left alone in situations like this, while ligatures would never be made when not appropriate.

But then it would be a matter of the backend, not LuaTeX (except for \letterspacefont), right?

> I thought this was the whole point behind the Unicode Consortium choosing not to allocate code points for ligatures.

what about U+FB03 for example? (LATIN SMALL LIGATURE FFI)


Perhaps I misunderstood you.

Patrick


From will.adams at frycomm.com  Thu Feb 10 14:49:26 2011
From: will.adams at frycomm.com (William Adams)
Date: Thu, 10 Feb 2011 08:49:26 -0500
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <B0E7A280-C4F1-4058-9A8F-DDF90005D998@gundla.ch>
References: <4D52DB7D.7000803@gmx.net>	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
	<4D53E1E1.7050309@elvenkind.com>
	<FBA3FE50-77DB-4066-8C88-C3599C4FC20B@frycomm.com>
	<B0E7A280-C4F1-4058-9A8F-DDF90005D998@gundla.ch>
Message-ID: <75881ACF-A7AE-46A0-B615-311EAD0FEBCC@frycomm.com>

On Feb 10, 2011, at 8:45 AM, Patrick Gundlach wrote:

>> Couldn't one create that distinction by how one sets the text?
>> 
>> Directly input the unicode character for the diphthongs, while allowing the ligatures to be constructed by OpenType rules --- that way the diphthongs would be left alone in situations like this, while ligatures would never be made when not appropriate.
> 
> But then it would be a matter of the backend, not LuaTeX (except for \letterspacefont), right?

Yep.

>> I thought this was the whole point behind the Unicode Consortium choosing not to allocate code points for ligatures.
> 
> what about U+FB03 for example? (LATIN SMALL LIGATURE FFI)
> 
> 
> Perhaps I misunderstood you.

No. I should've been more specific ``...the whole point behind the Unicode consortium choosing not to allocate any additional code points for ligatures beyond those which were provided for legacy's sake.''

William

-- 
William Adams
senior graphic designer
Fry Communications
Sphinx of black quartz, judge my vow.


From arthur.reutenauer at normalesup.org  Thu Feb 10 14:57:55 2011
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Thu, 10 Feb 2011 13:57:55 +0000
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <B0E7A280-C4F1-4058-9A8F-DDF90005D998@gundla.ch>
References: <4D52DB7D.7000803@gmx.net>
	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
	<4D53E1E1.7050309@elvenkind.com>
	<FBA3FE50-77DB-4066-8C88-C3599C4FC20B@frycomm.com>
	<B0E7A280-C4F1-4058-9A8F-DDF90005D998@gundla.ch>
Message-ID: <20110210135755.GH12314@phare.normalesup.org>

>> I thought this was the whole point behind the Unicode Consortium choosing not to allocate code points for ligatures.
> 
> what about U+FB03 for example? (LATIN SMALL LIGATURE FFI)

  As William says, this is for compatibility with a legacy encoding,
just as the hundreds of Arabic "presentation forms" that lurk nearby.
But, for that matter, this is also the reason for inclusion of the ij
ligature (U+0132 LATIN CAPITAL LIGATURE IJ and lowercase U+0133).

	Arthur

From w.m.l at gmx.net  Thu Feb 10 15:18:31 2011
From: w.m.l at gmx.net (Robert)
Date: Thu, 10 Feb 2011 15:18:31 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D5376DB.8000800@elvenkind.com>
References: <4D52DB7D.7000803@gmx.net> <4D5376DB.8000800@elvenkind.com>
Message-ID: <4D53F3B7.5030100@gmx.net>

On 10.02.11 06:25, Taco Hoekwater wrote:
> I've created a tracker item, but I am not sure yet whether either of
> them is actually a bug or simply a incompatibility.

I would call it an incompatibility bug ;-)

As others have noted, some ligatures in letterspaced text shouldn't be 
broken. If \letterspacefont now disables all ligatures, this is no 
longer possible except by changing the font for each and every such 
ligature (and even for "--", "<<" etc.). This renders \letterspacefont 
basically useless.

And to consider the fact that \tagcode and \pdfnoligatures are virtually 
no-ops as an incompatibility sounds like a strong euphemism to me...

Of course, one could always use lua code, but if you provide the pdftex 
commands at all, I think they should function in a sensible way.

Regards,
-- 
  Robert

From taco at elvenkind.com  Thu Feb 10 18:58:16 2011
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 10 Feb 2011 18:58:16 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D53F3B7.5030100@gmx.net>
References: <4D52DB7D.7000803@gmx.net> <4D5376DB.8000800@elvenkind.com>
	<4D53F3B7.5030100@gmx.net>
Message-ID: <57BEF102-91CD-43B8-B083-2501371BF138@elvenkind.com>



On 10 feb. 2011, at 15:18, Robert <w.m.l at gmx.net> wrote:

> On 10.02.11 06:25, Taco Hoekwater wrote:
>> I've created a tracker item, but I am not sure yet whether either of
>> them is actually a bug or simply a incompatibility.
> 
> I would call it an incompatibility bug ;-)
> 
> As others have noted, some ligatures in letterspaced text shouldn't be broken. If \letterspacefont now disables all ligatures, this is no longer possible except by changing the font for each and every such ligature (and even for "--", "<<" etc.). This renders \letterspacefont basically useless.
> 
That is a convincing argument, i will try to fix \letterspacefont

> And to consider the fact that \tagcode and \pdfnoligatures are virtually no-ops as an incompatibility sounds like a strong euphemism to me...
> 
This is a different matter, i suspect that these primitives can only be
Made to work with legacy fonts. Which would be an acceptable
Compromise, i guess

Best wishes,
Taco

From khaledhosny at eglug.org  Thu Feb 10 20:03:33 2011
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 10 Feb 2011 21:03:33 +0200
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <4D53E1E1.7050309@elvenkind.com>
References: <4D52DB7D.7000803@gmx.net>
	<3CFCDC9B-4D1C-44FA-A34D-E14B94E4C7C5@frycomm.com>
	<0381E2A8-F6CB-4590-9663-EF56AACCFBE8@gundla.ch>
	<4D53E085.1060703@elvenkind.com>
	<06746691-703E-4A65-AC5E-A29892C4EDF6@frycomm.com>
	<4D53E1E1.7050309@elvenkind.com>
Message-ID: <20110210190332.GA3077@khaled-laptop>

On Thu, Feb 10, 2011 at 02:02:25PM +0100, Taco Hoekwater wrote:
> 
> 
> On 02/10/11 13:59, William Adams wrote:
> > 
> > ck and ij would be (like ae and oe) diphthongs --- linguistic constructs denoting specific sounds.
> > 
> > ff is a ligature --- the joining together of two or more characters for stylistic or technical reasons.
> 
> But there is no distinction between those two in OpenType ...

There can be, you can use rlig (required ligatures) for the former and
liga (regular ligatures for the later) and letterspaced fonts would only
disable liga (I know few Frakture fonts that do it that way). But this
is likely to be a question to Hans not Taco since we are dealing with
non-tfm fonts here.

Regards,
 Khaled

-- 
 Khaled Hosny
 Egyptian

From w.m.l at gmx.net  Fri Feb 11 00:40:50 2011
From: w.m.l at gmx.net (Robert)
Date: Fri, 11 Feb 2011 00:40:50 +0100
Subject: [Dev-luatex] letterspacing and (no) ligatures
In-Reply-To: <57BEF102-91CD-43B8-B083-2501371BF138@elvenkind.com>
References: <4D52DB7D.7000803@gmx.net> <4D5376DB.8000800@elvenkind.com>
	<4D53F3B7.5030100@gmx.net>
	<57BEF102-91CD-43B8-B083-2501371BF138@elvenkind.com>
Message-ID: <4D547782.5060306@gmx.net>

On 10.02.11 18:58, Taco Hoekwater wrote:
 > Which would be an acceptable Compromise, i guess

Yes, OK.
Thanks,
-- 
  Robert

From pragma at wxs.nl  Sat Feb 12 12:54:11 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 12 Feb 2011 12:54:11 +0100
Subject: [Dev-luatex] mkiv/metapost torture test
In-Reply-To: <AANLkTinoKVYy+Vf4_WVOHqD3D0WWB--+bGHU8AazuFJ7@mail.gmail.com>
References: <AANLkTinoKVYy+Vf4_WVOHqD3D0WWB--+bGHU8AazuFJ7@mail.gmail.com>
Message-ID: <4D5674E3.50008@wxs.nl>

On 12-2-2011 11:27, Mojca Miklavec wrote:

> I forced \stoptext around line 5688 since it consumes all the
> available memory (approximately 3 GB) and then takes forever to
> proceed any further. You can try to remove those 10 lines and try to
> compile the whole document in case it succeds.

all these bytes go into the tex parser and get tokenized (which takes 
mem) and then stringified again when passed to mp etc etc

how about using a temp file for > 5K data .. i can provide a function 
for reading that in directly

i'll play a bit more with it later

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Sat Feb 12 12:59:29 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 12 Feb 2011 12:59:29 +0100
Subject: [Dev-luatex] mkiv/metapost torture test
In-Reply-To: <4D5674E3.50008@wxs.nl>
References: <AANLkTinoKVYy+Vf4_WVOHqD3D0WWB--+bGHU8AazuFJ7@mail.gmail.com>
	<4D5674E3.50008@wxs.nl>
Message-ID: <4D567621.4060503@wxs.nl>

On 12-2-2011 12:54, Hans Hagen wrote:

>> I forced \stoptext around line 5688 since it consumes all the
 > ...

sorry, this was meant for luigi not this list (wrong adressbook completion)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From heiko.oberdiek at googlemail.com  Sat Feb 19 13:38:27 2011
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Sat, 19 Feb 2011 13:38:27 +0100
Subject: [Dev-luatex] [luatex] Line breaks
In-Reply-To: <4D5FA8BB.8080000@free.fr>
References: <20110219111222.GC7513@rondloper>
 <4D5FA8BB.8080000@free.fr>
Message-ID: <20110219123827.GB20189@oberdiek.my-fqdn.de>

On Sat, Feb 19, 2011 at 12:25:47PM +0100, Paul Isambert wrote:

> Le 19/02/2011 12:12, Dirk Laurie a ?crit :
> >The following are not equivalent on my system (texlive, ubuntu lucid):
> >
> >% excerpt from TeX file
> >This is a paragraph
> >with some lines.
> >
> >This is another paragraph,
> >separated from the first
> >by a blank line.
> >% end excerpt
> >
> >% another excerpt
> >\directlua{ text = [[
> >This is a paragraph
> >with some lines.
> >
> >This is another paragraph,
> >separated from the first
> >by a blank line. ]]
> >tex.print(text)}
> >% end excerpt
> >
> >The second excerpt sets as a single paragraph.
> 
> Which confirms something I'd been suspecting for a while but never
> really investigated: blank lines aren't turned into \par in
> \directlua,

No, the conversion is done by TeX, \directlua sees the \par then.
But tex.print removes the \par, perhaps because of

| Each string argument is treated by TEX as a separate input line.

Also interesting:

| The very last string of the very last tex.print() command in a
| \directlua will not have the \endlinechar appended, all others do.

But a statement about \par filtering of tex.print() would be useful
for the documentation.

Minimal example (luatex --ini):

\catcode`\{=1
\catcode`\}=2
\expandafter\def\expandafter\x\expandafter{%
  \directlua{tex.print('a \par b')}%
}\show\x
\csname @@end\endcsname\end

Result: "a b"

Yours sincerely
  Heiko Oberdiek

From zappathustra at free.fr  Sat Feb 19 13:41:30 2011
From: zappathustra at free.fr (Paul Isambert)
Date: Sat, 19 Feb 2011 13:41:30 +0100
Subject: [Dev-luatex] [luatex] Line breaks
In-Reply-To: <20110219123827.GB20189@oberdiek.my-fqdn.de>
References: <20110219111222.GC7513@rondloper> <4D5FA8BB.8080000@free.fr>
	<20110219123827.GB20189@oberdiek.my-fqdn.de>
Message-ID: <4D5FBA7A.40203@free.fr>

Le 19/02/2011 13:38, Heiko Oberdiek a ?crit :
> On Sat, Feb 19, 2011 at 12:25:47PM +0100, Paul Isambert wrote:
>
>> Le 19/02/2011 12:12, Dirk Laurie a ?crit :
>>> The following are not equivalent on my system (texlive, ubuntu lucid):
>>>
>>> % excerpt from TeX file
>>> This is a paragraph
>>> with some lines.
>>>
>>> This is another paragraph,
>>> separated from the first
>>> by a blank line.
>>> % end excerpt
>>>
>>> % another excerpt
>>> \directlua{ text = [[
>>> This is a paragraph
>>> with some lines.
>>>
>>> This is another paragraph,
>>> separated from the first
>>> by a blank line. ]]
>>> tex.print(text)}
>>> % end excerpt
>>>
>>> The second excerpt sets as a single paragraph.
>> Which confirms something I'd been suspecting for a while but never
>> really investigated: blank lines aren't turned into \par in
>> \directlua,
> No, the conversion is done by TeX, \directlua sees the \par then.

Then

\directlua{

foo = 1}

should be read as "\parfoo=1", and it isn't. Or is there something I'm 
missing?

Paul

From heiko.oberdiek at googlemail.com  Sat Feb 19 14:05:18 2011
From: heiko.oberdiek at googlemail.com (Heiko Oberdiek)
Date: Sat, 19 Feb 2011 14:05:18 +0100
Subject: [Dev-luatex] [luatex]   Line breaks
In-Reply-To: <4D5FBA7A.40203@free.fr>
References: <20110219111222.GC7513@rondloper> <4D5FA8BB.8080000@free.fr>
	<20110219123827.GB20189@oberdiek.my-fqdn.de>
	<4D5FBA7A.40203@free.fr>
Message-ID: <20110219130517.GA20496@oberdiek.my-fqdn.de>

On Sat, Feb 19, 2011 at 01:41:30PM +0100, Paul Isambert wrote:

> >No, the conversion is done by TeX, \directlua sees the \par then.
> 
> Then
> 
> \directlua{
> 
> foo = 1}
> 
> should be read as "\parfoo=1", and it isn't. Or is there something
> I'm missing?

Yes, you example and some testing shows, that it isn't tex.print,
but \directlua seems to remove \par if it has its original meaning.

  \def\par{bar}
  \directlua{

  foo = 1}

Then Lua sees "barfoo = 1".

Something like the following should fix the OP's problem:

\begingroup
  \def\par{\endgraf}
  \directlua{
    text = [[
      This is a paragraph
      with some lines.

      This is another paragraph,
      separated from the first
      by a blank line. ]]
    tex.print(text)
  }
\endgroup

Yours sincerely
  Heiko Oberdiek

From zappathustra at free.fr  Sat Feb 19 14:25:05 2011
From: zappathustra at free.fr (Paul Isambert)
Date: Sat, 19 Feb 2011 14:25:05 +0100
Subject: [Dev-luatex] [luatex]   Line breaks
In-Reply-To: <20110219130517.GA20496@oberdiek.my-fqdn.de>
References: <20110219111222.GC7513@rondloper> <4D5FA8BB.8080000@free.fr>
	<20110219123827.GB20189@oberdiek.my-fqdn.de>
	<4D5FBA7A.40203@free.fr>
	<20110219130517.GA20496@oberdiek.my-fqdn.de>
Message-ID: <4D5FC4B1.6070902@free.fr>

Le 19/02/2011 14:05, Heiko Oberdiek a ?crit :
> On Sat, Feb 19, 2011 at 01:41:30PM +0100, Paul Isambert wrote:
>
>>> No, the conversion is done by TeX, \directlua sees the \par then.
>> Then
>>
>> \directlua{
>>
>> foo = 1}
>>
>> should be read as "\parfoo=1", and it isn't. Or is there something
>> I'm missing?
> Yes, you example and some testing shows, that it isn't tex.print,
> but \directlua seems to remove \par if it has its original meaning.

So I guess it's definitely a feature (quite useful), not a bug. But that 
should be mentioned in the manual.

Best,
Paul

From indiego at gmx.net  Sat Feb 19 15:04:27 2011
From: indiego at gmx.net (Peter Rolf)
Date: Sat, 19 Feb 2011 15:04:27 +0100
Subject: [Dev-luatex] mediabox accuracy
Message-ID: <4D5FCDEB.1060108@gmx.net>

Hi,

I have a preflighting problem caused by a badly rounded (too small)
mediabox. This following snippet is taken from that pdf.

93 0 obj
<<
/Type /Page
/Contents 94 0 R
/Resources 92 0 R
/MediaBox [0 0 923.24 585.99]
/TrimBox [ 0.0000 0.0000 923.2440 585.9925 ] /CropBox [ 0.0000 0.0000
923.2440 585.9925 ]
/Parent 98 0 R
>>

The mediabox accuracy is swayed by \pdfdecimaldigits (here
\pdfdecimaldigits=2), while the other boxes use a fixed accuracy (four
points after the digit).
I see two solutions:

1. use the same fixed accuracy for all boxes
2. use the same accuracy given by \pdfdecimaldigits for all boxes

I guess the second solution can still cause problems due to runtime
changes of \pdfdecimaldigits (unless this is a 'write once' register)

Test file (ConTeXt) is attached.

Tested with trunk beta-0.65.0-2011010308 (rev 4050) and
beta-0.66.0-2011021618 (rev 4086) on Windows Vista.


Peter
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdfboxes.tex
Type: text/x-tex
Size: 460 bytes
Desc: not available
URL: <http://www.ntg.nl/pipermail/dev-luatex/attachments/20110219/59f11352/attachment.tex>

From pragma at wxs.nl  Sat Feb 19 23:58:12 2011
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 19 Feb 2011 23:58:12 +0100
Subject: [Dev-luatex] mediabox accuracy
In-Reply-To: <4D5FCDEB.1060108@gmx.net>
References: <4D5FCDEB.1060108@gmx.net>
Message-ID: <4D604B04.7060703@wxs.nl>

On 19-2-2011 3:04, Peter Rolf wrote:
> Hi,
>
> I have a preflighting problem caused by a badly rounded (too small)
> mediabox. This following snippet is taken from that pdf.
>
> 93 0 obj
> <<
> /Type /Page
> /Contents 94 0 R
> /Resources 92 0 R
> /MediaBox [0 0 923.24 585.99]
> /TrimBox [ 0.0000 0.0000 923.2440 585.9925 ] /CropBox [ 0.0000 0.0000
> 923.2440 585.9925 ]
> /Parent 98 0 R
>>>
>
> The mediabox accuracy is swayed by \pdfdecimaldigits (here
> \pdfdecimaldigits=2), while the other boxes use a fixed accuracy (four
> points after the digit).
> I see two solutions:
>
> 1. use the same fixed accuracy for all boxes
> 2. use the same accuracy given by \pdfdecimaldigits for all boxes
>
> I guess the second solution can still cause problems due to runtime
> changes of \pdfdecimaldigits (unless this is a 'write once' register)
>
> Test file (ConTeXt) is attached.

this probably does not belong here (e.g. trimbox etc are written by the 
macro package) so best move this thread to the context list


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From beingalink at googlemail.com  Mon Feb 21 20:52:20 2011
From: beingalink at googlemail.com (Beingalink)
Date: Mon, 21 Feb 2011 20:52:20 +0100
Subject: [Dev-luatex] Proposal for a change in otfl-luat-dum.lua
Message-ID: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>

To be able to use fonts inside a dfont archive (Helvetica for example) I had to change line 59 in otfl-luat-dum.lua to "    dfont = "truetype fonts",". When I updated my mactex 2010 installation a few days ago, the file got overwritten and I had to do the change again. I'm not sure if there is a better/cleaner solution but since this small change works for me, this could at least be used as a temporary fix.


From khaledhosny at eglug.org  Mon Feb 21 21:11:13 2011
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 21 Feb 2011 22:11:13 +0200
Subject: [Dev-luatex] Proposal for a change in otfl-luat-dum.lua
In-Reply-To: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>
References: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>
Message-ID: <20110221201113.GA11399@khaled-laptop>

On Mon, Feb 21, 2011 at 08:52:20PM +0100, Beingalink wrote:
> To be able to use fonts inside a dfont archive (Helvetica for example)
> I had to change line 59 in otfl-luat-dum.lua to "    dfont = "truetype
> fonts",". When I updated my mactex 2010 installation a few days ago,
> the file got overwritten and I had to do the change again. I'm not
> sure if there is a better/cleaner solution but since this small change
> works for me, this could at least be used as a temporary fix.

What is the original problem that you had to fix?

Regards,
 Khaled

-- 
 Khaled Hosny
 Egyptian
 Arab

From beingalink at googlemail.com  Mon Feb 21 21:15:58 2011
From: beingalink at googlemail.com (Beingalink)
Date: Mon, 21 Feb 2011 21:15:58 +0100
Subject: [Dev-luatex] Proposal for a change in otfl-luat-dum.lua
In-Reply-To: <20110221201113.GA11399@khaled-laptop>
References: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>
	<20110221201113.GA11399@khaled-laptop>
Message-ID: <43649335-53DB-46A3-B5E3-0AD6E5D3C69F@googlemail.com>

For example following scenario didn't work:
\setsansfont[Scale=MatchLowercase,Ligatures=TeX]{Helvetica}

With the change I described it works just fine.



Am 21.02.2011 um 21:11 schrieb Khaled Hosny:

> On Mon, Feb 21, 2011 at 08:52:20PM +0100, Beingalink wrote:
>> To be able to use fonts inside a dfont archive (Helvetica for example)
>> I had to change line 59 in otfl-luat-dum.lua to "    dfont = "truetype
>> fonts",". When I updated my mactex 2010 installation a few days ago,
>> the file got overwritten and I had to do the change again. I'm not
>> sure if there is a better/cleaner solution but since this small change
>> works for me, this could at least be used as a temporary fix.
> 
> What is the original problem that you had to fix?
> 
> Regards,
> Khaled
> 
> -- 
> Khaled Hosny
> Egyptian
> Arab


From khaledhosny at eglug.org  Mon Feb 21 21:20:45 2011
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 21 Feb 2011 22:20:45 +0200
Subject: [Dev-luatex] Proposal for a change in otfl-luat-dum.lua
In-Reply-To: <43649335-53DB-46A3-B5E3-0AD6E5D3C69F@googlemail.com>
References: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>
	<20110221201113.GA11399@khaled-laptop>
	<43649335-53DB-46A3-B5E3-0AD6E5D3C69F@googlemail.com>
Message-ID: <20110221202045.GA11473@khaled-laptop>

This don't tell much, does not work in what sense (I neither have the
font nor a mac machine to test myself).

Regards,
 Khaled


On Mon, Feb 21, 2011 at 09:15:58PM +0100, Beingalink wrote:
> For example following scenario didn't work:
> \setsansfont[Scale=MatchLowercase,Ligatures=TeX]{Helvetica}
> 
> With the change I described it works just fine.
> 
> 
> 
> Am 21.02.2011 um 21:11 schrieb Khaled Hosny:
> 
> > On Mon, Feb 21, 2011 at 08:52:20PM +0100, Beingalink wrote:
> >> To be able to use fonts inside a dfont archive (Helvetica for example)
> >> I had to change line 59 in otfl-luat-dum.lua to "    dfont = "truetype
> >> fonts",". When I updated my mactex 2010 installation a few days ago,
> >> the file got overwritten and I had to do the change again. I'm not
> >> sure if there is a better/cleaner solution but since this small change
> >> works for me, this could at least be used as a temporary fix.
> > 
> > What is the original problem that you had to fix?
> > 
> > Regards,
> > Khaled
> > 
> > -- 
> > Khaled Hosny
> > Egyptian
> > Arab

-- 
 Khaled Hosny
 Egyptian
 Arab

From beingalink at googlemail.com  Mon Feb 21 21:27:15 2011
From: beingalink at googlemail.com (Beingalink)
Date: Mon, 21 Feb 2011 21:27:15 +0100
Subject: [Dev-luatex] Proposal for a change in otfl-luat-dum.lua
In-Reply-To: <20110221202045.GA11473@khaled-laptop>
References: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>
	<20110221201113.GA11399@khaled-laptop>
	<43649335-53DB-46A3-B5E3-0AD6E5D3C69F@googlemail.com>
	<20110221202045.GA11473@khaled-laptop>
Message-ID: <A32CE9F4-6C2C-4CB6-85AC-7E0C15DC4FEE@googlemail.com>

I already posted to the mailing list about this problem: http://www.mail-archive.com/dev-luatex at ntg.nl/msg02392.html
If you need even more information, just tell me.

Regards,
Tobias Link


Am 21.02.2011 um 21:20 schrieb Khaled Hosny:

> This don't tell much, does not work in what sense (I neither have the
> font nor a mac machine to test myself).
> 
> Regards,
> Khaled
> 
> 
> On Mon, Feb 21, 2011 at 09:15:58PM +0100, Beingalink wrote:
>> For example following scenario didn't work:
>> \setsansfont[Scale=MatchLowercase,Ligatures=TeX]{Helvetica}
>> 
>> With the change I described it works just fine.
>> 
>> 
>> 
>> Am 21.02.2011 um 21:11 schrieb Khaled Hosny:
>> 
>>> On Mon, Feb 21, 2011 at 08:52:20PM +0100, Beingalink wrote:
>>>> To be able to use fonts inside a dfont archive (Helvetica for example)
>>>> I had to change line 59 in otfl-luat-dum.lua to "    dfont = "truetype
>>>> fonts",". When I updated my mactex 2010 installation a few days ago,
>>>> the file got overwritten and I had to do the change again. I'm not
>>>> sure if there is a better/cleaner solution but since this small change
>>>> works for me, this could at least be used as a temporary fix.
>>> 
>>> What is the original problem that you had to fix?
>>> 
>>> Regards,
>>> Khaled
>>> 
>>> -- 
>>> Khaled Hosny
>>> Egyptian
>>> Arab
> 
> -- 
> Khaled Hosny
> Egyptian
> Arab


From khaledhosny at eglug.org  Mon Feb 21 21:45:43 2011
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 21 Feb 2011 22:45:43 +0200
Subject: [Dev-luatex] Proposal for a change in otfl-luat-dum.lua
In-Reply-To: <A32CE9F4-6C2C-4CB6-85AC-7E0C15DC4FEE@googlemail.com>
References: <8868CE28-17B9-419F-92EA-9302B6AF788C@googlemail.com>
	<20110221201113.GA11399@khaled-laptop>
	<43649335-53DB-46A3-B5E3-0AD6E5D3C69F@googlemail.com>
	<20110221202045.GA11473@khaled-laptop>
	<A32CE9F4-6C2C-4CB6-85AC-7E0C15DC4FEE@googlemail.com>
Message-ID: <20110221204543.GA12841@khaled-laptop>


Oh, I missed that. Thanks for the report, will be fixed for the next
release.

Regards,
 Khaled

On Mon, Feb 21, 2011 at 09:27:15PM +0100, Beingalink wrote:
> I already posted to the mailing list about this problem: http://www.mail-archive.com/dev-luatex at ntg.nl/msg02392.html
> If you need even more information, just tell me.
> 
> Regards,
> Tobias Link
> 
> 
> Am 21.02.2011 um 21:20 schrieb Khaled Hosny:
> 
> > This don't tell much, does not work in what sense (I neither have the
> > font nor a mac machine to test myself).
> > 
> > Regards,
> > Khaled
> > 
> > 
> > On Mon, Feb 21, 2011 at 09:15:58PM +0100, Beingalink wrote:
> >> For example following scenario didn't work:
> >> \setsansfont[Scale=MatchLowercase,Ligatures=TeX]{Helvetica}
> >> 
> >> With the change I described it works just fine.
> >> 
> >> 
> >> 
> >> Am 21.02.2011 um 21:11 schrieb Khaled Hosny:
> >> 
> >>> On Mon, Feb 21, 2011 at 08:52:20PM +0100, Beingalink wrote:
> >>>> To be able to use fonts inside a dfont archive (Helvetica for example)
> >>>> I had to change line 59 in otfl-luat-dum.lua to "    dfont = "truetype
> >>>> fonts",". When I updated my mactex 2010 installation a few days ago,
> >>>> the file got overwritten and I had to do the change again. I'm not
> >>>> sure if there is a better/cleaner solution but since this small change
> >>>> works for me, this could at least be used as a temporary fix.
> >>> 
> >>> What is the original problem that you had to fix?
> >>> 
> >>> Regards,
> >>> Khaled
> >>> 
> >>> -- 
> >>> Khaled Hosny
> >>> Egyptian
> >>> Arab
> > 
> > -- 
> > Khaled Hosny
> > Egyptian
> > Arab

-- 
 Khaled Hosny
 Egyptian
 Arab

From root at mail.boekplan.nl  Wed Feb 23 12:27:58 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed, 23 Feb 2011 12:27:58 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110223112759.49D9040049@mail.boekplan.nl>

------------------------------------------------------------------------
r4087 | taco | 2011-02-23 11:32:30 +0100 (Wed, 23 Feb 2011) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.w

Initialize the static node's types

------------------------------------------------------------------------

From root at mail.boekplan.nl  Wed Feb 23 16:27:36 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed, 23 Feb 2011 16:27:36 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110223152736.6CA3540049@mail.boekplan.nl>

------------------------------------------------------------------------
r4088 | taco | 2011-02-23 16:00:10 +0100 (Wed, 23 Feb 2011) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.w

fix crash on  token.csname_id ("")

------------------------------------------------------------------------

From zappathustra at free.fr  Wed Feb 23 17:37:57 2011
From: zappathustra at free.fr (Paul Isambert)
Date: Wed, 23 Feb 2011 17:37:57 +0100
Subject: [Dev-luatex] [luatex]   Line breaks
In-Reply-To: <20110219130517.GA20496@oberdiek.my-fqdn.de>
References: <20110219130517.GA20496@oberdiek.my-fqdn.de>
Message-ID: <4D6537E5.4030809@free.fr>

Heiko said:

	Yes, you example and some testing shows, that it isn't tex.print,
	but \directlua seems to remove \par if it has its original meaning.

	  \def\par{bar}
	  \directlua{

	  foo = 1}

	Then Lua sees "barfoo = 1".



Actually, have I just noticed, \par is removed if it is unexpandable, whatever its definition:

\bgroup
\protected\def\par{par}
\directlua{texio.write_nl("foo\par")}
\egroup

prints "foo".
And it is a feature, Taco says.

Best,
Paul


From root at mail.boekplan.nl  Mon Feb 28 12:28:21 2011
From: root at mail.boekplan.nl (Cron Daemon)
Date: Mon, 28 Feb 2011 12:28:21 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20110228112821.9845C4005B@mail.boekplan.nl>

------------------------------------------------------------------------
r4089 | taco | 2011-02-28 09:12:59 +0100 (Mon, 28 Feb 2011) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

fix an unclarity in the local_par description

------------------------------------------------------------------------
r4090 | taco | 2011-02-28 09:51:20 +0100 (Mon, 28 Feb 2011) | 8 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.h

fix two small issues with the lua node interface:

* for some node types, node.has_field() would crash
* for the 'Auxiliary items' (section 8.1.1), luatex
  would incorrectly return true on has_field('subtype') and
  has_field('prev')


------------------------------------------------------------------------

From toralf.foerster at gmx.de  Mon Feb 28 21:26:46 2011
From: toralf.foerster at gmx.de (Toralf =?utf-8?q?F=C3=B6rster?=)
Date: Mon, 28 Feb 2011 21:26:46 +0100
Subject: [Dev-luatex] dev-tex/luatex-0.63.0: gives a warning under Gentoo
Message-ID: <201102282126.46564.toralf.foerster@gmx.de>

   usr/bin/luatex

 * QA Notice: Package has poor programming practices which may compile
 *            fine but exhibit random runtime failures.
 * luatexdir/luafontloader/fontforge/fontforge/nouiutil.c:49: warning: attempt 
to free a non-heap object 'buffer'

 * Please do not file a Gentoo bug and instead report the above QA
 * issues directly to the upstream developers of this software.
 * Homepage: http://www.luatex.org/


-- 
MfG/Kind regards
Toralf F?rster

pgp finger print: 7B1A 07F4 EC82 0F90 D4C2 8936 872A E508 7DB6 9DA3


