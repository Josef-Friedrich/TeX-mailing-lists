From taco at elvenkind.com  Wed Aug  2 17:24:09 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 02 Aug 2006 17:24:09 +0200
Subject: [Dev-luatex] Major commit today
Message-ID: <44D0C399.6020509@elvenkind.com>

Hi,

I have just committed an initial merge of the rest of Aleph.
Code status = alpha, of course; what did you expect? ;-).

If \pdfoutput=1, then the resulting binary is essentially
an unchanged pdfetex 1.40-beta-20060213, except that:

* there is no way to turn eTeX off
* My \clearmarks patch is included
* TeXXeT is removed. Missing primitives from pdfeTeX:

   \TeXXeTstate
   \beginL
   \beginR
   \endL
   \endR

Therefore, PDF mode is Left-to-Right only for the time
being. OTOH, it should be possible to use the '8-bit'
extensions provided by Aleph like "fi" stretchability,
\localleftbox, and math extensions, and even ocp
processing (as long as you stick to 8-bit glyph indices).

If \pdfoutput=0, then it is roughly equivalent to aleph-rc2.
The following primitives from Aleph are not present:

   \AlephVersion
   \Alephminorversion
   \Alephrevision
   \Alephversion
   \OmegaVersion
   \Omegaminorversion
   \Omegarevision
   \Omegaversion
   \eTeXVersion
   \eTeXminorversion

   \chardp        (use eTeX's \fontchardp)
   \charht        (use eTeX's \fontcharht)
   \charit        (use eTeX's \fontcharit)
   \charwd        (use eTeX's \fontcharwd)
   \pageheight    (use pdfTeX \pdfpageheight)
   \pagewidth     (use pdfTeX \pdfpagewidth)


The split between 'pdftex' and 'aleph' modes is likely
to stay for a while. It was not very hard to simply add
the aleph dvi code, but implementing a pdf backend to
aleph will take quite a lot longer.

I will spend the rest of this week as well as next week
debugging the merge (so that it will not be possible
to make it segfault any more), updating to aleph-rc4
and pdftex-beta-20060725, and documenting all the changes
I have made to make both engines cooperate.

Hopefully, by the end of next week there will be something
that is usable/testable by non-debugger-happy people.

Cheers,
Taco

From root at aanhet.net  Wed Aug  2 22:22:09 2006
From: root at aanhet.net (Cron Daemon)
Date: Wed,  2 Aug 2006 22:22:09 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060802202209.D9D7C2800087@server.aanhet.net>

U  luatex/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 U  luatex/src/texk/web2c/luatexdir/luatex.c
 U  luatex/src/texk/web2c/luatexdir/luatex.h
 U  luatex/src/texk/web2c/luatexdir/luatex.defines
 U  luatex/src/texk/web2c/lib/texmfmp.c
 U  luatex/src/texk/web2c/web2c/convert
 U  luatex/src/texk/web2c/web2c/main.c
 Checked out revision 73.

From taco at elvenkind.com  Thu Aug  3 20:37:12 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 03 Aug 2006 20:37:12 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <44D0C399.6020509@elvenkind.com>
References: <44D0C399.6020509@elvenkind.com>
Message-ID: <44D24258.9080200@elvenkind.com>

Taco Hoekwater wrote:
> The following primitives from Aleph are not present:
> 
>    \AlephVersion
>    \Alephminorversion
>    \Alephrevision
>    \Alephversion
>    \OmegaVersion
>    \Omegaminorversion
>    \Omegarevision
>    \Omegaversion
>    \eTeXVersion
>    \eTeXminorversion
>
>    \chardp        (use eTeX's \fontchardp)
>    \charht        (use eTeX's \fontcharht)
>    \charit        (use eTeX's \fontcharit)
>    \charwd        (use eTeX's \fontcharwd)
>    \pageheight    (use pdfTeX \pdfpageheight)
>    \pagewidth     (use pdfTeX \pdfpagewidth)

All reinstated. Not having them available was just unwieldy. The
last six are all aliases of eachother: \pageheight and \pdfpageheight
map to the same command code (\meaning shows \pageheight, I believe).

I have fixed some bugs today, and I have reverted back to strict
Unicode (2^20+2^16 possible characters instead of 2^21) because
in the current layout, that saves near 300Mb in virtual memory size.
Eventually, the affected arrays will become lua hashes, and we can
safely go back to 2^21 then.

Cheers, Taco

From root at aanhet.net  Thu Aug  3 22:22:13 2006
From: root at aanhet.net (Cron Daemon)
Date: Thu,  3 Aug 2006 22:22:13 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060803202213.EF93F2800085@server.aanhet.net>

U  luatex/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 Checked out revision 74.

From pragma at wxs.nl  Fri Aug  4 00:53:08 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 04 Aug 2006 00:53:08 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <44D24258.9080200@elvenkind.com>
References: <44D0C399.6020509@elvenkind.com> <44D24258.9080200@elvenkind.com>
Message-ID: <44D27E54.20400@wxs.nl>

Taco Hoekwater wrote:
> Taco Hoekwater wrote:
>   
>> The following primitives from Aleph are not present:
>>
>>    \AlephVersion
>>    \Alephminorversion
>>    \Alephrevision
>>    \Alephversion
>>    \OmegaVersion
>>    \Omegaminorversion
>>    \Omegarevision
>>    \Omegaversion
>>    \eTeXVersion
>>    \eTeXminorversion
>>
>>    \chardp        (use eTeX's \fontchardp)
>>    \charht        (use eTeX's \fontcharht)
>>    \charit        (use eTeX's \fontcharit)
>>    \charwd        (use eTeX's \fontcharwd)
>>    \pageheight    (use pdfTeX \pdfpageheight)
>>    \pagewidth     (use pdfTeX \pdfpagewidth)
>>     
>
> All reinstated. Not having them available was just unwieldy. The
> last six are all aliases of eachother: \pageheight and \pdfpageheight
> map to the same command code (\meaning shows \pageheight, I believe).
>   
makes sense
> I have fixed some bugs today, and I have reverted back to strict
> Unicode (2^20+2^16 possible characters instead of 2^21) because
> in the current layout, that saves near 300Mb in virtual memory size.
>   
whow, reminds me of former omega days ...
> Eventually, the affected arrays will become lua hashes, and we can
> safely go back to 2^21 then.
>   
good

Hans

-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From taco at elvenkind.com  Fri Aug  4 09:20:55 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 04 Aug 2006 09:20:55 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <44D27E54.20400@wxs.nl>
References: <44D0C399.6020509@elvenkind.com> <44D24258.9080200@elvenkind.com>
	<44D27E54.20400@wxs.nl>
Message-ID: <44D2F557.8090005@elvenkind.com>

Hans Hagen wrote:
> 
>> I have fixed some bugs today, and I have reverted back to strict
>> Unicode (2^20+2^16 possible characters instead of 2^21) because
>> in the current layout, that saves near 300Mb in virtual memory size.
>>   
> whow, reminds me of former omega days ...

The executable is still around 480Mb in virtual size even with
this change :-)

>> Eventually, the affected arrays will become lua hashes, and we can
>> safely go back to 2^21 then.
>>   
> 
> good

Bugs first, speedups later.

Taco

From taco at elvenkind.com  Fri Aug 11 17:02:48 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 11 Aug 2006 17:02:48 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <44D2F557.8090005@elvenkind.com>
References: <44D0C399.6020509@elvenkind.com> <44D24258.9080200@elvenkind.com>
	<44D27E54.20400@wxs.nl> <44D2F557.8090005@elvenkind.com>
Message-ID: <44DC9C18.3030203@elvenkind.com>


Hi,

Today's news:

The source now also compiles using the mingw32 cross compiler.
At least, it does on my linux machine, YMMV. Hans says the
executable runs OK on XP, and that is the main thing.

I do not really understand  autoconf all that well, so I
probably made a mess of the build system, but at the moment
I am extremely happy that the cross-compile creates a valid
(non crashing) executable.

After three days of constant fighting (building/installing the
cross-compiler itself, attempting to apply the mingw32 patches
by Siep, and tricking autotools into postponing the configuration
to "configure" (to avoid the need for reautoconf), I do not quite
feel up to the task of cleaning up (e.g some headers are now
duplicated four times).

I will commit what I have in a few minutes. There are still
quite a few problems with the program itself, but I'll have
a look at that after the weekend.

Taco

From hanthethanh at gmail.com  Fri Aug 11 17:58:16 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Fri, 11 Aug 2006 17:58:16 +0200
Subject: [Dev-luatex] Major commit today
Message-ID: <74f506dc0608110858t1f99b45ayb3709ea1963a28fd@mail.gmail.com>

Hi Taco,

I find the djgpp cross compiler much easier to use than
mingw32. The binary produced by mingw32 is probably faster,
however using djgpp cross compiler is almost the same as the
native compiler. If you are interested I can send the
package (its building was rather lengthy).

Regards,
Thanh


On Fri, Aug 11, 2006 at 05:02:48PM +0200, Taco Hoekwater wrote:
>
> Hi,
>
> Today's news:
>
> The source now also compiles using the mingw32 cross compiler.
> At least, it does on my linux machine, YMMV. Hans says the
> executable runs OK on XP, and that is the main thing.
>
> I do not really understand  autoconf all that well, so I
> probably made a mess of the build system, but at the moment
> I am extremely happy that the cross-compile creates a valid
> (non crashing) executable.
>
> After three days of constant fighting (building/installing the
> cross-compiler itself, attempting to apply the mingw32 patches
> by Siep, and tricking autotools into postponing the configuration
> to "configure" (to avoid the need for reautoconf), I do not quite
> feel up to the task of cleaning up (e.g some headers are now
> duplicated four times).
>
> I will commit what I have in a few minutes. There are still
> quite a few problems with the program itself, but I'll have
> a look at that after the weekend.
>
> Taco
> _______________________________________________
> dev-luatex mailing list
> dev-luatex at ntg.nl
> http://www.ntg.nl/mailman/listinfo/dev-luatex
>

From hanthethanh at gmail.com  Fri Aug 11 17:59:31 2006
From: hanthethanh at gmail.com (Thanh Han The)
Date: Fri, 11 Aug 2006 17:59:31 +0200
Subject: [Dev-luatex] Major commit today
Message-ID: <74f506dc0608110859i50a3f5fcx69d65f0fc0532393@mail.gmail.com>

Hi Taco,

I find the djgpp cross compiler much easier to use than
mingw32. The binary produced by mingw32 is probably faster,
however using djgpp cross compiler is almost the same as the
native compiler. If you are interested I can send the
package (its building was rather lengthy).

Regards,
Thanh


On Fri, Aug 11, 2006 at 05:02:48PM +0200, Taco Hoekwater wrote:
>
> Hi,
>
> Today's news:
>
> The source now also compiles using the mingw32 cross compiler.
> At least, it does on my linux machine, YMMV. Hans says the
> executable runs OK on XP, and that is the main thing.
>
> I do not really understand  autoconf all that well, so I
> probably made a mess of the build system, but at the moment
> I am extremely happy that the cross-compile creates a valid
> (non crashing) executable.
>
> After three days of constant fighting (building/installing the
> cross-compiler itself, attempting to apply the mingw32 patches
> by Siep, and tricking autotools into postponing the configuration
> to "configure" (to avoid the need for reautoconf), I do not quite
> feel up to the task of cleaning up (e.g some headers are now
> duplicated four times).
>
> I will commit what I have in a few minutes. There are still
> quite a few problems with the program itself, but I'll have
> a look at that after the weekend.
>
> Taco
> _______________________________________________
> dev-luatex mailing list
> dev-luatex at ntg.nl
> http://www.ntg.nl/mailman/listinfo/dev-luatex
>

From martin at oneiros.de  Fri Aug 11 19:10:04 2006
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Fri, 11 Aug 2006 19:10:04 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <44DC9C18.3030203@elvenkind.com>
References: <44D0C399.6020509@elvenkind.com> <44D24258.9080200@elvenkind.com>
	<44D27E54.20400@wxs.nl> <44D2F557.8090005@elvenkind.com>
	<44DC9C18.3030203@elvenkind.com>
Message-ID: <68c491a60608111010g63c927d1t7abfa2f562d929bb@mail.gmail.com>

2006/8/11, Taco Hoekwater <taco at elvenkind.com>:
> I do not really understand  autoconf all that well, so I
> probably made a mess of the build system, but at the moment

autfoo is hard. Thomas Esser has been willing to help me. :-)

Best
   Martin

From taco at elvenkind.com  Fri Aug 11 20:13:48 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 11 Aug 2006 20:13:48 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <74f506dc0608110859i50a3f5fcx69d65f0fc0532393@mail.gmail.com>
References: <74f506dc0608110859i50a3f5fcx69d65f0fc0532393@mail.gmail.com>
Message-ID: <44DCC8DC.6060802@elvenkind.com>


Hi Thanh,

Thanh Han The wrote:
> Hi Taco,
> 
> I find the djgpp cross compiler much easier to use than
> mingw32. The binary produced by mingw32 is probably faster,
> however using djgpp cross compiler is almost the same as the
> native compiler. If you are interested I can send the
> package (its building was rather lengthy).

Thanks for the offer, but it works fine now. I now have unified
sources with a bunch of #ifdef __MINGW32__  statements thrown in,
and the only things that don't compile for win are IPC (the dvi
output to a named pipe) and regular expressions (don't have a
cross-compiled regex library yet).

The latter one is simple to fix, don't know about the former
one. I am not even sure if named pipes _can_ work on windows.

Cheers,
Taco

From pragma at wxs.nl  Fri Aug 11 21:05:57 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 11 Aug 2006 21:05:57 +0200
Subject: [Dev-luatex] Major commit today
In-Reply-To: <44DCC8DC.6060802@elvenkind.com>
References: <74f506dc0608110859i50a3f5fcx69d65f0fc0532393@mail.gmail.com>
	<44DCC8DC.6060802@elvenkind.com>
Message-ID: <44DCD515.6060906@wxs.nl>

Taco Hoekwater wrote:
> Hi Thanh,
>
> Thanh Han The wrote:
>   
>> Hi Taco,
>>
>> I find the djgpp cross compiler much easier to use than
>> mingw32. The binary produced by mingw32 is probably faster,
>> however using djgpp cross compiler is almost the same as the
>> native compiler. If you are interested I can send the
>> package (its building was rather lengthy).
>>     
the ming binaries are compact and fast
>
> Thanks for the offer, but it works fine now. I now have unified
> sources with a bunch of #ifdef __MINGW32__  statements thrown in,
> and the only things that don't compile for win are IPC (the dvi
> output to a named pipe) and regular expressions (don't have a
> cross-compiled regex library yet).
>   
but we don't need that one, do we?
> The latter one is simple to fix, don't know about the former
> one. I am not even sure if named pipes _can_ work on windows.
>   
there is a pipe mechanism so ask fanrice when he's back from vacation 

Hans 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From root at aanhet.net  Fri Aug 11 22:22:08 2006
From: root at aanhet.net (Cron Daemon)
Date: Fri, 11 Aug 2006 22:22:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060811202208.B39912800098@server.aanhet.net>

A  luatex/build.sh.cross
 A  luatex/src/libs/xpdf/goo/win32lib.h
 A  luatex/src/libs/xpdf/goo/c-proto.h
 U  luatex/src/libs/xpdf/goo/gfile.cc
 U  luatex/src/libs/xpdf/xpdf/Stream.cc
 A  luatex/src/libs/xpdf/xpdf/oldnames.h
 U  luatex/src/libs/lua51/Makefile
 A  luatex/src/texk/kpathsea/user.c
 U  luatex/src/texk/kpathsea/xopendir.c
 A  luatex/src/texk/kpathsea/time.c
 A  luatex/src/texk/kpathsea/pwd.h
 A  luatex/src/texk/kpathsea/string.c
 A  luatex/src/texk/kpathsea/oldnames.h
 A  luatex/src/texk/kpathsea/system.c
 A  luatex/src/texk/kpathsea/c-auto.h
 U  luatex/src/texk/kpathsea/progname.c
 U  luatex/src/texk/kpathsea/Makefile.in
 A  luatex/src/texk/kpathsea/volume.c
 U  luatex/src/texk/kpathsea/config.h
 A  luatex/src/texk/kpathsea/home.c
 A  luatex/src/texk/kpathsea/error.c
 A  luatex/src/texk/kpathsea/win32lib.h
 A  luatex/src/texk/kpathsea/lookcmd.c
 A  luatex/src/texk/kpathsea/filename.c
 A  luatex/src/texk/web2c/win32lib.h
 A  luatex/src/texk/web2c/pwd.h
 U  luatex/src/texk/web2c/configure
 U  luatex/src/texk/web2c/Makefile.in
 A  luatex/src/texk/web2c/oldnames.h
 U  luatex/src/texk/web2c/config.h
 U  luatex/src/texk/web2c/luatexdir/utils.c
 U  luatex/src/texk/web2c/luatexdir/mapfile.c
 U  luatex/src/texk/web2c/luatexdir/luatex.mk
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 U  luatex/src/texk/web2c/luatexdir/luatexlib.mk
 U  luatex/src/texk/web2c/lib/texmfmp.c
 U  luatex/src/texk/web2c/configure.in
 U  luatex/src/texk/web2c/web2c/convert
 U  luatex/build.sh
 Checked out revision 77.

From root at aanhet.net  Mon Aug 14 16:22:09 2006
From: root at aanhet.net (Cron Daemon)
Date: Mon, 14 Aug 2006 16:22:09 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060814142209.140912800095@server.aanhet.net>

A  luatex/build.sh.linux
 U  luatex/src/texk/kpathsea/texmf.in
 U  luatex/build.sh
 Checked out revision 80.

From root at aanhet.net  Mon Aug 14 22:22:09 2006
From: root at aanhet.net (Cron Daemon)
Date: Mon, 14 Aug 2006 22:22:09 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060814202209.29F7B2800095@server.aanhet.net>

U  luatex/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 Checked out revision 82.

From root at aanhet.net  Tue Aug 15 16:22:08 2006
From: root at aanhet.net (Cron Daemon)
Date: Tue, 15 Aug 2006 16:22:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060815142208.99ECA28000A7@server.aanhet.net>

U  luatex/src/libs/xpdf/goo/gmem.c
 U  luatex/src/libs/xpdf/xpdf/JBIG2Stream.cc
 U  luatex/src/libs/xpdf/xpdf/Stream.cc
 U  luatex/src/libs/xpdf/xpdf/JPXStream.cc
 U  luatex/src/libs/libpng/pngerror.c
 U  luatex/src/libs/libpng/pngwtran.c
 U  luatex/src/libs/libpng/Makefile.in
 U  luatex/src/libs/libpng/pngvcrd.c
 U  luatex/src/libs/libpng/libpng.txt
 U  luatex/src/libs/libpng/KNOWNBUG
 U  luatex/src/libs/libpng/pngread.c
 U  luatex/src/libs/libpng/pngmem.c
 U  luatex/src/libs/libpng/pngget.c
 U  luatex/src/libs/libpng/png.c
 U  luatex/src/libs/libpng/INSTALL
 U  luatex/src/libs/libpng/pnggccrd.c
 U  luatex/src/libs/libpng/CHANGES
 U  luatex/src/libs/libpng/png.h
 U  luatex/src/libs/libpng/example.c
 U  luatex/src/libs/libpng/libpng.3
 U  luatex/src/libs/libpng/pngtrans.c
 U  luatex/src/libs/libpng/pngrio.c
 U  luatex/src/libs/libpng/pngconf.h
 U  luatex/src/libs/libpng/pngwrite.c
 U  luatex/src/libs/libpng/pngpread.c
 U  luatex/src/libs/libpng/Y2KINFO
 U  luatex/src/libs/libpng/pngset.c
 U  luatex/src/libs/libpng/LICENSE
 U  luatex/src/libs/libpng/pngwio.c
 U  luatex/src/libs/libpng/pngrutil.c
 U  luatex/src/libs/libpng/png.5
 U  luatex/src/libs/libpng/pngwutil.c
 U  luatex/src/libs/libpng/README
 U  luatex/src/libs/libpng/libpngpf.3
 U  luatex/src/libs/libpng/pngtest.c
 U  luatex/src/libs/libpng/ANNOUNCE
 U  luatex/src/libs/libpng/pngrtran.c
 A  luatex/src/libs/obsdcompat
 A  luatex/src/libs/obsdcompat/libobsd-compat.ac
 A  luatex/src/libs/obsdcompat/configure
 A  luatex/src/libs/obsdcompat/config.h.org
 A  luatex/src/libs/obsdcompat/strlcpy.c
 A  luatex/src/libs/obsdcompat/Makefile.in
 A  luatex/src/libs/obsdcompat/strtoll.c
 A  luatex/src/libs/obsdcompat/config.guess
 A  luatex/src/libs/obsdcompat/bsd-snprintf.c
 A  luatex/src/libs/obsdcompat/includes.h
 A  luatex/src/libs/obsdcompat/config.sub
 A  luatex/src/libs/obsdcompat/README
 A  luatex/src/libs/obsdcompat/strlcat.c
 A  luatex/src/libs/obsdcompat/strtoul.c
 A  luatex/src/libs/obsdcompat/strmode.c
 A  luatex/src/libs/obsdcompat/config.h.in
 A  luatex/src/libs/obsdcompat/openbsd-compat.h
 A  luatex/src/libs/obsdcompat/strsep.c
 A  luatex/src/libs/obsdcompat/defines.h
 A  luatex/src/libs/obsdcompat/configure.ac
 A  luatex/src/libs/obsdcompat/strtonum.c
 A  luatex/src/libs/obsdcompat/bsd-asprintf.c
 A  luatex/src/libs/obsdcompat/.cvsignore
 A  luatex/src/libs/obsdcompat/install-sh
 Checked out revision 85.

From taco at elvenkind.com  Tue Aug 15 20:10:19 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 15 Aug 2006 20:10:19 +0200
Subject: [Dev-luatex] progress
Message-ID: <44E20E0B.8070700@elvenkind.com>

Hi,

Todays commits have lifted the code to the level of 
pdftex-1.40-beta-20060814 and aleph-rc4. There are some
remaining issues with cross-compiling the obsdcompat
library, those I will attempt to deal with tomorrow.

I am still on schedule for snapshot file release on
friday.

Cheers, taco



From christof at schardt.info  Tue Aug 15 22:18:54 2006
From: christof at schardt.info (Christof Schardt)
Date: Tue, 15 Aug 2006 22:18:54 +0200
Subject: [Dev-luatex] (no subject)
Message-ID: <265984529.20060815221854@schardt.info>

Hello,

I couldn't figure out, how I can get access to the luatex-sources.

My concern is: I'm developing a music-score language,
as of now called "emil" (= easy music input language), which is
likely to move towards Lua. (Hans: we had a short conversation in 
Darmstadt, if you remember).
I am curious to see, how luatex communicates with the tex-interpreter.
I'm at the beginning and my first problem is, to get Lua-output
as a scannable string back to the calling interpreter.
Hans' luatex-manual points out, that luatex has this
already built in.

So my question: can I get access to the sources, or get a hint,
how to output Lua to the calling interpreter,

Thanks in advance
Christof










From root at aanhet.net  Tue Aug 15 22:22:16 2006
From: root at aanhet.net (Cron Daemon)
Date: Tue, 15 Aug 2006 22:22:16 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060815202216.10E9028000A7@server.aanhet.net>

U  luatex/build.sh.cross
 U  luatex/src/configure
 U  luatex/src/Makefile.in
 U  luatex/src/configure.in
 U  luatex/src/libs/configure
 U  luatex/src/libs/configure.in
 A  luatex/src/libs/obsdcompat/pwd.h
 U  luatex/src/libs/obsdcompat/includes.h
 U  luatex/src/libs/obsdcompat/strmode.c
 U  luatex/src/texk/web2c/configure
 U  luatex/src/texk/web2c/Makefile.in
 U  luatex/src/texk/web2c/luatexdir/utils.c
 U  luatex/src/texk/web2c/luatexdir/Makefile.in
 U  luatex/src/texk/web2c/luatexdir/ttf2afm.c
 U  luatex/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/src/texk/web2c/luatexdir/mapfile.c
 U  luatex/src/texk/web2c/luatexdir/writeenc.c
 U  luatex/src/texk/web2c/luatexdir/epdf.h
 U  luatex/src/texk/web2c/luatexdir/depend.mk
 U  luatex/src/texk/web2c/luatexdir/luatex.mk
 A  luatex/src/texk/web2c/luatexdir/tounicode.c
 U  luatex/src/texk/web2c/luatexdir/NEWS
 U  luatex/src/texk/web2c/luatexdir/writejpg.c
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 U  luatex/src/texk/web2c/luatexdir/writepng.c
 U  luatex/src/texk/web2c/luatexdir/writet1.c
 U  luatex/src/texk/web2c/luatexdir/writet3.c
 U  luatex/src/texk/web2c/luatexdir/writettf.c
 U  luatex/src/texk/web2c/luatexdir/README
 U  luatex/src/texk/web2c/luatexdir/ptexlib.h
 U  luatex/src/texk/web2c/luatexdir/writettf.h
 U  luatex/src/texk/web2c/luatexdir/pdftoepdf.cc
 U  luatex/src/texk/web2c/luatexdir/luatexlib.mk
 U  luatex/src/texk/web2c/luatexdir/subfont.c
 U  luatex/src/texk/web2c/luatexdir/writefont.c
 U  luatex/src/texk/web2c/luatexdir/writeimg.c
 U  luatex/src/texk/web2c/luatexdir/luatex.defines
 U  luatex/src/texk/web2c/lib/texmfmp.c
 U  luatex/src/texk/web2c/lib/openclose.c
 Checked out revision 88.

From taco at elvenkind.com  Tue Aug 15 23:04:15 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 15 Aug 2006 23:04:15 +0200
Subject: [Dev-luatex] (no subject)
In-Reply-To: <265984529.20060815221854@schardt.info>
References: <265984529.20060815221854@schardt.info>
Message-ID: <44E236CF.4080101@elvenkind.com>


Hi Christof,
> Hello,
> 
> I couldn't figure out, how I can get access to the luatex-sources.

The sources are here:

   https://foundry.supelec.fr/projects/luatex

You can browse online, but because of a problem with the gforge
server configuration at the moment you have to be a registered
developer to do checkouts.

If you know how to use wget, the checkout tree that generates the
report to this mailing list is available online as well:

   http://context.aanhet.net/svn/luatex/

But if can you hold on 'til friday, that is perhaps the best
idea. I'll do a snapshot release of the repository then,
along with a bit of cleanup and some basic documentation.

> My concern is: I'm developing a music-score language,
> as of now called "emil" (= easy music input language), which is
> likely to move towards Lua. (Hans: we had a short conversation in 
> Darmstadt, if you remember).

This sounds exciting.

> So my question: can I get access to the sources, or get a hint,
> how to output Lua to the calling interpreter,

Lua code called from within TeX has a command tex.print().
Anything you feed to that function ends up inside LuaTeX as
if you executed eTeX's \detokenize instead of \directlua.

Cheers, Taco

From pragma at wxs.nl  Wed Aug 16 00:25:46 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 16 Aug 2006 00:25:46 +0200
Subject: [Dev-luatex] (no subject)
In-Reply-To: <265984529.20060815221854@schardt.info>
References: <265984529.20060815221854@schardt.info>
Message-ID: <44E249EA.6060607@wxs.nl>

Christof Schardt wrote:
> Hello,
>
> I couldn't figure out, how I can get access to the luatex-sources.
>
> My concern is: I'm developing a music-score language,
> as of now called "emil" (= easy music input language), which is
> likely to move towards Lua. (Hans: we had a short conversation in 
> Darmstadt, if you remember).
> I am curious to see, how luatex communicates with the tex-interpreter.
> I'm at the beginning and my first problem is, to get Lua-output
> as a scannable string back to the calling interpreter.
> Hans' luatex-manual points out, that luatex has this
> already built in.
>
> So my question: can I get access to the sources, or get a hint,
> how to output Lua to the calling interpreter,
>   
this is still a bit experimental, but you must think of something 

\luainstance {lua code} 

(there can be multiple lua instances) 

it's fully expandable and you feed back results into the tex input stream with tex.print() 

very rough picture (a bit behind) 

www.pragma-ade.com/general/manuals/luatex.pdf

Hans  

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From root at aanhet.net  Wed Aug 16 12:22:12 2006
From: root at aanhet.net (Cron Daemon)
Date: Wed, 16 Aug 2006 12:22:12 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060816102212.DB5B228000B7@server.aanhet.net>

D  luatex/src/libs/obsdcompat/pwd.h
 D  luatex/src/libs/obsdcompat/strmode.c
 U  luatex/src/libs/obsdcompat/configure
 U  luatex/src/libs/obsdcompat/Makefile.in
 U  luatex/src/libs/obsdcompat/includes.h
 U  luatex/src/libs/obsdcompat/config.h.in
 U  luatex/src/libs/obsdcompat/openbsd-compat.h
 U  luatex/src/libs/obsdcompat/configure.ac
 Checked out revision 89.

From root at aanhet.net  Wed Aug 16 16:22:06 2006
From: root at aanhet.net (Cron Daemon)
Date: Wed, 16 Aug 2006 16:22:06 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060816142206.C32BE2800097@server.aanhet.net>

U  luatex/build.sh.cross
 U  luatex/build.sh.linux
 Checked out revision 90.

From taco at elvenkind.com  Wed Aug 16 16:48:34 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 16 Aug 2006 16:48:34 +0200
Subject: [Dev-luatex] Input and output character sets
Message-ID: <44E33042.1090708@elvenkind.com>


Hi all (Idris especially),

When you read the Omega 1.12 documentation, section 12 is all
about Input and Output text file encodings and how Omega deals
with those in a much more elaborate way than traditional TeX.
In particular, there are "modes" and "translations", along with
a number of (mixed case, yuk) primitives.

I would like very much to have a smalll but complete set of test
files to make sure that my merge of the Aleph code into LuaTeX is
correct. Because the I/O internals are quite different, I have
a hard time making sure LuaTeX behaves just like Aleph.

Idris, could you (or perhaps another Aleph user) create such a
set of test files? Something like a mini-trip test for just this
bit of code.

Thanks in advance,

Taco



From ishamid at colostate.edu  Wed Aug 16 17:54:10 2006
From: ishamid at colostate.edu (Idris Samawi Hamid)
Date: Wed, 16 Aug 2006 09:54:10 -0600
Subject: [Dev-luatex] Input and output character sets
In-Reply-To: <44E33042.1090708@elvenkind.com>
References: <44E33042.1090708@elvenkind.com>
Message-ID: <op.tedvskapnx1yh1@walayah-main>

Hi Taco,

On Wed, 16 Aug 2006 08:48:34 -0600, Taco Hoekwater <taco at elvenkind.com>  
wrote:

> Hi all (Idris especially),
>
> When you read the Omega 1.12 documentation, section 12 is all
> about Input and Output text file encodings and how Omega deals
> with those in a much more elaborate way than traditional TeX.
> In particular, there are "modes" and "translations", along with
> a number of (mixed case, yuk) primitives.
>
> I would like very much to have a smalll but complete set of test
> files to make sure that my merge of the Aleph code into LuaTeX is
> correct. Because the I/O internals are quite different, I have
> a hard time making sure LuaTeX behaves just like Aleph.

I'll put something together using the gamma module (see m-gamma.tex and  
type-omg.tex) sometime today. See also the off-list mail I sent you.

> Idris, could you (or perhaps another Aleph user) create such a
> set of test files? Something like a mini-trip test for just this
> bit of code.

I just checked out that section: as far as I can remember I have never  
used any of these primitives at all in any of my work.

Roger Wright apparently uses some of this:

http://pws.prserv.net/Roger_Wright/ROGER.HTM
http://pws.prserv.net/Roger_Wright/utf8test.htm

As well as Vincent Zoonekynd

http://zoonek.free.fr/LaTeX/
http://zoonek.free.fr/LaTeX/Omega-Japanese/doc.html

This is interesting; it allows one to globally specify the input encoding  
prior/independent of the ocp-list. I've always just done that inside the  
ocp list itself in my own work (but then again I use multiple inputs  
generally).

Perhaps this mechanism holds a clue to the problem of abstracting ocp  
lists so that the input encodings, internal translation processing, and  
output font mapping can be handled separately instead of hard-wired into a  
single ocp list.

Does anyone have that book written on LaTeX by our Greek colleague (I  
don't remember his name); it has a chapter on Omega and maybe some examples

I'll send a note to the aleph list to see if anyone else has used this  
stuff.

Best
Idris

-- 
Professor Idris Samawi Hamid
Department of Philosophy
Colorado State University
Fort Collins, CO 80523

--
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/

From ishamid at colostate.edu  Wed Aug 16 18:06:32 2006
From: ishamid at colostate.edu (Idris Samawi Hamid)
Date: Wed, 16 Aug 2006 10:06:32 -0600
Subject: [Dev-luatex] Input and output character sets
In-Reply-To: <op.tedvskapnx1yh1@walayah-main>
References: <44E33042.1090708@elvenkind.com> <op.tedvskapnx1yh1@walayah-main>
Message-ID: <op.tedwc6nanx1yh1@walayah-main>

On Wed, 16 Aug 2006 09:54:10 -0600, Idris Samawi Hamid  
<ishamid at colostate.edu> wrote:

> Does anyone have that book written on LaTeX by our Greek colleague (I
> don't remember his name); it has a chapter on Omega and maybe some  
> examples

Digital Typography Using LaTeX
Apostolos Syropoulos

http://www.amazon.com/gp/product/0387952179/sr=8-1/qid=1155744248/ref=sr_1_1/104-1912310-8019969?ie=UTF8

-- 
Professor Idris Samawi Hamid
Department of Philosophy
Colorado State University
Fort Collins, CO 80523

--
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/

From lists at texytipografia.com  Wed Aug 16 19:28:02 2006
From: lists at texytipografia.com (Javier Bezos)
Date: Wed, 16 Aug 2006 19:28:02 +0200
Subject: [Dev-luatex] Input and output character sets
References: <44E33042.1090708@elvenkind.com>
Message-ID: <000a01c6c159$a1d41a00$9a850e3e@PROPIETAFMI1K9>

Taco,

> I would like very much to have a smalll but complete set of test
> files to make sure that my merge of the Aleph code into LuaTeX is
> correct. Because the I/O internals are quite different, I have
> a hard time making sure LuaTeX behaves just like Aleph.

There is a file named torture.tex with lots of
Arabic/Farsi/etc. text, but I'm not sure the
name describes correctly what the file is.
Unfortunately, there is a primitive named
\nextfakemath which is not avaliable in Aleph,
but if you ignore it this file could help.

Javier



From taco at elvenkind.com  Thu Aug 17 19:56:33 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 17 Aug 2006 19:56:33 +0200
Subject: [Dev-luatex] Input and output character sets
In-Reply-To: <op.tedvskapnx1yh1@walayah-main>
References: <44E33042.1090708@elvenkind.com> <op.tedvskapnx1yh1@walayah-main>
Message-ID: <44E4ADD1.5020208@elvenkind.com>


Hi,

Idris Samawi Hamid wrote:
> 
> I'll put something together using the gamma module (see m-gamma.tex and  
> type-omg.tex) sometime today. See also the off-list mail I sent you.

Meanwhile torture.tex has proved to be quite useful. It runs almost
OK now (one issue remains afaics). It should be possible to fix that
tomorrow, so that at least one non-trivial document is typeset
correctly.

In case anyone is interested: the biggest problems are caused by the
move from the two separate homogenenous 'file i/o' models that are
used by pdfTeX and Aleph (resp. bytes and 16-bit shorts) to the
variable encoding (utf-8) that is used by LuaTeX internally.

For example, when TeX is searching for a control sequence name, it does
a sneak past the end of the name,  and then it jumps back one item to
find the actual last character of the name. This does not work in UTF-8,
because if the last character was > 128, it has to back up two, three,
or even four items.


> This is interesting; it allows one to globally specify the input encoding  
> prior/independent of the ocp-list. I've always just done that inside the  
> ocp list itself in my own work (but then again I use multiple inputs  
> generally).

I've looked at this quite intensively over the past two days, and I
propose to drop this entire feature. It seems not to be heavily used,
the used names are 'abnormal' for TeX (e.g. \noDefaultInputMode is an
actual primitive), the feature is very likely to clash with, as well
as complicate, future callbacks to/from Lua scripting, and finally
both the interface and the implementation appear to be a badly rushed
job or an experiment only.

A fresh implementation of file encoding support using Lua makes more
sense to me (and will probably take less time to do than fixing the
Omega code).

Greetings,
Taco


From root at aanhet.net  Fri Aug 18 16:22:08 2006
From: root at aanhet.net (Cron Daemon)
Date: Fri, 18 Aug 2006 16:22:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060818142208.A2BEF2800087@server.aanhet.net>

D  luatex/pdftex.xml
 D  luatex/NEWS
 D  luatex/README
 U  luatex/INSTALL
 U  luatex/src/texk/web2c/luatexdir/utils.c
 U  luatex/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 U  luatex/src/texk/web2c/luatexdir/luatex.c
 U  luatex/src/texk/web2c/luatexdir/luatex.h
 U  luatex/src/texk/web2c/luatexdir/luatex.defines
 A  luatex/README.luatex
 Checked out revision 93.

From taco at elvenkind.com  Fri Aug 18 18:26:49 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 18 Aug 2006 18:26:49 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
Message-ID: <44E5EA49.1050501@elvenkind.com>


Hi all,

I have made a first snapshot available, now that it processes
torture.tex correctly. This is not a 'release' per se, so
please  do not be offended by the extreme lack of install
instructions and manual. Some hints are at the end of this
message.

The snapshot is up to par with Aleph-RC4 (from texlive devel)
and the latest pdftex beta (even newer than 20060811). However,
there are some differences, to summarize:

* There is no pool file (all strings are embedded)

* -8bit and -translate-file are silently ignored

* There is no mltex nor enctex (conflicts with aleph)

* The tex functionality is always present and enabled
   (but see below about TeXXeT), so the asterisk or
   -etex switch for initex is not needed

* "plus 1 filllllllll" does not generate any errors from TeX

* TeXXeT (from eTeX) is not present, so the primives
	\TeXXeTstate
	\beginR
	\beginL
	\endR
	\endL
   are missing

* The experimental pdftex regex match operations are removed,
   because that feature does not make much sense when lua is
   available so the primitives
         \pdfmatch
	\pdflastmatch
   are missing

* The input translations from Aleph are not implemented, the
   16 related primitives are all missing
      \DefaultInputMode
      \noDefaultInputMode
      \noInputMode
      \InputMode
      \DefaultOutputMode
      \noDefaultOutputMode
      \noOutputMode
      \OutputMode
      \DefaultInputTranslation
      \noDefaultInputTranslation
      \noInputTranslation
      \InputTranslation
      \DefaultOutputTranslation
      \noDefaultOutputTranslation
      \noOutputTranslation
      \OutputTranslation
   All file IO assumes UTF-8, except that all the low-ascii
   controls except TAB, CR en LF are written to the terminal
   using ^^  notation (even these are binary in the log file).

* Input characters can use the full range of Unicode,
   but it probably only makes sense to use values above
   the base plane for \mathcode and \catcode assignments,
   since the fonts as well as the hyphenation patterns
   are strictly 16-bit still.

* The primitives
      \pdfpagewidth and \pagewidth,
      \pdfpageheight and \pageheight,
      \fontcharwd and \charwd,
      \fontcharht and \charht,
      \fontchardp and \chardp,
      \fontcharic and \charic,
   are all aliases of eachother.

* The new primitive
      \clearmarks<number>
   clears a marks class completely.

* The experimental pdftex primitives
      \pdfprimitive
      \ifpdfprimitive
      \ifpdfabsnum
      \ifpdfabsdim
   and provided without the extra 'pdf' prefix, so they are
   simply called
      \primitive
      \ifprimitive
      \ifabsnum
      \ifabsdim
   instead.

* I probably forgot to mention some things :-)

Have fun, Taco


Downloading and installation details:

If you go to

   https://foundry.supelec.fr/frs/?group_id=10&release_id=160

you will see that there are three released files:

* luatex-snapshot-20060818.tar.gz
   This is the source tree.

* luatex-snapshot-20060818-win32.zip
   A cross-compiled (mingw) windows binary. This is a web2c
   based binary, so it needs a texmf.cnf file (It will NOT
   work if you have only miktex installed).

   This executable cannot run dynamically loaded lua dlls. Perhaps
   that can be fixed but I do not know how.

* luatex-snapshot-20060818-linux-i386.tar.gz
   A linux binary. This needs ld-linux.so.2, so you need
   a somewhat modern linux for that, but compiling from
   source for linux should not be a problem.

The binaries should go in a 'normal' TeX binary folder
like texmf/bin or texmf-win32/bin so that they can find
your texmf.cnf automatically. If you put them elsewhere,
you have to set the TEXMFCNF environment variable.

There is no pool file, so you do not have to worry about that.

For meaningful unicode input and hyphenation, you need a
file that sets the \lccode etc. values for chars with
a value higher than 256. One such file is part of the
xetex distribution (unicode-letters.tex).

Greetings, Taco

From taco at elvenkind.com  Fri Aug 18 19:36:38 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 18 Aug 2006 19:36:38 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E5EA49.1050501@elvenkind.com>
References: <44E5EA49.1050501@elvenkind.com>
Message-ID: <44E5FAA6.30206@elvenkind.com>

Taco Hoekwater wrote:
> * I probably forgot to mention some things :-)

Only the most important remarks:

* The pdf writing parts are still 8bit, these do not
   understand ofm/ovf fonts yet.

* Text directions TRT etc. also only work in dvi mode.

* Memory consumption is nearly 300MB higher than either
   pdfTeX or Aleph.

The memory and font writing issues are next on my todo
list for next week.

Greetings,
Taco



From geoffw at cis.upenn.edu  Fri Aug 18 20:04:20 2006
From: geoffw at cis.upenn.edu (Geoffrey Alan Washburn)
Date: Fri, 18 Aug 2006 14:04:20 -0400
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E5EA49.1050501@elvenkind.com>
References: <44E5EA49.1050501@elvenkind.com>
Message-ID: <44E60124.9080308@cis.upenn.edu>

Taco Hoekwater wrote:
> The binaries should go in a 'normal' TeX binary folder
> like texmf/bin or texmf-win32/bin so that they can find
> your texmf.cnf automatically. If you put them elsewhere,
> you have to set the TEXMFCNF environment variable.
>
> There is no pool file, so you do not have to worry about that.
>   
    Hopefully this I'm not doing something too obviously wrong here, but 
I'm getting the following error trying to build a LaTeX format.

 ./luatex -ini /usr/share/texmf-tetex/tex/latex/base/latex.ltx
...
...
! Text line contains an invalid utf-8 sequence.
l.7801   \uccode`\=`\
                       ? % d-bar

I'm able to build the format for Plain TeX working without any problems 
though. 

-- 
[Geoff Washburn|geoffw at cis.upenn.edu|http://www.cis.upenn.edu/~geoffw/]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://www.ntg.nl/mailman/private/dev-luatex/attachments/20060818/e8b19333/attachment.html 

From taco at elvenkind.com  Fri Aug 18 20:55:05 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 18 Aug 2006 20:55:05 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E60124.9080308@cis.upenn.edu>
References: <44E5EA49.1050501@elvenkind.com> <44E60124.9080308@cis.upenn.edu>
Message-ID: <44E60D09.2020103@elvenkind.com>

Hi Geoffrey,

Geoffrey Alan Washburn wrote:
> ...
> ! Text line contains an invalid utf-8 sequence.
> l.7801   \uccode`\=`\
>                        ? % d-bar

I'll bet this line is coming from a hyphenation patterns file.
_all_  file I/O has to be utf-8 encoded, including patterns.
Unf., lots of patterns files are using EC font encoding as a
file encoding, and are therefore not valid utf-8.

I do not normally use LaTeX any more, making it hard for me to
give exact advice, but you either need to find a set of patterns
for this language that _is_ utf-8 encoded (ConTeXt ships with
such pattern files, and I understood that there is a set of
similar files that come with XeTeX), or you have to disable
the language(s) that is causing you grief by means of some
babel configuration file.

Greetings,
Taco


From pragma at wxs.nl  Fri Aug 18 21:00:14 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 18 Aug 2006 21:00:14 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E60124.9080308@cis.upenn.edu>
References: <44E5EA49.1050501@elvenkind.com> <44E60124.9080308@cis.upenn.edu>
Message-ID: <44E60E3E.7010907@wxs.nl>

Geoffrey Alan Washburn wrote:
> Taco Hoekwater wrote:
>> The binaries should go in a 'normal' TeX binary folder
>> like texmf/bin or texmf-win32/bin so that they can find
>> your texmf.cnf automatically. If you put them elsewhere,
>> you have to set the TEXMFCNF environment variable.
>>
>> There is no pool file, so you do not have to worry about that.
>>   
>    Hopefully this I'm not doing something too obviously wrong here, 
> but I'm getting the following error trying to build a LaTeX format.
>
> ./luatex -ini /usr/share/texmf-tetex/tex/latex/base/latex.ltx
> ...
> ...
> ! Text line contains an invalid utf-8 sequence.
> l.7801   \uccode`\=`\
>                       ? % d-bar
>
> I'm able to build the format for Plain TeX working without any 
> problems though.
i dunno about latex; since luatex is far from production ready you can 
best comment pattern loading or (since you're 'edu') stick to us 
patterns only since that is covered by utf

(context uses utf patterns so loading there is no problem in generating 
context formats)

Hans

-- 

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From ishamid at colostate.edu  Fri Aug 18 22:52:28 2006
From: ishamid at colostate.edu (Idris Samawi Hamid)
Date: Fri, 18 Aug 2006 14:52:28 -0600
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E60D09.2020103@elvenkind.com>
References: <44E5EA49.1050501@elvenkind.com> <44E60124.9080308@cis.upenn.edu>
	<44E60D09.2020103@elvenkind.com>
Message-ID: <op.tehyxqhnnx1yh1@walayah-main>

Hi Taco,

On Fri, 18 Aug 2006 12:55:05 -0600, Taco Hoekwater <taco at elvenkind.com>  
wrote:

> Hi Geoffrey,
>
> Geoffrey Alan Washburn wrote:
>> ...
>> ! Text line contains an invalid utf-8 sequence.
>> l.7801   \uccode`\=`\
>>                        ? % d-bar
>
> I'll bet this line is coming from a hyphenation patterns file.
> _all_  file I/O has to be utf-8 encoded, including patterns.
> Unf., lots of patterns files are using EC font encoding as a
> file encoding, and are therefore not valid utf-8.
>
> I do not normally use LaTeX any more, making it hard for me to
> give exact advice, but you either need to find a set of patterns
> for this language that _is_ utf-8 encoded (ConTeXt ships with
> such pattern files, and I understood that there is a set of
> similar files that come with XeTeX), or you have to disable
> the language(s) that is causing you grief by means of some
> babel configuration file.

How do you avoid this problem to run torture.tex, which is a latex/lambda  
file?

Best
Idris

-- 
Professor Idris Samawi Hamid
Department of Philosophy
Colorado State University
Fort Collins, CO 80523

--
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/

From ishamid at colostate.edu  Fri Aug 18 23:33:19 2006
From: ishamid at colostate.edu (Idris Samawi Hamid)
Date: Fri, 18 Aug 2006 15:33:19 -0600
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E60124.9080308@cis.upenn.edu>
References: <44E5EA49.1050501@elvenkind.com> <44E60124.9080308@cis.upenn.edu>
Message-ID: <op.teh0ttttnx1yh1@walayah-main>

On Fri, 18 Aug 2006 12:04:20 -0600, Geoffrey Alan Washburn  
<geoffw at cis.upenn.edu> wrote:

> I'm getting the following error trying to build a LaTeX format.
>
>  ./luatex -ini /usr/share/texmf-tetex/tex/latex/base/latex.ltx
> ...
> ...
> ! Text line contains an invalid utf-8 sequence.
> l.7801   \uccode`\=`\
>                        ? % d-bar
>
> I'm able to build the format for Plain TeX working without any problems
> though.

Here is what I did:

1. comment out lines 7801 and 7901 in latex.ltx
2. comment out offending languages in \tex\generic\config\language.dat  
(for me I just commented out everything other than english-)

Then I do

luatex "&lambda" torture

And I can confirm that torture.tex runs fine!

BTW: Taco, what dod you do with \nextfakemath (I just did
\let\nextfakemath\relax)?

Best
Idris

-- 
Professor Idris Samawi Hamid
Department of Philosophy
Colorado State University
Fort Collins, CO 80523

--
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/

From taco at elvenkind.com  Sat Aug 19 00:00:20 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 19 Aug 2006 00:00:20 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <op.teh0ttttnx1yh1@walayah-main>
References: <44E5EA49.1050501@elvenkind.com> <44E60124.9080308@cis.upenn.edu>
	<op.teh0ttttnx1yh1@walayah-main>
Message-ID: <44E63874.30302@elvenkind.com>

Hi,

Idris Samawi Hamid wrote:
> 
> Here is what I did:
> 
> 1. comment out lines 7801 and 7901 in latex.ltx

I do not remember having to do that, but it could be just
my memory cells that no longer accept 'hitting enter' as
a noticeable event. Or it could be a difference in latex
(mine was fetched fresh from CTAN yesterday)

> BTW: Taco, what dod you do with \nextfakemath (I just did
> \let\nextfakemath\relax)?

I had \def\nextfakemath{}, that amounts to roughly
the same thing in practice.

The strange thing is: the command doesn't appear to be
necessary anyway. I googled for what it was supposed to do,
but could not quite figure it out.

It was not even clear if it was a really old  (1.5?) or a
really new primitive (1.21?). However, the output does not
strike me as 'wrong' in any way. Bizarre.

Taco


From pragma at wxs.nl  Sat Aug 19 00:06:52 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 19 Aug 2006 00:06:52 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
In-Reply-To: <44E63874.30302@elvenkind.com>
References: <44E5EA49.1050501@elvenkind.com> <44E60124.9080308@cis.upenn.edu>
	<op.teh0ttttnx1yh1@walayah-main> <44E63874.30302@elvenkind.com>
Message-ID: <44E639FC.9030602@wxs.nl>

Taco Hoekwater wrote:
> Hi,
>
> Idris Samawi Hamid wrote:
>   
>> Here is what I did:
>>
>> 1. comment out lines 7801 and 7901 in latex.ltx
>>     
>
> I do not remember having to do that, but it could be just
> my memory cells that no longer accept 'hitting enter' as
> a noticeable event. Or it could be a difference in latex
> (mine was fetched fresh from CTAN yesterday)
>
>   
>> BTW: Taco, what dod you do with \nextfakemath (I just did
>> \let\nextfakemath\relax)?
>>     
>
> I had \def\nextfakemath{}, that amounts to roughly
> the same thing in practice.
>
> The strange thing is: the command doesn't appear to be
> necessary anyway. I googled for what it was supposed to do,
> but could not quite figure it out.
>
> It was not even clear if it was a really old  (1.5?) or a
> really new primitive (1.21?). However, the output does not
> strike me as 'wrong' in any way. Bizarre.
>   
maybe a left over from this one time tex -> pres mml mess

Hans

From lists at texytipografia.com  Sat Aug 19 11:28:50 2006
From: lists at texytipografia.com (Javier Bezos)
Date: Sat, 19 Aug 2006 11:28:50 +0200
Subject: [Dev-luatex] Snapshot 20060818 released
References: <44E5EA49.1050501@elvenkind.com>
	<44E60124.9080308@cis.upenn.edu><op.teh0ttttnx1yh1@walayah-main>
	<44E63874.30302@elvenkind.com>
Message-ID: <014301c6c372$200f00a0$a2810e3e@PROPIETAFMI1K9>

Taco,

> I had \def\nextfakemath{}, that amounts to roughly
> the same thing in practice.
> 
> The strange thing is: the command doesn't appear to be
> necessary anyway. I googled for what it was supposed to do,
> but could not quite figure it out.

IIRC, it was a trick for the LaTeX tabular environment, 
which is typeset in math mode, but there were plans to
remove it. I think it ensures the writing direction is
that of text.

Javier

From pragma at wxs.nl  Tue Aug 22 14:05:13 2006
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 22 Aug 2006 14:05:13 +0200
Subject: [Dev-luatex] bug
Message-ID: <44EAF2F9.9010109@wxs.nl>

Hi Taco,

As we discussed by chat ... there is a buffer overflow when the amount 
of chars fed into lua is large:

 Error: luatex.exe: buffer overflow at file 
../../../../src/texk/web2c/luatexdir
/utils.c, line 177

Low priority bug since it was an extreme case.

Hans

-----------------------------------------------------------------
                                          Hans Hagen | PRAGMA ADE
              Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                             | www.pragma-pod.nl
-----------------------------------------------------------------


From taco at elvenkind.com  Fri Aug 25 18:09:36 2006
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 25 Aug 2006 18:09:36 +0200
Subject: [Dev-luatex] Snapshot 20060825
Message-ID: <44EF20C0.9020004@elvenkind.com>


Hi all,

I have released a new snapshot just a few moments ago.

The main change in this snapshot is that it uses far less memory.
luatex -ini on my linux machine went from 326Mb (last week) to
93Mb (now), and "texexec luatex" now ends at 184Mb instead of
over 1/2Gb.

This is achieved by two big changes:

* The \mathcode, \delcode, \catcode, \sfcode, \lccode and \uccode
   tables are now sparse arrays that are implemented in C. They
   are no longer part of the TeX "equivalence table" and because
   each had 1.1 million entries with a few memory words each, this
   makes a major difference.

   See mathcodes.c and textcodes.c if you are interested in the
   gory details, but be warned: the code is still extremely
   rough and ugly. In particular, the dump and undump routines
   are far from optimal, resulting in somewhat larger format files
   than before (approx 1.3Mb larger with unicode-letters loaded,
   10k without); and the assignments do not show up when using
   the etex tracing routines \tracingassigns and \tracingrestores
   (code simply not written yet)

* Single-character commands are no longer "special" internally,
   they are stored in the hash just like the multiletter csnames.

Both changes are supposed to be transparent to the user, so
if something does not work _exactly_ as before, it is a bug.

There are a few memory hogs remaining (active characters and
the various registers), but I will not dive into those until
(much) later.

Next week I will focus on the input callbacks, so that files no
longer have to be utf-8 encoded.



-------------------

Downloading and installation details:

If you go to

    https://foundry.supelec.fr/frs/?group_id=10&release_id=164

you will see that there are three released files:

* luatex-snapshot-20060825.tar.gz
    This is the source tree.

* luatex-snapshot-20060825-win32.zip
    A cross-compiled (mingw) windows binary. This is a web2c
    based binary, so it needs a texmf.cnf file (It will NOT
    work if you have only miktex installed).

    This executable cannot run dynamically loaded lua dlls. Perhaps
    that can be fixed but I do not know how.

* luatex-snapshot-20060825-linux-i386.tar.gz
    A linux binary. This needs ld-linux.so.2, so you need
    a somewhat modern linux for that, but compiling from
    source for linux should not be a problem.

The binaries should go in a 'normal' TeX binary folder
like texmf/bin or texmf-win32/bin so that they can find
your texmf.cnf automatically. If you put them elsewhere,
you have to set the TEXMFCNF environment variable.

There is no pool file, so you do not have to worry about that.

For meaningful unicode input and hyphenation, you need a
file that sets the \lccode etc. values for chars with
a value higher than 256. One such file is part of the
xetex distribution (unicode-letters.tex).

Greetings, Taco

From root at aanhet.net  Fri Aug 25 22:22:09 2006
From: root at aanhet.net (Cron Daemon)
Date: Fri, 25 Aug 2006 22:22:09 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060825202209.2319C28000EB@server.aanhet.net>

U  luatex/build.sh.cross
 U  luatex/src/texk/web2c/luatexdir/Makefile.in
 A  luatex/src/texk/web2c/luatexdir/textcodes.c
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 A  luatex/src/texk/web2c/luatexdir/mathcodes.c
 U  luatex/src/texk/web2c/luatexdir/luatex.h
 U  luatex/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 96.

From root at aanhet.net  Mon Aug 28 16:22:08 2006
From: root at aanhet.net (Cron Daemon)
Date: Mon, 28 Aug 2006 16:22:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060828142208.D8C8B280009C@server.aanhet.net>

U  luatex/src/texk/web2c/luatexdir/luatex.web
 U  luatex/src/texk/web2c/luatexdir/luatex.c
 U  luatex/src/texk/web2c/luatexdir/luatex.h
 U  luatex/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 97.

From root at aanhet.net  Wed Aug 30 22:22:07 2006
From: root at aanhet.net (Cron Daemon)
Date: Wed, 30 Aug 2006 22:22:07 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20060830202207.01AC32800088@server.aanhet.net>

U  luatex/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/src/texk/web2c/luatexdir/luastuff.c
 U  luatex/src/texk/web2c/luatexdir/luatex.web
 U  luatex/src/texk/web2c/luatexdir/luatex-api.h
 U  luatex/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 98.

