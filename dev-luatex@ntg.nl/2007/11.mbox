From dak at gnu.org  Thu Nov  1 00:01:27 2007
From: dak at gnu.org (David Kastrup)
Date: Thu, 01 Nov 2007 00:01:27 +0100
Subject: [Dev-luatex] luatex and hyphenation patterns
In-Reply-To: <20071031100510.GI24231@gamma.logic.tuwien.ac.at> (Norbert
	Preining's message of "Wed, 31 Oct 2007 11:05:10 +0100")
References: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>
Message-ID: <851wbax514.fsf@lola.goethe.zz>

Norbert Preining <preining at logic.at> writes:

> Hi all!
>
> One user of Debian wanted to build a luatex based latex format (he
> wanted to test some examples from the luatex.org documentation slides,
> using the old \lua{...} code, anyway).
>
> Unfortunaltely this will not work in any way because there are so many
> hyphenation patterns using non-ascii and non-utf8 content. All those of
> course break.
>
> Is there any suggested way how to cope with this?

I've posted example code for this to the list once (basically converting
LuaTeX input into byte streams which is what LaTeX expects), but can't
at the moment find the (afterwards improved) sources on my computers.
Maybe a list search will turn up the first versions.

-- 
David Kastrup, Kriemhildstr. 15, 44793 Bochum

From root at www.bittext.nl  Fri Nov  2 22:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri,  2 Nov 2007 22:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071102212244.659BF1E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/Makefile.in
 U    svn/trunk/src/texk/web2c/luatexdir/managed-sa.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luatoken.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 A    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/managed-sa.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 U    svn/trunk/src/texk/web2c/lib/texmfmp.c
 Checked out revision 810.

From root at www.bittext.nl  Sun Nov  4 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Sun,  4 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071104212243.60B841E8C2B4@www.bittext.nl>

U    svn/trunk/src/libs/luafontforge/fontforge/fontforge/encoding.c
 U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 821.

From root at www.bittext.nl  Mon Nov  5 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon,  5 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071105212243.08A7A1E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.h
 Checked out revision 827.

From root at www.bittext.nl  Tue Nov  6 12:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue,  6 Nov 2007 12:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071106112244.CE4F71E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 Checked out revision 829.

From root at www.bittext.nl  Tue Nov  6 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue,  6 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071106212243.0FBC61E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexiolib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 Checked out revision 836.

From martin at oneiros.de  Wed Nov  7 17:29:49 2007
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Wed, 7 Nov 2007 17:29:49 +0100
Subject: [Dev-luatex] trunk broken on Linux?
Message-ID: <68c491a60711070829s227bf1e3xd7ddbb273e7cee52@mail.gmail.com>

I get this from build.linux on Ubuntu 7.10:
c++ -o luatex  luatexini.o luatex0.o luatex1.o luatex2.o luatex3.o
luatexextra.o loadpool.o  luatexdir/libpdf.a
../../libs/libpng/libpng.a ../../libs/zlib/libz.a
../../libs/xpdf/xpdf/libxpdf.a ../../libs/xpdf/goo/libGoo.a
../../libs/xpdf/fofi/libfofi.a ../../libs/md5/md5.o
../../libs/obsdcompat/libopenbsd-compat.a ../../libs/lua51/liblua.a
../../libs/slnunicode/slnunico.o  ../../libs/luazip/src/luazip.o
../../libs/zziplib/zzip/libzzip.a ../../libs/luafilesystem/src/lfs.o
../../libs/luapeg/lpeg.o ../../libs/luamd5/md5lib.o
../../libs/luamd5/md5.o  ../../libs/luazlib/lgzip.o
../../libs/luazlib/lzlib.o ../../libs/luafontforge/libff.a  lib/lib.a
../kpathsea/.libs/libkpathsea.a -lm   -nodefaultlibs -Wl,-Bstatic
-lstdc++ -Wl,-Bdynamic -lm -lgcc_eh -lgcc -lc -lgcc_eh -lgcc
luatexdir/libpdf.a(utils.o): In function `tprint_esc':
/home/ms/tex/luatex/svn/trunk/build/texk/web2c/luatexdir/../../../../src/texk/web2c/luatexdir/utils.c:1790:
undefined reference to `get_int_base'

Best
   Martin

From taco at elvenkind.com  Wed Nov  7 18:15:08 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 07 Nov 2007 18:15:08 +0100
Subject: [Dev-luatex] trunk broken on Linux?
In-Reply-To: <68c491a60711070829s227bf1e3xd7ddbb273e7cee52@mail.gmail.com>
References: <68c491a60711070829s227bf1e3xd7ddbb273e7cee52@mail.gmail.com>
Message-ID: <4731F29C.2060106@elvenkind.com>


Yes, it is broken. Sorry about that.

Best wishes,
Taco

From root at www.bittext.nl  Thu Nov  8 22:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Thu,  8 Nov 2007 22:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071108212244.1D9FD1E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.c
 Checked out revision 851.

From root at www.bittext.nl  Thu Nov  8 12:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Thu,  8 Nov 2007 12:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071108112244.94D671E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 Checked out revision 843.

From root at www.bittext.nl  Mon Nov 12 16:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon, 12 Nov 2007 16:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071112152243.3D4C91E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 Checked out revision 855.

From root at www.bittext.nl  Tue Nov 13 16:22:10 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue, 13 Nov 2007 16:22:10 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071113152249.1BF671E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltokenlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luastuff.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexiolib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writet3.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/dofont.c
 Checked out revision 859.

From root at www.bittext.nl  Tue Nov 13 22:22:08 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue, 13 Nov 2007 22:22:08 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071113212247.8B7FA1E8C2B8@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lstatslib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexiolib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 Checked out revision 863.

From root at www.bittext.nl  Wed Nov 14 12:22:08 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Wed, 14 Nov 2007 12:22:08 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071114112249.1BF701E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luastuff.c
 Checked out revision 865.

From root at www.bittext.nl  Wed Nov 14 22:22:10 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Wed, 14 Nov 2007 22:22:10 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071114212248.D3B781E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/Makefile.in
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luatoken.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 A    svn/trunk/src/texk/web2c/luatexdir/tex/texpdf.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 873.

From root at www.bittext.nl  Fri Nov 16 22:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri, 16 Nov 2007 22:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071116212244.0DE891E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/Makefile.in
 A    svn/trunk/src/texk/web2c/luatexdir/tokens.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luatoken.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltokenlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex-api.h
 A    svn/trunk/src/texk/web2c/luatexdir/tex/textoken.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texpdf.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writefont.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 883.

From preining at logic.at  Sat Nov 17 10:51:05 2007
From: preining at logic.at (Norbert Preining)
Date: Sat, 17 Nov 2007 10:51:05 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
Message-ID: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>

Hi all!

Frank K?ster has rewritten texdoc in luatex and now it really works much
better than the original one. 

But, we have a problem, the os.tmpname function.

Could you recommend a procedure for creating a temporary DIRECTORY?

os.tmpname already CREATES a file named in the return value, so

	tmpdir = os.tmpname();
	is_ok_tmpdir,error_string = lfs.mkdir(tmpdir)

does not work.

Furthermore, a call to securly create a tmp dir would be nice, too.

Any suggestion? Or consider this a proposal for what would be nice to
have in luatex ;-)

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
LOWER PEOVER (n.)
Common solution to the problems of a humby (q.v.)
			--- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Sat Nov 17 12:56:31 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 17 Nov 2007 12:56:31 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
Message-ID: <473ED6EF.5080503@elvenkind.com>

Norbert Preining wrote:
> Hi all!
> 
> Frank K?ster has rewritten texdoc in luatex and now it really works much
> better than the original one. 

Good to here that!

> 
> Furthermore, a call to securly create a tmp dir would be nice, too.

I agree, and will happily add it. mkstemp() doesn't help though,
as it only works for files. I'll have to borrow or write a version
of BSD's mkdtemp, somehow.

Best wishes,
Taco


From preining at logic.at  Sat Nov 17 13:28:32 2007
From: preining at logic.at (Norbert Preining)
Date: Sat, 17 Nov 2007 13:28:32 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <473ED6EF.5080503@elvenkind.com>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473ED6EF.5080503@elvenkind.com>
Message-ID: <20071117122832.GA8540@gamma.logic.tuwien.ac.at>

Hi Taco,

On Sa, 17 Nov 2007, Taco Hoekwater wrote:
> >Frank K?ster has rewritten texdoc in luatex and now it really works much
> >better than the original one. 
> 
> Good to here that!

Well, searching the whole disk with find when we have ls-R databases was
a strange approach, no? The next Debian packages of luatex (as soon as
you release a new beta ;-) will ship the lua version of texdoc instead
of the default texlive texdoc.

> >Furthermore, a call to securly create a tmp dir would be nice, too.
> 
> I agree, and will happily add it. mkstemp() doesn't help though,
> as it only works for files. I'll have to borrow or write a version
> of BSD's mkdtemp, somehow.

The is probably the best idea, since relying on a lib function which
might not exist is a problem.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
CRANLEIGH (n.)
A mood of irrational irritation with everyone and everything.
			--- Douglas Adams, The Meaning of Liff

From pragma at wxs.nl  Sat Nov 17 14:58:47 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 17 Nov 2007 14:58:47 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
Message-ID: <473EF397.6030303@wxs.nl>

Norbert Preining wrote:
> Hi all!
> 
> Frank K?ster has rewritten texdoc in luatex and now it really works much
> better than the original one. 
> 
> But, we have a problem, the os.tmpname function.
> 
> Could you recommend a procedure for creating a temporary DIRECTORY?
> 
> os.tmpname already CREATES a file named in the return value, so
> 
> 	tmpdir = os.tmpname();
> 	is_ok_tmpdir,error_string = lfs.mkdir(tmpdir)
> 
> does not work.

maybe it opens a file just to be sure that the name is indeed reserved 
an dnot taken by another process in tne meantime, so os.tmpdir() is 
needed; i wonder, maybe it makse sense to accept an optional argument 
that for the root so that one can generate a tmpdir at a specific 
location i.e. tmpdir("/tmp") or so

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From preining at logic.at  Sat Nov 17 20:24:56 2007
From: preining at logic.at (Norbert Preining)
Date: Sat, 17 Nov 2007 20:24:56 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <473EF397.6030303@wxs.nl>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473EF397.6030303@wxs.nl>
Message-ID: <20071117192456.GC3313@gamma.logic.tuwien.ac.at>

Hi Hans!

On Sa, 17 Nov 2007, Hans Hagen wrote:
> maybe it opens a file just to be sure that the name is indeed reserved 
> an dnot taken by another process in tne meantime, so os.tmpdir() is 

Yes, otherwise it would be racy, some other process could make a symlink
attack whatever you have in your home dir.

> needed; i wonder, maybe it makse sense to accept an optional argument 
> that for the root so that one can generate a tmpdir at a specific 
> location i.e. tmpdir("/tmp") or so

	mkstemp and mkdtemp (section 3)

allow for templates. Or the shell function

	mktemp

allows for templates and creation of dirs/files.

But are mkdtemp and mkstemp available everywhere we want to compile
luatex?

The man page of mkdtemp(3) is not very inviting:
   VERSIONS
       Available since glibc 2.1.91.


Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
BOOTHBY GRAFFOE
1. The man in the pub who slaps people on the back as if they were old
   friends, when in fact he has no friends, largely on account of this
   habit. 2. Any story told by Robert Morley on chat shows.
			--- Douglas Adams, The Meaning of Liff

From martin at oneiros.de  Sat Nov 17 20:33:33 2007
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Sat, 17 Nov 2007 20:33:33 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <20071117192456.GC3313@gamma.logic.tuwien.ac.at>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473EF397.6030303@wxs.nl>
	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>
Message-ID: <68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>

2007/11/17, Norbert Preining <preining at logic.at>:
> But are mkdtemp and mkstemp available everywhere we want to compile
> luatex?
>
> The man page of mkdtemp(3) is not very inviting:
>    VERSIONS
>        Available since glibc 2.1.91.
------------------
HISTORY
     A mktemp() function appeared in Version 7 AT&T UNIX.  The mkdtemp() func-
     tion appeared in OpenBSD 2.2.  The mkstemp() function appeared in 4.4BSD.
     The mkstemps() function appeared in OpenBSD 2.3.

BUGS
     For mktemp() there is an obvious race between file name selection and
     file creation and deletion: the program is typically written to call
     tmpnam(3), tempnam(3), or mktemp().  Subsequently, the program calls
     open(2) or fopen(3) and erroneously opens a file (or symbolic link, FIFO
     or other device) that the attacker has created in the expected file loca-
     tion.  Hence mkstemp() is recommended, since it atomically creates the
     file.  An attacker can guess the file names produced by mktemp().  When-
     ever it is possible, mkstemp() or mkdtemp() should be used instead.

     For this reason, ld(1) will output a warning message whenever it links
     code that uses mktemp().

     The mkdtemp() and mkstemps() functions are non-standard and should not be
     used if portability is required.
------------------
Btw: The OpenBSD man pages are available online. :-)

Best
   Martin

From preining at logic.at  Sat Nov 17 20:43:10 2007
From: preining at logic.at (Norbert Preining)
Date: Sat, 17 Nov 2007 20:43:10 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473EF397.6030303@wxs.nl>
	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>
	<68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>
Message-ID: <20071117194310.GE3313@gamma.logic.tuwien.ac.at>

On Sa, 17 Nov 2007, Martin Schr?der wrote:
>      For this reason, ld(1) will output a warning message whenever it links
>      code that uses mktemp().
> 
>      The mkdtemp() and mkstemps() functions are non-standard and should not be
>      used if portability is required.

Hmm, so there is the option between portability and security, grrrrr.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
QUEDGELEY (n.)
A rabidly left-wing politician who can afford to be that way because
he married a millionairess.
			--- Douglas Adams, The Meaning of Liff

From martin at oneiros.de  Sat Nov 17 20:52:25 2007
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Sat, 17 Nov 2007 20:52:25 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <20071117194310.GE3313@gamma.logic.tuwien.ac.at>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473EF397.6030303@wxs.nl>
	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>
	<68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>
	<20071117194310.GE3313@gamma.logic.tuwien.ac.at>
Message-ID: <68c491a60711171152w338e0faen4ef84ba0d35b216@mail.gmail.com>

2007/11/17, Norbert Preining <preining at logic.at>:
> Hmm, so there is the option between portability and security, grrrrr.

Yes. And a case for autoconf. :-(

Best
   Martin

From preining at logic.at  Sat Nov 17 20:59:28 2007
From: preining at logic.at (Norbert Preining)
Date: Sat, 17 Nov 2007 20:59:28 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <68c491a60711171152w338e0faen4ef84ba0d35b216@mail.gmail.com>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473EF397.6030303@wxs.nl>
	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>
	<68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>
	<20071117194310.GE3313@gamma.logic.tuwien.ac.at>
	<68c491a60711171152w338e0faen4ef84ba0d35b216@mail.gmail.com>
Message-ID: <20071117195928.GI3313@gamma.logic.tuwien.ac.at>

On Sa, 17 Nov 2007, Martin Schr?der wrote:
> Yes. And a case for autoconf. :-(

I am confident Taco will manage this ;-) My acquantaince with auto*
tools is not even 0, better less then 0.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
ARTHUR	What is an Algolian Zylatburger anyway?
FORD	They're a kind of meatburger made from the most unpleasant parts
	of a creature well known for its total lack of any pleasant
	parts.
ARTHUR	So you mean that the Universe does actually end not with a bang
	but with a Wimpy?
                 --- Cut dialogue from Fit the Fifth.
                 --- Douglas Adams, The Hitchhikers Guide to the Galaxy

From taco at elvenkind.com  Sun Nov 18 09:27:02 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 18 Nov 2007 09:27:02 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <20071117194310.GE3313@gamma.logic.tuwien.ac.at>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>	<473EF397.6030303@wxs.nl>	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>	<68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>
	<20071117194310.GE3313@gamma.logic.tuwien.ac.at>
Message-ID: <473FF756.1020301@elvenkind.com>

Norbert Preining wrote:
> On Sa, 17 Nov 2007, Martin Schr?der wrote:
>>      For this reason, ld(1) will output a warning message whenever it links
>>      code that uses mktemp().
>>
>>      The mkdtemp() and mkstemps() functions are non-standard and should not be
>>      used if portability is required.
> 
> Hmm, so there is the option between portability and security, grrrrr.

That's why I wrote:

> I'll have to borrow or write a version of BSD's mkdtemp, somehow.

conf'ing for something that only exists in some specific BSD's is not
worth the effort (unless it can reliably be added to openbsdcompat).

Best wishes,
Taco





From martin at oneiros.de  Sun Nov 18 13:55:10 2007
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Sun, 18 Nov 2007 13:55:10 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <473FF756.1020301@elvenkind.com>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>
	<473EF397.6030303@wxs.nl>
	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>
	<68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>
	<20071117194310.GE3313@gamma.logic.tuwien.ac.at>
	<473FF756.1020301@elvenkind.com>
Message-ID: <68c491a60711180455j67c70ec7tb2ed666e9e69d384@mail.gmail.com>

2007/11/18, Taco Hoekwater <taco at elvenkind.com>:
> That's why I wrote:
>
> > I'll have to borrow or write a version of BSD's mkdtemp, somehow.
>
> conf'ing for something that only exists in some specific BSD's is not
> worth the effort (unless it can reliably be added to openbsdcompat).

The original openssh-openbsd-compat has
#if !defined(HAVE_MKDTEMP) || defined(HAVE_STRICT_MKSTEMP)
int mkstemps(char *path, int slen);
int mkstemp(char *path);
char *mkdtemp(char *path);
#endif

Best
   Martin

From taco at elvenkind.com  Sun Nov 18 14:14:53 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 18 Nov 2007 14:14:53 +0100
Subject: [Dev-luatex] mkstemp or similar in lua(tex)
In-Reply-To: <68c491a60711180455j67c70ec7tb2ed666e9e69d384@mail.gmail.com>
References: <20071117095105.GN26438@gamma.logic.tuwien.ac.at>	<473EF397.6030303@wxs.nl>	<20071117192456.GC3313@gamma.logic.tuwien.ac.at>	<68c491a60711171133g72993f93l68ecea4c8e770cc0@mail.gmail.com>	<20071117194310.GE3313@gamma.logic.tuwien.ac.at>	<473FF756.1020301@elvenkind.com>
	<68c491a60711180455j67c70ec7tb2ed666e9e69d384@mail.gmail.com>
Message-ID: <47403ACD.3070808@elvenkind.com>

Martin Schr?der wrote:
> 2007/11/18, Taco Hoekwater <taco at elvenkind.com>:
>> That's why I wrote:
>>
>>> I'll have to borrow or write a version of BSD's mkdtemp, somehow.
>> conf'ing for something that only exists in some specific BSD's is not
>> worth the effort (unless it can reliably be added to openbsdcompat).
> 
> The original openssh-openbsd-compat has
> #if !defined(HAVE_MKDTEMP) || defined(HAVE_STRICT_MKSTEMP)
> int mkstemps(char *path, int slen);
> int mkstemp(char *path);
> char *mkdtemp(char *path);
> #endif

But will this work if a platform has mkstemp, but not mkdtemp?

Best,
Taco



From root at www.bittext.nl  Mon Nov 19 16:22:11 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon, 19 Nov 2007 16:22:11 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071119152250.15E8C1E8C2BD@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/Makefile.in
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 A    svn/trunk/src/texk/web2c/luatexdir/lua/loslibext.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luastuff.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex-api.h
 Checked out revision 889.

From root at www.bittext.nl  Tue Nov 20 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue, 20 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071120212243.226581E8C2BD@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 Checked out revision 892.

From root at www.bittext.nl  Wed Nov 21 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Wed, 21 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071121212243.3EE761E8C2BD@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 Checked out revision 895.

From root at www.bittext.nl  Thu Nov 22 16:22:12 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Thu, 22 Nov 2007 16:22:12 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071122152251.7948A1E8C2BD@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/hyphen.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 Checked out revision 900.

From root at www.bittext.nl  Thu Nov 22 22:22:08 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Thu, 22 Nov 2007 22:22:08 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071122212248.019561E8C2BA@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 Checked out revision 903.

From root at www.bittext.nl  Fri Nov 23 22:22:07 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri, 23 Nov 2007 22:22:07 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071123212246.6F19F1E8C2B4@www.bittext.nl>

U    svn/trunk/src/libs/luafontforge/src/luafflib.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 Checked out revision 905.

From root at www.bittext.nl  Mon Nov 26 16:22:12 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon, 26 Nov 2007 16:22:12 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071126152251.C06061E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 Checked out revision 907.

From root at www.bittext.nl  Tue Nov 27 16:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue, 27 Nov 2007 16:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071127152245.6B6091E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/vfovf.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 912.

From root at www.bittext.nl  Tue Nov 27 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Tue, 27 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071127212243.670101E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 913.

From root at www.bittext.nl  Wed Nov 28 12:22:10 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Wed, 28 Nov 2007 12:22:10 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071128112252.8DC4F1E8C2B4@www.bittext.nl>

U    svn/trunk/build.sh.linux
 U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/hyphen.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lstatslib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luastuff.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexmac.h
 U    svn/trunk/src/texk/web2c/luatexdir/makecpool.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/svnversion.h
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writettf.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/tfmofm.c
 Checked out revision 918.

From root at www.bittext.nl  Wed Nov 28 22:22:07 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Wed, 28 Nov 2007 22:22:07 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071128212246.11FDE1E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/manual/luatexref-t.tex
 U    svn/trunk/manual/luatexref-t.pdf
 Checked out revision 922.

From root at www.bittext.nl  Thu Nov 29 12:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Thu, 29 Nov 2007 12:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071129112244.3C16A1E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltokenlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexiolib.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/tfmofm.c
 Checked out revision 925.

From root at www.bittext.nl  Fri Nov 30 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri, 30 Nov 2007 22:22:04 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071130212242.EED731E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/texnodes.c
 U    svn/trunk/manual/luatexref-t.tex
 Checked out revision 930.

