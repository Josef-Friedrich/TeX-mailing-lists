From preining at logic.at  Mon Oct  1 07:22:10 2007
From: preining at logic.at (Norbert Preining)
Date: Mon, 1 Oct 2007 07:22:10 +0200
Subject: [Dev-luatex] setting up context/luatex, luatex caches
Message-ID: <20071001052210.GA18947@gamma.logic.tuwien.ac.at>

Hi all!

Before uploading context 2007.09.28 I want to straigthen some things out
wrt luatex etc, the least is that I want to add a README so that users
can set up context/luatex themselves.

Now my questions:
- Is it possible to have MORE THAN ONE luatex cache directory? Something
  like
	TEXMFCACHE=/var/lib/texmf/systexmf-cache;$HOME/.texmf-var/texmfcache
  such that 
	/v/l/t/systexmf-cache contains the cached trees for the system
		trees (/usr/share/texmf{,-texlive}, ...)
	$HOME/.texmf-var/texmfcache contains the cache of the users
		home directory texmf tree

- Is it possible to tell luatools to update only some (or only one)
  texmf tree? Something like
	luatools --generate /usr/share/texmf-texlive
  ?

- Is there an obvious objection to replace luatex binary with a script
  which contains the necessary TEXMFCNF settings, something like
	if [ -z "$TEXMFCNF" ] ; then
		TEXMFCNF=/usr/share/texmf/web2c
		export TEXMFCNF
	fi
	luatex.bin $*
  ? Reason: First is that we know where the texmf.cnf is and we don't
  have to urge the user to set the env var. Furthermore a user CAN 
  override the TEXMFCNF settings if he wants to.

Thanks a lot, and sorry for buggering you with these questions, but I
want to get a decent system for Debian.  

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
For a moment, nothing happened. Then, after a second or
so, nothing continued to happen.
                 --- Douglas Adams, The Hitchhikers Guide to the Galaxy

From arthur.reutenauer at normalesup.org  Mon Oct  1 07:59:36 2007
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Mon, 1 Oct 2007 07:59:36 +0200
Subject: [Dev-luatex] [dev-context] setting up context/luatex,
	luatex caches
In-Reply-To: <20071001052210.GA18947@gamma.logic.tuwien.ac.at>
References: <20071001052210.GA18947@gamma.logic.tuwien.ac.at>
Message-ID: <20071001055936.GA17300@phare.normalesup.org>

> - Is it possible to have MORE THAN ONE luatex cache directory?

  I'm not sure if this really makes sense, but you may want to know that
luatools looks up a number of environment variables consecutively to
determine the location of the cache: first TEXMFCACHE, then HOME and
other similar variables, then VARTEXMF and similar vars, etc. (see line 3768
of luatools.lua for the complete list).

  I guess this could do the trick: the installation could generate the
formats and put them in $VARTEXMF, and each user could put his own files
in $HOME and override the defaults if the wants to (provided TEXMFCACHE
is not set); but I need to check if this indeed works (not sure).

> - Is there an obvious objection to replace luatex binary with a script
>   which contains the necessary TEXMFCNF settings

  I don't think this would be any problem with the ConTeXt developers,
but you need to account for the fact that LuaTeX may be used with other
formats.  That's what I told you in the other thread: all these settings
are related to LuaTeX but they're really specific to ConTeXt, and if
someone wants to use LaTeX over the LuaTeX engine he may not be happy
that the settings are not exactly the same than for the other engines.

  Of course if you only set TEXMFCNF and nothing else this shouldn't
make any difference.

	Arthur

From pragma at wxs.nl  Mon Oct  1 10:49:34 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 01 Oct 2007 10:49:34 +0200
Subject: [Dev-luatex] [dev-context] setting up context/luatex,
	luatex caches
In-Reply-To: <20071001055936.GA17300@phare.normalesup.org>
References: <20071001052210.GA18947@gamma.logic.tuwien.ac.at>
	<20071001055936.GA17300@phare.normalesup.org>
Message-ID: <4700B49E.5030901@wxs.nl>

Arthur Reutenauer wrote:
>> - Is it possible to have MORE THAN ONE luatex cache directory?
> 
>   I'm not sure if this really makes sense, but you may want to know that
> luatools looks up a number of environment variables consecutively to
> determine the location of the cache: first TEXMFCACHE, then HOME and
> other similar variables, then VARTEXMF and similar vars, etc. (see line 3768
> of luatools.lua for the complete list).
> 
>   I guess this could do the trick: the installation could generate the
> formats and put them in $VARTEXMF, and each user could put his own files
> in $HOME and override the defaults if the wants to (provided TEXMFCACHE
> is not set); but I need to check if this indeed works (not sure).
> 
>> - Is there an obvious objection to replace luatex binary with a script
>>   which contains the necessary TEXMFCNF settings
> 
>   I don't think this would be any problem with the ConTeXt developers,
> but you need to account for the fact that LuaTeX may be used with other
> formats.  That's what I told you in the other thread: all these settings
> are related to LuaTeX but they're really specific to ConTeXt, and if
> someone wants to use LaTeX over the LuaTeX engine he may not be happy
> that the settings are not exactly the same than for the other engines.

when generating things you see something

c:/temp/luatex-cache/context/36cfaf81cc343ab858e892f7ccbb5039/trees/36cfaf81cc343ab858e892f7cc
bb5039.tma

the first hash is tree basesd and permits multiple tex installations 
alongside, the filename hashes are derived from the names plus full 
paths, also in order to prevent funny subpaths etc; so, indeed we can 
run multiple installations in the same cache (on our linux servers i 
often run multiple trees along side since project use frozen tex's)

Hans




-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From preining at logic.at  Mon Oct  1 11:00:14 2007
From: preining at logic.at (Norbert Preining)
Date: Mon, 1 Oct 2007 11:00:14 +0200
Subject: [Dev-luatex] [dev-context] setting up context/luatex,
	luatex caches
In-Reply-To: <4700B49E.5030901@wxs.nl>
References: <20071001052210.GA18947@gamma.logic.tuwien.ac.at>
	<20071001055936.GA17300@phare.normalesup.org>
	<4700B49E.5030901@wxs.nl>
Message-ID: <20071001090014.GB29998@gamma.logic.tuwien.ac.at>

Hi Hans!

On Mo, 01 Okt 2007, Hans Hagen wrote:
> >>- Is it possible to have MORE THAN ONE luatex cache directory?
[...]
> the first hash is tree basesd and permits multiple tex installations 
> alongside, the filename hashes are derived from the names plus full 
> paths, also in order to prevent funny subpaths etc; so, indeed we can 
> run multiple installations in the same cache (on our linux servers i 
> often run multiple trees along side since project use frozen tex's)

Sorry if I have been unclear: I don't want to have different
installation trees in the lua cache, I want DIFFERENT LOCATIONS of the
lua cache to be merged. So that the cache for
	TEXMFDIST
	TEXMFMAIN
	TEXMFVAR
lies in /var/lib/texmf/luatexcache, and the cache for
	TEXMFHOME
lies in ~/.texmf-var/luatexcache.

And in ~/.texmf-var/luatexcache there is ONLY the cache for TEXMFHOME
and not for the others.

So users can add/remove files from TEXMFHOME and update their local
cache without fiddling with the system wide cache.

Do go conform with other texmf.cnf settings, for example something like
this:
	TEXMFSYSCACHE=/var/lib/texmf/luatexcache
	TEXMFCACHE=$HOME/.texmf-var/luatexcache
and luatex/context collects the stuff found in TEXMFSYSCACHE and
TEXMFCACHE. Same as with TEXMFVAR and TEXMFSYSVAR

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
EAST WITTERING (n.)
The same as west wittering (q.v.) only it's you they've trying to get
away from.
			--- Douglas Adams, The Meaning of Liff

From root at aanhet.net  Mon Oct  1 16:24:34 2007
From: root at aanhet.net (Cron Daemon)
Date: Mon,  1 Oct 2007 16:24:34 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071001142434.6C25328000AF@server.aanhet.net>

U  luatex/trunk/manual/luatexref-t.tex
 Checked out revision 771.

From root at aanhet.net  Mon Oct  1 22:26:32 2007
From: root at aanhet.net (Cron Daemon)
Date: Mon,  1 Oct 2007 22:26:32 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071001202632.BEBA928000B3@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/nodes.h
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/ptexlib.h
 Checked out revision 772.

From Jonathan.Sauer at silverstroke.com  Tue Oct  2 09:49:13 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Tue, 2 Oct 2007 09:49:13 +0200
Subject: [Dev-luatex] Revision 768
Message-ID: <9343542E664B894484613D106D7D3F5F84AACF@s-yellow.net.silverstroke.de>

Hello,

when GCC is used, writing '==' instead of '=' should be caught
with the switch '-Wunused-value'.

Enable compiler warnings (all of them, if possible), compiler
warnings are your friend :-)


Jonathan


From Jonathan.Sauer at silverstroke.com  Tue Oct  2 10:09:59 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Tue, 2 Oct 2007 10:09:59 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
Message-ID: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>

Hello,

tex.print/tex.sprint/tex.write accept an arbitrary number of
parameters, whereas texio.write does not. Is there a reason
for this discrepancy? (other than "temporary implementation",
of course ;-)


Jonathan


From taco at elvenkind.com  Tue Oct  2 11:31:44 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 02 Oct 2007 11:31:44 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>
References: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>
Message-ID: <47021000.3050208@elvenkind.com>



Jonathan Sauer wrote:
> Hello,
> 
> tex.print/tex.sprint/tex.write accept an arbitrary number of
> parameters, whereas texio.write does not. Is there a reason
> for this discrepancy? (other than "temporary implementation",
> of course ;-)

Not really. I will make the texio functions accept multiple strings
as well.



From taco at elvenkind.com  Tue Oct  2 11:42:25 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 02 Oct 2007 11:42:25 +0200
Subject: [Dev-luatex] Revision 768
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AACF@s-yellow.net.silverstroke.de>
References: <9343542E664B894484613D106D7D3F5F84AACF@s-yellow.net.silverstroke.de>
Message-ID: <47021281.1070208@elvenkind.com>



Jonathan Sauer wrote:
> Hello,
> 
> when GCC is used, writing '==' instead of '=' should be caught
> with the switch '-Wunused-value'.
> 
> Enable compiler warnings (all of them, if possible), compiler
> warnings are your friend :-)

Actually, I occasionally do that, just not all the time. If you want
to do it yourself, run build.sh while the environment variable 
XCFLAGS=-Wall set.



From Jonathan.Sauer at silverstroke.com  Tue Oct  2 12:03:44 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Tue, 2 Oct 2007 12:03:44 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
References: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>
	<47021000.3050208@elvenkind.com>
Message-ID: <9343542E664B894484613D106D7D3F5F84AAD2@s-yellow.net.silverstroke.de>

Hello,

> > tex.print/tex.sprint/tex.write accept an arbitrary number of 
> > parameters, whereas texio.write does not. Is there a reason for this

> > discrepancy? (other than "temporary implementation", of course ;-)
> 
> Not really. I will make the texio functions accept multiple 
> strings as well.

Great! Thank you!


Jonathan


From root at aanhet.net  Tue Oct  2 12:24:39 2007
From: root at aanhet.net (Cron Daemon)
Date: Tue,  2 Oct 2007 12:24:39 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071002102439.512F8280023F@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/hyphen.h
 U  luatex/trunk/src/texk/web2c/luatexdir/lang/hyphen.c
 Checked out revision 773.

From root at aanhet.net  Tue Oct  2 16:25:32 2007
From: root at aanhet.net (Cron Daemon)
Date: Tue,  2 Oct 2007 16:25:32 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071002142532.593072800280@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/nodes.h
 Checked out revision 775.

From root at aanhet.net  Wed Oct  3 22:24:34 2007
From: root at aanhet.net (Cron Daemon)
Date: Wed,  3 Oct 2007 22:24:34 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071003202434.64ACF2800185@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/hyphen.h
 U  luatex/trunk/src/texk/web2c/luatexdir/Makefile.in
 U  luatex/trunk/src/texk/web2c/luatexdir/luatex.web
 U  luatex/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lang/hyphen.c
 D  luatex/trunk/src/texk/web2c/luatexdir/lua/nodes.h
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 A  luatex/trunk/src/texk/web2c/luatexdir/nodes.h
 Checked out revision 777.

From preining at logic.at  Thu Oct  4 10:44:24 2007
From: preining at logic.at (Norbert Preining)
Date: Thu, 4 Oct 2007 10:44:24 +0200
Subject: [Dev-luatex] compiling luatexref-t.tex
Message-ID: <20071004084424.GH2593@gamma.logic.tuwien.ac.at>

Hi all!

I am trying to compile luatexref-t.tex from svn source but:

$ texexec luatexref-t.tex
...
(mpgraph.mp
! Number is too large (10000).
l.4 _special_div_ := 10000
                          ;


I have
luatex 0.11.2
context 2007.09.28
metapost 1.00

Any idea where this is coming from?


Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
AINDERBY QUERNHOW (n.)
One who continually bemoans the 'loss' of the word 'gay' to the
English language, even though they had never used the word in any
context at all until they started complaining that they couldn't use
it any more.
			--- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Thu Oct  4 12:41:07 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 04 Oct 2007 12:41:07 +0200
Subject: [Dev-luatex] compiling luatexref-t.tex
In-Reply-To: <20071004084424.GH2593@gamma.logic.tuwien.ac.at>
References: <20071004084424.GH2593@gamma.logic.tuwien.ac.at>
Message-ID: <4704C343.1050408@elvenkind.com>

Norbert Preining wrote:
> Hi all!
> 
> I am trying to compile luatexref-t.tex from svn source but:
> 
> $ texexec luatexref-t.tex
> ...
> (mpgraph.mp
> ! Number is too large (10000).
> l.4 _special_div_ := 10000
>                           ;
> 
> 
> I have
> luatex 0.11.2
> context 2007.09.28
> metapost 1.00
> 
> Any idea where this is coming from?

 From metapost (but that is obvious). I suspect you are running an
older version of metafun.mem, but I do not quite understand why,
it should have been re-generated when you upgraded your context.



From mojca.miklavec.lists at gmail.com  Thu Oct  4 12:44:37 2007
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Thu, 4 Oct 2007 12:44:37 +0200
Subject: [Dev-luatex] [dev-context]  compiling luatexref-t.tex
In-Reply-To: <4704C343.1050408@elvenkind.com>
References: <20071004084424.GH2593@gamma.logic.tuwien.ac.at>
	<4704C343.1050408@elvenkind.com>
Message-ID: <6faad9f00710040344o744e50bfpc2648d2744a8d7d9@mail.gmail.com>

On 10/4/07, Taco Hoekwater wrote:
> Norbert Preining wrote:
> > Hi all!
> >
> > I am trying to compile luatexref-t.tex from svn source but:
> >
> > $ texexec luatexref-t.tex
> > ...
> > (mpgraph.mp
> > ! Number is too large (10000).
> > l.4 _special_div_ := 10000
> >                           ;
> >
> >
> > I have
> > luatex 0.11.2
> > context 2007.09.28
> > metapost 1.00
> >
> > Any idea where this is coming from?
>
>  From metapost (but that is obvious). I suspect you are running an
> older version of metafun.mem, but I do not quite understand why,
> it should have been re-generated when you upgraded your context.

Unless metapost is upgraded after ConTeXt :)

Mojca

From preining at logic.at  Thu Oct  4 12:48:20 2007
From: preining at logic.at (Norbert Preining)
Date: Thu, 4 Oct 2007 12:48:20 +0200
Subject: [Dev-luatex] compiling luatexref-t.tex
In-Reply-To: <4704C343.1050408@elvenkind.com>
References: <20071004084424.GH2593@gamma.logic.tuwien.ac.at>
	<4704C343.1050408@elvenkind.com>
Message-ID: <20071004104820.GO2593@gamma.logic.tuwien.ac.at>

Hi Taco!

On Do, 04 Okt 2007, Taco Hoekwater wrote:
> >luatex 0.11.2
> >context 2007.09.28
> >metapost 1.00
> >
> >Any idea where this is coming from?
> 
> From metapost (but that is obvious). I suspect you are running an
> older version of metafun.mem, but I do not quite understand why,
> it should have been re-generated when you upgraded your context.

Strange. I updated metafun.mem ...

$ metafun --version
MetaPost 1.000 (Web2C 7.5.6)
...
$ metafun
...
**\relax

*bye.
$ 

So this could not be the problem???

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
`...You hadn't exactly gone out of your way to call
attention to them had you? I mean like actually telling
anyone or anything.'
`But the plans were on display...'
`On display? I eventually had to go down to the cellar to
find them.'
`That's the display department.'
`With a torch.'
`Ah, well the lights had probably gone.'
`So had the stairs.'
`But look you found the notice didn't you?'
yes I did. It was on display in the
bottom of a locked filing cabinet stuck in a disused
lavatory with a sign on the door saying "Beware of The
Leopard".'
                 --- Arthur singing the praises of the local council planning
                 --- department.
                 --- Douglas Adams, The Hitchhikers Guide to the Galaxy

From taco at elvenkind.com  Thu Oct  4 12:52:51 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 04 Oct 2007 12:52:51 +0200
Subject: [Dev-luatex] compiling luatexref-t.tex
In-Reply-To: <20071004104820.GO2593@gamma.logic.tuwien.ac.at>
References: <20071004084424.GH2593@gamma.logic.tuwien.ac.at>
	<4704C343.1050408@elvenkind.com>
	<20071004104820.GO2593@gamma.logic.tuwien.ac.at>
Message-ID: <4704C603.4030502@elvenkind.com>

Norbert Preining wrote:
> Hi Taco!
> 
> On Do, 04 Okt 2007, Taco Hoekwater wrote:
>>> luatex 0.11.2
>>> context 2007.09.28
>>> metapost 1.00
>>>
>>> Any idea where this is coming from?
>> From metapost (but that is obvious). I suspect you are running an
>> older version of metafun.mem, but I do not quite understand why,
>> it should have been re-generated when you upgraded your context.
> 
> Strange. I updated metafun.mem ...
> 
> $ metafun --version
> MetaPost 1.000 (Web2C 7.5.6)
> ...
> $ metafun
> ...
> **\relax
> 
> *bye.
> $ 
> 
> So this could not be the problem???

Odd indeed. The actual error is triggered by the 'warning checks'
in metapost, and there is an explicit

	warningcheck := 0 ;

in mp-tool.mp to suppress them (line 62).


From jjq at galcit.caltech.edu  Thu Oct  4 20:32:05 2007
From: jjq at galcit.caltech.edu (James Quirk)
Date: Thu, 4 Oct 2007 11:32:05 -0700 (PDT)
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
Message-ID: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>

Hi,

With luatex-beta-0.11.2 when I run:

\directlua 0 {
   local t = node.new('whatsit',8)
   t.mode  = 1
   t.data  = "1 0 0 rgb"
   print (t.data)
}
\bye

I get the output:

\BAD.1 0 0 rgb

After investigating the matter, it seems that the routine 
tokenlist_to_luastring is trying to output the reference count 
set up by the routine tokenlist_from_lua. Hence the appearance
of \BAD. Is this a bug? Or am I missing something?
If it's the latter then I apologise.

Thanks in advance,

James

From taco at elvenkind.com  Thu Oct  4 21:24:54 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 04 Oct 2007 21:24:54 +0200
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
In-Reply-To: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
References: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
Message-ID: <47053E06.506@elvenkind.com>

James Quirk wrote:
> Hi,
> 
> With luatex-beta-0.11.2 when I run:
> 
> \directlua 0 {
>    local t = node.new('whatsit',8)
>    t.mode  = 1
>    t.data  = "1 0 0 rgb"
>    print (t.data)
> }
> \bye
> 
> I get the output:
> 
> \BAD.1 0 0 rgb
> 
> After investigating the matter, it seems that the routine 
> tokenlist_to_luastring is trying to output the reference count 
> set up by the routine tokenlist_from_lua. Hence the appearance
> of \BAD. Is this a bug? Or am I missing something?
> If it's the latter then I apologise.

I believe that is a bug. I'll check it out tomorrow.

Best wishes,
Taco

From root at aanhet.net  Thu Oct  4 22:25:08 2007
From: root at aanhet.net (Cron Daemon)
Date: Thu,  4 Oct 2007 22:25:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071004202508.C733E2800402@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/hyphen.h
 U  luatex/trunk/src/texk/web2c/luatexdir/luatex.ch
 U  luatex/trunk/src/texk/web2c/luatexdir/luatex.web
 U  luatex/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lang/hyphen.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/lstatslib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/nodes.h
 U  luatex/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 779.

From jjq at galcit.caltech.edu  Fri Oct  5 00:29:47 2007
From: jjq at galcit.caltech.edu (James Quirk)
Date: Thu, 4 Oct 2007 15:29:47 -0700 (PDT)
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
In-Reply-To: <47053E06.506@elvenkind.com>
References: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
	<47053E06.506@elvenkind.com>
Message-ID: <Pine.LNX.4.64.0710041457100.27782@hmx.galcit.caltech.edu>

On Thu, 4 Oct 2007, Taco Hoekwater wrote:

> James Quirk wrote:
> > Hi,
> > 
> > With luatex-beta-0.11.2 when I run:
> > 
> > \directlua 0 {
> >    local t = node.new('whatsit',8)
> >    t.mode  = 1
> >    t.data  = "1 0 0 rgb"
> >    print (t.data)
> > }
> > \bye
> > 
> > I get the output:
> > 
> > \BAD.1 0 0 rgb
> > 
> > After investigating the matter, it seems that the routine
> > tokenlist_to_luastring is trying to output the reference count set up by the
> > routine tokenlist_from_lua. Hence the appearance
> > of \BAD. Is this a bug? Or am I missing something?
> > If it's the latter then I apologise.
> 
> I believe that is a bug. I'll check it out tomorrow.
If it helps you track down the problem, my band-aid to
the above was to change line 444 of luatoken.c from:

  s = tokenlist_to_cstring(p,1,&l);

to:  
 
  s = tokenlist_to_cstring(link(p),1,&l);

I've checked to see what the knock-on affects are and it seems
to be safe, but I'm not really in a position to judge.

On a related note, I noticed that is not possible to
read or write the data field in a pdf_annot whatsit.
For instance, I was trying to define an annotation using:

\directlua 0 {
   local t  = node.new('whatsit',15)
   t.width  = mywidth
   t.height = myheight   
   t.depth  = mydepth
   t.objnum = myobjnum
   t.data   = mydata
   tex.setbox(0,t)
}
\box0

Is this an oversight, or have you simply not had the chance to plumb 
this facility in yet. I recognize that you must be snowed under with work,
but it occurred to me that the above would be much quicker for
defining a /Widget annotation than to have to use the token interface.
As an experiment, I added the necessary read and write code to lnodelib.c 
and tested how long it would take to create 10,000 annotations.
The node route was an order of magnitude quicker than the token route.
It would also be useful to have a routine in the pdf library
that would be able to reserve a pdfobj so one could write:

\directlua 0 {
   local t  = node.new('whatsit',15)
   t.width  = mywidth
   t.height = myheight
   t.depth  = mydepth
   t.objnum = pdf.reserveobjnum()
   t.data   = mydata
   tex.setbox(0,t)
}

Anyhow, please don't think that I'm not appreciate of your
efforts. Because the deeper I delve into LuaTeX, the more
I'm excited by the possibilites it offers.

Best Regards,

James

> 
> Best wishes,
> Taco
> 

From pragma at wxs.nl  Fri Oct  5 09:27:14 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 05 Oct 2007 09:27:14 +0200
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
In-Reply-To: <Pine.LNX.4.64.0710041457100.27782@hmx.galcit.caltech.edu>
References: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>	<47053E06.506@elvenkind.com>
	<Pine.LNX.4.64.0710041457100.27782@hmx.galcit.caltech.edu>
Message-ID: <4705E752.5030809@wxs.nl>

James Quirk wrote:

> \directlua 0 {
>    local t  = node.new('whatsit',15)
>    t.width  = mywidth
>    t.height = myheight   
>    t.depth  = mydepth
>    t.objnum = myobjnum
>    t.data   = mydata
>    tex.setbox(0,t)
> }
> \box0
> 
> Is this an oversight, or have you simply not had the chance to plumb 
> this facility in yet. I recognize that you must be snowed under with work,
> but it occurred to me that the above would be much quicker for
> defining a /Widget annotation than to have to use the token interface.
> As an experiment, I added the necessary read and write code to lnodelib.c 
> and tested how long it would take to create 10,000 annotations.
> The node route was an order of magnitude quicker than the token route.
> It would also be useful to have a routine in the pdf library
> that would be able to reserve a pdfobj so one could write:
> 
> \directlua 0 {
>    local t  = node.new('whatsit',15)
>    t.width  = mywidth
>    t.height = myheight
>    t.depth  = mydepth
>    t.objnum = pdf.reserveobjnum()
>    t.data   = mydata
>    tex.setbox(0,t)
> }
> 
> Anyhow, please don't think that I'm not appreciate of your
> efforts. Because the deeper I delve into LuaTeX, the more
> I'm excited by the possibilites it offers.

So far we've focussed on the input part, fonts, node list building, 
currently hyphenation, soon math ... the backend issues (to which this 
is related) are on the agenda. Eventually the whole pdf machinery will 
be opened up so there may be additional interfaces to the whatsit one

(concerning speed: we do lots of experiments with performance and 
although currently luatex overall is slower than pdftex, one can indeed 
gain some back by using lua code instead of tex code and directly 
accessing the node list; also, the token interface is less efficient 
(more data involved, lots of small tables and therefore garbage 
collection) than manipulating nodes (first versions used tables, now we 
have userdata)

Hans



-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Fri Oct  5 11:15:13 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 05 Oct 2007 11:15:13 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AAD2@s-yellow.net.silverstroke.de>
References: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>	<47021000.3050208@elvenkind.com>
	<9343542E664B894484613D106D7D3F5F84AAD2@s-yellow.net.silverstroke.de>
Message-ID: <470600A1.2030808@elvenkind.com>



Jonathan Sauer wrote:
> Hello,
> 
>>> tex.print/tex.sprint/tex.write accept an arbitrary number of 
>>> parameters, whereas texio.write does not. Is there a reason for this
> 
>>> discrepancy? (other than "temporary implementation", of course ;-)
>> Not really. I will make the texio functions accept multiple 
>> strings as well.
> 
> Great! Thank you!

Patch is in trunk


From taco at elvenkind.com  Fri Oct  5 11:16:06 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 05 Oct 2007 11:16:06 +0200
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
In-Reply-To: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
References: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
Message-ID: <470600D6.8020303@elvenkind.com>



James Quirk wrote:
> Hi,
> 
> 
> I get the output:
> 
> \BAD.1 0 0 rgb

patch is in trunk

From taco at elvenkind.com  Fri Oct  5 11:16:35 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 05 Oct 2007 11:16:35 +0200
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
In-Reply-To: <Pine.LNX.4.64.0710041457100.27782@hmx.galcit.caltech.edu>
References: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
	<47053E06.506@elvenkind.com>
	<Pine.LNX.4.64.0710041457100.27782@hmx.galcit.caltech.edu>
Message-ID: <470600F3.6080403@elvenkind.com>



James Quirk wrote:
> On a related note, I noticed that is not possible to
> read or write the data field in a pdf_annot whatsit.
> For instance, I was trying to define an annotation using:
> 
> \directlua 0 {
>    local t  = node.new('whatsit',15)
>    t.width  = mywidth
>    t.height = myheight   
>    t.depth  = mydepth
>    t.objnum = myobjnum
>    t.data   = mydata
>    tex.setbox(0,t)
> }
> \box0

patch is in trunk


From root at aanhet.net  Fri Oct  5 12:25:05 2007
From: root at aanhet.net (Cron Daemon)
Date: Fri,  5 Oct 2007 12:25:05 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071005102505.981E728000EB@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/luatex.web
 U  luatex/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/luatoken.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/ltexiolib.c
 U  luatex/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U  luatex/trunk/src/texk/web2c/luatexdir/nodes.h
 Checked out revision 784.

From jjq at galcit.caltech.edu  Fri Oct  5 12:18:45 2007
From: jjq at galcit.caltech.edu (James Quirk)
Date: Fri, 5 Oct 2007 03:18:45 -0700 (PDT)
Subject: [Dev-luatex] possible bug: tokenlist_to_luastring
In-Reply-To: <470600D6.8020303@elvenkind.com>
References: <Pine.LNX.4.64.0710041118580.27782@hmx.galcit.caltech.edu>
	<470600D6.8020303@elvenkind.com>
Message-ID: <Pine.LNX.4.64.0710050318290.28423@hmx.galcit.caltech.edu>

On Fri, 5 Oct 2007, Taco Hoekwater wrote:

> 
> 
> James Quirk wrote:
> > Hi,
> > 
> > 
> > I get the output:
> > 
> > \BAD.1 0 0 rgb
> 
> patch is in trunk
> 
Thanks.

James

From Jonathan.Sauer at silverstroke.com  Fri Oct  5 16:07:49 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Fri, 5 Oct 2007 16:07:49 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
References: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>	<47021000.3050208@elvenkind.com><9343542E664B894484613D106D7D3F5F84AAD2@s-yellow.net.silverstroke.de>
	<470600A1.2030808@elvenkind.com>
Message-ID: <9343542E664B894484613D106D7D3F5F84AAD3@s-yellow.net.silverstroke.de>

Hello,

> >>> discrepancy? (other than "temporary implementation", of course ;-)
> >> Not really. I will make the texio functions accept multiple strings

> >> as well.
> > 
> > Great! Thank you!
> 
> Patch is in trunk

Thanks!

A question: How stable is trunk currently?


Jonathan


From taco at elvenkind.com  Fri Oct  5 16:12:59 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 05 Oct 2007 16:12:59 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AAD3@s-yellow.net.silverstroke.de>
References: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>	<47021000.3050208@elvenkind.com><9343542E664B894484613D106D7D3F5F84AAD2@s-yellow.net.silverstroke.de>	<470600A1.2030808@elvenkind.com>
	<9343542E664B894484613D106D7D3F5F84AAD3@s-yellow.net.silverstroke.de>
Message-ID: <4706466B.9030508@elvenkind.com>



Jonathan Sauer wrote:
> Hello,
> 
>>>>> discrepancy? (other than "temporary implementation", of course ;-)
>>>> Not really. I will make the texio functions accept multiple strings
> 
>>>> as well.
>>> Great! Thank you!
>> Patch is in trunk
> 
> Thanks!
> 
> A question: How stable is trunk currently?

It is pretty stable right now (hyphenation works once again), but
you should not use it if you like having kerning and ligatures,
because neither are present :-)

Best wishes,
Taco








From Jonathan.Sauer at silverstroke.com  Fri Oct  5 16:21:35 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Fri, 5 Oct 2007 16:21:35 +0200
Subject: [Dev-luatex] tex.print vs. texio.write
References: <9343542E664B894484613D106D7D3F5F84AAD1@s-yellow.net.silverstroke.de>	<47021000.3050208@elvenkind.com><9343542E664B894484613D106D7D3F5F84AAD2@s-yellow.net.silverstroke.de>	<470600A1.2030808@elvenkind.com>
	<9343542E664B894484613D106D7D3F5F84AAD3@s-yellow.net.silverstroke.de>
	<4706466B.9030508@elvenkind.com>
Message-ID: <9343542E664B894484613D106D7D3F5F84AAD4@s-yellow.net.silverstroke.de>

Hello,

> > A question: How stable is trunk currently?
> 
> It is pretty stable right now (hyphenation works once again), 
> but you should not use it if you like having kerning and 
> ligatures, because neither are present :-)

So we should call it LuaWord now? ;-)


> Best wishes,
> Taco

Jonathan


From weg at indiscrete.org  Fri Oct  5 17:29:34 2007
From: weg at indiscrete.org (Eythan Weg)
Date: Fri, 05 Oct 2007 11:29:34 -0400
Subject: [Dev-luatex] a problem with ~=
Message-ID: <87hcl5a8bl.fsf@indiscrete.org>


Hi ,

\directlua 0{
if ("ab" ~= "cb") then do texio.write_nl("not equal") end end 
}
\bye

results in
        ! LuaTeX error [string "luas[0]"]:1: ')' expected near '\'.

This is with yesterday's svn.  

eythan 


From taco at elvenkind.com  Fri Oct  5 17:37:06 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 05 Oct 2007 17:37:06 +0200
Subject: [Dev-luatex] a problem with ~=
In-Reply-To: <87hcl5a8bl.fsf@indiscrete.org>
References: <87hcl5a8bl.fsf@indiscrete.org>
Message-ID: <47065A22.2000802@elvenkind.com>



Eythan Weg wrote:
> Hi ,
> 
> \directlua 0{
> if ("ab" ~= "cb") then do texio.write_nl("not equal") end end 
> }
> \bye
> 
> results in
>         ! LuaTeX error [string "luas[0]"]:1: ')' expected near '\'.
> 
> This is with yesterday's svn.  

try \string~ (~ is an active character, probably)



From pragma at wxs.nl  Fri Oct  5 18:20:19 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 05 Oct 2007 18:20:19 +0200
Subject: [Dev-luatex] a problem with ~=
In-Reply-To: <87hcl5a8bl.fsf@indiscrete.org>
References: <87hcl5a8bl.fsf@indiscrete.org>
Message-ID: <47066443.7040607@wxs.nl>

Eythan Weg wrote:
> Hi ,
> 
> \directlua 0{
> if ("ab" ~= "cb") then do texio.write_nl("not equal") end end 
> }
> \bye
> 
> results in
>         ! LuaTeX error [string "luas[0]"]:1: ')' expected near '\'.
> 
> This is with yesterday's svn.  

well, it fails with any version, given that you have ~ defines as active 
char that expands to something

\directlua 0 {
     if "ab" \string ~= "cb" then
         texio.write_nl("not equal")
     end
}

probably works ok at your end

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From weg at indiscrete.org  Fri Oct  5 19:12:02 2007
From: weg at indiscrete.org (Eythan Weg)
Date: Fri, 05 Oct 2007 13:12:02 -0400
Subject: [Dev-luatex] a problem with ~=
In-Reply-To: <47066443.7040607@wxs.nl> (Hans Hagen's message of "Fri, 05 Oct
	2007 18:20:19 +0200")
References: <87hcl5a8bl.fsf@indiscrete.org> <47066443.7040607@wxs.nl>
Message-ID: <87d4vta3kt.fsf@indiscrete.org>


Hans Hagen <pragma at wxs.nl>
Fri, 05 Oct 2007 18:20:19 +0200

   Eythan Weg wrote:
   > Hi ,
   > 
   > \directlua 0{
   > if ("ab" ~= "cb") then do texio.write_nl("not equal") end end 
   > }
   > \bye
   > 
   > results in
   >         ! LuaTeX error [string "luas[0]"]:1: ')' expected near '\'.
   > 
   > This is with yesterday's svn.  
   
   well, it fails with any version, given that you have ~ defines as active 
   char that expands to something
   
   \directlua 0 {
        if "ab" \string ~= "cb" then
            texio.write_nl("not equal")
        end
   }
   
   probably works ok at your end
   
   Hans

Yes, thanks. 

eythan 

From root at aanhet.net  Fri Oct  5 22:25:43 2007
From: root at aanhet.net (Cron Daemon)
Date: Fri,  5 Oct 2007 22:25:43 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@server> /home/luatex/luatex-svn
Message-ID: <20071005202543.C720428001F2@server.aanhet.net>

U  luatex/trunk/src/texk/web2c/luatexdir/luatex.web
 U  luatex/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 Checked out revision 786.

From root at www.bittext.nl  Mon Oct  8 16:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon,  8 Oct 2007 16:22:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071008142238.016911E8C2B2@www.bittext.nl>

U    svn/trunk/src/libs/zziplib/zzip/Makefile
 U    svn/trunk/src/texk/web2c/luatexdir/hyphen.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 Checked out revision 788.

From root at www.bittext.nl  Mon Oct  8 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon,  8 Oct 2007 22:22:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071008202238.20EEC1E8C2B2@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lcallbacklib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.h
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 789.

From Jonathan.Sauer at silverstroke.com  Tue Oct  9 09:04:45 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Tue, 9 Oct 2007 09:04:45 +0200
Subject: [Dev-luatex] a problem with ~=
References: <87hcl5a8bl.fsf@indiscrete.org>
Message-ID: <9343542E664B894484613D106D7D3F5F84AAD5@s-yellow.net.silverstroke.de>

Hello,

> \directlua 0{
> if ("ab" ~= "cb") then do texio.write_nl("not equal") end end } \bye
> 
> results in
>         ! LuaTeX error [string "luas[0]"]:1: ')' expected near '\'.
> 
> This is with yesterday's svn.  

Try \directlua 0{\unexpanded{...}} \bye. \directlua expands its
arguments completely, thus also expands the ~, which is active in
at least PlainTeX, LaTeX and Context.

@Taco: Perhaps a note in the manual about expansion in \directlua (and
most likely \latelua) would be useful.

> eythan 

Jonathan


From taco at elvenkind.com  Tue Oct  9 09:54:54 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 09 Oct 2007 09:54:54 +0200
Subject: [Dev-luatex] a problem with ~=
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AAD5@s-yellow.net.silverstroke.de>
References: <87hcl5a8bl.fsf@indiscrete.org>
	<9343542E664B894484613D106D7D3F5F84AAD5@s-yellow.net.silverstroke.de>
Message-ID: <470B33CE.7030506@elvenkind.com>



Jonathan Sauer wrote:
> 
> @Taco: Perhaps a note in the manual about expansion in \directlua (and
> most likely \latelua) would be useful.

I've made the description a little more verbose.


From taco at elvenkind.com  Wed Oct 10 08:29:00 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 10 Oct 2007 08:29:00 +0200
Subject: [Dev-luatex] [Fwd: [Fontforge-devel] ORA pro nobis]
Message-ID: <470C712C.3060709@elvenkind.com>


I assume some of you may be interested in this book as well.

Best wishes, Taco

-------- Original Message --------
Subject: [Fontforge-devel] ORA pro nobis
Date: 09 Oct 2007 12:57:06 -0700
From: George Williams <gww at silcom.com>
Organization: FontForge
To: fontforge-devel at lists.sourceforge.net
CC: fontforge-users at lists.sourceforge.net

O'Reilly & Associates has finally shipped the English translation of
Yannis Haralambous's
     Fonts & Encodings

It has a large section of FontForge, though I fear it may be a bit out
of date by now.


-------------------------------------------------------------------------
This SF.net email is sponsored by: Splunk Inc.
Still grepping through log files to find problems?  Stop.
Now Search log events and configuration files using AJAX and a browser.
Download your FREE copy of Splunk now >> http://get.splunk.com/
_______________________________________________
Fontforge-devel mailing list
Fontforge-devel at lists.sourceforge.net
https://lists.sourceforge.net/lists/listinfo/fontforge-devel

From lists at texytipografia.com  Thu Oct 11 10:36:12 2007
From: lists at texytipografia.com (Javier Bezos)
Date: Thu, 11 Oct 2007 10:36:12 +0200
Subject: [Dev-luatex] [Fwd: [Fontforge-devel] ORA pro nobis]
References: <470C712C.3060709@elvenkind.com>
Message-ID: <00be01c80be1$cb90c9f0$8001a8c0@PROPIETAFMI1K9>

> O'Reilly & Associates has finally shipped the English translation of
> Yannis Haralambous's
>     Fonts & Encodings

At last! I ordered a year ago! Is it a direct translation from
French or has it been updated? 

Cheers
Javier

From arthur.reutenauer at normalesup.org  Thu Oct 11 20:26:53 2007
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Thu, 11 Oct 2007 20:26:53 +0200
Subject: [Dev-luatex] [Fwd: [Fontforge-devel] ORA pro nobis]
In-Reply-To: <00be01c80be1$cb90c9f0$8001a8c0@PROPIETAFMI1K9>
References: <470C712C.3060709@elvenkind.com>
	<00be01c80be1$cb90c9f0$8001a8c0@PROPIETAFMI1K9>
Message-ID: <20071011182653.GB20139@phare.normalesup.org>

> At last! I ordered a year ago! Is it a direct translation from
> French or has it been updated? 

  Not really; only factual errors have been corrected.

	Arthur

From taco at elvenkind.com  Fri Oct 12 18:54:34 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 12 Oct 2007 18:54:34 +0200
Subject: [Dev-luatex] state of development
Message-ID: <470FA6CA.3070109@elvenkind.com>

Hi all,

I have just committed last week's work to the repository. The code is
not yet stable, but this makes sure the data is safe from harm, and
it allows me to look at it during the weekend.

I'll write down the details when the next beta comes out (hopefully
sometime next week) but so you know why it takes so long: the next
beta will finally split apart all of the intermingled stuff relating
to hyphenation and ligature/kern processing.

Best wishes,
Taco



From root at www.bittext.nl  Fri Oct 12 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri, 12 Oct 2007 22:22:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071012202238.65FC01E8C2B3@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lcallbacklib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 Checked out revision 793.

From Jonathan.Sauer at silverstroke.com  Wed Oct 17 10:05:03 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Wed, 17 Oct 2007 10:05:03 +0200
Subject: [Dev-luatex] # or ##, that is the question
Message-ID: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>

Hello,

(This is not strictly LuaTeX-related, though LuaTeX exhibits the same
behaviour. But the LuaTeX ML is the only TeX-related forum I currently
have access to. And maybe this is something to fix in LuaTeX ;-)

While writing unit tests for some of my macros, I stumbled on the 
following weird behaviour when expanding \toks registers inside \edef 
using \the (PlainTeX):

---------------------------------- CUT -------------------------------

\catcode`\@=11
\def\log#1{\immediate\write\sixt@@n{#1}}


\toks@{|##|}

% Obvious result: Doubled
\edef\foo{\the\toks@}

\log{1: \meaning\foo}


% Obvious as well: Doubled
\edef\foo{\the\toks@\the\toks@}

\log{2: \meaning\foo}


% Now this is weird: First doubled, then not
\edef\foo{\the\expandafter\toks@\the\toks@}

\log{3: \meaning\foo}


\bye

---------------------------------- CUT -------------------------------

This produces the following output:

---------------------------------- CUT -------------------------------

TeX:

$ tex ToksSharpTest.tex 
This is TeX, Version 3.141592 (Web2C 7.5.5)
(./ToksSharpTest.tex
1: macro:->|####|
2: macro:->|####||####|
3: macro:->|####||##|
 )
No pages of output.
Transcript written on ToksSharpTest.log.


pdfTeX:

$ pdftex ToksSharpTest.tex 
This is pdfTeX, Version 3.141592-1.40.3 (Web2C 7.5.6)
entering extended mode
(./ToksSharpTest.tex
1: macro:->|####|
2: macro:->|####||####|
3: macro:->|####||##|
 )
No pages of output.
Transcript written on ToksSharpTest.log.


LuaTeX:

$ luatex ToksSharpTest.tex 
This is luaTeX, Version 3.141592-beta-0.11.2-2007091918 (Web2C 7.5.6)
(ToksSharpTest.tex
1: macro:->|####|
2: macro:->|####||####|
3: macro:->|####||##|
 )
No pages of output.
Transcript written on ToksSharpTest.log.

---------------------------------- CUT -------------------------------

So when jumping out of the first expansion of the \toks register and
into the second expansion, TeX seems to forget that it is inside an 
\edef and thus does not double the ##.

I do not know what to make of this. I could not find any place in the
TeXbook where it is stated that # is doubled when expanding a \toks
register inside \edef, so this might not be a bug, but simply some 
weird undocumented phenomenon.

And it might be useful too, to build up the body of a complicated macro
inside a \toks register before finally creating the macro using \edef:

% Empty dummy register
\toksA{}

% Macro body (not really complicated)
\toksB{[#1] [#2]}

% Define the macro
\edef\macro#1#2{\the\expandafter\toksA\the\toksB}


\meaning\macro would then be: macro:#1#2->[#1] [#2]


What do you think?


Jonathan


From pragma at wxs.nl  Wed Oct 17 10:43:32 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 17 Oct 2007 10:43:32 +0200
Subject: [Dev-luatex] # or ##, that is the question
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>
References: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>
Message-ID: <4715CB34.1020100@wxs.nl>

Jonathan Sauer wrote:
> Hello,
> 
> (This is not strictly LuaTeX-related, though LuaTeX exhibits the same
> behaviour. But the LuaTeX ML is the only TeX-related forum I currently
> have access to. And maybe this is something to fix in LuaTeX ;-)
> 
> While writing unit tests for some of my macros, I stumbled on the 
> following weird behaviour when expanding \toks registers inside \edef 
> using \the (PlainTeX):

weird indeed, it is some lookahead interference, if you put a relax in 
between (6x), or do a one level expansion (9x) ....

\starttext

\newtoks\mytoks
\def\log{\immediate\write16}
\let\ea\expandafter

\toks 0{[##]}
\mytoks{[##]}

\edef\foo{\the\toks0}                          \log{1a: \meaning\foo}
\edef\foo{\the\toks0\the\toks0}                \log{2a: \meaning\foo}
\edef\foo{\the\toks0 \the\toks0}               \log{3a: \meaning\foo}
\edef\foo{\the\toks0 \the\toks0}               \log{3a: \meaning\foo}
\edef\foo{\the\ea\toks\ea0\the\toks0}          \log{4a: \meaning\foo}
\edef\foo{\the\ea\toks\ea0\ea\space\the\toks0} \log{5a: \meaning\foo}

\edef\foo{\the\mytoks}                         \log{1b: \meaning\foo}
\edef\foo{\the\mytoks\the\mytoks}              \log{3b: \meaning\foo}
\edef\foo{\the\ea\mytoks\the\mytoks}           \log{4b: \meaning\foo}

\edef\foo{\the\mytoks\relax\the\mytoks}        \log{6x: \meaning\foo}
\edef\foo{\the\mytoks[##]}                     \log{7x: \meaning\foo}
\edef\foo{[##][##]}                            \log{8x: \meaning\foo}
\ea\edef\ea\foo\ea{\the\mytoks\the\mytoks}     \log{9x: \meaning\foo}

\stoptext

this # duplication has always been kind of messy (changing catcodes also 
can have unexpected results because the # is kind of hardcoded in some 
places) and changing this behaviour may break existing code that happens 
to work (i have some places where trial and error and tracing finally 
gave me some idea to handle it in certain cases)

(i can imagine a future version of luatex to support an alternative 
mechanism for arguments, but that will be a few years away)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From dak at gnu.org  Wed Oct 17 13:56:12 2007
From: dak at gnu.org (David Kastrup)
Date: Wed, 17 Oct 2007 13:56:12 +0200
Subject: [Dev-luatex] # or ##, that is the question
In-Reply-To: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>
	(Jonathan Sauer's message of "Wed\, 17 Oct 2007 10\:05\:03 +0200")
References: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>
Message-ID: <86bqayhs4j.fsf@lola.quinscape.zz>

"Jonathan Sauer" <Jonathan.Sauer at silverstroke.com> writes:

> While writing unit tests for some of my macros, I stumbled on the
> following weird behaviour when expanding \toks registers inside
> \edef using \the (PlainTeX):

There is nothing strange here.

> \catcode`\@=11
> \def\log#1{\immediate\write\sixt@@n{#1}}
>
>
> \toks@{|##|}
>
> % Obvious result: Doubled
> \edef\foo{\the\toks@}
>
> \log{1: \meaning\foo}
>
>
> % Obvious as well: Doubled
> \edef\foo{\the\toks@\the\toks@}
>
> \log{2: \meaning\foo}
>
>
> % Now this is weird: First doubled, then not
> \edef\foo{\the\expandafter\toks@\the\toks@}

\the\toks@ passes # unmolested into \edef.  In every other case (apart
from the equivalent use of \unexpanded), a doubled ## is required for
producing a single # in the result, because then # is a parameter
delimiting token for the \edef.  The \expandafter takes the ## out of
the token register and into the regular input stream, so the
#-preserving character of \the inside of \edef is no longer in action.

> So when jumping out of the first expansion of the \toks register and
> into the second expansion, TeX seems to forget that it is inside an
> \edef and thus does not double the ##.

TeX _never_ doubles the # in \edef: you are confusing this with a
printing artifact.

> I do not know what to make of this. I could not find any place in
> the TeXbook where it is stated that # is doubled when expanding a
> \toks register inside \edef, so this might not be a bug, but simply
> some weird undocumented phenomenon.

It is not doubled, but simply left uninterpreted.

> And it might be useful too, to build up the body of a complicated
> macro inside a \toks register before finally creating the macro
> using \edef:
>
> What do you think?

You are about 20 years late.  Please check LaTeX's definition (and
usage) of \g at addto@macro:

\long\def\g at addto@macro#1#2{%
  \begingroup
    \toks@\expandafter{#1#2}%
    \xdef#1{\the\toks@}%
  \endgroup}
\def\AtEndOfPackage{%
  \expandafter\g at addto@macro\csname\@currname.\@currext-h@@k\endcsname}
\let\AtEndOfClass\AtEndOfPackage
\@onlypreamble\AtEndOfPackage
\@onlypreamble\AtEndOfClass
\def\AtBeginDocument{\g at addto@macro\@begindocumenthook}
\def\AtEndDocument{\g at addto@macro\@enddocumenthook}


-- 
David Kastrup

From Jonathan.Sauer at silverstroke.com  Wed Oct 17 14:56:13 2007
From: Jonathan.Sauer at silverstroke.com (Jonathan Sauer)
Date: Wed, 17 Oct 2007 14:56:13 +0200
Subject: [Dev-luatex] # or ##, that is the question
References: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>
	<86bqayhs4j.fsf@lola.quinscape.zz>
Message-ID: <9343542E664B894484613D106D7D3F5F84ACF2@s-yellow.net.silverstroke.de>

Hello,

> [...]
> > % Now this is weird: First doubled, then not
> > \edef\foo{\the\expandafter\toks@\the\toks@}
> 
> \the\toks@ passes # unmolested into \edef.  In every other case (apart
> from the equivalent use of \unexpanded), a doubled ## is required for
> producing a single # in the result, because then # is a parameter
> delimiting token for the \edef.  The \expandafter takes the ## out of
> the token register and into the regular input stream, so the
> #-preserving character of \the inside of \edef is no longer in action.

You are of course right. And I am a little bit wiser.

> [...]
> > And it might be useful too, to build up the body of a complicated
> > macro inside a \toks register before finally creating the macro
> > using \edef:
> >
> > What do you think?
> 
> You are about 20 years late.  Please check LaTeX's definition (and
> usage) of \g at addto@macro:
> [...]

Well, my example was to show how to use above behaviour to create the
body of a macro *with parameters* in a \toks register. \g at addto@macro
does not do this.


> David Kastrup

Jonathan


From dak at gnu.org  Wed Oct 17 15:15:21 2007
From: dak at gnu.org (David Kastrup)
Date: Wed, 17 Oct 2007 15:15:21 +0200
Subject: [Dev-luatex] # or ##, that is the question
In-Reply-To: <9343542E664B894484613D106D7D3F5F84ACF2@s-yellow.net.silverstroke.de>
	(Jonathan Sauer's message of "Wed\, 17 Oct 2007 14\:56\:13 +0200")
References: <9343542E664B894484613D106D7D3F5F84AADE@s-yellow.net.silverstroke.de>
	<86bqayhs4j.fsf@lola.quinscape.zz>
	<9343542E664B894484613D106D7D3F5F84ACF2@s-yellow.net.silverstroke.de>
Message-ID: <864pgpj312.fsf@lola.quinscape.zz>

"Jonathan Sauer" <Jonathan.Sauer at silverstroke.com> writes:

>> [...]
>> > % Now this is weird: First doubled, then not
>> > \edef\foo{\the\expandafter\toks@\the\toks@}
>> 
>> \the\toks@ passes # unmolested into \edef.  In every other case (apart
>> from the equivalent use of \unexpanded), a doubled ## is required for
>> producing a single # in the result, because then # is a parameter
>> delimiting token for the \edef.  The \expandafter takes the ## out of
>> the token register and into the regular input stream, so the
>> #-preserving character of \the inside of \edef is no longer in action.
>
> You are of course right. And I am a little bit wiser.
>
>> [...]
>> > And it might be useful too, to build up the body of a complicated
>> > macro inside a \toks register before finally creating the macro
>> > using \edef:
>> >
>> > What do you think?
>> 
>> You are about 20 years late.  Please check LaTeX's definition (and
>> usage) of \g at addto@macro:
>> [...]
>
> Well, my example was to show how to use above behaviour to create the
> body of a macro *with parameters* in a \toks register. \g at addto@macro
> does not do this.

But it can be used for it.  Which is the reason it is implemented
using a token register (according to the change note in ltclass.dtx,
this has been done in 1994, probably due to a somewhat pressing
suggestion of mine, so I have to take back the "20 years").

-- 
David Kastrup

From root at www.bittext.nl  Fri Oct 19 22:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri, 19 Oct 2007 22:22:05 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071019202239.158D61E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/Makefile.in
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lfontlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatexlib.mk
 A    svn/trunk/src/texk/web2c/luatexdir/tex
 A    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 U    svn/trunk/manual/luatexref-t.tex
 Checked out revision 794.

From root at www.bittext.nl  Mon Oct 22 16:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon, 22 Oct 2007 16:22:05 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071022142239.339221E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/utils.c
 U    svn/trunk/src/texk/web2c/luatexdir/image/writeimg.c
 U    svn/trunk/src/texk/web2c/luatexdir/image/writejbig2.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lstatslib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luatex.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltexlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luainit.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lkpselib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lpdflib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/ltokenlib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luastuff.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.h
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex-api.h
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/tt_table.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writet1.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writet3.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/vfpacket.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writettf.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writecff.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/sfnt.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/writecff.h
 U    svn/trunk/src/texk/web2c/luatexdir/font/writefont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/vfovf.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/tounicode.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/dofont.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/texfont.h
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 U    svn/trunk/src/texk/web2c/lib/texmfmp.c
 Checked out revision 797.

From root at www.bittext.nl  Mon Oct 22 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon, 22 Oct 2007 22:22:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071022202238.081441E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/manual/luatexref-t.tex
 U    svn/trunk/manual/luatexref-t.pdf
 Checked out revision 799.

From taco at elvenkind.com  Fri Oct 26 18:02:04 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 26 Oct 2007 18:02:04 +0200
Subject: [Dev-luatex] friday news
Message-ID: <47220F7C.1010803@elvenkind.com>

Hi,

Sorry, I had hoped to do a snapshot today, but the code is not
really ready yet. There one big bug expecially that I want to
fix: halfway through typesetting the reference manual it starts
producing empty pages. Since the manual is supposed to explain
what is new, this is pretty serious. I now hope to tackle that
bug over the weekend, with a snapshot on monday.

Sorry for the continuous delays,
Taco

From dak at gnu.org  Fri Oct 26 18:20:11 2007
From: dak at gnu.org (David Kastrup)
Date: Fri, 26 Oct 2007 18:20:11 +0200
Subject: [Dev-luatex] friday news
In-Reply-To: <47220F7C.1010803@elvenkind.com> (Taco Hoekwater's message of
	"Fri\, 26 Oct 2007 18\:02\:04 +0200")
References: <47220F7C.1010803@elvenkind.com>
Message-ID: <86fxzxzw3o.fsf@lola.quinscape.zz>

Taco Hoekwater <taco at elvenkind.com> writes:

> Sorry, I had hoped to do a snapshot today, but the code is not
> really ready yet. There one big bug expecially that I want to
> fix: halfway through typesetting the reference manual it starts
> producing empty pages. Since the manual is supposed to explain
> what is new, this is pretty serious. I now hope to tackle that
> bug over the weekend, with a snapshot on monday.
>
> Sorry for the continuous delays,

As a sort of feedback: I see with growing amazement how LuaTeX is
increasingly being taken to pieces.  It does not look like stability
is around the corner anytime soon and things appear very much "under
construction".  I mean, the inner loop is gone, the "Omega becomes a
sign processor" talk we have been listening to for years more or less
is pounded into place with a few nonchalant commits, hyphenation is
replaced by a different data structure/algorithm...  The list goes on
and on.

I am not too happy about that.  On the other hand, the pieces LuaTeX
is being taken to are of the kind that one says "Yeah! Long time
due!".  I just hope you don't run out of steam before a nice point of
stability is reached again.

All the best,
David

-- 
David Kastrup

From root at www.bittext.nl  Fri Oct 26 22:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Fri, 26 Oct 2007 22:22:05 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071026202238.BC51F1E8C2B4@www.bittext.nl>

U    svn/trunk/build.sh.linux
 U    svn/trunk/src/texk/web2c/luatexdir/Makefile.in
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/lang/texlang.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lcallbacklib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/llanglib.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/luanode.c
 U    svn/trunk/src/texk/web2c/luatexdir/lua/lnodelib.c
 U    svn/trunk/src/texk/web2c/luatexdir/ptexlib.h
 U    svn/trunk/src/texk/web2c/luatexdir/nodes.h
 A    svn/trunk/src/texk/web2c/luatexdir/tex/postlinebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/src/texk/web2c/luatexdir/font/luafont.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.defines
 U    svn/trunk/src/texk/web2c/lib/texmfmp.c
 U    svn/trunk/src/texk/web2c/texmfmp.h
 U    svn/trunk/manual/luatexref-t.tex
 Checked out revision 801.

From pragma at wxs.nl  Fri Oct 26 23:24:14 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Fri, 26 Oct 2007 23:24:14 +0200
Subject: [Dev-luatex] friday news
In-Reply-To: <86fxzxzw3o.fsf@lola.quinscape.zz>
References: <47220F7C.1010803@elvenkind.com> <86fxzxzw3o.fsf@lola.quinscape.zz>
Message-ID: <47225AFE.7070306@wxs.nl>

David Kastrup wrote:

> I am not too happy about that.  On the other hand, the pieces LuaTeX
> is being taken to are of the kind that one says "Yeah! Long time
> due!".  I just hope you don't run out of steam before a nice point of
> stability is reached again.

most replacements are done piecewise and tested on real docs; of course 
we cannot forsee what bug show up, but i use luatex as a replacement for 
pdftex so that helps to uncover bugs

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From root at www.bittext.nl  Sat Oct 27 22:22:04 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Sat, 27 Oct 2007 22:22:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071027202238.24A101E8C2B4@www.bittext.nl>

U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 U    svn/trunk/src/texk/web2c/luatexdir/tex/linebreak.c
 U    svn/trunk/manual/luatexref-t.tex
 U    svn/trunk/manual/luatexref-t.pdf
 Checked out revision 804.

From taco at elvenkind.com  Sun Oct 28 10:24:05 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 28 Oct 2007 10:24:05 +0100
Subject: [Dev-luatex] friday news
In-Reply-To: <86fxzxzw3o.fsf@lola.quinscape.zz>
References: <47220F7C.1010803@elvenkind.com> <86fxzxzw3o.fsf@lola.quinscape.zz>
Message-ID: <47245535.20506@elvenkind.com>


Hi David,

A short reply to (hopefully) ease your mind a bit.

The comments in the repository have been minimalistic, but there
is nothing casual about the code itself. Over the past weeks, my
co-worker Nanning Buitenhuis and I have been working non-stop on
a massive change to the internals with two main goals:

* to switch from hyphenating glyphs to hyphenating characters
* to remove the language-related limits

We are not yet completely finished, but the invasive part of
that operation is now complete, and what is left to do is pretty
simple compared to what has been done already. The worst is
definately over.

There will be a snapshot tomorrow. The repository is already set up,
but I cannot generate the packages in the weekend. You could do a
checkout right now if you are eager, the tag is "snapshot-0.15".

There will be an official beta release to consolidate the changes to
the algorithms in a week or two (after Nanning and I have done some
cleanup and written the remaining bits of code).

After that, development in luatex will slow down for a while, as my
attention will shift to the mplib project for some a few months.
In this 'resting' period we (Nanning, mostly) will be writing a paper 
documenting the new behaviour in detail, and there will be plenty
of time to find the bugs.


Best wishes,
Taco


From C.A.Rowley at open.ac.uk  Sun Oct 28 12:45:47 2007
From: C.A.Rowley at open.ac.uk (Chris Rowley)
Date: Sun, 28 Oct 2007 11:45:47 +0000
Subject: [Dev-luatex] dev-luatex Digest, Vol 21, Issue 18
In-Reply-To: <mailman.5.1193569208.27477.dev-luatex@ntg.nl>
References: <mailman.5.1193569208.27477.dev-luatex@ntg.nl>
Message-ID: <18212.30315.419180.645830@fell.open.ac.uk>

Wow!

> * to switch from hyphenating glyphs to hyphenating characters

That's the best news I have heard in many a long decade!

I would be very interseted in reading the documentation for such
innovations (or even to help writing it ... oops, what am I saying???).

> * to remove the language-related limits

Examples?

Thanks


chris


From taco at elvenkind.com  Sun Oct 28 13:34:56 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 28 Oct 2007 13:34:56 +0100
Subject: [Dev-luatex] dev-luatex Digest, Vol 21, Issue 18
In-Reply-To: <18212.30315.419180.645830@fell.open.ac.uk>
References: <mailman.5.1193569208.27477.dev-luatex@ntg.nl>
	<18212.30315.419180.645830@fell.open.ac.uk>
Message-ID: <472481F0.6020008@elvenkind.com>

Chris Rowley wrote:
> Wow!
> 
>> * to switch from hyphenating glyphs to hyphenating characters
> 
> That's the best news I have heard in many a long decade!
> 
> I would be very interseted in reading the documentation for such
> innovations (or even to help writing it ... oops, what am I saying???).

There is a preliminary chapter in the manual already (just wait until
tomorrow).

>> * to remove the language-related limits
> 
> Examples?

For example:

* TeX's words are 64 characters maximum
* The pattern and hyphenation memory sizes are fixed
* hyphenation exceptions don't scale
   (i.e. you can't create a language solely by means of \hyphenation)
* \patterns are illegal in non-initex runs
* you can't add new patterns to any language after any hyphenation
   attempt has taken place (in any other language at all)
* \uchyph is a paragraph-scoped property, not word-based


Best wishes,
Taco

From pragma at wxs.nl  Sun Oct 28 19:25:02 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 28 Oct 2007 19:25:02 +0100
Subject: [Dev-luatex] dev-luatex Digest, Vol 21, Issue 18
In-Reply-To: <472481F0.6020008@elvenkind.com>
References: <mailman.5.1193569208.27477.dev-luatex@ntg.nl>	<18212.30315.419180.645830@fell.open.ac.uk>
	<472481F0.6020008@elvenkind.com>
Message-ID: <4724D3FE.10107@wxs.nl>

Taco Hoekwater wrote:

>>> * to remove the language-related limits
>> Examples?
> 
> For example:
> 
> * TeX's words are 64 characters maximum
> * The pattern and hyphenation memory sizes are fixed
> * hyphenation exceptions don't scale
>    (i.e. you can't create a language solely by means of \hyphenation)
> * \patterns are illegal in non-initex runs
> * you can't add new patterns to any language after any hyphenation
>    attempt has taken place (in any other language at all)
> * \uchyph is a paragraph-scoped property, not word-based

* language is now a glyphnode property

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Mon Oct 29 10:53:02 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 29 Oct 2007 10:53:02 +0100
Subject: [Dev-luatex] snapshot  2007-10-29 released
Message-ID: <4725AD7E.4030608@elvenkind.com>

Hi,

As I promised yesterday, snapshot 2007-10-29 is now released.
Note that this is a snapshot only, not a proper beta. There
are some known problems, even though the test documents now
seem to run properly.

News compared to the last beta (0.11.2):

* Completely overhauled hyphenation and ligkern application.

   There is a new chapter in the manual to document all the
   changes to the hyphenation and line breaking algorithms,
   it is simply too much to list here.

* the interface of the pre_linebreak_filter,hpack_filter,
   vpack_filter, and pre_output_filter has changed slightly.

* lpeg is now at version 0.7

* a whole series of exotic bugs and compiler warnings are
   fixed thanks to the watchful eye of Fabrice.

* texio.print now accepts multiple strings as arguments.

* The lua function os.sleep() is added


I have uploaded source and linux/windows 32 binaries to

     http://foundry.supelec.fr/projects/luatex/

Have fun,

Taco


From arthur.reutenauer at normalesup.org  Mon Oct 29 16:09:04 2007
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Mon, 29 Oct 2007 16:09:04 +0100
Subject: [Dev-luatex] snapshot  2007-10-29 released
In-Reply-To: <4725AD7E.4030608@elvenkind.com>
References: <4725AD7E.4030608@elvenkind.com>
Message-ID: <20071029150904.GA19056@phare.normalesup.org>

> I have uploaded source and linux/windows 32 binaries to
> 
>      http://foundry.supelec.fr/projects/luatex/

  You'll have to wait a bit for the Mac binaries; my power cord
literally melted down so I can charge my battery anymore -- apparently
that's not even exceptional ...
(http://store.apple.com/1-800-MY-APPLE/WebObjects/AppleStore.woa/wa/RSLID?mco=701C0CBE&fnode=home/shop_mac/mac_accessories/power&nplm=MA538LL/B)

	Arthur

From taco at elvenkind.com  Mon Oct 29 16:35:52 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 29 Oct 2007 16:35:52 +0100
Subject: [Dev-luatex] snapshot  2007-10-29 released
In-Reply-To: <20071029150904.GA19056@phare.normalesup.org>
References: <4725AD7E.4030608@elvenkind.com>
	<20071029150904.GA19056@phare.normalesup.org>
Message-ID: <4725FDD8.5040106@elvenkind.com>



Arthur Reutenauer wrote:
>> I have uploaded source and linux/windows 32 binaries to
>>
>>      http://foundry.supelec.fr/projects/luatex/
> 
>   You'll have to wait a bit for the Mac binaries; my power cord
> literally melted down so I can charge my battery anymore -- apparently
> that's not even exceptional ...
> (http://store.apple.com/1-800-MY-APPLE/WebObjects/AppleStore.woa/wa/RSLID?mco=701C0CBE&fnode=home/shop_mac/mac_accessories/power&nplm=MA538LL/B)

I am very sorry for you, but reading the forum I could not help but 
smile a little. It seems the cyberpunk era has finally arrived, with 
Apple firmly in the lead by shipping wetware-enabled notebooks ;-)

Good luck,
Taco

From preining at logic.at  Mon Oct 29 17:42:36 2007
From: preining at logic.at (Norbert Preining)
Date: Mon, 29 Oct 2007 17:42:36 +0100
Subject: [Dev-luatex] snapshot  2007-10-29 released
In-Reply-To: <20071029150904.GA19056@phare.normalesup.org>
References: <4725AD7E.4030608@elvenkind.com>
	<20071029150904.GA19056@phare.normalesup.org>
Message-ID: <20071029164236.GF23547@gamma.logic.tuwien.ac.at>

On Mo, 29 Okt 2007, Arthur Reutenauer wrote:
> literally melted down so I can charge my battery anymore -- apparently
> that's not even exceptional ...

Strange that noone has sued them in the US already for that...everywhere
the put up warning signs that eating bread is dangerous to your health
etc etc, but a burning power cord ... well, who here does NOT recharge
his laptop overnight???

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
COTTERSTOCK (n.)
A piece of wood used to stir paint and thereafter stored uselessly in
a shed in perpetuity.
			--- Douglas Adams, The Meaning of Liff

From root at www.bittext.nl  Mon Oct 29 22:22:05 2007
From: root at www.bittext.nl (Cron Daemon)
Date: Mon, 29 Oct 2007 22:22:05 +0100 (CET)
Subject: [Dev-luatex] Cron <luatex@www>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20071029212244.6195F1E8C2B4@www.bittext.nl>

U    svn/trunk/src/libs/lua51/Makefile
 A    svn/trunk/src/libs/lua51/lcoco.c
 U    svn/trunk/src/libs/lua51/lstate.h
 A    svn/trunk/src/libs/lua51/lcoco.h
 U    svn/trunk/src/libs/lua51/lbaselib.c
 U    svn/trunk/src/libs/lua51/lapi.c
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.ch
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.mk
 U    svn/trunk/src/texk/web2c/luatexdir/luatex.web
 Checked out revision 809.

From yuleopen at gmail.com  Wed Oct 31 10:57:42 2007
From: yuleopen at gmail.com (Sherry Zhang)
Date: Wed, 31 Oct 2007 17:57:42 +0800
Subject: [Dev-luatex] CWeb?
Message-ID: <68bfdc900710310257u1ff4b0f8wb0f2ea9f95d88f2@mail.gmail.com>

Hi, Taco

just a small question concerning the development road map.
I have just found cweb source code added in the latest snapshot.
does it mean the LuaTeX team want to rewrite TeX in cweb?
thx.

Best regards
Sherry Zhang

From preining at logic.at  Wed Oct 31 11:05:10 2007
From: preining at logic.at (Norbert Preining)
Date: Wed, 31 Oct 2007 11:05:10 +0100
Subject: [Dev-luatex] luatex and hyphenation patterns
Message-ID: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>

Hi all!

One user of Debian wanted to build a luatex based latex format (he
wanted to test some examples from the luatex.org documentation slides,
using the old \lua{...} code, anyway).

Unfortunaltely this will not work in any way because there are so many
hyphenation patterns using non-ascii and non-utf8 content. All those of
course break.

Is there any suggested way how to cope with this?

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
Far out in the uncharted backwaters of the unfashionable
end of the western spiral arm of the Galaxy lies a small
unregarded yellow sun.
                 --- Douglas Adams, The Hitchhikers Guide to the Galaxy

From pragma at wxs.nl  Wed Oct 31 11:08:26 2007
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 31 Oct 2007 11:08:26 +0100
Subject: [Dev-luatex] CWeb?
In-Reply-To: <68bfdc900710310257u1ff4b0f8wb0f2ea9f95d88f2@mail.gmail.com>
References: <68bfdc900710310257u1ff4b0f8wb0f2ea9f95d88f2@mail.gmail.com>
Message-ID: <4728541A.9000408@wxs.nl>

Sherry Zhang wrote:

> just a small question concerning the development road map.
> I have just found cweb source code added in the latest snapshot.
> does it mean the LuaTeX team want to rewrite TeX in cweb?
> thx.

Eventually (some years ahead, long term roadmap) everything will be 
written in C indeed.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Wed Oct 31 18:54:13 2007
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 31 Oct 2007 18:54:13 +0100
Subject: [Dev-luatex] luatex and hyphenation patterns
In-Reply-To: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>
References: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>
Message-ID: <4728C145.5020107@elvenkind.com>

Norbert Preining wrote:
> Hi all!
> 
> One user of Debian wanted to build a luatex based latex format (he
> wanted to test some examples from the luatex.org documentation slides,
> using the old \lua{...} code, anyway).
> 
> Unfortunaltely this will not work in any way because there are so many
> hyphenation patterns using non-ascii and non-utf8 content. All those of
> course break.
> 
> Is there any suggested way how to cope with this?

It should be possible to use the (UTF-8) pattern files from xelatex,
but I don't know how those are packaged.

Best wishes,
Taco

From arthur.reutenauer at normalesup.org  Wed Oct 31 19:09:38 2007
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Wed, 31 Oct 2007 19:09:38 +0100
Subject: [Dev-luatex] luatex and hyphenation patterns
In-Reply-To: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>
References: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>
Message-ID: <20071031180938.GC31407@phare.normalesup.org>

> Is there any suggested way how to cope with this?

  Depending on what he wants to do with LaTeX-luatex, he might:

  1. (The smartest) Use a solution like XeTeX's xu-hyphen package to
  wrap the pattern-loading routine into something that looks more like
  UTF-8 (I don't know how this is done exactly so I cannot be more
  precise).

  2. (Quick and dirty) De-activate the troublesome hyphen files by
  either using a custom language.dat, or creating empty files to
  override the standard ones.

  In TeX Live 2007 The files in questions should be

-rw-r--r-- 1 areutena promo8 0 sep 26 18:42 bghyphsi.tex
-rw-r--r-- 1 areutena promo8 0 sep 26 18:43 gahyph.tex
-rw-r--r-- 1 areutena promo8 0 sep 26 18:43 huhyphn.tex
-rw-r--r-- 1 areutena promo8 0 sep 26 18:44 ruhyphen.tex
-rw-r--r-- 1 areutena promo8 0 sep 26 18:44 srhyphc.tex
-rw-r--r-- 1 areutena promo8 0 sep 26 18:44 trhyph.tex
-rw-r--r-- 1 areutena promo8 0 sep 26 18:44 ukrhypmp.tex

  3. (Even faster) If he's only interested in testing LuaTeX features,
  use plain LuaTeX.

	Arthur

From mojca.miklavec.lists at gmail.com  Wed Oct 31 19:39:09 2007
From: mojca.miklavec.lists at gmail.com (Mojca Miklavec)
Date: Wed, 31 Oct 2007 19:39:09 +0100
Subject: [Dev-luatex] luatex and hyphenation patterns
In-Reply-To: <4728C145.5020107@elvenkind.com>
References: <20071031100510.GI24231@gamma.logic.tuwien.ac.at>
	<4728C145.5020107@elvenkind.com>
Message-ID: <6faad9f00710311139j39476bafvb064b5a9c069b978@mail.gmail.com>

On 10/31/07, Taco Hoekwater wrote:
> Norbert Preining wrote:
> > Hi all!
> >
> > One user of Debian wanted to build a luatex based latex format (he
> > wanted to test some examples from the luatex.org documentation slides,
> > using the old \lua{...} code, anyway).
> >
> > Unfortunaltely this will not work in any way because there are so many
> > hyphenation patterns using non-ascii and non-utf8 content. All those of
> > course break.
> >
> > Is there any suggested way how to cope with this?
>
> It should be possible to use the (UTF-8) pattern files from xelatex,
> but I don't know how those are packaged.

XeTeX uses a kind-of-quick-and-dirty-hack, but it should work for LuaTeX.

Take a look into xu-XXhyph.tex (where XX denotes the language), where
you can find the following lines:

\expandafter\ifx\csname XeTeXrevision\endcsname\relax
\else

It now recognises XeTeX, but you can modify it to recognise LuaTeX as well.

On the other hand, stary by removing (commenting) languages from
language.dat, so that there will be far less files to modify for the
start.

Mojca

