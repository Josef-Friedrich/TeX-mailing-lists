From root at www.metatex.org  Wed Jul  1 12:28:55 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  1 Jul 2009 12:28:55 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090701102855.194C1788001@www.metatex.org>

------------------------------------------------------------------------
r2708 | oneiros | 2009-06-30 23:38:31 +0200 (Tue, 30 Jun 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

export string_to_toks

------------------------------------------------------------------------
r2709 | taco | 2009-07-01 09:03:48 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

move the rest of section 24 to textoken.c

------------------------------------------------------------------------
r2710 | taco | 2009-07-01 11:06:47 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c

fix a crash on failed terminal initialization

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul  1 16:27:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  1 Jul 2009 16:27:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090701142727.E6F16788001@www.metatex.org>

------------------------------------------------------------------------
r2711 | taco | 2009-07-01 12:53:34 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/expand.c
   A /trunk/source/texk/web2c/luatexdir/tex/expand.h

introduced expand.[ch] to hold section 25

------------------------------------------------------------------------
r2712 | taco | 2009-07-01 14:09:02 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luatexfont.h
   M /trunk/source/texk/web2c/luatexdir/font/writecff.c
   M /trunk/source/texk/web2c/luatexdir/font/writecff.h
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.h
   M /trunk/source/texk/web2c/luatexdir/font/writetype0.c
   M /trunk/source/texk/web2c/luatexdir/font/writetype2.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

put some more variables in the structure

------------------------------------------------------------------------
r2713 | taco | 2009-07-01 14:42:50 +0200 (Wed, 01 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

create an pdf_object_list type, convert pdf_font_list to that, and put in 
the pdf structure

------------------------------------------------------------------------
r2714 | taco | 2009-07-01 14:43:44 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c

drop the obsolete \pdfmovechar primitive

------------------------------------------------------------------------
r2715 | taco | 2009-07-01 15:25:11 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

it is important to also reset pdf->font_list

------------------------------------------------------------------------
r2716 | taco | 2009-07-01 15:26:19 +0200 (Wed, 01 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfglyph.c

move some functions and code away from pdfgen,c to pdffont.c, pdfglyph.c,
and fix the handling of multiple fonts per page

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul  1 22:27:31 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  1 Jul 2009 22:27:31 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090701202731.AFC59788001@www.metatex.org>

------------------------------------------------------------------------
r2717 | taco | 2009-07-01 16:31:22 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/epdf.h
   M /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.cc

fix a prototype (also fixes a bug) and remove the now unneeded prototypes

------------------------------------------------------------------------
r2718 | taco | 2009-07-01 17:33:44 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf

with fixed pdf info

------------------------------------------------------------------------
r2719 | taco | 2009-07-01 17:34:16 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

get rid of the \directlua/\latelua number warning

------------------------------------------------------------------------
r2720 | oneiros | 2009-07-01 17:56:03 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/errors.c
   M /trunk/source/texk/web2c/luatexdir/tex/errors.h
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/expand.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.c
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

indent

------------------------------------------------------------------------
r2721 | oneiros | 2009-07-01 17:57:11 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.cc

indent

------------------------------------------------------------------------
r2722 | oneiros | 2009-07-01 17:57:59 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfovf.c
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/font/writecff.c
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.c

indent

------------------------------------------------------------------------
r2723 | hhenkel | 2009-07-01 22:13:42 +0200 (Wed, 01 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfglyph.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfrule.c

change print_pdffloat() interface

------------------------------------------------------------------------

From root at www.metatex.org  Thu Jul  2 12:29:12 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  2 Jul 2009 12:29:12 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090702102912.9DB1E788001@www.metatex.org>

------------------------------------------------------------------------
r2724 | taco | 2009-07-01 22:51:01 +0200 (Wed, 01 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   A /trunk/source/texk/web2c/luatexdir/tex/conditional.h

It is not possible to do expansion without conditionals,
so here is the infrastructure for C versions of those

------------------------------------------------------------------------

From khaledhosny at eglug.org  Thu Jul  2 21:55:00 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 2 Jul 2009 22:55:00 +0300
Subject: [Dev-luatex] \pdfannot in TRT direction
Message-ID: <20090702195500.GA4428@khaled-laptop>

PDF annotations are not placed correctly in TRT directions (and I guess
other directions as well), I tried to track this issue and apparently
directions are not taken into account when doing do_annot() in
pdflistout.c. 

The attached patch is quick hack, it does work to some degree, but I
don't really understand how PDF annotations are supposed to work, and
the result in vertical mode is not right yet.

Also, if I didn't set page and body direction, the vlist example will
ignore the direction change completely (is this related to the other
text direction in vertical mode issue?)

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.tex
Type: text/x-tex
Size: 210 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090702/91b2a00f/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pdf_annotation.diff
Type: text/x-diff
Size: 3799 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090702/91b2a00f/attachment-0001.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090702/91b2a00f/attachment-0002.bin>

From root at www.metatex.org  Thu Jul  2 22:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  2 Jul 2009 22:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090702203016.D1EAB788001@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://foundry.supelec.fr)

From hartmut_henkel at gmx.de  Thu Jul  2 23:06:00 2009
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu, 2 Jul 2009 23:06:00 +0200 (CEST)
Subject: [Dev-luatex] \pdfannot in TRT direction
In-Reply-To: <20090702195500.GA4428@khaled-laptop>
References: <20090702195500.GA4428@khaled-laptop>
Message-ID: <alpine.DEB.1.00.0907022258130.5471@hahepc1.hahe>

On Thu, 2 Jul 2009, Khaled Hosny wrote:

> PDF annotations are not placed correctly in TRT directions (and I
> guess other directions as well), I tried to track this issue and
> apparently directions are not taken into account when doing do_annot()
> in pdflistout.c.
>
> The attached patch is quick hack, it does work to some degree, but I
> don't really understand how PDF annotations are supposed to work, and
> the result in vertical mode is not right yet.
>
> Also, if I didn't set page and body direction, the vlist example will
> ignore the direction change completely (is this related to the other
> text direction in vertical mode issue?)

thanks for the report, seems do_annot was still just TLT only. I'll try
to fix (waiting for supelec).

Regards, Hartmut
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test-annot1.tex
Type: text/x-tex
Size: 1483 bytes
Desc: test-annot1.tex
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090702/0379e148/attachment.bin>

From root at www.metatex.org  Fri Jul  3 12:28:48 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri,  3 Jul 2009 12:28:48 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090703102848.B891C788001@www.metatex.org>

------------------------------------------------------------------------
r2725 | taco | 2009-07-03 11:00:49 +0200 (Fri, 03 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/llanglib.c

fix single-argument version of lang.hyphenate()

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul  4 12:29:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat,  4 Jul 2009 12:29:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090704102910.533AD788001@www.metatex.org>

------------------------------------------------------------------------
r2726 | taco | 2009-07-03 22:46:14 +0200 (Fri, 03 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.ch
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.h
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/expand.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c

convert sections 25 (expand) and 28 (conditional) to C

------------------------------------------------------------------------
r2727 | taco | 2009-07-04 08:25:22 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   A /trunk/source/texk/web2c/luatexdir/tex/packaging.h

prepare C files for packaging routines

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul  4 16:27:35 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat,  4 Jul 2009 16:27:35 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090704142735.E46F1788001@www.metatex.org>

------------------------------------------------------------------------
r2728 | oneiros | 2009-07-04 13:33:51 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/expand.h
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h

indent

------------------------------------------------------------------------
r2729 | taco | 2009-07-04 15:32:18 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h

move the boxing and box splitting to C 

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul  4 22:27:23 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat,  4 Jul 2009 22:27:23 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090704202723.BEAB6788001@www.metatex.org>

------------------------------------------------------------------------
r2730 | hhenkel | 2009-07-04 16:43:30 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c

indent only

------------------------------------------------------------------------
r2731 | taco | 2009-07-04 17:01:29 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

funny stuff happens if dimen_par() in used instead of glue_par() !!

------------------------------------------------------------------------
r2732 | taco | 2009-07-04 17:10:52 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

glue_set calculations should be floating point operations

------------------------------------------------------------------------
r2733 | taco | 2009-07-04 17:15:39 +0200 (Sat, 04 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

the same problem of using integer division for float values happened
a few more times

------------------------------------------------------------------------
r2734 | taco | 2009-07-04 17:16:44 +0200 (Sat, 04 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   A /trunk/source/texk/web2c/luatexdir/tex/linebreak.h
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c
   A /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.h

create postlinebreak.h and linebreak.h, and move the 
final bits of the line breaking code to linebreak.c

------------------------------------------------------------------------
r2735 | taco | 2009-07-04 17:31:34 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   D /trunk/source/texk/web2c/luatexdir/hyphen.h
   A /trunk/source/texk/web2c/luatexdir/lang/hyphen.h (from /trunk/source/texk/web2c/luatexdir/hyphen.h:2728)
   A /trunk/source/texk/web2c/luatexdir/lang/texlang.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

move hyphen.h to lang/ and introduce texlang.h

------------------------------------------------------------------------
r2736 | taco | 2009-07-04 17:40:20 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.h
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web

move the last of section 42 to C

------------------------------------------------------------------------
r2737 | taco | 2009-07-04 19:29:24 +0200 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.ch
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.c
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.h

move the rest of section 29 to texfileio.c

------------------------------------------------------------------------

From root at www.metatex.org  Sun Jul  5 12:28:49 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun,  5 Jul 2009 12:28:49 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090705102849.AF459788001@www.metatex.org>

------------------------------------------------------------------------
r2738 | hhenkel | 2009-07-04 22:36:58 +0200 (Sat, 04 Jul 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.h

integrate new structure posstructure for PDF positioning
into structure pdf_output_file.
pdf_place_form() already converted, more to follow...

------------------------------------------------------------------------
r2739 | hhenkel | 2009-07-05 00:46:37 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfglyph.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfglyph.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

new positioning for do_vf_packet() and pdf_place_glyph()

------------------------------------------------------------------------
r2740 | hhenkel | 2009-07-05 01:22:34 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfliteral.c

pdf_literal() positioning

------------------------------------------------------------------------
r2741 | hhenkel | 2009-07-05 01:55:52 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfrule.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfrule.h

pdf_place_rule() positioning

------------------------------------------------------------------------
r2742 | hhenkel | 2009-07-05 02:45:42 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

fix place_image() and vf_out_image()

------------------------------------------------------------------------
r2743 | hhenkel | 2009-07-05 02:50:16 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

use less global pos

------------------------------------------------------------------------
r2744 | hhenkel | 2009-07-05 03:17:15 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

clean up output_one_char() positioning

------------------------------------------------------------------------
r2745 | taco | 2009-07-05 08:26:11 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   A /trunk/source/texk/web2c/luatexdir/tex/scanning.h

create C files for the basic scanning routines in section 26

------------------------------------------------------------------------

From root at www.metatex.org  Sun Jul  5 16:27:29 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun,  5 Jul 2009 16:27:29 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090705142729.8B2C6788001@www.metatex.org>

------------------------------------------------------------------------
r2746 | oneiros | 2009-07-05 14:15:45 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h

indent

------------------------------------------------------------------------

From hartmut_henkel at gmx.de  Sun Jul  5 22:06:02 2009
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sun, 5 Jul 2009 22:06:02 +0200 (CEST)
Subject: [Dev-luatex] \pdfannot in TRT direction
In-Reply-To: <20090702195500.GA4428@khaled-laptop>
References: <20090702195500.GA4428@khaled-laptop>
Message-ID: <alpine.DEB.1.00.0907052109540.10419@hahepc1.hahe>

Hi Khaled,

On Thu, 2 Jul 2009, Khaled Hosny wrote:

> PDF annotations are not placed correctly in TRT directions (and I
> guess other directions as well), I tried to track this issue and
> apparently directions are not taken into account when doing do_annot()
> in pdflistout.c.

checked your test file. i guess it's looking wrong since you did not set
width, height, or depth of the \pdfannot. Then by default it takes as
annotation rectangle dimensions and position the width from the current
point to the end of the surrounding box (as pdftex does). And in TRT
mode the end of the box is left from the current point, as the
surrounding \hbox goes across the full \hsize. The viewer then places
the annotation text flush left into this rectangle, so it ends up rather
left on the paper. I guess one does not have good control over this
other than stating width, height, and depth as arguments to \pdfannot.
Seems to be also rather implementation dependent.

Just set width to some value (e. g. 20mm, see also samplepdf.tex from
pdftex) and you will hopefully see that the annotation will be about
where you want it. And have a look at the /Rect [] array in the PDF
file.

The directions _are_ taken care of (in a correct way i hope); the
coordinate transform to the page system happens within the
set_rect_dimens() function called from do_annot(). Even for the vertical
*B* and *T* directions it should be ok, but it stretches the
width/height/depth concept, as annotations seem to be generally TLT
text.

Well, one could start philosophize whether the rectangle should be
mounted better always to the right from the current point, independent
from direction. One could state dimensions (x,y), and maybe (x,y) offset
strictly in page coordinates, and forget about w/h/d as the rectangle
has anyway not much to do with the classical width/height/depth TeX
parameters, particularly when they are transformed. But then one has to
guarantee that the annotation does not fall off the page...

Regards, Hartmut

From root at www.metatex.org  Sun Jul  5 22:27:30 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun,  5 Jul 2009 22:27:30 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090705202730.3F3A8788001@www.metatex.org>

------------------------------------------------------------------------
r2747 | hhenkel | 2009-07-05 18:06:56 +0200 (Sun, 05 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/tex/directions.h

fix a compiler warning spotted by Martin (thanks!)
+ have a dir_TLT defined

------------------------------------------------------------------------
r2748 | oneiros | 2009-07-05 22:05:59 +0200 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.h
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h

indent

------------------------------------------------------------------------

From root at www.metatex.org  Mon Jul  6 12:28:43 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon,  6 Jul 2009 12:28:43 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090706102843.11BAF788001@www.metatex.org>

------------------------------------------------------------------------
r2749 | hhenkel | 2009-07-06 00:00:21 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfsetmatrix.c

remove transform from pdf_out_setmatrix()

------------------------------------------------------------------------

From root at www.metatex.org  Mon Jul  6 16:27:26 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon,  6 Jul 2009 16:27:26 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090706142726.C0FDD788001@www.metatex.org>

------------------------------------------------------------------------
r2750 | taco | 2009-07-06 13:17:45 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

convert the scanning routines to C

------------------------------------------------------------------------
r2751 | taco | 2009-07-06 16:15:37 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

indent

------------------------------------------------------------------------

From khaledhosny at eglug.org  Mon Jul  6 19:19:26 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Mon, 6 Jul 2009 20:19:26 +0300
Subject: [Dev-luatex] \pdfannot in TRT direction
In-Reply-To: <alpine.DEB.1.00.0907052109540.10419@hahepc1.hahe>
References: <20090702195500.GA4428@khaled-laptop>
	<alpine.DEB.1.00.0907052109540.10419@hahepc1.hahe>
Message-ID: <20090706171926.GB9850@khaled-laptop>

On Sun, Jul 05, 2009 at 10:06:02PM +0200, Hartmut Henkel wrote:
> Hi Khaled,
> 
> On Thu, 2 Jul 2009, Khaled Hosny wrote:
> 
> > PDF annotations are not placed correctly in TRT directions (and I
> > guess other directions as well), I tried to track this issue and
> > apparently directions are not taken into account when doing do_annot()
> > in pdflistout.c.
> 
> checked your test file. i guess it's looking wrong since you did not set
> width, height, or depth of the \pdfannot. Then by default it takes as
> annotation rectangle dimensions and position the width from the current
> point to the end of the surrounding box (as pdftex does). And in TRT
> mode the end of the box is left from the current point, as the
> surrounding \hbox goes across the full \hsize. The viewer then places
> the annotation text flush left into this rectangle, so it ends up rather
> left on the paper. I guess one does not have good control over this
> other than stating width, height, and depth as arguments to \pdfannot.
> Seems to be also rather implementation dependent.
> 
> Just set width to some value (e. g. 20mm, see also samplepdf.tex from
> pdftex) and you will hopefully see that the annotation will be about
> where you want it. And have a look at the /Rect [] array in the PDF
> file.

OK, got that and I think it is fine that way. However, if I don't set
page and body dir, annotations in vertical mode will be positioned at
the left side of the page:

\pardir TRT\textdir TRT
\pdfannot {/Subtype/Text/Contents(My comment)}

\leavevmode\pdfannot {/Subtype/Text/Contents(My comment)}
\bye

Is that related to hbox in vmode issue?
(I think that was the source of my problem, but I didn't realize that
then).

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090706/882c550e/attachment.bin>

From pragma at wxs.nl  Mon Jul  6 20:41:56 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Mon, 06 Jul 2009 20:41:56 +0200
Subject: [Dev-luatex] \pdfannot in TRT direction
In-Reply-To: <alpine.DEB.1.00.0907052109540.10419@hahepc1.hahe>
References: <20090702195500.GA4428@khaled-laptop>
	<alpine.DEB.1.00.0907052109540.10419@hahepc1.hahe>
Message-ID: <4A524574.4090501@wxs.nl>

Hartmut Henkel wrote:

> The directions _are_ taken care of (in a correct way i hope); the
> coordinate transform to the page system happens within the
> set_rect_dimens() function called from do_annot(). Even for the vertical
> *B* and *T* directions it should be ok, but it stretches the
> width/height/depth concept, as annotations seem to be generally TLT
> text.

indeed and we should be careful in adding to much automatism to that as 
often the code involved in custom annotations can be rather complex

> Well, one could start philosophize whether the rectangle should be
> mounted better always to the right from the current point, independent
> from direction. One could state dimensions (x,y), and maybe (x,y) offset
> strictly in page coordinates, and forget about w/h/d as the rectangle
> has anyway not much to do with the classical width/height/depth TeX
> parameters, particularly when they are transformed. But then one has to
> guarantee that the annotation does not fall off the page...

normally this is under macro package control and one can simply use 
-width or -height depending on the direction wanted (in pdf annotations 
are something independent of the page stream anyway)

the annotation model is already tricky in the sense that one has to do 
some positioning i.e. ps/pdf llcorner upwards model versus tex's page 
stream down model so let's not act too hastely

i suggest that we leave this code untouched till we have cleaned up the 
backend code (when you visit NL sometime we can sit on the balcony and 
muse about all the variants and options an dpossibilities)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From root at www.metatex.org  Mon Jul  6 22:27:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon,  6 Jul 2009 22:27:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090706202728.02B85788001@www.metatex.org>

------------------------------------------------------------------------
r2752 | taco | 2009-07-06 16:35:43 +0200 (Mon, 06 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.ch
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h

combine many of the restricted classes of scan_int into a single function,
and bring in the 0-15,18 scanner from the change file

------------------------------------------------------------------------
r2753 | oneiros | 2009-07-06 16:41:49 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writejpg.c

handle jfifs where either xres or yres is 0 and the other res is != 0

------------------------------------------------------------------------
r2754 | taco | 2009-07-06 17:06:39 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

the restricted classes section is now gone completely

------------------------------------------------------------------------
r2755 | taco | 2009-07-06 17:10:24 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c

fix '\the\delcode' and disable '\the\odelcode', '\the\Udelcode', and '\the\Udelcodenum'  

------------------------------------------------------------------------
r2756 | oneiros | 2009-07-06 17:11:59 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writejpg.c

fix #2753

------------------------------------------------------------------------
r2757 | taco | 2009-07-06 20:02:32 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c

fix a few conversion bugs

------------------------------------------------------------------------
r2758 | oneiros | 2009-07-06 20:11:54 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c

indent

------------------------------------------------------------------------
r2759 | oneiros | 2009-07-06 20:13:05 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c

indent

------------------------------------------------------------------------
r2760 | hhenkel | 2009-07-06 20:34:36 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c

r2747 wasn't enough to sedate the compiler

------------------------------------------------------------------------
r2761 | taco | 2009-07-06 21:54:21 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h

convert scan_expr() to C

------------------------------------------------------------------------
r2762 | hhenkel | 2009-07-06 21:54:30 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.h

simplify set_rect_dimens() interface

------------------------------------------------------------------------
r2763 | taco | 2009-07-06 21:54:42 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h

indent

------------------------------------------------------------------------

From root at www.metatex.org  Tue Jul  7 12:28:57 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue,  7 Jul 2009 12:28:57 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090707102857.327E6788001@www.metatex.org>

------------------------------------------------------------------------
r2764 | oneiros | 2009-07-06 22:27:54 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/web2c/native

ignore generated file

------------------------------------------------------------------------
r2765 | hhenkel | 2009-07-06 22:41:41 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c

ooops scaled_pos ---> scaledpos

------------------------------------------------------------------------
r2766 | hhenkel | 2009-07-06 23:18:45 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c

end_thread() cleanup

------------------------------------------------------------------------
r2767 | hhenkel | 2009-07-06 23:26:18 +0200 (Mon, 06 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

fix end_link()

------------------------------------------------------------------------
r2768 | taco | 2009-07-07 09:08:11 +0200 (Tue, 07 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.h

move some more routines to scanning.c

------------------------------------------------------------------------

From root at www.metatex.org  Tue Jul  7 16:27:28 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue,  7 Jul 2009 16:27:28 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090707142728.32997788002@www.metatex.org>

------------------------------------------------------------------------
r2769 | taco | 2009-07-07 13:02:13 +0200 (Tue, 07 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/directions.c
   M /trunk/source/texk/web2c/luatexdir/tex/directions.h

move some more direction stuff to directions.c

------------------------------------------------------------------------

From root at www.metatex.org  Tue Jul  7 22:27:24 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue,  7 Jul 2009 22:27:24 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090707202724.8E809788001@www.metatex.org>

------------------------------------------------------------------------
r2770 | taco | 2009-07-07 17:28:49 +0200 (Tue, 07 Jul 2009) | 16 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.h
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/lua/texluac.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.h

* move scan_image() from image/writeimg.c to pdf/pdfimage.c

* put the gobals pdf_obj_count, pdf_ximage_count, pdf_xform_count in
the big pdf structure

* remove append_ptr() and pdf_lookup_list() (i n pdftables.c) in 
favour of append_object_list() and lookup_object_list() (pdfgen.c). 
The new function does not use token memory anymore.

* move the related globals into the pdf structure: obj_list,
xform_list, ximage_list, dest_list, link_list, annot_list, bead_list

* created 3 extra pdf object types in the enumeration to allow the 
lists above to use a unified API (the last three are not in head_tab)


------------------------------------------------------------------------
r2771 | oneiros | 2009-07-07 18:05:04 +0200 (Tue, 07 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c

rm unused variable

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul  8 12:28:55 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  8 Jul 2009 12:28:55 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090708102855.35B0B1E8C2AC@www.metatex.org>

------------------------------------------------------------------------
r2772 | hhenkel | 2009-07-08 00:16:42 +0200 (Wed, 08 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.h

anchor set_rect_dimens() at cur instead of at the list origin
& make cur local within this function.

------------------------------------------------------------------------
r2773 | taco | 2009-07-08 10:25:58 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c

patch status.filename so that it (nearly) always returns a file name

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul  8 16:27:25 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  8 Jul 2009 16:27:25 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090708142725.996771E8C2AC@www.metatex.org>

------------------------------------------------------------------------
r2774 | taco | 2009-07-08 12:24:10 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

put the text_procset and image_procset into the pdf structure

------------------------------------------------------------------------
r2775 | oneiros | 2009-07-08 12:35:11 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c

init variable

------------------------------------------------------------------------
r2776 | taco | 2009-07-08 12:53:24 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/image.h

oops, missed one occurence of pdf_image_procset

------------------------------------------------------------------------
r2777 | taco | 2009-07-08 14:12:48 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pagetree.c

remove unnecessary headers

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul  8 22:27:25 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  8 Jul 2009 22:27:25 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090708202725.9D1B01E8C2AC@www.metatex.org>

------------------------------------------------------------------------
r2778 | taco | 2009-07-08 16:33:22 +0200 (Wed, 08 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/luatex.ch
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

move the destination names into the pdf structure, and switch to using char*s
(which, as a bonus, allows qsort() for sorting)

------------------------------------------------------------------------
r2779 | oneiros | 2009-07-08 16:36:48 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c

rm unused variable

------------------------------------------------------------------------
r2780 | taco | 2009-07-08 16:49:48 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

put two unions in the obj_entry  type to simplify the dest names dumping

------------------------------------------------------------------------
r2781 | taco | 2009-07-08 17:08:07 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

put the static variables from pdfoutline.c in the structure

------------------------------------------------------------------------
r2782 | taco | 2009-07-08 17:17:03 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

put the pdf link stack in the pdf structure

------------------------------------------------------------------------
r2783 | hhenkel | 2009-07-08 19:45:52 +0200 (Wed, 08 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c

use localpos.dir instead of global dvi_direction,
remove save_direction, make basepoint a scaledpos

------------------------------------------------------------------------
r2784 | hhenkel | 2009-07-08 20:04:09 +0200 (Wed, 08 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfsaverestore.c

move transform from pdf_out_save() and pdf_out_restore(),
remove box_pos 

------------------------------------------------------------------------
r2785 | hhenkel | 2009-07-08 21:04:46 +0200 (Wed, 08 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

remove left_edge and base_line (they were zero anyway),
and += cosmetics

------------------------------------------------------------------------
r2786 | hhenkel | 2009-07-08 21:30:30 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

edge cleanup

------------------------------------------------------------------------
r2787 | hhenkel | 2009-07-08 21:46:51 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

add missing transforms

------------------------------------------------------------------------

From root at www.metatex.org  Thu Jul  9 12:28:58 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  9 Jul 2009 12:28:58 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090709102858.AD7AF788001@www.metatex.org>

------------------------------------------------------------------------
r2788 | hhenkel | 2009-07-08 22:16:36 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

less transforms

------------------------------------------------------------------------
r2789 | oneiros | 2009-07-08 22:42:52 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

indent

------------------------------------------------------------------------
r2790 | hhenkel | 2009-07-08 22:48:18 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

remove dvi_ptr

------------------------------------------------------------------------
r2791 | hhenkel | 2009-07-08 23:58:17 +0200 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

combined cases for pdf_refximage_node and pdf_refxform_node

------------------------------------------------------------------------

From khaledhosny at eglug.org  Thu Jul  9 14:30:05 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 9 Jul 2009 15:30:05 +0300
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
	(and	luatex.1 man page)]
In-Reply-To: <20090426144341.GA16306@khaled-laptop>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
	<49F01645.90907@elvenkind.com>
	<20090426144341.GA16306@khaled-laptop>
Message-ID: <20090709123005.GA6778@khaled-laptop>

Any news about this man page, I assumed it was OK since there were no
further complaints :) but now texlive2009 pretest is out and I see the
old man page.

Regards,
 Khaled

On Sun, Apr 26, 2009 at 05:43:41PM +0300, Khaled Hosny wrote:
> On Thu, Apr 23, 2009 at 09:18:29AM +0200, Taco Hoekwater wrote:
> > Khaled Hosny wrote:
> >>
> >>>   The option list is a bit outdated in any case, I will try to
> >>>   document the actual, complete option list tomorrow.
> >>
> >> That would be very helpful, since I'd to guess most of the time.
> >
> > First, there are two switches that alter the executable behaviour:
> >
> >   --luaonly
> >   --luaconly
> >
> > Then, there are ignored:
> >
> >   --8bit
> >   --etex
> >   --[no-]parse-first-line
> >       these are always on
> >
> >   --default-translate-file=TCXNAME
> >   --translate-file=TCXNAME
> >       these are always off
> >
> > Actually interpreted switches and arguments:
> >
> >   --credits
> >       prints credits
> >
> >   --debug-format
> >       (normally undocumented) to debug format loading
> >
> >   --draftmode
> >       switch on draft mode (generates no output PDF)
> >
> >   --disable-write18
> >   --enable-write18
> >   --[no-]shell-escape
> >   --shell-restricted
> >       enable/disable/restrict \write18, os.execute(),
> >       os.exec(), os.spawn(), and io.popen().
> >
> >   --[no-]file-line-error[-style]
> >       disable/enable file:line:error style messages
> >
> >   --fmt=FMTNAME
> >       use FMTNAME instead of program name or a %& line
> >
> >   --halt-on-error
> >       stop processing at the first error
> >
> >   --help
> >       show help
> >
> >   --ini
> >       be iniluatex, for dumping formats
> >
> >   --interaction=STRING
> >       set interaction mode (STRING=batchmode/nonstopmode/
> >       scrollmode/errorstopmode)
> >
> >   --jobname=STRING
> >       set the job name to STRING
> >
> >   --kpathsea-debug=NUMBER
> >       set path searching debugging flags according to
> >       the bits of NUMBER
> >
> >   --lua=FILE
> >       the lua initialization file
> >
> >   --[no-]mktex=FMT
> >       disable/enable mktexFMT generation (FMT=tex/tfm)
> >
> >   --nosocket
> >       disable the luasocket (network) library
> >
> >   --output-comment=STRING
> >       use STRING for DVI file comment instead of date
> >
> >   --output-directory=DIR
> >       use DIR as the directory to write files to
> >
> >   --output-format=FORMAT
> >       use FORMAT for job output; FORMAT is `dvi' or `pdf
> >
> >   --progname=STRING
> >       set program (and fmt) name to STRING
> >
> >   --recorder
> >       enable filename recorder
> >
> >   --safer
> >       disable easily exploitable lua commands
> >
> >   --synctex=NUMBER
> >       enable/disable synctex
> >
> >   --version
> >       show version and exit
> >
> > The presence of --lua makes most of these switches unreliable,
> > because the lua initialization file can disable kpathsea and/or
> > hook functions into various callbacks. Here is the list of
> > possibly affected switches/functionality, and why:
> >
> >   --[no-]file-line-error[-style]
> >   --halt-on-error
> >   --disable-write18
> >   --enable-write18
> >   --[no-]shell-escape
> >   --shell-restricted
> >   --fmt
> >   --jobname
> >       controllable via the texconfig table
> >
> >   --kpathsea-debug
> >   --[no-]mktex
> >   --output-directory
> >   --progname=S
> >   --jobname=S
> >   --recorder
> >       kpathsea can be switched off via the texconfig table
> >
> >   --interaction
> >   --output-format
> >   --synctex
> >   --draftmode
> >       can be reset via texconf.init function
> >
> >   --<unrecognized options>
> >       the lua initialization script can access the commandline, so it
> >       can interpret extra options if it so desires.
> 
> Here is an updated one, comments are welcomed.
> 
> Regards,
>  Khaled
> 
> 
> -- 
>  Khaled Hosny
>  Arabic localiser and member of Arabeyes.org team
>  Free font developer

> LUATEX(1)                       Web2C @VERSION@                      LUATEX(1)
> 
> 
> 
> NNAAMMEE
>        luatex, texlua, texluac - An extended version of pdfTeX using Lua as an
>        embedded scripting language
> 
> SSYYNNOOPPSSIISS
>        lluuaatteexx [--lua=_F_I_L_E] [_O_P_T_I_O_N]... [_T_E_X_N_A_M_E[.tex]] [_C_O_M_M_A_N_D_S]
> 
>        lluuaatteexx [--lua=_F_I_L_E] [_O_P_T_I_O_N]... _\_F_I_R_S_T_-_L_I_N_E
> 
>        lluuaatteexx [--lua=_F_I_L_E] [_O_P_T_I_O_N]... &&_F_M_T _A_R_G_S
> 
> DDEESSCCRRIIPPTTIIOONN
>        Run the luaTeX typesetter on _T_E_X_N_A_M_E, usually creating TEXNAME.pdf. Any
>        remaining  _C_O_M_M_A_N_D_S  are  processed  as  luaTeX input, after TEXNAME is
>        read.
> 
>        Alternatively, if the first non-option argument  begins  with  a  back?
>        slash, interpret all non-option arguments as a line of luaTeX input.
> 
>        Alternatively,  if  the  first non-option argument begins with a &&, the
>        next word is taken as the _F_M_T to read, overriding all else. Any remain?
>        ing arguments are processed as above.
> 
>        If no arguments or options are specified, prompt for input.
> 
>        If  called  as tteexxlluuaa it acts as lua interpreter.  If called as tteexxlluuaacc
>        it acts as lua bytecode compiler.
> 
>        LuaTeX is an extended version of pdfTeX with Unicode and OpenType  font
>        support,  embeded  LLuuaa  scripting  language, the ee--TTeeXX and OOmmeeggaa exten?
>        sions, as well as integrated MetaPost engine, that can create _P_D_F files
>        as  well  as  _D_V_I  files.   For  more  information  about  luatex,  see
>        http://www.luatex.org, you can read LuaTeX manual using texdoc  utility
>        (tteexxddoocc lluuaatteexx).
> 
>        All LuaTeX text input and output is considered to be Unicode text.
> 
>        In  _D_V_I  mode, luaTeX can be used as a complete replacement for the TeX
>        engine.
> 
>        In _P_D_F mode, luaTeX can natively handle the _P_D_F, _J_P_G,  _J_B_I_G_2,  and  _P_N_G
>        graphics  formats.   luaTeX  cannot  include PostScript or Encapsulated
>        PostScript (EPS) graphics  files;  first  convert  them  to  PDF  using
>        eeppssttooppddff (1).
> 
> 
> OOPPTTIIOONNSS
>        When  the  LuaTeX executable starts, it looks for the ----lluuaa commandline
>        option.  If there is no ----lluuaa option, the commandline is interpreted in
>        a similar fashion as in traditional pdfTeX and Aleph. But if the option
>        is present, LuaTeX will enter an alternative mode of commandline  pars?
>        ing in comparison to the standard web2c programs. The presence of ----lluuaa
>        makes most of other options unreliable, because the lua  initialization
>        file can disable kpathsea and/or hook functions into various callbacks.
> 
>        ----lluuaa==_F_I_L_E
>               The lua initialization file.
> 
>        The following two options alter the executable behaviour:
> 
>        ----lluuaaoonnllyy
>               Start LuaTeX as a Lua interpreter. In this  mode,  it  will  set
>               Lua?s _a_r_g_[_0_] to the found script name, pushing preceding options
>               in negative values and the rest of the commandline in the  posi?
>               tive  values,  just  like  the Lua interpreter. LuaTeX will exit
>               immediately after executing the specified Lua script.
> 
>        ----lluuaaccoonnllyy
>               Start LuaTeX as a Lua byte compiler. In  this  mode,  LuaTeX  is
>               exactly  like  lluuaacc from the standalone Lua distribution, except
>               that it does not have the --ll switch, and that  it  accepts  (but
>               ignores) the ----lluuaaccoonnllyy switch.
> 
>        Then the regular web2c options:
> 
>        ----ddeebbuugg--ffoorrmmaatt
>               Debug format loading.
> 
>        ----ddrraaffttmmooddee
>               Sets  \pdfdraftmode  so  luaTeX  doesn?t write a PDF and doesn?t
>               read any included images, thus speeding up execution.
> 
>        ----eennaabbllee--wwrriittee1188
>               Synonym for ----sshheellll--eessccaappee.
> 
>        ----ddiissaabbllee--wwrriittee1188
>               Synonym for ----nnoo--sshheellll--eessccaappee.
> 
>        ----sshheellll--eessccaappee
>               Enable  the  \\wwrriittee1188{{_c_o_m_m_a_n_d}}  construct,  and  Lua   functions
>               ooss..eexxeeccuuttee(()),  ooss..eexxeecc(()),  ooss..ssppaawwnn(()), and iioo..ppooppeenn(()).  The _c_o_m_?
>               _m_a_n_d can be any shell command.  This construct is normally  dis?
>               allowed for security reasons.
> 
>        ----nnoo--sshheellll--eessccaappee
>               Disable  the \\wwrriittee1188{{_c_o_m_m_a_n_d}} construct and the other Lua func?
>               tions, even if it is enabled in the _t_e_x_m_f_._c_n_f file.
> 
>        ----sshheellll--rreessttrriicctteedd
>               Enable restricted version of \\wwrriittee1188, ooss..eexxeeccuuttee(()),  ooss..eexxeecc(()),
>               ooss..ssppaawwnn(()),  and  iioo..ppooppeenn(()),  only commands listed in _t_e_x_m_f_._c_n_f
>               file are allowed.
> 
>        ----ffiillee--lliinnee--eerrrroorr
>               Print error messages in the form _f_i_l_e_:_l_i_n_e_:_e_r_r_o_r which is  simi?
>               lar to the way many compilers format them.
> 
>        ----nnoo--ffiillee--lliinnee--eerrrroorr
>               Disable printing error messages in the _f_i_l_e_:_l_i_n_e_:_e_r_r_o_r style.
> 
>        ----ffmmtt==_F_O_R_M_A_T
>               Use  _F_O_R_M_A_T as the name of the format to be used, instead of the
>               name by which luaTeX was called or a _%_& line.
> 
>        ----hheellpp Print help message and exit.
> 
>        ----iinnii  Start in _I_N_I mode, which is used to dump formats.  The _I_N_I  mode
>               can  be  used  for  typesetting, but no format is preloaded, and
>               basic initializations like setting catcodes may be required.
> 
>        ----iinntteerraaccttiioonn==_M_O_D_E
>               Sets the interaction mode.  The _M_O_D_E can  be  either  _b_a_t_c_h_m_o_d_e,
>               _n_o_n_s_t_o_p_m_o_d_e,  _s_c_r_o_l_l_m_o_d_e,  and  _e_r_r_o_r_s_t_o_p_m_o_d_e.   The  meaning of
>               these modes is the same as that of the corresponding  \commands.
> 
>        ----jjoobbnnaammee==_N_A_M_E
>               Use  _N_A_M_E for the job name, instead of deriving it from the name
>               of the input file.
> 
>        ----kkppaatthhsseeaa--ddeebbuugg==_B_I_T_M_A_S_K
>               Sets path searching debugging flags according  to  the  _B_I_T_M_A_S_K.
>               See the _K_p_a_t_h_s_e_a manual for details.
> 
>        ----mmkktteexx==_F_M_T
>               Enable mktex_F_M_T generation, where _F_M_T must be either _t_e_x or _t_f_m.
> 
>        ----nnoossoocckkeett
>               Disable the luasocket (network) library.
> 
> 
>        ----oouuttppuutt--ccoommmmeenntt==_S_T_R_I_N_G
>               In _D_V_I mode, use _S_T_R_I_N_G for the _D_V_I file comment  instead
>               of the date.  This option is ignored in_P_D_F mode.
> 
>        ----oouuttppuutt--ddiirreeccttoorryy==_D_I_R_E_C_T_O_R_Y
>               Write  output  files  in _D_I_R_E_C_T_O_R_Y instead of the current
>               directory.  Look up input files in _D_I_R_E_C_T_O_R_Y first,  then
>               along the normal search path.
> 
>        ----oouuttppuutt--ffoorrmmaatt==_F_O_R_M_A_T
>               Set  the  output format mode, where _F_O_R_M_A_T must be either
>               _p_d_f or _d_v_i.  This also influences  the  set  of  graphics
>               formats understood by luaTeX.
> 
>        ----pprrooggnnaammee==_N_A_M_E
>               Pretend to be program _N_A_M_E (only for kpathsea).
> 
>        ----rreeccoorrddeerr
>               Enable the filename recorder.  This leaves a trace of the
>               files opened for input and output in a file  with  exten?
>               sion _._f_l_s.
> 
>        ----ssaaffeerr
>               Disable  some Lua commands that can easily be abused by a
>               malicious document.
> 
>        ----ssyynncctteexx==_N_U_M_B_E_R
>               Enable/disable SyncTeX extension.
> 
>        ----vveerrssiioonn
>               Print version information and exit.
> 
>        ----ccrreeddiittss
>               Print credits and version details.
> 
>        The following options are ignored:
> 
>        ----88bbiitt, ----eetteexx, ----ppaarrssee--ffiirrsstt--lliinnee,"--no-parse-first-line"
>               These are always on.
> 
>        ----ddeeffaauulltt--ttrraannssllaattee--ffiillee==_T_C_X_N_A_M_E,, ----ttrraannssllaattee--ffiillee==
>               TCXNAME These are always off.
> 
> 
> SSEEEE AALLSSOO
>        ppddfftteexx(1), eetteexx(1), aalleepphh(1), oommeeggaa(1), lluuaa(1).
> 
> AAUUTTHHOORRSS
>        The primary authors of LuaTeX are Hartmut Henkel,  Taco  Hoekwa?
>        ter,  and  Hans  Hagen,  with  help  from Martin Schr?der, Karel
>        Skoupy, and Han The Thanh.
> 
>        TeX was designed by Donald E. Knuth, who  implemented  it  using
>        his  Web  system  for Pascal programs.  It was ported to Unix at
>        Stanford by Howard Trickey, and at Cornell by Pavel Curtis.  The
>        version  now offered with the Unix TeX distribution is that gen?
>        erated by the Web to C system  (wweebb22cc),  originally  written  by
>        Tomas Rokicki and Tim Morgan.
> 
> 
> 
> luatex 0.40                       2009.04.22                         LUATEX(1)


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090709/b9af360b/attachment.bin>

From taco at elvenkind.com  Thu Jul  9 15:36:22 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Jul 2009 15:36:22 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <20090709123005.GA6778@khaled-laptop>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
	<49F01645.90907@elvenkind.com>
	<20090426144341.GA16306@khaled-laptop>
	<20090709123005.GA6778@khaled-laptop>
Message-ID: <4A55F256.4000600@elvenkind.com>


Hi Khaled,

Khaled Hosny wrote:
> Any news about this man page, I assumed it was OK since there were no
> further complaints :) but now texlive2009 pretest is out and I see the
> old man page.

I've added the man page to the texlive repository just now.

Best wishes,
Taco

From preining at logic.at  Thu Jul  9 15:43:12 2009
From: preining at logic.at (Norbert Preining)
Date: Thu, 9 Jul 2009 15:43:12 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
	(and	luatex.1 man page)]
In-Reply-To: <4A55F256.4000600@elvenkind.com>
References: <20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
	<49F01645.90907@elvenkind.com>
	<20090426144341.GA16306@khaled-laptop>
	<20090709123005.GA6778@khaled-laptop>
	<4A55F256.4000600@elvenkind.com>
Message-ID: <20090709134312.GD19134@gamma.logic.tuwien.ac.at>

On Do, 09 Jul 2009, Taco Hoekwater wrote:
> I've added the man page to the texlive repository just now.

And I have updated Master/texmf/doc/man/man1/luatex.1, which is the only
one that will actually be used. The man pages generated from source are
not actually used, but have to be kept in sync by hand with
texmf/doc/man

Thanks for the nice man page!

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
WORKSOP (n.)
A person who never actually gets round to doing anything because he
spends all his time writing out lists headed 'Things to Do (Urgent)'.
			--- Douglas Adams, The Meaning of Liff

From root at www.metatex.org  Thu Jul  9 16:27:23 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  9 Jul 2009 16:27:23 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090709142723.92CF3788001@www.metatex.org>

------------------------------------------------------------------------
r2792 | taco | 2009-07-09 15:25:47 +0200 (Thu, 09 Jul 2009) | 2 lines
Changed paths:
   A /trunk/manual/luatex.man

Add Khaled Hosny's man page to the repository

------------------------------------------------------------------------

From mpg at elzevir.fr  Thu Jul  9 14:48:03 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Thu, 09 Jul 2009 14:48:03 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <20090709123005.GA6778@khaled-laptop>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
	<49F01645.90907@elvenkind.com>
	<20090426144341.GA16306@khaled-laptop>
	<20090709123005.GA6778@khaled-laptop>
Message-ID: <4A55E703.7050402@elzevir.fr>

Khaled Hosny a ?crit :
> Any news about this man page, I assumed it was OK since there were no
> further complaints :) but now texlive2009 pretest is out and I see the
> old man page.
> 
I assume we were waiting for further comments and forgot to install it. I'll
install the new man page tonight (right now I'm behind a firewall and don't feel
like playing with tunnels).

Thanks for reminding us.

Manuel.

From khaledhosny at eglug.org  Thu Jul  9 19:14:20 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Thu, 9 Jul 2009 20:14:20 +0300
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
	(and	luatex.1 man page)]
In-Reply-To: <4A55F256.4000600@elvenkind.com>
References: <20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
	<49F01645.90907@elvenkind.com>
	<20090426144341.GA16306@khaled-laptop>
	<20090709123005.GA6778@khaled-laptop>
	<4A55F256.4000600@elvenkind.com>
Message-ID: <20090709171420.GA27140@khaled-laptop>

On Thu, Jul 09, 2009 at 03:36:22PM +0200, Taco Hoekwater wrote:
>
> Hi Khaled,
>
> Khaled Hosny wrote:
>> Any news about this man page, I assumed it was OK since there were no
>> further complaints :) but now texlive2009 pretest is out and I see the
>> old man page.
>
> I've added the man page to the texlive repository just now.

Great!


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090709/f81cfb02/attachment.bin>

From root at www.metatex.org  Fri Jul 10 12:29:18 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 10 Jul 2009 12:29:18 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090710102918.80E23788001@www.metatex.org>

------------------------------------------------------------------------
r2793 | taco | 2009-07-10 08:37:35 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

move some more of section 27 to C files

------------------------------------------------------------------------
r2794 | taco | 2009-07-10 10:20:47 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

fix hz crash introduced in 2729

------------------------------------------------------------------------
r2795 | taco | 2009-07-10 10:48:17 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

remove some obsolete code

------------------------------------------------------------------------
r2796 | taco | 2009-07-10 10:52:05 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

move the pdf action code (except alloc/dealloc) to pdfaction.c

------------------------------------------------------------------------
r2797 | taco | 2009-07-10 11:28:30 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.h

some action code cleanup

------------------------------------------------------------------------

From root at www.metatex.org  Fri Jul 10 16:27:28 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 10 Jul 2009 16:27:28 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090710142728.3DE9A788001@www.metatex.org>

------------------------------------------------------------------------
r2798 | oneiros | 2009-07-10 13:04:11 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.h

add missing declaration

------------------------------------------------------------------------
r2799 | taco | 2009-07-10 14:23:53 +0200 (Fri, 10 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c

allow oentries to have char *'s as values, and add some
(still clumsy) interfacing around that

------------------------------------------------------------------------
r2800 | taco | 2009-07-10 15:12:04 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

move the thread variables and pdf_last_resources into the pdf structure

------------------------------------------------------------------------
r2801 | taco | 2009-07-10 15:12:59 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

indent

------------------------------------------------------------------------
r2802 | taco | 2009-07-10 16:12:44 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines

remove lots of unneeded identifiers from luatex.defines

------------------------------------------------------------------------

From root at www.metatex.org  Fri Jul 10 22:27:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 10 Jul 2009 22:27:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090710202727.19D8D788001@www.metatex.org>

------------------------------------------------------------------------
r2803 | taco | 2009-07-10 16:34:06 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   D /trunk/source/texk/web2c/luatexdir/change-files.txt
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   D /trunk/source/texk/web2c/luatexdir/get_svnversion.sh
   D /trunk/source/texk/web2c/luatexdir/luatex.mk
   D /trunk/source/texk/web2c/luatexdir/luatexlib.mk
   D /trunk/source/texk/web2c/luatexdir/managed-sa.c
   D /trunk/source/texk/web2c/luatexdir/managed-sa.h
   D /trunk/source/texk/web2c/luatexdir/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   A /trunk/source/texk/web2c/luatexdir/tex/mathcodes.c (from /trunk/source/texk/web2c/luatexdir/mathcodes.c:2798)
   A /trunk/source/texk/web2c/luatexdir/tex/textcodes.c (from /trunk/source/texk/web2c/luatexdir/textcodes.c:2798)
   D /trunk/source/texk/web2c/luatexdir/textcodes.c
   A /trunk/source/texk/web2c/luatexdir/utils/managed-sa.c (from /trunk/source/texk/web2c/luatexdir/managed-sa.c:2798)
   A /trunk/source/texk/web2c/luatexdir/utils/managed-sa.h (from /trunk/source/texk/web2c/luatexdir/managed-sa.h:2798)
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/web2c/Makefile.in
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure

move some files into subdirectories

------------------------------------------------------------------------
r2804 | oneiros | 2009-07-10 18:07:10 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luafontloader/fontforge/fontforge/splineutil2.c

init variable to silence compiler

------------------------------------------------------------------------
r2805 | taco | 2009-07-10 18:56:16 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

the rest of section 27 (conv_toks and read_toks)

------------------------------------------------------------------------
r2806 | taco | 2009-07-10 20:19:32 +0200 (Fri, 10 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/errors.c
   M /trunk/source/texk/web2c/luatexdir/tex/errors.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h

convert some more functions (mostly printing)

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul 11 12:28:55 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 11 Jul 2009 12:28:55 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090711102855.36B80788001@www.metatex.org>

------------------------------------------------------------------------
r2807 | oneiros | 2009-07-11 01:01:31 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/writettf.c

bugfix by thanh

------------------------------------------------------------------------
r2808 | taco | 2009-07-11 08:57:18 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/luatex.web

some of the pascal macro interface functions are obsolete

------------------------------------------------------------------------
r2809 | taco | 2009-07-11 09:07:32 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

move a few other small functions

------------------------------------------------------------------------
r2810 | taco | 2009-07-11 09:13:14 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   A /trunk/source/texk/web2c/luatexdir/tex/buildpage.h
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/web2c/Makefile.in
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure

prepare a set of C files for the page builder (section 45)

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul 11 16:27:24 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 11 Jul 2009 16:27:24 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090711142724.1C296788001@www.metatex.org>

------------------------------------------------------------------------
r2811 | taco | 2009-07-11 12:19:00 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.h

do page building in C

------------------------------------------------------------------------
r2812 | taco | 2009-07-11 12:24:10 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   A /trunk/source/texk/web2c/luatexdir/tex/maincontrol.h

prepare C source files for the main executive

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul 11 22:27:22 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 11 Jul 2009 22:27:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090711202722.78CBC788001@www.metatex.org>

------------------------------------------------------------------------
r2813 | hhenkel | 2009-07-11 16:56:31 +0200 (Sat, 11 Jul 2009) | 2 lines
Changed paths:
   M /trunk/build.sh

parameter check for build.sh

------------------------------------------------------------------------

From root at www.metatex.org  Sun Jul 12 12:28:50 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 12 Jul 2009 12:28:50 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090712102850.7C032788001@www.metatex.org>

------------------------------------------------------------------------
r2814 | hhenkel | 2009-07-12 01:02:31 +0200 (Sun, 12 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/image.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

collect all 8 page resource lists into one structure
make last_resources again local to pdf_ship_out()

------------------------------------------------------------------------
r2815 | hhenkel | 2009-07-12 01:40:15 +0200 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

move reset_resource_lists()

------------------------------------------------------------------------
r2816 | hhenkel | 2009-07-12 02:11:01 +0200 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

new function flush_resource_lists()

------------------------------------------------------------------------
r2817 | oneiros | 2009-07-12 02:45:27 +0200 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/errors.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.c

indent

------------------------------------------------------------------------
r2818 | oneiros | 2009-07-12 03:26:09 +0200 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c

treat TTC fonts as TTF (r572 from pdftex)

------------------------------------------------------------------------

From root at www.metatex.org  Sun Jul 12 16:27:24 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 12 Jul 2009 16:27:24 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090712142724.EDAC3788001@www.metatex.org>

------------------------------------------------------------------------
r2819 | taco | 2009-07-12 15:28:12 +0200 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   A /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   A /trunk/source/texk/web2c/luatexdir/tex/equivalents.h

Looks like these are really needed for maincontrol as well

------------------------------------------------------------------------

From root at www.metatex.org  Mon Jul 13 12:28:45 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 13 Jul 2009 12:28:45 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090713102845.468FB788001@www.metatex.org>

------------------------------------------------------------------------
r2820 | taco | 2009-07-13 08:32:04 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   A /trunk/source/texk/web2c/luatexdir/tex/commands.c
   A /trunk/source/texk/web2c/luatexdir/tex/dumpdata.c
   A /trunk/source/texk/web2c/luatexdir/tex/dumpdata.h
   A /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   A /trunk/source/texk/web2c/luatexdir/tex/extensions.h
   A /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   A /trunk/source/texk/web2c/luatexdir/tex/mainbody.h

here are the last batch of needed C files

------------------------------------------------------------------------
r2821 | taco | 2009-07-13 09:47:15 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

fix the Overfull... messages

------------------------------------------------------------------------
r2822 | taco | 2009-07-13 11:16:00 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

new mplib

------------------------------------------------------------------------

From root at www.metatex.org  Mon Jul 13 16:27:41 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 13 Jul 2009 16:27:41 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090713142741.46B1D788001@www.metatex.org>

------------------------------------------------------------------------
r2823 | taco | 2009-07-13 12:41:40 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

fix a potential crash in mplib

------------------------------------------------------------------------
r2824 | taco | 2009-07-13 12:42:05 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c

support a 'nomath' field (for speedup)

------------------------------------------------------------------------
r2825 | taco | 2009-07-13 12:43:17 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c

fix a bug in tex_for_cs() and clean it up a bit

------------------------------------------------------------------------
r2826 | taco | 2009-07-13 14:16:03 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfliteral.c

fix an offset of one in STRING_OFFSET 

------------------------------------------------------------------------
r2827 | taco | 2009-07-13 14:18:53 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

hide the manipulations of STRING_OFFSET for cmd,chr tokens in macros

------------------------------------------------------------------------
r2828 | taco | 2009-07-13 15:17:17 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h

add some packing hints for the input_stack structure

------------------------------------------------------------------------
r2829 | taco | 2009-07-13 16:05:02 +0200 (Mon, 13 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/font/tounicode.c
   M /trunk/source/texk/web2c/luatexdir/font/vfovf.c
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

small (and simple) speedups were possible in the font backend

------------------------------------------------------------------------

From taco at elvenkind.com  Tue Jul 14 09:15:44 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Jul 2009 09:15:44 +0200
Subject: [Dev-luatex] trunk is broken
Message-ID: <4A5C30A0.9080303@elvenkind.com>

Hi,

Just a quick note: the TRUNK in the repository is broken at the moment
and will likely remain broken for a day (two at the most, I hope). I am
in the final stages of converting the pascal web code to C, and I needed
to check the code in so I can continue working on it at the office.

For Martin: don't bother running indent yet, I'll clean it up later.

Best wishes,
Taco


From dak at gnu.org  Tue Jul 14 11:40:27 2009
From: dak at gnu.org (David Kastrup)
Date: Tue, 14 Jul 2009 11:40:27 +0200
Subject: [Dev-luatex] trunk is broken
In-Reply-To: <4A5C30A0.9080303@elvenkind.com> (Taco Hoekwater's message of
	"Tue, 14 Jul 2009 09:15:44 +0200")
References: <4A5C30A0.9080303@elvenkind.com>
Message-ID: <87zlb7k3g4.fsf@lola.goethe.zz>

Taco Hoekwater <taco at elvenkind.com> writes:

> Hi,
>
> Just a quick note: the TRUNK in the repository is broken at the moment
> and will likely remain broken for a day (two at the most, I hope). I
> am in the final stages of converting the pascal web code to C, and I
> needed to check the code in so I can continue working on it at the
> office.

Is that a plea for a distributed version control system?

At some point of time you might find it worth doing your checkouts with
"git svn" and then working with git.  One of the advantages is that you
can perfectly well work offline (including working with all of the
project history), and do that very efficiently.  Another is that
maintaining local branches (and moving them to another computer) is also
quite painless.

I've switched to using git for everything years ago, and "git svn" makes
that quite transparent to other people when working with Subversion
repositories.  Except that systems like "Trac" sometimes display things
in a somewhat mixed up if you make 5 commits in the same second...

-- 
David Kastrup

From taco at elvenkind.com  Tue Jul 14 11:44:47 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Jul 2009 11:44:47 +0200
Subject: [Dev-luatex] trunk is broken
In-Reply-To: <87zlb7k3g4.fsf@lola.goethe.zz>
References: <4A5C30A0.9080303@elvenkind.com> <87zlb7k3g4.fsf@lola.goethe.zz>
Message-ID: <4A5C538F.3020209@elvenkind.com>



David Kastrup wrote:
> 
> At some point of time you might find it worth doing your checkouts with
> "git svn" and then working with git.  One of the advantages is that you
> can perfectly well work offline (including working with all of the
> project history), and do that very efficiently.  Another is that
> maintaining local branches (and moving them to another computer) is also
> quite painless.

I have been told by a few people already that I could set up a git in
front of the subversion repository to act as a local frontend, but I
never seem to manage to find the time to learn how to use git, not even
for such 'trivial' use.

Best wishes,
Taco

From martin at oneiros.de  Tue Jul 14 11:50:43 2009
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Tue, 14 Jul 2009 11:50:43 +0200
Subject: [Dev-luatex] trunk is broken
In-Reply-To: <87zlb7k3g4.fsf@lola.goethe.zz>
References: <4A5C30A0.9080303@elvenkind.com> <87zlb7k3g4.fsf@lola.goethe.zz>
Message-ID: <68c491a60907140250w687d26b8tab45a1578b4f172f@mail.gmail.com>

2009/7/14 David Kastrup <dak at gnu.org>:
> Is that a plea for a distributed version control system?

I doubt it.

Best
   Martin

From root at www.metatex.org  Tue Jul 14 12:28:56 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 14 Jul 2009 12:28:56 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090714102856.CDE43788001@www.metatex.org>

------------------------------------------------------------------------
r2830 | taco | 2009-07-14 09:09:38 +0200 (Tue, 14 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/vfovf.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/luatex.ch
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/ocp/ocp.c
   M /trunk/source/texk/web2c/luatexdir/ocp/ocp.h
   M /trunk/source/texk/web2c/luatexdir/ocp/ocplist.c
   M /trunk/source/texk/web2c/luatexdir/ocp/runocp.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.h
   M /trunk/source/texk/web2c/luatexdir/primitive.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.h
   M /trunk/source/texk/web2c/luatexdir/tex/commands.c
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/directions.c
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.c
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.h
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/errors.c
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.h
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/nesting.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.c
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.h
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.c
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h
   M /trunk/source/texk/web2c/luatexdir/utils/synctex.c
   M /trunk/source/texk/web2c/texmfmp.h

Ok, now all the pascal code is converted to C.
Note: the binary is broken right now.

------------------------------------------------------------------------
r2831 | oneiros | 2009-07-14 09:22:38 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c

rm duplicat definition

------------------------------------------------------------------------
r2832 | oneiros | 2009-07-14 09:28:46 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.h

fix a "warning: format ?\226?\128?\152%ld?\226?\128?\153 expects type ?\226?\128?\152long int?\226?\128?\153, but argument 7 has type ?\226?\128?\152pool_pointer?\226?\128?\153"

------------------------------------------------------------------------
r2833 | taco | 2009-07-14 09:43:23 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

fix a few types

------------------------------------------------------------------------
r2834 | taco | 2009-07-14 10:06:40 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.c

prevent crashes from luatex -ini plain 

------------------------------------------------------------------------
r2835 | taco | 2009-07-14 10:15:47 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/lib/texmfmp.c
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c

silence compiler warnings

------------------------------------------------------------------------
r2836 | taco | 2009-07-14 10:17:53 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h

drop some definitions that were really unneeded

------------------------------------------------------------------------
r2837 | taco | 2009-07-14 10:38:18 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c

fix escape_char at start_input()

------------------------------------------------------------------------
r2838 | taco | 2009-07-14 10:58:59 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c

might as well memset the lot

------------------------------------------------------------------------
r2839 | taco | 2009-07-14 10:59:18 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c

add some braces

------------------------------------------------------------------------
r2840 | taco | 2009-07-14 10:59:39 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h

stop the zeqtb sillyness

------------------------------------------------------------------------
r2841 | taco | 2009-07-14 11:06:35 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h

xeq_level was one too small

------------------------------------------------------------------------
r2842 | taco | 2009-07-14 11:11:32 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c

A small thing: the output box is now dynamic

------------------------------------------------------------------------
r2843 | taco | 2009-07-14 11:14:12 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.c

hash initialization can use memset here as well

------------------------------------------------------------------------
r2844 | taco | 2009-07-14 11:43:15 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

the direction specifiers are dir_par() items

------------------------------------------------------------------------
r2845 | taco | 2009-07-14 12:10:19 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.c

get_strings_started () is now not needed anymore

------------------------------------------------------------------------

From nvitacolonna at gmail.com  Tue Jul 14 14:46:25 2009
From: nvitacolonna at gmail.com (Nicola)
Date: Tue, 14 Jul 2009 14:46:25 +0200
Subject: [Dev-luatex] trunk is broken
References: <4A5C30A0.9080303@elvenkind.com> <87zlb7k3g4.fsf@lola.goethe.zz>
	<4A5C538F.3020209@elvenkind.com>
Message-ID: <nvitacolonna-DBEF42.14462414072009@news.gmane.org>

In article <4A5C538F.3020209 at elvenkind.com>,
 Taco Hoekwater <taco at elvenkind.com> wrote:

> never seem to manage to find the time to learn how to use git, not even
> for such 'trivial' use.

Have you considered any possibly simpler but no less powerful 
alternatives (Bazaar, Mercurial, ...)? Personally, I've been using 
Bazaar for some time now and I'm pretty happy with it. Switching from 
svn was a breeze. And, as git, it can interoperate with a Subversion 
repository.

Nicola

PS: I would also suggest Redmine as an alternative to Trac...


From taco at elvenkind.com  Tue Jul 14 16:23:01 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 14 Jul 2009 16:23:01 +0200
Subject: [Dev-luatex] trunk is broken
In-Reply-To: <nvitacolonna-DBEF42.14462414072009@news.gmane.org>
References: <4A5C30A0.9080303@elvenkind.com>
	<87zlb7k3g4.fsf@lola.goethe.zz>	<4A5C538F.3020209@elvenkind.com>
	<nvitacolonna-DBEF42.14462414072009@news.gmane.org>
Message-ID: <4A5C94C5.5000004@elvenkind.com>



Nicola wrote:
> In article <4A5C538F.3020209 at elvenkind.com>,
>  Taco Hoekwater <taco at elvenkind.com> wrote:
> 
>> never seem to manage to find the time to learn how to use git, not even
>> for such 'trivial' use.
> 
> Have you considered any possibly simpler but no less powerful 
> alternatives (Bazaar, Mercurial, ...)? 

Practically speaking, just the simple fact that there is a choice
stops me from trying any of them.

Anyway, even though something weird is still wrong with my arabic
samples, TRUNK is more or less usable again.

Best wishes,
Taco

From root at www.metatex.org  Tue Jul 14 16:27:24 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 14 Jul 2009 16:27:24 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090714142724.D6B8B788001@www.metatex.org>

------------------------------------------------------------------------
r2846 | taco | 2009-07-14 13:49:28 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h

can't call maketexstring from inside get_luatexrevision()

------------------------------------------------------------------------
r2847 | taco | 2009-07-14 14:49:56 +0200 (Tue, 14 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

dump the page box contents when \tracingoutput is nonzero even if there is a callback
defined (I need this for debugging of context mkiv code)

------------------------------------------------------------------------
r2848 | taco | 2009-07-14 14:51:39 +0200 (Tue, 14 Jul 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c

to be investigated: the luatex reference manual now hits this assert()
in the first contents page. it could be that something is not initialized
properly from lua...

------------------------------------------------------------------------
r2849 | taco | 2009-07-14 14:52:00 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c

cleanup mainbody.c a bit

------------------------------------------------------------------------
r2850 | taco | 2009-07-14 15:56:02 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

fix math directions (and the assert bug from earlier)

------------------------------------------------------------------------
r2851 | taco | 2009-07-14 15:59:57 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c

at least insert a dash between the revision and the dateinfo in the banner line

------------------------------------------------------------------------
r2852 | taco | 2009-07-14 16:07:38 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/writecff.c

the crosscompiler is complaining about ERROR being redefined

------------------------------------------------------------------------

From root at www.metatex.org  Tue Jul 14 22:27:25 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 14 Jul 2009 22:27:25 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090714202725.E5BC7788001@www.metatex.org>

------------------------------------------------------------------------
r2853 | taco | 2009-07-14 16:34:33 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/directions.c

scan_direction has to save cur_chr and cur_cmd because of the optional space

------------------------------------------------------------------------
r2854 | taco | 2009-07-14 16:40:06 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/font/writecff.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfliteral.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   M /trunk/source/texk/web2c/luatexdir/tex/commands.c
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.c
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.h
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/errors.c
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.h
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.c
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

indent

------------------------------------------------------------------------
r2855 | taco | 2009-07-14 16:56:53 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

fix memory stats messages

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul 15 12:28:51 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 15 Jul 2009 12:28:51 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090715102851.BEF49788001@www.metatex.org>

------------------------------------------------------------------------
r2856 | oneiros | 2009-07-14 22:51:50 +0200 (Tue, 14 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.h
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c

indent

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul 15 16:27:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 15 Jul 2009 16:27:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090715142727.D4CB4788001@www.metatex.org>

------------------------------------------------------------------------
r2857 | taco | 2009-07-15 13:10:12 +0200 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/luatangle.am
   M /trunk/source/texk/web2c/luatexdir/am/luatex.am
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   A /trunk/source/texk/web2c/luatexdir/luatex.c
   M /trunk/source/texk/web2c/luatexdir/luatex.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/utils/synctex.c

circumvent the  web2c  subsystem

------------------------------------------------------------------------
r2858 | taco | 2009-07-15 13:20:17 +0200 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   D /trunk/source/texk/web2c/luatexdir/luatangle.ch
   D /trunk/source/texk/web2c/luatexdir/luatangle.test
   D /trunk/source/texk/web2c/luatexdir/luatangle.web
   D /trunk/source/texk/web2c/luatexdir/luatex.ch
   D /trunk/source/texk/web2c/luatexdir/luatex.defines
   D /trunk/source/texk/web2c/luatexdir/luatex.web
   D /trunk/source/texk/web2c/luatexdir/luatexextra.in
   D /trunk/source/texk/web2c/luatexdir/makecpool.c

drop obsolete source files

------------------------------------------------------------------------
r2859 | taco | 2009-07-15 14:37:51 +0200 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   D /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/lang/hyphen.h
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/llanglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   D /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/ocp/ocp.c
   M /trunk/source/texk/web2c/luatexdir/ocp/ocplist.c
   M /trunk/source/texk/web2c/luatexdir/ocp/runocp.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   D /trunk/source/texk/web2c/luatexdir/primitive.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   A /trunk/source/texk/web2c/luatexdir/tex/commands.h (from /trunk/source/texk/web2c/luatexdir/commands.h:2858)
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/directions.c
   M /trunk/source/texk/web2c/luatexdir/tex/errors.c
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/filename.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/nesting.c
   A /trunk/source/texk/web2c/luatexdir/tex/nodes.h (from /trunk/source/texk/web2c/luatexdir/nodes.h:2858)
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   A /trunk/source/texk/web2c/luatexdir/tex/primitive.h (from /trunk/source/texk/web2c/luatexdir/primitive.h:2858)
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.c
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.c
   A /trunk/source/texk/web2c/luatexdir/tex/texmath.h (from /trunk/source/texk/web2c/luatexdir/texmath.h:2858)
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textcodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   D /trunk/source/texk/web2c/luatexdir/texmath.h
   M /trunk/source/texk/web2c/luatexdir/utils/synctex.c
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/web2c/Makefile.in
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure

move some header files around

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul 15 22:27:22 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 15 Jul 2009 22:27:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090715202722.98020788001@www.metatex.org>

------------------------------------------------------------------------
r2860 | taco | 2009-07-15 17:51:22 +0200 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/utils/managed-sa.c
   M /trunk/source/texk/web2c/luatexdir/utils/managed-sa.h

an attempt to squeeze a little bit more speed out of sparse arrays

------------------------------------------------------------------------

From root at www.metatex.org  Thu Jul 16 12:29:03 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 16 Jul 2009 12:29:03 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090716102903.A00C9788001@www.metatex.org>

------------------------------------------------------------------------
r2861 | taco | 2009-07-16 08:26:43 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   D /trunk/source/texk/web2c/luatexdir/tex/nodes.h
   A /trunk/source/texk/web2c/luatexdir/tex/texnodes.h (from /trunk/source/texk/web2c/luatexdir/tex/nodes.h:2860)
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/web2c/Makefile.in
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure

rename nodes.h to texnodes.h

------------------------------------------------------------------------
r2862 | taco | 2009-07-16 08:36:57 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/image/epdf.h
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   D /trunk/source/texk/web2c/luatexdir/ptexmac.h

merge ptexmac.h with ptexlib.h

------------------------------------------------------------------------
r2863 | taco | 2009-07-16 08:53:56 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   D /trunk/source/texk/web2c/luatexdir/tex/math.c
   A /trunk/source/texk/web2c/luatexdir/tex/mlist.h
   A /trunk/source/texk/web2c/luatexdir/tex/texmath.c (from /trunk/source/texk/web2c/luatexdir/tex/math.c:2860)
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.h

create mlist.h and move math.h to texmath.h

------------------------------------------------------------------------
r2864 | taco | 2009-07-16 08:55:10 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c

add a missing break statement in maincontrol

------------------------------------------------------------------------
r2865 | taco | 2009-07-16 11:35:38 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

fix a cur and paste error in make_scripts

------------------------------------------------------------------------
r2866 | taco | 2009-07-16 11:44:18 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c

implement node.tail()

------------------------------------------------------------------------

From root at www.metatex.org  Thu Jul 16 16:27:40 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 16 Jul 2009 16:27:40 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090716142740.B2AE3788001@www.metatex.org>

------------------------------------------------------------------------
r2867 | taco | 2009-07-16 12:51:07 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/luatex.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.c

fix the ptexbanner, and stop printing the Web2c version

------------------------------------------------------------------------
r2868 | taco | 2009-07-16 13:20:03 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/luatex-api.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h

move tokenlist_to_cstring to textoken.c

------------------------------------------------------------------------
r2869 | taco | 2009-07-16 13:31:18 +0200 (Thu, 16 Jul 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/tfmofm.c
   M /trunk/source/texk/web2c/luatexdir/font/vfovf.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lua/lcallbacklib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lkpselib.c
   M /trunk/source/texk/web2c/luatexdir/lua/llanglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/llualib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/lua/loslibext.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexiolib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.c
   M /trunk/source/texk/web2c/luatexdir/lua/luastuff.c
   A /trunk/source/texk/web2c/luatexdir/lua/luatex-api.h (from /trunk/source/texk/web2c/luatexdir/luatex-api.h:2868)
   M /trunk/source/texk/web2c/luatexdir/lua/luatex.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   D /trunk/source/texk/web2c/luatexdir/luatex-api.h
   M /trunk/source/texk/web2c/luatexdir/ocp/ocp.c
   M /trunk/source/texk/web2c/luatexdir/ocp/ocplist.c
   M /trunk/source/texk/web2c/luatexdir/ocp/readocp.c
   M /trunk/source/texk/web2c/luatexdir/ocp/runocp.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/filename.c
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/stringpool.c
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.c
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textcodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/utils/managed-sa.c

move luatex-api.h to lua/luatex-api.h, and remove the #include
from all source files that only had it by accident or because 
of tokenlist_to_cstring.

------------------------------------------------------------------------
r2870 | taco | 2009-07-16 13:46:18 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/font/pkin.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   A /trunk/source/texk/web2c/luatexdir/tex/filename.h
   A /trunk/source/texk/web2c/luatexdir/tex/mathcodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.h
   A /trunk/source/texk/web2c/luatexdir/tex/texdeffont.h
   A /trunk/source/texk/web2c/luatexdir/tex/textcodes.h

add four more headers for completeness' sake

------------------------------------------------------------------------
r2871 | oneiros | 2009-07-16 15:51:16 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/libpng/ChangeLog
   M /trunk/source/libs/libpng/Makefile.in
   M /trunk/source/libs/libpng/configure
   M /trunk/source/libs/libpng/configure.ac
   D /trunk/source/libs/libpng/libpng-1.2.37
   A /trunk/source/libs/libpng/libpng-1.2.38 (from /trunk/source/libs/libpng/libpng-1.2.37:2870)
   M /trunk/source/libs/libpng/libpng-1.2.38/ANNOUNCE
   M /trunk/source/libs/libpng/libpng-1.2.38/CHANGES
   M /trunk/source/libs/libpng/libpng-1.2.38/INSTALL
   M /trunk/source/libs/libpng/libpng-1.2.38/KNOWNBUG
   M /trunk/source/libs/libpng/libpng-1.2.38/LICENSE
   M /trunk/source/libs/libpng/libpng-1.2.38/Makefile.am
   M /trunk/source/libs/libpng/libpng-1.2.38/Makefile.in
   M /trunk/source/libs/libpng/libpng-1.2.38/README
   M /trunk/source/libs/libpng/libpng-1.2.38/TODO
   M /trunk/source/libs/libpng/libpng-1.2.38/Y2KINFO
   M /trunk/source/libs/libpng/libpng-1.2.38/config.guess
   M /trunk/source/libs/libpng/libpng-1.2.38/config.sub
   M /trunk/source/libs/libpng/libpng-1.2.38/configure
   M /trunk/source/libs/libpng/libpng-1.2.38/configure.ac
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/pngminim/decoder/pngusr.h
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/pngminim/encoder/pngusr.h
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/pngminim/preader/pngusr.h
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/visupng/PngFile.c
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/visupng/PngFile.h
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/visupng/README.txt
   M /trunk/source/libs/libpng/libpng-1.2.38/contrib/visupng/VisualPng.c
   M /trunk/source/libs/libpng/libpng-1.2.38/depcomp
   M /trunk/source/libs/libpng/libpng-1.2.38/install-sh
   D /trunk/source/libs/libpng/libpng-1.2.38/libpng-1.2.37.txt
   A /trunk/source/libs/libpng/libpng-1.2.38/libpng-1.2.38.txt (from /trunk/source/libs/libpng/libpng-1.2.37/libpng-1.2.37.txt:2870)
   M /trunk/source/libs/libpng/libpng-1.2.38/libpng.3
   M /trunk/source/libs/libpng/libpng-1.2.38/libpngpf.3
   M /trunk/source/libs/libpng/libpng-1.2.38/ltmain.sh
   M /trunk/source/libs/libpng/libpng-1.2.38/missing
   M /trunk/source/libs/libpng/libpng-1.2.38/mkinstalldirs
   M /trunk/source/libs/libpng/libpng-1.2.38/png.5
   M /trunk/source/libs/libpng/libpng-1.2.38/png.c
   M /trunk/source/libs/libpng/libpng-1.2.38/png.h
   M /trunk/source/libs/libpng/libpng-1.2.38/pngconf.h
   M /trunk/source/libs/libpng/libpng-1.2.38/pngerror.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngget.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngmem.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngpread.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngread.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngrio.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngrtran.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngrutil.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngset.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngtest.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngtrans.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngwio.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngwrite.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngwtran.c
   M /trunk/source/libs/libpng/libpng-1.2.38/pngwutil.c
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/CMakeLists.txt
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/libpng-config-head.in
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/libpng-config.in
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/libpng.icc
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/libpng.pc.in
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.32sunu
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.64sunu
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.aix
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.amiga
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.atari
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.beos
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.cygwin
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.darwin
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.dec
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.dj2
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.elf
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.freebsd
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.gcc
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.gcmmx
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.hp64
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.hpgcc
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.hpux
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.ibmc
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.intel
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.knr
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.linux
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.mingw
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.mips
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.msc
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.ne12bsd
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.netbsd
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.nommx
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.openbsd
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.os2
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.sco
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.sggcc
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.sgi
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.so9
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.solaris
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.solaris-x86
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.std
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.sunos
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.vcawin32
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.vcwin32
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/makefile.watcom
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/pngos2.def
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/pngw32.def
   M /trunk/source/libs/libpng/libpng-1.2.38/scripts/smakefile.ppc

libpng 1.2.38

------------------------------------------------------------------------
r2872 | taco | 2009-07-16 16:04:41 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

allow \relax inbetween attr and dir box attributes

------------------------------------------------------------------------

From root at www.metatex.org  Thu Jul 16 22:27:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 16 Jul 2009 22:27:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090716202727.7A96A788001@www.metatex.org>

------------------------------------------------------------------------
r2873 | taco | 2009-07-16 16:19:42 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/NEWS

prepare for 0.42.0 - tomorrow

------------------------------------------------------------------------
r2874 | taco | 2009-07-16 16:56:02 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfimage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c

dont do statements until the variable list is complete

------------------------------------------------------------------------
r2875 | taco | 2009-07-16 17:29:20 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.c

fix a bad trace message

------------------------------------------------------------------------
r2876 | oneiros | 2009-07-16 20:26:12 +0200 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/build.sh

extra warning flag for c99-declarations

------------------------------------------------------------------------

From root at www.metatex.org  Fri Jul 17 12:31:41 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 17 Jul 2009 12:31:41 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090717103141.9A197788001@www.metatex.org>

------------------------------------------------------------------------
r2877 | taco | 2009-07-17 10:42:02 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c

forgot to update the tail pointer after make_accent()

------------------------------------------------------------------------
r2878 | taco | 2009-07-17 10:58:30 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c

fix the addition of newlines if the selector is term_only

------------------------------------------------------------------------
r2879 | taco | 2009-07-17 11:26:56 +0200 (Fri, 17 Jul 2009) | 6 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c

Should check the catcode of buffer[1] against the escape_cmd,
not agains the actual escape char
-- This line, and those below, will be ignored--

M    source/texk/web2c/luatexdir/tex/mainbody.c

------------------------------------------------------------------------
r2880 | taco | 2009-07-17 11:37:34 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf

new manual

------------------------------------------------------------------------
r2881 | taco | 2009-07-17 11:44:15 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/README

small wording changes

------------------------------------------------------------------------
r2882 | taco | 2009-07-17 11:47:18 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   A /tags/0.42.0 (from /trunk:2881)

new tag for beta release

------------------------------------------------------------------------

From taco at elvenkind.com  Fri Jul 17 12:31:56 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 17 Jul 2009 12:31:56 +0200
Subject: [Dev-luatex] Luatex 0.42.0 (a snapshot release)
Message-ID: <4A60531C.20502@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.42.0.

NOTE: This snapshot is just for testing the new sources and the
updated build process, do NOT trust this binary for production work!


There is a whole lot of work done on the luatex internals since the
previous beta, and just judging by the amount of work done it seems
likely that there will be a few serious bugs remaining. There are two
big internal changes. Both changes are invisible to the user, but
definately worth mentioning:

* There is no pascal (web) code in luatex at all anymore, everything
  is now converted into plain C and split over about 50 source files.
  Later, this code will be converted back to CWEB (almost all comments
  have been kept) but first we want to spend a few months reorganizing
  the code base.

* The PDF backend has been reorganized a lot, and most of the global
  variables are not put into a single backend structure. Work in this
  area is not complete, but getting there.


The other newsworthy changes are:

* There is a new node.tail() function

* lua-loaded fonts now support a 'nomath' key to speed up
  loading the lua table.

* A bugfix in the ttf reader for the inclusion backend, and
  (also in the backend) support for treating ttc files by
  pretending they are single ttf fonts (both patches from pdftex)

* Add Khaled Hosny's man page to the repository

* The \pdfcompresslevel is now effectively fixed as soon as
  output to the pdf file has occurred.

* Patched status.filename so that it (nearly) always returns a
  file name.

* fix '\the\delcode' and disable '\the\odelcode', '\the\Udelcode',
  and '\the\Udelcodenum'

* Handle jfifs where either xres or yres is 0 and the other
  res is != 0 (from pdftex)

* The single-argument version of lang.hyphenate() was broken.

* Get rid of the \directlua/\latelua number warning.

* The Lua coroutine patch (coco) is now disabled on linux
  powerpc architectures (because it caused crashes)

* Removed obsolete pdftex primitives:
  \pdfoptionalwaysusepdfpagebox
  \pdfoptionpdfinclusionerrorlevel
  \pdfforcepagebox
  \pdfmovechars

* The loading speed of large fonts (especially ttf) via the
  fontloader library, and the inclusion speed for subsetting
  in the backend have both been improved.

* The 'pdf' lua library has been enhanced with various new
  functions, see the manual for details.

* BLT and BRT glyph position fixed.

* Various fixes for synctex offsets.

* Support for exotic font string encodings has been removed
  from the fontloader library.

* The embedded MPlib is now 1.205.

* libpng is now 1.2.38.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

  svn co http://foundry.supelec.fr/svn/luatex/tags/0.42.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco


From mpg at elzevir.fr  Fri Jul 17 13:10:01 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Fri, 17 Jul 2009 13:10:01 +0200
Subject: [Dev-luatex] String problem with \csname\endcsname
Message-ID: <4A605C09.7000105@elzevir.fr>

Hi,

Here's a small problem with luatex from trunk (notice the missing 'hello' in the
first line):

! \csname\endcsname.
l.2 \errmessage{hello \csname\endcsname}

More generally, print_cs() screws things up when printing null_cs while selector
is new_string, by indirectly calling make_string(). I think the attached patch
solves the problem.

Manuel.

PS: Btw, I wonder about two points in tokenlist_to_cstring()
- why did you comment out printing of \csname\endcsname?
- why is there two times Print_uchar(e) in the definition of Print_esc?

-------------- next part --------------
A non-text attachment was scrubbed...
Name: new_string.patch
Type: text/x-diff
Size: 987 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090717/c344a329/attachment.bin>

From oberdiek at uni-freiburg.de  Fri Jul 17 13:12:15 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri, 17 Jul 2009 13:12:15 +0200
Subject: [Dev-luatex] Luatex 0.42.0 (a snapshot release)
In-Reply-To: <4A60531C.20502@elvenkind.com>
References: <4A60531C.20502@elvenkind.com>
Message-ID: <20090717111215.GA12454@irwin.vpn.uni-freiburg.de>

On Fri, Jul 17, 2009 at 12:31:56PM +0200, Taco Hoekwater wrote:

> * The \pdfcompresslevel is now effectively fixed as soon as
>   output to the pdf file has occurred.

Why? Is there a technical reason?

Sometimes it makes sense to have some parts uncompressed
(e.g. for debugging purposes, ...)

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From taco at elvenkind.com  Fri Jul 17 13:18:41 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 17 Jul 2009 13:18:41 +0200
Subject: [Dev-luatex] [luatex]  Luatex 0.42.0 (a snapshot release)
In-Reply-To: <20090717111215.GA12454@irwin.vpn.uni-freiburg.de>
References: <4A60531C.20502@elvenkind.com>
	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>
Message-ID: <4A605E11.40402@elvenkind.com>

Heiko Oberdiek wrote:
> On Fri, Jul 17, 2009 at 12:31:56PM +0200, Taco Hoekwater wrote:
> 
>> * The \pdfcompresslevel is now effectively fixed as soon as
>>   output to the pdf file has occurred.
> 
> Why? Is there a technical reason?

Yes (-ish). The compression level is now a part of the pdf back-end
structure because with that, the back-end does not have to access
eqtb all the time. It would be possible to do a synchronization
whenever the value in eqtb changes, but:

> Sometimes it makes sense to have some parts uncompressed
> (e.g. for debugging purposes, ...)

You could just be brave and not compress the pdf at all.

Best wishes,
Taco

From taco at elvenkind.com  Fri Jul 17 13:22:16 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 17 Jul 2009 13:22:16 +0200
Subject: [Dev-luatex] String problem with \csname\endcsname
In-Reply-To: <4A605C09.7000105@elzevir.fr>
References: <4A605C09.7000105@elzevir.fr>
Message-ID: <4A605EE8.9080301@elvenkind.com>


Hi Manuel,

Manuel P?gouri?-Gonnard wrote:
> Hi,
> 
> Here's a small problem with luatex from trunk (notice the missing 'hello' in the
> first line):
> 
> ! \csname\endcsname.
> l.2 \errmessage{hello \csname\endcsname}
> 
> More generally, print_cs() screws things up when printing null_cs while selector
> is new_string, by indirectly calling make_string(). I think the attached patch
> solves the problem.

Thanks.

> Manuel.
> 
> PS: Btw, I wonder about two points in tokenlist_to_cstring()
> - why did you comment out printing of \csname\endcsname?
> - why is there two times Print_uchar(e) in the definition of Print_esc?

The function was originally used from some very specific lua code only,
I'll fix that.

Best wishes,
Taco

From oberdiek at uni-freiburg.de  Fri Jul 17 14:11:37 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri, 17 Jul 2009 14:11:37 +0200
Subject: [Dev-luatex] \pdfcompresslevel (was: Luatex 0.42.0 (a snapshot
	release))
In-Reply-To: <4A605E11.40402@elvenkind.com>
References: <4A60531C.20502@elvenkind.com>
	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>
	<4A605E11.40402@elvenkind.com>
Message-ID: <20090717121136.GA13104@irwin.vpn.uni-freiburg.de>

Hello Taco,

On Fri, Jul 17, 2009 at 01:18:41PM +0200, Taco Hoekwater wrote:

> Heiko Oberdiek wrote:
> >On Fri, Jul 17, 2009 at 12:31:56PM +0200, Taco Hoekwater wrote:
> >
> >>* The \pdfcompresslevel is now effectively fixed as soon as
> >>  output to the pdf file has occurred.
> >
> >Why? Is there a technical reason?
> 
> Yes (-ish). The compression level is now a part of the pdf back-end
> structure because with that, the back-end does not have to access
> eqtb all the time. It would be possible to do a synchronization
> whenever the value in eqtb changes, but:
> 
> >Sometimes it makes sense to have some parts uncompressed
> >(e.g. for debugging purposes, ...)
> 
> You could just be brave and not compress the pdf at all.

There can be Metadata Streams in the PDF file (e.g. in the Catalog).
The PDF specification says in "10.2.2 Metadata Streams":

| The contents of a metadata stream is the metadata represented in
| Extensible Markup Language (XML). This information is visible as plain
| text to tools that are not PDF-aware only if the metadata stream is both
| unfiltered and unencrypted.

How can the compression of these streams can be avoided without
having umcompressed anything else?

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From taco at elvenkind.com  Fri Jul 17 15:00:00 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 17 Jul 2009 15:00:00 +0200
Subject: [Dev-luatex] \pdfcompresslevel
In-Reply-To: <20090717121136.GA13104@irwin.vpn.uni-freiburg.de>
References: <4A60531C.20502@elvenkind.com>	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>	<4A605E11.40402@elvenkind.com>
	<20090717121136.GA13104@irwin.vpn.uni-freiburg.de>
Message-ID: <4A6075D0.9010607@elvenkind.com>


Hi,

Heiko Oberdiek wrote:
> There can be Metadata Streams in the PDF file (e.g. in the Catalog).

Ah, I didn't know that. The next release will restore the dynamicness
of \pdfcompresslevel and \pdfobjcompresslevel. (the code is checked in
already).

Best wishes,
Taco



From root at www.metatex.org  Fri Jul 17 16:27:50 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 17 Jul 2009 16:27:50 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090717142750.8418E788001@www.metatex.org>

------------------------------------------------------------------------
r2883 | taco | 2009-07-17 14:33:26 +0200 (Fri, 17 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/ocp/readocp.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c

fix a bunch of issues with text(), get_cs_text() and tokenlist_to_cstring() 
that were reported by Manual 

------------------------------------------------------------------------
r2884 | taco | 2009-07-17 14:56:18 +0200 (Fri, 17 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c

restore dynamic behaviour of \pdfcompresslevel and \pdfobjcompresslevel
and fix a bug in \newlinechar/\endlinechar handling

------------------------------------------------------------------------
r2885 | taco | 2009-07-17 15:16:44 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c

fix a missing backslash

------------------------------------------------------------------------
r2886 | taco | 2009-07-17 15:47:29 +0200 (Fri, 17 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/ocp/ocp.c
   M /trunk/source/texk/web2c/luatexdir/ocp/ocplist.c
   M /trunk/source/texk/web2c/luatexdir/ocp/readocp.c
   M /trunk/source/texk/web2c/luatexdir/ocp/runocp.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/commands.c
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.h
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/expand.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c

put the hash variables in primitive.c and create a global macro
cs_text() to replace various local text() definitions

------------------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Jul 17 16:43:25 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri, 17 Jul 2009 16:43:25 +0200
Subject: [Dev-luatex] \pdfcompresslevel
In-Reply-To: <4A6075D0.9010607@elvenkind.com>
References: <4A60531C.20502@elvenkind.com>
	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>
	<4A605E11.40402@elvenkind.com>
	<20090717121136.GA13104@irwin.vpn.uni-freiburg.de>
	<4A6075D0.9010607@elvenkind.com>
Message-ID: <20090717144325.GA15062@irwin.vpn.uni-freiburg.de>

On Fri, Jul 17, 2009 at 03:00:00PM +0200, Taco Hoekwater wrote:

> Heiko Oberdiek wrote:
> > There can be Metadata Streams in the PDF file (e.g. in the Catalog).
> 
> Ah, I didn't know that. The next release will restore the dynamicness
> of \pdfcompresslevel and \pdfobjcompresslevel. (the code is checked in
> already).

Thanks.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From root at www.metatex.org  Fri Jul 17 22:27:36 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 17 Jul 2009 22:27:36 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090717202736.2D6DA788001@www.metatex.org>

------------------------------------------------------------------------
r2887 | taco | 2009-07-17 18:04:51 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.h
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.h
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.c
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.h

a first attempt at cleaning out mainbody.c

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul 18 12:31:31 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 18 Jul 2009 12:31:31 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090718103131.9BE82788001@www.metatex.org>

------------------------------------------------------------------------
r2888 | taco | 2009-07-17 23:54:11 +0200 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   A /tags/beta-0.42.0 (from /tags/0.42.0:2887)

an extra tag to easy contextgarden's scripts

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul 18 16:27:52 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 18 Jul 2009 16:27:52 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090718142752.96503788001@www.metatex.org>

------------------------------------------------------------------------
r2889 | taco | 2009-07-18 14:39:09 +0200 (Sat, 18 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.h
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.c

reorganize the save_stack macros and some fixes for \showgroups

------------------------------------------------------------------------

From root at www.metatex.org  Sat Jul 18 22:27:47 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 18 Jul 2009 22:27:47 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090718202747.63D3B788001@www.metatex.org>

------------------------------------------------------------------------
r2890 | taco | 2009-07-18 18:14:15 +0200 (Sat, 18 Jul 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c

create a save_record type so that each save_stack entry can have 
a save_type (this will be useful later on, when interfacing to lua
will be implemented)

------------------------------------------------------------------------

From root at www.metatex.org  Sun Jul 19 12:29:30 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 19 Jul 2009 12:29:30 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090719102930.A7FB4788001@www.metatex.org>

------------------------------------------------------------------------
r2891 | taco | 2009-07-19 11:33:16 +0200 (Sun, 19 Jul 2009) | 12 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/commands.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.h

Cleaned up the internal integer parameter stuff by:
* removing the holes in the list that were introduced by 
  the removal of obsolete primitives
* putting a bunch of extra internal strings into the prim 
  hash for the few (omega) entries in eqtb that are not
  actually associated with primitives, so that they can
  be printed using primt_cmd_chr()
* remove the now unnecessary print_param() procedure.
And while at it, removed the avoidable procedure 
print_length_param() as well.


------------------------------------------------------------------------
r2892 | taco | 2009-07-19 11:57:10 +0200 (Sun, 19 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/printing.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

print_skip_param could go away as well

------------------------------------------------------------------------

From root at www.metatex.org  Sun Jul 19 16:27:49 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 19 Jul 2009 16:27:49 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090719142749.8CC41788001@www.metatex.org>

------------------------------------------------------------------------
r2893 | taco | 2009-07-19 14:22:01 +0200 (Sun, 19 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h

cleanup every_eof handling

------------------------------------------------------------------------
r2894 | taco | 2009-07-19 14:29:59 +0200 (Sun, 19 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h

remove duplicate #define

------------------------------------------------------------------------
r2895 | taco | 2009-07-19 15:19:39 +0200 (Sun, 19 Jul 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/tex/buildpage.c
   M /trunk/source/texk/web2c/luatexdir/tex/commands.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/scanning.c
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.c
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

change the internal direction parameters so that they behave nicer
compared to the other internal integer parameters, and fix show_eqtb()
wrt. those direction parameters

------------------------------------------------------------------------
r2896 | taco | 2009-07-19 15:27:36 +0200 (Sun, 19 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c

fix the status.hash_size field

------------------------------------------------------------------------

From root at www.metatex.org  Mon Jul 20 12:29:32 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 20 Jul 2009 12:29:32 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090720102932.97DA7788001@www.metatex.org>

------------------------------------------------------------------------
r2897 | oneiros | 2009-07-20 10:55:27 +0200 (Mon, 20 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/lua/texluac.c

mark some functions as noreturn

------------------------------------------------------------------------

From root at www.metatex.org  Tue Jul 21 12:29:23 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 21 Jul 2009 12:29:23 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090721102923.DFC8C788001@www.metatex.org>

------------------------------------------------------------------------
r2898 | taco | 2009-07-21 08:26:12 +0200 (Tue, 21 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/lua/lcallbacklib.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

A patch to add a process_output_buffer callback, from Manuel P?\195?\169gouri?\195?\169-Gonnard

------------------------------------------------------------------------

From root at www.metatex.org  Wed Jul 22 12:29:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 22 Jul 2009 12:29:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090722102927.C9E8E788001@www.metatex.org>

------------------------------------------------------------------------
r2899 | oneiros | 2009-07-22 01:03:53 +0200 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/image/epdf.h
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/luatex.c
   M /trunk/source/texk/web2c/luatexdir/luatex.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/align.c
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/commands.c
   M /trunk/source/texk/web2c/luatexdir/tex/commands.h
   M /trunk/source/texk/web2c/luatexdir/tex/conditional.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.c
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.c
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.c
   M /trunk/source/texk/web2c/luatexdir/tex/mathcodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.h
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.h
   M /trunk/source/texk/web2c/luatexdir/tex/printing.c
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.h
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/textcodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/utils/managed-sa.c

indent

------------------------------------------------------------------------
r2900 | taco | 2009-07-22 08:17:32 +0200 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.c

fix a typo in an assert

------------------------------------------------------------------------

From vvv at vsu.ru  Wed Jul 22 13:10:09 2009
From: vvv at vsu.ru (Vladimir Volovich)
Date: Wed, 22 Jul 2009 15:10:09 +0400
Subject: [Dev-luatex] \pdfcompresslevel (was: Luatex 0.42.0 (a snapshot
	release))
In-Reply-To: <20090717121136.GA13104@irwin.vpn.uni-freiburg.de> (Heiko
	Oberdiek's message of "Fri\, 17 Jul 2009 14\:11\:37 +0200")
References: <4A60531C.20502@elvenkind.com>
	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>
	<4A605E11.40402@elvenkind.com>
	<20090717121136.GA13104@irwin.vpn.uni-freiburg.de>
Message-ID: <878wih3re6.fsf@vvv.org.vrn.ru>

Hi!

 >>>>> * The \pdfcompresslevel is now effectively fixed as soon as
 >>>>>   output to the pdf file has occurred.

 >>>> Why? Is there a technical reason?

 >> Yes (-ish). The compression level is now a part of the pdf back-end
 >> structure because with that, the back-end does not have to access
 >> eqtb all the time.

 >>> Sometimes it makes sense to have some parts uncompressed
 >>> (e.g. for debugging purposes, ...)

 >> You could just be brave and not compress the pdf at all.

 > There can be Metadata Streams in the PDF file (e.g. in the
 > Catalog).  The PDF specification says in "10.2.2 Metadata Streams":

just a thought - if cleanup for making \pdfcompresslevel static makes
the code simpler ("The compression level is now a part of the pdf back-end
structure ..."), maybe there could be an option in the \pdfobj to force
a particular stream to have no compression, instead of making
\pdfcompresslevel dynamic?

something like \pdfobj stream nocompress ...

Best,
v.

From taco at elvenkind.com  Wed Jul 22 14:07:00 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Jul 2009 14:07:00 +0200
Subject: [Dev-luatex] \pdfcompresslevel
In-Reply-To: <878wih3re6.fsf@vvv.org.vrn.ru>
References: <4A60531C.20502@elvenkind.com>	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>	<4A605E11.40402@elvenkind.com>	<20090717121136.GA13104@irwin.vpn.uni-freiburg.de>
	<878wih3re6.fsf@vvv.org.vrn.ru>
Message-ID: <4A6700E4.1070602@elvenkind.com>



Vladimir Volovich wrote:
> 
> just a thought - if cleanup for making \pdfcompresslevel static makes
> the code simpler ("The compression level is now a part of the pdf back-end
> structure ..."), maybe there could be an option in the \pdfobj to force
> a particular stream to have no compression, instead of making
> \pdfcompresslevel dynamic?

> something like \pdfobj stream nocompress ...

I am thinking of pushing a whatsit into the node stream to control
such settings. That or your solution will become a requirement if
we ever want to move the backend to a separate thread.

Best wishes,
Taco



From pragma at wxs.nl  Wed Jul 22 14:26:04 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 22 Jul 2009 14:26:04 +0200
Subject: [Dev-luatex] \pdfcompresslevel
In-Reply-To: <4A6700E4.1070602@elvenkind.com>
References: <4A60531C.20502@elvenkind.com>	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>	<4A605E11.40402@elvenkind.com>	<20090717121136.GA13104@irwin.vpn.uni-freiburg.de>	<878wih3re6.fsf@vvv.org.vrn.ru>
	<4A6700E4.1070602@elvenkind.com>
Message-ID: <4A67055C.50202@wxs.nl>

Taco Hoekwater wrote:
> 
> Vladimir Volovich wrote:
>> just a thought - if cleanup for making \pdfcompresslevel static makes
>> the code simpler ("The compression level is now a part of the pdf back-end
>> structure ..."), maybe there could be an option in the \pdfobj to force
>> a particular stream to have no compression, instead of making
>> \pdfcompresslevel dynamic?
> 
>> something like \pdfobj stream nocompress ...
> 
> I am thinking of pushing a whatsit into the node stream to control
> such settings. That or your solution will become a requirement if
> we ever want to move the backend to a separate thread.

but it will be a different primitive then as we don't want a such node 
in the document preamble

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From vvv at vsu.ru  Wed Jul 22 14:56:23 2009
From: vvv at vsu.ru (Vladimir Volovich)
Date: Wed, 22 Jul 2009 16:56:23 +0400
Subject: [Dev-luatex] \pdfcompresslevel
In-Reply-To: <4A6700E4.1070602@elvenkind.com> (Taco Hoekwater's message of
	"Wed\, 22 Jul 2009 14\:07\:00 +0200")
References: <4A60531C.20502@elvenkind.com>
	<20090717111215.GA12454@irwin.vpn.uni-freiburg.de>
	<4A605E11.40402@elvenkind.com>
	<20090717121136.GA13104@irwin.vpn.uni-freiburg.de>
	<878wih3re6.fsf@vvv.org.vrn.ru> <4A6700E4.1070602@elvenkind.com>
Message-ID: <87fxco3mh4.fsf@vvv.org.vrn.ru>

"TH" == Taco Hoekwater writes:

 >> just a thought - if cleanup for making \pdfcompresslevel static makes
 >> the code simpler ("The compression level is now a part of the pdf
 >> back-end structure ..."), maybe there could be an option in the
 >> \pdfobj to force a particular stream to have no compression, instead
 >> of making \pdfcompresslevel dynamic?

 >> something like \pdfobj stream nocompress ...

 TH> I am thinking of pushing a whatsit into the node stream to control
 TH> such settings. That or your solution will become a requirement if
 TH> we ever want to move the backend to a separate thread.

if the purpose to disable compression is for debugging, then your
suggestion to "be brave and not compress the pdf at all" is the best
solution.

the rest of the need to prevent compression seems to be for specific
streams such as metadata, where it is enough to use an option in the
\pdfobj, instead of making a more complex approach with whatsit nodes.

Best,
v.

From root at www.metatex.org  Thu Jul 23 12:29:28 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 23 Jul 2009 12:29:28 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090723102928.8702D788001@www.metatex.org>

------------------------------------------------------------------------
r2901 | oneiros | 2009-07-23 01:38:59 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   D /trunk/source/libs/libpng/libpng-1.2.38/config.guess
   D /trunk/source/libs/libpng/libpng-1.2.38/config.sub
   D /trunk/source/libs/libpng/libpng-1.2.38/depcomp
   D /trunk/source/libs/libpng/libpng-1.2.38/install-sh
   D /trunk/source/libs/libpng/libpng-1.2.38/missing
   D /trunk/source/libs/libpng/libpng-1.2.38/mkinstalldirs

rm unused programs

------------------------------------------------------------------------
r2902 | oneiros | 2009-07-23 01:40:27 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/libpng/libpng-1.2.38/png.c

merge change to png.c from TL

------------------------------------------------------------------------
r2903 | oneiros | 2009-07-23 01:42:59 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/libpng/ChangeLog
   M /trunk/source/libs/libpng/Makefile.in
   M /trunk/source/libs/libpng/aclocal.m4
   M /trunk/source/libs/libpng/configure

use libpng from TL

------------------------------------------------------------------------

From root at www.metatex.org  Fri Jul 24 12:29:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 24 Jul 2009 12:29:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090724102927.5804D788001@www.metatex.org>

------------------------------------------------------------------------
r2904 | hhenkel | 2009-07-23 23:19:48 +0200 (Thu, 23 Jul 2009) | 28 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.h
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfrule.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfrule.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.h
   M /trunk/source/texk/web2c/luatexdir/utils/synctex.c

PDF/DVI backend patch:

To reduce the amount of code to care for in parallel for PDF and DVI
output, both output modes are now handled through the same general
hlist_out() and vlist_out() functions, renamed from pdf_h/v_list_out(),
and located in pdflistout.c. The DVI-specific h/vlist_out() functions in
dvigen.c are obsolete. Switching between PDF and DVI backend functions
works through function pointers (Taco's idea); should be extensible to
other backends.

Backend functions for PDF and DVI have been shuffled to have the 
same variable list, needed for the function pointer principle. Some
functions are reorganized, with new names, e. g., dvi_place_glyph() and
dvi_place_rule(), function special_out() is renamed to dvi_special()
corresponding to pdf_special(), function out_what() got pdf pointer
as argument.

Position variable cur is now local, box_pos is gone, as is global pos.
Function do_vf_packet() has been adapted.

For synchronization from cur to pos always function synch_pos_with_cur() 
is used. The synchronization is now done early, so that one should get
a valid pos value without the need to resync. This reduces the number
of required sync_pos_with_cur() instances in the code.

The lua variables (meta-functions) pdf.h and pdf.v should now return
the position on the paper (\latelua).

------------------------------------------------------------------------
r2905 | oneiros | 2009-07-23 23:35:00 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c

indent

------------------------------------------------------------------------
r2906 | oneiros | 2009-07-23 23:35:39 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c

init some variables

------------------------------------------------------------------------
r2907 | oneiros | 2009-07-23 23:36:13 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

indent

------------------------------------------------------------------------
r2908 | oneiros | 2009-07-23 23:39:29 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.c

init some variables

------------------------------------------------------------------------
r2909 | hhenkel | 2009-07-23 23:56:16 +0200 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/dvi/dvigen.c

fix pdf_save_pos_node in out_what()

------------------------------------------------------------------------
r2910 | hhenkel | 2009-07-24 00:14:29 +0200 (Fri, 24 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

use dir_orthogonal()

------------------------------------------------------------------------
r2911 | hhenkel | 2009-07-24 00:25:48 +0200 (Fri, 24 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.c

movement after hrule in a vlist was wrong

------------------------------------------------------------------------

From root at www.metatex.org  Thu Jul 30 22:27:57 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 30 Jul 2009 22:27:57 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090730202757.84F82788001@www.metatex.org>

------------------------------------------------------------------------
r2935 | taco | 2009-07-30 17:31:46 +0200 (Thu, 30 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.h

implement node.dimensions()

------------------------------------------------------------------------
r2936 | taco | 2009-07-30 17:43:43 +0200 (Thu, 30 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/packaging.c

small fix for invalid second node arguments

------------------------------------------------------------------------
r2937 | taco | 2009-07-30 17:45:39 +0200 (Thu, 30 Jul 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

document node.dimensions()

------------------------------------------------------------------------

From root at www.metatex.org  Fri Jul 31 12:29:29 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 31 Jul 2009 12:29:29 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090731102929.ECB71788001@www.metatex.org>

------------------------------------------------------------------------
r2938 | taco | 2009-07-31 09:11:01 +0200 (Fri, 31 Jul 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/texmath.c

fix the display placement as it should be based on \pardir,
not \textdir (thanks, Hartmut!)

------------------------------------------------------------------------
r2939 | taco | 2009-07-31 11:59:03 +0200 (Fri, 31 Jul 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

metapost 1.206

------------------------------------------------------------------------
r2940 | taco | 2009-07-31 11:59:35 +0200 (Fri, 31 Jul 2009) | 2 lines
Changed paths:
   M /branches/0.40.x/source/texk/web2c/mplibdir/mp.w

metapost 1.206

------------------------------------------------------------------------

