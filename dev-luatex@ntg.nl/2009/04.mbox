From taco at elvenkind.com  Wed Apr  1 20:33:16 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 01 Apr 2009 20:33:16 +0200
Subject: [Dev-luatex] Affiliation change
Message-ID: <49D3B36C.4010603@elvenkind.com>


Hello everybody,

This message is to inform you all that as of today, I am no longer an
employee of Elvenkind BV, the company where I have worked for during
the past years.

Working for Elvenkind has been a pleasure, but it has always been
hard for Elvenkind to find enough commercial projects to employ me in.
Even the recent (much appreciated!) funded TeX-development projects
simply do not generate enough revenue for Elvenkind to make it viable
to keep me as an employee in the current economic climate.

This is not the best time to be out of a job, but nevertheless I have
decided to try to make the most of it an attempt to make an old dream
happen: being my own boss.

Since quite some time already I have had a private company called
Bittext that I use for various bits and pieces that simply did not fit
in with Elvenkind's company strategy (its original intent was to place 
my font development work in that company, but it has also been used as
the company behind organizing the ConTeXt Epen meeting in 2007, for
example).

For the development of luatex and metapost, I do not expect that much
to change compared to the current situation: Hans and I will continue
to write funding proposals and we hope that enough of those will be
granted so that I can keep that development work going much like it is.
(about a 50% commitment working on these two programs in an average
working week).

However, for ConTeXT and other TeX-related things, the situation is a
bit more problematic. Pragma ADE does not have money to fund any
projects, even if I managed to find something to excite Hans that
he couldn't do faster himself ;). To find the missing source of
income, I intend to start giving commercial ConTeXt courses and
I plan to start selling manuals via lulu. Perhaps there is a bit of
consultancy that can be found as well, and I will try to regain some
of my old mathematical typesetting clients.

But I fear that even all of that together will generate enough income
for me to continue developing modules and offering help for free. 
Therefore, the planned bib module replacement will be released as
commercial software, and support for other ConTeXT stuff (like the
current bib module) will become a paid service. Probably via a
subscription website, that will (for example) also host my release
notes. I am brooding on other ConTeXt module ideas that people
may be willing to pay for, and I will finish the font projects
that are still on my disk for sale via my website.

This April (until around BachoTeX) I will still be busy preparing the
luatex and metapost binaries for the TeXlive 2009 deadline, but after
that I will likely drop offline for a while, creating the Bittext 
website ( http://www.bittext.com ) and figuring out things like how to
be on the receiving end of Lulu and PayPal.

Well, that is about all I wanted to say right now. I am quite 
apprehensive about how this news will fall in the ConTeXT community, but
I see no other way. And I must admit that at the same time I am quite
excited about being "in control of my own destiny", as they say!

Best wishes to all of you,

Taco










From taco at elvenkind.com  Thu Apr  2 09:40:26 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 02 Apr 2009 09:40:26 +0200
Subject: [Dev-luatex] [NTG-context] Affiliation change
In-Reply-To: <49D3B36C.4010603@elvenkind.com>
References: <49D3B36C.4010603@elvenkind.com>
Message-ID: <49D46BEA.5060009@elvenkind.com>


Hi,

As Arthur emailed me already: you people are just too gullible ! :)

Taco Hoekwater wrote:
> 
> Hello everybody,
> 
> This message is to inform you all that as of today, I am no longer an
> employee of Elvenkind BV, the company where I have worked for during
> the past years.

This part is true, I am in fact an independant contractor now. Life is
just more fun that way, there is no other reason.

> Working for Elvenkind has been a pleasure, but it has always been
> hard for Elvenkind to find enough commercial projects to employ me in.

false

> Even the recent (much appreciated!) funded TeX-development projects
> simply do not generate enough revenue for Elvenkind to make it viable
> to keep me as an employee in the current economic climate.

false (Elvenkind is doing better than ever, if anything)


> This is not the best time to be out of a job, but nevertheless I have
> decided to try to make the most of it an attempt to make an old dream
> happen: being my own boss.

true

> Since quite some time already I have had a private company called
> Bittext that I use for various bits and pieces that simply did not fit
> in with Elvenkind's company strategy (its original intent was to place 
> my font development work in that company, but it has also been used as
> the company behind organizing the ConTeXt Epen meeting in 2007, for
> example).

true

> For the development of luatex and metapost, I do not expect that much
> to change compared to the current situation: Hans and I will continue
> to write funding proposals and we hope that enough of those will be
> granted so that I can keep that development work going much like it is.
> (about a 50% commitment working on these two programs in an average
> working week).

true

> However, for ConTeXT and other TeX-related things, the situation is a
> bit more problematic. 

false

>                        Pragma ADE does not have money to fund any
> projects, even if I managed to find something to excite Hans that
> he couldn't do faster himself ;). 

true

>                                   To find the missing source of
> income, I intend to start giving commercial ConTeXt courses and

false

> I plan to start selling manuals via lulu. 

false

>                                           Perhaps there is a bit of
> consultancy that can be found as well, 

false

>                                           and I will try to regain some
> of my old mathematical typesetting clients.

false

> But I fear that even all of that together will generate enough income
> for me to continue developing modules and offering help for free. 

false

> Therefore, the planned bib module replacement will be released as
> commercial software, 

false

>                       and support for other ConTeXT stuff (like the
> current bib module) will become a paid service. 

false

>                                                 Probably via a
> subscription website, that will (for example) also host my release
> notes. 

false

>        I am brooding on other ConTeXt module ideas that people
> may be willing to pay for, 

false

>                            and I will finish the font projects
> that are still on my disk for sale via my website.

maybe

> This April (until around BachoTeX) I will still be busy preparing the
> luatex and metapost binaries for the TeXlive 2009 deadline, but after

true

> that I will likely drop offline for a while, 

false

>                                               creating the Bittext 
> website ( http://www.bittext.com ) 

true-ish, that really does need to be done.

>                                    and figuring out things like how to
> be on the receiving end of Lulu and PayPal.

false

> Well, that is about all I wanted to say right now. I am quite 
> apprehensive about how this news will fall in the ConTeXT community, but
> I see no other way. 

false

>                     And I must admit that at the same time I am quite
> excited about being "in control of my own destiny", as they say!

true

Best wishes,
Taco


From root at www.metatex.org  Thu Apr  2 12:27:05 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  2 Apr 2009 12:27:05 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090402102705.701DC1E8C425@www.metatex.org>

------------------------------------------------------------------------
r2196 | hhenkel | 2009-04-02 00:17:25 +0200 (Thu, 02 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

fix TRT/TLT bug reported Wed, 1 Apr 2009 11:26:27 +1100
on luatex at tug.org, Subject: [luatex] Bug In RTL

------------------------------------------------------------------------

From root at www.metatex.org  Fri Apr  3 12:27:07 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri,  3 Apr 2009 12:27:07 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090403102707.3DBC51E8C428@www.metatex.org>

------------------------------------------------------------------------
r2197 | hhenkel | 2009-04-03 00:48:58 +0200 (Fri, 03 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c

calc_pdfpos was very buggy (a wonder that it worked at all)

------------------------------------------------------------------------
r2198 | hhenkel | 2009-04-03 01:25:22 +0200 (Fri, 03 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

cosmetics (better DVI-PDF diff)

------------------------------------------------------------------------

From root at www.metatex.org  Fri Apr  3 16:25:35 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri,  3 Apr 2009 16:25:35 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090403142535.4BBA21E8C428@www.metatex.org>

------------------------------------------------------------------------
r2199 | taco | 2009-04-03 15:05:35 +0200 (Fri, 03 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/luatex-api.h
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web

implement support for a texconfig.init() function that will
be run right after format loading (experimental)

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr  5 12:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun,  5 Apr 2009 12:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090405102841.F00611E8C428@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From root at www.metatex.org  Sun Apr  5 16:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun,  5 Apr 2009 16:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090405142831.3335B1E8C426@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From texworld at laposte.net  Sun Apr  5 21:10:07 2009
From: texworld at laposte.net (TeXWorld)
Date: Sun, 05 Apr 2009 21:10:07 +0200
Subject: [Dev-luatex] Commenting TeX code
Message-ID: <49D9020F.8000300@laposte.net>

Hello,

Lua has the following mechanisms to comment codes:

--

and

--[[   --]].

TeX has % but does not have something like %[[   %]].
It could be useful for one line code.

Jack


From pragma at wxs.nl  Sun Apr  5 22:02:10 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sun, 05 Apr 2009 22:02:10 +0200
Subject: [Dev-luatex] Commenting TeX code
In-Reply-To: <49D9020F.8000300@laposte.net>
References: <49D9020F.8000300@laposte.net>
Message-ID: <49D90E42.4050604@wxs.nl>

TeXWorld wrote:
> Hello,
> 
> Lua has the following mechanisms to comment codes:
> 
> -- 
> 
> and
> 
> --[[   --]].
> 
> TeX has % but does not have something like %[[   %]].
> It could be useful for one line code.

it's quite unlike that any kind of commenting other then the (already 
configurable) % character will end up in the kernel

you can write a lua function that intercept the input and handles such a 
syntax

also, you can write a macro that intercept long comments


Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From root at www.metatex.org  Sun Apr  5 22:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun,  5 Apr 2009 22:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090405202830.C6A7A1E8C428@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From root at www.metatex.org  Mon Apr  6 12:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon,  6 Apr 2009 12:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090406102844.CECB51E8C428@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From root at www.metatex.org  Mon Apr  6 16:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon,  6 Apr 2009 16:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090406142832.7C15B1E8C428@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From root at www.metatex.org  Mon Apr  6 22:26:03 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon,  6 Apr 2009 22:26:03 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090406202603.529371E8C428@www.metatex.org>

------------------------------------------------------------------------
r2200 | taco | 2009-04-06 18:14:56 +0200 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua51/Makefile
   M /trunk/source/texk/web2c/luatexdir/lua51/lapi.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lapi.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lauxlib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lauxlib.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lbaselib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lcoco.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lcoco.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lcode.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lcode.h
   M /trunk/source/texk/web2c/luatexdir/lua51/ldblib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ldebug.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ldebug.h
   M /trunk/source/texk/web2c/luatexdir/lua51/ldo.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ldo.h
   M /trunk/source/texk/web2c/luatexdir/lua51/ldump.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lfunc.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lfunc.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lgc.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lgc.h
   M /trunk/source/texk/web2c/luatexdir/lua51/linit.c
   M /trunk/source/texk/web2c/luatexdir/lua51/liolib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/llex.c
   M /trunk/source/texk/web2c/luatexdir/lua51/llex.h
   M /trunk/source/texk/web2c/luatexdir/lua51/llimits.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lmathlib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lmem.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lmem.h
   M /trunk/source/texk/web2c/luatexdir/lua51/loadlib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lobject.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lobject.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lopcodes.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lopcodes.h
   M /trunk/source/texk/web2c/luatexdir/lua51/loslib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lparser.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lparser.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lstate.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lstate.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lstring.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lstring.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lstrlib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ltable.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ltable.h
   M /trunk/source/texk/web2c/luatexdir/lua51/ltablib.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ltm.c
   M /trunk/source/texk/web2c/luatexdir/lua51/ltm.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lua.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lua.h
   M /trunk/source/texk/web2c/luatexdir/lua51/luaconf.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lualib.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lundump.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lundump.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lvm.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lvm.h
   M /trunk/source/texk/web2c/luatexdir/lua51/lzio.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lzio.h

Update to lua 5.1.4 and coco 1.1.5 

------------------------------------------------------------------------
r2201 | taco | 2009-04-06 18:15:20 +0200 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luapeg/lpeg.c

update to 0.9

------------------------------------------------------------------------
r2202 | taco | 2009-04-06 18:16:17 +0200 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luatex.c

temporarily disable compression

------------------------------------------------------------------------
r2203 | taco | 2009-04-06 18:18:14 +0200 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

update lua component versioins

------------------------------------------------------------------------
r2204 | taco | 2009-04-06 21:25:02 +0200 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

fix system dependency of format files (dump font structure items by field instead of en block)

------------------------------------------------------------------------

From taco at elvenkind.com  Tue Apr  7 10:10:33 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 07 Apr 2009 10:10:33 +0200
Subject: [Dev-luatex] luatex format portability
Message-ID: <49DB0A79.7060807@elvenkind.com>


Hi,

This is a question for people that have powerpc/arm as well as
intel/amd machines and know how to compile the luatex repository
trunk:

Can you please try the latest and see if the luatex formats are
now platform-independent? As of commit 2207 it should be possible
to copy the generated formats from one machine to the other, even
(and especially) the context mkiv format with its internal lua
bytecodes.

I already know that i386 <-> amd64 works, but I am interested in
endianness tests.

Best wishes,
Taco

From root at www.metatex.org  Tue Apr  7 12:27:09 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue,  7 Apr 2009 12:27:09 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090407102710.011231E8C429@www.metatex.org>

------------------------------------------------------------------------
r2205 | taco | 2009-04-07 08:34:30 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c

make scan_keyword() restore cur_cs if it fails (this fixes the error message for runaways)

------------------------------------------------------------------------
r2206 | taco | 2009-04-07 09:11:30 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luatex.c

restore format compression

------------------------------------------------------------------------
r2207 | taco | 2009-04-07 09:37:06 +0200 (Tue, 07 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua51/ldump.c
   M /trunk/source/texk/web2c/luatexdir/lua51/lundump.c

Apply the bytecode independency patch from
https://dev.openwrt.org/browser/trunk/package/lua/patches-host/030-archindependent-bytecode.patch?rev=14631

------------------------------------------------------------------------
r2208 | taco | 2009-04-07 10:02:31 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/build.sh

re-instate the c++ runtime workaround

------------------------------------------------------------------------
r2209 | taco | 2009-04-07 10:58:56 +0200 (Tue, 07 Apr 2009) | 5 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/luatex.web

fix a crash for status.best_page_break in texlua mode, and add:
status.luatex_version (a number)
status.luatex_revision (a string)
status.ini_version (a boolean)

------------------------------------------------------------------------
r2210 | taco | 2009-04-07 11:11:40 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

bump the version to 0.38.0

------------------------------------------------------------------------
r2211 | taco | 2009-04-07 11:11:51 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

fix up the manual

------------------------------------------------------------------------

From root at www.metatex.org  Tue Apr  7 16:25:45 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue,  7 Apr 2009 16:25:45 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090407142545.2472E1E8C428@www.metatex.org>

------------------------------------------------------------------------
r2212 | taco | 2009-04-07 14:19:58 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

Combine the eleven simple noad types into one.

------------------------------------------------------------------------
r2213 | taco | 2009-04-07 14:22:10 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

manual text for the new "noad" node type

------------------------------------------------------------------------
r2214 | taco | 2009-04-07 14:31:28 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/README
   M /trunk/source/libs/xpdf/Makefile.am
   A /trunk/source/libs/xpdf/xpdf-3.02-mingw32.patch
   M /trunk/source/texk/kpathsea/ChangeLog
   M /trunk/source/texk/kpathsea/config.h
   M /trunk/source/texk/kpathsea/doc/bugs.texi
   M /trunk/source/texk/kpathsea/doc/kpathsea.info
   M /trunk/source/texk/kpathsea/doc/kpathsea.texi
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/am/bootstrap.am
   M /trunk/source/texk/web2c/man/ChangeLog
   M /trunk/source/texk/web2c/man/aleph.man

some patched files from texlive

------------------------------------------------------------------------
r2215 | taco | 2009-04-07 14:36:57 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

new manual pdf 

------------------------------------------------------------------------
r2216 | taco | 2009-04-07 15:11:34 +0200 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

fix a math spacing error for under/over/vcenter objects

------------------------------------------------------------------------

From root at www.metatex.org  Tue Apr  7 22:25:34 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue,  7 Apr 2009 22:25:34 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090407202534.744291E8C428@www.metatex.org>

------------------------------------------------------------------------
r2217 | taco | 2009-04-07 17:00:12 +0200 (Tue, 07 Apr 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

fix a math attribute leak in close_math_group and a node leak
in math_radical (degree was never freed). En passant: fix a crash
for bare number as the degree argument of an \Uroot

------------------------------------------------------------------------
r2218 | taco | 2009-04-07 18:15:58 +0200 (Tue, 07 Apr 2009) | 6 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/math.c

This patch implements new primitives
\Usuperscript \Usubscript 
\Ustartmath \Ustopmath 
\Ustartdisplaymath \Ustopdisplaymath
that are aliases of the single character events

------------------------------------------------------------------------

From root at www.metatex.org  Wed Apr  8 12:27:23 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  8 Apr 2009 12:27:23 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090408102723.5A1CE1E8C429@www.metatex.org>

------------------------------------------------------------------------
r2219 | taco | 2009-04-08 12:07:25 +0200 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

add a bit of extra debugging code

------------------------------------------------------------------------
r2220 | taco | 2009-04-08 12:07:55 +0200 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

fix attribute list leaks for \halign, \valign and \vcenter

------------------------------------------------------------------------

From root at www.metatex.org  Wed Apr  8 16:25:43 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  8 Apr 2009 16:25:43 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090408142543.E46CF1E8C429@www.metatex.org>

------------------------------------------------------------------------
r2221 | taco | 2009-04-08 13:57:42 +0200 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c

node.write does not have to copy the node list

------------------------------------------------------------------------
r2222 | taco | 2009-04-08 14:06:12 +0200 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

new manual text

------------------------------------------------------------------------

From root at www.metatex.org  Wed Apr  8 22:25:38 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed,  8 Apr 2009 22:25:38 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090408202538.808841E8C429@www.metatex.org>

------------------------------------------------------------------------
r2223 | oneiros | 2009-04-08 18:57:32 +0200 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua51/lstrlib.c

squash a warning (size_t != int)

------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr  9 12:27:04 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  9 Apr 2009 12:27:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090409102704.E72D11E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2224 | taco | 2009-04-09 11:49:45 +0200 (Thu, 09 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h

support loading and saving of font mathkern data in the internal structures,
and fix a bug in font_shareable() when dealing with font collections

------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr  9 16:25:47 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  9 Apr 2009 16:25:47 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090409142547.3FCC01E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2225 | oneiros | 2009-04-09 15:44:37 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

init a variable

------------------------------------------------------------------------
r2226 | oneiros | 2009-04-09 15:48:56 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

indent

------------------------------------------------------------------------
r2227 | taco | 2009-04-09 16:09:22 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

implement copying of mathkern values

------------------------------------------------------------------------
r2228 | taco | 2009-04-09 16:13:47 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

Implement handling of OT mathkern

------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr  9 22:25:45 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu,  9 Apr 2009 22:25:45 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090409202545.A07B11E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2229 | taco | 2009-04-09 16:27:56 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

document that mathfonts should have a zero space

------------------------------------------------------------------------
r2230 | taco | 2009-04-09 16:34:24 +0200 (Thu, 09 Apr 2009) | 3 lines
Changed paths:
   M /trunk/manual/luatexref-env.tex
   M /trunk/manual/luatexref-t.pdf

improve the bookmarks pane by adding \luatex to the simplified commands,
and a new pdf

------------------------------------------------------------------------
r2231 | taco | 2009-04-09 17:08:35 +0200 (Thu, 09 Apr 2009) | 3 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

document horizontal math script placements and a bit of reorganisation
in the math sectioning

------------------------------------------------------------------------
r2232 | taco | 2009-04-09 18:27:34 +0200 (Thu, 09 Apr 2009) | 3 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

add support for f.MathConstants.SubscriptShiftDownWithSuperscript,
to solve the lack of "sub2" in the opentype math spec

------------------------------------------------------------------------
r2233 | taco | 2009-04-09 19:25:43 +0200 (Thu, 09 Apr 2009) | 4 lines
Changed paths:
   M /trunk/source/Makefile.in
   M /trunk/source/aclocal.m4
   M /trunk/source/configure
   M /trunk/source/libs/Makefile.in
   M /trunk/source/libs/aclocal.m4
   M /trunk/source/libs/dummy/Makefile.in
   M /trunk/source/libs/dummy/aclocal.m4
   M /trunk/source/libs/libpng/Makefile.in
   M /trunk/source/libs/libpng/aclocal.m4
   M /trunk/source/libs/libpng/configure
   M /trunk/source/libs/obsdcompat/Makefile.in
   M /trunk/source/libs/obsdcompat/aclocal.m4
   M /trunk/source/libs/obsdcompat/configure
   M /trunk/source/libs/xpdf/Makefile.in
   M /trunk/source/libs/xpdf/aclocal.m4
   M /trunk/source/libs/xpdf/configure
   M /trunk/source/libs/xpdf/fofi/Makefile.in
   M /trunk/source/libs/xpdf/goo/Makefile.in
   M /trunk/source/libs/xpdf/xpdf/Makefile.in
   M /trunk/source/libs/zlib/Makefile.in
   M /trunk/source/libs/zlib/aclocal.m4
   M /trunk/source/libs/zlib/configure
   M /trunk/source/m4/kpse-cxx-hack.m4
   M /trunk/source/texk/Makefile.in
   M /trunk/source/texk/aclocal.m4
   M /trunk/source/texk/dummy/Makefile.in
   M /trunk/source/texk/dummy/aclocal.m4
   M /trunk/source/texk/kpathsea/Makefile.in
   M /trunk/source/texk/kpathsea/aclocal.m4
   M /trunk/source/texk/kpathsea/configure
   M /trunk/source/texk/kpathsea/doc/Makefile.in
   M /trunk/source/texk/kpathsea/man/Makefile.in
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/web2c/Makefile.in
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure
   M /trunk/source/utils/Makefile.in
   M /trunk/source/utils/aclocal.m4
   M /trunk/source/utils/dummy/Makefile.in
   M /trunk/source/utils/dummy/aclocal.m4

A one-line fix in m4/kpse-cxx-hack.m4 to static cxx runtime compilation
(and a massive autoreconf)


------------------------------------------------------------------------
r2234 | taco | 2009-04-09 19:40:05 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

suppress empty \localleftbox and \localrightbox -es.

------------------------------------------------------------------------
r2235 | taco | 2009-04-09 20:52:42 +0200 (Thu, 09 Apr 2009) | 3 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lua/lcallbacklib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.c
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c

support the use of callback,register('name', false), which disables 
not only the callback but also the code it is supposed to replace

------------------------------------------------------------------------

From oberdiek at uni-freiburg.de  Fri Apr 10 01:16:08 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri, 10 Apr 2009 01:16:08 +0200
Subject: [Dev-luatex] tex.enableprimitives also fails for undefined
	primitives
Message-ID: <20090409231608.GA11129@irwin.vpn.uni-freiburg.de>

Hello,

test file:

\def\msg#{\immediate\write16}
\msg{\meaning\Xpdfoutput}
\begingroup
  \csname Xpdfoutput\endcsname
\endgroup
\msg{\meaning\Xpdfoutput}
\directlua{tex.enableprimitives('X', {'pdfoutput'})}
\msg{\meaning\Xpdfoutput}
\csname @@end\endcsname\end

Result: 3 x "undefined"

After reading the documentation I expected:
  2 x "undefined", 1 x "\pdfoutput"

| Then it will check for the existence of the constructed csname. If the
| csname is currently undefined (note: that is not the same as \relax), it
| will globally define the csname to have the meaning: run code belonging to
| the primitive `name'. If for some reason the csname is already defined, it
| does nothing and tries the next pair.

Either there is a bug in the implementation or in the
description ("is already defined" --> "is or was already defined").

Workaround:
  \directlua{tex.enableprimitives('Workaround', {'pdfoutput'})}
  \global\let\Xpdfoutput\Workaroundpdfoutput

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From oberdiek at uni-freiburg.de  Fri Apr 10 00:52:17 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Fri, 10 Apr 2009 00:52:17 +0200
Subject: [Dev-luatex] \primitive\pdfoutput cannot be queried
Message-ID: <20090409225216.GA9842@irwin.vpn.uni-freiburg.de>

Hello,

AFAIK, an expression with \primitive will become expandable
if and only if the primitive is expandable.
(pdfTeX: \pdfprimitive)

The problem arises with \pdfoutput, a kind of count register.
Therefore it isn't expandable. This doesn't hurt, if \pdfoutput
is set. However it cannot get its value anymore:

  \gdef\pdfoutput{\primitive\pdfoutput}

a) \ifcase\pdfoutput
   fails with
     ! Missing number, treated as zero.
     <to be read again> 
                        \primitive 

b) \ifcase\the\pdfoutput
   fails with
     ! You can't use `\primitive' after \the.

c) \ifcase\number\pdfoutput
   fails with
     ! Missing number, treated as zero.
     <to be read again> 
                        \primitive 

d) \count0=\pdfoutput
   fails with
     ! Missing number, treated as zero.
     <to be read again> 
                        \primitive 

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From taco at elvenkind.com  Fri Apr 10 08:24:58 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 10 Apr 2009 08:24:58 +0200
Subject: [Dev-luatex] tex.enableprimitives also fails for
	undefined	primitives
In-Reply-To: <20090409231608.GA11129@irwin.vpn.uni-freiburg.de>
References: <20090409231608.GA11129@irwin.vpn.uni-freiburg.de>
Message-ID: <49DEE63A.2040208@elvenkind.com>

Heiko Oberdiek wrote:
> | Then it will check for the existence of the constructed csname. If the
> | csname is currently undefined (note: that is not the same as \relax), it
> | will globally define the csname to have the meaning: run code belonging to
> | the primitive `name'. If for some reason the csname is already defined, it
> | does nothing and tries the next pair.
> 
> Either there is a bug in the implementation or in the
> description ("is already defined" --> "is or was already defined").

That was an implementation bug. The fix is in SVN as #2237.

Best wishes,
Taco


From taco at elvenkind.com  Fri Apr 10 09:06:36 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 10 Apr 2009 09:06:36 +0200
Subject: [Dev-luatex] \primitive\pdfoutput cannot be queried
In-Reply-To: <20090409225216.GA9842@irwin.vpn.uni-freiburg.de>
References: <20090409225216.GA9842@irwin.vpn.uni-freiburg.de>
Message-ID: <49DEEFFC.1070407@elvenkind.com>

Heiko Oberdiek wrote:
> Hello,
> 
> AFAIK, an expression with \primitive will become expandable
> if and only if the primitive is expandable.
> (pdfTeX: \pdfprimitive)

I am thinking about this bug.

Best wishes,
Taco

From root at www.metatex.org  Fri Apr 10 12:27:08 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 10 Apr 2009 12:27:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090410102708.D09761E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2236 | oneiros | 2009-04-09 22:32:42 +0200 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

fix warning about uninitialized use

------------------------------------------------------------------------
r2237 | taco | 2009-04-10 08:22:29 +0200 (Fri, 10 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c

fix tex.enableprimitives check on currently undefined, but previously defined,
control sequences names

------------------------------------------------------------------------
r2238 | taco | 2009-04-10 12:11:44 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf

new manual pdf

------------------------------------------------------------------------

From taco at elvenkind.com  Fri Apr 10 12:49:38 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 10 Apr 2009 12:49:38 +0200
Subject: [Dev-luatex] luatex beta 0.38.0
Message-ID: <49DF2442.306@elvenkind.com>

Hi,

I have just uploaded luatex 0.38.0.

This is a beta in the process towards 0.40.0, the version that
will be included in texlive 2009. This beta will be shortlived,
the plan is to release the next (hopefully last) intermediate
beta within a week.

What's new:

* tex.enableprimitives() had a bug were previously defined (but
  currently undefined) control sequences prevented the creation
  of the new csname.

* The special calling format callback.register('name', false)
  not only disables the callback, but also the builtin code it
  is supposed to replace.

* Empty \localleftbox and \localrightbox -es are now suppressed.

* Support for <f>.MathConstants.SubscriptShiftDownWithSuperscript
  was added, to solve the lack of "sub2" in OpenType math.

* Luatex now supports horizontal super- and subscript placement
  corrections via the OpenType MATH mathkern table. See the
  manual for details.

* node.write() no longer copies its argument node list before
  appending it.

* There are six new primitives that are verbose forms
  of one and two byte special tokens:
  \Usuperscript \Usubscript
  \Ustartmath \Ustopmath
  \Ustartdisplaymath \Ustopdisplaymath

* The attribute node leaks in math mode and alignmetns have been
  fixed.

* The 11 simple math noads are now combined into a single "noad"
  node type.

* Static linking against libstdc++ is working once again.

* There is a small fix in the keyword scanner to solve the
  problem of 'Runaway ... while scanning ???' that could happen
  for some primitives.

* Lua now also has the "architecture independent bytecode"
  patch applied.

* Lua is updated to version 5.1.4 with coco patches 1.1.5, and
  lpeg is now 0.9.

* Some TRT/TLT backend bugs are fixed.

* Various manual updates.



The archives (now including source again) can be downloaded from
supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.38.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org

Have fun,
Taco




From root at www.metatex.org  Fri Apr 10 16:28:12 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 10 Apr 2009 16:28:12 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090410142812.21DEE1E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2239 | taco | 2009-04-10 12:30:38 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/NEWS

update the news

------------------------------------------------------------------------
r2240 | taco | 2009-04-10 12:31:38 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   A /tags/beta-0.38.0 (from /trunk:2239)

new tag

------------------------------------------------------------------------
r2241 | taco | 2009-04-10 13:58:50 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /tools/luatextag

this file was updated  for the new build process

------------------------------------------------------------------------
r2242 | oneiros | 2009-04-10 14:09:17 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/xpdf/xpdf-3.02/misc/hello.pdf

fix mine-type

------------------------------------------------------------------------
r2243 | taco | 2009-04-10 15:53:37 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c

additional timing code for debugging purposes

------------------------------------------------------------------------
r2244 | taco | 2009-04-10 15:54:23 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

grow charinfo with 16-at-a-time to improve speed a bit

------------------------------------------------------------------------
r2245 | taco | 2009-04-10 15:55:09 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c

use precompiled strings to improve font loading speed another bit

------------------------------------------------------------------------

From khaledhosny at eglug.org  Fri Apr 10 16:47:34 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Fri, 10 Apr 2009 16:47:34 +0200
Subject: [Dev-luatex] Help with fonts needed
In-Reply-To: <4937CD15.70004@elvenkind.com>
References: <4937CD15.70004@elvenkind.com>
Message-ID: <20090410144734.GB21843@khaled-laptop>

On Thu, Dec 04, 2008 at 01:29:09PM +0100, Taco Hoekwater wrote:
> Hi all,
> 
> * Fonts specifying justification data (OT "JST" | AAT "just")

While playing with the new JSTF table support, I found that Palatino
Linotype font, distributed with windows xp, has JSFT table, I can send
you the font if still needed.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090410/14c31212/attachment.bin>

From root at www.metatex.org  Fri Apr 10 22:25:52 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 10 Apr 2009 22:25:52 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090410202552.9D01E1E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2246 | oneiros | 2009-04-10 20:51:04 +0200 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c

indent

------------------------------------------------------------------------

From root at www.metatex.org  Sat Apr 11 12:27:37 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 11 Apr 2009 12:27:37 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090411102737.BC15F1E8C42C@www.metatex.org>

------------------------------------------------------------------------
r2247 | taco | 2009-04-11 12:16:01 +0200 (Sat, 11 Apr 2009) | 11 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/texpdf.c

* adjust pdf_literal nodes so there is room for type information.
there can now be two types of literals: those created by tex macro 
code are tokenlists, those created in lua code are lua string
references (except in initex, because lua strings are not dumped)
* add a bunch of short new functions to deal with pdf_literal nodes
to luanode.c & ptexlib.h
* convert pdf_room() in the luatex.web to a procedure
* remove some local definitions from lpdflib.c and texpdf.c, thanks
to some new additions to nodes.h


------------------------------------------------------------------------

From root at www.metatex.org  Sat Apr 11 16:25:48 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 11 Apr 2009 16:25:48 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090411142548.1FDE51E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2248 | taco | 2009-04-11 12:34:12 +0200 (Sat, 11 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex-api.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

the prototype for check_texconfig_init was in the wrong header

------------------------------------------------------------------------
r2249 | taco | 2009-04-11 14:48:31 +0200 (Sat, 11 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

do not (un)dump the allocation size helpers charinfo_count and charinfo_size

------------------------------------------------------------------------
r2250 | taco | 2009-04-11 15:48:36 +0200 (Sat, 11 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

fix appearance of (unexandable) \primitive during scan_int and scan_something_internal

------------------------------------------------------------------------
r2251 | taco | 2009-04-11 16:18:23 +0200 (Sat, 11 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

tiny fixes

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr 12 12:27:27 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 12 Apr 2009 12:27:27 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090412102727.AAB921E8C42C@www.metatex.org>

------------------------------------------------------------------------
r2252 | taco | 2009-04-12 10:49:06 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c

fix optimization of math accents in mathlists

------------------------------------------------------------------------
r2253 | taco | 2009-04-12 11:28:50 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

implement large operators as-if they are variable delimiters

------------------------------------------------------------------------
r2254 | taco | 2009-04-12 11:48:22 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

remove the unnecessary function print_math_param()

------------------------------------------------------------------------
r2255 | taco | 2009-04-12 11:51:08 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

remove unnecessary function print_limit_switch()

------------------------------------------------------------------------
r2256 | taco | 2009-04-12 11:53:08 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

remove unnecessary function print_math_comp()

------------------------------------------------------------------------
r2257 | taco | 2009-04-12 12:01:50 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

remove unnecessary command print_style()

------------------------------------------------------------------------
r2258 | taco | 2009-04-12 12:04:12 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

remove unnecessary function print_size()

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr 12 16:26:06 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 12 Apr 2009 16:26:06 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090412142606.BE5AB1E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2259 | taco | 2009-04-12 14:33:29 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/texmfmp.h

add the missing prototype for runsystem()

------------------------------------------------------------------------
r2260 | taco | 2009-04-12 14:34:31 +0200 (Sun, 12 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

fix show_eqtb() and add begin...end around various blocks to get rid of the
remaining 'ambiguous else' compiler warnings

------------------------------------------------------------------------
r2261 | taco | 2009-04-12 15:27:01 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

implement lua math parameter setting and querying (tex.setmath, tex.getmath)

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr 12 22:25:41 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 12 Apr 2009 22:25:41 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090412202541.0668F1E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2262 | hhenkel | 2009-04-12 19:13:00 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

fix reflection in a \hbox

------------------------------------------------------------------------
r2263 | hhenkel | 2009-04-12 19:31:04 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c

add missing void

------------------------------------------------------------------------
r2264 | hhenkel | 2009-04-12 19:54:48 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c
   A /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

new header file pdfpage.h

------------------------------------------------------------------------
r2265 | hhenkel | 2009-04-12 20:06:06 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   A /trunk/source/texk/web2c/luatexdir/pdf/pagetree.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

new header file pagetree.h

------------------------------------------------------------------------
r2266 | oneiros | 2009-04-12 20:21:08 +0200 (Sun, 12 Apr 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pagetree.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h

svn:keywords
fix (c) year
indent

------------------------------------------------------------------------
r2267 | oneiros | 2009-04-12 20:23:21 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pagetree.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h

fix indentation

------------------------------------------------------------------------
r2268 | taco | 2009-04-12 21:05:44 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

remove unused function scan_right_brace

------------------------------------------------------------------------

From root at www.metatex.org  Mon Apr 13 12:27:41 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 13 Apr 2009 12:27:41 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090413102741.BED911E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2269 | hhenkel | 2009-04-12 22:40:30 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c
   A /trunk/source/texk/web2c/luatexdir/font/mapfile.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

new header file mapfile.h

------------------------------------------------------------------------
r2270 | hhenkel | 2009-04-12 22:43:46 +0200 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

cosmetics: remove spurious blanks at 385 luatex.web line ends

------------------------------------------------------------------------
r2271 | oneiros | 2009-04-13 01:42:21 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/NEWS
   M /trunk/source/texk/web2c/luatexdir/README
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/luatexfont.h
   M /trunk/source/texk/web2c/luatexdir/font/macnames.c
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.h
   M /trunk/source/texk/web2c/luatexdir/font/pkin.c
   M /trunk/source/texk/web2c/luatexdir/font/sfnt.c
   M /trunk/source/texk/web2c/luatexdir/font/sfnt.h
   M /trunk/source/texk/web2c/luatexdir/font/subfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/font/tfmofm.c
   M /trunk/source/texk/web2c/luatexdir/font/tounicode.c
   M /trunk/source/texk/web2c/luatexdir/font/tt_glyf.c
   M /trunk/source/texk/web2c/luatexdir/font/tt_glyf.h
   M /trunk/source/texk/web2c/luatexdir/font/tt_table.c
   M /trunk/source/texk/web2c/luatexdir/font/tt_table.h
   M /trunk/source/texk/web2c/luatexdir/font/vfovf.c
   M /trunk/source/texk/web2c/luatexdir/font/vfpacket.c
   M /trunk/source/texk/web2c/luatexdir/font/writecff.c
   M /trunk/source/texk/web2c/luatexdir/font/writecff.h
   M /trunk/source/texk/web2c/luatexdir/font/writeenc.c
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/font/writet3.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.h
   M /trunk/source/texk/web2c/luatexdir/font/writetype0.c
   M /trunk/source/texk/web2c/luatexdir/font/writetype2.c
   M /trunk/source/texk/web2c/luatexdir/hyphen.h
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c
   M /trunk/source/texk/web2c/luatexdir/lua/lcallbacklib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/liolib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lkpselib.c
   M /trunk/source/texk/web2c/luatexdir/lua/llanglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/llualib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/lua/loslibext.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexiolib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.c
   M /trunk/source/texk/web2c/luatexdir/lua/luastuff.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatex.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.c
   M /trunk/source/texk/web2c/luatexdir/lua/texluac.c
   M /trunk/source/texk/web2c/luatexdir/luatangle.ch
   M /trunk/source/texk/web2c/luatexdir/luatangle.web
   M /trunk/source/texk/web2c/luatexdir/luatex-api.h
   M /trunk/source/texk/web2c/luatexdir/luatex.ch
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.h
   M /trunk/source/texk/web2c/luatexdir/luatex.mk
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/luatexextra.in
   M /trunk/source/texk/web2c/luatexdir/luatexlib.mk
   M /trunk/source/texk/web2c/luatexdir/makecpool.c
   M /trunk/source/texk/web2c/luatexdir/managed-sa.c
   M /trunk/source/texk/web2c/luatexdir/managed-sa.h
   M /trunk/source/texk/web2c/luatexdir/mathcodes.c
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/primitive.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/ptexmac.h
   M /trunk/source/texk/web2c/luatexdir/tex/filename.c
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c
   M /trunk/source/texk/web2c/luatexdir/tex/texdeffont.c
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/tex/texpdf.c
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h
   M /trunk/source/texk/web2c/luatexdir/textcodes.c
   M /trunk/source/texk/web2c/luatexdir/tokens.h
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.c
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.h
   M /trunk/source/texk/web2c/luatexdir/utils/writezip.c

the return of svn:keywords

------------------------------------------------------------------------
r2272 | taco | 2009-04-13 11:50:26 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c

fix dir_node leak in ext_do_line_break

------------------------------------------------------------------------
r2273 | taco | 2009-04-13 11:52:04 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c

add debug information for copy_node 

------------------------------------------------------------------------

From root at www.metatex.org  Mon Apr 13 16:25:50 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 13 Apr 2009 16:25:50 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090413142550.3DBBE1E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2274 | taco | 2009-04-13 14:10:20 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c

fix handling of truetype .otf files in the backend

------------------------------------------------------------------------
r2275 | taco | 2009-04-13 14:13:09 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

bump the version to 0.39

------------------------------------------------------------------------
r2276 | taco | 2009-04-13 15:30:10 +0200 (Mon, 13 Apr 2009) | 4 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c

Implements array tex.gbox[], tex.gcount[], tex.gattribute[] etc. that do
global assignments when assigned to. Also cleans up the related functions
and improves the error report a bit.

------------------------------------------------------------------------
r2277 | taco | 2009-04-13 15:38:54 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

experiment with $Id$

------------------------------------------------------------------------
r2278 | taco | 2009-04-13 15:57:20 +0200 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

Starting printing the svn version of luatex.web

------------------------------------------------------------------------

From root at www.metatex.org  Mon Apr 13 22:25:46 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 13 Apr 2009 22:25:46 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090413202546.368261E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2279 | taco | 2009-04-13 16:41:15 +0200 (Mon, 13 Apr 2009) | 5 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

don't bother with mlist_to_hlist when the math list is empty,
or when there is a callback with value -1, but don't forget 
to update vlink(temp_head) in these cases, otherwise there 
can be weird errors later on.

------------------------------------------------------------------------

From root at www.metatex.org  Tue Apr 14 12:27:35 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 14 Apr 2009 12:27:35 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090414102735.9A00D1E8C42B@www.metatex.org>

------------------------------------------------------------------------
r2280 | taco | 2009-04-14 11:49:01 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/commands.h
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/tex/math.c
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c
   M /trunk/source/texk/web2c/luatexdir/texmath.h

Implement \mathstyle and \Ustack

------------------------------------------------------------------------
r2281 | taco | 2009-04-14 11:51:59 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines

silly typo

------------------------------------------------------------------------

From root at www.metatex.org  Tue Apr 14 16:26:06 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 14 Apr 2009 16:26:06 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090414142606.D41311E8C430@www.metatex.org>

------------------------------------------------------------------------
r2282 | taco | 2009-04-14 13:00:47 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c

a different, better implementation of global param settings

------------------------------------------------------------------------
r2283 | taco | 2009-04-14 14:34:20 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

precious patch broke \mathchoices

------------------------------------------------------------------------
r2284 | taco | 2009-04-14 14:58:45 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.c

dont forget to pop the literal string from the lua stack

------------------------------------------------------------------------

From root at www.metatex.org  Tue Apr 14 22:25:47 2009
From: root at www.metatex.org (Cron Daemon)
Date: Tue, 14 Apr 2009 22:25:47 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090414202547.DFA661E8C430@www.metatex.org>

------------------------------------------------------------------------
r2285 | taco | 2009-04-14 16:32:38 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/luatex.am
   D /trunk/source/texk/web2c/luatexdir/mp
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/mplibdir/am/mplib.am
   A /trunk/source/texk/web2c/mplibdir/avl.c
   A /trunk/source/texk/web2c/mplibdir/avl.h
   A /trunk/source/texk/web2c/mplibdir/lmplib.c
   A /trunk/source/texk/web2c/mplibdir/memio.w
   A /trunk/source/texk/web2c/mplibdir/mp.w
   A /trunk/source/texk/web2c/mplibdir/mpost.w
   A /trunk/source/texk/web2c/mplibdir/mpxout.w
   A /trunk/source/texk/web2c/mplibdir/psout.w
   A /trunk/source/texk/web2c/mplibdir/svgout.w
   A /trunk/source/texk/web2c/mplibdir/tfmin.w
   M /trunk/source/texk/web2c/web2c/Makefile.in
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure

merge of external mpost trunk (1.110)

------------------------------------------------------------------------
r2286 | taco | 2009-04-14 17:18:46 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/mplibdir/am/mplib.am

mplib.am was a little broken

------------------------------------------------------------------------
r2287 | taco | 2009-04-14 17:19:18 +0200 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mpxout.w

fix an unlucky label name

------------------------------------------------------------------------

From root at www.metatex.org  Wed Apr 15 12:27:50 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 15 Apr 2009 12:27:50 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090415102750.8F0571E8C431@www.metatex.org>

------------------------------------------------------------------------
r2288 | hhenkel | 2009-04-15 00:56:09 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c

Typo; Derek Noonburg

------------------------------------------------------------------------
r2289 | hhenkel | 2009-04-15 01:33:07 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

manual aspell

------------------------------------------------------------------------
r2290 | hhenkel | 2009-04-15 01:41:11 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

remove TABs and blanks at line ends

------------------------------------------------------------------------

From root at www.metatex.org  Wed Apr 15 16:25:44 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 15 Apr 2009 16:25:44 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090415142544.8C9901E8C431@www.metatex.org>

------------------------------------------------------------------------
r2291 | taco | 2009-04-15 14:46:21 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

reinstate patch for snprintf zero-padding

------------------------------------------------------------------------

From root at www.metatex.org  Wed Apr 15 22:22:01 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 15 Apr 2009 22:22:01 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090415202532.84F4E1E8C431@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': Could not resolve hostname `scm.foundry.supelec.fr': Host not found (http://scm.foundry.supelec.fr)

From taco at elvenkind.com  Wed Apr 15 23:22:09 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 15 Apr 2009 23:22:09 +0200
Subject: [Dev-luatex] luatex beta 0.39.0
Message-ID: <49E65001.6020404@elvenkind.com>

Hi,

I have just uploaded luatex 0.39.0.

This is the last beta before 0.40.0, and we consider it to be
feature complete now. The difference between 0.39.0 and 0.40.0
will be nothing more than a newer version of MPlib, improvements
to the manual, and (probably) a few bugfixes.

What's new:

* iniluatex will from now on start up with only the TeX82 primitives
   and \directlua, everything else has to be bootstrapped via
   tex.enableprimitives(). This change was planned for 0.40.0,
   but *now* is the time to test it.

* A bugfix for \primitive in various expandable contexts,
   and \primitive now generates an error message when the
   argument is not actually a primitive's name.

* There was a bug found in the math accent handling.

* Large math operators are now treated like extensible characters
   in the sense that they can be composed of segments.

* The extra assign- and restore tracing information from eTeX
   had a massive bug because of a dangling else in the pascal web.
   As a side-effect of fixing this bugs, all such potential errors
   in the pascal web have been fixed (for now).

* The math parameters can now be set and queried from lua code
   via the new tex.setmath() and tex.getmath() functions.

* Reflection in a \hbox was broken.

* There was a leak of direction nodes in the paragraph builder.

* The font backend now does a small peek to differentiate
   truetype and postscript style opentype fonts. This fixes
   the "Can't find CFF table" bug for otf's with truetype outlines.

* Parameters and registers can now also be assinged to globally
   from lua (see the manual for details).

* It is now possible to query the current math style while a
   formula is still being constructed by using the new read-only
   value \mathstyle. Associated is the new command \Ustack that
   is to be used as a prefix for {.. \over ..} and friends.
   See the manual for more information.

* The embedded MPLib is brought up to date with the current
   metapost repository (version 1.110 and a few small patches).

* Luatex can now handle two breakpoints inside a single ligature
   (like for the functional word of-f-ice). The solution is not
   perfect yet, but the chance of missed hyphenation points in
   actual documents should now be negligible.

* Some speedups in the font loading code, and in the handling of
   pdf_literal nodes that are set from within Lua code.

* Some source code and manual cleanup, as usual.


The archives can be downloaded from supelec as usual:

         http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

   svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.39.0

Bugs and feature requests can be added to the issue tracker at

        http://tracker.luatex.org


Have fun,
Taco




From root at www.metatex.org  Thu Apr 16 12:30:22 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 16 Apr 2009 12:30:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090416103022.DF2351E8C431@www.metatex.org>

------------------------------------------------------------------------
r2292 | taco | 2009-04-15 18:49:49 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

some small fixes and rewordings

------------------------------------------------------------------------
r2293 | taco | 2009-04-15 18:55:18 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/nodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c

implement handling of two breakpoints in a single ligature (like for ffi)

------------------------------------------------------------------------
r2294 | taco | 2009-04-15 21:40:11 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.c
   M /trunk/source/texk/web2c/luatexdir/tex/postlinebreak.c

fix potential crashes and forget about the third, problematic breakpoint

------------------------------------------------------------------------
r2295 | taco | 2009-04-15 21:52:10 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

error handling added for \primitive

------------------------------------------------------------------------
r2296 | taco | 2009-04-15 22:16:16 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

update the manual

------------------------------------------------------------------------
r2297 | taco | 2009-04-15 22:16:38 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.c

now is the time to disable the extra primitives

------------------------------------------------------------------------
r2298 | taco | 2009-04-15 22:19:41 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

commit the web to get a nice svn revision number

------------------------------------------------------------------------
r2299 | taco | 2009-04-15 22:38:10 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/NEWS

new NEWS

------------------------------------------------------------------------
r2300 | taco | 2009-04-15 22:39:20 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   A /tags/beta-0.39.0 (from /trunk:2299)

new tag

------------------------------------------------------------------------
r2301 | hhenkel | 2009-04-15 23:19:14 +0200 (Wed, 15 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

add some remark about needed \catcode assignments to curly braces

------------------------------------------------------------------------
r2302 | taco | 2009-04-16 09:57:47 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/README
   M /trunk/source/texk/README
   M /trunk/source/texk/web2c/luatexdir/ChangeLog
   M /trunk/source/texk/web2c/texmfmp.h

A few small updates coming from texlive

------------------------------------------------------------------------
r2303 | taco | 2009-04-16 11:10:56 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

fix ugly mess on pages 79-82 (there were two \NC's missing)

------------------------------------------------------------------------
r2304 | oneiros | 2009-04-16 11:37:55 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

rm unused variable

------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr 16 16:25:58 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 16 Apr 2009 16:25:58 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090416142559.025331E8C431@www.metatex.org>

------------------------------------------------------------------------
r2305 | taco | 2009-04-16 16:15:05 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/utils/synctex.c

remove synctex compiler warnings

------------------------------------------------------------------------

From preining at logic.at  Thu Apr 16 18:42:51 2009
From: preining at logic.at (Norbert Preining)
Date: Thu, 16 Apr 2009 18:42:51 +0200
Subject: [Dev-luatex] Building luatex with poppler
Message-ID: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>

Hi all,

for Debian I have adjusted the libpoppler patch for luatex. Thanks to
the work of Peter it is getting easier and easier, and AFAIS the patch
for TeX Live itself well shrink, too.

Besides the code change (which is rather minimal), the patch to the
Makefile.in and configure is as follows:

Index: luatex-0.39.0/source/configure
===================================================================
--- luatex-0.39.0.orig/source/configure	2009-04-16 18:11:31.000000000 +0200
+++ luatex-0.39.0/source/configure	2009-04-16 18:11:59.000000000 +0200
@@ -2387,7 +2387,7 @@
 esac
 
 test "x$enable_pdftex" = xno || {
-  need_xpdf=yes
+  need_xpdf=no
   need_libpng=yes
   need_obsdcompat=yes
 }
@@ -2401,7 +2401,7 @@
 esac
 
 test "x$enable_luatex" = xno || {
-  need_xpdf=yes
+  need_xpdf=no
   need_libpng=yes
   need_obsdcompat=yes
 }
@@ -2415,7 +2415,7 @@
 esac
 
 test "x$enable_xetex" = xno || {
-  need_xpdf=yes
+  need_xpdf=no
   need_libpng=yes
   need_freetype2=yes
 }

Index: luatex-0.39.0/source/texk/web2c/Makefile.in
===================================================================
--- luatex-0.39.0.orig/source/texk/web2c/Makefile.in	2009-04-16 18:11:31.000000000 +0200
+++ luatex-0.39.0/source/texk/web2c/Makefile.in	2009-04-16 18:11:59.000000000 +0200
@@ -872,10 +872,10 @@
 	-I$(srcdir)/mplibdir -Dextra_version_info=`date +-%Y%m%d%H`
 luatex_ldadd = libluatex.a libff.a libluamisc.a libzzip.a \
 	libluasocket.a liblua51.a $(LIBPNG_LIBS) $(ZLIB_LIBS) \
-	$(XPDF_LIBS) $(OBSDCOMPAT_LIBS) libmd5.a libmplib.a
+	-lpoppler $(OBSDCOMPAT_LIBS) libmd5.a libmplib.a
 luatex_LDADD = $(luatex_ldadd) $(LDADD) $(socketlibs)
 luatex_DEPENDENCIES = $(proglib) libluatex.a $(LIBPNG_DEPEND) \
-	$(ZLIB_DEPEND) $(XPDF_DEPEND) $(OBSDCOMPAT_DEPEND) libmd5.a
+	$(ZLIB_DEPEND) $(OBSDCOMPAT_DEPEND) libmd5.a
 luatex_c_h = luatexini.c luatex0.c luatexcoerce.h luatexd.h
 nodist_luatex_SOURCES = $(luatex_c_h) luatex-pool.c luatexextra.c luatexdir/luatexextra.h
 luatex_sources = luatexdir/luatex.web luatexdir/luatex.ch
@@ -1149,11 +1149,13 @@
     luatexdir/luafontloader/src/ffdummies.c \
     luatexdir/luafontloader/src/luafflib.c
 
+POPPLERVERSION=`pkg-config --modversion poppler`
+
 libluatex_a_DEPENDENCIES = libff.a
 libluatex_a_CPPFLAGS = $(ZLIB_INCLUDES) $(LIBPNG_INCLUDES) \
-	$(XPDF_INCLUDES) $(OBSDCOMPAT_INCLUDES) -I$(srcdir)/libmd5 \
+	-I/usr/include/poppler $(OBSDCOMPAT_INCLUDES) -I$(srcdir)/libmd5 \
 	-Iluatexdir -I$(srcdir)/luatexdir -I$(srcdir)/luatexdir/lua51 \
-	-DpdfTeX
+	-DpdfTeX -DPOPPLERVERSION=\"$(POPPLERVERSION)\"
 libluatex_a_SOURCES = \
 	luatexdir/commands.h  \
 	luatexdir/font/dofont.c  \


The magic with POPPLERVERSION is only necessary because the poppler
library does not support getting the current built version from the
header files, so I have to set it like that for the output in 
source/texk/web2c/luatexdir/utils/utils.c.



Now two things:
1) is there any chance to make that even simpler? I mean if one selects
   --with-poppler we would only have to change the value of
	XPDF_LIBS to -lpoppler
   and
	XPDF_DEPEND to nothing
   (because poppler would be always system wide)
   and
	XPDF_INCLUDES to something given with --with-poppler-include
   Whether the need_xpdf is set to true/false I do not know if it makes 
   any difference.

2) Concerning system libpng: Most things work out of the box if one
   gives
	--with-system-png
   but in source/texk/web2c/luatexdir/image/image.h there is a
	#  include <../libpng/png.h>
   which has to be changed to
	#  include <png.h>
   Taco, any chance to fix that in one or the other way?


In any case, big thanks to all for the nice work.

For completeness, the diffstat of the libpoppler patch:
 source/configure                               |    6 +--
 source/texk/web2c/Makefile.in                  |   10 +++---
	both shown above
 source/texk/web2c/luatexdir/image/pdftoepdf.cc |   39 ++++++++++++-------------
	only header changes and 4 times GString -> GooString
 source/texk/web2c/luatexdir/luatexextra.in     |    2 -
	adjustment of the bannder adding "... using libpoppler"
 source/texk/web2c/luatexdir/utils/utils.c      |    6 +--
	one header change
		#include "xpdf/config.h" 
	to
		#include "poppler/poppler-config.h"
	and replacing xpdfVersion with POPPLERVERSION

That is all.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
ZEAL MONACHORUM (n.)
(Skiing term.) To ski with 'zeal monachorum' is to descend the top
three quarters of the mountain in a quivering blue funk, but on
arriving at the gentle bit just in front of the restaurant to whizz to
a stop like a victorious slalom-champion.
                        --- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Thu Apr 16 19:43:23 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 16 Apr 2009 19:43:23 +0200
Subject: [Dev-luatex] Building luatex with poppler
In-Reply-To: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
References: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
Message-ID: <49E76E3B.2090003@elvenkind.com>

Norbert Preining wrote:
> 
> Now two things:
> 1) is there any chance to make that even simpler? I mean if one selects
>    --with-poppler we would only have to change the value of
> 	XPDF_LIBS to -lpoppler
>    and
> 	XPDF_DEPEND to nothing
>    (because poppler would be always system wide)
>    and
> 	XPDF_INCLUDES to something given with --with-poppler-include
>    Whether the need_xpdf is set to true/false I do not know if it makes 
>    any difference.

This is beyond my knowledge of autoconf.

> 2) Concerning system libpng: Most things work out of the box if one
>    gives
> 	--with-system-png
>    but in source/texk/web2c/luatexdir/image/image.h there is a
> 	#  include <../libpng/png.h>
>    which has to be changed to
> 	#  include <png.h>
>    Taco, any chance to fix that in one or the other way?

Changed in commit #12735

Best wishes,
Taco

From preining at logic.at  Thu Apr 16 19:46:14 2009
From: preining at logic.at (Norbert Preining)
Date: Thu, 16 Apr 2009 19:46:14 +0200
Subject: [Dev-luatex] Building luatex with poppler
In-Reply-To: <49E76E3B.2090003@elvenkind.com>
References: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
	<49E76E3B.2090003@elvenkind.com>
Message-ID: <20090416174614.GB31097@gamma.logic.tuwien.ac.at>

On Do, 16 Apr 2009, Taco Hoekwater wrote:
> >	#  include <png.h>
> 
> Changed in commit #12735

Thanks, I guess you have checked that it still compiles and finds png.h
with the shipped libpng?

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
BEDFONT
A lurching sensation in the pit of the stomach experienced at
breakfast in a hotel, occasioned by the realisation that it is about
now that the chamber-maid will have discovered the embarrassing stain
on your bottom sheet.
			--- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Thu Apr 16 19:46:59 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 16 Apr 2009 19:46:59 +0200
Subject: [Dev-luatex] Building luatex with poppler
In-Reply-To: <20090416174614.GB31097@gamma.logic.tuwien.ac.at>
References: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
	<49E76E3B.2090003@elvenkind.com>
	<20090416174614.GB31097@gamma.logic.tuwien.ac.at>
Message-ID: <49E76F13.7020001@elvenkind.com>

Norbert Preining wrote:
> On Do, 16 Apr 2009, Taco Hoekwater wrote:
>>> 	#  include <png.h>
>> Changed in commit #12735
> 
> Thanks, I guess you have checked that it still compiles and finds png.h
> with the shipped libpng?

Yes, and it does.

Best wishes,
Taco


From root at www.metatex.org  Thu Apr 16 22:25:55 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 16 Apr 2009 22:25:55 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090416202555.DC7051E8C431@www.metatex.org>

------------------------------------------------------------------------
r2306 | taco | 2009-04-16 17:01:45 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c
   M /trunk/source/texk/web2c/luatexdir/font/subfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/font/tfmofm.c
   M /trunk/source/texk/web2c/luatexdir/font/tounicode.c
   M /trunk/source/texk/web2c/luatexdir/font/writeenc.c
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c
   M /trunk/source/texk/web2c/luatexdir/font/writet1.c
   M /trunk/source/texk/web2c/luatexdir/font/writettf.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.c
   M /trunk/source/texk/web2c/luatexdir/image/writepng.c
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lstatslib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltokenlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatex.c
   M /trunk/source/texk/web2c/luatexdir/luaprofiler/core_profiler.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/pdf/pagetree.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.c

patch various bits of libluatex to remove compiler warnings

------------------------------------------------------------------------
r2307 | taco | 2009-04-16 19:37:31 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/image.h

no need to force a local <png.h> any more

------------------------------------------------------------------------

From root at www.metatex.org  Fri Apr 17 12:27:49 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 17 Apr 2009 12:27:49 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090417102749.A3B801E8C431@www.metatex.org>

------------------------------------------------------------------------
r2308 | oneiros | 2009-04-16 23:30:19 +0200 (Thu, 16 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/xpdf/Makefile.am
   M /trunk/source/libs/xpdf/Makefile.in
   M /trunk/source/libs/xpdf/xpdf-3.02-pdftex.patch
   A /trunk/source/libs/xpdf/xpdf-3.02-pl3.patch

xpdf-3.02-pl3

------------------------------------------------------------------------
r2309 | taco | 2009-04-17 09:27:18 +0200 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/ChangeLog
   M /trunk/source/texk/web2c/luatexdir/ChangeLog
   M /trunk/source/texk/web2c/texmfmp.h

new files from texlive

------------------------------------------------------------------------
r2310 | taco | 2009-04-17 10:03:45 +0200 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c

remove the need for an explicit progname

------------------------------------------------------------------------

From dak at gnu.org  Fri Apr 17 14:51:42 2009
From: dak at gnu.org (David Kastrup)
Date: Fri, 17 Apr 2009 14:51:42 +0200
Subject: [Dev-luatex] Implementing \pdfmatch via LPEG - opinions?
Message-ID: <864ownxx29.fsf@lola.quinscape.zz>


Hi,

I am pondering using \pdfmatch for some application that might
eventually be migrated to LuaTeX.  My scraps of half-knowledge right of
the top of my head indicate that LPEG is compiled into LuaTeX, and that
LPEG contains a module that is able to parse regular expression syntax
into LPEG.

Given those basics, do people see major stumbling blocks for
implementing a mostly compatible \pdfmatch as LuaTeX macros?  If not, I
might just use \pdfmatch in my application and leave the problem of a
LuaTeX based implementation for later.

All the best,

-- 
David Kastrup

From taco at elvenkind.com  Fri Apr 17 15:12:24 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 17 Apr 2009 15:12:24 +0200
Subject: [Dev-luatex] Implementing \pdfmatch via LPEG - opinions?
In-Reply-To: <864ownxx29.fsf@lola.quinscape.zz>
References: <864ownxx29.fsf@lola.quinscape.zz>
Message-ID: <49E88038.7030409@elvenkind.com>



David Kastrup wrote:
> Hi,
> 
> I am pondering using \pdfmatch for some application that might
> eventually be migrated to LuaTeX.  My scraps of half-knowledge right of
> the top of my head indicate that LPEG is compiled into LuaTeX, 

This is 100% true.

> and that LPEG contains a module that is able to parse regular 
> expression syntax into LPEG.

A specific form of regular expression syntax, yes.

  http://www.inf.puc-rio.br/~roberto/lpeg/re.html

But I do not know whether that matches up with libc's regex routines.

Best wishes,
Taco


From dak at gnu.org  Fri Apr 17 15:27:25 2009
From: dak at gnu.org (David Kastrup)
Date: Fri, 17 Apr 2009 15:27:25 +0200
Subject: [Dev-luatex] Implementing \pdfmatch via LPEG - opinions?
In-Reply-To: <49E88038.7030409@elvenkind.com> (Taco Hoekwater's message of
	"Fri, 17 Apr 2009 15:12:24 +0200")
References: <864ownxx29.fsf@lola.quinscape.zz> <49E88038.7030409@elvenkind.com>
Message-ID: <86zlefwgua.fsf@lola.quinscape.zz>

Taco Hoekwater <taco at elvenkind.com> writes:

> David Kastrup wrote:
>> Hi,
>> 
>> I am pondering using \pdfmatch for some application that might
>> eventually be migrated to LuaTeX.  My scraps of half-knowledge right of
>> the top of my head indicate that LPEG is compiled into LuaTeX, 
>
> This is 100% true.
>
>> and that LPEG contains a module that is able to parse regular 
>> expression syntax into LPEG.
>
> A specific form of regular expression syntax, yes.
>
>   http://www.inf.puc-rio.br/~roberto/lpeg/re.html
>
> But I do not know whether that matches up with libc's regex routines.

Uh, no.  That's not really anything close to standard syntax.  Looks
more like a convenience interface than trying to track existing usage.
But standard syntax can probably be translated into that syntax
reasonably well using regular expressions...

Thanks for the pointer,

-- 
David Kastrup

From arthur.reutenauer at normalesup.org  Fri Apr 17 16:15:28 2009
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Fri, 17 Apr 2009 16:15:28 +0200
Subject: [Dev-luatex] Implementing \pdfmatch via LPEG - opinions?
In-Reply-To: <86zlefwgua.fsf@lola.quinscape.zz>
References: <864ownxx29.fsf@lola.quinscape.zz> <49E88038.7030409@elvenkind.com>
	<86zlefwgua.fsf@lola.quinscape.zz>
Message-ID: <20090417141528.GJ28714@phare.normalesup.org>

> But standard syntax can probably be translated into that syntax
> reasonably well using regular expressions...

  If you want to do that, you would probably be better off using lpeg
directly.

	Arthur

From root at www.metatex.org  Fri Apr 17 22:26:00 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 17 Apr 2009 22:26:00 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090417202600.2E2511E8C433@www.metatex.org>

------------------------------------------------------------------------
r2311 | taco | 2009-04-17 16:25:29 +0200 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/mplibdir/lmplib.c
   M /trunk/source/texk/web2c/mplibdir/memio.w
   M /trunk/source/texk/web2c/mplibdir/mp.w
   M /trunk/source/texk/web2c/mplibdir/mpost.w
   M /trunk/source/texk/web2c/mplibdir/mpxout.w
   M /trunk/source/texk/web2c/mplibdir/psout.w
   M /trunk/source/texk/web2c/mplibdir/svgout.w

import the current state of mplib

------------------------------------------------------------------------
r2312 | taco | 2009-04-17 17:43:13 +0200 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/font/luafont.c

put the caching of lua font tables under user control

------------------------------------------------------------------------
r2313 | taco | 2009-04-17 19:33:07 +0200 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c

fix a crash while expanding a font (attempted to copy one charinfo too much)

------------------------------------------------------------------------

From root at www.metatex.org  Sat Apr 18 12:27:43 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 18 Apr 2009 12:27:43 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090418102743.627C31E8C409@www.metatex.org>

------------------------------------------------------------------------
r2314 | hhenkel | 2009-04-17 22:57:48 +0200 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c

fix \textdir in a \hbox dir *** {}

------------------------------------------------------------------------
r2315 | hhenkel | 2009-04-18 01:34:42 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/image.h
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.c
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

clean up writejbig2.c prototypes, static functions

------------------------------------------------------------------------
r2316 | hhenkel | 2009-04-18 02:01:17 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.h

flushjbig2page0objects --> flush_jbig2_page0_objects

------------------------------------------------------------------------
r2317 | hhenkel | 2009-04-18 02:12:18 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/image.h
   M /trunk/source/texk/web2c/luatexdir/image/writepng.c
   A /trunk/source/texk/web2c/luatexdir/image/writepng.h

new writepng.h

------------------------------------------------------------------------
r2318 | hhenkel | 2009-04-18 02:14:21 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writepng.h

wrong filename

------------------------------------------------------------------------
r2319 | taco | 2009-04-18 10:09:34 +0200 (Sat, 18 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

it is cleaner to put the radical_vgap calculation in the font assignment,
even though it means it has to be repeated twice

------------------------------------------------------------------------
r2320 | hhenkel | 2009-04-18 10:52:30 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/epdf.h
   M /trunk/source/texk/web2c/luatexdir/image/image.h
   A /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.h
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   A /trunk/source/texk/web2c/luatexdir/image/writeimg.h
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.h
   M /trunk/source/texk/web2c/luatexdir/image/writejpg.c
   A /trunk/source/texk/web2c/luatexdir/image/writejpg.h
   M /trunk/source/texk/web2c/luatexdir/image/writepng.h
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

arrange header files for image handling

------------------------------------------------------------------------
r2321 | hhenkel | 2009-04-18 11:17:13 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/dofont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.c
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/font/tounicode.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.h
   M /trunk/source/texk/web2c/luatexdir/lua/ltexiolib.c
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luastuff.c
   M /trunk/source/texk/web2c/luatexdir/makecpool.c
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.c
   M /trunk/source/texk/web2c/luatexdir/utils/utils.c

cosmetics/consistency: strnumber --> str_number (but either works)

------------------------------------------------------------------------
r2322 | taco | 2009-04-18 11:50:26 +0200 (Sat, 18 Apr 2009) | 6 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

We may as well do the degree-style parameters at \mathfont2,
because that family has to be initialized anyway. 
-- This line, and those below, will be ignored--

M    trunk/source/texk/web2c/luatexdir/tex/mlist.c

------------------------------------------------------------------------
r2323 | taco | 2009-04-18 11:53:47 +0200 (Sat, 18 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

the manual says we will look at \scriptspace only once,
so it is better to defined the missing parameters globally

------------------------------------------------------------------------

From khaledhosny at eglug.org  Sat Apr 18 16:09:00 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 18 Apr 2009 16:09:00 +0200
Subject: [Dev-luatex] textdir inside boxes
Message-ID: <20090418140900.GA4681@khaled-laptop>

In Aleph, when changin textdir outside a box, the textdir inside the box
is not changed. For example:

\textdir TRT
\setbox0 = \hbox{textdir: \the\textdir , boxdir: \the\boxdir0}
\box0
\bye

In Aleph, bot will remain TLT. However, in Omega textdir inside the box
will get updated to TRT as well. IMO, Omega behaviour makes more sense. 
The current behaviour just make things more complex. I spent several
hours trying to debug why in the following latex example, the second
section number is misplaced:

\documentclass{article}
\begin{document}
\section{Test}
\textdir TRT\pardir TRT
\section{Test}
\end{document}

I turned out that latex buts section number inside an hbox, which is TLT
here.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090418/53ea1686/attachment.bin>

From pragma at wxs.nl  Sat Apr 18 16:19:40 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 18 Apr 2009 16:19:40 +0200
Subject: [Dev-luatex] textdir inside boxes
In-Reply-To: <20090418140900.GA4681@khaled-laptop>
References: <20090418140900.GA4681@khaled-laptop>
Message-ID: <49E9E17C.10807@wxs.nl>

Khaled Hosny wrote:
> In Aleph, when changin textdir outside a box, the textdir inside the box
> is not changed. For example:
> 
> \textdir TRT
> \setbox0 = \hbox{textdir: \the\textdir , boxdir: \the\boxdir0}
> \box0
> \bye
> 
> In Aleph, bot will remain TLT. However, in Omega textdir inside the box
> will get updated to TRT as well. IMO, Omega behaviour makes more sense. 
> The current behaviour just make things more complex. I spent several
> hours trying to debug why in the following latex example, the second
> section number is misplaced:
> 
> \documentclass{article}
> \begin{document}
> \section{Test}
> \textdir TRT\pardir TRT
> \section{Test}
> \end{document}
> 
> I turned out that latex buts section number inside an hbox, which is TLT
> here.

i can imagine it being configurable behaviour, something 
\inherittextdir=0/1  because there are quite some places in 
macropackages where boxing is used in a way that even in rtl assumes ltr 
packing; explicitly making all these boxes TLT then is a lot of work

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From hartmut_henkel at gmx.de  Sat Apr 18 16:22:32 2009
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Sat, 18 Apr 2009 16:22:32 +0200 (CEST)
Subject: [Dev-luatex] textdir inside boxes
In-Reply-To: <20090418140900.GA4681@khaled-laptop>
References: <20090418140900.GA4681@khaled-laptop>
Message-ID: <alpine.DEB.1.00.0904181621330.20951@hahepc1.hahe>

On Sat, 18 Apr 2009, Khaled Hosny wrote:

> In Aleph, when changin textdir outside a box, the textdir inside the box
> is not changed. For example:
>
> \textdir TRT
> \setbox0 = \hbox{textdir: \the\textdir , boxdir: \the\boxdir0}
> \box0
> \bye
>
> In Aleph, bot will remain TLT. However, in Omega textdir inside the
> box will get updated to TRT as well. IMO, Omega behaviour makes more
> sense. The current behaviour just make things more complex. I spent
> several hours trying to debug why in the following latex example, the
> second section number is misplaced:
>
> \documentclass{article}
> \begin{document}
> \section{Test}
> \textdir TRT\pardir TRT
> \section{Test}
> \end{document}
>
> I turned out that latex buts section number inside an hbox, which is
> TLT here.

please check current svn luatex, we had this topics a few days before,
it should now be more consistent.

Regards, Hartmut

From root at www.metatex.org  Sat Apr 18 16:25:56 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 18 Apr 2009 16:25:56 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090418142556.4E3D61E8C409@www.metatex.org>

------------------------------------------------------------------------
r2324 | hhenkel | 2009-04-18 12:27:44 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.defines
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/utils/utils.c
   A /trunk/source/texk/web2c/luatexdir/utils/utils.h

new header file utils.h

------------------------------------------------------------------------
r2325 | hhenkel | 2009-04-18 13:24:38 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.cc
   M /trunk/source/texk/web2c/luatexdir/pdf/pagetree.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.c
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.h

clean up avlstuff.c and avlstuf.h a bit

------------------------------------------------------------------------
r2326 | hhenkel | 2009-04-18 14:20:27 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.h
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/ptexmac.h

move mapfile related macros from ptexmac.h to mapfile.h

------------------------------------------------------------------------
r2327 | hhenkel | 2009-04-18 14:47:21 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.h
   M /trunk/source/texk/web2c/luatexdir/image/epdf.h
   M /trunk/source/texk/web2c/luatexdir/image/image.h
   M /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.h
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.h
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.h
   M /trunk/source/texk/web2c/luatexdir/image/writejpg.h
   M /trunk/source/texk/web2c/luatexdir/image/writepng.h

SVN Id for header files

------------------------------------------------------------------------
r2328 | hhenkel | 2009-04-18 14:50:26 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.h
   M /trunk/source/texk/web2c/luatexdir/utils/utils.h

more svn:keywords

------------------------------------------------------------------------

From texworld at laposte.net  Sat Apr 18 16:48:59 2009
From: texworld at laposte.net (TeXWorld)
Date: Sat, 18 Apr 2009 16:48:59 +0200
Subject: [Dev-luatex] A native support for SVG
In-Reply-To: <48688BF6.8000404@wxs.nl>
References: <4867E762.4040902@laposte.net> <48688BF6.8000404@wxs.nl>
Message-ID: <49E9E85B.5000601@laposte.net>

Hans Hagen a ?crit :
>
> TeXWorld wrote:
>> Hello,
>>
>> I'm a ConTeXt (and LaTeX too) user. When I want to make a vector 
>> picture, I'm trying most of the time to use programs who can export 
>> PGF/TikZ or PStricks.
>> A lot of users like me don't "program" their vector pictures and use 
>> wysiwyg programs like Inkscape or Illustrator to generate PStricks ou 
>> PGF/TikZ code. Of course whatever program used, we can
>> find a SVG export. SVG is the most spread and the most used format to 
>> store vector pictures.
>>
>> I request a native support for SVG in XeTeX and in LuaTeX, I think it 
>> would be a great thing.
>> Of course when I want to include SVG pictures in my documents I can 
>> convert them to pdf before but the problem is that labels and texts 
>> won't be compiled : fonts will be wrong.
>>
>> What do you think about this ? Do you think it's something possible ?
>
> it would involve parsing of the svg code and that's real low on my 
> agenda (svg is not my favourite format with all this data in 
> attributes while actually it should in element and properly structured)
>
> Hans
Hello everybody, hello Hans,

I was reading this old message I posted about ten months ago.
I found scripts written in perl or python to include svg pictures in pdf 
but that's not really good (to me) and it doesn't work with any pdf 
viewer (it also requires a plugin installation in adobe acrobat ...). I 
was thinking about the mars project : 
http://labs.adobe.com/technologies/mars/

I thought that maybe the day when luatex and this new pdfxml format 
would be stable enough,  it could be conceivable to give luatex this 
ability to produce pdfxml files and maybe it would make easier the 
integration of svg images in this pdfxml without having to parse svg 
code. What do you think ? Pdfxml could be a good opportunity for luatex 
users ?












From pragma at wxs.nl  Sat Apr 18 17:55:29 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Sat, 18 Apr 2009 17:55:29 +0200
Subject: [Dev-luatex] A native support for SVG
In-Reply-To: <49E9E85B.5000601@laposte.net>
References: <4867E762.4040902@laposte.net> <48688BF6.8000404@wxs.nl>
	<49E9E85B.5000601@laposte.net>
Message-ID: <49E9F7F1.4040206@wxs.nl>

TeXWorld wrote:
> Hans Hagen a ?crit :
>>
>> TeXWorld wrote:
>>> Hello,
>>>
>>> I'm a ConTeXt (and LaTeX too) user. When I want to make a vector 
>>> picture, I'm trying most of the time to use programs who can export 
>>> PGF/TikZ or PStricks.
>>> A lot of users like me don't "program" their vector pictures and use 
>>> wysiwyg programs like Inkscape or Illustrator to generate PStricks ou 
>>> PGF/TikZ code. Of course whatever program used, we can
>>> find a SVG export. SVG is the most spread and the most used format to 
>>> store vector pictures.
>>>
>>> I request a native support for SVG in XeTeX and in LuaTeX, I think it 
>>> would be a great thing.
>>> Of course when I want to include SVG pictures in my documents I can 
>>> convert them to pdf before but the problem is that labels and texts 
>>> won't be compiled : fonts will be wrong.
>>>
>>> What do you think about this ? Do you think it's something possible ?
>>
>> it would involve parsing of the svg code and that's real low on my 
>> agenda (svg is not my favourite format with all this data in 
>> attributes while actually it should in element and properly structured)
>>
>> Hans
> Hello everybody, hello Hans,
> 
> I was reading this old message I posted about ten months ago.
> I found scripts written in perl or python to include svg pictures in pdf 
> but that's not really good (to me) and it doesn't work with any pdf 
> viewer (it also requires a plugin installation in adobe acrobat ...). I 
> was thinking about the mars project : 
> http://labs.adobe.com/technologies/mars/
> 
> I thought that maybe the day when luatex and this new pdfxml format 
> would be stable enough,  it could be conceivable to give luatex this 
> ability to produce pdfxml files and maybe it would make easier the 
> integration of svg images in this pdfxml without having to parse svg 
> code. What do you think ? Pdfxml could be a good opportunity for luatex 
> users ?

you can make your inclusion code clever enough to convert the image to 
pdf before inclusions (has to be done once only) so that's a feasible 
solution for now

concerning the future, other output formats like mars or xps will be 
looked into when we have luatex version 1.0 at which point we hope to 
have the backend code redone; in order to support extra backends some of 
the now rather pdf related functionality has to be generalized as well 
(like the concept of reusing typeset content); also, when the backend 
also has the ability to plug in lua code, support for multiple backends 
is easier to implement

so, to answer the question ... indeed we will look into it once we're 
ready for it (of course this might not solve the svg solution as it then 
still demands plugins in the viewing app)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From khaledhosny at eglug.org  Sat Apr 18 18:03:04 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 18 Apr 2009 18:03:04 +0200
Subject: [Dev-luatex] textdir inside boxes
In-Reply-To: <alpine.DEB.1.00.0904181621330.20951@hahepc1.hahe>
References: <20090418140900.GA4681@khaled-laptop>
	<alpine.DEB.1.00.0904181621330.20951@hahepc1.hahe>
Message-ID: <20090418160304.GA12943@khaled-laptop>

On Sat, Apr 18, 2009 at 04:22:32PM +0200, Hartmut Henkel wrote:
> please check current svn luatex, we had this topics a few days before,
> it should now be more consistent.

I did an 'svn up' and build before posting this mail, I checked again
now and still the same. 
Oh, I think I caught it. If the hbox is in vertical mode, it won't
inherit textdir:

\textdir TRT
\setbox0 = \hbox{textdir: \the\textdir , boxdir: \the\boxdir0}
\leavevmode\setbox1 = \hbox{textdir: \the\textdir , boxdir: \the\boxdir1}

\box0

\box1
\bye

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090418/426fdd25/attachment.bin>

From root at www.metatex.org  Sat Apr 18 22:25:58 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sat, 18 Apr 2009 22:25:58 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090418202558.0EE931E8C409@www.metatex.org>

------------------------------------------------------------------------
r2329 | hhenkel | 2009-04-18 16:25:30 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/luatex.web
   M /trunk/source/texk/web2c/luatexdir/ptexmac.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.c
   M /trunk/source/texk/web2c/luatexdir/utils/avlstuff.c
   M /trunk/source/texk/web2c/luatexdir/utils/utils.c

move (only a few) #defines copied from luatex.web into ptexmac.h

------------------------------------------------------------------------
r2330 | taco | 2009-04-18 18:21:21 +0200 (Sat, 18 Apr 2009) | 6 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c

the svn version number is always at least the printed number,
but not necessarily exactly that number
--this line, and those below, will be ignored--

M    trunk/source/texk/web2c/luatexdir/lua/luainit.c

------------------------------------------------------------------------
r2331 | hhenkel | 2009-04-18 18:39:50 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luatexfont.h
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.c
   M /trunk/source/texk/web2c/luatexdir/font/mapfile.h
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/font/writecff.c
   M /trunk/source/texk/web2c/luatexdir/font/writefont.c
   M /trunk/source/texk/web2c/luatexdir/image/epdf.c
   M /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/ptexmac.h
   M /trunk/source/texk/web2c/luatexdir/utils/utils.h

move font-related stuff into luatexfont.h, clean up ptexlib.h

------------------------------------------------------------------------
r2332 | hhenkel | 2009-04-18 19:17:56 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/luatexfont.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

move also vfovf.c prototypes to luatexfont.h

------------------------------------------------------------------------
r2333 | hhenkel | 2009-04-18 19:45:46 +0200 (Sat, 18 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/ptexmac.h
   M /trunk/source/texk/web2c/luatexdir/utils/utils.h

move more prototypes, delete unused defines

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr 19 12:27:38 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 19 Apr 2009 12:27:38 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090419102738.36B101E8C409@www.metatex.org>

------------------------------------------------------------------------
r2334 | oneiros | 2009-04-19 00:38:27 +0200 (Sun, 19 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

fix missing declaration of flush_jbig2_page0_objects

------------------------------------------------------------------------
r2335 | oneiros | 2009-04-19 00:42:46 +0200 (Sun, 19 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h

provide missing declaration of epdf_check_mem

------------------------------------------------------------------------
r2336 | hhenkel | 2009-04-19 10:38:24 +0200 (Sun, 19 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/image.h
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.h

pdfpage.c provides pstruct

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr 19 22:25:56 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 19 Apr 2009 22:25:56 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090419202556.C55891E8C41C@www.metatex.org>

------------------------------------------------------------------------
r2337 | oneiros | 2009-04-19 19:35:08 +0200 (Sun, 19 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luaprofiler/core_profiler.h

add missing declaration

------------------------------------------------------------------------

From oberdiek at uni-freiburg.de  Mon Apr 20 01:12:13 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Mon, 20 Apr 2009 01:12:13 +0200
Subject: [Dev-luatex] Segmentation fault if \patterns{} is dumped
Message-ID: <20090419231213.GA31951@irwin.vpn.uni-freiburg.de>

Hello,

I got a segmentation fault and could reduce the problem to the
following example using "luatex -ini".

\catcode`{=1
\catcode`}=2
\patterns{}
\dump

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From taco at elvenkind.com  Mon Apr 20 08:40:41 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 20 Apr 2009 08:40:41 +0200
Subject: [Dev-luatex] Segmentation fault if \patterns{} is dumped
In-Reply-To: <20090419231213.GA31951@irwin.vpn.uni-freiburg.de>
References: <20090419231213.GA31951@irwin.vpn.uni-freiburg.de>
Message-ID: <49EC18E9.1000106@elvenkind.com>

Heiko Oberdiek wrote:
> Hello,
> 
> I got a segmentation fault and could reduce the problem to the
> following example using "luatex -ini".
> 
> \catcode`{=1
> \catcode`}=2
> \patterns{}
> \dump

Thank you for the report. Fix is in trunk.

Best wishes,
Taco

From root at www.metatex.org  Mon Apr 20 12:27:50 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 20 Apr 2009 12:27:50 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090420102750.4BB0A1E8C41C@www.metatex.org>

------------------------------------------------------------------------
r2338 | taco | 2009-04-20 08:37:43 +0200 (Mon, 20 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.c

fix a crash on empty \patterns (reported by Heiko)

------------------------------------------------------------------------
r2339 | taco | 2009-04-20 09:24:25 +0200 (Mon, 20 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/am/luatex.am

add the new headers

------------------------------------------------------------------------
r2340 | taco | 2009-04-20 09:44:39 +0200 (Mon, 20 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in

autoreconf

------------------------------------------------------------------------

From peb at mppmu.mpg.de  Mon Apr 20 14:24:38 2009
From: peb at mppmu.mpg.de (Peter Breitenlohner)
Date: Mon, 20 Apr 2009 14:24:38 +0200 (CEST)
Subject: [Dev-luatex] Building luatex with poppler
In-Reply-To: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
References: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
Message-ID: <alpine.LNX.1.10.0904201405050.18351@pcl321.mppmu.mpg.de>

On Thu, 16 Apr 2009, Norbert Preining wrote:

> for Debian I have adjusted the libpoppler patch for luatex. Thanks to
> the work of Peter it is getting easier and easier, and AFAIS the patch
> for TeX Live itself well shrink, too.
>
> Besides the code change (which is rather minimal), the patch to the
> Makefile.in and configure is as follows:
>
> ..........
>
> Now two things:
> 1) is there any chance to make that even simpler? I mean if one selects
>   --with-poppler we would only have to change the value of
> 	XPDF_LIBS to -lpoppler
>   and
> 	XPDF_DEPEND to nothing
>   (because poppler would be always system wide)
>   and
> 	XPDF_INCLUDES to something given with --with-poppler-include
>   Whether the need_xpdf is set to true/false I do not know if it makes
>   any difference.

Hi Norbert,

I have something like that in mind:

configuring with --with-system-poppler (use installed libpoppler instead of
libxpdf from TL tree) will set the CPPFLAGS, INCLUDES, and DEPENDENCIES for
libpoppler, including one flag like -DPOPPLERVERSION that can be used by the
{pdf,lua,Xe}TeX code to distinguish which one is used.

In other words the build systems pretends that libxpdf and libpoppler are
essentially the same thing (which they are), one from the TL tree and one
installed.

I think that will have the minimal impact on the TL build system (at the
price of renaming libs/xpdf => libs/poppler).

If Karl objects to that renaming, --with-system-xpdf would have the same
effect (the name being slightly misleading, but the help text could
elaborate).  [The configure options --with-system-XXX are generated
automatically with names derived from the libs/* directories].

=================

So, all that would be needed for this are the -DPOPPLERVERSION dependent
changes in the *TeX code.

> 2) Concerning system libpng: Most things work out of the box if one
>   gives
> 	--with-system-png
>   but in source/texk/web2c/luatexdir/image/image.h there is a
> 	#  include <../libpng/png.h>
>   which has to be changed to
> 	#  include <png.h>
>   Taco, any chance to fix that in one or the other way?

I think Taco has already fixed that.

Regards
Peter

From preining at logic.at  Mon Apr 20 16:35:43 2009
From: preining at logic.at (Norbert Preining)
Date: Mon, 20 Apr 2009 16:35:43 +0200
Subject: [Dev-luatex] Building luatex with poppler
In-Reply-To: <alpine.LNX.1.10.0904201405050.18351@pcl321.mppmu.mpg.de>
References: <20090416164251.GD20643@gamma.logic.tuwien.ac.at>
	<alpine.LNX.1.10.0904201405050.18351@pcl321.mppmu.mpg.de>
Message-ID: <20090420143543.GH2502@gamma.logic.tuwien.ac.at>

Hi Peter,

first of all, again thanks for all the work you have done!!!!

On Mo, 20 Apr 2009, Peter Breitenlohner wrote:
> configuring with --with-system-poppler (use installed libpoppler instead of
> libxpdf from TL tree) will set the CPPFLAGS, INCLUDES, and DEPENDENCIES for
> libpoppler, including one flag like -DPOPPLERVERSION that can be used by the
> {pdf,lua,Xe}TeX code to distinguish which one is used.

Perfect! That would be fine. The problem is about getting the
POPPLERVERSION as you know. Anyway, that sound actually great.

Of course, there are still changes to the source code necessary, but
they are quite small.

> So, all that would be needed for this are the -DPOPPLERVERSION dependent
> changes in the *TeX code.

Right, and I can even help with that. I have patches for all the
programs in TL2007 and current luatex, so I am sure that it is not too
hard. Especially, with poppler v0.10 there are really a few things to
change.

Again, thanks.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
SKEGNESS (n.)
Nose excreta of a malleable consistency.
			--- Douglas Adams, The Meaning of Liff

From taco at elvenkind.com  Tue Apr 21 23:50:24 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 21 Apr 2009 23:50:24 +0200
Subject: [Dev-luatex] mpost.1 man page (and luatex.1 man page)
In-Reply-To: <49EDFDAC.9010304@elzevir.fr>
References: <49EDFDAC.9010304@elzevir.fr>
Message-ID: <49EE3FA0.8030509@elvenkind.com>

Manuel P?gouri?-Gonnard wrote:
> Hi Taco,
> 
> While converting man pages to PDF in TeX Live (for the sake of windows user), I
> noticed groff complains about the .URL macro used on line 475 of mpost.1. This
> macro probably belongs to the 'www' module of groff, which is apparently not
> included for processing man page (at least it doesn't render properly in my man
> viewer).
> 
> Maybe you'll want to remove this macro from mpost.1?

That page is in need of a bit of updating besides, and it is
only in texlive, not in the mpost repository. At the least,
the TL page needs to be merged back (metapost repo has only "mp.1",
which looks like the original page Hobby wrote, back in the nineties).

I would be glad if someone else could take charge of the few
needed updates (hence CC mp-implementors and Sanjoy).

> Thanks,
> Manuel.
> 
> PS: do you plan to provide a man page for luatex in the future?

Not an exhaustive one for sure, but maybe a generic one that just
lists the commandline switches and points to the manual (like
pdftex's man page) would be good.

It would be great for me if someone else would step in, though.
I don't like creating man pages and never have. In fact, I disliked
troff so much that I was willing to learn a completely new system
called 'tex' instead ;), (hence CC dev-luatex)

Best wishes,
Taco

From khaledhosny at eglug.org  Wed Apr 22 00:20:11 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 22 Apr 2009 00:20:11 +0200
Subject: [Dev-luatex] mpost.1 man page (and luatex.1 man page)
In-Reply-To: <49EE3FA0.8030509@elvenkind.com>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
Message-ID: <20090421222011.GA3564@khaled-laptop>

On Tue, Apr 21, 2009 at 11:50:24PM +0200, Taco Hoekwater wrote:
>> PS: do you plan to provide a man page for luatex in the future?
>
> Not an exhaustive one for sure, but maybe a generic one that just
> lists the commandline switches and points to the manual (like
> pdftex's man page) would be good.

Is there an existing man page to start with (TL?) should I start with
pdftex man page?

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090422/5ee3ce13/attachment.bin>

From mpg at elzevir.fr  Wed Apr 22 00:42:30 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Wed, 22 Apr 2009 00:42:30 +0200
Subject: [Dev-luatex] mpost.1 man page (and luatex.1 man page)
In-Reply-To: <20090421222011.GA3564@khaled-laptop>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop>
Message-ID: <49EE4BD6.6050406@elzevir.fr>

Khaled Hosny a ?crit :
> On Tue, Apr 21, 2009 at 11:50:24PM +0200, Taco Hoekwater wrote:
>>> PS: do you plan to provide a man page for luatex in the future?
>> Not an exhaustive one for sure, but maybe a generic one that just
>> lists the commandline switches and points to the manual (like
>> pdftex's man page) would be good.
> 
> Is there an existing man page to start with (TL?) should I start with
> pdftex man page?
> 
There is one man page written by Norbert for Debian, which I included in TL
yesterday.

Manuel.


From chofchof at ktug.or.kr  Wed Apr 22 03:16:01 2009
From: chofchof at ktug.or.kr (Jin-Hwan Cho)
Date: Wed, 22 Apr 2009 10:16:01 +0900
Subject: [Dev-luatex] kpse.find_file not work with TFM files...
Message-ID: <BAE2E4D6-7F32-4371-ACA6-053353F352A1@ktug.or.kr>

Hi, Taco.

I tested the following simple script with texlua.

#!/usr/bin/env texlua

kpse.set_program_name('luatex')
cmr10 = kpse.find_file('cmr10', 'tfm')
t = font.read_tfm(cmr10, 655360)

I am using Leopard and the version of texlua is

This is LuaTeX, Version snapshot-0.39.0-2009041623 luatex.web v2298

However, I could get assertion failure as

../../../source/texk/web2c/luatexdir/font/texfont.c:1102: failed  
assertion `f > 0'
Abort trap

Did I miss something or is it a bug?

One more note. kpse.find_file() worked well with virtual files.

Cheers, ChoF.


From taco at elvenkind.com  Wed Apr 22 08:29:23 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 08:29:23 +0200
Subject: [Dev-luatex] kpse.find_file not work with TFM files...
In-Reply-To: <BAE2E4D6-7F32-4371-ACA6-053353F352A1@ktug.or.kr>
References: <BAE2E4D6-7F32-4371-ACA6-053353F352A1@ktug.or.kr>
Message-ID: <49EEB943.50702@elvenkind.com>

Jin-Hwan Cho wrote:
> Hi, Taco.
> 
> I tested the following simple script with texlua.
> 
> #!/usr/bin/env texlua
> 
> kpse.set_program_name('luatex')
> cmr10 = kpse.find_file('cmr10', 'tfm')
> t = font.read_tfm(cmr10, 655360)
> 
> I am using Leopard and the version of texlua is
> 
> This is LuaTeX, Version snapshot-0.39.0-2009041623 luatex.web v2298
> 
> However, I could get assertion failure as
> 
> ../../../source/texk/web2c/luatexdir/font/texfont.c:1102: failed 
> assertion `f > 0'
> Abort trap
> 
> Did I miss something or is it a bug?

Fix in trunk. It was an oversight: I never expected anybody to
use read_tfm() in a texlua script. In a normal tex run, deleting
a font with 'f==0' would be bad (as that is the nullfont).

Anyway, fixed now.  Thank you for the continuous testing and
bug reports!

Best wishes,
Taco

From root at www.metatex.org  Wed Apr 22 12:30:22 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 22 Apr 2009 12:30:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090422103022.5F5691E8C425@www.metatex.org>

------------------------------------------------------------------------
r2341 | taco | 2009-04-22 08:24:50 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c

make sure texlua can run font.read_tfm()

------------------------------------------------------------------------
r2342 | taco | 2009-04-22 11:48:04 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/build.sh
   M /trunk/source/Makefile.in
   M /trunk/source/ac/withenable.ac
   M /trunk/source/aclocal.m4
   M /trunk/source/build-aux/README.TL
   M /trunk/source/build-aux/config.guess
   M /trunk/source/build-aux/config.sub
   M /trunk/source/config/config.guess
   M /trunk/source/config/config.sub
   M /trunk/source/configure
   M /trunk/source/libs/Makefile.am
   M /trunk/source/libs/Makefile.in
   M /trunk/source/libs/ac/withenable.ac
   M /trunk/source/libs/aclocal.m4
   M /trunk/source/libs/configure
   M /trunk/source/libs/dummy/Makefile.am
   M /trunk/source/libs/dummy/Makefile.in
   M /trunk/source/libs/dummy/README
   M /trunk/source/libs/dummy/aclocal.m4
   M /trunk/source/libs/libpng/Makefile.am
   M /trunk/source/libs/libpng/Makefile.in
   M /trunk/source/libs/libpng/ac/libpng.ac
   M /trunk/source/libs/libpng/ac/withenable.ac
   M /trunk/source/libs/libpng/aclocal.m4
   M /trunk/source/libs/libpng/configure
   M /trunk/source/libs/libpng/libpng-1.2.35/config.guess
   M /trunk/source/libs/libpng/libpng-1.2.35/config.sub
   M /trunk/source/libs/obsdcompat/Makefile.am
   M /trunk/source/libs/obsdcompat/Makefile.in
   M /trunk/source/libs/obsdcompat/ac/withenable.ac
   M /trunk/source/libs/obsdcompat/aclocal.m4
   M /trunk/source/libs/obsdcompat/configure
   M /trunk/source/libs/xpdf/Makefile.am
   M /trunk/source/libs/xpdf/Makefile.in
   M /trunk/source/libs/xpdf/ac/withenable.ac
   M /trunk/source/libs/xpdf/aclocal.m4
   M /trunk/source/libs/xpdf/configure
   M /trunk/source/libs/xpdf/fofi/Makefile.in
   M /trunk/source/libs/xpdf/goo/Makefile.in
   M /trunk/source/libs/xpdf/hdrs.am
   M /trunk/source/libs/xpdf/xpdf/Makefile.in
   M /trunk/source/libs/zlib/Makefile.am
   M /trunk/source/libs/zlib/Makefile.in
   M /trunk/source/libs/zlib/ac/withenable.ac
   M /trunk/source/libs/zlib/ac/zlib.ac
   M /trunk/source/libs/zlib/aclocal.m4
   M /trunk/source/libs/zlib/configure
   M /trunk/source/m4/README
   M /trunk/source/m4/cho-kpse.m4
   M /trunk/source/m4/cho-libs.m4
   M /trunk/source/m4/kpse-common.m4
   M /trunk/source/m4/kpse-cxx-hack.m4
   A /trunk/source/m4/kpse-fontconfig-flags.m4
   A /trunk/source/m4/kpse-icu-flags.m4
   M /trunk/source/m4/kpse-macos-framework.m4
   M /trunk/source/m4/kpse-pkgs.m4
   M /trunk/source/m4/kpse-setup.m4
   M /trunk/source/m4/kpse-web2c.m4
   M /trunk/source/texk/Makefile.am
   M /trunk/source/texk/Makefile.in
   M /trunk/source/texk/ac/withenable.ac
   M /trunk/source/texk/aclocal.m4
   M /trunk/source/texk/configure
   M /trunk/source/texk/dummy/Makefile.am
   M /trunk/source/texk/dummy/Makefile.in
   M /trunk/source/texk/dummy/README
   M /trunk/source/texk/dummy/aclocal.m4
   M /trunk/source/texk/kpathsea/ChangeLog
   M /trunk/source/texk/kpathsea/Makefile.in
   M /trunk/source/texk/kpathsea/ac/kpathsea.ac
   M /trunk/source/texk/kpathsea/ac/web2c.ac
   M /trunk/source/texk/kpathsea/ac/withenable.ac
   M /trunk/source/texk/kpathsea/aclocal.m4
   M /trunk/source/texk/kpathsea/configure
   M /trunk/source/texk/kpathsea/doc/Makefile.in
   M /trunk/source/texk/kpathsea/man/Makefile.in
   M /trunk/source/texk/kpathsea/texmf.cnf
   M /trunk/source/texk/web2c/Makefile.am
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/ac/web2c.ac
   M /trunk/source/texk/web2c/ac/withenable.ac
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/am/texmf.am
   M /trunk/source/texk/web2c/c-auto.in
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/configure.ac
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   A /trunk/source/texk/web2c/luatexdir/am/liblua51.am
   A /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   A /trunk/source/texk/web2c/luatexdir/am/libzzip.am
   A /trunk/source/texk/web2c/luatexdir/am/luafontforge.am
   A /trunk/source/texk/web2c/luatexdir/am/luamisc.am
   A /trunk/source/texk/web2c/luatexdir/am/luasocket.am
   A /trunk/source/texk/web2c/luatexdir/am/luatangle.am
   M /trunk/source/texk/web2c/luatexdir/am/luatex.am
   M /trunk/source/texk/web2c/man/Makefile.in
   A /trunk/source/texk/web2c/mplibdir/am/libmplib.am
   M /trunk/source/texk/web2c/mplibdir/am/mplib.am
   M /trunk/source/texk/web2c/mplibdir/avl.h
   M /trunk/source/texk/web2c/mplibdir/mp.w
   M /trunk/source/texk/web2c/mplibdir/mpost.w
   M /trunk/source/texk/web2c/mplibdir/mpxout.w
   M /trunk/source/texk/web2c/mplibdir/psout.w
   A /trunk/source/texk/web2c/pdftexdir/am/libpdftex.am
   A /trunk/source/texk/web2c/pdftexdir/am/pdftosrc.am
   A /trunk/source/texk/web2c/pdftexdir/am/ttf2afm.am
   M /trunk/source/texk/web2c/web2c/ChangeLog
   M /trunk/source/texk/web2c/web2c/convert
   M /trunk/source/utils/Makefile.am
   M /trunk/source/utils/Makefile.in
   M /trunk/source/utils/ac/withenable.ac
   M /trunk/source/utils/aclocal.m4
   M /trunk/source/utils/configure
   M /trunk/source/utils/dummy/Makefile.am
   M /trunk/source/utils/dummy/Makefile.in
   M /trunk/source/utils/dummy/README
   M /trunk/source/utils/dummy/aclocal.m4

new build infrastructure files from texlive

------------------------------------------------------------------------
r2343 | taco | 2009-04-22 11:49:17 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

a final small metapost import

------------------------------------------------------------------------
r2344 | taco | 2009-04-22 11:50:19 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

bump the version number to 0.40.0

------------------------------------------------------------------------
r2345 | taco | 2009-04-22 12:01:08 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/NEWS

update NEWS and the manual version number

------------------------------------------------------------------------
r2346 | taco | 2009-04-22 12:02:15 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   A /tags/beta-0.40.0 (from /trunk:2345)

new tag

------------------------------------------------------------------------

From taco at elvenkind.com  Wed Apr 22 12:26:28 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 12:26:28 +0200
Subject: [Dev-luatex] luatex beta 0.40.0
Message-ID: <49EEF0D4.1000606@elvenkind.com>

Hi,

I have just uploaded luatex 0.40.0 to the foundry server,
and will commit the source code to texlive later today.

What's new:

* The embedded MPlib is updated to version 1.200.

* Texlua would crash if run font.read_tfm() was used.

* Luatex would crash on empty \patterns.

* Lots of small C code cleanups.

* \textdir inside a \hbox dir *** was wrong earlier.

* 0.39.0 introduced a bug that would make luatex crash whenever
  font expansion was used.

* Font tables returned by define_font can now have a key named
  'cache' that controls the internal lua font table caching.

* There is no longer a need for an explicit --progname if there
  is no input file given.


The archives can be downloaded from supelec as usual:

        http://foundry.supelec.fr/projects/luatex/

You could also check out the sources via anonymous svn:

  svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.40.0

Bugs and feature requests can be added to the issue tracker at

       http://tracker.luatex.org


Have fun,
Taco




From taco at elvenkind.com  Wed Apr 22 14:23:12 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 14:23:12 +0200
Subject: [Dev-luatex] [luatex] luatex beta 0.40.0
In-Reply-To: <49EEF0D4.1000606@elvenkind.com>
References: <49EEF0D4.1000606@elvenkind.com>
Message-ID: <49EF0C30.40302@elvenkind.com>


Hi again,

Taco Hoekwater wrote:
> Hi,
> 
> I have just uploaded luatex 0.40.0 to the foundry server,
> and will commit the source code to texlive later today.

As it turns out, there were two fatal flaws in the release,
so I have cheated a little and have delete the archive files.

I am now in the process of uploading new versions. I saw that
there had been two downloads of the old files already, those
people (I hope you know who you are) should fetch new the new
archives file that will be available shortly.

I am sorry for the inconvenience,

Taco



From root at www.metatex.org  Wed Apr 22 16:29:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 22 Apr 2009 16:29:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090422142910.C98231E8C3F8@www.metatex.org>

------------------------------------------------------------------------
r2347 | taco | 2009-04-22 13:51:15 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lfontlib.c

fix the nullfont fix

------------------------------------------------------------------------
r2348 | taco | 2009-04-22 14:10:14 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/configure.ac
   M /trunk/source/texk/web2c/doc/Makefile.in
   M /trunk/source/texk/web2c/lib/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/man/Makefile.in
   M /trunk/source/texk/web2c/web2c/ChangeLog
   M /trunk/source/texk/web2c/web2c/convert

Import a few new files from texlive (fixes crosscompilation)

------------------------------------------------------------------------
r2349 | taco | 2009-04-22 14:13:26 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /tags/beta-0.40.0/source/texk/web2c/Makefile.in
   M /tags/beta-0.40.0/source/texk/web2c/configure
   M /tags/beta-0.40.0/source/texk/web2c/configure.ac
   M /tags/beta-0.40.0/source/texk/web2c/doc/Makefile.in
   M /tags/beta-0.40.0/source/texk/web2c/lib/Makefile.in
   M /tags/beta-0.40.0/source/texk/web2c/luatexdir/am/libluatex.am
   M /tags/beta-0.40.0/source/texk/web2c/luatexdir/lua/lfontlib.c
   M /tags/beta-0.40.0/source/texk/web2c/man/Makefile.in
   M /tags/beta-0.40.0/source/texk/web2c/web2c/ChangeLog
   M /tags/beta-0.40.0/source/texk/web2c/web2c/convert

some extreme hotfixes

------------------------------------------------------------------------
r2350 | taco | 2009-04-22 15:03:37 +0200 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   A /branches/0.40.x (from /tags/beta-0.40.0:2349)

bugfix branch

------------------------------------------------------------------------

From khaledhosny at eglug.org  Wed Apr 22 20:02:40 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 22 Apr 2009 20:02:40 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
	(and	luatex.1 man page)]
In-Reply-To: <49EE4BD6.6050406@elzevir.fr>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
Message-ID: <20090422180240.GA27936@khaled-laptop>

On Wed, Apr 22, 2009 at 12:42:30AM +0200, Manuel P?gouri?-Gonnard wrote:
> Khaled Hosny a ?crit :
> > On Tue, Apr 21, 2009 at 11:50:24PM +0200, Taco Hoekwater wrote:
> >>> PS: do you plan to provide a man page for luatex in the future?
> >> Not an exhaustive one for sure, but maybe a generic one that just
> >> lists the commandline switches and points to the manual (like
> >> pdftex's man page) would be good.
> > 
> > Is there an existing man page to start with (TL?) should I start with
> > pdftex man page?
> > 
> There is one man page written by Norbert for Debian, which I included in TL
> yesterday.

OK, here is a more or less working man page, based on pdftex.man and
luatex.1 from Debian. I omitted some options from pdftex man page that
I'm not sure are supported by luatex, included some descriptions from
luatex manual, and some formatting. The ENVIRONMENT section is a direct
copy from pdftex man page, not sure if there is some thing that need to
be added/removed for luatex. FILES, AVAILABILITY and BUGS sections were
omitted as well.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: luatex.man
Type: application/x-troff-man
Size: 7889 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090422/ae1223a3/attachment-0001.man>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090422/ae1223a3/attachment-0001.bin>

From mpg at elzevir.fr  Wed Apr 22 20:17:25 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Wed, 22 Apr 2009 20:17:25 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <20090422180240.GA27936@khaled-laptop>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
Message-ID: <49EF5F35.2030704@elzevir.fr>

[un-cc-ing the metapost list since this part is only about luatex]

Khaled Hosny a ?crit :
> OK, here is a more or less working man page, based on pdftex.man and
> luatex.1 from Debian.

Cool, thanks!

> I omitted some options from pdftex man page that
> I'm not sure are supported by luatex, included some descriptions from
> luatex manual, and some formatting. The ENVIRONMENT section is a direct
> copy from pdftex man page, not sure if there is some thing that need to
> be added/removed for luatex. FILES, AVAILABILITY and BUGS sections were
> omitted as well.
> 
Maybe TEXPOOL isn't relevant any more (not sure).

Manuel.

From 2347827245734 at gmx.net  Wed Apr 22 20:03:21 2009
From: 2347827245734 at gmx.net (Guenther B.)
Date: Wed, 22 Apr 2009 20:03:21 +0200
Subject: [Dev-luatex] Minor Bug: luatex does not compile with -DNDEBUG
Message-ID: <49EF5BE9.3030508@gmx.net>

Hi all,

The debugging diagnostic code in src/texk/web2c/luatexdir/tex/texnodes.c
(using the latest version luatex-beta-0.30.3 which has been marked as
"stable" in the Gentoo repository) fails to compile if the package is
being compiled as a release version (-DNDEBUG) rather than a debugging
version (no -DNDEBUG).

See

http://bugs.gentoo.org/show_bug.cgi?id=263275

for a full description of the bug and a proposed patch.

However, the patch does nothing more than disable the #ifndef NDEBUG
sections locally for that source file.

And as I do not have any deeper understanding what those "varmem_sizes"
array is actually being used for, this might or might not be such a good
idea to do.

Therefore, I hereby humbly request whether you upstream guys might be
kindly willing to fix that problem in some forthcoming release, because
it is sort of annoying to manually have to interfere with the build
system each time this package is rebuilt on a source-based Distribution
like Gentoo.

Nevertheless, thanks for all the labour you already have spent on this
fine project and keep up the good work!

Greetings,

Guenther

From taco at elvenkind.com  Wed Apr 22 20:47:25 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 20:47:25 +0200
Subject: [Dev-luatex] Minor Bug: luatex does not compile with -DNDEBUG
In-Reply-To: <49EF5BE9.3030508@gmx.net>
References: <49EF5BE9.3030508@gmx.net>
Message-ID: <49EF663D.8090900@elvenkind.com>


Hi Guenther,

Guenther B. wrote:
> Hi all,
> 
> The debugging diagnostic code in src/texk/web2c/luatexdir/tex/texnodes.c
> (using the latest version luatex-beta-0.30.3 which has been marked as
> "stable" in the Gentoo repository) fails to compile if the package is
> being compiled as a release version (-DNDEBUG) rather than a debugging
> version (no -DNDEBUG).

Well, it is not a release version, nor stable, so there! :)

> See
> 
> http://bugs.gentoo.org/show_bug.cgi?id=263275
> 
> for a full description of the bug and a proposed patch.

You could try version 0.40.0 (released today) because I recall
having dealt with this bug report a few months ago (commit #1721,
added on January 2, based on a report by Bj?rn Augestad).

Nevertheless, I think it is madness to mark luatex as either
stable or released at this point in time, and handling it thus
is not supported.

Best wishes,
Taco



From pragma at wxs.nl  Wed Apr 22 20:58:00 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 22 Apr 2009 20:58:00 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <49EF5F35.2030704@elzevir.fr>
References: <49EDFDAC.9010304@elzevir.fr>
	<49EE3FA0.8030509@elvenkind.com>	<20090421222011.GA3564@khaled-laptop>
	<49EE4BD6.6050406@elzevir.fr>	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr>
Message-ID: <49EF68B8.4020205@wxs.nl>

Manuel P?gouri?-Gonnard wrote:
> [un-cc-ing the metapost list since this part is only about luatex]
> 
> Khaled Hosny a ?crit :
>> OK, here is a more or less working man page, based on pdftex.man and
>> luatex.1 from Debian.
> 
> Cool, thanks!
> 
>> I omitted some options from pdftex man page that
>> I'm not sure are supported by luatex, included some descriptions from
>> luatex manual, and some formatting. The ENVIRONMENT section is a direct
>> copy from pdftex man page, not sure if there is some thing that need to
>> be added/removed for luatex. FILES, AVAILABILITY and BUGS sections were
>> omitted as well.
>>
> Maybe TEXPOOL isn't relevant any more (not sure).

indeed, pool is irrelevant, also for pdftex if i'm right

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Wed Apr 22 21:03:19 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 22 Apr 2009 21:03:19 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <49EF5F35.2030704@elzevir.fr>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr>
Message-ID: <49EF69F7.2010107@elvenkind.com>

Manuel P?gouri?-Gonnard wrote:
> [un-cc-ing the metapost list since this part is only about luatex]
> 
> Khaled Hosny a ?crit :
>> OK, here is a more or less working man page, based on pdftex.man and
>> luatex.1 from Debian.
> 
> Cool, thanks!

Very cool. I don't know how to edit it, but I can give comments
and other help, if you don't mind.

* --lua is actually optional even though it looks to be required
   now from the SYNOPSIS (I am sorry, I know this came from the
   commandline help, but that is also a bit misleading)

   The option list is a bit outdated in any case, I will try to
   document the actual, complete option list tomorrow.

* It would be nice if some one-liner about Unicode and OpenType
   fonts could be squeezed in.

* Maybe point to either www.luatex.org or to "texdoc luatex"
   (although I am not certain that that actually works)

>> I omitted some options from pdftex man page that
>> I'm not sure are supported by luatex, included some descriptions from
>> luatex manual, and some formatting. The ENVIRONMENT section is a direct
>> copy from pdftex man page, not sure if there is some thing that need to
>> be added/removed for luatex. FILES, AVAILABILITY and BUGS sections were
>> omitted as well.
>>
> Maybe TEXPOOL isn't relevant any more (not sure).

The env variables are all sort of weird:

TEXPOOL is definilely irrelevant nowadays (also for pdftex, btw.)

TEXMFOUTPUT is unreliable at best, and it may be better to
remove it (because the file callbacks can or cannot listen to
this variable at their option).

I believe that the current consensus these days is that it is better
to leave TEXINPUTS and TEXFORMATS well alone also, and instead just
rely on auto-discovery of texmf.cnf and if that happens to fail,
set TEXMFCNF to its location.


Best wishes,
Taco


From mpg at elzevir.fr  Wed Apr 22 21:16:04 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Wed, 22 Apr 2009 21:16:04 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <49EF69F7.2010107@elvenkind.com>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
Message-ID: <49EF6CF4.1050808@elzevir.fr>

Taco Hoekwater a ?crit :
> * Maybe point to either www.luatex.org or to "texdoc luatex"
>   (although I am not certain that that actually works)
> 
In current TeX Live (2008 with updates), 'texdoc luatex' opens luatexref-t.pdf.

> I believe that the current consensus these days is that it is better
> to leave TEXINPUTS and TEXFORMATS well alone also, and instead just
> rely on auto-discovery of texmf.cnf and if that happens to fail,
> set TEXMFCNF to its location.
> 
I think that the use of environment variables (except TEXMFCNF only when
necessary) is generally not recommended these days for web2c configuration.

Manuel.

From root at www.metatex.org  Wed Apr 22 22:26:23 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 22 Apr 2009 22:26:23 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090422202623.05D211E8C3F8@www.metatex.org>

------------------------------------------------------------------------
r2351 | taco | 2009-04-22 17:08:57 +0200 (Wed, 22 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/zziplib/uses/config.guess
   M /trunk/source/texk/web2c/luatexdir/zziplib/uses/config.sub

from texlive. sort of silly to update these because they are 
not actually used, but it minimizes the directory tree differences

------------------------------------------------------------------------

From khaledhosny at eglug.org  Wed Apr 22 23:10:27 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Wed, 22 Apr 2009 23:10:27 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
	(and	luatex.1 man page)]
In-Reply-To: <49EF69F7.2010107@elvenkind.com>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
Message-ID: <20090422211027.GA4504@khaled-laptop>

On Wed, Apr 22, 2009 at 09:03:19PM +0200, Taco Hoekwater wrote:
> Manuel P?gouri?-Gonnard wrote:
>> [un-cc-ing the metapost list since this part is only about luatex]
>>
>> Khaled Hosny a ?crit :
>>> OK, here is a more or less working man page, based on pdftex.man and
>>> luatex.1 from Debian.
>>
>> Cool, thanks!
>
> Very cool. I don't know how to edit it, but I can give comments
> and other help, if you don't mind.
>
> * --lua is actually optional even though it looks to be required
>   now from the SYNOPSIS (I am sorry, I know this came from the
>   commandline help, but that is also a bit misleading)

It is now surrounded by square brackets.

>   The option list is a bit outdated in any case, I will try to
>   document the actual, complete option list tomorrow.

That would be very helpful, since I'd to guess most of the time.

> * It would be nice if some one-liner about Unicode and OpenType
>   fonts could be squeezed in.

Added sort of.

>
> * Maybe point to either www.luatex.org or to "texdoc luatex"
>   (although I am not certain that that actually works)

I pointed to both :)

>
>>> I omitted some options from pdftex man page that
>>> I'm not sure are supported by luatex, included some descriptions from
>>> luatex manual, and some formatting. The ENVIRONMENT section is a direct
>>> copy from pdftex man page, not sure if there is some thing that need to
>>> be added/removed for luatex. FILES, AVAILABILITY and BUGS sections were
>>> omitted as well.
>>>
>> Maybe TEXPOOL isn't relevant any more (not sure).
>
> The env variables are all sort of weird:

I commented it all out, should we remove it altogether?

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: luatex.man
Type: application/x-troff-man
Size: 8207 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090422/5b2ca01d/attachment-0001.man>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090422/5b2ca01d/attachment-0001.bin>

From taco at elvenkind.com  Thu Apr 23 09:18:29 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 23 Apr 2009 09:18:29 +0200
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
 (and	luatex.1 man page)]
In-Reply-To: <20090422211027.GA4504@khaled-laptop>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
Message-ID: <49F01645.90907@elvenkind.com>

Khaled Hosny wrote:
> 
>>   The option list is a bit outdated in any case, I will try to
>>   document the actual, complete option list tomorrow.
> 
> That would be very helpful, since I'd to guess most of the time.

First, there are two switches that alter the executable behaviour:

   --luaonly
   --luaconly

Then, there are ignored:

   --8bit
   --etex
   --[no-]parse-first-line
       these are always on

   --default-translate-file=TCXNAME
   --translate-file=TCXNAME
       these are always off

Actually interpreted switches and arguments:

   --credits
       prints credits

   --debug-format
       (normally undocumented) to debug format loading

   --draftmode
       switch on draft mode (generates no output PDF)

   --disable-write18
   --enable-write18
   --[no-]shell-escape
   --shell-restricted
       enable/disable/restrict \write18, os.execute(),
       os.exec(), os.spawn(), and io.popen().

   --[no-]file-line-error[-style]
       disable/enable file:line:error style messages

   --fmt=FMTNAME
       use FMTNAME instead of program name or a %& line

   --halt-on-error
       stop processing at the first error

   --help
       show help

   --ini
       be iniluatex, for dumping formats

   --interaction=STRING
       set interaction mode (STRING=batchmode/nonstopmode/
       scrollmode/errorstopmode)

   --jobname=STRING
       set the job name to STRING

   --kpathsea-debug=NUMBER
       set path searching debugging flags according to
       the bits of NUMBER

   --lua=FILE
       the lua initialization file

   --[no-]mktex=FMT
       disable/enable mktexFMT generation (FMT=tex/tfm)

   --nosocket
       disable the luasocket (network) library

   --output-comment=STRING
       use STRING for DVI file comment instead of date

   --output-directory=DIR
       use DIR as the directory to write files to

   --output-format=FORMAT
       use FORMAT for job output; FORMAT is `dvi' or `pdf

   --progname=STRING
       set program (and fmt) name to STRING

   --recorder
       enable filename recorder

   --safer
       disable easily exploitable lua commands

   --synctex=NUMBER
       enable/disable synctex

   --version
       show version and exit

The presence of --lua makes most of these switches unreliable,
because the lua initialization file can disable kpathsea and/or
hook functions into various callbacks. Here is the list of
possibly affected switches/functionality, and why:

   --[no-]file-line-error[-style]
   --halt-on-error
   --disable-write18
   --enable-write18
   --[no-]shell-escape
   --shell-restricted
   --fmt
   --jobname
       controllable via the texconfig table

   --kpathsea-debug
   --[no-]mktex
   --output-directory
   --progname=S
   --jobname=S
   --recorder
       kpathsea can be switched off via the texconfig table

   --interaction
   --output-format
   --synctex
   --draftmode
       can be reset via texconf.init function

   --<unrecognized options>
       the lua initialization script can access the commandline, so it
       can interpret extra options if it so desires.



From root at www.metatex.org  Thu Apr 23 12:27:56 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 23 Apr 2009 12:27:56 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090423102756.8FDB11E8C40D@www.metatex.org>

------------------------------------------------------------------------
r2352 | hhenkel | 2009-04-23 12:03:51 +0200 (Thu, 23 Apr 2009) | 4 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

Issue warning, if \pagedir != \bodydir during \shipout. Maybe better also
report the two values; one could as well ignore the 3rd dir parm, using
the box_direction() macro, but maybe better strive for identical values.

------------------------------------------------------------------------
r2353 | taco | 2009-04-23 12:15:34 +0200 (Thu, 23 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

fix a string realloc overflow bug for the input buffer

------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr 23 16:26:24 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 23 Apr 2009 16:26:24 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090423142624.359841E8C409@www.metatex.org>

------------------------------------------------------------------------
r2354 | hhenkel | 2009-04-23 12:21:13 +0200 (Thu, 23 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

issue no warning (r2352) when shipping a form

------------------------------------------------------------------------

From hartmut_henkel at gmx.de  Thu Apr 23 19:56:40 2009
From: hartmut_henkel at gmx.de (Hartmut Henkel)
Date: Thu, 23 Apr 2009 19:56:40 +0200 (CEST)
Subject: [Dev-luatex] luatex and synctex
Message-ID: <alpine.DEB.1.00.0904231948240.31384@hahepc1.hahe>

Hi,

does anybody use the synctex features in luatex? synctex is included in
the luatex engine, but due to the multidir changes also the synctex C
code needed to be patched and now the positions on the page reported by
synctex are rather likely off by a constant (x,y) distance. Problem is
that i can't test it. Therefore i would be very happy if anybody could
tell me how to use synctex under linux? Or is it a Mac thing only? Does
it work with, e. g., xpdf?

Regards, Hartmut


From olli at sopos.org  Thu Apr 23 21:46:02 2009
From: olli at sopos.org (Oliver Heins)
Date: Thu, 23 Apr 2009 21:46:02 +0200
Subject: [Dev-luatex] luatex and synctex
In-Reply-To: <alpine.DEB.1.00.0904231948240.31384@hahepc1.hahe> (Hartmut
	Henkel's message of "Thu\, 23 Apr 2009 19\:56\:40 +0200 \(CEST\)")
References: <alpine.DEB.1.00.0904231948240.31384@hahepc1.hahe>
Message-ID: <87zle7w3ut.fsf@sopos.org>

Hartmut Henkel <hartmut_henkel at gmx.de> writes:

> Hi,
>
> does anybody use the synctex features in luatex? synctex is included in
> the luatex engine, but due to the multidir changes also the synctex C
> code needed to be patched and now the positions on the page reported by
> synctex are rather likely off by a constant (x,y) distance. Problem is
> that i can't test it. Therefore i would be very happy if anybody could
> tell me how to use synctex under linux? Or is it a Mac thing only? Does
> it work with, e. g., xpdf?

Actually I don't use it (yet), because there was no supporting viewer
that would work with emacs/auctex (which has already experimental
support for synctex).  Today I've read that the latest okular release
claims to have support for pdfsync: http://okular.kde.org/news.php

Then there's texworks (http://www.tug.org/texworks/), a combination of
editor and viewer, which integrates synctex very nicely.  You might want
to give it a try.

Best regards,
 olli

-- 
Oliver Heins olli at sopos.de     F27A BA8C 1CFB B905 65A8
http://www.sopos.org/olli/     2544 0F07 B675 9A00 D827
1024D/9A00D827 2004-09-24 -- gpg --recv-keys 0x9A00D827
Please avoid sending me Word or PowerPoint attachments:
http://www.gnu.org/philosophy/no-word-attachments.html

From root at www.metatex.org  Thu Apr 23 22:26:22 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 23 Apr 2009 22:26:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090423202622.7D3BF1E8C419@www.metatex.org>

------------------------------------------------------------------------
r2355 | hhenkel | 2009-04-23 18:09:03 +0200 (Thu, 23 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

(finally) fix \pageleftoffset vs. \hoffset for \mag != 1000

------------------------------------------------------------------------

From root at www.metatex.org  Fri Apr 24 12:28:20 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 24 Apr 2009 12:28:20 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090424102820.531E11E8C426@www.metatex.org>

------------------------------------------------------------------------
r2356 | hhenkel | 2009-04-24 00:42:41 +0200 (Fri, 24 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.web

one_true_inch wasn't initialized at all, oh sorry for this silliness.

------------------------------------------------------------------------

From root at www.metatex.org  Fri Apr 24 22:26:25 2009
From: root at www.metatex.org (Cron Daemon)
Date: Fri, 24 Apr 2009 22:26:25 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090424202625.289CB1E8C426@www.metatex.org>

------------------------------------------------------------------------
r2357 | taco | 2009-04-24 18:20:38 +0200 (Fri, 24 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

fix tex.extraprimitives() examples

------------------------------------------------------------------------

From root at www.metatex.org  Sun Apr 26 12:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 26 Apr 2009 12:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090426102925.204D61E8C426@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From root at www.metatex.org  Sun Apr 26 16:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 26 Apr 2009 16:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090426142912.7BE7B1E8C426@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From khaledhosny at eglug.org  Sun Apr 26 16:43:41 2009
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 26 Apr 2009 17:43:41 +0300
Subject: [Dev-luatex] luatex manpage [was: mpost.1 man page
	(and	luatex.1 man page)]
In-Reply-To: <49F01645.90907@elvenkind.com>
References: <49EDFDAC.9010304@elzevir.fr> <49EE3FA0.8030509@elvenkind.com>
	<20090421222011.GA3564@khaled-laptop> <49EE4BD6.6050406@elzevir.fr>
	<20090422180240.GA27936@khaled-laptop>
	<49EF5F35.2030704@elzevir.fr> <49EF69F7.2010107@elvenkind.com>
	<20090422211027.GA4504@khaled-laptop>
	<49F01645.90907@elvenkind.com>
Message-ID: <20090426144341.GA16306@khaled-laptop>

On Thu, Apr 23, 2009 at 09:18:29AM +0200, Taco Hoekwater wrote:
> Khaled Hosny wrote:
>>
>>>   The option list is a bit outdated in any case, I will try to
>>>   document the actual, complete option list tomorrow.
>>
>> That would be very helpful, since I'd to guess most of the time.
>
> First, there are two switches that alter the executable behaviour:
>
>   --luaonly
>   --luaconly
>
> Then, there are ignored:
>
>   --8bit
>   --etex
>   --[no-]parse-first-line
>       these are always on
>
>   --default-translate-file=TCXNAME
>   --translate-file=TCXNAME
>       these are always off
>
> Actually interpreted switches and arguments:
>
>   --credits
>       prints credits
>
>   --debug-format
>       (normally undocumented) to debug format loading
>
>   --draftmode
>       switch on draft mode (generates no output PDF)
>
>   --disable-write18
>   --enable-write18
>   --[no-]shell-escape
>   --shell-restricted
>       enable/disable/restrict \write18, os.execute(),
>       os.exec(), os.spawn(), and io.popen().
>
>   --[no-]file-line-error[-style]
>       disable/enable file:line:error style messages
>
>   --fmt=FMTNAME
>       use FMTNAME instead of program name or a %& line
>
>   --halt-on-error
>       stop processing at the first error
>
>   --help
>       show help
>
>   --ini
>       be iniluatex, for dumping formats
>
>   --interaction=STRING
>       set interaction mode (STRING=batchmode/nonstopmode/
>       scrollmode/errorstopmode)
>
>   --jobname=STRING
>       set the job name to STRING
>
>   --kpathsea-debug=NUMBER
>       set path searching debugging flags according to
>       the bits of NUMBER
>
>   --lua=FILE
>       the lua initialization file
>
>   --[no-]mktex=FMT
>       disable/enable mktexFMT generation (FMT=tex/tfm)
>
>   --nosocket
>       disable the luasocket (network) library
>
>   --output-comment=STRING
>       use STRING for DVI file comment instead of date
>
>   --output-directory=DIR
>       use DIR as the directory to write files to
>
>   --output-format=FORMAT
>       use FORMAT for job output; FORMAT is `dvi' or `pdf
>
>   --progname=STRING
>       set program (and fmt) name to STRING
>
>   --recorder
>       enable filename recorder
>
>   --safer
>       disable easily exploitable lua commands
>
>   --synctex=NUMBER
>       enable/disable synctex
>
>   --version
>       show version and exit
>
> The presence of --lua makes most of these switches unreliable,
> because the lua initialization file can disable kpathsea and/or
> hook functions into various callbacks. Here is the list of
> possibly affected switches/functionality, and why:
>
>   --[no-]file-line-error[-style]
>   --halt-on-error
>   --disable-write18
>   --enable-write18
>   --[no-]shell-escape
>   --shell-restricted
>   --fmt
>   --jobname
>       controllable via the texconfig table
>
>   --kpathsea-debug
>   --[no-]mktex
>   --output-directory
>   --progname=S
>   --jobname=S
>   --recorder
>       kpathsea can be switched off via the texconfig table
>
>   --interaction
>   --output-format
>   --synctex
>   --draftmode
>       can be reset via texconf.init function
>
>   --<unrecognized options>
>       the lua initialization script can access the commandline, so it
>       can interpret extra options if it so desires.

Here is an updated one, comments are welcomed.

Regards,
 Khaled


-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer
-------------- next part --------------
A non-text attachment was scrubbed...
Name: luatex.man
Type: application/x-troff-man
Size: 8320 bytes
Desc: not available
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090426/6b45ddf6/attachment.man>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <http://www.ntg.nl/mailman/private/dev-luatex/attachments/20090426/6b45ddf6/attachment.bin>

From root at www.metatex.org  Sun Apr 26 22:25:10 2009
From: root at www.metatex.org (Cron Daemon)
Date: Sun, 26 Apr 2009 22:25:10 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090426202914.125BB1E8C41B@www.metatex.org>

svn: PROPFIND request failed on '/svn/luatex'
svn: PROPFIND of '/svn/luatex': could not connect to server (http://scm.foundry.supelec.fr)

From root at www.metatex.org  Mon Apr 27 12:28:16 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 27 Apr 2009 12:28:16 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090427102816.4C7BE1E8C428@www.metatex.org>

------------------------------------------------------------------------
r2358 | taco | 2009-04-27 08:39:33 +0200 (Mon, 27 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.c

fix vertical placement of radical signs and radical degrees

------------------------------------------------------------------------
r2359 | taco | 2009-04-27 11:57:04 +0200 (Mon, 27 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/mp.w

fresh version of metapost

------------------------------------------------------------------------

From root at www.metatex.org  Mon Apr 27 16:26:25 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 27 Apr 2009 16:26:25 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090427142625.829EC1E8C426@www.metatex.org>

------------------------------------------------------------------------
r2360 | taco | 2009-04-27 14:52:56 +0200 (Mon, 27 Apr 2009) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

minimal text update (lua and mplib version itemization)

------------------------------------------------------------------------

From preining at logic.at  Mon Apr 27 18:49:33 2009
From: preining at logic.at (Norbert Preining)
Date: Mon, 27 Apr 2009 18:49:33 +0200
Subject: [Dev-luatex] [luatex] luatex beta 0.40.0
In-Reply-To: <49EEF0D4.1000606@elvenkind.com>
References: <49EEF0D4.1000606@elvenkind.com>
Message-ID: <20090427164933.GA22138@gamma.logic.tuwien.ac.at>

On Mi, 22 Apr 2009, Taco Hoekwater wrote:
>   svn co svn://scm.foundry.supelec.fr/svn/luatex/tags/beta-0.40.0

luatex 0.40 has been uploaded to Debian and binaries for various archs
will be available soon on the usual unstable sources.

I included already the ini files rework, and updates to texdoc.

Best wishes

Norbert

-------------------------------------------------------------------------------
Dr. Norbert Preining <preining at logic.at>        Vienna University of Technology
Debian Developer <preining at debian.org>                         Debian TeX Group
gpg DSA: 0x09C5B094      fp: 14DF 2E6C 0307 BE6D AD76  A9C0 D2BF 4AA3 09C5 B094
-------------------------------------------------------------------------------
TRISPEN (n.) A form of intelligent grass. It grows a single, tough
stalk and makes its home on lawns. When it sees the lawnmower coming
it lies down and pops up again after it has gone by.
			--- Douglas Adams, The Meaning of Liff

From root at www.metatex.org  Mon Apr 27 22:26:21 2009
From: root at www.metatex.org (Cron Daemon)
Date: Mon, 27 Apr 2009 22:26:21 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090427202621.85AEA1E8C426@www.metatex.org>

------------------------------------------------------------------------
r2361 | taco | 2009-04-27 16:30:46 +0200 (Mon, 27 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfpage.c

cygwin portability patches

------------------------------------------------------------------------

From mpg at elzevir.fr  Tue Apr 28 00:27:16 2009
From: mpg at elzevir.fr (=?ISO-8859-15?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Tue, 28 Apr 2009 00:27:16 +0200
Subject: [Dev-luatex] \jobname with spaces
Message-ID: <49F63144.4020704@elzevir.fr>

Hi,

Consider the following source file

\edef\x{\jobname}
\show\x

Run it with pdftex, you get:

> \x=macro:
->"foo bar".

With luatex (0.40):

> \x=macro:
->foo bar.

This is a problem eg when using LaTeX when it tries to \input\jobname.aux.

Regardless of any particular format, there is a consistency problem with pdftex,
which should be fixed, imo by making luatex behave the same as pdftex, namely
quote the file name in \jobname.

Thanks,
Manuel.

From taco at elvenkind.com  Tue Apr 28 00:45:50 2009
From: taco at elvenkind.com (Taco Hoekwater)
Date: Tue, 28 Apr 2009 00:45:50 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F63144.4020704@elzevir.fr>
References: <49F63144.4020704@elzevir.fr>
Message-ID: <49F6359E.2050607@elvenkind.com>

Manuel P?gouri?-Gonnard wrote:

> Regardless of any particular format, there is a consistency problem with pdftex,
> which should be fixed, imo by making luatex behave the same as pdftex, namely
> quote the file name in \jobname.

There is a consistency problem with the web2c extension that handles
filename quoting, yes. I have removed the quotes recently after it
became obvious that the quoting mechanism in web2c does not know how
to deal with directory separators in font file names properly.

I'll think about this some more, but just going back to whatever
web2c was doing just because that was what web2c was doing, may not
such a good solution. Perhaps we could backport the braced filename
support to the rest of web2c ...

Best wishes,
Taco



From mpg at elzevir.fr  Tue Apr 28 01:01:59 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Tue, 28 Apr 2009 01:01:59 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F6359E.2050607@elvenkind.com>
References: <49F63144.4020704@elzevir.fr> <49F6359E.2050607@elvenkind.com>
Message-ID: <49F63967.7010609@elzevir.fr>

Taco Hoekwater a ?crit :
> There is a consistency problem with the web2c extension that handles
> filename quoting, yes. I have removed the quotes recently after it
> became obvious that the quoting mechanism in web2c does not know how
> to deal with directory separators in font file names properly.
>
Ok. Isn't it possible to fix web2c quoting mechanism rather than removing the
quotes? (Perhaps more a question for texk...)

> I'll think about this some more, but just going back to whatever
> web2c was doing just because that was what web2c was doing, may not
> such a good solution. Perhaps we could backport the braced filename
> support to the rest of web2c ...
> 
Why not, I have no opinion about that, as long a the solution you choose doesn't
break popular macro packages, such as LaTeX.

Thanks,
Manuel.

From pragma at wxs.nl  Tue Apr 28 08:31:04 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 28 Apr 2009 08:31:04 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F63144.4020704@elzevir.fr>
References: <49F63144.4020704@elzevir.fr>
Message-ID: <49F6A2A8.30701@wxs.nl>

Manuel P?gouri?-Gonnard wrote:
> Hi,
> 
> Consider the following source file
> 
> \edef\x{\jobname}
> \show\x
> 
> Run it with pdftex, you get:
> 
>> \x=macro:
> ->"foo bar".
> 
> With luatex (0.40):
> 
>> \x=macro:
> ->foo bar.
> 
> This is a problem eg when using LaTeX when it tries to \input\jobname.aux.
> 
> Regardless of any particular format, there is a consistency problem with pdftex,
> which should be fixed, imo by making luatex behave the same as pdftex, namely
> quote the file name in \jobname.

more sounds like a bug in pdftex to me, luatex also supports {some name} 
and you don't want {} back then

sorry, but luatex is *not* in all aspecets the same as pdftex

of course you can just overload jobname if it suits you

\let\oldjobname\jobname \def\jobname{"\oldjobname"}

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From oberdiek at uni-freiburg.de  Tue Apr 28 10:02:21 2009
From: oberdiek at uni-freiburg.de (Heiko Oberdiek)
Date: Tue, 28 Apr 2009 10:02:21 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F6A2A8.30701@wxs.nl>
References: <49F63144.4020704@elzevir.fr> <49F6A2A8.30701@wxs.nl>
Message-ID: <20090428080221.GA4462@irwin.vpn.uni-freiburg.de>

On Tue, Apr 28, 2009 at 12:45:50AM +0200, Taco Hoekwater wrote:

> Perhaps we could backport the braced filename
> support to the rest of web2c ...

On Tue, Apr 28, 2009 at 08:31:04AM +0200, Hans Hagen wrote:

> luatex also supports {some name}

According to the documentation braced filenames are supported for
fonts, see 2.7.11 "Font syntax":
  \font\myfont = {cmr10}

But neither \input or \openin supports this syntax:

    \catcode`\{=1
    \catcode`\}=2
    \catcode`\#=6
    \def\msg#{\immediate\write16}

    \openin0={abc def.tex}
    \ifeof0 \msg{EOF}\else\msg{OK}\fi

    \input{abc def.tex}
    \end

File 'abc def.tex' exists, but it isn't found (or other files without spaces
in their name). Result from 'luatex -ini':

    ! Too many }'s.
    l.6 \openin0={abc def.tex}
                              
    ? 
    EOF
    ! I can't find file `{abc'.
    l.14 \input{abc 
                    def.tex}
    Please type another input file name:

Miss I something?
Generally braced file names would be a nice feature.

Yours sincerely
  Heiko <oberdiek at uni-freiburg.de>

From elie.roux at telecom-bretagne.eu  Tue Apr 28 12:32:05 2009
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Tue, 28 Apr 2009 12:32:05 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F6A2A8.30701@wxs.nl>
References: <49F63144.4020704@elzevir.fr> <49F6A2A8.30701@wxs.nl>
Message-ID: <49F6DB25.3030501@telecom-bretagne.eu>

Hans Hagen a ?crit :
> of course you can just overload jobname if it suits you
>
> \let\oldjobname\jobname \def\jobname{"\oldjobname"}

I guess we'll have to add this in the ini files, but this means that the 
behaviour of the primitives start to be different from ConTeXt to Plain 
and LaTeX and I'm not sure it's the best way to go... is it the only 
solution (of course modifying Plain or LaTeX is not an option...)?
-- 
Elie

From pragma at wxs.nl  Wed Apr 29 09:41:07 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 29 Apr 2009 09:41:07 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F6DB25.3030501@telecom-bretagne.eu>
References: <49F63144.4020704@elzevir.fr> <49F6A2A8.30701@wxs.nl>
	<49F6DB25.3030501@telecom-bretagne.eu>
Message-ID: <49F80493.3020408@wxs.nl>

Elie Roux wrote:
> Hans Hagen a ?crit :
>> of course you can just overload jobname if it suits you
>>
>> \let\oldjobname\jobname \def\jobname{"\oldjobname"}
> 
> I guess we'll have to add this in the ini files, but this means that the 
> behaviour of the primitives start to be different from ConTeXt to Plain 

don't worry about that ... if macro packages load each others file at 
all, then it often happens under strict control (i.e. low level wrapped 
code) so no user will be affected

also, since for instance context had some macro names in use that later 
showed up as primitives in engines so "primitive names" already behave 
different anyway

(this i snot so much different from name space issues discussed before)

Hans


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Wed Apr 29 10:15:15 2009
From: taco at elvenkind.com (taco)
Date: Wed, 29 Apr 2009 10:15:15 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <20090428080221.GA4462@irwin.vpn.uni-freiburg.de>
References: <49F63144.4020704@elzevir.fr> <49F6A2A8.30701@wxs.nl>
	<20090428080221.GA4462@irwin.vpn.uni-freiburg.de>
Message-ID: <49F80C93.3070004@elvenkind.com>

Heiko Oberdiek wrote:
> Miss I something?

No.

> Generally braced file names would be a nice feature.

I actually thought I had done that already, so it will certainly
be added soon.

Best wishes,
Taco

From elie.roux at telecom-bretagne.eu  Wed Apr 29 12:15:22 2009
From: elie.roux at telecom-bretagne.eu (Elie Roux)
Date: Wed, 29 Apr 2009 12:15:22 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F80493.3020408@wxs.nl>
References: <49F63144.4020704@elzevir.fr> <49F6A2A8.30701@wxs.nl>
	<49F6DB25.3030501@telecom-bretagne.eu> <49F80493.3020408@wxs.nl>
Message-ID: <49F828BA.2080002@telecom-bretagne.eu>

Hans Hagen a ?crit :
> also, since for instance context had some macro names in use that 
> later showed up as primitives in engines so "primitive names" already 
> behave different anyway

Ok. The only questions remaining are about details: We have to override 
\jobname for LaTeX, this is not an option, but what about Plain? As I 
never use it, I don't know if it's common to have 
\input\jobname.myextention...

Also, how should the old \jobname be renamed? Something like luajobname?

Thank you,
-- 
Elie

From pragma at wxs.nl  Wed Apr 29 15:13:50 2009
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 29 Apr 2009 15:13:50 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F828BA.2080002@telecom-bretagne.eu>
References: <49F63144.4020704@elzevir.fr>
	<49F6A2A8.30701@wxs.nl>	<49F6DB25.3030501@telecom-bretagne.eu>
	<49F80493.3020408@wxs.nl> <49F828BA.2080002@telecom-bretagne.eu>
Message-ID: <49F8528E.3080002@wxs.nl>

Elie Roux wrote:
> Hans Hagen a ?crit :
>> also, since for instance context had some macro names in use that 
>> later showed up as primitives in engines so "primitive names" already 
>> behave different anyway
> 
> Ok. The only questions remaining are about details: We have to override 
> \jobname for LaTeX, this is not an option, but what about Plain? As I 
> never use it, I don't know if it's common to have 
> \input\jobname.myextention...

well, in luatex that's ok then but if pdftex adds "" you'd get \input 
"some name with spaces".myextention which is strange anyway


-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
      tel: 038 477 53 69 | fax: 038 477 53 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From mpg at elzevir.fr  Wed Apr 29 15:53:59 2009
From: mpg at elzevir.fr (=?ISO-8859-1?Q?Manuel_P=E9gouri=E9-Gonnard?=)
Date: Wed, 29 Apr 2009 15:53:59 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F8528E.3080002@wxs.nl>
References: <49F63144.4020704@elzevir.fr>	<49F6A2A8.30701@wxs.nl>	<49F6DB25.3030501@telecom-bretagne.eu>	<49F80493.3020408@wxs.nl>
	<49F828BA.2080002@telecom-bretagne.eu> <49F8528E.3080002@wxs.nl>
Message-ID: <49F85BF7.3090902@elzevir.fr>

Hans Hagen a ?crit :
>> \input\jobname.myextention...
> 
> well, in luatex that's ok then

Hum, unless I'm mistaken that's not ok because while compiling 'foo bar.tex',
you get

\input foo bar.tex

which is likely to complain about a missing foo.tex file.

> but if pdftex adds "" you'd get \input
> "some name with spaces".myextention which is strange anyway
> 
Strange but it "works".

Anyway, the best solution indeed would be to have support for

\input{\jobname.ext}

and adapt existing macro packages.

Manuel.

From dak at gnu.org  Wed Apr 29 17:03:30 2009
From: dak at gnu.org (David Kastrup)
Date: Wed, 29 Apr 2009 17:03:30 +0200
Subject: [Dev-luatex] \jobname with spaces
In-Reply-To: <49F85BF7.3090902@elzevir.fr> ("Manuel =?iso-8859-1?Q?P=E9gou?=
	=?iso-8859-1?Q?ri=E9-Gonnard=22's?=
	message of "Wed, 29 Apr 2009 15:53:59 +0200")
References: <49F63144.4020704@elzevir.fr> <49F6A2A8.30701@wxs.nl>
	<49F6DB25.3030501@telecom-bretagne.eu> <49F80493.3020408@wxs.nl>
	<49F828BA.2080002@telecom-bretagne.eu> <49F8528E.3080002@wxs.nl>
	<49F85BF7.3090902@elzevir.fr>
Message-ID: <85my9zbiyl.fsf@lola.goethe.zz>

Manuel P?gouri?-Gonnard <mpg at elzevir.fr> writes:

> Hans Hagen a ?crit :
>>> \input\jobname.myextention...
>> 
>> well, in luatex that's ok then
>
> Hum, unless I'm mistaken that's not ok because while compiling 'foo bar.tex',
> you get
>
> \input foo bar.tex
>
> which is likely to complain about a missing foo.tex file.

One somewhat perverse solution would be to have \jobname return catcode
12 tokens only (including the space) and let only catcode 10 spaces
finish a file name.

Probably a bit obscure, but it would appear to do the trick to me.

-- 
David Kastrup

From root at www.metatex.org  Wed Apr 29 22:26:21 2009
From: root at www.metatex.org (Cron Daemon)
Date: Wed, 29 Apr 2009 22:26:21 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090429202621.9C8F01E8C2A0@www.metatex.org>

------------------------------------------------------------------------
r2362 | taco | 2009-04-29 18:03:00 +0200 (Wed, 29 Apr 2009) | 1 line
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/math.c

fix handling of mathchars with type 6 (punct, *not* inner)
------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr 30 12:28:08 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 30 Apr 2009 12:28:08 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090430102808.163711E8C2A7@www.metatex.org>

------------------------------------------------------------------------
r2363 | taco | 2009-04-30 09:47:37 +0200 (Thu, 30 Apr 2009) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/liolib.c
   M /trunk/source/texk/web2c/luatexdir/lua/loslibext.c
   M /trunk/source/texk/web2c/luatexdir/lua/luainit.c
   M /trunk/source/texk/web2c/texmfmp.h

remove unnecessary extern declarations from some lualib files
and move those declarations in texmfmp.h to a visible location

------------------------------------------------------------------------

From root at www.metatex.org  Thu Apr 30 16:26:22 2009
From: root at www.metatex.org (Cron Daemon)
Date: Thu, 30 Apr 2009 16:26:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@vz3>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20090430142622.B502A1E8C2A7@www.metatex.org>

------------------------------------------------------------------------
r2364 | oneiros | 2009-04-30 12:22:04 +0200 (Thu, 30 Apr 2009) | 2 lines
Changed paths:
   M /trunk/source/libs/xpdf/xpdf-3.02/goo/gmem.cc
   M /trunk/source/libs/xpdf/xpdf-3.02/xpdf/JBIG2Stream.cc
   M /trunk/source/libs/xpdf/xpdf-3.02/xpdf/JBIG2Stream.h
   M /trunk/source/libs/xpdf/xpdf-3.02/xpdf/config.h

xpdf 3.02pl3

------------------------------------------------------------------------

