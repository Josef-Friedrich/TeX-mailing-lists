From root at mail.boekplan.nl  Wed Sep  1 12:27:53 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed,  1 Sep 2010 12:27:53 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100901102753.A3DD540064@mail.boekplan.nl>

------------------------------------------------------------------------
r3846 | taco | 2010-09-01 07:38:20 +0200 (Wed, 01 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h

it turns out that the 10->13 newline conversion is not needed after all

------------------------------------------------------------------------
r3847 | taco | 2010-09-01 10:29:55 +0200 (Wed, 01 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/aclocal.m4
   M /trunk/source/auxdir/auxsub/configure
   M /trunk/source/configure
   M /trunk/source/libs/configure
   M /trunk/source/libs/libpng/configure
   M /trunk/source/libs/obsdcompat/configure
   M /trunk/source/libs/poppler/configure
   M /trunk/source/libs/zlib/configure
   M /trunk/source/libs/zziplib/configure
   M /trunk/source/texk/configure
   M /trunk/source/texk/kpathsea/aclocal.m4
   M /trunk/source/texk/kpathsea/configure
   M /trunk/source/texk/web2c/aclocal.m4
   M /trunk/source/texk/web2c/configure
   M /trunk/source/texk/web2c/web2c/aclocal.m4
   M /trunk/source/texk/web2c/web2c/configure
   M /trunk/source/utils/configure

autoreconf only (slightly different autotools version)

------------------------------------------------------------------------
r3848 | taco | 2010-09-01 10:34:37 +0200 (Wed, 01 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/writecff.w
   M /trunk/source/texk/web2c/luatexdir/font/writetype2.w

clean up the CIDset calculation

------------------------------------------------------------------------
r3849 | taco | 2010-09-01 11:10:48 +0200 (Wed, 01 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/fdata.lua
   M /trunk/manual/functionref.tex
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/Makefile.in
   M /trunk/source/texk/web2c/luatexdir/am/libluatex.am
   M /trunk/source/texk/web2c/luatexdir/lua/lcallbacklib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatoken.w
   D /trunk/source/texk/web2c/luatexdir/ocp
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/commands.h
   M /trunk/source/texk/web2c/luatexdir/tex/commands.w
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.w
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.w
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.w
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.h
   M /trunk/source/texk/web2c/luatexdir/tex/mainbody.w
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.w
   M /trunk/source/texk/web2c/luatexdir/tex/primitive.w
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.h
   M /trunk/source/texk/web2c/luatexdir/tex/texfileio.w
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.w

remove OCPs

------------------------------------------------------------------------

From root at mail.boekplan.nl  Wed Sep  1 22:27:33 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed,  1 Sep 2010 22:27:33 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100901202733.49BC440064@mail.boekplan.nl>

------------------------------------------------------------------------
r3850 | hhenkel | 2010-09-01 22:02:09 +0200 (Wed, 01 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

add "rotation" key

------------------------------------------------------------------------

From linuxss at list.ru  Thu Sep  2 15:12:46 2010
From: linuxss at list.ru (linuxss)
Date: Thu, 02 Sep 2010 16:12:46 +0300
Subject: [Dev-luatex]  page break in node processing mode
In-Reply-To: <4C726C1F.1080207@wxs.nl>
References: <4C6E89D9.802@wxs.nl>
	<E1OnDv0-0001d0-00.linuxss-list-ru@f231.mail.ru>
	<4C726C1F.1080207@wxs.nl>
Message-ID: <4C7FA2CE.4080401@list.ru>

hallo, Hans!
I'm interested in "page_insert (id 41)" node. It's just mentioned in 
node list, but not documented (in luatexref-t.pdf (beta 0.62.0)).

Is there a chance to break a page (or create a page breaking node) while 
traversing the nodes.
Maybe "page_insert" does that?

tex example:
$2+2$ <---*insert page brake here *
$3+3$

Node traverse example:
.....
 node id=hlist numb(1),      
     node id=math,       subtype=0
        node id=hlist  numb(2),     
        node id=glyph,   2  
        node id=glyph,   +  
        node id=glyph,   2  
        --------->end   hlist numb(2) 
     node id=math,       subtype=1
  --------->end   hlist numb(1)
<-------*insert page brake here*
....
other nodes
....

thanks,
Linas
LuaTeX, Version beta-0.61
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.ntg.nl/pipermail/dev-luatex/attachments/20100902/993919e3/attachment.html>

From linuxss at list.ru  Thu Sep  2 16:03:06 2010
From: linuxss at list.ru (linuxss)
Date: Thu, 02 Sep 2010 17:03:06 +0300
Subject: [Dev-luatex] (no subject)
In-Reply-To: <4C726C1F.1080207@wxs.nl>
References: <4C6E89D9.802@wxs.nl>
	<E1OnDv0-0001d0-00.linuxss-list-ru@f231.mail.ru>
	<4C726C1F.1080207@wxs.nl>
Message-ID: <4C7FAE9A.50706@list.ru>

hi, Hans!
I would like to use epdf library on a current pdf file after its made.
but pdf is still not closed if I use "finish_pdffile" callback.
epdf returns more useful information, then pdf library.
 
function doc_end()
    doc = epdf.open(tex.filename .. ".pdf")
    pageref = doc:getCatalog()
    texio.write_nl("pdfcatalog=".. tostring(pageref))
end

callback.register("finish_pdffile", doc_end)

maybe there could be a callback after document output?

Linas

From pragma at wxs.nl  Thu Sep  2 16:20:53 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 02 Sep 2010 16:20:53 +0200
Subject: [Dev-luatex] page break in node processing mode
In-Reply-To: <4C7FA2CE.4080401@list.ru>
References: <4C6E89D9.802@wxs.nl>
	<E1OnDv0-0001d0-00.linuxss-list-ru@f231.mail.ru>
	<4C726C1F.1080207@wxs.nl> <4C7FA2CE.4080401@list.ru>
Message-ID: <4C7FB2C5.8090506@wxs.nl>

On 2-9-2010 3:12, linuxss wrote:
> hallo, Hans!
> I'm interested in "page_insert (id 41)" node. It's just mentioned in
> node list, but not documented (in luatexref-t.pdf (beta 0.62.0)).
>
> Is there a chance to break a page (or create a page breaking node) while
> traversing the nodes.
> Maybe "page_insert" does that?

no, nodes like that are mentioned in the manual (side effect of the fact 
that the list is auto generated) but not really public ... they are used 
in tex itself when breaking paragraphs and pages .. so they are not 
documented because they are not meant to be used

actually there are a couple of more nodes that you can create and push 
in the list but even then tex has some assumptions about what node to 
expect where so it might give unwanted side effects

the page builder is not opened up yet (the parbuilder is partially 
opened up) so much of that might change before luatex 1.0

concerning breaking a page: you can insert a penalty node with a high 
value (i.e. do at the lua end what normally happens at the tex end)

(btw, 'insert' normally refers to insert nodes)

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From pragma at wxs.nl  Thu Sep  2 16:23:46 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 02 Sep 2010 16:23:46 +0200
Subject: [Dev-luatex] (no subject)
In-Reply-To: <4C7FAE9A.50706@list.ru>
References: <4C6E89D9.802@wxs.nl>
	<E1OnDv0-0001d0-00.linuxss-list-ru@f231.mail.ru>
	<4C726C1F.1080207@wxs.nl> <4C7FAE9A.50706@list.ru>
Message-ID: <4C7FB372.2000101@wxs.nl>

On 2-9-2010 4:03, linuxss wrote:
> hi, Hans!
> I would like to use epdf library on a current pdf file after its made.
> but pdf is still not closed if I use "finish_pdffile" callback.
> epdf returns more useful information, then pdf library.
>
> function doc_end()
> doc = epdf.open(tex.filename .. ".pdf")
> pageref = doc:getCatalog()
> texio.write_nl("pdfcatalog=".. tostring(pageref))
> end
>
> callback.register("finish_pdffile", doc_end)
>
> maybe there could be a callback after document output?

This is unlikely to happen. When the file is closed tex is basically 
finished and cleans up states and so. Of course you can try to hook 
something in the stop_run callback, but as you want to do something 
after the pdf file is created a better approach is to just quit and in a 
next run do what you want to do (you can rename the file inbetween).

Luatex is not primarily a pdf processing tool.

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From linuxss at list.ru  Fri Sep  3 07:37:44 2010
From: linuxss at list.ru (linuxss)
Date: Fri, 03 Sep 2010 08:37:44 +0300
Subject: [Dev-luatex] page break in node processing mode
In-Reply-To: <4C7FB2C5.8090506@wxs.nl>
References: <4C6E89D9.802@wxs.nl>
	<E1OnDv0-0001d0-00.linuxss-list-ru@f231.mail.ru>
	<4C726C1F.1080207@wxs.nl> <4C7FA2CE.4080401@list.ru>
	<4C7FB2C5.8090506@wxs.nl>
Message-ID: <4C8089A8.8010907@list.ru>


> concerning breaking a page: you can insert a penalty node with a high 
> value (i.e. do at the lua end what normally happens at the tex end)
I'll try to play with a penalty.
thank you, Hans!!!


From root at mail.boekplan.nl  Fri Sep  3 16:27:22 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Fri,  3 Sep 2010 16:27:22 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100903142722.8C44340065@mail.boekplan.nl>

------------------------------------------------------------------------
r3851 | taco | 2010-09-03 13:55:16 +0200 (Fri, 03 Sep 2010) | 3 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luanode.w
   M /trunk/source/texk/web2c/luatexdir/lua/luastuff.w
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/extensions.w
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.w

add a a 'string' field to late_lua nodes. This does not
convert the assigned string to a tokenlist

------------------------------------------------------------------------
r3852 | taco | 2010-09-03 15:02:17 +0200 (Fri, 03 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c
   M /trunk/source/texk/web2c/luatexdir/lua/luatex-api.h

implement tex.mathcode[] and tex.delcode[]

------------------------------------------------------------------------

From root at mail.boekplan.nl  Fri Sep  3 22:27:28 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Fri,  3 Sep 2010 22:27:28 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100903202728.5594F40068@mail.boekplan.nl>

------------------------------------------------------------------------
r3853 | oneiros | 2010-09-03 20:05:14 +0200 (Fri, 03 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.h
   M /trunk/source/texk/web2c/luatexdir/lua/luatex-api.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.h
   M /trunk/source/texk/web2c/luatexdir/ptexlib.h
   M /trunk/source/texk/web2c/luatexdir/tex/arithmetic.h
   M /trunk/source/texk/web2c/luatexdir/tex/commands.h
   M /trunk/source/texk/web2c/luatexdir/tex/directions.h
   M /trunk/source/texk/web2c/luatexdir/tex/dumpdata.h
   M /trunk/source/texk/web2c/luatexdir/tex/equivalents.h
   M /trunk/source/texk/web2c/luatexdir/tex/inputstack.h
   M /trunk/source/texk/web2c/luatexdir/tex/linebreak.h
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.h
   M /trunk/source/texk/web2c/luatexdir/tex/textoken.h
   M /trunk/source/texk/web2c/luatexdir/utils/synctex-luatex.h

indent

------------------------------------------------------------------------

From root at mail.boekplan.nl  Sat Sep  4 12:27:39 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Sat,  4 Sep 2010 12:27:39 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100904102739.26C8B40066@mail.boekplan.nl>

------------------------------------------------------------------------
r3854 | taco | 2010-09-04 11:23:41 +0200 (Sat, 04 Sep 2010) | 8 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.w
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.w

* insertion of discretionaries following explicit hyphen characters
now happens in hnj_hyphenation(), not earlier
* the main control loop has been simplified accordingly
* hyphenation exceptions are now case sensitive
* it is now possible to add extra hyphenation points to a compound word 
containing explict hyphens via a hyphenation exception


------------------------------------------------------------------------

From root at mail.boekplan.nl  Sat Sep  4 16:27:30 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Sat,  4 Sep 2010 16:27:30 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100904142730.40C4740066@mail.boekplan.nl>

------------------------------------------------------------------------
r3855 | taco | 2010-09-04 16:01:27 +0200 (Sat, 04 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.w

convert main_control to a jump table

------------------------------------------------------------------------

From taco at elvenkind.com  Sat Sep  4 17:10:10 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sat, 04 Sep 2010 17:10:10 +0200
Subject: [Dev-luatex] script position of textstyle operators
In-Reply-To: <20100818105357.GC4281@khaled-laptop>
References: <20100817194901.GA25709@khaled-laptop>
	<4C6BB2C6.1020803@elvenkind.com>
	<20100818105357.GC4281@khaled-laptop>
Message-ID: <4C826152.8010204@elvenkind.com>

On 08/18/2010 12:53 PM, Khaled Hosny wrote:
> On Wed, Aug 18, 2010 at 12:15:34PM +0200, Taco Hoekwater wrote:
>>
>>
>> Khaled Hosny wrote:
>>> The script position of math operators with opentype fonts that was
>>> solved while ago, seems not have been solved completely, or so it seems.
>>
>> Moved to tracker (I have no time right now).

Khaled, can you please test revision 3856 (trunk)? I seem to
have an outdated luaotfload or an outdated xits-math, because
I get different output from the pdf you sent.

Best wishes,
Taco

From khaledhosny at eglug.org  Sat Sep  4 17:19:59 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sat, 4 Sep 2010 17:19:59 +0200
Subject: [Dev-luatex] script position of textstyle operators
In-Reply-To: <4C826152.8010204@elvenkind.com>
References: <20100817194901.GA25709@khaled-laptop>
	<4C6BB2C6.1020803@elvenkind.com>
	<20100818105357.GC4281@khaled-laptop>
	<4C826152.8010204@elvenkind.com>
Message-ID: <20100904151959.GA10279@khaled-laptop>

On Sat, Sep 04, 2010 at 05:10:10PM +0200, Taco Hoekwater wrote:
> On 08/18/2010 12:53 PM, Khaled Hosny wrote:
> >On Wed, Aug 18, 2010 at 12:15:34PM +0200, Taco Hoekwater wrote:
> >>
> >>
> >>Khaled Hosny wrote:
> >>>The script position of math operators with opentype fonts that was
> >>>solved while ago, seems not have been solved completely, or so it seems.
> >>
> >>Moved to tracker (I have no time right now).
> 
> Khaled, can you please test revision 3856 (trunk)? I seem to
> have an outdated luaotfload or an outdated xits-math, because
> I get different output from the pdf you sent.

Yes, fixed now. Thanks.
(Now I need to adjust the italic correction a bit).

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From patrick at gundla.ch  Sat Sep  4 21:29:01 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Sat, 4 Sep 2010 21:29:01 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <20100904102739.26C8B40066@mail.boekplan.nl>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
Message-ID: <39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>


[changes from svn/cron]

> * hyphenation exceptions are now case sensitive

Does that mean that if I write

\hyphenation{man-u-script}

"Manuscript" will not be covered?


Patrick


From root at mail.boekplan.nl  Sat Sep  4 22:27:43 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Sat,  4 Sep 2010 22:27:43 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100904202743.3BD3840066@mail.boekplan.nl>

------------------------------------------------------------------------
r3856 | taco | 2010-09-04 17:08:01 +0200 (Sat, 04 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/mlist.w

hopefully fix bug #466

------------------------------------------------------------------------

From taco at elvenkind.com  Sat Sep  4 22:32:16 2010
From: taco at elvenkind.com (taco)
Date: Sat, 04 Sep 2010 22:32:16 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>
Message-ID: <4C82ACD0.8020803@elvenkind.com>

Patrick Gundlach wrote:
> [changes from svn/cron]
> 
>> * hyphenation exceptions are now case sensitive
> 
> Does that mean that if I write
> 
> \hyphenation{man-u-script}
> 
> "Manuscript" will not be covered?

Yes, exactly. It seemed a reasonable thing to do,
considering that it is considerably easier to add another
exception than it is to prevent an unwanted hyphenation if it
is defined by an exception.

Best wishes,
Taco

From oudomphe at phare.normalesup.org  Sun Sep  5 01:02:44 2010
From: oudomphe at phare.normalesup.org (Oudompheng =?UTF-8?B?UsOpbXk=?=)
Date: Sun, 05 Sep 2010 01:02:44 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
References: <20100904102739.26C8B40066@mail.boekplan.nl>
Message-ID: <i5uj6l$uf1$1@dough.gmane.org>

Cron Daemon wrote:
> * it is now possible to add extra hyphenation points to a compound word
> containing explict hyphens via a hyphenation exception

I do not quite understand this comment: what syntax is used to specify 
hyphenation for the word "pseudo-compatible" for example ?

-- 
R?my.


From khaledhosny at eglug.org  Sun Sep  5 07:54:07 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 5 Sep 2010 07:54:07 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
 /var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <i5uj6l$uf1$1@dough.gmane.org>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<i5uj6l$uf1$1@dough.gmane.org>
Message-ID: <20100905055406.GA5272@khaled-laptop>

On Sun, Sep 05, 2010 at 01:02:44AM +0200, Oudompheng R?my wrote:
> Cron Daemon wrote:
> > * it is now possible to add extra hyphenation points to a compound word
> > containing explict hyphens via a hyphenation exception
> 
> I do not quite understand this comment: what syntax is used to specify 
> hyphenation for the word "pseudo-compatible" for example ?

I think it is explained in the manual (that was updated in that commit).

(I really appreciate that LuaTeX has a reference manual right from the
start, that is actively maintained and not an afterthought.)

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From taco at elvenkind.com  Sun Sep  5 08:44:55 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 05 Sep 2010 08:44:55 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <i5uj6l$uf1$1@dough.gmane.org>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<i5uj6l$uf1$1@dough.gmane.org>
Message-ID: <4C833C67.1070800@elvenkind.com>

On 09/05/2010 01:02 AM, Oudompheng R?my wrote:
> Cron Daemon wrote:
>> * it is now possible to add extra hyphenation points to a compound word
>> containing explict hyphens via a hyphenation exception
>
> I do not quite understand this comment: what syntax is used to specify
> hyphenation for the word "pseudo-compatible" for example ?

Please rtfm, it is not just my diary. Anyway:

   \hyphenation{pseudo{-}{}{-}compa-tible}

Best wishes,
Taco



From patrick at gundla.ch  Sun Sep  5 14:55:40 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Sun, 5 Sep 2010 14:55:40 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <4C82ACD0.8020803@elvenkind.com>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>
	<4C82ACD0.8020803@elvenkind.com>
Message-ID: <CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>



> Patrick Gundlach wrote:
>> [changes from svn/cron]
>>> * hyphenation exceptions are now case sensitive
>> Does that mean that if I write
>> \hyphenation{man-u-script}
>> "Manuscript" will not be covered?
> 
> Yes, exactly. It seemed a reasonable thing to do,
> considering that it is considerably easier to add another
> exception than it is to prevent an unwanted hyphenation if it
> is defined by an exception.

While I don't have an opinion at all on whether this is good or not, won't this

a) break TeX compatibility and b) will make existing documents (hyphenation exceptions) "fail" ?

I am _not_ asking to change anything, I am just wondering and trying to understand TeX.


Patrick


From taco at elvenkind.com  Sun Sep  5 16:35:16 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 05 Sep 2010 16:35:16 +0200
Subject: [Dev-luatex]
	Cron	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
References: <20100904102739.26C8B40066@mail.boekplan.nl>	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>	<4C82ACD0.8020803@elvenkind.com>
	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
Message-ID: <4C83AAA4.3040704@elvenkind.com>

On 09/05/2010 02:55 PM, Patrick Gundlach wrote:
>
>
>> Patrick Gundlach wrote:
>>> [changes from svn/cron]
>>>> * hyphenation exceptions are now case sensitive
>>> Does that mean that if I write
>>> \hyphenation{man-u-script}
>>> "Manuscript" will not be covered?
>>
>> Yes, exactly. It seemed a reasonable thing to do,
>> considering that it is considerably easier to add another
>> exception than it is to prevent an unwanted hyphenation if it
>> is defined by an exception.
>
> While I don't have an opinion at all on whether this is good or not, won't this
>
> a) break TeX compatibility and

Yeah, sure it does. But LuaTeX's language handling is already
incompatible in other ways, so that is not a big deal.

> b) will make existing documents (hyphenation exceptions) "fail" ?

Yes, for example:

    bla bla bla. Declination is ....

will not use the standard hyphen.tex exception for "Declination".

Personally, I think this is acceptable. But if there are objections,
I can go back to being case-incensitive, it is not that important.

Best wishes,
Taco

From khaledhosny at eglug.org  Sun Sep  5 16:43:43 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 5 Sep 2010 16:43:43 +0200
Subject: [Dev-luatex] Cron	<luatex@boekplan>
 /var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <4C83AAA4.3040704@elvenkind.com>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>
	<4C82ACD0.8020803@elvenkind.com>
	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
	<4C83AAA4.3040704@elvenkind.com>
Message-ID: <20100905144342.GA11073@khaled-laptop>

On Sun, Sep 05, 2010 at 04:35:16PM +0200, Taco Hoekwater wrote:
> On 09/05/2010 02:55 PM, Patrick Gundlach wrote:
> >
> >
> >>Patrick Gundlach wrote:
> >>>[changes from svn/cron]
> >>>>* hyphenation exceptions are now case sensitive
> >>>Does that mean that if I write
> >>>\hyphenation{man-u-script}
> >>>"Manuscript" will not be covered?
> >>
> >>Yes, exactly. It seemed a reasonable thing to do,
> >>considering that it is considerably easier to add another
> >>exception than it is to prevent an unwanted hyphenation if it
> >>is defined by an exception.
> >
> >While I don't have an opinion at all on whether this is good or not, won't this
> >
> >a) break TeX compatibility and
> 
> Yeah, sure it does. But LuaTeX's language handling is already
> incompatible in other ways, so that is not a big deal.
> 
> >b) will make existing documents (hyphenation exceptions) "fail" ?
> 
> Yes, for example:
> 
>    bla bla bla. Declination is ....
> 
> will not use the standard hyphen.tex exception for "Declination".
> 
> Personally, I think this is acceptable. But if there are objections,
> I can go back to being case-incensitive, it is not that important.

Since we are using different hyphenation patterns anyway (may be except
for English), then I think it is better to adapt hyphenation patterns, I
don't even see a reason for defaulting to Knuth's patterns for English,
since the output is likely to be different anyway.

Regards,
 Khaled

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From taco at elvenkind.com  Sun Sep  5 17:08:43 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 05 Sep 2010 17:08:43 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>
Message-ID: <4C83B27B.30604@elvenkind.com>


Hi,

It has been a busy day.

On 09/05/2010 04:39 PM, taco at metatex.org wrote:
> New Revision: 3857
>
> Log:
> add some virtual accessors to fontloader.open() return data

Here is the relevant new section in the manual:

%%% start manual

As mentioned earlier, the return value of \type{fontloader.open()} is a 
userdata object. In \LUATEX\ versions before 0.63, the only way to have 
access to the actual metrics was to call \type{fontloader.to_table()} 
on this object, returning a table structure that is explained in the 
following subsections.

However, it turns out that the result from \type{fontloader.to_table()} 
sometimes needs very large amounts of memory (depending on the font's 
complexity and size) so starting with \LUATEX\ 0.63, it will 
incrementally become possible to access the userdata object directly.

In the \LUATEX\ 0.63.0, the following is implemented:

\startitemize
\item all top-level keys that would be returned by \type{to_table()} can 
also be accessed directly.
\item the top-level key \quote{glyphs} returns a {\it virtual\/} array 
that allows indices from \type{0} to ($\type{f.glyphmax}-1$).
\item the items in that virtual array (the actual glyphs) are themselves 
also userdata objects, and each has accessors for all of the keys 
explained in the section \quote{Glyph items} below.
\item the top-level key \quote{subfonts} returns an {\it actual} array 
of userdata objects, one for each of the subfonts (or nil, if there are 
no subfonts).
\stopitemize

A short example may be helpful. This code generates a printout of all 
the glyph names in the font \type{PunkNova.kern.otf}:

\starttyping
local f = fontloader.open('PunkNova.kern.otf')
print (f.fontname);
local i = 0
while (i < f.glyphmax) do
    local g = f.glyphs[i]
    if g then
       print(g.name)
    end
    i = i + 1
end
fontloader.close(f)
\stoptyping

In this case, the \LUATEX\ memory requirement stays below 100MB on the 
test computer, while the internal stucture generated by 
\type{to_table()} needs more than 2GB of memory (the font itself is 
6.9MB in disk size).

In \LUATEX\ 0.63 only the top-level font, the subfont table entries, and 
the glyphs are virtual objects, everything else still produces normal 
lua values and tables. In future versions, more return values will be 
replaced by userdata objects (as much as needed to keep the
memory requirements in check).

%%% end manual

For course the memory savings will be less when more of the font 
information is used than just the glyph names, but it does seem to help
quite a lot already (assuming the characters are converted into a 
metrics structure one at a time).

The reason for this message is this: what are items that need to be 
virtualized, and which ones can easily be left alone?

For example

   <glyph>.boundingbox

returns an array of 4 integer numbers. It seems to me that it makes
not that much sense to write a dedicated userdata object for such
boundingboxes: the method call overhead will probably outweigh the
gain from using less memory.

On the other hand,

    <glyph>.kerns

can be enormous (as it is in the punknova.kern case) and should probably
be converted.

Does anybody want to think about a shortlist of such items?

Best wishes,
Taco










From arthur.reutenauer at normalesup.org  Sun Sep  5 17:10:37 2010
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Sun, 5 Sep 2010 17:10:37 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <20100905144342.GA11073@khaled-laptop>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>
	<4C82ACD0.8020803@elvenkind.com>
	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
	<4C83AAA4.3040704@elvenkind.com>
	<20100905144342.GA11073@khaled-laptop>
Message-ID: <20100905151037.GB27273@phare.normalesup.org>

> Since we are using different hyphenation patterns anyway

  Not really, apart for German, for which patterns are being actively
updated and tested.  For most of the other languages we still use
patterns that are sometimes several decades old, and not really
maintained by anyone.  The only difference between UTF-8 TeX engines and
8-bit engines is that for the latter ones, the patterns are converted to
an appropriate 8-bit encoding on the fly, with the additional difference
that LuaTeX can load patterns on demand during each run, but it still
uses the same patterns.

	Arthur

From root at mail.boekplan.nl  Sun Sep  5 22:26:52 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Sun,  5 Sep 2010 22:26:52 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100905202652.DB0CB40066@mail.boekplan.nl>

------------------------------------------------------------------------
r3857 | taco | 2010-09-05 16:39:50 +0200 (Sun, 05 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

add some virtual accessors to fontloader.open() return data

------------------------------------------------------------------------
r3858 | taco | 2010-09-05 16:53:50 +0200 (Sun, 05 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/ltexlib.c

remove the error when assigning to tex.XXXX fields that are known primitives

------------------------------------------------------------------------
r3859 | oneiros | 2010-09-05 17:28:09 +0200 (Sun, 05 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

rm unused variables, fix some warnings

------------------------------------------------------------------------
r3860 | oneiros | 2010-09-05 17:29:47 +0200 (Sun, 05 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

indent

------------------------------------------------------------------------

From mailing_list at arcor.de  Mon Sep  6 10:47:38 2010
From: mailing_list at arcor.de (Stephan Hennig)
Date: Mon, 06 Sep 2010 10:47:38 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <4C83AAA4.3040704@elvenkind.com>
References: <20100904102739.26C8B40066@mail.boekplan.nl>	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>	<4C82ACD0.8020803@elvenkind.com>	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
	<4C83AAA4.3040704@elvenkind.com>
Message-ID: <4C84AAAA.7000802@arcor.de>

Am 05.09.2010 16:35, schrieb Taco Hoekwater:
> On 09/05/2010 02:55 PM, Patrick Gundlach wrote:
>>
>> b) will make existing documents (hyphenation exceptions) "fail" ?
>
> Yes, for example:
>
>      bla bla bla. Declination is ....
>
> will not use the standard hyphen.tex exception for "Declination".

What about patterns, are they going to be case-sensitive, too?  That 
could resolve one class of homonyms in German language, e.g.,

    spie-len-de  vs.  Spiel-en-de

At the same time, I think the number of used levels (we are at level 8 
already), average pattern length, and number of matching patterns per 
word could decrease, because case-sensitive patterns are should be more 
specific then case-insensitive ones.  All at the cost of more patterns 
of course, but I haven't done any tests so far.  I'll report back, if I 
have some numbers.


> Personally, I think this is acceptable. But if there are objections,
> I can go back to being case-incensitive, it is not that important.

A configuration option seems sensible that, if set to case-insensitive, 
lower-cases words before pattern matching, effectively ignoring patterns 
containing upper-case letters (lower-casing patterns, too, could 
generate conflicting patterns).  I have no preference for the default 
behaviour, though.  Hyphenation quality would go down in both cases, 
case-insensitive patterns are used with a case-sensitive pattern 
matching strategy and vice versa.  But it would preserve (a way for) 
backwards-compatibility, i.e., maintaining the current level of 
hyphenation quality, when existing patterns are used.

Best regards,
Stephan Hennig

From patrick at gundla.ch  Mon Sep  6 10:54:51 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Mon, 6 Sep 2010 10:54:51 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <4C84AAAA.7000802@arcor.de>
References: <20100904102739.26C8B40066@mail.boekplan.nl>	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>	<4C82ACD0.8020803@elvenkind.com>	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
	<4C83AAA4.3040704@elvenkind.com> <4C84AAAA.7000802@arcor.de>
Message-ID: <12FB0E65-9E6B-4922-A3CE-6E023C094D6C@gundla.ch>



> What about patterns, are they going to be case-sensitive, too?  That could resolve one class of homonyms in German language, e.g.,
> 
>   spie-len-de  vs.  Spiel-en-de
> 

"Spielende" can be hyphenated the first way if it starts at the beginning of the sentence:

"Spie-len-de Kinder sehe ich jeden Tag."

Patrick


From taco at elvenkind.com  Mon Sep  6 11:42:21 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 06 Sep 2010 11:42:21 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <4C84AAAA.7000802@arcor.de>
References: <20100904102739.26C8B40066@mail.boekplan.nl>	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>	<4C82ACD0.8020803@elvenkind.com>	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>	<4C83AAA4.3040704@elvenkind.com>
	<4C84AAAA.7000802@arcor.de>
Message-ID: <4C84B77D.7080900@elvenkind.com>


Hi,

On 09/06/10 10:47, Stephan Hennig wrote:
> 
> A configuration option seems sensible that, if set to case-insensitive,
> lower-cases words before pattern matching, effectively ignoring patterns

That would be getting silly. I will revert to case-insensitive exceptions.

Best wishes,
Taco

From mailing_list at arcor.de  Mon Sep  6 14:01:18 2010
From: mailing_list at arcor.de (Stephan Hennig)
Date: Mon, 06 Sep 2010 14:01:18 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <12FB0E65-9E6B-4922-A3CE-6E023C094D6C@gundla.ch>
References: <20100904102739.26C8B40066@mail.boekplan.nl>	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>	<4C82ACD0.8020803@elvenkind.com>	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>	<4C83AAA4.3040704@elvenkind.com>
	<4C84AAAA.7000802@arcor.de>
	<12FB0E65-9E6B-4922-A3CE-6E023C094D6C@gundla.ch>
Message-ID: <4C84D80E.8020601@arcor.de>

Am 06.09.2010 10:54, schrieb Patrick Gundlach:
>
>
>> What about patterns, are they going to be case-sensitive, too?  That could resolve one class of homonyms in German language, e.g.,
>>
>>    spie-len-de  vs.  Spiel-en-de
>>
>
> "Spielende" can be hyphenated the first way if it starts at the beginning of the sentence:
>
> "Spie-len-de Kinder sehe ich jeden Tag."

Ouch, didn't think about capitalisation at sentence beginning!  As in 
German language every word can be at the beginning of a sentence, 
case-sensitive hyphenation would indeed introduce new errors (where 
there are clear rules what hyphenation to prefer for homonyms in our 
patterns currently).  Case-sensitive hyphenation seems to need grammar 
analysis.

Best regards,
Stephan Hennig

From martin at oneiros.de  Mon Sep  6 14:17:03 2010
From: martin at oneiros.de (=?ISO-8859-1?Q?Martin_Schr=F6der?=)
Date: Mon, 6 Sep 2010 14:17:03 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <4C84D80E.8020601@arcor.de>
References: <20100904102739.26C8B40066@mail.boekplan.nl>
	<39B5D606-2187-4712-A730-A2DF54D24EB8@gundla.ch>
	<4C82ACD0.8020803@elvenkind.com>
	<CD926F3B-9C96-4C08-A6BC-C79CB7A65CA4@gundla.ch>
	<4C83AAA4.3040704@elvenkind.com> <4C84AAAA.7000802@arcor.de>
	<12FB0E65-9E6B-4922-A3CE-6E023C094D6C@gundla.ch>
	<4C84D80E.8020601@arcor.de>
Message-ID: <AANLkTiksGt6-u-pZUxktvOotMS37WGi7T9OiooVy5-Mo@mail.gmail.com>

2010/9/6 Stephan Hennig <mailing_list at arcor.de>:
> ?Case-sensitive hyphenation seems to need grammar analysis.

Seems like a problem best solved by iTeX. :-)

Best
   Martin

From root at mail.boekplan.nl  Mon Sep  6 22:27:56 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Mon,  6 Sep 2010 22:27:56 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100906202756.2B2D540074@mail.boekplan.nl>

------------------------------------------------------------------------
r3861 | taco | 2010-09-06 17:48:02 +0200 (Mon, 06 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/mplibdir/lmplib.c

don't use the 'size' of the metapost postscript buffer but the 'used'

------------------------------------------------------------------------

From root at mail.boekplan.nl  Tue Sep  7 12:27:52 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue,  7 Sep 2010 12:27:52 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100907102752.9F53B4007E@mail.boekplan.nl>

------------------------------------------------------------------------
r3862 | taco | 2010-09-07 07:31:42 +0200 (Tue, 07 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

fix two cases of TEX_UNDEF in the virtual font accessors

------------------------------------------------------------------------
r3863 | taco | 2010-09-07 07:36:16 +0200 (Tue, 07 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/commands.h
   M /trunk/source/texk/web2c/luatexdir/tex/maincontrol.w

fix \leftghost and \rightghost in math mode

------------------------------------------------------------------------
r3864 | taco | 2010-09-07 09:26:43 +0200 (Tue, 07 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

add fontloader.fields() function

------------------------------------------------------------------------

From P.Jackowski at gust.org.pl  Tue Sep  7 20:12:21 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Tue, 07 Sep 2010 20:12:21 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C83B27B.30604@elvenkind.com>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>
	<4C83B27B.30604@elvenkind.com>
Message-ID: <4C868085.70807@gust.org.pl>


[...]
> The reason for this message is this: what are items that need to be 
> virtualized, and which ones can easily be left alone?
> 
> For example
> 
>   <glyph>.boundingbox
> 
> returns an array of 4 integer numbers. It seems to me that it makes
> not that much sense to write a dedicated userdata object for such
> boundingboxes: the method call overhead will probably outweigh the
> gain from using less memory.
> 
> On the other hand,
> 
>    <glyph>.kerns
> 
> can be enormous (as it is in the punknova.kern case) and should probably
> be converted.
> 
> Does anybody want to think about a shortlist of such items?

Wow! Thank you for preserving objects access interface; it seems I don't 
need to change anything.

Among glyph.kerns I'd vote to virtualize glyph.lookups, as this is the 
_most_ scary part, especially in non-latin fonts. Possibly also 
glyph.anchors

Regarding mappings, I think that every of the following

	loaded_font.map.map
	loaded_font.map.backmap
	loaded_font.map.enc

could be available on demand.

Regards
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From root at mail.boekplan.nl  Tue Sep  7 22:25:11 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue,  7 Sep 2010 22:25:11 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100907202954.605F240086@mail.boekplan.nl>

svn: OPTIONS of 'http://foundry.supelec.fr/svn/luatex': could not connect to server (http://foundry.supelec.fr)

From pragma at wxs.nl  Tue Sep  7 22:45:24 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Tue, 07 Sep 2010 22:45:24 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C868085.70807@gust.org.pl>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>
	<4C868085.70807@gust.org.pl>
Message-ID: <4C86A464.20204@wxs.nl>

On 7-9-2010 8:12, Pawe? Jackowski wrote:
>
> [...]
>> The reason for this message is this: what are items that need to be
>> virtualized, and which ones can easily be left alone?
>>
>> For example
>>
>> <glyph>.boundingbox
>>
>> returns an array of 4 integer numbers. It seems to me that it makes
>> not that much sense to write a dedicated userdata object for such
>> boundingboxes: the method call overhead will probably outweigh the
>> gain from using less memory.
>>
>> On the other hand,
>>
>> <glyph>.kerns
>>
>> can be enormous (as it is in the punknova.kern case) and should probably
>> be converted.
>>
>> Does anybody want to think about a shortlist of such items?
>
> Wow! Thank you for preserving objects access interface; it seems I don't
> need to change anything.

It all depends on usage ... I need to change a lot (to more ugly code 
actually) and we're only talking of a partial userdata -)

> Among glyph.kerns I'd vote to virtualize glyph.lookups, as this is the
> _most_ scary part, especially in non-latin fonts. Possibly also
> glyph.anchors

it doesn't make it less scary, does it?

> Regarding mappings, I think that every of the following
>
> loaded_font.map.map
> loaded_font.map.backmap
> loaded_font.map.enc

I've experimented a lot with these things (mem consumption, speed, eyc) 
and and there is quite a trade-off

- accessing them as userdata each time needed takes a function call and 
is slower than accessing a table

- most tables are not that large data and hardly give overhead

- as soon as you would like to have the data at the lua end more 
permanently you have to do quite some (inefficient) table construction

- there is no gain in for instance the map tables, and if one needs them 
one often needs the whole table and unless you make a copy you then need 
to keep the font object in memory

it all depends on how you use fonts ...

(1) just consult then ... the current userdata saves much mem as one can 
access selectively

(2) construct a tex font (tfm table) ... one stepwise fills the tfm data 
structure, and keeps whatever needed around, and then closes the 
fontloader object

(3) idem but keeping the object open

in case 2 there will be the penalty of constructing tables from userdata 
but we win in less memory consumption of glyph data (if not used at the 
lua end); in case 3 you basically loose the gain as you need to keep the 
whole font in mem anyway, ok, not in table form, but one will probably 
also cache some info so that duplicates and the gain gets lost

the advantage of the userdata for glyphs and the root tables is that one 
delays table conversion but eventually one will need much of the data 
but at least it can be fetched selectively; the userdata keeps the 
memory footprint low in the sense that less intermediate data is needed

so, it's kind of a mix ... partial userdata helps, but too much of it 
works against us

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Wed Sep  8 07:35:55 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 08 Sep 2010 07:35:55 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C86A464.20204@wxs.nl>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>	<4C868085.70807@gust.org.pl>
	<4C86A464.20204@wxs.nl>
Message-ID: <4C8720BB.2080904@elvenkind.com>

Hi,

On 09/07/10 22:45, Hans Hagen wrote:
> 
> the advantage of the userdata for glyphs and the root tables is that one
> delays table conversion but eventually one will need much of the data
> but at least it can be fetched selectively; the userdata keeps the
> memory footprint low in the sense that less intermediate data is needed

The glyph kerning information is a good example: usually when processing
a fontloader font into a metrics table, you need access to all of that
data (at least per glyph). Therefore, there is not that much point in
totally virtualizing the 'kerns' entry as then each access to it becomes
a method call, which will slow down processing considerably, and the
end result is likely to use a fair amount of memory anyway.

Here is the current format of 'kerns', with punknova.kern.otf as
example:

<f>.glyphs[65].kerns={
 {
  ["char"]="quotedblright.9",
  ["lookup"]={ "pp_l_0_g_4", "pp_l_0_g_5", ... 94 more entries ... },
  ["off"]=24,
 },
 {
  ["char"]="quotedblleft.9",
  ...

There is not a lot to be gained from virtualizing this, even though the
dump of each of the kerns per-glyhp tables is nearly 2 megabytes. The
reason is that you typically need code like this:

  for _,v in pairs(<f>.glyphs[0].kerns) do
    local n = v.char
    local off = v.off
    for _,l in pairs(v.lookup) do
       ...
    end
  end

So you are accessing everything (and likely will even convert it to
a temporary table at some point).

In punknova.kern, there tend to be 1242 top-level kern array entries,
each of which has about a little under a hundred keys. That would be
over 100k worth of metatable lookups, and that will definitely be
slower than accessing the actual table that is returned at the moment.

Best wishes,
Taco

From root at mail.boekplan.nl  Wed Sep  8 12:27:14 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed,  8 Sep 2010 12:27:14 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100908102714.3BB7240086@mail.boekplan.nl>

------------------------------------------------------------------------
r3865 | taco | 2010-09-08 07:45:52 +0200 (Wed, 08 Sep 2010) | 5 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

remove the generation of 'automatic' glyph classes, and reword the
documentation to remove the definitiveness of further conversion
to userdata.


------------------------------------------------------------------------

From taco at elvenkind.com  Wed Sep  8 18:57:18 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Wed, 08 Sep 2010 18:57:18 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C8720BB.2080904@elvenkind.com>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>	<4C868085.70807@gust.org.pl>	<4C86A464.20204@wxs.nl>
	<4C8720BB.2080904@elvenkind.com>
Message-ID: <4C87C06E.1090504@elvenkind.com>

Hi,

On 09/08/2010 07:35 AM, Taco Hoekwater wrote:
>
> In punknova.kern, there tend to be 1242 top-level kern array entries,
> each of which has about a little under a hundred keys. That would be
> over 100k worth of metatable lookups, and that will definitely be
> slower than accessing the actual table that is returned at the moment.

Also, each of those metatable calls would introduce a new userdata
object to be garbage collected.

Hans and I just did some tests, and it seems that the userdata access
is useful if *but only if* you are very low on memory. In other cases,
it just adds extra objects to be garbage collected, which makes the
collector slower. That is on top of extra time spent on the actual
calls, and even worse: those extra gc objects tend to be scattered
around in memory, resulting in extra minor page faults (cpu cache
misses) and all that has a  noticeable  effect on run speed: the
metatable-based access is 20-30%  slower than the old massive to_table.

Therefore, there seems little point in expanding the metadata
functionality any further. What is there will stay, but adding more
metadata objects appears to be a waste of time on all sides.

Best wishes,
Taco


From graham.douglas at readytext.co.uk  Wed Sep  8 19:20:11 2010
From: graham.douglas at readytext.co.uk (Graham Douglas)
Date: Wed, 08 Sep 2010 18:20:11 +0100
Subject: [Dev-luatex] Documentation update/suggestion
In-Reply-To: <mailman.5.1283940002.31061.dev-luatex@ntg.nl>
References: <mailman.5.1283940002.31061.dev-luatex@ntg.nl>
Message-ID: <4C87C5CB.4020806@readytext.co.uk>

Hi Taco

Firstly, thank you and the team for the continued stream
of updates etc to LuaTeX.

I was wondering if the mplib section of the LuaTeX Reference should
be updated to reflect that the MPlib library no longer uses mem files
--- according to a post you made recently:

-------------
Perhaps it has something to do with the fact that luatex 0.61.0
uses mplib 1.502, which does not use actual mem files. Not only
that, but at the moment basically only the 'ini_version' mode of mplib
works, so the way to set up a mplib instance with a preloaded set of
macros is like this (ignoring error testing):

     function newmpx (memname)
         local preamble = "let dump = endinput ; input %s ;"
         local mpx = mplib.new {
             ini_version = true,
             find_file = finder, -- change this as needed
         }
         return mpx:execute(string.format(preamble, memname))
     end

Code like this has been added to ConTeXt, but I do not know whether
luamplib has caught up with that yet.

Best wishes,
Taco
---------------------

I'd forgotten this until I recalled reading your post.
An example with a simple finder function and a simple test
graphic would I think be most welcome.

Best wishes and thanks again for the continued and marvellous
work of the LuaTeX team.

Graham









From pragma at wxs.nl  Wed Sep  8 20:44:07 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Wed, 08 Sep 2010 20:44:07 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C87C06E.1090504@elvenkind.com>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>	<4C868085.70807@gust.org.pl>	<4C86A464.20204@wxs.nl>
	<4C8720BB.2080904@elvenkind.com> <4C87C06E.1090504@elvenkind.com>
Message-ID: <4C87D977.1040708@wxs.nl>

On 8-9-2010 6:57, Taco Hoekwater wrote:
> Hi,
>
> On 09/08/2010 07:35 AM, Taco Hoekwater wrote:
>>
>> In punknova.kern, there tend to be 1242 top-level kern array entries,
>> each of which has about a little under a hundred keys. That would be
>> over 100k worth of metatable lookups, and that will definitely be
>> slower than accessing the actual table that is returned at the moment.
>
> Also, each of those metatable calls would introduce a new userdata
> object to be garbage collected.
>
> Hans and I just did some tests, and it seems that the userdata access
> is useful if *but only if* you are very low on memory. In other cases,
> it just adds extra objects to be garbage collected, which makes the
> collector slower. That is on top of extra time spent on the actual
> calls, and even worse: those extra gc objects tend to be scattered
> around in memory, resulting in extra minor page faults (cpu cache
> misses) and all that has a noticeable effect on run speed: the
> metatable-based access is 20-30% slower than the old massive to_table.
>
> Therefore, there seems little point in expanding the metadata
> functionality any further. What is there will stay, but adding more
> metadata objects appears to be a waste of time on all sides.

quite some time went in rewriting mkiv font loading code to do these 
tests and as i don't want to throw it away, mkiv will provide several 
loading methods but the table based one will be the default; we will 
wrap up some stats in an (maybe mapsable) article some day although a 
sound strategy for when to use what method (as taco explained) is not 
possible

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From root at mail.boekplan.nl  Wed Sep  8 22:27:29 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed,  8 Sep 2010 22:27:29 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100908202729.6758540086@mail.boekplan.nl>

------------------------------------------------------------------------
r3866 | taco | 2010-09-08 18:06:09 +0200 (Wed, 08 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

fix crashes in cidfonts by creating an extra userdata type (without __gc metamethod)

------------------------------------------------------------------------

From P.Jackowski at gust.org.pl  Thu Sep  9 09:07:18 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Thu, 09 Sep 2010 09:07:18 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C87C06E.1090504@elvenkind.com>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>	<4C868085.70807@gust.org.pl>	<4C86A464.20204@wxs.nl>	<4C8720BB.2080904@elvenkind.com>
	<4C87C06E.1090504@elvenkind.com>
Message-ID: <4C8887A6.6040300@gust.org.pl>

Taco Hoekwater wrote:
[...]
> Hans and I just did some tests, and it seems that the userdata access
> is useful if *but only if* you are very low on memory. In other cases,
> it just adds extra objects to be garbage collected, which makes the
> collector slower. That is on top of extra time spent on the actual
> calls, and even worse: those extra gc objects tend to be scattered
> around in memory, resulting in extra minor page faults (cpu cache
> misses) and all that has a  noticeable  effect on run speed: the
> metatable-based access is 20-30%  slower than the old massive to_table.

Interesting. As you said, much depends on how one uses / tests. I made 
some tests with translating fontforge font structure directly into the 
luatex font table without an intermediate form. This gives bests 
results, but obviously requires too many simplifications.

> Therefore, there seems little point in expanding the metadata
> functionality any further. What is there will stay, but adding more
> metadata objects appears to be a waste of time on all sides.

OK, thank you.

-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From pragma at wxs.nl  Thu Sep  9 10:16:32 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 09 Sep 2010 10:16:32 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C8887A6.6040300@gust.org.pl>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>	<4C868085.70807@gust.org.pl>	<4C86A464.20204@wxs.nl>	<4C8720BB.2080904@elvenkind.com>
	<4C87C06E.1090504@elvenkind.com> <4C8887A6.6040300@gust.org.pl>
Message-ID: <4C8897E0.6080002@wxs.nl>

On 9-9-2010 9:07, Pawe? Jackowski wrote:
> Taco Hoekwater wrote:
> [...]
>> Hans and I just did some tests, and it seems that the userdata access
>> is useful if *but only if* you are very low on memory. In other cases,
>> it just adds extra objects to be garbage collected, which makes the
>> collector slower. That is on top of extra time spent on the actual
>> calls, and even worse: those extra gc objects tend to be scattered
>> around in memory, resulting in extra minor page faults (cpu cache
>> misses) and all that has a noticeable effect on run speed: the
>> metatable-based access is 20-30% slower than the old massive to_table.
>
> Interesting. As you said, much depends on how one uses / tests. I made
> some tests with translating fontforge font structure directly into the
> luatex font table without an intermediate form. This gives bests
> results, but obviously requires too many simplifications.

That is indeed where there can be some gain (no intermediate table but 
compensated by function calls) but as soon as you start keeping some 
extra info around (not passed to tex or manipulated inbetween) it 
quickly gets worse due to the mentioned scattering. Then there can be a 
smaller mem footprint at the cost of some extra runtime. On the other 
hand, using the traditional method (table) and invoking the garbage 
collector every now and then gives an equally low memory footprint but a 
sweep takes some time as well. Interesting is that on some test runs I 
can get about twice the performance using tables but it's not that easy 
to figure out why.

Btw, in the table approach one can manipulate the font before 
conversion, something that is less easy in the userdata variant.

Anyhow, what we provide now is a nice compromise

Hans

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From taco at elvenkind.com  Thu Sep  9 11:15:30 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 11:15:30 +0200
Subject: [Dev-luatex] Documentation update/suggestion
In-Reply-To: <4C87C5CB.4020806@readytext.co.uk>
References: <mailman.5.1283940002.31061.dev-luatex@ntg.nl>
	<4C87C5CB.4020806@readytext.co.uk>
Message-ID: <4C88A5B2.5030709@elvenkind.com>

On 09/08/2010 07:20 PM, Graham Douglas wrote:
> Hi Taco
>
> Firstly, thank you and the team for the continued stream
> of updates etc to LuaTeX.
>
> I was wondering if the mplib section of the LuaTeX Reference should
> be updated to reflect that the MPlib library no longer uses mem files

Manual updated. Thanks for the heads up.

Best wishes,
Taco

From luigi.scarso at gmail.com  Thu Sep  9 11:21:18 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 9 Sep 2010 11:21:18 +0200
Subject: [Dev-luatex] Revision 3761 compile failing on Windows Vista
In-Reply-To: <4C509DC3.3010100@readytext.co.uk>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
Message-ID: <AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>

On Wed, Jul 28, 2010 at 11:14 PM, Graham Douglas
<graham.douglas at readytext.co.uk> wrote:
> Hi Taco
>
> Yes, a stupid copy error on my part!
>
> Builds OK, as Pawel confirmed.
>
> Thanks, as always
>
> Graham
>
>
>
> _______________________________________________
> dev-luatex mailing list
> dev-luatex at ntg.nl
> http://www.ntg.nl/mailman/listinfo/dev-luatex
>

I'm newby on windows 7, but I would like to compile
luatex with MingW32 -- and I need help .

-- 
luigi

From taco at elvenkind.com  Thu Sep  9 11:22:55 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 11:22:55 +0200
Subject: [Dev-luatex] Luatex 0.63.0 announcement
Message-ID: <4C88A76F.1000205@elvenkind.com>

Hi,

I have just uploaded the archives for a new luatex release, 0.63.0.
This is a development release.

News:

* Drop tex.ht[], tex.wd[], tex.dp[].

* Drop OCP support (and associated primitives).

* Add tex.catcode[], tex.lccode[], tex.sfcode[], tex.uccode[],
   tex.mathcode[] and tex.delcode[] and associated functions.

* Add CIDset tables to the output pdf where appropriate.

* Added a 'string' field to late_lua nodes on the lua side. This
   field does not convert the assigned string to a tokenlist.

* The result of fontloader.open() now has some virtual accessors
   (as well as fontloader.to_table).

* There is now a `short reference' in the manual folder
   (functionref.pdf)

Bugfixes:

* Fix a crash on an empty font (bugreport #468).

* Fix a crash for extremely long pattern arguments.

* Fix a crash on bad virtual character arguments in lua.

* Fix hyphenation exceptions.

* Prevent linebreak between initial local_par paragraph whatsit
   and a following skip (bugreport #437).

* Fix placement of scripts on textstyle big operators in MATH
   fonts (bugreport #466).

* Fix a crash on the return value of MPlib's 'postscript'
   operation on images.

* Fix a crash on \leftghost & \rightghost in math mode.


The archives can be downloaded from supelec as usual:

         http://foundry.supelec.fr/gf/project/luatex/

You could also check out the sources via anonymous svn:

   svn co http://foundry.supelec.fr/svn/luatex/tags/beta-0.63.0

Bugs and feature requests can be added to the issue tracker at

        http://tracker.luatex.org

Have fun,
Taco




From taco at elvenkind.com  Thu Sep  9 11:24:25 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 11:24:25 +0200
Subject: [Dev-luatex] Revision 3761 compile failing on Windows Vista
In-Reply-To: <AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
Message-ID: <4C88A7C9.1050308@elvenkind.com>

On 09/09/2010 11:21 AM, luigi scarso wrote:
>
> I'm newby on windows 7, but I would like to compile
> luatex with MingW32 -- and I need help .

A more precise question would be useful :)

Best wishes,
Taco




From luigi.scarso at gmail.com  Thu Sep  9 11:38:24 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 9 Sep 2010 11:38:24 +0200
Subject: [Dev-luatex] Revision 3761 compile failing on Windows Vista
In-Reply-To: <4C88A7C9.1050308@elvenkind.com>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C88A7C9.1050308@elvenkind.com>
Message-ID: <AANLkTikUGXKyQqY2y-FmUztQxF63c9Gy8waPCZ1oiR5J@mail.gmail.com>

On Thu, Sep 9, 2010 at 11:24 AM, Taco Hoekwater <taco at elvenkind.com> wrote:
> On 09/09/2010 11:21 AM, luigi scarso wrote:
>>
>> I'm newby on windows 7, but I would like to compile
>> luatex with MingW32 -- and I need help .
>
> A more precise question would be useful :)
Well, If I download luatex-beta-0.63.0.tar.bz2
and uncompress I only see a build.sh
which means that at least I need bash, just to start.
What else and where to download ?
gnuwin32  ?
For mingw I have used the
http://www.tdragon.net/recentgcc/ installer
is it OK ?

-- 
luigi

From taco at elvenkind.com  Thu Sep  9 11:43:03 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 11:43:03 +0200
Subject: [Dev-luatex] Revision 3761 compile failing on Windows Vista
In-Reply-To: <AANLkTikUGXKyQqY2y-FmUztQxF63c9Gy8waPCZ1oiR5J@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>
	<4C509DC3.3010100@readytext.co.uk>	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>	<4C88A7C9.1050308@elvenkind.com>
	<AANLkTikUGXKyQqY2y-FmUztQxF63c9Gy8waPCZ1oiR5J@mail.gmail.com>
Message-ID: <4C88AC27.9000104@elvenkind.com>

On 09/09/2010 11:38 AM, luigi scarso wrote:
> Well, If I download luatex-beta-0.63.0.tar.bz2
> and uncompress I only see a build.sh
> which means that at least I need bash, just to start.

Yes. MSYS is the quickest option for the various things
you need at shell level (bash, make, cp, sed etc.)

Then you need a full build toolchain:

* gcc
* g++
* binutils
* flex or lex
* bison or yacc

Simplest is probably to start with downloading and installing MSYS,
start a shell, run

   $ ./build.sh

and see how far it takes you.

I know the source code compiles fine under mingw (as I use that
for cross-compilation) but I do not have a 'native' system so
I cannot give a clear recipe of what to install.

Best wishes,
Taco


From luigi.scarso at gmail.com  Thu Sep  9 11:54:18 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 9 Sep 2010 11:54:18 +0200
Subject: [Dev-luatex] Revision 3761 compile failing on Windows Vista
In-Reply-To: <4C88AC27.9000104@elvenkind.com>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C88A7C9.1050308@elvenkind.com>
	<AANLkTikUGXKyQqY2y-FmUztQxF63c9Gy8waPCZ1oiR5J@mail.gmail.com>
	<4C88AC27.9000104@elvenkind.com>
Message-ID: <AANLkTimWpxA5ueoW7Ck9CAqHgD89TdwnX6kg==BNJ5OY@mail.gmail.com>

On Thu, Sep 9, 2010 at 11:43 AM, Taco Hoekwater <taco at elvenkind.com> wrote:
> On 09/09/2010 11:38 AM, luigi scarso wrote:
>>
>> Well, If I download luatex-beta-0.63.0.tar.bz2
>> and uncompress I only see a build.sh
>> which means that at least I need bash, just to start.
>
> Yes. MSYS is the quickest option for the various things
> you need at shell level (bash, make, cp, sed etc.)
It looks only for linux, but I will see tha batch files
> I know the source code compiles fine under mingw (as I use that
> for cross-compilation) but I do not have a 'native' system so
> I cannot give a clear recipe of what to install.
Yes, I also have mingw under linux and cross-compiled luatex too
I would like to have *the same* under windows 7.
If I understand well Akira uses VisualC : I also have the express edition
but until now I was unable to compile showttf.c (while it's ok with mingw)
so better start with mingw.





-- 
luigi

From root at mail.boekplan.nl  Thu Sep  9 12:28:11 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Thu,  9 Sep 2010 12:28:11 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100909102811.49E1D40083@mail.boekplan.nl>

------------------------------------------------------------------------
r3867 | taco | 2010-09-09 09:27:33 +0200 (Thu, 09 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lang/texlang.w

make hyphenation exceptions case-insensitive 

------------------------------------------------------------------------
r3868 | taco | 2010-09-09 09:27:58 +0200 (Thu, 09 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luafontloader/src/luafflib.c

fix fontloader.fields() for cid subfonts

------------------------------------------------------------------------
r3869 | taco | 2010-09-09 09:32:24 +0200 (Thu, 09 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

remove obsolete note about case sensitivity of exceptions

------------------------------------------------------------------------
r3870 | taco | 2010-09-09 09:41:26 +0200 (Thu, 09 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

update mplib section

------------------------------------------------------------------------
r3871 | taco | 2010-09-09 11:04:03 +0200 (Thu, 09 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/fdata.lua
   M /trunk/manual/functionref.pdf
   M /trunk/manual/functionref.tex

update the short ref for 0.63

------------------------------------------------------------------------
r3872 | taco | 2010-09-09 11:06:53 +0200 (Thu, 09 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/NEWS

new news

------------------------------------------------------------------------
r3873 | taco | 2010-09-09 11:09:44 +0200 (Thu, 09 Sep 2010) | 5 lines
Changed paths:
   A /tags/beta-0.63.0 (from /trunk:3872)


--Tddddhis line, and those below, will be ignored--
qi
A a   http://foundry.supelec.fr/svn/luatex/tags/beta-0.63.0

------------------------------------------------------------------------

From patrick at gundla.ch  Thu Sep  9 13:14:47 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 9 Sep 2010 13:14:47 +0200
Subject: [Dev-luatex] user_defined whatsits
Message-ID: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>

Hi,

once in a while I find surprises in the luatex reference manual, such as the user_defined whatsits (great!).

1) Is the user_id field completely up to me? So I can use it somewhat as an attribute?
2) Will the user_defined whatsit stay in LuaTeX (I know, nothing is fixed, but the developers might have a tendency)
3) am I dreaming or is this really real?

Patrick


From taco at elvenkind.com  Thu Sep  9 13:20:02 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 13:20:02 +0200
Subject: [Dev-luatex] user_defined whatsits
In-Reply-To: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
Message-ID: <4C88C2E2.7040007@elvenkind.com>


Hi,

On 09/09/2010 01:14 PM, Patrick Gundlach wrote:
> Hi,
>
> once in a while I find surprises in the luatex reference manual, such as the user_defined whatsits (great!).
>
> 1) Is the user_id field completely up to me? So I can use it somewhat as an attribute?

Yes.

> 2) Will the user_defined whatsit stay in LuaTeX (I know, nothing is fixed, but the developers might have a tendency)

Yes, I think it will stay. At least, I see no reason to ever remote it.

> 3) am I dreaming or is this really real?

Both could be true at the same time, depending on how well the
actual reality -- interpreted reality link works in your brain :)

Best wishes,
Taco

From pragma at wxs.nl  Thu Sep  9 13:57:02 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 09 Sep 2010 13:57:02 +0200
Subject: [Dev-luatex] user_defined whatsits
In-Reply-To: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
Message-ID: <4C88CB8E.7070600@wxs.nl>

On 9-9-2010 1:14, Patrick Gundlach wrote:
> Hi,
>
> once in a while I find surprises in the luatex reference manual, such as the user_defined whatsits (great!).
>
> 1) Is the user_id field completely up to me? So I can use it somewhat as an attribute?

yes

> 2) Will the user_defined whatsit stay in LuaTeX (I know, nothing is fixed, but the developers might have a tendency)

yes

> 3) am I dreaming or is this really real?

yes

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From patrick at gundla.ch  Thu Sep  9 18:29:42 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 9 Sep 2010 18:29:42 +0200
Subject: [Dev-luatex] user_defined whatsits - store function?
In-Reply-To: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
Message-ID: <14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>



While I am at the user_defined whatsit. Is there a way to store a function? I can dump the function to a string, but that doesn't sound too efficient. The manual states that the table is a token list, so I am not trying to do 

n.value = { function () do whatever I want until the end }

Any ideas?

Patrick


From patrick at gundla.ch  Thu Sep  9 18:42:28 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 9 Sep 2010 18:42:28 +0200
Subject: [Dev-luatex] test on node
Message-ID: <87D059BD-A645-481F-9549-3E7512B7EFF6@gundla.ch>

Hi,

would it be (easily) possible to have a distinct kind of "type" for a node, for example:

if type(myobject)=="node" then
  do whatever
end

could be of course tex.node or something else.

Patrick



From patrick at gundla.ch  Thu Sep  9 19:17:44 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 9 Sep 2010 19:17:44 +0200
Subject: [Dev-luatex] user_defined whatsits - store function?
In-Reply-To: <14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
	<14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>
Message-ID: <051F3CE8-E1EC-4210-9C1D-6BFA153D988A@gundla.ch>


Am 09.09.2010 um 18:29 schrieb Patrick Gundlach:

> 
> 
> While I am at the user_defined whatsit. Is there a way to store a function? I can dump the function to a string, but that doesn't sound too efficient. The manual states that the table is a token list, so I am not trying to do 
> 
> n.value = { function () do whatever I want until the end }
> 
> Any ideas?

my idea with string.dump somehow doesn't work for two reasons:

1) the dumped string must not contain upvalues (lua limitation)
2) i get an error when loading the string back: "binary string: unexpected end in precompiled chun
k"

this is how I store the function:

      n.value = string.dump(function() print("a") end)

and this is how I read it:

        fun = assert(loadstring(head.value))
        fun()

I guess that n.value "chokes" on \0 in strings.


So any idea on how to store a function?

Patrick


From taco at elvenkind.com  Thu Sep  9 20:07:53 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 20:07:53 +0200
Subject: [Dev-luatex] user_defined whatsits - store function?
In-Reply-To: <051F3CE8-E1EC-4210-9C1D-6BFA153D988A@gundla.ch>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>	<14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>
	<051F3CE8-E1EC-4210-9C1D-6BFA153D988A@gundla.ch>
Message-ID: <4C892279.9000409@elvenkind.com>

On 09/09/2010 07:17 PM, Patrick Gundlach wrote:
>
> this is how I store the function:
>
>        n.value = string.dump(function() print("a") end)
>
> and this is how I read it:
>
>          fun = assert(loadstring(head.value))
>          fun()
>
> I guess that n.value "chokes" on \0 in strings.

Yes, and that is because internally the user_defined node has no room
to store the string length in. I can fix that (later), but it is not
intended usage and regardless it does not help you right now.

> So any idea on how to store a function?

Put the functions in a global lua table and store the index to it?
That allows upvalues, and faster too if the function is non-trivial.

Best wishes,
Taco


From taco at elvenkind.com  Thu Sep  9 20:13:30 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Thu, 09 Sep 2010 20:13:30 +0200
Subject: [Dev-luatex] test on node
In-Reply-To: <87D059BD-A645-481F-9549-3E7512B7EFF6@gundla.ch>
References: <87D059BD-A645-481F-9549-3E7512B7EFF6@gundla.ch>
Message-ID: <4C8923CA.2050302@elvenkind.com>

On 09/09/2010 06:42 PM, Patrick Gundlach wrote:
> Hi,
>
> would it be (easily) possible to have a distinct kind of "type" for a node, for example:
>
> if type(myobject)=="node" then
>    do whatever
> end

That is somewhat messy, but node.isnode(myobject) returning a boolean
would be simple. (remind me next week)

Best wishes,
Taco

From graham.douglas at readytext.co.uk  Thu Sep  9 20:23:05 2010
From: graham.douglas at readytext.co.uk (Graham Douglas)
Date: Thu, 09 Sep 2010 19:23:05 +0100
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>	<4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
Message-ID: <4C892609.8000003@readytext.co.uk>

luigi scarso wrote:

>>
> 
> I'm newby on windows 7, but I would like to compile
> luatex with MingW32 -- and I need help .
> 

Hi Luigi!

Here's what I have under Windows Vista

(1) I have MSYS installed under

C:\msys\1.0\bin

which I think is the default install location

(2) The "bash shell" is run via the following batch file

C:\msys\1.0\msys.bat -norxvt
--- the install creates a shortcut to this
and places it on your desktop

(3) I have MinGW installed under

c:\MinGW

--- again, the default

(4) Within MSYS there is a file called "fstab" located
under
c:\msys\1.0\etc\

You'll need to edit this to tell MSYS where
things are --- a sort of mapping I guess. For example

My directory c:/LuaTeX (source code) is mapped to

  /luatexbeta

with a line in fstab like this

c:/LuaTeX /luatexbeta

so that when I run the "bash shell" I do

cd /luatexbeta

to go to the LuaTeX source code, which is updated
by Tortoise SVN client (excellent + free)


(5) From memory I recall that I had to manually install
gcc/gdb  into MinGW --- here:

c:\MinGW\bin\

(I really can't recall if it was gcc or gdb (debugger) which
I had to install)

(6) To compile LuaTeX I start MSYS via the shortcut to the batch file
-- as discussed above

Then I type

cd /luatexbeta

and then all I do is type

build.sh

actually I do

build.sh --nostrip

to leave symbols in for debugging with gdb


(7) Go and gab a coffee.

Hope that helps

Graham












From pragma at wxs.nl  Thu Sep  9 20:35:20 2010
From: pragma at wxs.nl (Hans Hagen)
Date: Thu, 09 Sep 2010 20:35:20 +0200
Subject: [Dev-luatex] user_defined whatsits - store function?
In-Reply-To: <14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
	<14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>
Message-ID: <4C8928E8.4060907@wxs.nl>

On 9-9-2010 6:29, Patrick Gundlach wrote:
>
>
> While I am at the user_defined whatsit. Is there a way to store a function? I can dump the function to a string, but that doesn't sound too efficient. The manual states that the table is a token list, so I am not trying to do
>
> n.value = { function () do whatever I want until the end }

maybe use an indirect method:

list, last= { }, 0

... set ....

last = last + 1
list[last] = fnc
n.value = last

.... whatever ...

after usage
list[n.value] = nil

... use and forget ...

-----------------------------------------------------------------
                                           Hans Hagen | PRAGMA ADE
               Ridderstraat 27 | 8061 GH Hasselt | The Netherlands
     tel: 038 477 53 69 | voip: 087 875 68 74 | www.pragma-ade.com
                                              | www.pragma-pod.nl
-----------------------------------------------------------------

From patrick at gundla.ch  Thu Sep  9 21:01:48 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 9 Sep 2010 21:01:48 +0200
Subject: [Dev-luatex] user_defined whatsits - store function?
In-Reply-To: <4C8928E8.4060907@wxs.nl>
References: <FB28BAAE-C675-488D-9FC8-C48B67C8DC99@gundla.ch>
	<14D41DD2-6718-46C2-A5E9-A53CAFB07C08@gundla.ch>
	<4C8928E8.4060907@wxs.nl>
Message-ID: <065257A9-24D7-45D0-8E67-3C25C90524FF@gundla.ch>

Hi Hans + Taco + *,


>> 
>> n.value = { function () do whatever I want until the end }
> 
> maybe use an indirect method:


[snip]

this is exactly what I am doing now.

Thanks

Patrick


From patrick at gundla.ch  Thu Sep  9 21:02:19 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Thu, 9 Sep 2010 21:02:19 +0200
Subject: [Dev-luatex] test on node
In-Reply-To: <4C8923CA.2050302@elvenkind.com>
References: <87D059BD-A645-481F-9549-3E7512B7EFF6@gundla.ch>
	<4C8923CA.2050302@elvenkind.com>
Message-ID: <317D9E1E-B8DE-420F-B3FE-960EF044150D@gundla.ch>


Am 09.09.2010 um 20:13 schrieb Taco Hoekwater:

> On 09/09/2010 06:42 PM, Patrick Gundlach wrote:
>> Hi,
>> 
>> would it be (easily) possible to have a distinct kind of "type" for a node, for example:
>> 
>> if type(myobject)=="node" then
>>   do whatever
>> end
> 
> That is somewhat messy, but node.isnode(myobject) returning a boolean
> would be simple.

great!

> (remind me next week)

I will :)


Patrick


From luigi.scarso at gmail.com  Thu Sep  9 23:36:30 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Thu, 9 Sep 2010 23:36:30 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <4C892609.8000003@readytext.co.uk>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C892609.8000003@readytext.co.uk>
Message-ID: <AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>

On Thu, Sep 9, 2010 at 8:23 PM, Graham Douglas
<graham.douglas at readytext.co.uk> wrote:
> luigi scarso wrote:
Thank you Graham. I have found the mingw installer
http://sourceforge.net/projects/mingw/files/Automated%20MinGW%20Installer/mingw-get-inst/mingw-get-inst-20100831/mingw-get-inst-20100831.exe/download
that seems a complete (but I must check)
I have saved your steps for reference.
-- 
luigi

From graham.douglas at readytext.co.uk  Fri Sep 10 08:49:24 2010
From: graham.douglas at readytext.co.uk (Graham Douglas)
Date: Fri, 10 Sep 2010 07:49:24 +0100
Subject: [Dev-luatex] [***SPAM***] Re: Compiling LuaTeX on Windows
In-Reply-To: <AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>	<4C509DC3.3010100@readytext.co.uk>	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
Message-ID: <4C89D4F4.1070409@readytext.co.uk>

luigi scarso wrote:
> On Thu, Sep 9, 2010 at 8:23 PM, Graham Douglas
> <graham.douglas at readytext.co.uk> wrote:
>> luigi scarso wrote:
> Thank you Graham. I have found the mingw installer
> http://sourceforge.net/projects/mingw/files/Automated%20MinGW%20Installer/mingw-get-inst/mingw-get-inst-20100831/mingw-get-inst-20100831.exe/download
> that seems a complete (but I must check)
> I have saved your steps for reference.

Hi Luigi

You are very welcome, feel free to contact me anytime
if you have additional questions --- if I can help, I'd
be pleased to do so.

Warm regards

Graham


From P.Jackowski at gust.org.pl  Fri Sep 10 11:29:34 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Fri, 10 Sep 2010 11:29:34 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>
	<4C509DC3.3010100@readytext.co.uk>	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
Message-ID: <4C89FA7E.8020903@gust.org.pl>

luigi scarso wrote:
> On Thu, Sep 9, 2010 at 8:23 PM, Graham Douglas
> <graham.douglas at readytext.co.uk> wrote:
>> luigi scarso wrote:
> Thank you Graham. I have found the mingw installer
> http://sourceforge.net/projects/mingw/files/Automated%20MinGW%20Installer/mingw-get-inst/mingw-get-inst-20100831/mingw-get-inst-20100831.exe/download

I build luatex under windows for quite some time, but so far it never 
happened, that the installer provided by mingw + msys just worked :) 
Most of problems I found was related to make (ie. in previous versions 
both mingw and msys provided make version 3.81, both printed exactly the 
same version message, but in fact they worked _completely_ different). 
But once I finally found the proper one, it was enough to hit

	sh build.sh
	sh build.sh --make

(plus strip ...\luatex.exe at the end) Personally I've learned to 
dislike shells provided by msys as they to some magic I don't understand 
(simulates fstab mounting etc.).

Thanks for this link, it looks promising (at least it takes care about 
basic utils and installs a fresh GCC version).

-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From P.Jackowski at gust.org.pl  Fri Sep 10 12:13:03 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Fri, 10 Sep 2010 12:13:03 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>
	<4C509DC3.3010100@readytext.co.uk>	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
Message-ID: <4C8A04AF.4020804@gust.org.pl>


I just made a test on clean environment and did the following:

-- installed mingw-get-inst-20100831.exe
-- installed MSYS-1.0.11
(both from http://sourceforge.net/projects/mingw/files)

When msys installer asked me for postinstall I said NO.
Since there are no conflicts, I've copied both into the same root C:\GNU 
and added C:\GNU\bin to path. I've checked that no other things are 
present in PATH to be sure that those two (mingw + msys) are enough.
Then started a full luatex build (svn trunk) with

	sh build.sh

Works fine.

I have also copied the entire directory to another machine (without 
installing mingw or msys) to be sure that installers do not perform some 
hidden preconfiguration. They doesn't. So having mingw + msys files tree 
and adding binaries to PATH is enough.
-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From luigi.scarso at gmail.com  Fri Sep 10 12:33:52 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Fri, 10 Sep 2010 12:33:52 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <4C8A04AF.4020804@gust.org.pl>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
	<4C8A04AF.4020804@gust.org.pl>
Message-ID: <AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>

On Fri, Sep 10, 2010 at 12:13 PM, Pawe? Jackowski
<P.Jackowski at gust.org.pl> wrote:
>
> I just made a test on clean environment and did the following:
>
> -- installed mingw-get-inst-20100831.exe
> -- installed MSYS-1.0.11
> (both from http://sourceforge.net/projects/mingw/files)
How did you installed MSYS-1.0.11 ?
Is there any installer for it ?
-- 
luigi

From P.Jackowski at gust.org.pl  Fri Sep 10 14:48:33 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Fri, 10 Sep 2010 14:48:33 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>
	<4C509DC3.3010100@readytext.co.uk>	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>	<4C892609.8000003@readytext.co.uk>	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>	<4C8A04AF.4020804@gust.org.pl>
	<AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>
Message-ID: <4C8A2921.4010101@gust.org.pl>

luigi scarso wrote:
> On Fri, Sep 10, 2010 at 12:13 PM, Pawe? Jackowski
> <P.Jackowski at gust.org.pl> wrote:
>> I just made a test on clean environment and did the following:
>>
>> -- installed mingw-get-inst-20100831.exe
>> -- installed MSYS-1.0.11
>> (both from http://sourceforge.net/projects/mingw/files)
> How did you installed MSYS-1.0.11 ?
> Is there any installer for it ?

I took it from here:

http://downloads.sourceforge.net/mingw/MSYS-1.0.11.exe

Don't confuse with

http://downloads.sourceforge.net/mingw/msysDTK-1.0.1.exe

which contains perl, ssh, scp, ftp, autogen and lots of other stuff, not 
necessary to build luatex.

-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From luigi.scarso at gmail.com  Fri Sep 10 14:58:53 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Fri, 10 Sep 2010 14:58:53 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <4C8A2921.4010101@gust.org.pl>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
	<4C8A04AF.4020804@gust.org.pl>
	<AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>
	<4C8A2921.4010101@gust.org.pl>
Message-ID: <AANLkTimA2d5M8RTeaK-BBHDwLz1Ly9=ahGLp71Toy5Xi@mail.gmail.com>

On Fri, Sep 10, 2010 at 2:48 PM, Pawe? Jackowski
<P.Jackowski at gust.org.pl> wrote:
> luigi scarso wrote:
>>
>> On Fri, Sep 10, 2010 at 12:13 PM, Pawe? Jackowski
>> <P.Jackowski at gust.org.pl> wrote:
>>>
>>> I just made a test on clean environment and did the following:
>>>
>>> -- installed mingw-get-inst-20100831.exe
>>> -- installed MSYS-1.0.11
>>> (both from http://sourceforge.net/projects/mingw/files)
>>
>> How did you installed MSYS-1.0.11 ?
>> Is there any installer for it ?
>
> I took it from here:
>
> http://downloads.sourceforge.net/mingw/MSYS-1.0.11.exe
good.
mingw-get-inst-20100831.exe
has already it's msys
but build.sh seems fails because ln -s doesn't exist
need to investigate a bit.
-- 
luigi

From P.Jackowski at gust.org.pl  Fri Sep 10 16:17:27 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Fri, 10 Sep 2010 16:17:27 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <AANLkTimA2d5M8RTeaK-BBHDwLz1Ly9=ahGLp71Toy5Xi@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com>
	<4C509DC3.3010100@readytext.co.uk>	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>	<4C892609.8000003@readytext.co.uk>	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>	<4C8A04AF.4020804@gust.org.pl>	<AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>	<4C8A2921.4010101@gust.org.pl>
	<AANLkTimA2d5M8RTeaK-BBHDwLz1Ly9=ahGLp71Toy5Xi@mail.gmail.com>
Message-ID: <4C8A3DF7.7070807@gust.org.pl>

luigi scarso wrote:
> On Fri, Sep 10, 2010 at 2:48 PM, Pawe? Jackowski
> <P.Jackowski at gust.org.pl> wrote:
>> luigi scarso wrote:
>>> On Fri, Sep 10, 2010 at 12:13 PM, Pawe? Jackowski
>>> <P.Jackowski at gust.org.pl> wrote:
>>>> I just made a test on clean environment and did the following:
>>>>
>>>> -- installed mingw-get-inst-20100831.exe
>>>> -- installed MSYS-1.0.11
>>>> (both from http://sourceforge.net/projects/mingw/files)
>>> How did you installed MSYS-1.0.11 ?
>>> Is there any installer for it ?
>> I took it from here:
>>
>> http://downloads.sourceforge.net/mingw/MSYS-1.0.11.exe
> good.
> mingw-get-inst-20100831.exe
> has already it's msys
> but build.sh seems fails because ln -s doesn't exist
> need to investigate a bit.

Indeed, mingw installer now installs something called msys basic. I 
don't know how it differs from `normal' msys package from the link 
above. The one I give a link to contains ln (and a reasonable set of 
dev-oriented tools; apparently they made some cleanups).

-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From luigi.scarso at gmail.com  Fri Sep 10 16:20:13 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Fri, 10 Sep 2010 16:20:13 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <4C8A3DF7.7070807@gust.org.pl>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
	<4C8A04AF.4020804@gust.org.pl>
	<AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>
	<4C8A2921.4010101@gust.org.pl>
	<AANLkTimA2d5M8RTeaK-BBHDwLz1Ly9=ahGLp71Toy5Xi@mail.gmail.com>
	<4C8A3DF7.7070807@gust.org.pl>
Message-ID: <AANLkTi=RDKpfAM_QCoutwVkFM2ycEGekavKzUwiZh-xL@mail.gmail.com>

On Fri, Sep 10, 2010 at 4:17 PM, Pawe? Jackowski
<P.Jackowski at gust.org.pl> wrote:
> Indeed, mingw installer now installs something called msys basic. I don't
> know how it differs from `normal' msys package from the link above. The one
> I give a link to contains ln (and a reasonable set of dev-oriented tools;
> apparently they made some cleanups).
The installer comes with
the mingw-get program,  a command line tool to install programs :
maybe I can install with it -- I will check


-- 
luigi

From P.Jackowski at gust.org.pl  Fri Sep 10 17:27:08 2010
From: P.Jackowski at gust.org.pl (=?UTF-8?B?UGF3ZcWCIEphY2tvd3NraQ==?=)
Date: Fri, 10 Sep 2010 17:27:08 +0200
Subject: [Dev-luatex] luafontloader virtual access (bug #404, #448)
In-Reply-To: <4C8897E0.6080002@wxs.nl>
References: <201009051439.o85EdrQ0006361@foundry.metz.supelec.fr>	<4C83B27B.30604@elvenkind.com>	<4C868085.70807@gust.org.pl>	<4C86A464.20204@wxs.nl>	<4C8720BB.2080904@elvenkind.com>
	<4C87C06E.1090504@elvenkind.com> <4C8887A6.6040300@gust.org.pl>
	<4C8897E0.6080002@wxs.nl>
Message-ID: <4C8A4E4C.5060603@gust.org.pl>

 > Interesting is that on some test runs I
> can get about twice the performance using tables but it's not that easy 
> to figure out why.

I've learned just one think about optimizations: my intuition fails so 
only practical tests make sense.

> Btw, in the table approach one can manipulate the font before 
> conversion, something that is less easy in the userdata variant.

> Anyhow, what we provide now is a nice compromise

Sure, agree.

-- 
Pawe/l Jackowski
P.Jackowski at gust.org.pl

From reinhard.kotucha at web.de  Fri Sep 10 17:56:20 2010
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Fri, 10 Sep 2010 17:56:20 +0200
Subject: [Dev-luatex] Compiling LuaTeX on Windows
In-Reply-To: <AANLkTimA2d5M8RTeaK-BBHDwLz1Ly9=ahGLp71Toy5Xi@mail.gmail.com>
References: <4C508DF6.7000008@elvenkind.com> <4C509DC3.3010100@readytext.co.uk>
	<AANLkTim6T5kM7QWL7POL1q_k3BNY8SsarSTJZJnYxwqH@mail.gmail.com>
	<4C892609.8000003@readytext.co.uk>
	<AANLkTik1bUG09te3S=CxsZjNMAgPx1pbWi0Hu6m6P4o3@mail.gmail.com>
	<4C8A04AF.4020804@gust.org.pl>
	<AANLkTikjjQBjBY5sr=1-WBi5ekzOKY4_ioOnzdDhFsH-@mail.gmail.com>
	<4C8A2921.4010101@gust.org.pl>
	<AANLkTimA2d5M8RTeaK-BBHDwLz1Ly9=ahGLp71Toy5Xi@mail.gmail.com>
Message-ID: <19594.21796.746296.190458@zaphod.ms25.net>

On 10 September 2010 luigi scarso wrote:

 > > http://downloads.sourceforge.net/mingw/MSYS-1.0.11.exe
 > good.
 > mingw-get-inst-20100831.exe
 > has already it's msys
 > but build.sh seems fails because ln -s doesn't exist
 > need to investigate a bit.

The version of MSYS/MinGW I installed on a machine at work a few years
ago provided an ln program.  But ln -s actually did the same as cp -p.
This is not what Unix users expect and thus a bit confusing.  On the
other hand it's not easy to provide symlinks on Windows and this
workaround might be sufficient in most cases.  Sure, one should be
aware of it.

If they removed the ln program from their distribution (should be
documented somewhere), you can write your own one:

#! /bin/sh
cp -p "$@"

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From khaledhosny at eglug.org  Sun Sep 12 05:17:04 2010
From: khaledhosny at eglug.org (Khaled Hosny)
Date: Sun, 12 Sep 2010 06:17:04 +0300
Subject: [Dev-luatex] Typo in functuonref.tex
Message-ID: <20100912031703.GA23966@khaled-laptop>

It says \latexlua, though being half a sleep, I'm pretty sure there is
no latex in luatex, a Freudian slip? :P

-- 
 Khaled Hosny
 Arabic localiser and member of Arabeyes.org team
 Free font developer

From taco at elvenkind.com  Sun Sep 12 09:22:28 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Sun, 12 Sep 2010 09:22:28 +0200
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <20100912031703.GA23966@khaled-laptop>
References: <20100912031703.GA23966@khaled-laptop>
Message-ID: <4C8C7FB4.7050800@elvenkind.com>

On 09/12/2010 05:17 AM, Khaled Hosny wrote:
> It says \latexlua, though being half a sleep, I'm pretty sure there is
> no latex in luatex, a Freudian slip? :P

Fixed, thanks.

Best wishes,
Taco



From root at mail.boekplan.nl  Sun Sep 12 12:27:20 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Sun, 12 Sep 2010 12:27:20 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100912102720.D11594006A@mail.boekplan.nl>

------------------------------------------------------------------------
r3874 | hhenkel | 2010-09-12 00:22:05 +0200 (Sun, 12 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.w

pdf.refobj()

------------------------------------------------------------------------
r3875 | taco | 2010-09-12 09:22:01 +0200 (Sun, 12 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/functionref.pdf
   M /trunk/manual/functionref.tex

fix typo

------------------------------------------------------------------------
r3876 | hhenkel | 2010-09-12 09:45:48 +0200 (Sun, 12 Sep 2010) | 3 lines
Changed paths:
   A /trunk/manual/Makefile
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex

pdf.refobj() doc.
+ cleanup a few line endings + simple Makefile

------------------------------------------------------------------------
r3877 | hhenkel | 2010-09-12 10:07:20 +0200 (Sun, 12 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/Makefile
   M /trunk/manual/fdata.lua
   M /trunk/manual/functionref.pdf
   M /trunk/manual/functionref.tex

pdf.refobj() into functionref.tex

------------------------------------------------------------------------
r3878 | hhenkel | 2010-09-12 10:19:18 +0200 (Sun, 12 Sep 2010) | 2 lines
Changed paths:
   D /trunk/manual/s-abr-01.tex

s-abr-01.tex not needed here

------------------------------------------------------------------------
r3879 | hhenkel | 2010-09-12 10:49:06 +0200 (Sun, 12 Sep 2010) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h

new functions pdf.maxobjnum() and pdf.objtype()
+ add forgotten "return 0;"

------------------------------------------------------------------------
r3880 | hhenkel | 2010-09-12 11:16:09 +0200 (Sun, 12 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.w

function was still static

------------------------------------------------------------------------

From reinhard.kotucha at web.de  Sun Sep 12 13:39:26 2010
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sun, 12 Sep 2010 13:39:26 +0200
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <20100912031703.GA23966@khaled-laptop>
References: <20100912031703.GA23966@khaled-laptop>
Message-ID: <19596.48110.113170.5294@zaphod.ms25.net>

On 12 September 2010 Khaled Hosny wrote:

 > It says \latexlua, though being half a sleep, I'm pretty sure there
 > is no latex in luatex, a Freudian slip? :P

Sure, Taco is secretly working on latexlib.  This allows you to run
LaTeX directly in Context:

\startLaTeX
\textbf{hello}
\stopLaTeX

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From adityam at umich.edu  Sun Sep 12 17:24:27 2010
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 12 Sep 2010 11:24:27 -0400 (EDT)
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <19596.48110.113170.5294@zaphod.ms25.net>
References: <20100912031703.GA23966@khaled-laptop>
	<19596.48110.113170.5294@zaphod.ms25.net>
Message-ID: <alpine.LNX.2.00.1009121112020.16468@ybpnyubfg.ybpnyqbznva>

On Sun, 12 Sep 2010, Reinhard Kotucha wrote:

> On 12 September 2010 Khaled Hosny wrote:
>
> > It says \latexlua, though being half a sleep, I'm pretty sure there
> > is no latex in luatex, a Freudian slip? :P
>
> Sure, Taco is secretly working on latexlib.  This allows you to run
> LaTeX directly in Context:
>
> \startLaTeX
> \textbf{hello}
> \stopLaTeX

Oh, you underestimate the power of the dark side. Running latex inside 
context is already possible using the external filter module[1].

\usemodule[filter]

\defineexternalfilter
   [LATEX]
   [filtercommand={pandoc -f latex -t context
                   -o \externalfilteroutputfile\space
                   \externalfilterinputfile}]

\starttext

\startLATEX
   Simple \LaTeX\ (this gets gobbled!)
   commands like \textbf{bold} and \textit{italic} work, as
   does \emph{emphasize}. Even equations work!

   \begin{equation}
     E = mc^2
   \end{equation}
   though we end up loosing the numbering.

   Graphics also work: \includegraphics{dummy} but floats is a different
   story

   \begin{figure}
     \centering
     \includegraphics{dummy}
     \caption{A figure}
   \end{figure}
\stopLATEX

\stoptext

I could also give an actual call to latex and simply include the resultant 
pdf, but this is more fun.

Aditya

[1]: http://www.github.com/adityam/filter


From luigi.scarso at gmail.com  Sun Sep 12 17:33:11 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sun, 12 Sep 2010 17:33:11 +0200
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <alpine.LNX.2.00.1009121112020.16468@ybpnyubfg.ybpnyqbznva>
References: <20100912031703.GA23966@khaled-laptop>
	<19596.48110.113170.5294@zaphod.ms25.net>
	<alpine.LNX.2.00.1009121112020.16468@ybpnyubfg.ybpnyqbznva>
Message-ID: <AANLkTinQPzccB_=sA6gqgQZFYejNF8Qrf5Wm0jnU09Lr@mail.gmail.com>

On Sun, Sep 12, 2010 at 5:24 PM, Aditya Mahajan <adityam at umich.edu> wrote:
> On Sun, 12 Sep 2010, Reinhard Kotucha wrote:
>
>> On 12 September 2010 Khaled Hosny wrote:
>>
>> > It says \latexlua, though being half a sleep, I'm pretty sure there
>> > is no latex in luatex, a Freudian slip? :P
>>
>> Sure, Taco is secretly working on latexlib. ?This allows you to run
>> LaTeX directly in Context:
>>
>> \startLaTeX
>> \textbf{hello}
>> \stopLaTeX
>
> Oh, you underestimate the power of the dark side. Running latex inside
> context is already possible using the external filter module[1].
as I said to Reinhard to a private email
it's also something that I'm thinking from a while.
The Aditya idea (that I *must* know :-) )
is to call an external process, hence
1) doesn't share state (ie fonts) and this can be a limit
2) it's slow, but on multicore system this cannot be  a problem
3) it has a safe separation of task , and this always matter
An alternative is to use a luatex with more states and then 1) maybe
can be resolved
(with a good support from mkiv)
but then 2) (locks on commons data structures) and 3) (threading) may fail.



-- 
luigi

From adityam at umich.edu  Sun Sep 12 17:48:26 2010
From: adityam at umich.edu (Aditya Mahajan)
Date: Sun, 12 Sep 2010 11:48:26 -0400 (EDT)
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <AANLkTinQPzccB_=sA6gqgQZFYejNF8Qrf5Wm0jnU09Lr@mail.gmail.com>
References: <20100912031703.GA23966@khaled-laptop>
	<19596.48110.113170.5294@zaphod.ms25.net>
	<alpine.LNX.2.00.1009121112020.16468@ybpnyubfg.ybpnyqbznva>
	<AANLkTinQPzccB_=sA6gqgQZFYejNF8Qrf5Wm0jnU09Lr@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.1009121139410.16468@ybpnyubfg.ybpnyqbznva>

On Sun, 12 Sep 2010, luigi scarso wrote:

> On Sun, Sep 12, 2010 at 5:24 PM, Aditya Mahajan <adityam at umich.edu> wrote:
>> On Sun, 12 Sep 2010, Reinhard Kotucha wrote:
>>
>>> On 12 September 2010 Khaled Hosny wrote:
>>>
>>>> It says \latexlua, though being half a sleep, I'm pretty sure there
>>>> is no latex in luatex, a Freudian slip? :P
>>>
>>> Sure, Taco is secretly working on latexlib. ?This allows you to run
>>> LaTeX directly in Context:
>>>
>>> \startLaTeX
>>> \textbf{hello}
>>> \stopLaTeX
>>
>> Oh, you underestimate the power of the dark side. Running latex inside
>> context is already possible using the external filter module[1].
> as I said to Reinhard to a private email
> it's also something that I'm thinking from a while.
> The Aditya idea (that I *must* know :-) )
> is to call an external process, hence
> 1) doesn't share state (ie fonts) and this can be a limit

No, it does. pandoc is an (incomplete) parser that converts latex to 
context. So, the latex snippet is converted to context snippet and read 
back.

> 2) it's slow, but on multicore system this cannot be  a problem
> 3) it has a safe separation of task , and this always matter

> An alternative is to use a luatex with more states and then 1) maybe
> can be resolved
> (with a good support from mkiv)
> but then 2) (locks on commons data structures) and 3) (threading) may fail.

But seriously, if you want to read LaTeX commands, the simplest way is to 
write the "converter" in TeX.

\let\textbf=\bold
\let\bfseries=\bold
...
etc.

An easier solution might be to restrict to GELLMU aware commands and use 
GELLMU to transform LaTeX to SGML and then just write a Context XML parser 
for that. But this is way OT here.

Aditya

From luigi.scarso at gmail.com  Sun Sep 12 17:53:19 2010
From: luigi.scarso at gmail.com (luigi scarso)
Date: Sun, 12 Sep 2010 17:53:19 +0200
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <alpine.LNX.2.00.1009121139410.16468@ybpnyubfg.ybpnyqbznva>
References: <20100912031703.GA23966@khaled-laptop>
	<19596.48110.113170.5294@zaphod.ms25.net>
	<alpine.LNX.2.00.1009121112020.16468@ybpnyubfg.ybpnyqbznva>
	<AANLkTinQPzccB_=sA6gqgQZFYejNF8Qrf5Wm0jnU09Lr@mail.gmail.com>
	<alpine.LNX.2.00.1009121139410.16468@ybpnyubfg.ybpnyqbznva>
Message-ID: <AANLkTi=9+BYRx=tR9OFGRL8j_6JhERs5-r6uRLuWgbrH@mail.gmail.com>

On Sun, Sep 12, 2010 at 5:48 PM, Aditya Mahajan <adityam at umich.edu> wrote:
> On Sun, 12 Sep 2010, luigi scarso wrote:
>
>> On Sun, Sep 12, 2010 at 5:24 PM, Aditya Mahajan <adityam at umich.edu> wrote:
>>>
>>> On Sun, 12 Sep 2010, Reinhard Kotucha wrote:
>>>
>>>> On 12 September 2010 Khaled Hosny wrote:
>>>>
>>>>> It says \latexlua, though being half a sleep, I'm pretty sure there
>>>>> is no latex in luatex, a Freudian slip? :P
>>>>
>>>> Sure, Taco is secretly working on latexlib. ?This allows you to run
>>>> LaTeX directly in Context:
>>>>
>>>> \startLaTeX
>>>> \textbf{hello}
>>>> \stopLaTeX
>>>
>>> Oh, you underestimate the power of the dark side. Running latex inside
>>> context is already possible using the external filter module[1].
>>
>> as I said to Reinhard to a private email
>> it's also something that I'm thinking from a while.
>> The Aditya idea (that I *must* know :-) )
>> is to call an external process, hence
>> 1) doesn't share state (ie fonts) and this can be a limit
>
> No, it does. pandoc is an (incomplete) parser that converts latex to
> context. So, the latex snippet is converted to context snippet and read
> back.
yes, but  pandoc must be in synch with latex and context.
Maybe it's ok for pdflatex and mkii .


> But seriously, if you want to read LaTeX commands, the simplest way is to
> write the "converter" in TeX.
in luatex+mkiv



-- 
luigi

From reinhard.kotucha at web.de  Sun Sep 12 18:40:17 2010
From: reinhard.kotucha at web.de (Reinhard Kotucha)
Date: Sun, 12 Sep 2010 18:40:17 +0200
Subject: [Dev-luatex] Typo in functuonref.tex
In-Reply-To: <AANLkTinQPzccB_=sA6gqgQZFYejNF8Qrf5Wm0jnU09Lr@mail.gmail.com>
References: <20100912031703.GA23966@khaled-laptop>
	<19596.48110.113170.5294@zaphod.ms25.net>
	<alpine.LNX.2.00.1009121112020.16468@ybpnyubfg.ybpnyqbznva>
	<AANLkTinQPzccB_=sA6gqgQZFYejNF8Qrf5Wm0jnU09Lr@mail.gmail.com>
Message-ID: <19597.625.719854.330530@zaphod.ms25.net>

On 12 September 2010 luigi scarso wrote:

 > On Sun, Sep 12, 2010 at 5:24 PM, Aditya Mahajan <adityam at umich.edu> wrote:
 > > On Sun, 12 Sep 2010, Reinhard Kotucha wrote:
 > >
 > >> On 12 September 2010 Khaled Hosny wrote:
 > >>
 > >> > It says \latexlua, though being half a sleep, I'm pretty sure there
 > >> > is no latex in luatex, a Freudian slip? :P
 > >>
 > >> Sure, Taco is secretly working on latexlib. ?This allows you to run
 > >> LaTeX directly in Context:
 > >>
 > >> \startLaTeX
 > >> \textbf{hello}
 > >> \stopLaTeX
 > >
 > > Oh, you underestimate the power of the dark side. Running latex inside
 > > context is already possible using the external filter module[1].
 > as I said to Reinhard to a private email
 > it's also something that I'm thinking from a while.

Sorry Luigi, but my mail was meant as a joke, just to explain the
Freudian slip.

Regards,
  Reinhard

-- 
----------------------------------------------------------------------------
Reinhard Kotucha			              Phone: +49-511-3373112
Marschnerstr. 25
D-30167 Hannover	                      mailto:reinhard.kotucha at web.de
----------------------------------------------------------------------------
Microsoft isn't the answer. Microsoft is the question, and the answer is NO.
----------------------------------------------------------------------------

From root at mail.boekplan.nl  Mon Sep 13 12:27:25 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Mon, 13 Sep 2010 12:27:25 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100913102725.3FE0D40066@mail.boekplan.nl>

------------------------------------------------------------------------
r3881 | hhenkel | 2010-09-13 08:19:56 +0200 (Mon, 13 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

obj_type_catalog, obj_type_info

------------------------------------------------------------------------

From taco at elvenkind.com  Tue Sep 14 11:34:37 2010
From: taco at elvenkind.com (taco)
Date: Tue, 14 Sep 2010 11:34:37 +0200
Subject: [Dev-luatex] [Fwd: [luatex 0000481]: can't load chinese otf font
 correctly, always give "LuaTeX warning: lua-loaded font has no characters"]
Message-ID: <4C8F41AD.8040508@elvenkind.com>

Hi,

See forward. Can anybody try this with current versions
and possibly report back to the reporter? I am at the
ConTeXt meeting which makes working at bugs sort of
problematic  and besides, I do not really understand
luaotfload all that well.

Thanks in advance,
Taco
-------------- next part --------------
An embedded message was scrubbed...
From: Mantis Bug Tracker <noreply at luatex.org>
Subject: [luatex 0000481]: can't load chinese otf font correctly, always give "LuaTeX warning: lua-loaded font has no characters"
Date: Tue, 14 Sep 2010 10:52:45 +0200
Size: 4778
URL: <http://www.ntg.nl/pipermail/dev-luatex/attachments/20100914/9b67e088/attachment.eml>

From taco at elvenkind.com  Tue Sep 14 11:34:50 2010
From: taco at elvenkind.com (taco)
Date: Tue, 14 Sep 2010 11:34:50 +0200
Subject: [Dev-luatex] [Fwd: [luatex 0000481]: can't load chinese otf font
 correctly, always give "LuaTeX warning: lua-loaded font has no characters"]
Message-ID: <4C8F41BA.6060502@elvenkind.com>

Hi,

See forward. Can somebody try this with current versions
and possibly report back to the reporter? I am at the
ConTeXt meeting which makes working at bugs sort of
problematic  and besides, I do not really understand
luaotfload all that well.

Thanks in advance,
Taco
-------------- next part --------------
An embedded message was scrubbed...
From: Mantis Bug Tracker <noreply at luatex.org>
Subject: [luatex 0000481]: can't load chinese otf font correctly, always give "LuaTeX warning: lua-loaded font has no characters"
Date: Tue, 14 Sep 2010 10:52:45 +0200
Size: 4778
URL: <http://www.ntg.nl/pipermail/dev-luatex/attachments/20100914/f68aa28b/attachment.eml>

From root at mail.boekplan.nl  Tue Sep 14 12:27:44 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue, 14 Sep 2010 12:27:44 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100914102744.1E8E340070@mail.boekplan.nl>

------------------------------------------------------------------------
r3882 | hhenkel | 2010-09-14 00:29:18 +0200 (Tue, 14 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/writet3.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.w

pdf_new_obj() and pdf_new_dict() now return object number

------------------------------------------------------------------------

From liyanrui.m2 at gmail.com  Tue Sep 14 14:36:43 2010
From: liyanrui.m2 at gmail.com (=?UTF-8?B?TGkgWWFucnVpICjmnY7lu7bnkZ4p?=)
Date: Tue, 14 Sep 2010 20:36:43 +0800
Subject: [Dev-luatex] Fwd: [Fwd: [luatex 0000481]: can't load chinese otf
 font correctly,
 always give "LuaTeX warning: lua-loaded font has no characters"]
In-Reply-To: <AANLkTinw2aA8t6weMwZ-CvrPuczvK8iwyC=vWnOaVZat@mail.gmail.com>
References: <4C8F41BA.6060502@elvenkind.com>
	<AANLkTinw2aA8t6weMwZ-CvrPuczvK8iwyC=vWnOaVZat@mail.gmail.com>
Message-ID: <AANLkTin88XQ+8jk2xxFPKyT6pv3Q01ooB2uAVTpnu+D2@mail.gmail.com>

---------- Forwarded message ----------
From: Li Yanrui (???) <liyanrui.m2 at gmail.com>
Date: 2010/9/14
Subject: Re: [Dev-luatex] [Fwd: [luatex 0000481]: can't load chinese
otf font correctly, always give "LuaTeX warning: lua-loaded font has
no characters"]
To: taco <taco at elvenkind.com>


2010/9/14 taco <taco at elvenkind.com>:
> Hi,
>
> See forward. Can somebody try this with current versions
> and possibly report back to the reporter? I am at the
> ConTeXt meeting which makes working at bugs sort of
> problematic ?and besides, I do not really understand
> luaotfload all that well.
>
> Thanks in advance,
> Taco
>

Hi,

This seems an old problem:

http://www.ntg.nl/pipermail/ntg-context/2009/040965.html

But luatex/plain can not work with the latest beta:

! LuaTeX error ...-context/tex/generic/context/luatex-fonts-merged.lua:3096:
attempt to index field '?' (a nil value)

So no way to test this problem.

--
Best regards,

Li Yanrui (???)



-- 
Best regards,

Li Yanrui (???)

From root at mail.boekplan.nl  Tue Sep 14 22:27:40 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue, 14 Sep 2010 22:27:40 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100914202740.8894140071@mail.boekplan.nl>

------------------------------------------------------------------------
r3883 | hhenkel | 2010-09-14 20:55:11 +0200 (Tue, 14 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/luatex.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /trunk/source/texk/web2c/luatexdir/tex/printing.w

make a few functions static and remove a few -Wconversion warns

------------------------------------------------------------------------
r3884 | oneiros | 2010-09-14 21:19:25 +0200 (Tue, 14 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/printing.w

remove superfluous type conversions (the numbers can not become negative)

------------------------------------------------------------------------
r3885 | oneiros | 2010-09-14 21:24:08 +0200 (Tue, 14 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/printing.w

indent

------------------------------------------------------------------------

From root at mail.boekplan.nl  Wed Sep 15 12:28:04 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed, 15 Sep 2010 12:28:04 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100915102804.4876640070@mail.boekplan.nl>

------------------------------------------------------------------------
r3886 | hhenkel | 2010-09-14 22:54:39 +0200 (Tue, 14 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftypes.h

seems sys_obj_ptr was an unnecessary complication

------------------------------------------------------------------------
r3887 | hhenkel | 2010-09-14 23:32:23 +0200 (Tue, 14 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.w
   M /trunk/source/texk/web2c/luatexdir/image/writejbig2.w
   M /trunk/source/texk/web2c/luatexdir/image/writepng.w
   M /trunk/source/texk/web2c/luatexdir/lua/limglib.c
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pagetree.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfannot.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdffont.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.w

pdf_create_obj() now returns the object number

------------------------------------------------------------------------
r3888 | taco | 2010-09-15 00:17:57 +0200 (Wed, 15 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.pdf
   M /trunk/manual/luatexref-t.tex
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c

implement node.is_node()

------------------------------------------------------------------------
r3889 | hhenkel | 2010-09-15 00:21:57 +0200 (Wed, 15 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfdest.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfthread.w

use object numbers returned by functions pdf_new_*()

------------------------------------------------------------------------
r3890 | hhenkel | 2010-09-15 00:38:42 +0200 (Wed, 15 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w

rename argument

------------------------------------------------------------------------
r3891 | hhenkel | 2010-09-15 01:02:24 +0200 (Wed, 15 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/writeimg.w
   M /trunk/source/texk/web2c/luatexdir/lua/lpdflib.c
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfaction.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfcolorstack.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflink.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdflistout.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfobj.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfoutline.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfshipout.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdftables.w
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfxform.w

remove a incr() and decr() macros from Pascal time

------------------------------------------------------------------------
r3892 | hhenkel | 2010-09-15 01:29:58 +0200 (Wed, 15 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.h
   M /trunk/source/texk/web2c/luatexdir/pdf/pdfgen.w

a few more static functions

------------------------------------------------------------------------

From patrick at gundla.ch  Wed Sep 15 14:59:06 2010
From: patrick at gundla.ch (Patrick Gundlach)
Date: Wed, 15 Sep 2010 14:59:06 +0200
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <20100915102804.4876640070@mail.boekplan.nl>
References: <20100915102804.4876640070@mail.boekplan.nl>
Message-ID: <0453C04B-0EB7-4B31-A7DD-DF754C7B815A@gundla.ch>



> ------------------------------------------------------------------------
> r3888 | taco | 2010-09-15 00:17:57 +0200 (Wed, 15 Sep 2010) | 2 lines
> Changed paths:
>   M /trunk/manual/luatexref-t.pdf
>   M /trunk/manual/luatexref-t.tex
>   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c
> 
> implement node.is_node()


Thanks!


Patrick


From arthur.reutenauer at normalesup.org  Wed Sep 15 15:09:24 2010
From: arthur.reutenauer at normalesup.org (Arthur Reutenauer)
Date: Wed, 15 Sep 2010 15:09:24 +0200
Subject: [Dev-luatex] Cron
	<luatex@boekplan>	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <0453C04B-0EB7-4B31-A7DD-DF754C7B815A@gundla.ch>
References: <20100915102804.4876640070@mail.boekplan.nl>
	<0453C04B-0EB7-4B31-A7DD-DF754C7B815A@gundla.ch>
Message-ID: <20100915130924.GB11189@phare.normalesup.org>

>> implement node.is_node()
> 
> 
> Thanks!

  I, too, noticed that the LuaTeX repository was strangely active
during the ConTeXt meeting.  Taco didn't mention he had just implemented
a new feature when he left for bed last night :-)

	Arthur

From liyanrui.m2 at gmail.com  Thu Sep 16 04:46:49 2010
From: liyanrui.m2 at gmail.com (=?UTF-8?B?TGkgWWFucnVpICjmnY7lu7bnkZ4p?=)
Date: Thu, 16 Sep 2010 10:46:49 +0800
Subject: [Dev-luatex] [Fwd: [luatex 0000481]: can't load chinese otf
 font correctly,
 always give "LuaTeX warning: lua-loaded font has no characters"]
In-Reply-To: <4C8F41BA.6060502@elvenkind.com>
References: <4C8F41BA.6060502@elvenkind.com>
Message-ID: <AANLkTinQ0kHpmdHAJyLhA=Zhia-SY02Wrd43q19eXTJ3@mail.gmail.com>

2010/9/14 taco <taco at elvenkind.com>:
> Hi,
>
> See forward. Can somebody try this with current versions
> and possibly report back to the reporter? I am at the
> ConTeXt meeting which makes working at bugs sort of
> problematic ?and besides, I do not really understand
> luaotfload all that well.
>
> Thanks in advance,
> Taco
>
>
> The following issue has been SUBMITTED.
> ======================================================================
> http://tracker.luatex.org/view.php?id=481
> ======================================================================
> Reported By: ? ? ? ? ? ? ? ?luoyi
> Assigned To:
> ======================================================================
> Project: ? ? ? ? ? ? ? ? ? ?luatex
> Issue ID: ? ? ? ? ? ? ? ? ? 481
> Category: ? ? ? ? ? ? ? ? ? luatex bug
> Reproducibility: ? ? ? ? ? ?always
> Severity: ? ? ? ? ? ? ? ? ? major
> Priority: ? ? ? ? ? ? ? ? ? high
> Status: ? ? ? ? ? ? ? ? ? ? new
> ======================================================================
> Date Submitted: ? ? ? ? ? ? 2010-09-14 10:52 CEST
> Last Modified: ? ? ? ? ? ? ?2010-09-14 10:52 CEST
> ======================================================================
> Summary: ? ? ? ? ? ? ? ? ? ?can't load chinese otf font correctly, always
> give
> "LuaTeX warning: lua-loaded font has no characters"
> Description:
> I'm using TL2010 with the latest luatex , and it looks like luatex can't
> load
> chinese otf font correctly. It always give error msg like" LuaTeX warning:
> lua-loaded font has no characters". hope we can solve it.
>
> the tex file is:
>
> \input {luaotfload.sty}
> \font\asong={AdobeSongStd-Light} at 10pt
> \asong
> women
> \bye
>

Now the LuaTeX/plain TeX can works with the latest beta. Because I
have not the LaTeX enviroment, I just tested this example:

\font\asong={AdobeSongStd-Light} at 10pt
\asong
??
\bye

It can work. LuaTeX can find AdobeSongStd-Light.otf rightly and load it.

-- 
Best regards,

Li Yanrui (???)

From luoyi.ly at gmail.com  Thu Sep 16 05:10:31 2010
From: luoyi.ly at gmail.com (luoyi)
Date: Thu, 16 Sep 2010 11:10:31 +0800
Subject: [Dev-luatex] [Fwd: [luatex 0000481]: can't load chinese otf
 font correctly,
 always give "LuaTeX warning: lua-loaded font has no characters"]
In-Reply-To: <AANLkTinQ0kHpmdHAJyLhA=Zhia-SY02Wrd43q19eXTJ3@mail.gmail.com>
References: <4C8F41BA.6060502@elvenkind.com>
	<AANLkTinQ0kHpmdHAJyLhA=Zhia-SY02Wrd43q19eXTJ3@mail.gmail.com>
Message-ID: <AANLkTi=8vwvyiob+ZBvvA3xd=nBFhTv1bWCZh7WngGHK@mail.gmail.com>

sorry, still can't get it to work.

[luoyi at myhost ~/tex]$ mtxrun --script fonts --list --all --pattern=adobe
|grep -i song
adobesongstd             adobesongstdlight
/usr/share/fonts/adobe/AdobeSongStd-Light.otf
adobesongstdlight        adobesongstdlight
/usr/share/fonts/adobe/AdobeSongStd-Light.otf
adobesongstdregular      adobesongstdlight
/usr/share/fonts/adobe/AdobeSongStd-Light.otf
[luoyi at myhost ~/tex]$ which luatex
/usr/local/texlive/2010/bin/x86_64-linux/luatex
[luoyi at myhost ~/tex]$ luatex lf.tex
This is LuaTeX, Version beta-0.63.0-2010090921
 restricted \write18 enabled.
(./lf.tex
! Font \asong=AdobeSongStd-Light at 10pt not loadable: metric data not found
or
 bad.
<to be read again>
                   \asong
l.3 \asong

?
! Emergency stop.
<to be read again>
                   \asong
l.3 \asong

!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on lf.log.
[luoyi at myhost ~/tex]$ head lf.tex
% \input {luaotfload.sty}
\font\asong={AdobeSongStd-Light} at 10pt
\asong
women
\font\couri={CourierStd} at 10pt
\couri
women
\bye



2010/9/16 Li Yanrui (???) <liyanrui.m2 at gmail.com>

> 2010/9/14 taco <taco at elvenkind.com>:
> > Hi,
> >
> > See forward. Can somebody try this with current versions
> > and possibly report back to the reporter? I am at the
> > ConTeXt meeting which makes working at bugs sort of
> > problematic  and besides, I do not really understand
> > luaotfload all that well.
> >
> > Thanks in advance,
> > Taco
> >
> >
> > The following issue has been SUBMITTED.
> > ======================================================================
> > http://tracker.luatex.org/view.php?id=481
> > ======================================================================
> > Reported By:                luoyi
> > Assigned To:
> > ======================================================================
> > Project:                    luatex
> > Issue ID:                   481
> > Category:                   luatex bug
> > Reproducibility:            always
> > Severity:                   major
> > Priority:                   high
> > Status:                     new
> > ======================================================================
> > Date Submitted:             2010-09-14 10:52 CEST
> > Last Modified:              2010-09-14 10:52 CEST
> > ======================================================================
> > Summary:                    can't load chinese otf font correctly, always
> > give
> > "LuaTeX warning: lua-loaded font has no characters"
> > Description:
> > I'm using TL2010 with the latest luatex , and it looks like luatex can't
> > load
> > chinese otf font correctly. It always give error msg like" LuaTeX
> warning:
> > lua-loaded font has no characters". hope we can solve it.
> >
> > the tex file is:
> >
> > \input {luaotfload.sty}
> > \font\asong={AdobeSongStd-Light} at 10pt
> > \asong
> > women
> > \bye
> >
>
> Now the LuaTeX/plain TeX can works with the latest beta. Because I
> have not the LaTeX enviroment, I just tested this example:
>
> \font\asong={AdobeSongStd-Light} at 10pt
> \asong
> ??
> \bye
>
> It can work. LuaTeX can find AdobeSongStd-Light.otf rightly and load it.
>
> --
> Best regards,
>
> Li Yanrui (???)
> _______________________________________________
> dev-luatex mailing list
> dev-luatex at ntg.nl
> http://www.ntg.nl/mailman/listinfo/dev-luatex
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://www.ntg.nl/pipermail/dev-luatex/attachments/20100916/7dff733a/attachment-0001.html>

From root at mail.boekplan.nl  Thu Sep 16 12:27:58 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Thu, 16 Sep 2010 12:27:58 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100916102758.F0A4A40072@mail.boekplan.nl>

------------------------------------------------------------------------
r3893 | taco | 2010-09-16 11:15:42 +0200 (Thu, 16 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/luatexref-t.tex

small clarification to the use of tex.linebreak()

------------------------------------------------------------------------

From root at mail.boekplan.nl  Thu Sep 16 22:27:38 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Thu, 16 Sep 2010 22:27:38 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100916202738.7766C40072@mail.boekplan.nl>

------------------------------------------------------------------------
r3894 | hhenkel | 2010-09-16 20:59:35 +0200 (Thu, 16 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lepdflib.cc

declare lepdflib.cc function static

------------------------------------------------------------------------

From w.m.l at gmx.net  Fri Sep 17 04:16:38 2010
From: w.m.l at gmx.net (Robert)
Date: Fri, 17 Sep 2010 04:16:38 +0200
Subject: [Dev-luatex] \letterspacefont and font dimensions
Message-ID: <4C92CF86.8050209@gmx.net>

Hi,

it seems that the font dimens 6 and 7 aren't correct with letterspaced 
fonts:

\letterspacefont\x\font 100
\def\test#1{\message
   {^^J#1: \the\fontdimen#1\font\space/ \the\fontdimen#1\x}}
\test6
\test7
\bye

With pdftex, both dimens are equal for the letterspaced font and the 
base font.

Regards,
-- 
  Robert

From root at mail.boekplan.nl  Sat Sep 18 22:27:41 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Sat, 18 Sep 2010 22:27:41 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100918202741.AC96540072@mail.boekplan.nl>

------------------------------------------------------------------------
r3895 | taco | 2010-09-18 19:52:19 +0200 (Sat, 18 Sep 2010) | 3 lines
Changed paths:
   M /trunk/source/texk/kpathsea/Makefile.am
   M /trunk/source/texk/kpathsea/Makefile.in

forget about building kpathsea doc.info as it causes nothing but 
trouble (talked through with Harald Koenig) 

------------------------------------------------------------------------

From taco at elvenkind.com  Mon Sep 20 11:51:25 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Mon, 20 Sep 2010 11:51:25 +0200
Subject: [Dev-luatex] \letterspacefont and font dimensions
In-Reply-To: <4C92CF86.8050209@gmx.net>
References: <4C92CF86.8050209@gmx.net>
Message-ID: <4C972E9D.6090407@elvenkind.com>

On 09/17/2010 04:16 AM, Robert wrote:
> Hi,
>
> it seems that the font dimens 6 and 7 aren't correct with letterspaced
> fonts:
>
> \letterspacefont\x\font 100
> \def\test#1{\message
> {^^J#1: \the\fontdimen#1\font\space/ \the\fontdimen#1\x}}
> \test6
> \test7
> \bye
>
> With pdftex, both dimens are equal for the letterspaced font and the
> base font.

Luatex output is clearly wrong. But: would it not make more sense to
adjust fontdimens 2,3,4,6 and 7 to the new, wider font?

Best wishes,
Taco

From root at mail.boekplan.nl  Mon Sep 20 12:27:37 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Mon, 20 Sep 2010 12:27:37 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100920102738.10FEF40069@mail.boekplan.nl>

------------------------------------------------------------------------
r3896 | taco | 2010-09-20 11:52:00 +0200 (Mon, 20 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/texfont.w

copy_font forgot to copy the last fontdimen

------------------------------------------------------------------------

From liyanrui.m2 at gmail.com  Mon Sep 20 12:49:37 2010
From: liyanrui.m2 at gmail.com (=?UTF-8?B?TGkgWWFucnVpICjmnY7lu7bnkZ4p?=)
Date: Mon, 20 Sep 2010 18:49:37 +0800
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <20100920102738.10FEF40069@mail.boekplan.nl>
References: <20100920102738.10FEF40069@mail.boekplan.nl>
Message-ID: <AANLkTin92P_OyYoOfbyJqgZzVONFm11paa_JgY5b1iFx@mail.gmail.com>

2010/9/20 Cron Daemon <root at mail.boekplan.nl>:
> ------------------------------------------------------------------------
> r3896 | taco | 2010-09-20 11:52:00 +0200 (Mon, 20 Sep 2010) | 2 lines
> Changed paths:
> ? M /trunk/source/texk/web2c/luatexdir/font/texfont.w
>
> copy_font forgot to copy the last fontdimen
>

It seems that the problem which cjk texts in the pdf file which MkIV
output sometimes can not be copy rightly is solved by this version.


-- 
Best regards,

Li Yanrui (???)

From liyanrui.m2 at gmail.com  Mon Sep 20 12:58:22 2010
From: liyanrui.m2 at gmail.com (=?UTF-8?B?TGkgWWFucnVpICjmnY7lu7bnkZ4p?=)
Date: Mon, 20 Sep 2010 18:58:22 +0800
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
In-Reply-To: <AANLkTin92P_OyYoOfbyJqgZzVONFm11paa_JgY5b1iFx@mail.gmail.com>
References: <20100920102738.10FEF40069@mail.boekplan.nl>
	<AANLkTin92P_OyYoOfbyJqgZzVONFm11paa_JgY5b1iFx@mail.gmail.com>
Message-ID: <AANLkTi=g-aXZbfOeoOYAWeG5S7X8+0gm0=6tRMWvXzi9@mail.gmail.com>

2010/9/20 Li Yanrui (???) <liyanrui.m2 at gmail.com>:
> 2010/9/20 Cron Daemon <root at mail.boekplan.nl>:
>> ------------------------------------------------------------------------
>> r3896 | taco | 2010-09-20 11:52:00 +0200 (Mon, 20 Sep 2010) | 2 lines
>> Changed paths:
>> ? M /trunk/source/texk/web2c/luatexdir/font/texfont.w
>>
>> copy_font forgot to copy the last fontdimen
>>
>
> It seems that the problem which cjk texts in the pdf file which MkIV
> output sometimes can not be copy rightly is solved by this version.
>

Sorry, that problem is still there.

-- 
Best regards,

Li Yanrui (???)

From root at mail.boekplan.nl  Tue Sep 21 22:27:41 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue, 21 Sep 2010 22:27:41 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100921202741.A274540067@mail.boekplan.nl>

------------------------------------------------------------------------
r3897 | taco | 2010-09-21 17:12:35 +0200 (Tue, 21 Sep 2010) | 2 lines
Changed paths:
   M /trunk/manual/fdata.lua
   M /trunk/manual/functionref.tex

documentation for os.selfdir(), from PG

------------------------------------------------------------------------

From root at mail.boekplan.nl  Wed Sep 22 12:27:47 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Wed, 22 Sep 2010 12:27:47 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100922102747.C4EF040067@mail.boekplan.nl>

------------------------------------------------------------------------
r3898 | taco | 2010-09-22 08:03:03 +0200 (Wed, 22 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/font/vfovf.w

patch quad (\fontdimen6) in \letterspacefont to be compatible with pdftex

------------------------------------------------------------------------

From w.m.l at gmx.net  Thu Sep 23 22:01:48 2010
From: w.m.l at gmx.net (Robert)
Date: Thu, 23 Sep 2010 22:01:48 +0200
Subject: [Dev-luatex] negative protrusion values
Message-ID: <4C9BB22C.7060705@gmx.net>

Hi,

luatex doesn't deal with negative protrusion values correctly -- for 
opentype fonts, the margin kern is too small, while for type1 fonts it's 
way off, and even in the wrong direction:

\tracingoutput1
\showboxbreadth\maxdimen
\showboxdepth\maxdimen
   % Opentype:
   \input{luaotfload.sty}
   \font\x="Latin Modern Roman" at 12pt
   % Type1:
%  \font\x=cmr12
\x
\pdfprotrudechars2
\parindent=0pt
\lpcode\x`N=-500 \rpcode\x`N=-500
\lpcode\x`Z= 500 \rpcode\x`Z= 500
H\hfill H\penalty-10000 N\hfill N\par
H\hfill H\penalty-10000 Z\hfill Z\par
\bye



Regards,
-- 
  Robert

From w.m.l at gmx.net  Thu Sep 23 22:03:06 2010
From: w.m.l at gmx.net (Robert)
Date: Thu, 23 Sep 2010 22:03:06 +0200
Subject: [Dev-luatex] letterspacing and expansion
Message-ID: <4C9BB27A.3000404@gmx.net>

Sorry, me again ... The following gives a segmentation fault here:

\letterspacefont\x\font 100 \x
\pdffontexpand\x 20 20 1 autoexpand
Lorem ipsum dolor sit amet
\bye


PS: Thanks for the recent fix to \letterspacefont!

Regards,
-- 
  Robert

From taco at elvenkind.com  Fri Sep 24 08:37:17 2010
From: taco at elvenkind.com (Taco Hoekwater)
Date: Fri, 24 Sep 2010 08:37:17 +0200
Subject: [Dev-luatex] negative protrusion values
In-Reply-To: <4C9BB22C.7060705@gmx.net>
References: <4C9BB22C.7060705@gmx.net>
Message-ID: <4C9C471D.6070207@elvenkind.com>


Hi Robert,

Thanks for the reports. I have no time today, but I promise to
get around to fixing these bug reports. For the moment, I have
created bug tracker items for both bugs:

   http://tracker.luatex.org/view.php?id=486
   http://tracker.luatex.org/view.php?id=487

Best wishes,
Taco

From root at mail.boekplan.nl  Tue Sep 28 22:26:42 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Tue, 28 Sep 2010 22:26:42 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100928202642.5842740070@mail.boekplan.nl>

------------------------------------------------------------------------
r3899 | taco | 2010-09-28 18:57:40 +0200 (Tue, 28 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/ChangeLog
   M /trunk/source/texk/web2c/luatexdir/am/luatex.am
   A /trunk/source/texk/web2c/luatexdir/luatex.test

new test file and updates  from PEB

------------------------------------------------------------------------

From root at mail.boekplan.nl  Thu Sep 30 12:27:36 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Thu, 30 Sep 2010 12:27:36 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100930102736.189A940069@mail.boekplan.nl>

------------------------------------------------------------------------
r3900 | taco | 2010-09-30 10:54:14 +0200 (Thu, 30 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/image/pdftoepdf.cc

attempt to fix pdf inclusion slowness (bug 480)

------------------------------------------------------------------------

From root at mail.boekplan.nl  Thu Sep 30 16:27:20 2010
From: root at mail.boekplan.nl (Cron Daemon)
Date: Thu, 30 Sep 2010 16:27:20 +0200 (CEST)
Subject: [Dev-luatex] Cron <luatex@boekplan>
	/var/www/luatex.org/www/bin/luatex-svn
Message-ID: <20100930142720.C826040072@mail.boekplan.nl>

------------------------------------------------------------------------
r3901 | taco | 2010-09-30 13:53:11 +0200 (Thu, 30 Sep 2010) | 2 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/tex/texnodes.w

add glue_spec case to the show_node_list (for debugging)

------------------------------------------------------------------------
r3902 | taco | 2010-09-30 13:53:51 +0200 (Thu, 30 Sep 2010) | 3 lines
Changed paths:
   M /trunk/source/texk/web2c/luatexdir/lua/lnodelib.c

add errors for assignment of glue_specs to next fields,
and some debugging code

------------------------------------------------------------------------

